// version: 0.15.0
// date: Thu Dec 20 2018 13:45:40 GMT+0000 (GMT)
// licence: 
/**
* Copyright 2016 PT Inovação e Sistemas SA
* Copyright 2016 INESC-ID
* Copyright 2016 QUOBIS NETWORKS SL
* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V
* Copyright 2016 ORANGE SA
* Copyright 2016 Deutsche Telekom AG
* Copyright 2016 Apizee
* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
**/


!function(c,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Runtime",[],e):"object"==typeof exports?exports.Runtime=e():c.Runtime=e()}(window,function(){return function(c){var e={};function n(t){if(e[t])return e[t].exports;var g=e[t]={i:t,l:!1,exports:{}};return c[t].call(g.exports,g,g.exports,n),g.l=!0,g.exports}return n.m=c,n.c=e,n.d=function(c,e,t){n.o(c,e)||Object.defineProperty(c,e,{enumerable:!0,get:t})},n.r=function(c){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},n.t=function(c,e){if(1&e&&(c=n(c)),8&e)return c;if(4&e&&"object"==typeof c&&c&&c.__esModule)return c;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:c}),2&e&&"string"!=typeof c)for(var g in c)n.d(t,g,function(e){return c[e]}.bind(null,g));return t},n.n=function(c){var e=c&&c.__esModule?function(){return c.default}:function(){return c};return n.d(e,"a",e),e},n.o=function(c,e){return Object.prototype.hasOwnProperty.call(c,e)},n.p="",n(n.s=113)}([function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    "use strict";\n    if (true) {\n        !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === \'function\' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    } else {}\n}(this, function () {\n    "use strict";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = "undefined";\n\n    var logMethods = [\n        "trace",\n        "debug",\n        "info",\n        "warn",\n        "error"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === \'function\') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === \'debug\') {\n            methodName = \'log\';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, \'log\');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn\'t present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      var storageKey = "loglevel";\n      if (name) {\n        storageKey += ":" + name;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || \'silent\').toUpperCase();\n\n          if (typeof window === undefinedType) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + "=" + levelName + ";";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + "=");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { "TRACE": 0, "DEBUG": 1, "INFO": 2, "WARN": 3,\n          "ERROR": 4, "SILENT": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === "string" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === "number" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return "No console available for logging";\n              }\n          } else {\n              throw "log.setLevel() called with invalid level: " + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? "WARN" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if (typeof name !== "string" || name === "") {\n          throw new TypeError("You must supply a name when creating a logger.");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    return defaultLogger;\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9sb2dsZXZlbC9saWIvbG9nbGV2ZWwuanM/NWM3ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiBsb2dsZXZlbCAtIGh0dHBzOi8vZ2l0aHViLmNvbS9waW10ZXJyeS9sb2dsZXZlbFxuKlxuKiBDb3B5cmlnaHQgKGMpIDIwMTMgVGltIFBlcnJ5XG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiovXG4oZnVuY3Rpb24gKHJvb3QsIGRlZmluaXRpb24pIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShkZWZpbml0aW9uKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZGVmaW5pdGlvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJvb3QubG9nID0gZGVmaW5pdGlvbigpO1xuICAgIH1cbn0odGhpcywgZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8gU2xpZ2h0bHkgZHViaW91cyB0cmlja3MgdG8gY3V0IGRvd24gbWluaW1pemVkIGZpbGUgc2l6ZVxuICAgIHZhciBub29wID0gZnVuY3Rpb24oKSB7fTtcbiAgICB2YXIgdW5kZWZpbmVkVHlwZSA9IFwidW5kZWZpbmVkXCI7XG5cbiAgICB2YXIgbG9nTWV0aG9kcyA9IFtcbiAgICAgICAgXCJ0cmFjZVwiLFxuICAgICAgICBcImRlYnVnXCIsXG4gICAgICAgIFwiaW5mb1wiLFxuICAgICAgICBcIndhcm5cIixcbiAgICAgICAgXCJlcnJvclwiXG4gICAgXTtcblxuICAgIC8vIENyb3NzLWJyb3dzZXIgYmluZCBlcXVpdmFsZW50IHRoYXQgd29ya3MgYXQgbGVhc3QgYmFjayB0byBJRTZcbiAgICBmdW5jdGlvbiBiaW5kTWV0aG9kKG9iaiwgbWV0aG9kTmFtZSkge1xuICAgICAgICB2YXIgbWV0aG9kID0gb2JqW21ldGhvZE5hbWVdO1xuICAgICAgICBpZiAodHlwZW9mIG1ldGhvZC5iaW5kID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gbWV0aG9kLmJpbmQob2JqKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwobWV0aG9kLCBvYmopO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIE1pc3NpbmcgYmluZCBzaGltIG9yIElFOCArIE1vZGVybml6ciwgZmFsbGJhY2sgdG8gd3JhcHBpbmdcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuYXBwbHkobWV0aG9kLCBbb2JqLCBhcmd1bWVudHNdKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQnVpbGQgdGhlIGJlc3QgbG9nZ2luZyBtZXRob2QgcG9zc2libGUgZm9yIHRoaXMgZW52XG4gICAgLy8gV2hlcmV2ZXIgcG9zc2libGUgd2Ugd2FudCB0byBiaW5kLCBub3Qgd3JhcCwgdG8gcHJlc2VydmUgc3RhY2sgdHJhY2VzXG4gICAgZnVuY3Rpb24gcmVhbE1ldGhvZChtZXRob2ROYW1lKSB7XG4gICAgICAgIGlmIChtZXRob2ROYW1lID09PSAnZGVidWcnKSB7XG4gICAgICAgICAgICBtZXRob2ROYW1lID0gJ2xvZyc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUgPT09IHVuZGVmaW5lZFR5cGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gTm8gbWV0aG9kIHBvc3NpYmxlLCBmb3Igbm93IC0gZml4ZWQgbGF0ZXIgYnkgZW5hYmxlTG9nZ2luZ1doZW5Db25zb2xlQXJyaXZlc1xuICAgICAgICB9IGVsc2UgaWYgKGNvbnNvbGVbbWV0aG9kTmFtZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGJpbmRNZXRob2QoY29uc29sZSwgbWV0aG9kTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29uc29sZS5sb2cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGJpbmRNZXRob2QoY29uc29sZSwgJ2xvZycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUaGVzZSBwcml2YXRlIGZ1bmN0aW9ucyBhbHdheXMgbmVlZCBgdGhpc2AgdG8gYmUgc2V0IHByb3Blcmx5XG5cbiAgICBmdW5jdGlvbiByZXBsYWNlTG9nZ2luZ01ldGhvZHMobGV2ZWwsIGxvZ2dlck5hbWUpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb2dNZXRob2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgbWV0aG9kTmFtZSA9IGxvZ01ldGhvZHNbaV07XG4gICAgICAgICAgICB0aGlzW21ldGhvZE5hbWVdID0gKGkgPCBsZXZlbCkgP1xuICAgICAgICAgICAgICAgIG5vb3AgOlxuICAgICAgICAgICAgICAgIHRoaXMubWV0aG9kRmFjdG9yeShtZXRob2ROYW1lLCBsZXZlbCwgbG9nZ2VyTmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgbG9nLmxvZyBhcyBhbiBhbGlhcyBmb3IgbG9nLmRlYnVnXG4gICAgICAgIHRoaXMubG9nID0gdGhpcy5kZWJ1ZztcbiAgICB9XG5cbiAgICAvLyBJbiBvbGQgSUUgdmVyc2lvbnMsIHRoZSBjb25zb2xlIGlzbid0IHByZXNlbnQgdW50aWwgeW91IGZpcnN0IG9wZW4gaXQuXG4gICAgLy8gV2UgYnVpbGQgcmVhbE1ldGhvZCgpIHJlcGxhY2VtZW50cyBoZXJlIHRoYXQgcmVnZW5lcmF0ZSBsb2dnaW5nIG1ldGhvZHNcbiAgICBmdW5jdGlvbiBlbmFibGVMb2dnaW5nV2hlbkNvbnNvbGVBcnJpdmVzKG1ldGhvZE5hbWUsIGxldmVsLCBsb2dnZXJOYW1lKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09IHVuZGVmaW5lZFR5cGUpIHtcbiAgICAgICAgICAgICAgICByZXBsYWNlTG9nZ2luZ01ldGhvZHMuY2FsbCh0aGlzLCBsZXZlbCwgbG9nZ2VyTmFtZSk7XG4gICAgICAgICAgICAgICAgdGhpc1ttZXRob2ROYW1lXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIEJ5IGRlZmF1bHQsIHdlIHVzZSBjbG9zZWx5IGJvdW5kIHJlYWwgbWV0aG9kcyB3aGVyZXZlciBwb3NzaWJsZSwgYW5kXG4gICAgLy8gb3RoZXJ3aXNlIHdlIHdhaXQgZm9yIGEgY29uc29sZSB0byBhcHBlYXIsIGFuZCB0aGVuIHRyeSBhZ2Fpbi5cbiAgICBmdW5jdGlvbiBkZWZhdWx0TWV0aG9kRmFjdG9yeShtZXRob2ROYW1lLCBsZXZlbCwgbG9nZ2VyTmFtZSkge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICByZXR1cm4gcmVhbE1ldGhvZChtZXRob2ROYW1lKSB8fFxuICAgICAgICAgICAgICAgZW5hYmxlTG9nZ2luZ1doZW5Db25zb2xlQXJyaXZlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIExvZ2dlcihuYW1lLCBkZWZhdWx0TGV2ZWwsIGZhY3RvcnkpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHZhciBjdXJyZW50TGV2ZWw7XG4gICAgICB2YXIgc3RvcmFnZUtleSA9IFwibG9nbGV2ZWxcIjtcbiAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgIHN0b3JhZ2VLZXkgKz0gXCI6XCIgKyBuYW1lO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwZXJzaXN0TGV2ZWxJZlBvc3NpYmxlKGxldmVsTnVtKSB7XG4gICAgICAgICAgdmFyIGxldmVsTmFtZSA9IChsb2dNZXRob2RzW2xldmVsTnVtXSB8fCAnc2lsZW50JykudG9VcHBlckNhc2UoKTtcblxuICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSB1bmRlZmluZWRUeXBlKSByZXR1cm47XG5cbiAgICAgICAgICAvLyBVc2UgbG9jYWxTdG9yYWdlIGlmIGF2YWlsYWJsZVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Vbc3RvcmFnZUtleV0gPSBsZXZlbE5hbWU7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGNhdGNoIChpZ25vcmUpIHt9XG5cbiAgICAgICAgICAvLyBVc2Ugc2Vzc2lvbiBjb29raWUgYXMgZmFsbGJhY2tcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICB3aW5kb3cuZG9jdW1lbnQuY29va2llID1cbiAgICAgICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoc3RvcmFnZUtleSkgKyBcIj1cIiArIGxldmVsTmFtZSArIFwiO1wiO1xuICAgICAgICAgIH0gY2F0Y2ggKGlnbm9yZSkge31cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZ2V0UGVyc2lzdGVkTGV2ZWwoKSB7XG4gICAgICAgICAgdmFyIHN0b3JlZExldmVsO1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IHVuZGVmaW5lZFR5cGUpIHJldHVybjtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHN0b3JlZExldmVsID0gd2luZG93LmxvY2FsU3RvcmFnZVtzdG9yYWdlS2V5XTtcbiAgICAgICAgICB9IGNhdGNoIChpZ25vcmUpIHt9XG5cbiAgICAgICAgICAvLyBGYWxsYmFjayB0byBjb29raWVzIGlmIGxvY2FsIHN0b3JhZ2UgZ2l2ZXMgdXMgbm90aGluZ1xuICAgICAgICAgIGlmICh0eXBlb2Ygc3RvcmVkTGV2ZWwgPT09IHVuZGVmaW5lZFR5cGUpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIHZhciBjb29raWUgPSB3aW5kb3cuZG9jdW1lbnQuY29va2llO1xuICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gY29va2llLmluZGV4T2YoXG4gICAgICAgICAgICAgICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHN0b3JhZ2VLZXkpICsgXCI9XCIpO1xuICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgIHN0b3JlZExldmVsID0gL14oW147XSspLy5leGVjKGNvb2tpZS5zbGljZShsb2NhdGlvbikpWzFdO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGNhdGNoIChpZ25vcmUpIHt9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gSWYgdGhlIHN0b3JlZCBsZXZlbCBpcyBub3QgdmFsaWQsIHRyZWF0IGl0IGFzIGlmIG5vdGhpbmcgd2FzIHN0b3JlZC5cbiAgICAgICAgICBpZiAoc2VsZi5sZXZlbHNbc3RvcmVkTGV2ZWxdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgc3RvcmVkTGV2ZWwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHN0b3JlZExldmVsO1xuICAgICAgfVxuXG4gICAgICAvKlxuICAgICAgICpcbiAgICAgICAqIFB1YmxpYyBsb2dnZXIgQVBJIC0gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waW10ZXJyeS9sb2dsZXZlbCBmb3IgZGV0YWlsc1xuICAgICAgICpcbiAgICAgICAqL1xuXG4gICAgICBzZWxmLm5hbWUgPSBuYW1lO1xuXG4gICAgICBzZWxmLmxldmVscyA9IHsgXCJUUkFDRVwiOiAwLCBcIkRFQlVHXCI6IDEsIFwiSU5GT1wiOiAyLCBcIldBUk5cIjogMyxcbiAgICAgICAgICBcIkVSUk9SXCI6IDQsIFwiU0lMRU5UXCI6IDV9O1xuXG4gICAgICBzZWxmLm1ldGhvZEZhY3RvcnkgPSBmYWN0b3J5IHx8IGRlZmF1bHRNZXRob2RGYWN0b3J5O1xuXG4gICAgICBzZWxmLmdldExldmVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBjdXJyZW50TGV2ZWw7XG4gICAgICB9O1xuXG4gICAgICBzZWxmLnNldExldmVsID0gZnVuY3Rpb24gKGxldmVsLCBwZXJzaXN0KSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBsZXZlbCA9PT0gXCJzdHJpbmdcIiAmJiBzZWxmLmxldmVsc1tsZXZlbC50b1VwcGVyQ2FzZSgpXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGxldmVsID0gc2VsZi5sZXZlbHNbbGV2ZWwudG9VcHBlckNhc2UoKV07XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgbGV2ZWwgPT09IFwibnVtYmVyXCIgJiYgbGV2ZWwgPj0gMCAmJiBsZXZlbCA8PSBzZWxmLmxldmVscy5TSUxFTlQpIHtcbiAgICAgICAgICAgICAgY3VycmVudExldmVsID0gbGV2ZWw7XG4gICAgICAgICAgICAgIGlmIChwZXJzaXN0ICE9PSBmYWxzZSkgeyAgLy8gZGVmYXVsdHMgdG8gdHJ1ZVxuICAgICAgICAgICAgICAgICAgcGVyc2lzdExldmVsSWZQb3NzaWJsZShsZXZlbCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmVwbGFjZUxvZ2dpbmdNZXRob2RzLmNhbGwoc2VsZiwgbGV2ZWwsIG5hbWUpO1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUgPT09IHVuZGVmaW5lZFR5cGUgJiYgbGV2ZWwgPCBzZWxmLmxldmVscy5TSUxFTlQpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBcIk5vIGNvbnNvbGUgYXZhaWxhYmxlIGZvciBsb2dnaW5nXCI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aHJvdyBcImxvZy5zZXRMZXZlbCgpIGNhbGxlZCB3aXRoIGludmFsaWQgbGV2ZWw6IFwiICsgbGV2ZWw7XG4gICAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgc2VsZi5zZXREZWZhdWx0TGV2ZWwgPSBmdW5jdGlvbiAobGV2ZWwpIHtcbiAgICAgICAgICBpZiAoIWdldFBlcnNpc3RlZExldmVsKCkpIHtcbiAgICAgICAgICAgICAgc2VsZi5zZXRMZXZlbChsZXZlbCwgZmFsc2UpO1xuICAgICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHNlbGYuZW5hYmxlQWxsID0gZnVuY3Rpb24ocGVyc2lzdCkge1xuICAgICAgICAgIHNlbGYuc2V0TGV2ZWwoc2VsZi5sZXZlbHMuVFJBQ0UsIHBlcnNpc3QpO1xuICAgICAgfTtcblxuICAgICAgc2VsZi5kaXNhYmxlQWxsID0gZnVuY3Rpb24ocGVyc2lzdCkge1xuICAgICAgICAgIHNlbGYuc2V0TGV2ZWwoc2VsZi5sZXZlbHMuU0lMRU5ULCBwZXJzaXN0KTtcbiAgICAgIH07XG5cbiAgICAgIC8vIEluaXRpYWxpemUgd2l0aCB0aGUgcmlnaHQgbGV2ZWxcbiAgICAgIHZhciBpbml0aWFsTGV2ZWwgPSBnZXRQZXJzaXN0ZWRMZXZlbCgpO1xuICAgICAgaWYgKGluaXRpYWxMZXZlbCA9PSBudWxsKSB7XG4gICAgICAgICAgaW5pdGlhbExldmVsID0gZGVmYXVsdExldmVsID09IG51bGwgPyBcIldBUk5cIiA6IGRlZmF1bHRMZXZlbDtcbiAgICAgIH1cbiAgICAgIHNlbGYuc2V0TGV2ZWwoaW5pdGlhbExldmVsLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKlxuICAgICAqIFRvcC1sZXZlbCBBUElcbiAgICAgKlxuICAgICAqL1xuXG4gICAgdmFyIGRlZmF1bHRMb2dnZXIgPSBuZXcgTG9nZ2VyKCk7XG5cbiAgICB2YXIgX2xvZ2dlcnNCeU5hbWUgPSB7fTtcbiAgICBkZWZhdWx0TG9nZ2VyLmdldExvZ2dlciA9IGZ1bmN0aW9uIGdldExvZ2dlcihuYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIiB8fCBuYW1lID09PSBcIlwiKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIllvdSBtdXN0IHN1cHBseSBhIG5hbWUgd2hlbiBjcmVhdGluZyBhIGxvZ2dlci5cIik7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbG9nZ2VyID0gX2xvZ2dlcnNCeU5hbWVbbmFtZV07XG4gICAgICAgIGlmICghbG9nZ2VyKSB7XG4gICAgICAgICAgbG9nZ2VyID0gX2xvZ2dlcnNCeU5hbWVbbmFtZV0gPSBuZXcgTG9nZ2VyKFxuICAgICAgICAgICAgbmFtZSwgZGVmYXVsdExvZ2dlci5nZXRMZXZlbCgpLCBkZWZhdWx0TG9nZ2VyLm1ldGhvZEZhY3RvcnkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsb2dnZXI7XG4gICAgfTtcblxuICAgIC8vIEdyYWIgdGhlIGN1cnJlbnQgZ2xvYmFsIGxvZyB2YXJpYWJsZSBpbiBjYXNlIG9mIG92ZXJ3cml0ZVxuICAgIHZhciBfbG9nID0gKHR5cGVvZiB3aW5kb3cgIT09IHVuZGVmaW5lZFR5cGUpID8gd2luZG93LmxvZyA6IHVuZGVmaW5lZDtcbiAgICBkZWZhdWx0TG9nZ2VyLm5vQ29uZmxpY3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IHVuZGVmaW5lZFR5cGUgJiZcbiAgICAgICAgICAgICAgIHdpbmRvdy5sb2cgPT09IGRlZmF1bHRMb2dnZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2cgPSBfbG9nO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlZmF1bHRMb2dnZXI7XG4gICAgfTtcblxuICAgIGRlZmF1bHRMb2dnZXIuZ2V0TG9nZ2VycyA9IGZ1bmN0aW9uIGdldExvZ2dlcnMoKSB7XG4gICAgICAgIHJldHVybiBfbG9nZ2Vyc0J5TmFtZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRlZmF1bHRMb2dnZXI7XG59KSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQSxhQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n')},function(module,exports,__webpack_require__){eval("var global = __webpack_require__(3);\nvar core = __webpack_require__(9);\nvar hide = __webpack_require__(14);\nvar redefine = __webpack_require__(11);\nvar ctx = __webpack_require__(21);\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE];\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});\n  var key, own, out, exp;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    // export native or passed\n    out = (own ? target : source)[key];\n    // bind timers to global for call from export context\n    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // extend global\n    if (target) redefine(target, key, out, type & $export.U);\n    // export\n    if (exports[key] != out) hide(exports, key, exp);\n    if (IS_PROTO && expProto[key] != out) expProto[key] = out;\n  }\n};\nglobal.core = core;\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX2V4cG9ydC5qcz81Y2ExIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBjb3JlID0gcmVxdWlyZSgnLi9fY29yZScpO1xudmFyIGhpZGUgPSByZXF1aXJlKCcuL19oaWRlJyk7XG52YXIgcmVkZWZpbmUgPSByZXF1aXJlKCcuL19yZWRlZmluZScpO1xudmFyIGN0eCA9IHJlcXVpcmUoJy4vX2N0eCcpO1xudmFyIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnO1xuXG52YXIgJGV4cG9ydCA9IGZ1bmN0aW9uICh0eXBlLCBuYW1lLCBzb3VyY2UpIHtcbiAgdmFyIElTX0ZPUkNFRCA9IHR5cGUgJiAkZXhwb3J0LkY7XG4gIHZhciBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HO1xuICB2YXIgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUztcbiAgdmFyIElTX1BST1RPID0gdHlwZSAmICRleHBvcnQuUDtcbiAgdmFyIElTX0JJTkQgPSB0eXBlICYgJGV4cG9ydC5CO1xuICB2YXIgdGFyZ2V0ID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIHx8IChnbG9iYWxbbmFtZV0gPSB7fSkgOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdO1xuICB2YXIgZXhwb3J0cyA9IElTX0dMT0JBTCA/IGNvcmUgOiBjb3JlW25hbWVdIHx8IChjb3JlW25hbWVdID0ge30pO1xuICB2YXIgZXhwUHJvdG8gPSBleHBvcnRzW1BST1RPVFlQRV0gfHwgKGV4cG9ydHNbUFJPVE9UWVBFXSA9IHt9KTtcbiAgdmFyIGtleSwgb3duLCBvdXQsIGV4cDtcbiAgaWYgKElTX0dMT0JBTCkgc291cmNlID0gbmFtZTtcbiAgZm9yIChrZXkgaW4gc291cmNlKSB7XG4gICAgLy8gY29udGFpbnMgaW4gbmF0aXZlXG4gICAgb3duID0gIUlTX0ZPUkNFRCAmJiB0YXJnZXQgJiYgdGFyZ2V0W2tleV0gIT09IHVuZGVmaW5lZDtcbiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZFxuICAgIG91dCA9IChvd24gPyB0YXJnZXQgOiBzb3VyY2UpW2tleV07XG4gICAgLy8gYmluZCB0aW1lcnMgdG8gZ2xvYmFsIGZvciBjYWxsIGZyb20gZXhwb3J0IGNvbnRleHRcbiAgICBleHAgPSBJU19CSU5EICYmIG93biA/IGN0eChvdXQsIGdsb2JhbCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBjdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDtcbiAgICAvLyBleHRlbmQgZ2xvYmFsXG4gICAgaWYgKHRhcmdldCkgcmVkZWZpbmUodGFyZ2V0LCBrZXksIG91dCwgdHlwZSAmICRleHBvcnQuVSk7XG4gICAgLy8gZXhwb3J0XG4gICAgaWYgKGV4cG9ydHNba2V5XSAhPSBvdXQpIGhpZGUoZXhwb3J0cywga2V5LCBleHApO1xuICAgIGlmIChJU19QUk9UTyAmJiBleHBQcm90b1trZXldICE9IG91dCkgZXhwUHJvdG9ba2V5XSA9IG91dDtcbiAgfVxufTtcbmdsb2JhbC5jb3JlID0gY29yZTtcbi8vIHR5cGUgYml0bWFwXG4kZXhwb3J0LkYgPSAxOyAgIC8vIGZvcmNlZFxuJGV4cG9ydC5HID0gMjsgICAvLyBnbG9iYWxcbiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljXG4kZXhwb3J0LlAgPSA4OyAgIC8vIHByb3RvXG4kZXhwb3J0LkIgPSAxNjsgIC8vIGJpbmRcbiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcFxuJGV4cG9ydC5VID0gNjQ7ICAvLyBzYWZlXG4kZXhwb3J0LlIgPSAxMjg7IC8vIHJlYWwgcHJvdG8gbWV0aG9kIGZvciBgbGlicmFyeWBcbm1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///1\n")},function(module,exports){eval("module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX2ZhaWxzLmpzPzc5ZTUiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZXhlYykge1xuICB0cnkge1xuICAgIHJldHVybiAhIWV4ZWMoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2\n")},function(module,exports){eval("// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX2dsb2JhbC5qcz83NzI2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4XG52YXIgZ2xvYmFsID0gbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NYXRoID09IE1hdGhcbiAgPyB3aW5kb3cgOiB0eXBlb2Ygc2VsZiAhPSAndW5kZWZpbmVkJyAmJiBzZWxmLk1hdGggPT0gTWF0aCA/IHNlbGZcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW5ldy1mdW5jXG4gIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbmlmICh0eXBlb2YgX19nID09ICdudW1iZXInKSBfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///3\n")},function(module,exports){eval("module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX2lzLW9iamVjdC5qcz9kM2Y0Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiB0eXBlb2YgaXQgPT09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiB0eXBlb2YgaXQgPT09ICdmdW5jdGlvbic7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///4\n")},function(module,exports,__webpack_require__){eval("var isObject = __webpack_require__(4);\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX2FuLW9iamVjdC5qcz9jYjdjIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKCFpc09iamVjdChpdCkpIHRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTtcbiAgcmV0dXJuIGl0O1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///5\n")},function(module,exports,__webpack_require__){eval("var store = __webpack_require__(58)('wks');\nvar uid = __webpack_require__(30);\nvar Symbol = __webpack_require__(3).Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX3drcy5qcz8yYjRjIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBzdG9yZSA9IHJlcXVpcmUoJy4vX3NoYXJlZCcpKCd3a3MnKTtcbnZhciB1aWQgPSByZXF1aXJlKCcuL191aWQnKTtcbnZhciBTeW1ib2wgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5TeW1ib2w7XG52YXIgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJztcblxudmFyICRleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobmFtZSkge1xuICByZXR1cm4gc3RvcmVbbmFtZV0gfHwgKHN0b3JlW25hbWVdID1cbiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpO1xufTtcblxuJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///6\n")},function(module,exports,__webpack_require__){eval("var anObject = __webpack_require__(5);\nvar IE8_DOM_DEFINE = __webpack_require__(84);\nvar toPrimitive = __webpack_require__(27);\nvar dP = Object.defineProperty;\n\nexports.f = __webpack_require__(8) ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX29iamVjdC1kcC5qcz84NmNjIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xudmFyIElFOF9ET01fREVGSU5FID0gcmVxdWlyZSgnLi9faWU4LWRvbS1kZWZpbmUnKTtcbnZhciB0b1ByaW1pdGl2ZSA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpO1xudmFyIGRQID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXG5leHBvcnRzLmYgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpID8gT2JqZWN0LmRlZmluZVByb3BlcnR5IDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykge1xuICBhbk9iamVjdChPKTtcbiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpO1xuICBhbk9iamVjdChBdHRyaWJ1dGVzKTtcbiAgaWYgKElFOF9ET01fREVGSU5FKSB0cnkge1xuICAgIHJldHVybiBkUChPLCBQLCBBdHRyaWJ1dGVzKTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG4gIGlmICgnZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpIHRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7XG4gIGlmICgndmFsdWUnIGluIEF0dHJpYnV0ZXMpIE9bUF0gPSBBdHRyaWJ1dGVzLnZhbHVlO1xuICByZXR1cm4gTztcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///7\n")},function(module,exports,__webpack_require__){eval("// Thank's IE8 for his funny defineProperty\nmodule.exports = !__webpack_require__(2)(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX2Rlc2NyaXB0b3JzLmpzPzllMWUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhhbmsncyBJRTggZm9yIGhpcyBmdW5ueSBkZWZpbmVQcm9wZXJ0eVxubW9kdWxlLmV4cG9ydHMgPSAhcmVxdWlyZSgnLi9fZmFpbHMnKShmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdhJywgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDc7IH0gfSkuYSAhPSA3O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///8\n")},function(module,exports){eval("var core = module.exports = { version: '2.5.7' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvX2NvcmUuanM/ODM3OCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0geyB2ZXJzaW9uOiAnMi41LjcnIH07XG5pZiAodHlwZW9mIF9fZSA9PSAnbnVtYmVyJykgX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///9\n")},function(module,exports,__webpack_require__){eval("// 7.1.15 ToLength\nvar toInteger = __webpack_require__(25);\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190by1sZW5ndGguanM/OWRlZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA3LjEuMTUgVG9MZW5ndGhcbnZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJyk7XG52YXIgbWluID0gTWF0aC5taW47XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXQgPiAwID8gbWluKHRvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MVxufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///10\n")},function(module,exports,__webpack_require__){eval("var global = __webpack_require__(3);\nvar hide = __webpack_require__(14);\nvar has = __webpack_require__(13);\nvar SRC = __webpack_require__(30)('src');\nvar TO_STRING = 'toString';\nvar $toString = Function[TO_STRING];\nvar TPL = ('' + $toString).split(TO_STRING);\n\n__webpack_require__(9).inspectSource = function (it) {\n  return $toString.call(it);\n};\n\n(module.exports = function (O, key, val, safe) {\n  var isFunction = typeof val == 'function';\n  if (isFunction) has(val, 'name') || hide(val, 'name', key);\n  if (O[key] === val) return;\n  if (isFunction) has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n  if (O === global) {\n    O[key] = val;\n  } else if (!safe) {\n    delete O[key];\n    hide(O, key, val);\n  } else if (O[key]) {\n    O[key] = val;\n  } else {\n    hide(O, key, val);\n  }\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, TO_STRING, function toString() {\n  return typeof this == 'function' && this[SRC] || $toString.call(this);\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19yZWRlZmluZS5qcz8yYWJhIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBoaWRlID0gcmVxdWlyZSgnLi9faGlkZScpO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIFNSQyA9IHJlcXVpcmUoJy4vX3VpZCcpKCdzcmMnKTtcbnZhciBUT19TVFJJTkcgPSAndG9TdHJpbmcnO1xudmFyICR0b1N0cmluZyA9IEZ1bmN0aW9uW1RPX1NUUklOR107XG52YXIgVFBMID0gKCcnICsgJHRvU3RyaW5nKS5zcGxpdChUT19TVFJJTkcpO1xuXG5yZXF1aXJlKCcuL19jb3JlJykuaW5zcGVjdFNvdXJjZSA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gJHRvU3RyaW5nLmNhbGwoaXQpO1xufTtcblxuKG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKE8sIGtleSwgdmFsLCBzYWZlKSB7XG4gIHZhciBpc0Z1bmN0aW9uID0gdHlwZW9mIHZhbCA9PSAnZnVuY3Rpb24nO1xuICBpZiAoaXNGdW5jdGlvbikgaGFzKHZhbCwgJ25hbWUnKSB8fCBoaWRlKHZhbCwgJ25hbWUnLCBrZXkpO1xuICBpZiAoT1trZXldID09PSB2YWwpIHJldHVybjtcbiAgaWYgKGlzRnVuY3Rpb24pIGhhcyh2YWwsIFNSQykgfHwgaGlkZSh2YWwsIFNSQywgT1trZXldID8gJycgKyBPW2tleV0gOiBUUEwuam9pbihTdHJpbmcoa2V5KSkpO1xuICBpZiAoTyA9PT0gZ2xvYmFsKSB7XG4gICAgT1trZXldID0gdmFsO1xuICB9IGVsc2UgaWYgKCFzYWZlKSB7XG4gICAgZGVsZXRlIE9ba2V5XTtcbiAgICBoaWRlKE8sIGtleSwgdmFsKTtcbiAgfSBlbHNlIGlmIChPW2tleV0pIHtcbiAgICBPW2tleV0gPSB2YWw7XG4gIH0gZWxzZSB7XG4gICAgaGlkZShPLCBrZXksIHZhbCk7XG4gIH1cbi8vIGFkZCBmYWtlIEZ1bmN0aW9uI3RvU3RyaW5nIGZvciBjb3JyZWN0IHdvcmsgd3JhcHBlZCBtZXRob2RzIC8gY29uc3RydWN0b3JzIHdpdGggbWV0aG9kcyBsaWtlIExvRGFzaCBpc05hdGl2ZVxufSkoRnVuY3Rpb24ucHJvdG90eXBlLCBUT19TVFJJTkcsIGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICByZXR1cm4gdHlwZW9mIHRoaXMgPT0gJ2Z1bmN0aW9uJyAmJiB0aGlzW1NSQ10gfHwgJHRvU3RyaW5nLmNhbGwodGhpcyk7XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///11\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar fails = __webpack_require__(2);\nvar defined = __webpack_require__(24);\nvar quot = /\"/g;\n// B.2.3.2.1 CreateHTML(string, tag, attribute, value)\nvar createHTML = function (string, tag, attribute, value) {\n  var S = String(defined(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + String(value).replace(quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\nmodule.exports = function (NAME, exec) {\n  var O = {};\n  O[NAME] = exec(createHTML);\n  $export($export.P + $export.F * fails(function () {\n    var test = ''[NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  }), 'String', O);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zdHJpbmctaHRtbC5qcz8zODZiIl0sInNvdXJjZXNDb250ZW50IjpbInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgZmFpbHMgPSByZXF1aXJlKCcuL19mYWlscycpO1xudmFyIGRlZmluZWQgPSByZXF1aXJlKCcuL19kZWZpbmVkJyk7XG52YXIgcXVvdCA9IC9cIi9nO1xuLy8gQi4yLjMuMi4xIENyZWF0ZUhUTUwoc3RyaW5nLCB0YWcsIGF0dHJpYnV0ZSwgdmFsdWUpXG52YXIgY3JlYXRlSFRNTCA9IGZ1bmN0aW9uIChzdHJpbmcsIHRhZywgYXR0cmlidXRlLCB2YWx1ZSkge1xuICB2YXIgUyA9IFN0cmluZyhkZWZpbmVkKHN0cmluZykpO1xuICB2YXIgcDEgPSAnPCcgKyB0YWc7XG4gIGlmIChhdHRyaWJ1dGUgIT09ICcnKSBwMSArPSAnICcgKyBhdHRyaWJ1dGUgKyAnPVwiJyArIFN0cmluZyh2YWx1ZSkucmVwbGFjZShxdW90LCAnJnF1b3Q7JykgKyAnXCInO1xuICByZXR1cm4gcDEgKyAnPicgKyBTICsgJzwvJyArIHRhZyArICc+Jztcbn07XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChOQU1FLCBleGVjKSB7XG4gIHZhciBPID0ge307XG4gIE9bTkFNRV0gPSBleGVjKGNyZWF0ZUhUTUwpO1xuICAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGVzdCA9ICcnW05BTUVdKCdcIicpO1xuICAgIHJldHVybiB0ZXN0ICE9PSB0ZXN0LnRvTG93ZXJDYXNlKCkgfHwgdGVzdC5zcGxpdCgnXCInKS5sZW5ndGggPiAzO1xuICB9KSwgJ1N0cmluZycsIE8pO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///12\n")},function(module,exports){eval("var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19oYXMuanM/NjlhOCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCBrZXkpIHtcbiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///13\n")},function(module,exports,__webpack_require__){eval("var dP = __webpack_require__(7);\nvar createDesc = __webpack_require__(29);\nmodule.exports = __webpack_require__(8) ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19oaWRlLmpzPzMyZTkiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSA/IGZ1bmN0aW9uIChvYmplY3QsIGtleSwgdmFsdWUpIHtcbiAgcmV0dXJuIGRQLmYob2JqZWN0LCBrZXksIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTtcbn0gOiBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7XG4gIG9iamVjdFtrZXldID0gdmFsdWU7XG4gIHJldHVybiBvYmplY3Q7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///14\n")},function(module,exports,__webpack_require__){eval("// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = __webpack_require__(44);\nvar defined = __webpack_require__(24);\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190by1pb2JqZWN0LmpzPzY4MjEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzXG52YXIgSU9iamVjdCA9IHJlcXVpcmUoJy4vX2lvYmplY3QnKTtcbnZhciBkZWZpbmVkID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///15\n")},function(module,exports,__webpack_require__){eval("// 7.1.13 ToObject(argument)\nvar defined = __webpack_require__(24);\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190by1vYmplY3QuanM/NGJmOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA3LjEuMTMgVG9PYmplY3QoYXJndW1lbnQpXG52YXIgZGVmaW5lZCA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBPYmplY3QoZGVmaW5lZChpdCkpO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///16\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar fails = __webpack_require__(2);\n\nmodule.exports = function (method, arg) {\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call\n    arg ? method.call(null, function () { /* empty */ }, 1) : method.call(null);\n  });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zdHJpY3QtbWV0aG9kLmpzPzJmMjEiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIGZhaWxzID0gcmVxdWlyZSgnLi9fZmFpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobWV0aG9kLCBhcmcpIHtcbiAgcmV0dXJuICEhbWV0aG9kICYmIGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdXNlbGVzcy1jYWxsXG4gICAgYXJnID8gbWV0aG9kLmNhbGwobnVsbCwgZnVuY3Rpb24gKCkgeyAvKiBlbXB0eSAqLyB9LCAxKSA6IG1ldGhvZC5jYWxsKG51bGwpO1xuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///17\n")},function(module,exports,__webpack_require__){eval("var pIE = __webpack_require__(45);\nvar createDesc = __webpack_require__(29);\nvar toIObject = __webpack_require__(15);\nvar toPrimitive = __webpack_require__(27);\nvar has = __webpack_require__(13);\nvar IE8_DOM_DEFINE = __webpack_require__(84);\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = __webpack_require__(8) ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtZ29wZC5qcz8xMWU5Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBwSUUgPSByZXF1aXJlKCcuL19vYmplY3QtcGllJyk7XG52YXIgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcbnZhciB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0Jyk7XG52YXIgdG9QcmltaXRpdmUgPSByZXF1aXJlKCcuL190by1wcmltaXRpdmUnKTtcbnZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbnZhciBJRThfRE9NX0RFRklORSA9IHJlcXVpcmUoJy4vX2llOC1kb20tZGVmaW5lJyk7XG52YXIgZ09QRCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7XG5cbmV4cG9ydHMuZiA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApIHtcbiAgTyA9IHRvSU9iamVjdChPKTtcbiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpO1xuICBpZiAoSUU4X0RPTV9ERUZJTkUpIHRyeSB7XG4gICAgcmV0dXJuIGdPUEQoTywgUCk7XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxuICBpZiAoaGFzKE8sIFApKSByZXR1cm4gY3JlYXRlRGVzYyghcElFLmYuY2FsbChPLCBQKSwgT1tQXSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///18\n")},function(module,exports,__webpack_require__){eval("// most Object methods by ES6 should accept primitives\nvar $export = __webpack_require__(1);\nvar core = __webpack_require__(9);\nvar fails = __webpack_require__(2);\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3Qtc2FwLmpzPzVlZGEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbW9zdCBPYmplY3QgbWV0aG9kcyBieSBFUzYgc2hvdWxkIGFjY2VwdCBwcmltaXRpdmVzXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGNvcmUgPSByZXF1aXJlKCcuL19jb3JlJyk7XG52YXIgZmFpbHMgPSByZXF1aXJlKCcuL19mYWlscycpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoS0VZLCBleGVjKSB7XG4gIHZhciBmbiA9IChjb3JlLk9iamVjdCB8fCB7fSlbS0VZXSB8fCBPYmplY3RbS0VZXTtcbiAgdmFyIGV4cCA9IHt9O1xuICBleHBbS0VZXSA9IGV4ZWMoZm4pO1xuICAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIGZhaWxzKGZ1bmN0aW9uICgpIHsgZm4oMSk7IH0pLCAnT2JqZWN0JywgZXhwKTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///19\n")},function(module,exports,__webpack_require__){eval("// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx = __webpack_require__(21);\nvar IObject = __webpack_require__(44);\nvar toObject = __webpack_require__(16);\nvar toLength = __webpack_require__(10);\nvar asc = __webpack_require__(208);\nmodule.exports = function (TYPE, $create) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = $create || asc;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IObject(O);\n    var f = ctx(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var val, res;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      val = self[index];\n      res = f(val, index, O);\n      if (TYPE) {\n        if (IS_MAP) result[index] = res;   // map\n        else if (res) switch (TYPE) {\n          case 3: return true;             // some\n          case 5: return val;              // find\n          case 6: return index;            // findIndex\n          case 2: result.push(val);        // filter\n        } else if (IS_EVERY) return false; // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19hcnJheS1tZXRob2RzLmpzPzBhNDkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMCAtPiBBcnJheSNmb3JFYWNoXG4vLyAxIC0+IEFycmF5I21hcFxuLy8gMiAtPiBBcnJheSNmaWx0ZXJcbi8vIDMgLT4gQXJyYXkjc29tZVxuLy8gNCAtPiBBcnJheSNldmVyeVxuLy8gNSAtPiBBcnJheSNmaW5kXG4vLyA2IC0+IEFycmF5I2ZpbmRJbmRleFxudmFyIGN0eCA9IHJlcXVpcmUoJy4vX2N0eCcpO1xudmFyIElPYmplY3QgPSByZXF1aXJlKCcuL19pb2JqZWN0Jyk7XG52YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuL190by1vYmplY3QnKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpO1xudmFyIGFzYyA9IHJlcXVpcmUoJy4vX2FycmF5LXNwZWNpZXMtY3JlYXRlJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChUWVBFLCAkY3JlYXRlKSB7XG4gIHZhciBJU19NQVAgPSBUWVBFID09IDE7XG4gIHZhciBJU19GSUxURVIgPSBUWVBFID09IDI7XG4gIHZhciBJU19TT01FID0gVFlQRSA9PSAzO1xuICB2YXIgSVNfRVZFUlkgPSBUWVBFID09IDQ7XG4gIHZhciBJU19GSU5EX0lOREVYID0gVFlQRSA9PSA2O1xuICB2YXIgTk9fSE9MRVMgPSBUWVBFID09IDUgfHwgSVNfRklORF9JTkRFWDtcbiAgdmFyIGNyZWF0ZSA9ICRjcmVhdGUgfHwgYXNjO1xuICByZXR1cm4gZnVuY3Rpb24gKCR0aGlzLCBjYWxsYmFja2ZuLCB0aGF0KSB7XG4gICAgdmFyIE8gPSB0b09iamVjdCgkdGhpcyk7XG4gICAgdmFyIHNlbGYgPSBJT2JqZWN0KE8pO1xuICAgIHZhciBmID0gY3R4KGNhbGxiYWNrZm4sIHRoYXQsIDMpO1xuICAgIHZhciBsZW5ndGggPSB0b0xlbmd0aChzZWxmLmxlbmd0aCk7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgcmVzdWx0ID0gSVNfTUFQID8gY3JlYXRlKCR0aGlzLCBsZW5ndGgpIDogSVNfRklMVEVSID8gY3JlYXRlKCR0aGlzLCAwKSA6IHVuZGVmaW5lZDtcbiAgICB2YXIgdmFsLCByZXM7XG4gICAgZm9yICg7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIGlmIChOT19IT0xFUyB8fCBpbmRleCBpbiBzZWxmKSB7XG4gICAgICB2YWwgPSBzZWxmW2luZGV4XTtcbiAgICAgIHJlcyA9IGYodmFsLCBpbmRleCwgTyk7XG4gICAgICBpZiAoVFlQRSkge1xuICAgICAgICBpZiAoSVNfTUFQKSByZXN1bHRbaW5kZXhdID0gcmVzOyAgIC8vIG1hcFxuICAgICAgICBlbHNlIGlmIChyZXMpIHN3aXRjaCAoVFlQRSkge1xuICAgICAgICAgIGNhc2UgMzogcmV0dXJuIHRydWU7ICAgICAgICAgICAgIC8vIHNvbWVcbiAgICAgICAgICBjYXNlIDU6IHJldHVybiB2YWw7ICAgICAgICAgICAgICAvLyBmaW5kXG4gICAgICAgICAgY2FzZSA2OiByZXR1cm4gaW5kZXg7ICAgICAgICAgICAgLy8gZmluZEluZGV4XG4gICAgICAgICAgY2FzZSAyOiByZXN1bHQucHVzaCh2YWwpOyAgICAgICAgLy8gZmlsdGVyXG4gICAgICAgIH0gZWxzZSBpZiAoSVNfRVZFUlkpIHJldHVybiBmYWxzZTsgLy8gZXZlcnlcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIElTX0ZJTkRfSU5ERVggPyAtMSA6IElTX1NPTUUgfHwgSVNfRVZFUlkgPyBJU19FVkVSWSA6IHJlc3VsdDtcbiAgfTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///20\n")},function(module,exports,__webpack_require__){eval("// optional / simple context binding\nvar aFunction = __webpack_require__(22);\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19jdHguanM/OWI0MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmdcbnZhciBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChmbiwgdGhhdCwgbGVuZ3RoKSB7XG4gIGFGdW5jdGlvbihmbik7XG4gIGlmICh0aGF0ID09PSB1bmRlZmluZWQpIHJldHVybiBmbjtcbiAgc3dpdGNoIChsZW5ndGgpIHtcbiAgICBjYXNlIDE6IHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7XG4gICAgfTtcbiAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7XG4gICAgfTtcbiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbiAoYSwgYiwgYykge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gZnVuY3Rpb24gKC8qIC4uLmFyZ3MgKi8pIHtcbiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTtcbiAgfTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///21\n")},function(module,exports){eval("module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19hLWZ1bmN0aW9uLmpzP2Q4ZTgiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKSB0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uIScpO1xuICByZXR1cm4gaXQ7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///22\n")},function(module,exports){eval("var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19jb2YuanM/MmQ5NSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoaXQpLnNsaWNlKDgsIC0xKTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///23\n")},function(module,exports){eval('// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError("Can\'t call method on  " + it);\n  return it;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19kZWZpbmVkLmpzP2JlMTMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudClcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmIChpdCA9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNhbGwgbWV0aG9kIG9uICBcIiArIGl0KTtcbiAgcmV0dXJuIGl0O1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///24\n')},function(module,exports){eval("// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190by1pbnRlZ2VyLmpzPzQ1ODgiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gNy4xLjQgVG9JbnRlZ2VyXG52YXIgY2VpbCA9IE1hdGguY2VpbDtcbnZhciBmbG9vciA9IE1hdGguZmxvb3I7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///25\n")},function(module,exports,__webpack_require__){"use strict";eval("\nif (__webpack_require__(8)) {\n  var LIBRARY = __webpack_require__(31);\n  var global = __webpack_require__(3);\n  var fails = __webpack_require__(2);\n  var $export = __webpack_require__(1);\n  var $typed = __webpack_require__(56);\n  var $buffer = __webpack_require__(81);\n  var ctx = __webpack_require__(21);\n  var anInstance = __webpack_require__(41);\n  var propertyDesc = __webpack_require__(29);\n  var hide = __webpack_require__(14);\n  var redefineAll = __webpack_require__(42);\n  var toInteger = __webpack_require__(25);\n  var toLength = __webpack_require__(10);\n  var toIndex = __webpack_require__(109);\n  var toAbsoluteIndex = __webpack_require__(33);\n  var toPrimitive = __webpack_require__(27);\n  var has = __webpack_require__(13);\n  var classof = __webpack_require__(48);\n  var isObject = __webpack_require__(4);\n  var toObject = __webpack_require__(16);\n  var isArrayIter = __webpack_require__(74);\n  var create = __webpack_require__(34);\n  var getPrototypeOf = __webpack_require__(36);\n  var gOPN = __webpack_require__(35).f;\n  var getIterFn = __webpack_require__(76);\n  var uid = __webpack_require__(30);\n  var wks = __webpack_require__(6);\n  var createArrayMethod = __webpack_require__(20);\n  var createArrayIncludes = __webpack_require__(46);\n  var speciesConstructor = __webpack_require__(53);\n  var ArrayIterators = __webpack_require__(78);\n  var Iterators = __webpack_require__(38);\n  var $iterDetect = __webpack_require__(50);\n  var setSpecies = __webpack_require__(40);\n  var arrayFill = __webpack_require__(77);\n  var arrayCopyWithin = __webpack_require__(101);\n  var $DP = __webpack_require__(7);\n  var $GOPD = __webpack_require__(18);\n  var dP = $DP.f;\n  var gOPD = $GOPD.f;\n  var RangeError = global.RangeError;\n  var TypeError = global.TypeError;\n  var Uint8Array = global.Uint8Array;\n  var ARRAY_BUFFER = 'ArrayBuffer';\n  var SHARED_BUFFER = 'Shared' + ARRAY_BUFFER;\n  var BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';\n  var PROTOTYPE = 'prototype';\n  var ArrayProto = Array[PROTOTYPE];\n  var $ArrayBuffer = $buffer.ArrayBuffer;\n  var $DataView = $buffer.DataView;\n  var arrayForEach = createArrayMethod(0);\n  var arrayFilter = createArrayMethod(2);\n  var arraySome = createArrayMethod(3);\n  var arrayEvery = createArrayMethod(4);\n  var arrayFind = createArrayMethod(5);\n  var arrayFindIndex = createArrayMethod(6);\n  var arrayIncludes = createArrayIncludes(true);\n  var arrayIndexOf = createArrayIncludes(false);\n  var arrayValues = ArrayIterators.values;\n  var arrayKeys = ArrayIterators.keys;\n  var arrayEntries = ArrayIterators.entries;\n  var arrayLastIndexOf = ArrayProto.lastIndexOf;\n  var arrayReduce = ArrayProto.reduce;\n  var arrayReduceRight = ArrayProto.reduceRight;\n  var arrayJoin = ArrayProto.join;\n  var arraySort = ArrayProto.sort;\n  var arraySlice = ArrayProto.slice;\n  var arrayToString = ArrayProto.toString;\n  var arrayToLocaleString = ArrayProto.toLocaleString;\n  var ITERATOR = wks('iterator');\n  var TAG = wks('toStringTag');\n  var TYPED_CONSTRUCTOR = uid('typed_constructor');\n  var DEF_CONSTRUCTOR = uid('def_constructor');\n  var ALL_CONSTRUCTORS = $typed.CONSTR;\n  var TYPED_ARRAY = $typed.TYPED;\n  var VIEW = $typed.VIEW;\n  var WRONG_LENGTH = 'Wrong length!';\n\n  var $map = createArrayMethod(1, function (O, length) {\n    return allocate(speciesConstructor(O, O[DEF_CONSTRUCTOR]), length);\n  });\n\n  var LITTLE_ENDIAN = fails(function () {\n    // eslint-disable-next-line no-undef\n    return new Uint8Array(new Uint16Array([1]).buffer)[0] === 1;\n  });\n\n  var FORCED_SET = !!Uint8Array && !!Uint8Array[PROTOTYPE].set && fails(function () {\n    new Uint8Array(1).set({});\n  });\n\n  var toOffset = function (it, BYTES) {\n    var offset = toInteger(it);\n    if (offset < 0 || offset % BYTES) throw RangeError('Wrong offset!');\n    return offset;\n  };\n\n  var validate = function (it) {\n    if (isObject(it) && TYPED_ARRAY in it) return it;\n    throw TypeError(it + ' is not a typed array!');\n  };\n\n  var allocate = function (C, length) {\n    if (!(isObject(C) && TYPED_CONSTRUCTOR in C)) {\n      throw TypeError('It is not a typed array constructor!');\n    } return new C(length);\n  };\n\n  var speciesFromList = function (O, list) {\n    return fromList(speciesConstructor(O, O[DEF_CONSTRUCTOR]), list);\n  };\n\n  var fromList = function (C, list) {\n    var index = 0;\n    var length = list.length;\n    var result = allocate(C, length);\n    while (length > index) result[index] = list[index++];\n    return result;\n  };\n\n  var addGetter = function (it, key, internal) {\n    dP(it, key, { get: function () { return this._d[internal]; } });\n  };\n\n  var $from = function from(source /* , mapfn, thisArg */) {\n    var O = toObject(source);\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var iterFn = getIterFn(O);\n    var i, length, values, result, step, iterator;\n    if (iterFn != undefined && !isArrayIter(iterFn)) {\n      for (iterator = iterFn.call(O), values = [], i = 0; !(step = iterator.next()).done; i++) {\n        values.push(step.value);\n      } O = values;\n    }\n    if (mapping && aLen > 2) mapfn = ctx(mapfn, arguments[2], 2);\n    for (i = 0, length = toLength(O.length), result = allocate(this, length); length > i; i++) {\n      result[i] = mapping ? mapfn(O[i], i) : O[i];\n    }\n    return result;\n  };\n\n  var $of = function of(/* ...items */) {\n    var index = 0;\n    var length = arguments.length;\n    var result = allocate(this, length);\n    while (length > index) result[index] = arguments[index++];\n    return result;\n  };\n\n  // iOS Safari 6.x fails here\n  var TO_LOCALE_BUG = !!Uint8Array && fails(function () { arrayToLocaleString.call(new Uint8Array(1)); });\n\n  var $toLocaleString = function toLocaleString() {\n    return arrayToLocaleString.apply(TO_LOCALE_BUG ? arraySlice.call(validate(this)) : validate(this), arguments);\n  };\n\n  var proto = {\n    copyWithin: function copyWithin(target, start /* , end */) {\n      return arrayCopyWithin.call(validate(this), target, start, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    every: function every(callbackfn /* , thisArg */) {\n      return arrayEvery(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    fill: function fill(value /* , start, end */) { // eslint-disable-line no-unused-vars\n      return arrayFill.apply(validate(this), arguments);\n    },\n    filter: function filter(callbackfn /* , thisArg */) {\n      return speciesFromList(this, arrayFilter(validate(this), callbackfn,\n        arguments.length > 1 ? arguments[1] : undefined));\n    },\n    find: function find(predicate /* , thisArg */) {\n      return arrayFind(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    findIndex: function findIndex(predicate /* , thisArg */) {\n      return arrayFindIndex(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    forEach: function forEach(callbackfn /* , thisArg */) {\n      arrayForEach(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    indexOf: function indexOf(searchElement /* , fromIndex */) {\n      return arrayIndexOf(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    includes: function includes(searchElement /* , fromIndex */) {\n      return arrayIncludes(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    join: function join(separator) { // eslint-disable-line no-unused-vars\n      return arrayJoin.apply(validate(this), arguments);\n    },\n    lastIndexOf: function lastIndexOf(searchElement /* , fromIndex */) { // eslint-disable-line no-unused-vars\n      return arrayLastIndexOf.apply(validate(this), arguments);\n    },\n    map: function map(mapfn /* , thisArg */) {\n      return $map(validate(this), mapfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    reduce: function reduce(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars\n      return arrayReduce.apply(validate(this), arguments);\n    },\n    reduceRight: function reduceRight(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars\n      return arrayReduceRight.apply(validate(this), arguments);\n    },\n    reverse: function reverse() {\n      var that = this;\n      var length = validate(that).length;\n      var middle = Math.floor(length / 2);\n      var index = 0;\n      var value;\n      while (index < middle) {\n        value = that[index];\n        that[index++] = that[--length];\n        that[length] = value;\n      } return that;\n    },\n    some: function some(callbackfn /* , thisArg */) {\n      return arraySome(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    sort: function sort(comparefn) {\n      return arraySort.call(validate(this), comparefn);\n    },\n    subarray: function subarray(begin, end) {\n      var O = validate(this);\n      var length = O.length;\n      var $begin = toAbsoluteIndex(begin, length);\n      return new (speciesConstructor(O, O[DEF_CONSTRUCTOR]))(\n        O.buffer,\n        O.byteOffset + $begin * O.BYTES_PER_ELEMENT,\n        toLength((end === undefined ? length : toAbsoluteIndex(end, length)) - $begin)\n      );\n    }\n  };\n\n  var $slice = function slice(start, end) {\n    return speciesFromList(this, arraySlice.call(validate(this), start, end));\n  };\n\n  var $set = function set(arrayLike /* , offset */) {\n    validate(this);\n    var offset = toOffset(arguments[1], 1);\n    var length = this.length;\n    var src = toObject(arrayLike);\n    var len = toLength(src.length);\n    var index = 0;\n    if (len + offset > length) throw RangeError(WRONG_LENGTH);\n    while (index < len) this[offset + index] = src[index++];\n  };\n\n  var $iterators = {\n    entries: function entries() {\n      return arrayEntries.call(validate(this));\n    },\n    keys: function keys() {\n      return arrayKeys.call(validate(this));\n    },\n    values: function values() {\n      return arrayValues.call(validate(this));\n    }\n  };\n\n  var isTAIndex = function (target, key) {\n    return isObject(target)\n      && target[TYPED_ARRAY]\n      && typeof key != 'symbol'\n      && key in target\n      && String(+key) == String(key);\n  };\n  var $getDesc = function getOwnPropertyDescriptor(target, key) {\n    return isTAIndex(target, key = toPrimitive(key, true))\n      ? propertyDesc(2, target[key])\n      : gOPD(target, key);\n  };\n  var $setDesc = function defineProperty(target, key, desc) {\n    if (isTAIndex(target, key = toPrimitive(key, true))\n      && isObject(desc)\n      && has(desc, 'value')\n      && !has(desc, 'get')\n      && !has(desc, 'set')\n      // TODO: add validation descriptor w/o calling accessors\n      && !desc.configurable\n      && (!has(desc, 'writable') || desc.writable)\n      && (!has(desc, 'enumerable') || desc.enumerable)\n    ) {\n      target[key] = desc.value;\n      return target;\n    } return dP(target, key, desc);\n  };\n\n  if (!ALL_CONSTRUCTORS) {\n    $GOPD.f = $getDesc;\n    $DP.f = $setDesc;\n  }\n\n  $export($export.S + $export.F * !ALL_CONSTRUCTORS, 'Object', {\n    getOwnPropertyDescriptor: $getDesc,\n    defineProperty: $setDesc\n  });\n\n  if (fails(function () { arrayToString.call({}); })) {\n    arrayToString = arrayToLocaleString = function toString() {\n      return arrayJoin.call(this);\n    };\n  }\n\n  var $TypedArrayPrototype$ = redefineAll({}, proto);\n  redefineAll($TypedArrayPrototype$, $iterators);\n  hide($TypedArrayPrototype$, ITERATOR, $iterators.values);\n  redefineAll($TypedArrayPrototype$, {\n    slice: $slice,\n    set: $set,\n    constructor: function () { /* noop */ },\n    toString: arrayToString,\n    toLocaleString: $toLocaleString\n  });\n  addGetter($TypedArrayPrototype$, 'buffer', 'b');\n  addGetter($TypedArrayPrototype$, 'byteOffset', 'o');\n  addGetter($TypedArrayPrototype$, 'byteLength', 'l');\n  addGetter($TypedArrayPrototype$, 'length', 'e');\n  dP($TypedArrayPrototype$, TAG, {\n    get: function () { return this[TYPED_ARRAY]; }\n  });\n\n  // eslint-disable-next-line max-statements\n  module.exports = function (KEY, BYTES, wrapper, CLAMPED) {\n    CLAMPED = !!CLAMPED;\n    var NAME = KEY + (CLAMPED ? 'Clamped' : '') + 'Array';\n    var GETTER = 'get' + KEY;\n    var SETTER = 'set' + KEY;\n    var TypedArray = global[NAME];\n    var Base = TypedArray || {};\n    var TAC = TypedArray && getPrototypeOf(TypedArray);\n    var FORCED = !TypedArray || !$typed.ABV;\n    var O = {};\n    var TypedArrayPrototype = TypedArray && TypedArray[PROTOTYPE];\n    var getter = function (that, index) {\n      var data = that._d;\n      return data.v[GETTER](index * BYTES + data.o, LITTLE_ENDIAN);\n    };\n    var setter = function (that, index, value) {\n      var data = that._d;\n      if (CLAMPED) value = (value = Math.round(value)) < 0 ? 0 : value > 0xff ? 0xff : value & 0xff;\n      data.v[SETTER](index * BYTES + data.o, value, LITTLE_ENDIAN);\n    };\n    var addElement = function (that, index) {\n      dP(that, index, {\n        get: function () {\n          return getter(this, index);\n        },\n        set: function (value) {\n          return setter(this, index, value);\n        },\n        enumerable: true\n      });\n    };\n    if (FORCED) {\n      TypedArray = wrapper(function (that, data, $offset, $length) {\n        anInstance(that, TypedArray, NAME, '_d');\n        var index = 0;\n        var offset = 0;\n        var buffer, byteLength, length, klass;\n        if (!isObject(data)) {\n          length = toIndex(data);\n          byteLength = length * BYTES;\n          buffer = new $ArrayBuffer(byteLength);\n        } else if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {\n          buffer = data;\n          offset = toOffset($offset, BYTES);\n          var $len = data.byteLength;\n          if ($length === undefined) {\n            if ($len % BYTES) throw RangeError(WRONG_LENGTH);\n            byteLength = $len - offset;\n            if (byteLength < 0) throw RangeError(WRONG_LENGTH);\n          } else {\n            byteLength = toLength($length) * BYTES;\n            if (byteLength + offset > $len) throw RangeError(WRONG_LENGTH);\n          }\n          length = byteLength / BYTES;\n        } else if (TYPED_ARRAY in data) {\n          return fromList(TypedArray, data);\n        } else {\n          return $from.call(TypedArray, data);\n        }\n        hide(that, '_d', {\n          b: buffer,\n          o: offset,\n          l: byteLength,\n          e: length,\n          v: new $DataView(buffer)\n        });\n        while (index < length) addElement(that, index++);\n      });\n      TypedArrayPrototype = TypedArray[PROTOTYPE] = create($TypedArrayPrototype$);\n      hide(TypedArrayPrototype, 'constructor', TypedArray);\n    } else if (!fails(function () {\n      TypedArray(1);\n    }) || !fails(function () {\n      new TypedArray(-1); // eslint-disable-line no-new\n    }) || !$iterDetect(function (iter) {\n      new TypedArray(); // eslint-disable-line no-new\n      new TypedArray(null); // eslint-disable-line no-new\n      new TypedArray(1.5); // eslint-disable-line no-new\n      new TypedArray(iter); // eslint-disable-line no-new\n    }, true)) {\n      TypedArray = wrapper(function (that, data, $offset, $length) {\n        anInstance(that, TypedArray, NAME);\n        var klass;\n        // `ws` module bug, temporarily remove validation length for Uint8Array\n        // https://github.com/websockets/ws/pull/645\n        if (!isObject(data)) return new Base(toIndex(data));\n        if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {\n          return $length !== undefined\n            ? new Base(data, toOffset($offset, BYTES), $length)\n            : $offset !== undefined\n              ? new Base(data, toOffset($offset, BYTES))\n              : new Base(data);\n        }\n        if (TYPED_ARRAY in data) return fromList(TypedArray, data);\n        return $from.call(TypedArray, data);\n      });\n      arrayForEach(TAC !== Function.prototype ? gOPN(Base).concat(gOPN(TAC)) : gOPN(Base), function (key) {\n        if (!(key in TypedArray)) hide(TypedArray, key, Base[key]);\n      });\n      TypedArray[PROTOTYPE] = TypedArrayPrototype;\n      if (!LIBRARY) TypedArrayPrototype.constructor = TypedArray;\n    }\n    var $nativeIterator = TypedArrayPrototype[ITERATOR];\n    var CORRECT_ITER_NAME = !!$nativeIterator\n      && ($nativeIterator.name == 'values' || $nativeIterator.name == undefined);\n    var $iterator = $iterators.values;\n    hide(TypedArray, TYPED_CONSTRUCTOR, true);\n    hide(TypedArrayPrototype, TYPED_ARRAY, NAME);\n    hide(TypedArrayPrototype, VIEW, true);\n    hide(TypedArrayPrototype, DEF_CONSTRUCTOR, TypedArray);\n\n    if (CLAMPED ? new TypedArray(1)[TAG] != NAME : !(TAG in TypedArrayPrototype)) {\n      dP(TypedArrayPrototype, TAG, {\n        get: function () { return NAME; }\n      });\n    }\n\n    O[NAME] = TypedArray;\n\n    $export($export.G + $export.W + $export.F * (TypedArray != Base), O);\n\n    $export($export.S, NAME, {\n      BYTES_PER_ELEMENT: BYTES\n    });\n\n    $export($export.S + $export.F * fails(function () { Base.of.call(TypedArray, 1); }), NAME, {\n      from: $from,\n      of: $of\n    });\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayPrototype)) hide(TypedArrayPrototype, BYTES_PER_ELEMENT, BYTES);\n\n    $export($export.P, NAME, proto);\n\n    setSpecies(NAME);\n\n    $export($export.P + $export.F * FORCED_SET, NAME, { set: $set });\n\n    $export($export.P + $export.F * !CORRECT_ITER_NAME, NAME, $iterators);\n\n    if (!LIBRARY && TypedArrayPrototype.toString != arrayToString) TypedArrayPrototype.toString = arrayToString;\n\n    $export($export.P + $export.F * fails(function () {\n      new TypedArray(1).slice();\n    }), NAME, { slice: $slice });\n\n    $export($export.P + $export.F * (fails(function () {\n      return [1, 2].toLocaleString() != new TypedArray([1, 2]).toLocaleString();\n    }) || !fails(function () {\n      TypedArrayPrototype.toLocaleString.call([1, 2]);\n    })), NAME, { toLocaleString: $toLocaleString });\n\n    Iterators[NAME] = CORRECT_ITER_NAME ? $nativeIterator : $iterator;\n    if (!LIBRARY && !CORRECT_ITER_NAME) hide(TypedArrayPrototype, ITERATOR, $iterator);\n  };\n} else module.exports = function () { /* empty */ };\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190eXBlZC1hcnJheS5qcz9lYzMwIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmlmIChyZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpKSB7XG4gIHZhciBMSUJSQVJZID0gcmVxdWlyZSgnLi9fbGlicmFyeScpO1xuICB2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG4gIHZhciBmYWlscyA9IHJlcXVpcmUoJy4vX2ZhaWxzJyk7XG4gIHZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG4gIHZhciAkdHlwZWQgPSByZXF1aXJlKCcuL190eXBlZCcpO1xuICB2YXIgJGJ1ZmZlciA9IHJlcXVpcmUoJy4vX3R5cGVkLWJ1ZmZlcicpO1xuICB2YXIgY3R4ID0gcmVxdWlyZSgnLi9fY3R4Jyk7XG4gIHZhciBhbkluc3RhbmNlID0gcmVxdWlyZSgnLi9fYW4taW5zdGFuY2UnKTtcbiAgdmFyIHByb3BlcnR5RGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcbiAgdmFyIGhpZGUgPSByZXF1aXJlKCcuL19oaWRlJyk7XG4gIHZhciByZWRlZmluZUFsbCA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lLWFsbCcpO1xuICB2YXIgdG9JbnRlZ2VyID0gcmVxdWlyZSgnLi9fdG8taW50ZWdlcicpO1xuICB2YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcbiAgdmFyIHRvSW5kZXggPSByZXF1aXJlKCcuL190by1pbmRleCcpO1xuICB2YXIgdG9BYnNvbHV0ZUluZGV4ID0gcmVxdWlyZSgnLi9fdG8tYWJzb2x1dGUtaW5kZXgnKTtcbiAgdmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJyk7XG4gIHZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbiAgdmFyIGNsYXNzb2YgPSByZXF1aXJlKCcuL19jbGFzc29mJyk7XG4gIHZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xuICB2YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuL190by1vYmplY3QnKTtcbiAgdmFyIGlzQXJyYXlJdGVyID0gcmVxdWlyZSgnLi9faXMtYXJyYXktaXRlcicpO1xuICB2YXIgY3JlYXRlID0gcmVxdWlyZSgnLi9fb2JqZWN0LWNyZWF0ZScpO1xuICB2YXIgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJyk7XG4gIHZhciBnT1BOID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4nKS5mO1xuICB2YXIgZ2V0SXRlckZuID0gcmVxdWlyZSgnLi9jb3JlLmdldC1pdGVyYXRvci1tZXRob2QnKTtcbiAgdmFyIHVpZCA9IHJlcXVpcmUoJy4vX3VpZCcpO1xuICB2YXIgd2tzID0gcmVxdWlyZSgnLi9fd2tzJyk7XG4gIHZhciBjcmVhdGVBcnJheU1ldGhvZCA9IHJlcXVpcmUoJy4vX2FycmF5LW1ldGhvZHMnKTtcbiAgdmFyIGNyZWF0ZUFycmF5SW5jbHVkZXMgPSByZXF1aXJlKCcuL19hcnJheS1pbmNsdWRlcycpO1xuICB2YXIgc3BlY2llc0NvbnN0cnVjdG9yID0gcmVxdWlyZSgnLi9fc3BlY2llcy1jb25zdHJ1Y3RvcicpO1xuICB2YXIgQXJyYXlJdGVyYXRvcnMgPSByZXF1aXJlKCcuL2VzNi5hcnJheS5pdGVyYXRvcicpO1xuICB2YXIgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7XG4gIHZhciAkaXRlckRldGVjdCA9IHJlcXVpcmUoJy4vX2l0ZXItZGV0ZWN0Jyk7XG4gIHZhciBzZXRTcGVjaWVzID0gcmVxdWlyZSgnLi9fc2V0LXNwZWNpZXMnKTtcbiAgdmFyIGFycmF5RmlsbCA9IHJlcXVpcmUoJy4vX2FycmF5LWZpbGwnKTtcbiAgdmFyIGFycmF5Q29weVdpdGhpbiA9IHJlcXVpcmUoJy4vX2FycmF5LWNvcHktd2l0aGluJyk7XG4gIHZhciAkRFAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKTtcbiAgdmFyICRHT1BEID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKTtcbiAgdmFyIGRQID0gJERQLmY7XG4gIHZhciBnT1BEID0gJEdPUEQuZjtcbiAgdmFyIFJhbmdlRXJyb3IgPSBnbG9iYWwuUmFuZ2VFcnJvcjtcbiAgdmFyIFR5cGVFcnJvciA9IGdsb2JhbC5UeXBlRXJyb3I7XG4gIHZhciBVaW50OEFycmF5ID0gZ2xvYmFsLlVpbnQ4QXJyYXk7XG4gIHZhciBBUlJBWV9CVUZGRVIgPSAnQXJyYXlCdWZmZXInO1xuICB2YXIgU0hBUkVEX0JVRkZFUiA9ICdTaGFyZWQnICsgQVJSQVlfQlVGRkVSO1xuICB2YXIgQllURVNfUEVSX0VMRU1FTlQgPSAnQllURVNfUEVSX0VMRU1FTlQnO1xuICB2YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7XG4gIHZhciBBcnJheVByb3RvID0gQXJyYXlbUFJPVE9UWVBFXTtcbiAgdmFyICRBcnJheUJ1ZmZlciA9ICRidWZmZXIuQXJyYXlCdWZmZXI7XG4gIHZhciAkRGF0YVZpZXcgPSAkYnVmZmVyLkRhdGFWaWV3O1xuICB2YXIgYXJyYXlGb3JFYWNoID0gY3JlYXRlQXJyYXlNZXRob2QoMCk7XG4gIHZhciBhcnJheUZpbHRlciA9IGNyZWF0ZUFycmF5TWV0aG9kKDIpO1xuICB2YXIgYXJyYXlTb21lID0gY3JlYXRlQXJyYXlNZXRob2QoMyk7XG4gIHZhciBhcnJheUV2ZXJ5ID0gY3JlYXRlQXJyYXlNZXRob2QoNCk7XG4gIHZhciBhcnJheUZpbmQgPSBjcmVhdGVBcnJheU1ldGhvZCg1KTtcbiAgdmFyIGFycmF5RmluZEluZGV4ID0gY3JlYXRlQXJyYXlNZXRob2QoNik7XG4gIHZhciBhcnJheUluY2x1ZGVzID0gY3JlYXRlQXJyYXlJbmNsdWRlcyh0cnVlKTtcbiAgdmFyIGFycmF5SW5kZXhPZiA9IGNyZWF0ZUFycmF5SW5jbHVkZXMoZmFsc2UpO1xuICB2YXIgYXJyYXlWYWx1ZXMgPSBBcnJheUl0ZXJhdG9ycy52YWx1ZXM7XG4gIHZhciBhcnJheUtleXMgPSBBcnJheUl0ZXJhdG9ycy5rZXlzO1xuICB2YXIgYXJyYXlFbnRyaWVzID0gQXJyYXlJdGVyYXRvcnMuZW50cmllcztcbiAgdmFyIGFycmF5TGFzdEluZGV4T2YgPSBBcnJheVByb3RvLmxhc3RJbmRleE9mO1xuICB2YXIgYXJyYXlSZWR1Y2UgPSBBcnJheVByb3RvLnJlZHVjZTtcbiAgdmFyIGFycmF5UmVkdWNlUmlnaHQgPSBBcnJheVByb3RvLnJlZHVjZVJpZ2h0O1xuICB2YXIgYXJyYXlKb2luID0gQXJyYXlQcm90by5qb2luO1xuICB2YXIgYXJyYXlTb3J0ID0gQXJyYXlQcm90by5zb3J0O1xuICB2YXIgYXJyYXlTbGljZSA9IEFycmF5UHJvdG8uc2xpY2U7XG4gIHZhciBhcnJheVRvU3RyaW5nID0gQXJyYXlQcm90by50b1N0cmluZztcbiAgdmFyIGFycmF5VG9Mb2NhbGVTdHJpbmcgPSBBcnJheVByb3RvLnRvTG9jYWxlU3RyaW5nO1xuICB2YXIgSVRFUkFUT1IgPSB3a3MoJ2l0ZXJhdG9yJyk7XG4gIHZhciBUQUcgPSB3a3MoJ3RvU3RyaW5nVGFnJyk7XG4gIHZhciBUWVBFRF9DT05TVFJVQ1RPUiA9IHVpZCgndHlwZWRfY29uc3RydWN0b3InKTtcbiAgdmFyIERFRl9DT05TVFJVQ1RPUiA9IHVpZCgnZGVmX2NvbnN0cnVjdG9yJyk7XG4gIHZhciBBTExfQ09OU1RSVUNUT1JTID0gJHR5cGVkLkNPTlNUUjtcbiAgdmFyIFRZUEVEX0FSUkFZID0gJHR5cGVkLlRZUEVEO1xuICB2YXIgVklFVyA9ICR0eXBlZC5WSUVXO1xuICB2YXIgV1JPTkdfTEVOR1RIID0gJ1dyb25nIGxlbmd0aCEnO1xuXG4gIHZhciAkbWFwID0gY3JlYXRlQXJyYXlNZXRob2QoMSwgZnVuY3Rpb24gKE8sIGxlbmd0aCkge1xuICAgIHJldHVybiBhbGxvY2F0ZShzcGVjaWVzQ29uc3RydWN0b3IoTywgT1tERUZfQ09OU1RSVUNUT1JdKSwgbGVuZ3RoKTtcbiAgfSk7XG5cbiAgdmFyIExJVFRMRV9FTkRJQU4gPSBmYWlscyhmdW5jdGlvbiAoKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KG5ldyBVaW50MTZBcnJheShbMV0pLmJ1ZmZlcilbMF0gPT09IDE7XG4gIH0pO1xuXG4gIHZhciBGT1JDRURfU0VUID0gISFVaW50OEFycmF5ICYmICEhVWludDhBcnJheVtQUk9UT1RZUEVdLnNldCAmJiBmYWlscyhmdW5jdGlvbiAoKSB7XG4gICAgbmV3IFVpbnQ4QXJyYXkoMSkuc2V0KHt9KTtcbiAgfSk7XG5cbiAgdmFyIHRvT2Zmc2V0ID0gZnVuY3Rpb24gKGl0LCBCWVRFUykge1xuICAgIHZhciBvZmZzZXQgPSB0b0ludGVnZXIoaXQpO1xuICAgIGlmIChvZmZzZXQgPCAwIHx8IG9mZnNldCAlIEJZVEVTKSB0aHJvdyBSYW5nZUVycm9yKCdXcm9uZyBvZmZzZXQhJyk7XG4gICAgcmV0dXJuIG9mZnNldDtcbiAgfTtcblxuICB2YXIgdmFsaWRhdGUgPSBmdW5jdGlvbiAoaXQpIHtcbiAgICBpZiAoaXNPYmplY3QoaXQpICYmIFRZUEVEX0FSUkFZIGluIGl0KSByZXR1cm4gaXQ7XG4gICAgdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSB0eXBlZCBhcnJheSEnKTtcbiAgfTtcblxuICB2YXIgYWxsb2NhdGUgPSBmdW5jdGlvbiAoQywgbGVuZ3RoKSB7XG4gICAgaWYgKCEoaXNPYmplY3QoQykgJiYgVFlQRURfQ09OU1RSVUNUT1IgaW4gQykpIHtcbiAgICAgIHRocm93IFR5cGVFcnJvcignSXQgaXMgbm90IGEgdHlwZWQgYXJyYXkgY29uc3RydWN0b3IhJyk7XG4gICAgfSByZXR1cm4gbmV3IEMobGVuZ3RoKTtcbiAgfTtcblxuICB2YXIgc3BlY2llc0Zyb21MaXN0ID0gZnVuY3Rpb24gKE8sIGxpc3QpIHtcbiAgICByZXR1cm4gZnJvbUxpc3Qoc3BlY2llc0NvbnN0cnVjdG9yKE8sIE9bREVGX0NPTlNUUlVDVE9SXSksIGxpc3QpO1xuICB9O1xuXG4gIHZhciBmcm9tTGlzdCA9IGZ1bmN0aW9uIChDLCBsaXN0KSB7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGg7XG4gICAgdmFyIHJlc3VsdCA9IGFsbG9jYXRlKEMsIGxlbmd0aCk7XG4gICAgd2hpbGUgKGxlbmd0aCA+IGluZGV4KSByZXN1bHRbaW5kZXhdID0gbGlzdFtpbmRleCsrXTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIHZhciBhZGRHZXR0ZXIgPSBmdW5jdGlvbiAoaXQsIGtleSwgaW50ZXJuYWwpIHtcbiAgICBkUChpdCwga2V5LCB7IGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fZFtpbnRlcm5hbF07IH0gfSk7XG4gIH07XG5cbiAgdmFyICRmcm9tID0gZnVuY3Rpb24gZnJvbShzb3VyY2UgLyogLCBtYXBmbiwgdGhpc0FyZyAqLykge1xuICAgIHZhciBPID0gdG9PYmplY3Qoc291cmNlKTtcbiAgICB2YXIgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgdmFyIG1hcGZuID0gYUxlbiA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIG1hcHBpbmcgPSBtYXBmbiAhPT0gdW5kZWZpbmVkO1xuICAgIHZhciBpdGVyRm4gPSBnZXRJdGVyRm4oTyk7XG4gICAgdmFyIGksIGxlbmd0aCwgdmFsdWVzLCByZXN1bHQsIHN0ZXAsIGl0ZXJhdG9yO1xuICAgIGlmIChpdGVyRm4gIT0gdW5kZWZpbmVkICYmICFpc0FycmF5SXRlcihpdGVyRm4pKSB7XG4gICAgICBmb3IgKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoTyksIHZhbHVlcyA9IFtdLCBpID0gMDsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOyBpKyspIHtcbiAgICAgICAgdmFsdWVzLnB1c2goc3RlcC52YWx1ZSk7XG4gICAgICB9IE8gPSB2YWx1ZXM7XG4gICAgfVxuICAgIGlmIChtYXBwaW5nICYmIGFMZW4gPiAyKSBtYXBmbiA9IGN0eChtYXBmbiwgYXJndW1lbnRzWzJdLCAyKTtcbiAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCksIHJlc3VsdCA9IGFsbG9jYXRlKHRoaXMsIGxlbmd0aCk7IGxlbmd0aCA+IGk7IGkrKykge1xuICAgICAgcmVzdWx0W2ldID0gbWFwcGluZyA/IG1hcGZuKE9baV0sIGkpIDogT1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICB2YXIgJG9mID0gZnVuY3Rpb24gb2YoLyogLi4uaXRlbXMgKi8pIHtcbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIHZhciByZXN1bHQgPSBhbGxvY2F0ZSh0aGlzLCBsZW5ndGgpO1xuICAgIHdoaWxlIChsZW5ndGggPiBpbmRleCkgcmVzdWx0W2luZGV4XSA9IGFyZ3VtZW50c1tpbmRleCsrXTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIGlPUyBTYWZhcmkgNi54IGZhaWxzIGhlcmVcbiAgdmFyIFRPX0xPQ0FMRV9CVUcgPSAhIVVpbnQ4QXJyYXkgJiYgZmFpbHMoZnVuY3Rpb24gKCkgeyBhcnJheVRvTG9jYWxlU3RyaW5nLmNhbGwobmV3IFVpbnQ4QXJyYXkoMSkpOyB9KTtcblxuICB2YXIgJHRvTG9jYWxlU3RyaW5nID0gZnVuY3Rpb24gdG9Mb2NhbGVTdHJpbmcoKSB7XG4gICAgcmV0dXJuIGFycmF5VG9Mb2NhbGVTdHJpbmcuYXBwbHkoVE9fTE9DQUxFX0JVRyA/IGFycmF5U2xpY2UuY2FsbCh2YWxpZGF0ZSh0aGlzKSkgOiB2YWxpZGF0ZSh0aGlzKSwgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgcHJvdG8gPSB7XG4gICAgY29weVdpdGhpbjogZnVuY3Rpb24gY29weVdpdGhpbih0YXJnZXQsIHN0YXJ0IC8qICwgZW5kICovKSB7XG4gICAgICByZXR1cm4gYXJyYXlDb3B5V2l0aGluLmNhbGwodmFsaWRhdGUodGhpcyksIHRhcmdldCwgc3RhcnQsIGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkKTtcbiAgICB9LFxuICAgIGV2ZXJ5OiBmdW5jdGlvbiBldmVyeShjYWxsYmFja2ZuIC8qICwgdGhpc0FyZyAqLykge1xuICAgICAgcmV0dXJuIGFycmF5RXZlcnkodmFsaWRhdGUodGhpcyksIGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTtcbiAgICB9LFxuICAgIGZpbGw6IGZ1bmN0aW9uIGZpbGwodmFsdWUgLyogLCBzdGFydCwgZW5kICovKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAgIHJldHVybiBhcnJheUZpbGwuYXBwbHkodmFsaWRhdGUodGhpcyksIGFyZ3VtZW50cyk7XG4gICAgfSxcbiAgICBmaWx0ZXI6IGZ1bmN0aW9uIGZpbHRlcihjYWxsYmFja2ZuIC8qICwgdGhpc0FyZyAqLykge1xuICAgICAgcmV0dXJuIHNwZWNpZXNGcm9tTGlzdCh0aGlzLCBhcnJheUZpbHRlcih2YWxpZGF0ZSh0aGlzKSwgY2FsbGJhY2tmbixcbiAgICAgICAgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpKTtcbiAgICB9LFxuICAgIGZpbmQ6IGZ1bmN0aW9uIGZpbmQocHJlZGljYXRlIC8qICwgdGhpc0FyZyAqLykge1xuICAgICAgcmV0dXJuIGFycmF5RmluZCh2YWxpZGF0ZSh0aGlzKSwgcHJlZGljYXRlLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7XG4gICAgfSxcbiAgICBmaW5kSW5kZXg6IGZ1bmN0aW9uIGZpbmRJbmRleChwcmVkaWNhdGUgLyogLCB0aGlzQXJnICovKSB7XG4gICAgICByZXR1cm4gYXJyYXlGaW5kSW5kZXgodmFsaWRhdGUodGhpcyksIHByZWRpY2F0ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpO1xuICAgIH0sXG4gICAgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChjYWxsYmFja2ZuIC8qICwgdGhpc0FyZyAqLykge1xuICAgICAgYXJyYXlGb3JFYWNoKHZhbGlkYXRlKHRoaXMpLCBjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7XG4gICAgfSxcbiAgICBpbmRleE9mOiBmdW5jdGlvbiBpbmRleE9mKHNlYXJjaEVsZW1lbnQgLyogLCBmcm9tSW5kZXggKi8pIHtcbiAgICAgIHJldHVybiBhcnJheUluZGV4T2YodmFsaWRhdGUodGhpcyksIHNlYXJjaEVsZW1lbnQsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTtcbiAgICB9LFxuICAgIGluY2x1ZGVzOiBmdW5jdGlvbiBpbmNsdWRlcyhzZWFyY2hFbGVtZW50IC8qICwgZnJvbUluZGV4ICovKSB7XG4gICAgICByZXR1cm4gYXJyYXlJbmNsdWRlcyh2YWxpZGF0ZSh0aGlzKSwgc2VhcmNoRWxlbWVudCwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpO1xuICAgIH0sXG4gICAgam9pbjogZnVuY3Rpb24gam9pbihzZXBhcmF0b3IpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgcmV0dXJuIGFycmF5Sm9pbi5hcHBseSh2YWxpZGF0ZSh0aGlzKSwgYXJndW1lbnRzKTtcbiAgICB9LFxuICAgIGxhc3RJbmRleE9mOiBmdW5jdGlvbiBsYXN0SW5kZXhPZihzZWFyY2hFbGVtZW50IC8qICwgZnJvbUluZGV4ICovKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAgIHJldHVybiBhcnJheUxhc3RJbmRleE9mLmFwcGx5KHZhbGlkYXRlKHRoaXMpLCBhcmd1bWVudHMpO1xuICAgIH0sXG4gICAgbWFwOiBmdW5jdGlvbiBtYXAobWFwZm4gLyogLCB0aGlzQXJnICovKSB7XG4gICAgICByZXR1cm4gJG1hcCh2YWxpZGF0ZSh0aGlzKSwgbWFwZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTtcbiAgICB9LFxuICAgIHJlZHVjZTogZnVuY3Rpb24gcmVkdWNlKGNhbGxiYWNrZm4gLyogLCBpbml0aWFsVmFsdWUgKi8pIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgcmV0dXJuIGFycmF5UmVkdWNlLmFwcGx5KHZhbGlkYXRlKHRoaXMpLCBhcmd1bWVudHMpO1xuICAgIH0sXG4gICAgcmVkdWNlUmlnaHQ6IGZ1bmN0aW9uIHJlZHVjZVJpZ2h0KGNhbGxiYWNrZm4gLyogLCBpbml0aWFsVmFsdWUgKi8pIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgcmV0dXJuIGFycmF5UmVkdWNlUmlnaHQuYXBwbHkodmFsaWRhdGUodGhpcyksIGFyZ3VtZW50cyk7XG4gICAgfSxcbiAgICByZXZlcnNlOiBmdW5jdGlvbiByZXZlcnNlKCkge1xuICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgdmFyIGxlbmd0aCA9IHZhbGlkYXRlKHRoYXQpLmxlbmd0aDtcbiAgICAgIHZhciBtaWRkbGUgPSBNYXRoLmZsb29yKGxlbmd0aCAvIDIpO1xuICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgIHZhciB2YWx1ZTtcbiAgICAgIHdoaWxlIChpbmRleCA8IG1pZGRsZSkge1xuICAgICAgICB2YWx1ZSA9IHRoYXRbaW5kZXhdO1xuICAgICAgICB0aGF0W2luZGV4KytdID0gdGhhdFstLWxlbmd0aF07XG4gICAgICAgIHRoYXRbbGVuZ3RoXSA9IHZhbHVlO1xuICAgICAgfSByZXR1cm4gdGhhdDtcbiAgICB9LFxuICAgIHNvbWU6IGZ1bmN0aW9uIHNvbWUoY2FsbGJhY2tmbiAvKiAsIHRoaXNBcmcgKi8pIHtcbiAgICAgIHJldHVybiBhcnJheVNvbWUodmFsaWRhdGUodGhpcyksIGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTtcbiAgICB9LFxuICAgIHNvcnQ6IGZ1bmN0aW9uIHNvcnQoY29tcGFyZWZuKSB7XG4gICAgICByZXR1cm4gYXJyYXlTb3J0LmNhbGwodmFsaWRhdGUodGhpcyksIGNvbXBhcmVmbik7XG4gICAgfSxcbiAgICBzdWJhcnJheTogZnVuY3Rpb24gc3ViYXJyYXkoYmVnaW4sIGVuZCkge1xuICAgICAgdmFyIE8gPSB2YWxpZGF0ZSh0aGlzKTtcbiAgICAgIHZhciBsZW5ndGggPSBPLmxlbmd0aDtcbiAgICAgIHZhciAkYmVnaW4gPSB0b0Fic29sdXRlSW5kZXgoYmVnaW4sIGxlbmd0aCk7XG4gICAgICByZXR1cm4gbmV3IChzcGVjaWVzQ29uc3RydWN0b3IoTywgT1tERUZfQ09OU1RSVUNUT1JdKSkoXG4gICAgICAgIE8uYnVmZmVyLFxuICAgICAgICBPLmJ5dGVPZmZzZXQgKyAkYmVnaW4gKiBPLkJZVEVTX1BFUl9FTEVNRU5ULFxuICAgICAgICB0b0xlbmd0aCgoZW5kID09PSB1bmRlZmluZWQgPyBsZW5ndGggOiB0b0Fic29sdXRlSW5kZXgoZW5kLCBsZW5ndGgpKSAtICRiZWdpbilcbiAgICAgICk7XG4gICAgfVxuICB9O1xuXG4gIHZhciAkc2xpY2UgPSBmdW5jdGlvbiBzbGljZShzdGFydCwgZW5kKSB7XG4gICAgcmV0dXJuIHNwZWNpZXNGcm9tTGlzdCh0aGlzLCBhcnJheVNsaWNlLmNhbGwodmFsaWRhdGUodGhpcyksIHN0YXJ0LCBlbmQpKTtcbiAgfTtcblxuICB2YXIgJHNldCA9IGZ1bmN0aW9uIHNldChhcnJheUxpa2UgLyogLCBvZmZzZXQgKi8pIHtcbiAgICB2YWxpZGF0ZSh0aGlzKTtcbiAgICB2YXIgb2Zmc2V0ID0gdG9PZmZzZXQoYXJndW1lbnRzWzFdLCAxKTtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGg7XG4gICAgdmFyIHNyYyA9IHRvT2JqZWN0KGFycmF5TGlrZSk7XG4gICAgdmFyIGxlbiA9IHRvTGVuZ3RoKHNyYy5sZW5ndGgpO1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgaWYgKGxlbiArIG9mZnNldCA+IGxlbmd0aCkgdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19MRU5HVEgpO1xuICAgIHdoaWxlIChpbmRleCA8IGxlbikgdGhpc1tvZmZzZXQgKyBpbmRleF0gPSBzcmNbaW5kZXgrK107XG4gIH07XG5cbiAgdmFyICRpdGVyYXRvcnMgPSB7XG4gICAgZW50cmllczogZnVuY3Rpb24gZW50cmllcygpIHtcbiAgICAgIHJldHVybiBhcnJheUVudHJpZXMuY2FsbCh2YWxpZGF0ZSh0aGlzKSk7XG4gICAgfSxcbiAgICBrZXlzOiBmdW5jdGlvbiBrZXlzKCkge1xuICAgICAgcmV0dXJuIGFycmF5S2V5cy5jYWxsKHZhbGlkYXRlKHRoaXMpKTtcbiAgICB9LFxuICAgIHZhbHVlczogZnVuY3Rpb24gdmFsdWVzKCkge1xuICAgICAgcmV0dXJuIGFycmF5VmFsdWVzLmNhbGwodmFsaWRhdGUodGhpcykpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaXNUQUluZGV4ID0gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7XG4gICAgcmV0dXJuIGlzT2JqZWN0KHRhcmdldClcbiAgICAgICYmIHRhcmdldFtUWVBFRF9BUlJBWV1cbiAgICAgICYmIHR5cGVvZiBrZXkgIT0gJ3N5bWJvbCdcbiAgICAgICYmIGtleSBpbiB0YXJnZXRcbiAgICAgICYmIFN0cmluZygra2V5KSA9PSBTdHJpbmcoa2V5KTtcbiAgfTtcbiAgdmFyICRnZXREZXNjID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSB7XG4gICAgcmV0dXJuIGlzVEFJbmRleCh0YXJnZXQsIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSkpXG4gICAgICA/IHByb3BlcnR5RGVzYygyLCB0YXJnZXRba2V5XSlcbiAgICAgIDogZ09QRCh0YXJnZXQsIGtleSk7XG4gIH07XG4gIHZhciAkc2V0RGVzYyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgaWYgKGlzVEFJbmRleCh0YXJnZXQsIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSkpXG4gICAgICAmJiBpc09iamVjdChkZXNjKVxuICAgICAgJiYgaGFzKGRlc2MsICd2YWx1ZScpXG4gICAgICAmJiAhaGFzKGRlc2MsICdnZXQnKVxuICAgICAgJiYgIWhhcyhkZXNjLCAnc2V0JylcbiAgICAgIC8vIFRPRE86IGFkZCB2YWxpZGF0aW9uIGRlc2NyaXB0b3Igdy9vIGNhbGxpbmcgYWNjZXNzb3JzXG4gICAgICAmJiAhZGVzYy5jb25maWd1cmFibGVcbiAgICAgICYmICghaGFzKGRlc2MsICd3cml0YWJsZScpIHx8IGRlc2Mud3JpdGFibGUpXG4gICAgICAmJiAoIWhhcyhkZXNjLCAnZW51bWVyYWJsZScpIHx8IGRlc2MuZW51bWVyYWJsZSlcbiAgICApIHtcbiAgICAgIHRhcmdldFtrZXldID0gZGVzYy52YWx1ZTtcbiAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfSByZXR1cm4gZFAodGFyZ2V0LCBrZXksIGRlc2MpO1xuICB9O1xuXG4gIGlmICghQUxMX0NPTlNUUlVDVE9SUykge1xuICAgICRHT1BELmYgPSAkZ2V0RGVzYztcbiAgICAkRFAuZiA9ICRzZXREZXNjO1xuICB9XG5cbiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhQUxMX0NPTlNUUlVDVE9SUywgJ09iamVjdCcsIHtcbiAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXREZXNjLFxuICAgIGRlZmluZVByb3BlcnR5OiAkc2V0RGVzY1xuICB9KTtcblxuICBpZiAoZmFpbHMoZnVuY3Rpb24gKCkgeyBhcnJheVRvU3RyaW5nLmNhbGwoe30pOyB9KSkge1xuICAgIGFycmF5VG9TdHJpbmcgPSBhcnJheVRvTG9jYWxlU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgICByZXR1cm4gYXJyYXlKb2luLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgfVxuXG4gIHZhciAkVHlwZWRBcnJheVByb3RvdHlwZSQgPSByZWRlZmluZUFsbCh7fSwgcHJvdG8pO1xuICByZWRlZmluZUFsbCgkVHlwZWRBcnJheVByb3RvdHlwZSQsICRpdGVyYXRvcnMpO1xuICBoaWRlKCRUeXBlZEFycmF5UHJvdG90eXBlJCwgSVRFUkFUT1IsICRpdGVyYXRvcnMudmFsdWVzKTtcbiAgcmVkZWZpbmVBbGwoJFR5cGVkQXJyYXlQcm90b3R5cGUkLCB7XG4gICAgc2xpY2U6ICRzbGljZSxcbiAgICBzZXQ6ICRzZXQsXG4gICAgY29uc3RydWN0b3I6IGZ1bmN0aW9uICgpIHsgLyogbm9vcCAqLyB9LFxuICAgIHRvU3RyaW5nOiBhcnJheVRvU3RyaW5nLFxuICAgIHRvTG9jYWxlU3RyaW5nOiAkdG9Mb2NhbGVTdHJpbmdcbiAgfSk7XG4gIGFkZEdldHRlcigkVHlwZWRBcnJheVByb3RvdHlwZSQsICdidWZmZXInLCAnYicpO1xuICBhZGRHZXR0ZXIoJFR5cGVkQXJyYXlQcm90b3R5cGUkLCAnYnl0ZU9mZnNldCcsICdvJyk7XG4gIGFkZEdldHRlcigkVHlwZWRBcnJheVByb3RvdHlwZSQsICdieXRlTGVuZ3RoJywgJ2wnKTtcbiAgYWRkR2V0dGVyKCRUeXBlZEFycmF5UHJvdG90eXBlJCwgJ2xlbmd0aCcsICdlJyk7XG4gIGRQKCRUeXBlZEFycmF5UHJvdG90eXBlJCwgVEFHLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzW1RZUEVEX0FSUkFZXTsgfVxuICB9KTtcblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXN0YXRlbWVudHNcbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoS0VZLCBCWVRFUywgd3JhcHBlciwgQ0xBTVBFRCkge1xuICAgIENMQU1QRUQgPSAhIUNMQU1QRUQ7XG4gICAgdmFyIE5BTUUgPSBLRVkgKyAoQ0xBTVBFRCA/ICdDbGFtcGVkJyA6ICcnKSArICdBcnJheSc7XG4gICAgdmFyIEdFVFRFUiA9ICdnZXQnICsgS0VZO1xuICAgIHZhciBTRVRURVIgPSAnc2V0JyArIEtFWTtcbiAgICB2YXIgVHlwZWRBcnJheSA9IGdsb2JhbFtOQU1FXTtcbiAgICB2YXIgQmFzZSA9IFR5cGVkQXJyYXkgfHwge307XG4gICAgdmFyIFRBQyA9IFR5cGVkQXJyYXkgJiYgZ2V0UHJvdG90eXBlT2YoVHlwZWRBcnJheSk7XG4gICAgdmFyIEZPUkNFRCA9ICFUeXBlZEFycmF5IHx8ICEkdHlwZWQuQUJWO1xuICAgIHZhciBPID0ge307XG4gICAgdmFyIFR5cGVkQXJyYXlQcm90b3R5cGUgPSBUeXBlZEFycmF5ICYmIFR5cGVkQXJyYXlbUFJPVE9UWVBFXTtcbiAgICB2YXIgZ2V0dGVyID0gZnVuY3Rpb24gKHRoYXQsIGluZGV4KSB7XG4gICAgICB2YXIgZGF0YSA9IHRoYXQuX2Q7XG4gICAgICByZXR1cm4gZGF0YS52W0dFVFRFUl0oaW5kZXggKiBCWVRFUyArIGRhdGEubywgTElUVExFX0VORElBTik7XG4gICAgfTtcbiAgICB2YXIgc2V0dGVyID0gZnVuY3Rpb24gKHRoYXQsIGluZGV4LCB2YWx1ZSkge1xuICAgICAgdmFyIGRhdGEgPSB0aGF0Ll9kO1xuICAgICAgaWYgKENMQU1QRUQpIHZhbHVlID0gKHZhbHVlID0gTWF0aC5yb3VuZCh2YWx1ZSkpIDwgMCA/IDAgOiB2YWx1ZSA+IDB4ZmYgPyAweGZmIDogdmFsdWUgJiAweGZmO1xuICAgICAgZGF0YS52W1NFVFRFUl0oaW5kZXggKiBCWVRFUyArIGRhdGEubywgdmFsdWUsIExJVFRMRV9FTkRJQU4pO1xuICAgIH07XG4gICAgdmFyIGFkZEVsZW1lbnQgPSBmdW5jdGlvbiAodGhhdCwgaW5kZXgpIHtcbiAgICAgIGRQKHRoYXQsIGluZGV4LCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBnZXR0ZXIodGhpcywgaW5kZXgpO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiBzZXR0ZXIodGhpcywgaW5kZXgsIHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBpZiAoRk9SQ0VEKSB7XG4gICAgICBUeXBlZEFycmF5ID0gd3JhcHBlcihmdW5jdGlvbiAodGhhdCwgZGF0YSwgJG9mZnNldCwgJGxlbmd0aCkge1xuICAgICAgICBhbkluc3RhbmNlKHRoYXQsIFR5cGVkQXJyYXksIE5BTUUsICdfZCcpO1xuICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICAgICAgdmFyIGJ1ZmZlciwgYnl0ZUxlbmd0aCwgbGVuZ3RoLCBrbGFzcztcbiAgICAgICAgaWYgKCFpc09iamVjdChkYXRhKSkge1xuICAgICAgICAgIGxlbmd0aCA9IHRvSW5kZXgoZGF0YSk7XG4gICAgICAgICAgYnl0ZUxlbmd0aCA9IGxlbmd0aCAqIEJZVEVTO1xuICAgICAgICAgIGJ1ZmZlciA9IG5ldyAkQXJyYXlCdWZmZXIoYnl0ZUxlbmd0aCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YSBpbnN0YW5jZW9mICRBcnJheUJ1ZmZlciB8fCAoa2xhc3MgPSBjbGFzc29mKGRhdGEpKSA9PSBBUlJBWV9CVUZGRVIgfHwga2xhc3MgPT0gU0hBUkVEX0JVRkZFUikge1xuICAgICAgICAgIGJ1ZmZlciA9IGRhdGE7XG4gICAgICAgICAgb2Zmc2V0ID0gdG9PZmZzZXQoJG9mZnNldCwgQllURVMpO1xuICAgICAgICAgIHZhciAkbGVuID0gZGF0YS5ieXRlTGVuZ3RoO1xuICAgICAgICAgIGlmICgkbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmICgkbGVuICUgQllURVMpIHRocm93IFJhbmdlRXJyb3IoV1JPTkdfTEVOR1RIKTtcbiAgICAgICAgICAgIGJ5dGVMZW5ndGggPSAkbGVuIC0gb2Zmc2V0O1xuICAgICAgICAgICAgaWYgKGJ5dGVMZW5ndGggPCAwKSB0aHJvdyBSYW5nZUVycm9yKFdST05HX0xFTkdUSCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ5dGVMZW5ndGggPSB0b0xlbmd0aCgkbGVuZ3RoKSAqIEJZVEVTO1xuICAgICAgICAgICAgaWYgKGJ5dGVMZW5ndGggKyBvZmZzZXQgPiAkbGVuKSB0aHJvdyBSYW5nZUVycm9yKFdST05HX0xFTkdUSCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxlbmd0aCA9IGJ5dGVMZW5ndGggLyBCWVRFUztcbiAgICAgICAgfSBlbHNlIGlmIChUWVBFRF9BUlJBWSBpbiBkYXRhKSB7XG4gICAgICAgICAgcmV0dXJuIGZyb21MaXN0KFR5cGVkQXJyYXksIGRhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiAkZnJvbS5jYWxsKFR5cGVkQXJyYXksIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGhpZGUodGhhdCwgJ19kJywge1xuICAgICAgICAgIGI6IGJ1ZmZlcixcbiAgICAgICAgICBvOiBvZmZzZXQsXG4gICAgICAgICAgbDogYnl0ZUxlbmd0aCxcbiAgICAgICAgICBlOiBsZW5ndGgsXG4gICAgICAgICAgdjogbmV3ICREYXRhVmlldyhidWZmZXIpXG4gICAgICAgIH0pO1xuICAgICAgICB3aGlsZSAoaW5kZXggPCBsZW5ndGgpIGFkZEVsZW1lbnQodGhhdCwgaW5kZXgrKyk7XG4gICAgICB9KTtcbiAgICAgIFR5cGVkQXJyYXlQcm90b3R5cGUgPSBUeXBlZEFycmF5W1BST1RPVFlQRV0gPSBjcmVhdGUoJFR5cGVkQXJyYXlQcm90b3R5cGUkKTtcbiAgICAgIGhpZGUoVHlwZWRBcnJheVByb3RvdHlwZSwgJ2NvbnN0cnVjdG9yJywgVHlwZWRBcnJheSk7XG4gICAgfSBlbHNlIGlmICghZmFpbHMoZnVuY3Rpb24gKCkge1xuICAgICAgVHlwZWRBcnJheSgxKTtcbiAgICB9KSB8fCAhZmFpbHMoZnVuY3Rpb24gKCkge1xuICAgICAgbmV3IFR5cGVkQXJyYXkoLTEpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ld1xuICAgIH0pIHx8ICEkaXRlckRldGVjdChmdW5jdGlvbiAoaXRlcikge1xuICAgICAgbmV3IFR5cGVkQXJyYXkoKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXdcbiAgICAgIG5ldyBUeXBlZEFycmF5KG51bGwpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ld1xuICAgICAgbmV3IFR5cGVkQXJyYXkoMS41KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXdcbiAgICAgIG5ldyBUeXBlZEFycmF5KGl0ZXIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ld1xuICAgIH0sIHRydWUpKSB7XG4gICAgICBUeXBlZEFycmF5ID0gd3JhcHBlcihmdW5jdGlvbiAodGhhdCwgZGF0YSwgJG9mZnNldCwgJGxlbmd0aCkge1xuICAgICAgICBhbkluc3RhbmNlKHRoYXQsIFR5cGVkQXJyYXksIE5BTUUpO1xuICAgICAgICB2YXIga2xhc3M7XG4gICAgICAgIC8vIGB3c2AgbW9kdWxlIGJ1ZywgdGVtcG9yYXJpbHkgcmVtb3ZlIHZhbGlkYXRpb24gbGVuZ3RoIGZvciBVaW50OEFycmF5XG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJzb2NrZXRzL3dzL3B1bGwvNjQ1XG4gICAgICAgIGlmICghaXNPYmplY3QoZGF0YSkpIHJldHVybiBuZXcgQmFzZSh0b0luZGV4KGRhdGEpKTtcbiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiAkQXJyYXlCdWZmZXIgfHwgKGtsYXNzID0gY2xhc3NvZihkYXRhKSkgPT0gQVJSQVlfQlVGRkVSIHx8IGtsYXNzID09IFNIQVJFRF9CVUZGRVIpIHtcbiAgICAgICAgICByZXR1cm4gJGxlbmd0aCAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IG5ldyBCYXNlKGRhdGEsIHRvT2Zmc2V0KCRvZmZzZXQsIEJZVEVTKSwgJGxlbmd0aClcbiAgICAgICAgICAgIDogJG9mZnNldCAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgID8gbmV3IEJhc2UoZGF0YSwgdG9PZmZzZXQoJG9mZnNldCwgQllURVMpKVxuICAgICAgICAgICAgICA6IG5ldyBCYXNlKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChUWVBFRF9BUlJBWSBpbiBkYXRhKSByZXR1cm4gZnJvbUxpc3QoVHlwZWRBcnJheSwgZGF0YSk7XG4gICAgICAgIHJldHVybiAkZnJvbS5jYWxsKFR5cGVkQXJyYXksIGRhdGEpO1xuICAgICAgfSk7XG4gICAgICBhcnJheUZvckVhY2goVEFDICE9PSBGdW5jdGlvbi5wcm90b3R5cGUgPyBnT1BOKEJhc2UpLmNvbmNhdChnT1BOKFRBQykpIDogZ09QTihCYXNlKSwgZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBpZiAoIShrZXkgaW4gVHlwZWRBcnJheSkpIGhpZGUoVHlwZWRBcnJheSwga2V5LCBCYXNlW2tleV0pO1xuICAgICAgfSk7XG4gICAgICBUeXBlZEFycmF5W1BST1RPVFlQRV0gPSBUeXBlZEFycmF5UHJvdG90eXBlO1xuICAgICAgaWYgKCFMSUJSQVJZKSBUeXBlZEFycmF5UHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVHlwZWRBcnJheTtcbiAgICB9XG4gICAgdmFyICRuYXRpdmVJdGVyYXRvciA9IFR5cGVkQXJyYXlQcm90b3R5cGVbSVRFUkFUT1JdO1xuICAgIHZhciBDT1JSRUNUX0lURVJfTkFNRSA9ICEhJG5hdGl2ZUl0ZXJhdG9yXG4gICAgICAmJiAoJG5hdGl2ZUl0ZXJhdG9yLm5hbWUgPT0gJ3ZhbHVlcycgfHwgJG5hdGl2ZUl0ZXJhdG9yLm5hbWUgPT0gdW5kZWZpbmVkKTtcbiAgICB2YXIgJGl0ZXJhdG9yID0gJGl0ZXJhdG9ycy52YWx1ZXM7XG4gICAgaGlkZShUeXBlZEFycmF5LCBUWVBFRF9DT05TVFJVQ1RPUiwgdHJ1ZSk7XG4gICAgaGlkZShUeXBlZEFycmF5UHJvdG90eXBlLCBUWVBFRF9BUlJBWSwgTkFNRSk7XG4gICAgaGlkZShUeXBlZEFycmF5UHJvdG90eXBlLCBWSUVXLCB0cnVlKTtcbiAgICBoaWRlKFR5cGVkQXJyYXlQcm90b3R5cGUsIERFRl9DT05TVFJVQ1RPUiwgVHlwZWRBcnJheSk7XG5cbiAgICBpZiAoQ0xBTVBFRCA/IG5ldyBUeXBlZEFycmF5KDEpW1RBR10gIT0gTkFNRSA6ICEoVEFHIGluIFR5cGVkQXJyYXlQcm90b3R5cGUpKSB7XG4gICAgICBkUChUeXBlZEFycmF5UHJvdG90eXBlLCBUQUcsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBOQU1FOyB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBPW05BTUVdID0gVHlwZWRBcnJheTtcblxuICAgICRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogKFR5cGVkQXJyYXkgIT0gQmFzZSksIE8pO1xuXG4gICAgJGV4cG9ydCgkZXhwb3J0LlMsIE5BTUUsIHtcbiAgICAgIEJZVEVTX1BFUl9FTEVNRU5UOiBCWVRFU1xuICAgIH0pO1xuXG4gICAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbiAoKSB7IEJhc2Uub2YuY2FsbChUeXBlZEFycmF5LCAxKTsgfSksIE5BTUUsIHtcbiAgICAgIGZyb206ICRmcm9tLFxuICAgICAgb2Y6ICRvZlxuICAgIH0pO1xuXG4gICAgaWYgKCEoQllURVNfUEVSX0VMRU1FTlQgaW4gVHlwZWRBcnJheVByb3RvdHlwZSkpIGhpZGUoVHlwZWRBcnJheVByb3RvdHlwZSwgQllURVNfUEVSX0VMRU1FTlQsIEJZVEVTKTtcblxuICAgICRleHBvcnQoJGV4cG9ydC5QLCBOQU1FLCBwcm90byk7XG5cbiAgICBzZXRTcGVjaWVzKE5BTUUpO1xuXG4gICAgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiBGT1JDRURfU0VULCBOQU1FLCB7IHNldDogJHNldCB9KTtcblxuICAgICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogIUNPUlJFQ1RfSVRFUl9OQU1FLCBOQU1FLCAkaXRlcmF0b3JzKTtcblxuICAgIGlmICghTElCUkFSWSAmJiBUeXBlZEFycmF5UHJvdG90eXBlLnRvU3RyaW5nICE9IGFycmF5VG9TdHJpbmcpIFR5cGVkQXJyYXlQcm90b3R5cGUudG9TdHJpbmcgPSBhcnJheVRvU3RyaW5nO1xuXG4gICAgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbiAoKSB7XG4gICAgICBuZXcgVHlwZWRBcnJheSgxKS5zbGljZSgpO1xuICAgIH0pLCBOQU1FLCB7IHNsaWNlOiAkc2xpY2UgfSk7XG5cbiAgICAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChmYWlscyhmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gWzEsIDJdLnRvTG9jYWxlU3RyaW5nKCkgIT0gbmV3IFR5cGVkQXJyYXkoWzEsIDJdKS50b0xvY2FsZVN0cmluZygpO1xuICAgIH0pIHx8ICFmYWlscyhmdW5jdGlvbiAoKSB7XG4gICAgICBUeXBlZEFycmF5UHJvdG90eXBlLnRvTG9jYWxlU3RyaW5nLmNhbGwoWzEsIDJdKTtcbiAgICB9KSksIE5BTUUsIHsgdG9Mb2NhbGVTdHJpbmc6ICR0b0xvY2FsZVN0cmluZyB9KTtcblxuICAgIEl0ZXJhdG9yc1tOQU1FXSA9IENPUlJFQ1RfSVRFUl9OQU1FID8gJG5hdGl2ZUl0ZXJhdG9yIDogJGl0ZXJhdG9yO1xuICAgIGlmICghTElCUkFSWSAmJiAhQ09SUkVDVF9JVEVSX05BTUUpIGhpZGUoVHlwZWRBcnJheVByb3RvdHlwZSwgSVRFUkFUT1IsICRpdGVyYXRvcik7XG4gIH07XG59IGVsc2UgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7IC8qIGVtcHR5ICovIH07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///26\n")},function(module,exports,__webpack_require__){eval("// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = __webpack_require__(4);\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190by1wcmltaXRpdmUuanM/NmE5OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSlcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xuLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2Vcbi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwgUykge1xuICBpZiAoIWlzT2JqZWN0KGl0KSkgcmV0dXJuIGl0O1xuICB2YXIgZm4sIHZhbDtcbiAgaWYgKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIGlmICh0eXBlb2YgKGZuID0gaXQudmFsdWVPZikgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKSByZXR1cm4gdmFsO1xuICBpZiAoIVMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZVwiKTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///27\n")},function(module,exports,__webpack_require__){eval("var META = __webpack_require__(30)('meta');\nvar isObject = __webpack_require__(4);\nvar has = __webpack_require__(13);\nvar setDesc = __webpack_require__(7).f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !__webpack_require__(2)(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19tZXRhLmpzPzY3YWIiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIE1FVEEgPSByZXF1aXJlKCcuL191aWQnKSgnbWV0YScpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgaGFzID0gcmVxdWlyZSgnLi9faGFzJyk7XG52YXIgc2V0RGVzYyA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmY7XG52YXIgaWQgPSAwO1xudmFyIGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGUgfHwgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdHJ1ZTtcbn07XG52YXIgRlJFRVpFID0gIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gaXNFeHRlbnNpYmxlKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpO1xufSk7XG52YXIgc2V0TWV0YSA9IGZ1bmN0aW9uIChpdCkge1xuICBzZXREZXNjKGl0LCBNRVRBLCB7IHZhbHVlOiB7XG4gICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElEXG4gICAgdzoge30gICAgICAgICAgLy8gd2VhayBjb2xsZWN0aW9ucyBJRHNcbiAgfSB9KTtcbn07XG52YXIgZmFzdEtleSA9IGZ1bmN0aW9uIChpdCwgY3JlYXRlKSB7XG4gIC8vIHJldHVybiBwcmltaXRpdmUgd2l0aCBwcmVmaXhcbiAgaWYgKCFpc09iamVjdChpdCkpIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCcgPyBpdCA6ICh0eXBlb2YgaXQgPT0gJ3N0cmluZycgPyAnUycgOiAnUCcpICsgaXQ7XG4gIGlmICghaGFzKGl0LCBNRVRBKSkge1xuICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0XG4gICAgaWYgKCFpc0V4dGVuc2libGUoaXQpKSByZXR1cm4gJ0YnO1xuICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhXG4gICAgaWYgKCFjcmVhdGUpIHJldHVybiAnRSc7XG4gICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGFcbiAgICBzZXRNZXRhKGl0KTtcbiAgLy8gcmV0dXJuIG9iamVjdCBJRFxuICB9IHJldHVybiBpdFtNRVRBXS5pO1xufTtcbnZhciBnZXRXZWFrID0gZnVuY3Rpb24gKGl0LCBjcmVhdGUpIHtcbiAgaWYgKCFoYXMoaXQsIE1FVEEpKSB7XG4gICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3RcbiAgICBpZiAoIWlzRXh0ZW5zaWJsZShpdCkpIHJldHVybiB0cnVlO1xuICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhXG4gICAgaWYgKCFjcmVhdGUpIHJldHVybiBmYWxzZTtcbiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YVxuICAgIHNldE1ldGEoaXQpO1xuICAvLyByZXR1cm4gaGFzaCB3ZWFrIGNvbGxlY3Rpb25zIElEc1xuICB9IHJldHVybiBpdFtNRVRBXS53O1xufTtcbi8vIGFkZCBtZXRhZGF0YSBvbiBmcmVlemUtZmFtaWx5IG1ldGhvZHMgY2FsbGluZ1xudmFyIG9uRnJlZXplID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmIChGUkVFWkUgJiYgbWV0YS5ORUVEICYmIGlzRXh0ZW5zaWJsZShpdCkgJiYgIWhhcyhpdCwgTUVUQSkpIHNldE1ldGEoaXQpO1xuICByZXR1cm4gaXQ7XG59O1xudmFyIG1ldGEgPSBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgS0VZOiBNRVRBLFxuICBORUVEOiBmYWxzZSxcbiAgZmFzdEtleTogZmFzdEtleSxcbiAgZ2V0V2VhazogZ2V0V2VhayxcbiAgb25GcmVlemU6IG9uRnJlZXplXG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///28\n")},function(module,exports){eval("module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19wcm9wZXJ0eS1kZXNjLmpzPzQ2MzAiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYml0bWFwLCB2YWx1ZSkge1xuICByZXR1cm4ge1xuICAgIGVudW1lcmFibGU6ICEoYml0bWFwICYgMSksXG4gICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLFxuICAgIHdyaXRhYmxlOiAhKGJpdG1hcCAmIDQpLFxuICAgIHZhbHVlOiB2YWx1ZVxuICB9O1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///29\n")},function(module,exports){eval("var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL191aWQuanM/Y2E1YSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgaWQgPSAwO1xudmFyIHB4ID0gTWF0aC5yYW5kb20oKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///30\n")},function(module,exports){eval("module.exports = false;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19saWJyYXJ5LmpzPzJkMDAiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmYWxzZTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///31\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = __webpack_require__(86);\nvar enumBugKeys = __webpack_require__(61);\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3Qta2V5cy5qcz8wZDU4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi4xNCAvIDE1LjIuMy4xNCBPYmplY3Qua2V5cyhPKVxudmFyICRrZXlzID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwnKTtcbnZhciBlbnVtQnVnS2V5cyA9IHJlcXVpcmUoJy4vX2VudW0tYnVnLWtleXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pIHtcbiAgcmV0dXJuICRrZXlzKE8sIGVudW1CdWdLZXlzKTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///32\n")},function(module,exports,__webpack_require__){eval("var toInteger = __webpack_require__(25);\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190by1hYnNvbHV0ZS1pbmRleC5qcz83N2YxIl0sInNvdXJjZXNDb250ZW50IjpbInZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJyk7XG52YXIgbWF4ID0gTWF0aC5tYXg7XG52YXIgbWluID0gTWF0aC5taW47XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpbmRleCwgbGVuZ3RoKSB7XG4gIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTtcbiAgcmV0dXJuIGluZGV4IDwgMCA/IG1heChpbmRleCArIGxlbmd0aCwgMCkgOiBtaW4oaW5kZXgsIGxlbmd0aCk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///33\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = __webpack_require__(5);\nvar dPs = __webpack_require__(87);\nvar enumBugKeys = __webpack_require__(61);\nvar IE_PROTO = __webpack_require__(60)('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = __webpack_require__(57)('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  __webpack_require__(63).appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtY3JlYXRlLmpzPzJhZWIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pXG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBkUHMgPSByZXF1aXJlKCcuL19vYmplY3QtZHBzJyk7XG52YXIgZW51bUJ1Z0tleXMgPSByZXF1aXJlKCcuL19lbnVtLWJ1Zy1rZXlzJyk7XG52YXIgSUVfUFJPVE8gPSByZXF1aXJlKCcuL19zaGFyZWQta2V5JykoJ0lFX1BST1RPJyk7XG52YXIgRW1wdHkgPSBmdW5jdGlvbiAoKSB7IC8qIGVtcHR5ICovIH07XG52YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7XG5cbi8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBpZnJhbWUgT2JqZWN0IHdpdGggY2xlYXJlZCBwcm90b3R5cGVcbnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24gKCkge1xuICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1Z1xuICB2YXIgaWZyYW1lID0gcmVxdWlyZSgnLi9fZG9tLWNyZWF0ZScpKCdpZnJhbWUnKTtcbiAgdmFyIGkgPSBlbnVtQnVnS2V5cy5sZW5ndGg7XG4gIHZhciBsdCA9ICc8JztcbiAgdmFyIGd0ID0gJz4nO1xuICB2YXIgaWZyYW1lRG9jdW1lbnQ7XG4gIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICByZXF1aXJlKCcuL19odG1sJykuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgaWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0Oic7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2NyaXB0LXVybFxuICAvLyBjcmVhdGVEaWN0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuT2JqZWN0O1xuICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7XG4gIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gIGlmcmFtZURvY3VtZW50Lm9wZW4oKTtcbiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpO1xuICBpZnJhbWVEb2N1bWVudC5jbG9zZSgpO1xuICBjcmVhdGVEaWN0ID0gaWZyYW1lRG9jdW1lbnQuRjtcbiAgd2hpbGUgKGktLSkgZGVsZXRlIGNyZWF0ZURpY3RbUFJPVE9UWVBFXVtlbnVtQnVnS2V5c1tpXV07XG4gIHJldHVybiBjcmVhdGVEaWN0KCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpIHtcbiAgdmFyIHJlc3VsdDtcbiAgaWYgKE8gIT09IG51bGwpIHtcbiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7XG4gICAgcmVzdWx0ID0gbmV3IEVtcHR5KCk7XG4gICAgRW1wdHlbUFJPVE9UWVBFXSA9IG51bGw7XG4gICAgLy8gYWRkIFwiX19wcm90b19fXCIgZm9yIE9iamVjdC5nZXRQcm90b3R5cGVPZiBwb2x5ZmlsbFxuICAgIHJlc3VsdFtJRV9QUk9UT10gPSBPO1xuICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpO1xuICByZXR1cm4gUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkID8gcmVzdWx0IDogZFBzKHJlc3VsdCwgUHJvcGVydGllcyk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///34\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = __webpack_require__(86);\nvar hiddenKeys = __webpack_require__(61).concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtZ29wbi5qcz85MDkzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi43IC8gMTUuMi4zLjQgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTylcbnZhciAka2V5cyA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzLWludGVybmFsJyk7XG52YXIgaGlkZGVuS2V5cyA9IHJlcXVpcmUoJy4vX2VudW0tYnVnLWtleXMnKS5jb25jYXQoJ2xlbmd0aCcsICdwcm90b3R5cGUnKTtcblxuZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhPKSB7XG4gIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///35\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = __webpack_require__(13);\nvar toObject = __webpack_require__(16);\nvar IE_PROTO = __webpack_require__(60)('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtZ3BvLmpzPzM4ZmQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMTkuMS4yLjkgLyAxNS4yLjMuMiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTylcbnZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyIElFX1BST1RPID0gcmVxdWlyZSgnLi9fc2hhcmVkLWtleScpKCdJRV9QUk9UTycpO1xudmFyIE9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKE8pIHtcbiAgTyA9IHRvT2JqZWN0KE8pO1xuICBpZiAoaGFzKE8sIElFX1BST1RPKSkgcmV0dXJuIE9bSUVfUFJPVE9dO1xuICBpZiAodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcikge1xuICAgIHJldHVybiBPLmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///36\n")},function(module,exports,__webpack_require__){eval("var def = __webpack_require__(7).f;\nvar has = __webpack_require__(13);\nvar TAG = __webpack_require__(6)('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zZXQtdG8tc3RyaW5nLXRhZy5qcz83ZjIwIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBkZWYgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIFRBRyA9IHJlcXVpcmUoJy4vX3drcycpKCd0b1N0cmluZ1RhZycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwgdGFnLCBzdGF0KSB7XG4gIGlmIChpdCAmJiAhaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKSBkZWYoaXQsIFRBRywgeyBjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWcgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///37\n")},function(module,exports){eval("module.exports = {};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pdGVyYXRvcnMuanM/ODRmMiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHt9O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///38\n")},function(module,exports,__webpack_require__){eval("// 22.1.3.31 Array.prototype[@@unscopables]\nvar UNSCOPABLES = __webpack_require__(6)('unscopables');\nvar ArrayProto = Array.prototype;\nif (ArrayProto[UNSCOPABLES] == undefined) __webpack_require__(14)(ArrayProto, UNSCOPABLES, {});\nmodule.exports = function (key) {\n  ArrayProto[UNSCOPABLES][key] = true;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19hZGQtdG8tdW5zY29wYWJsZXMuanM/OWM2YyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMi4xLjMuMzEgQXJyYXkucHJvdG90eXBlW0BAdW5zY29wYWJsZXNdXG52YXIgVU5TQ09QQUJMRVMgPSByZXF1aXJlKCcuL193a3MnKSgndW5zY29wYWJsZXMnKTtcbnZhciBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlO1xuaWYgKEFycmF5UHJvdG9bVU5TQ09QQUJMRVNdID09IHVuZGVmaW5lZCkgcmVxdWlyZSgnLi9faGlkZScpKEFycmF5UHJvdG8sIFVOU0NPUEFCTEVTLCB7fSk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgQXJyYXlQcm90b1tVTlNDT1BBQkxFU11ba2V5XSA9IHRydWU7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///39\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar global = __webpack_require__(3);\nvar dP = __webpack_require__(7);\nvar DESCRIPTORS = __webpack_require__(8);\nvar SPECIES = __webpack_require__(6)('species');\n\nmodule.exports = function (KEY) {\n  var C = global[KEY];\n  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zZXQtc3BlY2llcy5qcz83YTU2Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBkUCA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpO1xudmFyIERFU0NSSVBUT1JTID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKTtcbnZhciBTUEVDSUVTID0gcmVxdWlyZSgnLi9fd2tzJykoJ3NwZWNpZXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoS0VZKSB7XG4gIHZhciBDID0gZ2xvYmFsW0tFWV07XG4gIGlmIChERVNDUklQVE9SUyAmJiBDICYmICFDW1NQRUNJRVNdKSBkUC5mKEMsIFNQRUNJRVMsIHtcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///40\n")},function(module,exports){eval("module.exports = function (it, Constructor, name, forbiddenField) {\n  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19hbi1pbnN0YW5jZS5qcz9mNjA1Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpIHtcbiAgaWYgKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKSB7XG4gICAgdGhyb3cgVHlwZUVycm9yKG5hbWUgKyAnOiBpbmNvcnJlY3QgaW52b2NhdGlvbiEnKTtcbiAgfSByZXR1cm4gaXQ7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///41\n")},function(module,exports,__webpack_require__){eval("var redefine = __webpack_require__(11);\nmodule.exports = function (target, src, safe) {\n  for (var key in src) redefine(target, key, src[key], safe);\n  return target;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19yZWRlZmluZS1hbGwuanM/ZGNiYyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgcmVkZWZpbmUgPSByZXF1aXJlKCcuL19yZWRlZmluZScpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodGFyZ2V0LCBzcmMsIHNhZmUpIHtcbiAgZm9yICh2YXIga2V5IGluIHNyYykgcmVkZWZpbmUodGFyZ2V0LCBrZXksIHNyY1trZXldLCBzYWZlKTtcbiAgcmV0dXJuIHRhcmdldDtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///42\n")},function(module,exports,__webpack_require__){eval("var isObject = __webpack_require__(4);\nmodule.exports = function (it, TYPE) {\n  if (!isObject(it) || it._t !== TYPE) throw TypeError('Incompatible receiver, ' + TYPE + ' required!');\n  return it;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL192YWxpZGF0ZS1jb2xsZWN0aW9uLmpzP2IzOWEiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwgVFlQRSkge1xuICBpZiAoIWlzT2JqZWN0KGl0KSB8fCBpdC5fdCAhPT0gVFlQRSkgdGhyb3cgVHlwZUVycm9yKCdJbmNvbXBhdGlibGUgcmVjZWl2ZXIsICcgKyBUWVBFICsgJyByZXF1aXJlZCEnKTtcbiAgcmV0dXJuIGl0O1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///43\n")},function(module,exports,__webpack_require__){eval("// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = __webpack_require__(23);\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pb2JqZWN0LmpzPzYyNmEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBhbmQgbm9uLWVudW1lcmFibGUgb2xkIFY4IHN0cmluZ3NcbnZhciBjb2YgPSByZXF1aXJlKCcuL19jb2YnKTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGNvZihpdCkgPT0gJ1N0cmluZycgPyBpdC5zcGxpdCgnJykgOiBPYmplY3QoaXQpO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///44\n")},function(module,exports){eval("exports.f = {}.propertyIsEnumerable;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtcGllLmpzPzUyYTciXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0cy5mID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7XG4iXSwibWFwcGluZ3MiOiJBQUFBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///45\n")},function(module,exports,__webpack_require__){eval("// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = __webpack_require__(15);\nvar toLength = __webpack_require__(10);\nvar toAbsoluteIndex = __webpack_require__(33);\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19hcnJheS1pbmNsdWRlcy5qcz9jMzY2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGZhbHNlIC0+IEFycmF5I2luZGV4T2Zcbi8vIHRydWUgIC0+IEFycmF5I2luY2x1ZGVzXG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyIHRvTGVuZ3RoID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJyk7XG52YXIgdG9BYnNvbHV0ZUluZGV4ID0gcmVxdWlyZSgnLi9fdG8tYWJzb2x1dGUtaW5kZXgnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKElTX0lOQ0xVREVTKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoJHRoaXMsIGVsLCBmcm9tSW5kZXgpIHtcbiAgICB2YXIgTyA9IHRvSU9iamVjdCgkdGhpcyk7XG4gICAgdmFyIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKTtcbiAgICB2YXIgaW5kZXggPSB0b0Fic29sdXRlSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpO1xuICAgIHZhciB2YWx1ZTtcbiAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtY29tcGFyZVxuICAgIGlmIChJU19JTkNMVURFUyAmJiBlbCAhPSBlbCkgd2hpbGUgKGxlbmd0aCA+IGluZGV4KSB7XG4gICAgICB2YWx1ZSA9IE9baW5kZXgrK107XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgICBpZiAodmFsdWUgIT0gdmFsdWUpIHJldHVybiB0cnVlO1xuICAgIC8vIEFycmF5I2luZGV4T2YgaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3RcbiAgICB9IGVsc2UgZm9yICg7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIGlmIChJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKSB7XG4gICAgICBpZiAoT1tpbmRleF0gPT09IGVsKSByZXR1cm4gSVNfSU5DTFVERVMgfHwgaW5kZXggfHwgMDtcbiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7XG4gIH07XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///46\n")},function(module,exports){eval("exports.f = Object.getOwnPropertySymbols;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtZ29wcy5qcz8yNjIxIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG4iXSwibWFwcGluZ3MiOiJBQUFBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///47\n")},function(module,exports,__webpack_require__){eval("// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = __webpack_require__(23);\nvar TAG = __webpack_require__(6)('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19jbGFzc29mLmpzPzIzYzYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZ2V0dGluZyB0YWcgZnJvbSAxOS4xLjMuNiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKClcbnZhciBjb2YgPSByZXF1aXJlKCcuL19jb2YnKTtcbnZhciBUQUcgPSByZXF1aXJlKCcuL193a3MnKSgndG9TdHJpbmdUYWcnKTtcbi8vIEVTMyB3cm9uZyBoZXJlXG52YXIgQVJHID0gY29mKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJztcblxuLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3JcbnZhciB0cnlHZXQgPSBmdW5jdGlvbiAoaXQsIGtleSkge1xuICB0cnkge1xuICAgIHJldHVybiBpdFtrZXldO1xuICB9IGNhdGNoIChlKSB7IC8qIGVtcHR5ICovIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHZhciBPLCBULCBCO1xuICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogaXQgPT09IG51bGwgPyAnTnVsbCdcbiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2VcbiAgICA6IHR5cGVvZiAoVCA9IHRyeUdldChPID0gT2JqZWN0KGl0KSwgVEFHKSkgPT0gJ3N0cmluZycgPyBUXG4gICAgLy8gYnVpbHRpblRhZyBjYXNlXG4gICAgOiBBUkcgPyBjb2YoTylcbiAgICAvLyBFUzMgYXJndW1lbnRzIGZhbGxiYWNrXG4gICAgOiAoQiA9IGNvZihPKSkgPT0gJ09iamVjdCcgJiYgdHlwZW9mIE8uY2FsbGVlID09ICdmdW5jdGlvbicgPyAnQXJndW1lbnRzJyA6IEI7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///48\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar defined = __webpack_require__(24);\nvar fails = __webpack_require__(2);\nvar spaces = __webpack_require__(65);\nvar space = '[' + spaces + ']';\nvar non = '\\u200b\\u0085';\nvar ltrim = RegExp('^' + space + space + '*');\nvar rtrim = RegExp(space + space + '*$');\n\nvar exporter = function (KEY, exec, ALIAS) {\n  var exp = {};\n  var FORCE = fails(function () {\n    return !!spaces[KEY]() || non[KEY]() != non;\n  });\n  var fn = exp[KEY] = FORCE ? exec(trim) : spaces[KEY];\n  if (ALIAS) exp[ALIAS] = fn;\n  $export($export.P + $export.F * FORCE, 'String', exp);\n};\n\n// 1 -> String#trimLeft\n// 2 -> String#trimRight\n// 3 -> String#trim\nvar trim = exporter.trim = function (string, TYPE) {\n  string = String(defined(string));\n  if (TYPE & 1) string = string.replace(ltrim, '');\n  if (TYPE & 2) string = string.replace(rtrim, '');\n  return string;\n};\n\nmodule.exports = exporter;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zdHJpbmctdHJpbS5qcz9hYTc3Il0sInNvdXJjZXNDb250ZW50IjpbInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgZGVmaW5lZCA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTtcbnZhciBmYWlscyA9IHJlcXVpcmUoJy4vX2ZhaWxzJyk7XG52YXIgc3BhY2VzID0gcmVxdWlyZSgnLi9fc3RyaW5nLXdzJyk7XG52YXIgc3BhY2UgPSAnWycgKyBzcGFjZXMgKyAnXSc7XG52YXIgbm9uID0gJ1xcdTIwMGJcXHUwMDg1JztcbnZhciBsdHJpbSA9IFJlZ0V4cCgnXicgKyBzcGFjZSArIHNwYWNlICsgJyonKTtcbnZhciBydHJpbSA9IFJlZ0V4cChzcGFjZSArIHNwYWNlICsgJyokJyk7XG5cbnZhciBleHBvcnRlciA9IGZ1bmN0aW9uIChLRVksIGV4ZWMsIEFMSUFTKSB7XG4gIHZhciBleHAgPSB7fTtcbiAgdmFyIEZPUkNFID0gZmFpbHMoZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAhIXNwYWNlc1tLRVldKCkgfHwgbm9uW0tFWV0oKSAhPSBub247XG4gIH0pO1xuICB2YXIgZm4gPSBleHBbS0VZXSA9IEZPUkNFID8gZXhlYyh0cmltKSA6IHNwYWNlc1tLRVldO1xuICBpZiAoQUxJQVMpIGV4cFtBTElBU10gPSBmbjtcbiAgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiBGT1JDRSwgJ1N0cmluZycsIGV4cCk7XG59O1xuXG4vLyAxIC0+IFN0cmluZyN0cmltTGVmdFxuLy8gMiAtPiBTdHJpbmcjdHJpbVJpZ2h0XG4vLyAzIC0+IFN0cmluZyN0cmltXG52YXIgdHJpbSA9IGV4cG9ydGVyLnRyaW0gPSBmdW5jdGlvbiAoc3RyaW5nLCBUWVBFKSB7XG4gIHN0cmluZyA9IFN0cmluZyhkZWZpbmVkKHN0cmluZykpO1xuICBpZiAoVFlQRSAmIDEpIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKGx0cmltLCAnJyk7XG4gIGlmIChUWVBFICYgMikgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UocnRyaW0sICcnKTtcbiAgcmV0dXJuIHN0cmluZztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0ZXI7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///49\n")},function(module,exports,__webpack_require__){eval("var ITERATOR = __webpack_require__(6)('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pdGVyLWRldGVjdC5qcz81Y2M1Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBJVEVSQVRPUiA9IHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpO1xudmFyIFNBRkVfQ0xPU0lORyA9IGZhbHNlO1xuXG50cnkge1xuICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7XG4gIHJpdGVyWydyZXR1cm4nXSA9IGZ1bmN0aW9uICgpIHsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXRocm93LWxpdGVyYWxcbiAgQXJyYXkuZnJvbShyaXRlciwgZnVuY3Rpb24gKCkgeyB0aHJvdyAyOyB9KTtcbn0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChleGVjLCBza2lwQ2xvc2luZykge1xuICBpZiAoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpIHJldHVybiBmYWxzZTtcbiAgdmFyIHNhZmUgPSBmYWxzZTtcbiAgdHJ5IHtcbiAgICB2YXIgYXJyID0gWzddO1xuICAgIHZhciBpdGVyID0gYXJyW0lURVJBVE9SXSgpO1xuICAgIGl0ZXIubmV4dCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHsgZG9uZTogc2FmZSA9IHRydWUgfTsgfTtcbiAgICBhcnJbSVRFUkFUT1JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gaXRlcjsgfTtcbiAgICBleGVjKGFycik7XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxuICByZXR1cm4gc2FmZTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///50\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar hide = __webpack_require__(14);\nvar redefine = __webpack_require__(11);\nvar fails = __webpack_require__(2);\nvar defined = __webpack_require__(24);\nvar wks = __webpack_require__(6);\n\nmodule.exports = function (KEY, length, exec) {\n  var SYMBOL = wks(KEY);\n  var fns = exec(defined, SYMBOL, ''[KEY]);\n  var strfn = fns[0];\n  var rxfn = fns[1];\n  if (fails(function () {\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  })) {\n    redefine(String.prototype, KEY, strfn);\n    hide(RegExp.prototype, SYMBOL, length == 2\n      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)\n      // 21.2.5.11 RegExp.prototype[@@split](string, limit)\n      ? function (string, arg) { return rxfn.call(string, this, arg); }\n      // 21.2.5.6 RegExp.prototype[@@match](string)\n      // 21.2.5.9 RegExp.prototype[@@search](string)\n      : function (string) { return rxfn.call(string, this); }\n    );\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19maXgtcmUtd2tzLmpzPzIxNGYiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIGhpZGUgPSByZXF1aXJlKCcuL19oaWRlJyk7XG52YXIgcmVkZWZpbmUgPSByZXF1aXJlKCcuL19yZWRlZmluZScpO1xudmFyIGZhaWxzID0gcmVxdWlyZSgnLi9fZmFpbHMnKTtcbnZhciBkZWZpbmVkID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpO1xudmFyIHdrcyA9IHJlcXVpcmUoJy4vX3drcycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChLRVksIGxlbmd0aCwgZXhlYykge1xuICB2YXIgU1lNQk9MID0gd2tzKEtFWSk7XG4gIHZhciBmbnMgPSBleGVjKGRlZmluZWQsIFNZTUJPTCwgJydbS0VZXSk7XG4gIHZhciBzdHJmbiA9IGZuc1swXTtcbiAgdmFyIHJ4Zm4gPSBmbnNbMV07XG4gIGlmIChmYWlscyhmdW5jdGlvbiAoKSB7XG4gICAgdmFyIE8gPSB7fTtcbiAgICBPW1NZTUJPTF0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiA3OyB9O1xuICAgIHJldHVybiAnJ1tLRVldKE8pICE9IDc7XG4gIH0pKSB7XG4gICAgcmVkZWZpbmUoU3RyaW5nLnByb3RvdHlwZSwgS0VZLCBzdHJmbik7XG4gICAgaGlkZShSZWdFeHAucHJvdG90eXBlLCBTWU1CT0wsIGxlbmd0aCA9PSAyXG4gICAgICAvLyAyMS4yLjUuOCBSZWdFeHAucHJvdG90eXBlW0BAcmVwbGFjZV0oc3RyaW5nLCByZXBsYWNlVmFsdWUpXG4gICAgICAvLyAyMS4yLjUuMTEgUmVnRXhwLnByb3RvdHlwZVtAQHNwbGl0XShzdHJpbmcsIGxpbWl0KVxuICAgICAgPyBmdW5jdGlvbiAoc3RyaW5nLCBhcmcpIHsgcmV0dXJuIHJ4Zm4uY2FsbChzdHJpbmcsIHRoaXMsIGFyZyk7IH1cbiAgICAgIC8vIDIxLjIuNS42IFJlZ0V4cC5wcm90b3R5cGVbQEBtYXRjaF0oc3RyaW5nKVxuICAgICAgLy8gMjEuMi41LjkgUmVnRXhwLnByb3RvdHlwZVtAQHNlYXJjaF0oc3RyaW5nKVxuICAgICAgOiBmdW5jdGlvbiAoc3RyaW5nKSB7IHJldHVybiByeGZuLmNhbGwoc3RyaW5nLCB0aGlzKTsgfVxuICAgICk7XG4gIH1cbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///51\n")},function(module,exports,__webpack_require__){eval("var ctx = __webpack_require__(21);\nvar call = __webpack_require__(99);\nvar isArrayIter = __webpack_require__(74);\nvar anObject = __webpack_require__(5);\nvar toLength = __webpack_require__(10);\nvar getIterFn = __webpack_require__(76);\nvar BREAK = {};\nvar RETURN = {};\nvar exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {\n  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);\n  var f = ctx(fn, that, entries ? 2 : 1);\n  var index = 0;\n  var length, step, iterator, result;\n  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if (result === BREAK || result === RETURN) return result;\n  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {\n    result = call(iterator, f, step.value, entries);\n    if (result === BREAK || result === RETURN) return result;\n  }\n};\nexports.BREAK = BREAK;\nexports.RETURN = RETURN;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19mb3Itb2YuanM/NGE1OSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY3R4ID0gcmVxdWlyZSgnLi9fY3R4Jyk7XG52YXIgY2FsbCA9IHJlcXVpcmUoJy4vX2l0ZXItY2FsbCcpO1xudmFyIGlzQXJyYXlJdGVyID0gcmVxdWlyZSgnLi9faXMtYXJyYXktaXRlcicpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcbnZhciBnZXRJdGVyRm4gPSByZXF1aXJlKCcuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCcpO1xudmFyIEJSRUFLID0ge307XG52YXIgUkVUVVJOID0ge307XG52YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCwgSVRFUkFUT1IpIHtcbiAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24gKCkgeyByZXR1cm4gaXRlcmFibGU7IH0gOiBnZXRJdGVyRm4oaXRlcmFibGUpO1xuICB2YXIgZiA9IGN0eChmbiwgdGhhdCwgZW50cmllcyA/IDIgOiAxKTtcbiAgdmFyIGluZGV4ID0gMDtcbiAgdmFyIGxlbmd0aCwgc3RlcCwgaXRlcmF0b3IsIHJlc3VsdDtcbiAgaWYgKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJykgdGhyb3cgVHlwZUVycm9yKGl0ZXJhYmxlICsgJyBpcyBub3QgaXRlcmFibGUhJyk7XG4gIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvclxuICBpZiAoaXNBcnJheUl0ZXIoaXRlckZuKSkgZm9yIChsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKykge1xuICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTtcbiAgICBpZiAocmVzdWx0ID09PSBCUkVBSyB8fCByZXN1bHQgPT09IFJFVFVSTikgcmV0dXJuIHJlc3VsdDtcbiAgfSBlbHNlIGZvciAoaXRlcmF0b3IgPSBpdGVyRm4uY2FsbChpdGVyYWJsZSk7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTspIHtcbiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTtcbiAgICBpZiAocmVzdWx0ID09PSBCUkVBSyB8fCByZXN1bHQgPT09IFJFVFVSTikgcmV0dXJuIHJlc3VsdDtcbiAgfVxufTtcbmV4cG9ydHMuQlJFQUsgPSBCUkVBSztcbmV4cG9ydHMuUkVUVVJOID0gUkVUVVJOO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///52\n")},function(module,exports,__webpack_require__){eval("// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject = __webpack_require__(5);\nvar aFunction = __webpack_require__(22);\nvar SPECIES = __webpack_require__(6)('species');\nmodule.exports = function (O, D) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zcGVjaWVzLWNvbnN0cnVjdG9yLmpzP2ViZDYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpXG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJyk7XG52YXIgU1BFQ0lFUyA9IHJlcXVpcmUoJy4vX3drcycpKCdzcGVjaWVzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChPLCBEKSB7XG4gIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3I7XG4gIHZhciBTO1xuICByZXR1cm4gQyA9PT0gdW5kZWZpbmVkIHx8IChTID0gYW5PYmplY3QoQylbU1BFQ0lFU10pID09IHVuZGVmaW5lZCA/IEQgOiBhRnVuY3Rpb24oUyk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///53\n")},function(module,exports,__webpack_require__){eval("var global = __webpack_require__(3);\nvar navigator = global.navigator;\n\nmodule.exports = navigator && navigator.userAgent || '';\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL191c2VyLWFnZW50LmpzP2EyNWYiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIG5hdmlnYXRvciA9IGdsb2JhbC5uYXZpZ2F0b3I7XG5cbm1vZHVsZS5leHBvcnRzID0gbmF2aWdhdG9yICYmIG5hdmlnYXRvci51c2VyQWdlbnQgfHwgJyc7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///54\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar global = __webpack_require__(3);\nvar $export = __webpack_require__(1);\nvar redefine = __webpack_require__(11);\nvar redefineAll = __webpack_require__(42);\nvar meta = __webpack_require__(28);\nvar forOf = __webpack_require__(52);\nvar anInstance = __webpack_require__(41);\nvar isObject = __webpack_require__(4);\nvar fails = __webpack_require__(2);\nvar $iterDetect = __webpack_require__(50);\nvar setToStringTag = __webpack_require__(37);\nvar inheritIfRequired = __webpack_require__(66);\n\nmodule.exports = function (NAME, wrapper, methods, common, IS_MAP, IS_WEAK) {\n  var Base = global[NAME];\n  var C = Base;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var proto = C && C.prototype;\n  var O = {};\n  var fixMethod = function (KEY) {\n    var fn = proto[KEY];\n    redefine(proto, KEY,\n      KEY == 'delete' ? function (a) {\n        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'has' ? function has(a) {\n        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'get' ? function get(a) {\n        return IS_WEAK && !isObject(a) ? undefined : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'add' ? function add(a) { fn.call(this, a === 0 ? 0 : a); return this; }\n        : function set(a, b) { fn.call(this, a === 0 ? 0 : a, b); return this; }\n    );\n  };\n  if (typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function () {\n    new C().entries().next();\n  }))) {\n    // create collection constructor\n    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);\n    redefineAll(C.prototype, methods);\n    meta.NEED = true;\n  } else {\n    var instance = new C();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~  Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    var ACCEPT_ITERABLES = $iterDetect(function (iter) { new C(iter); }); // eslint-disable-line no-new\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new C();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n    if (!ACCEPT_ITERABLES) {\n      C = wrapper(function (target, iterable) {\n        anInstance(target, C, NAME);\n        var that = inheritIfRequired(new Base(), target, C);\n        if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n        return that;\n      });\n      C.prototype = proto;\n      proto.constructor = C;\n    }\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n    // weak collections should not contains .clear method\n    if (IS_WEAK && proto.clear) delete proto.clear;\n  }\n\n  setToStringTag(C, NAME);\n\n  O[NAME] = C;\n  $export($export.G + $export.W + $export.F * (C != Base), O);\n\n  if (!IS_WEAK) common.setStrong(C, NAME, IS_MAP);\n\n  return C;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19jb2xsZWN0aW9uLmpzP2UwYjgiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciByZWRlZmluZSA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJyk7XG52YXIgcmVkZWZpbmVBbGwgPSByZXF1aXJlKCcuL19yZWRlZmluZS1hbGwnKTtcbnZhciBtZXRhID0gcmVxdWlyZSgnLi9fbWV0YScpO1xudmFyIGZvck9mID0gcmVxdWlyZSgnLi9fZm9yLW9mJyk7XG52YXIgYW5JbnN0YW5jZSA9IHJlcXVpcmUoJy4vX2FuLWluc3RhbmNlJyk7XG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbnZhciBmYWlscyA9IHJlcXVpcmUoJy4vX2ZhaWxzJyk7XG52YXIgJGl0ZXJEZXRlY3QgPSByZXF1aXJlKCcuL19pdGVyLWRldGVjdCcpO1xudmFyIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi9fc2V0LXRvLXN0cmluZy10YWcnKTtcbnZhciBpbmhlcml0SWZSZXF1aXJlZCA9IHJlcXVpcmUoJy4vX2luaGVyaXQtaWYtcmVxdWlyZWQnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTkFNRSwgd3JhcHBlciwgbWV0aG9kcywgY29tbW9uLCBJU19NQVAsIElTX1dFQUspIHtcbiAgdmFyIEJhc2UgPSBnbG9iYWxbTkFNRV07XG4gIHZhciBDID0gQmFzZTtcbiAgdmFyIEFEREVSID0gSVNfTUFQID8gJ3NldCcgOiAnYWRkJztcbiAgdmFyIHByb3RvID0gQyAmJiBDLnByb3RvdHlwZTtcbiAgdmFyIE8gPSB7fTtcbiAgdmFyIGZpeE1ldGhvZCA9IGZ1bmN0aW9uIChLRVkpIHtcbiAgICB2YXIgZm4gPSBwcm90b1tLRVldO1xuICAgIHJlZGVmaW5lKHByb3RvLCBLRVksXG4gICAgICBLRVkgPT0gJ2RlbGV0ZScgPyBmdW5jdGlvbiAoYSkge1xuICAgICAgICByZXR1cm4gSVNfV0VBSyAmJiAhaXNPYmplY3QoYSkgPyBmYWxzZSA6IGZuLmNhbGwodGhpcywgYSA9PT0gMCA/IDAgOiBhKTtcbiAgICAgIH0gOiBLRVkgPT0gJ2hhcycgPyBmdW5jdGlvbiBoYXMoYSkge1xuICAgICAgICByZXR1cm4gSVNfV0VBSyAmJiAhaXNPYmplY3QoYSkgPyBmYWxzZSA6IGZuLmNhbGwodGhpcywgYSA9PT0gMCA/IDAgOiBhKTtcbiAgICAgIH0gOiBLRVkgPT0gJ2dldCcgPyBmdW5jdGlvbiBnZXQoYSkge1xuICAgICAgICByZXR1cm4gSVNfV0VBSyAmJiAhaXNPYmplY3QoYSkgPyB1bmRlZmluZWQgOiBmbi5jYWxsKHRoaXMsIGEgPT09IDAgPyAwIDogYSk7XG4gICAgICB9IDogS0VZID09ICdhZGQnID8gZnVuY3Rpb24gYWRkKGEpIHsgZm4uY2FsbCh0aGlzLCBhID09PSAwID8gMCA6IGEpOyByZXR1cm4gdGhpczsgfVxuICAgICAgICA6IGZ1bmN0aW9uIHNldChhLCBiKSB7IGZuLmNhbGwodGhpcywgYSA9PT0gMCA/IDAgOiBhLCBiKTsgcmV0dXJuIHRoaXM7IH1cbiAgICApO1xuICB9O1xuICBpZiAodHlwZW9mIEMgIT0gJ2Z1bmN0aW9uJyB8fCAhKElTX1dFQUsgfHwgcHJvdG8uZm9yRWFjaCAmJiAhZmFpbHMoZnVuY3Rpb24gKCkge1xuICAgIG5ldyBDKCkuZW50cmllcygpLm5leHQoKTtcbiAgfSkpKSB7XG4gICAgLy8gY3JlYXRlIGNvbGxlY3Rpb24gY29uc3RydWN0b3JcbiAgICBDID0gY29tbW9uLmdldENvbnN0cnVjdG9yKHdyYXBwZXIsIE5BTUUsIElTX01BUCwgQURERVIpO1xuICAgIHJlZGVmaW5lQWxsKEMucHJvdG90eXBlLCBtZXRob2RzKTtcbiAgICBtZXRhLk5FRUQgPSB0cnVlO1xuICB9IGVsc2Uge1xuICAgIHZhciBpbnN0YW5jZSA9IG5ldyBDKCk7XG4gICAgLy8gZWFybHkgaW1wbGVtZW50YXRpb25zIG5vdCBzdXBwb3J0cyBjaGFpbmluZ1xuICAgIHZhciBIQVNOVF9DSEFJTklORyA9IGluc3RhbmNlW0FEREVSXShJU19XRUFLID8ge30gOiAtMCwgMSkgIT0gaW5zdGFuY2U7XG4gICAgLy8gVjggfiAgQ2hyb21pdW0gNDAtIHdlYWstY29sbGVjdGlvbnMgdGhyb3dzIG9uIHByaW1pdGl2ZXMsIGJ1dCBzaG91bGQgcmV0dXJuIGZhbHNlXG4gICAgdmFyIFRIUk9XU19PTl9QUklNSVRJVkVTID0gZmFpbHMoZnVuY3Rpb24gKCkgeyBpbnN0YW5jZS5oYXMoMSk7IH0pO1xuICAgIC8vIG1vc3QgZWFybHkgaW1wbGVtZW50YXRpb25zIGRvZXNuJ3Qgc3VwcG9ydHMgaXRlcmFibGVzLCBtb3N0IG1vZGVybiAtIG5vdCBjbG9zZSBpdCBjb3JyZWN0bHlcbiAgICB2YXIgQUNDRVBUX0lURVJBQkxFUyA9ICRpdGVyRGV0ZWN0KGZ1bmN0aW9uIChpdGVyKSB7IG5ldyBDKGl0ZXIpOyB9KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXdcbiAgICAvLyBmb3IgZWFybHkgaW1wbGVtZW50YXRpb25zIC0wIGFuZCArMCBub3QgdGhlIHNhbWVcbiAgICB2YXIgQlVHR1lfWkVSTyA9ICFJU19XRUFLICYmIGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIFY4IH4gQ2hyb21pdW0gNDItIGZhaWxzIG9ubHkgd2l0aCA1KyBlbGVtZW50c1xuICAgICAgdmFyICRpbnN0YW5jZSA9IG5ldyBDKCk7XG4gICAgICB2YXIgaW5kZXggPSA1O1xuICAgICAgd2hpbGUgKGluZGV4LS0pICRpbnN0YW5jZVtBRERFUl0oaW5kZXgsIGluZGV4KTtcbiAgICAgIHJldHVybiAhJGluc3RhbmNlLmhhcygtMCk7XG4gICAgfSk7XG4gICAgaWYgKCFBQ0NFUFRfSVRFUkFCTEVTKSB7XG4gICAgICBDID0gd3JhcHBlcihmdW5jdGlvbiAodGFyZ2V0LCBpdGVyYWJsZSkge1xuICAgICAgICBhbkluc3RhbmNlKHRhcmdldCwgQywgTkFNRSk7XG4gICAgICAgIHZhciB0aGF0ID0gaW5oZXJpdElmUmVxdWlyZWQobmV3IEJhc2UoKSwgdGFyZ2V0LCBDKTtcbiAgICAgICAgaWYgKGl0ZXJhYmxlICE9IHVuZGVmaW5lZCkgZm9yT2YoaXRlcmFibGUsIElTX01BUCwgdGhhdFtBRERFUl0sIHRoYXQpO1xuICAgICAgICByZXR1cm4gdGhhdDtcbiAgICAgIH0pO1xuICAgICAgQy5wcm90b3R5cGUgPSBwcm90bztcbiAgICAgIHByb3RvLmNvbnN0cnVjdG9yID0gQztcbiAgICB9XG4gICAgaWYgKFRIUk9XU19PTl9QUklNSVRJVkVTIHx8IEJVR0dZX1pFUk8pIHtcbiAgICAgIGZpeE1ldGhvZCgnZGVsZXRlJyk7XG4gICAgICBmaXhNZXRob2QoJ2hhcycpO1xuICAgICAgSVNfTUFQICYmIGZpeE1ldGhvZCgnZ2V0Jyk7XG4gICAgfVxuICAgIGlmIChCVUdHWV9aRVJPIHx8IEhBU05UX0NIQUlOSU5HKSBmaXhNZXRob2QoQURERVIpO1xuICAgIC8vIHdlYWsgY29sbGVjdGlvbnMgc2hvdWxkIG5vdCBjb250YWlucyAuY2xlYXIgbWV0aG9kXG4gICAgaWYgKElTX1dFQUsgJiYgcHJvdG8uY2xlYXIpIGRlbGV0ZSBwcm90by5jbGVhcjtcbiAgfVxuXG4gIHNldFRvU3RyaW5nVGFnKEMsIE5BTUUpO1xuXG4gIE9bTkFNRV0gPSBDO1xuICAkZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqIChDICE9IEJhc2UpLCBPKTtcblxuICBpZiAoIUlTX1dFQUspIGNvbW1vbi5zZXRTdHJvbmcoQywgTkFNRSwgSVNfTUFQKTtcblxuICByZXR1cm4gQztcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///55\n")},function(module,exports,__webpack_require__){eval("var global = __webpack_require__(3);\nvar hide = __webpack_require__(14);\nvar uid = __webpack_require__(30);\nvar TYPED = uid('typed_array');\nvar VIEW = uid('view');\nvar ABV = !!(global.ArrayBuffer && global.DataView);\nvar CONSTR = ABV;\nvar i = 0;\nvar l = 9;\nvar Typed;\n\nvar TypedArrayConstructors = (\n  'Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array'\n).split(',');\n\nwhile (i < l) {\n  if (Typed = global[TypedArrayConstructors[i++]]) {\n    hide(Typed.prototype, TYPED, true);\n    hide(Typed.prototype, VIEW, true);\n  } else CONSTR = false;\n}\n\nmodule.exports = {\n  ABV: ABV,\n  CONSTR: CONSTR,\n  TYPED: TYPED,\n  VIEW: VIEW\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190eXBlZC5qcz8wZjg4Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBoaWRlID0gcmVxdWlyZSgnLi9faGlkZScpO1xudmFyIHVpZCA9IHJlcXVpcmUoJy4vX3VpZCcpO1xudmFyIFRZUEVEID0gdWlkKCd0eXBlZF9hcnJheScpO1xudmFyIFZJRVcgPSB1aWQoJ3ZpZXcnKTtcbnZhciBBQlYgPSAhIShnbG9iYWwuQXJyYXlCdWZmZXIgJiYgZ2xvYmFsLkRhdGFWaWV3KTtcbnZhciBDT05TVFIgPSBBQlY7XG52YXIgaSA9IDA7XG52YXIgbCA9IDk7XG52YXIgVHlwZWQ7XG5cbnZhciBUeXBlZEFycmF5Q29uc3RydWN0b3JzID0gKFxuICAnSW50OEFycmF5LFVpbnQ4QXJyYXksVWludDhDbGFtcGVkQXJyYXksSW50MTZBcnJheSxVaW50MTZBcnJheSxJbnQzMkFycmF5LFVpbnQzMkFycmF5LEZsb2F0MzJBcnJheSxGbG9hdDY0QXJyYXknXG4pLnNwbGl0KCcsJyk7XG5cbndoaWxlIChpIDwgbCkge1xuICBpZiAoVHlwZWQgPSBnbG9iYWxbVHlwZWRBcnJheUNvbnN0cnVjdG9yc1tpKytdXSkge1xuICAgIGhpZGUoVHlwZWQucHJvdG90eXBlLCBUWVBFRCwgdHJ1ZSk7XG4gICAgaGlkZShUeXBlZC5wcm90b3R5cGUsIFZJRVcsIHRydWUpO1xuICB9IGVsc2UgQ09OU1RSID0gZmFsc2U7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBBQlY6IEFCVixcbiAgQ09OU1RSOiBDT05TVFIsXG4gIFRZUEVEOiBUWVBFRCxcbiAgVklFVzogVklFV1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///56\n")},function(module,exports,__webpack_require__){eval("var isObject = __webpack_require__(4);\nvar document = __webpack_require__(3).document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19kb20tY3JlYXRlLmpzPzIzMGUiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgZG9jdW1lbnQgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5kb2N1bWVudDtcbi8vIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50IGlzICdvYmplY3QnIGluIG9sZCBJRVxudmFyIGlzID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGlzID8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChpdCkgOiB7fTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///57\n")},function(module,exports,__webpack_require__){eval("var core = __webpack_require__(9);\nvar global = __webpack_require__(3);\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: core.version,\n  mode: __webpack_require__(31) ? 'pure' : 'global',\n  copyright: '© 2018 Denis Pushkarev (zloirock.ru)'\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zaGFyZWQuanM/NTUzNyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29yZSA9IHJlcXVpcmUoJy4vX2NvcmUnKTtcbnZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJztcbnZhciBzdG9yZSA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTtcblxuKG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiB7fSk7XG59KSgndmVyc2lvbnMnLCBbXSkucHVzaCh7XG4gIHZlcnNpb246IGNvcmUudmVyc2lvbixcbiAgbW9kZTogcmVxdWlyZSgnLi9fbGlicmFyeScpID8gJ3B1cmUnIDogJ2dsb2JhbCcsXG4gIGNvcHlyaWdodDogJ8KpIDIwMTggRGVuaXMgUHVzaGthcmV2ICh6bG9pcm9jay5ydSknXG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///58\n")},function(module,exports,__webpack_require__){eval("exports.f = __webpack_require__(6);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL193a3MtZXh0LmpzPzM3YzgiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fd2tzJyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///59\n")},function(module,exports,__webpack_require__){eval("var shared = __webpack_require__(58)('keys');\nvar uid = __webpack_require__(30);\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zaGFyZWQta2V5LmpzPzYxM2IiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIHNoYXJlZCA9IHJlcXVpcmUoJy4vX3NoYXJlZCcpKCdrZXlzJyk7XG52YXIgdWlkID0gcmVxdWlyZSgnLi9fdWlkJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIHNoYXJlZFtrZXldIHx8IChzaGFyZWRba2V5XSA9IHVpZChrZXkpKTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///60\n")},function(module,exports){eval("// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19lbnVtLWJ1Zy1rZXlzLmpzP2UxMWUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5c1xubW9kdWxlLmV4cG9ydHMgPSAoXG4gICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnXG4pLnNwbGl0KCcsJyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///61\n")},function(module,exports,__webpack_require__){eval("// 7.2.2 IsArray(argument)\nvar cof = __webpack_require__(23);\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pcy1hcnJheS5qcz8xMTY5Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDcuMi4yIElzQXJyYXkoYXJndW1lbnQpXG52YXIgY29mID0gcmVxdWlyZSgnLi9fY29mJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheShhcmcpIHtcbiAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///62\n")},function(module,exports,__webpack_require__){eval("var document = __webpack_require__(3).document;\nmodule.exports = document && document.documentElement;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19odG1sLmpzP2ZhYjIiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRvY3VtZW50ID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykuZG9jdW1lbnQ7XG5tb2R1bGUuZXhwb3J0cyA9IGRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///63\n")},function(module,exports,__webpack_require__){eval("// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = __webpack_require__(4);\nvar anObject = __webpack_require__(5);\nvar check = function (O, proto) {\n  anObject(O);\n  if (!isObject(proto) && proto !== null) throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function (test, buggy, set) {\n      try {\n        set = __webpack_require__(21)(Function.call, __webpack_require__(18).f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch (e) { buggy = true; }\n      return function setPrototypeOf(O, proto) {\n        check(O, proto);\n        if (buggy) O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zZXQtcHJvdG8uanM/OGI5NyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBXb3JrcyB3aXRoIF9fcHJvdG9fXyBvbmx5LiBPbGQgdjggY2FuJ3Qgd29yayB3aXRoIG51bGwgcHJvdG8gb2JqZWN0cy5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovXG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xudmFyIGNoZWNrID0gZnVuY3Rpb24gKE8sIHByb3RvKSB7XG4gIGFuT2JqZWN0KE8pO1xuICBpZiAoIWlzT2JqZWN0KHByb3RvKSAmJiBwcm90byAhPT0gbnVsbCkgdGhyb3cgVHlwZUVycm9yKHByb3RvICsgXCI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhXCIpO1xufTtcbm1vZHVsZS5leHBvcnRzID0ge1xuICBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoJ19fcHJvdG9fXycgaW4ge30gPyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgZnVuY3Rpb24gKHRlc3QsIGJ1Z2d5LCBzZXQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNldCA9IHJlcXVpcmUoJy4vX2N0eCcpKEZ1bmN0aW9uLmNhbGwsIHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykuZihPYmplY3QucHJvdG90eXBlLCAnX19wcm90b19fJykuc2V0LCAyKTtcbiAgICAgICAgc2V0KHRlc3QsIFtdKTtcbiAgICAgICAgYnVnZ3kgPSAhKHRlc3QgaW5zdGFuY2VvZiBBcnJheSk7XG4gICAgICB9IGNhdGNoIChlKSB7IGJ1Z2d5ID0gdHJ1ZTsgfVxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKE8sIHByb3RvKSB7XG4gICAgICAgIGNoZWNrKE8sIHByb3RvKTtcbiAgICAgICAgaWYgKGJ1Z2d5KSBPLl9fcHJvdG9fXyA9IHByb3RvO1xuICAgICAgICBlbHNlIHNldChPLCBwcm90byk7XG4gICAgICAgIHJldHVybiBPO1xuICAgICAgfTtcbiAgICB9KHt9LCBmYWxzZSkgOiB1bmRlZmluZWQpLFxuICBjaGVjazogY2hlY2tcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///64\n")},function(module,exports){eval("module.exports = '\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003' +\n  '\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zdHJpbmctd3MuanM/ZmRlZiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9ICdcXHgwOVxceDBBXFx4MEJcXHgwQ1xceDBEXFx4MjBcXHhBMFxcdTE2ODBcXHUxODBFXFx1MjAwMFxcdTIwMDFcXHUyMDAyXFx1MjAwMycgK1xuICAnXFx1MjAwNFxcdTIwMDVcXHUyMDA2XFx1MjAwN1xcdTIwMDhcXHUyMDA5XFx1MjAwQVxcdTIwMkZcXHUyMDVGXFx1MzAwMFxcdTIwMjhcXHUyMDI5XFx1RkVGRic7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///65\n")},function(module,exports,__webpack_require__){eval("var isObject = __webpack_require__(4);\nvar setPrototypeOf = __webpack_require__(64).set;\nmodule.exports = function (that, target, C) {\n  var S = target.constructor;\n  var P;\n  if (S !== C && typeof S == 'function' && (P = S.prototype) !== C.prototype && isObject(P) && setPrototypeOf) {\n    setPrototypeOf(that, P);\n  } return that;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pbmhlcml0LWlmLXJlcXVpcmVkLmpzPzVkYmMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgc2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19zZXQtcHJvdG8nKS5zZXQ7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0aGF0LCB0YXJnZXQsIEMpIHtcbiAgdmFyIFMgPSB0YXJnZXQuY29uc3RydWN0b3I7XG4gIHZhciBQO1xuICBpZiAoUyAhPT0gQyAmJiB0eXBlb2YgUyA9PSAnZnVuY3Rpb24nICYmIChQID0gUy5wcm90b3R5cGUpICE9PSBDLnByb3RvdHlwZSAmJiBpc09iamVjdChQKSAmJiBzZXRQcm90b3R5cGVPZikge1xuICAgIHNldFByb3RvdHlwZU9mKHRoYXQsIFApO1xuICB9IHJldHVybiB0aGF0O1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///66\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar toInteger = __webpack_require__(25);\nvar defined = __webpack_require__(24);\n\nmodule.exports = function repeat(count) {\n  var str = String(defined(this));\n  var res = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError(\"Count can't be negative\");\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) res += str;\n  return res;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zdHJpbmctcmVwZWF0LmpzPzk3NDQiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4vX3RvLWludGVnZXInKTtcbnZhciBkZWZpbmVkID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHJlcGVhdChjb3VudCkge1xuICB2YXIgc3RyID0gU3RyaW5nKGRlZmluZWQodGhpcykpO1xuICB2YXIgcmVzID0gJyc7XG4gIHZhciBuID0gdG9JbnRlZ2VyKGNvdW50KTtcbiAgaWYgKG4gPCAwIHx8IG4gPT0gSW5maW5pdHkpIHRocm93IFJhbmdlRXJyb3IoXCJDb3VudCBjYW4ndCBiZSBuZWdhdGl2ZVwiKTtcbiAgZm9yICg7biA+IDA7IChuID4+Pj0gMSkgJiYgKHN0ciArPSBzdHIpKSBpZiAobiAmIDEpIHJlcyArPSBzdHI7XG4gIHJldHVybiByZXM7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///67\n")},function(module,exports){eval("// 20.2.2.28 Math.sign(x)\nmodule.exports = Math.sign || function sign(x) {\n  // eslint-disable-next-line no-self-compare\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19tYXRoLXNpZ24uanM/OTZmYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMC4yLjIuMjggTWF0aC5zaWduKHgpXG5tb2R1bGUuZXhwb3J0cyA9IE1hdGguc2lnbiB8fCBmdW5jdGlvbiBzaWduKHgpIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtY29tcGFyZVxuICByZXR1cm4gKHggPSAreCkgPT0gMCB8fCB4ICE9IHggPyB4IDogeCA8IDAgPyAtMSA6IDE7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///68\n")},function(module,exports){eval("// 20.2.2.14 Math.expm1(x)\nvar $expm1 = Math.expm1;\nmodule.exports = (!$expm1\n  // Old FF bug\n  || $expm1(10) > 22025.465794806719 || $expm1(10) < 22025.4657948067165168\n  // Tor Browser bug\n  || $expm1(-2e-17) != -2e-17\n) ? function expm1(x) {\n  return (x = +x) == 0 ? x : x > -1e-6 && x < 1e-6 ? x + x * x / 2 : Math.exp(x) - 1;\n} : $expm1;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19tYXRoLWV4cG0xLmpzPzJkNWMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjE0IE1hdGguZXhwbTEoeClcbnZhciAkZXhwbTEgPSBNYXRoLmV4cG0xO1xubW9kdWxlLmV4cG9ydHMgPSAoISRleHBtMVxuICAvLyBPbGQgRkYgYnVnXG4gIHx8ICRleHBtMSgxMCkgPiAyMjAyNS40NjU3OTQ4MDY3MTkgfHwgJGV4cG0xKDEwKSA8IDIyMDI1LjQ2NTc5NDgwNjcxNjUxNjhcbiAgLy8gVG9yIEJyb3dzZXIgYnVnXG4gIHx8ICRleHBtMSgtMmUtMTcpICE9IC0yZS0xN1xuKSA/IGZ1bmN0aW9uIGV4cG0xKHgpIHtcbiAgcmV0dXJuICh4ID0gK3gpID09IDAgPyB4IDogeCA+IC0xZS02ICYmIHggPCAxZS02ID8geCArIHggKiB4IC8gMiA6IE1hdGguZXhwKHgpIC0gMTtcbn0gOiAkZXhwbTE7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///69\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar LIBRARY = __webpack_require__(31);\nvar $export = __webpack_require__(1);\nvar redefine = __webpack_require__(11);\nvar hide = __webpack_require__(14);\nvar Iterators = __webpack_require__(38);\nvar $iterCreate = __webpack_require__(98);\nvar setToStringTag = __webpack_require__(37);\nvar getPrototypeOf = __webpack_require__(36);\nvar ITERATOR = __webpack_require__(6)('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pdGVyLWRlZmluZS5qcz8wMWY5Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBMSUJSQVJZID0gcmVxdWlyZSgnLi9fbGlicmFyeScpO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciByZWRlZmluZSA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJyk7XG52YXIgaGlkZSA9IHJlcXVpcmUoJy4vX2hpZGUnKTtcbnZhciBJdGVyYXRvcnMgPSByZXF1aXJlKCcuL19pdGVyYXRvcnMnKTtcbnZhciAkaXRlckNyZWF0ZSA9IHJlcXVpcmUoJy4vX2l0ZXItY3JlYXRlJyk7XG52YXIgc2V0VG9TdHJpbmdUYWcgPSByZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpO1xudmFyIGdldFByb3RvdHlwZU9mID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdwbycpO1xudmFyIElURVJBVE9SID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyk7XG52YXIgQlVHR1kgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSk7IC8vIFNhZmFyaSBoYXMgYnVnZ3kgaXRlcmF0b3JzIHcvbyBgbmV4dGBcbnZhciBGRl9JVEVSQVRPUiA9ICdAQGl0ZXJhdG9yJztcbnZhciBLRVlTID0gJ2tleXMnO1xudmFyIFZBTFVFUyA9ICd2YWx1ZXMnO1xuXG52YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEJhc2UsIE5BTUUsIENvbnN0cnVjdG9yLCBuZXh0LCBERUZBVUxULCBJU19TRVQsIEZPUkNFRCkge1xuICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7XG4gIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbiAoa2luZCkge1xuICAgIGlmICghQlVHR1kgJiYga2luZCBpbiBwcm90bykgcmV0dXJuIHByb3RvW2tpbmRdO1xuICAgIHN3aXRjaCAoa2luZCkge1xuICAgICAgY2FzZSBLRVlTOiByZXR1cm4gZnVuY3Rpb24ga2V5cygpIHsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTtcbiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCkgeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9O1xuICAgIH0gcmV0dXJuIGZ1bmN0aW9uIGVudHJpZXMoKSB7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07XG4gIH07XG4gIHZhciBUQUcgPSBOQU1FICsgJyBJdGVyYXRvcic7XG4gIHZhciBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVM7XG4gIHZhciBWQUxVRVNfQlVHID0gZmFsc2U7XG4gIHZhciBwcm90byA9IEJhc2UucHJvdG90eXBlO1xuICB2YXIgJG5hdGl2ZSA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXTtcbiAgdmFyICRkZWZhdWx0ID0gJG5hdGl2ZSB8fCBnZXRNZXRob2QoREVGQVVMVCk7XG4gIHZhciAkZW50cmllcyA9IERFRkFVTFQgPyAhREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKCdlbnRyaWVzJykgOiB1bmRlZmluZWQ7XG4gIHZhciAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZTtcbiAgdmFyIG1ldGhvZHMsIGtleSwgSXRlcmF0b3JQcm90b3R5cGU7XG4gIC8vIEZpeCBuYXRpdmVcbiAgaWYgKCRhbnlOYXRpdmUpIHtcbiAgICBJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvdHlwZU9mKCRhbnlOYXRpdmUuY2FsbChuZXcgQmFzZSgpKSk7XG4gICAgaWYgKEl0ZXJhdG9yUHJvdG90eXBlICE9PSBPYmplY3QucHJvdG90eXBlICYmIEl0ZXJhdG9yUHJvdG90eXBlLm5leHQpIHtcbiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnNcbiAgICAgIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yUHJvdG90eXBlLCBUQUcsIHRydWUpO1xuICAgICAgLy8gZml4IGZvciBzb21lIG9sZCBlbmdpbmVzXG4gICAgICBpZiAoIUxJQlJBUlkgJiYgdHlwZW9mIEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SXSAhPSAnZnVuY3Rpb24nKSBoaWRlKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUiwgcmV0dXJuVGhpcyk7XG4gICAgfVxuICB9XG4gIC8vIGZpeCBBcnJheSN7dmFsdWVzLCBAQGl0ZXJhdG9yfS5uYW1lIGluIFY4IC8gRkZcbiAgaWYgKERFRl9WQUxVRVMgJiYgJG5hdGl2ZSAmJiAkbmF0aXZlLm5hbWUgIT09IFZBTFVFUykge1xuICAgIFZBTFVFU19CVUcgPSB0cnVlO1xuICAgICRkZWZhdWx0ID0gZnVuY3Rpb24gdmFsdWVzKCkgeyByZXR1cm4gJG5hdGl2ZS5jYWxsKHRoaXMpOyB9O1xuICB9XG4gIC8vIERlZmluZSBpdGVyYXRvclxuICBpZiAoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpIHtcbiAgICBoaWRlKHByb3RvLCBJVEVSQVRPUiwgJGRlZmF1bHQpO1xuICB9XG4gIC8vIFBsdWcgZm9yIGxpYnJhcnlcbiAgSXRlcmF0b3JzW05BTUVdID0gJGRlZmF1bHQ7XG4gIEl0ZXJhdG9yc1tUQUddID0gcmV0dXJuVGhpcztcbiAgaWYgKERFRkFVTFQpIHtcbiAgICBtZXRob2RzID0ge1xuICAgICAgdmFsdWVzOiBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSxcbiAgICAgIGtleXM6IElTX1NFVCA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLFxuICAgICAgZW50cmllczogJGVudHJpZXNcbiAgICB9O1xuICAgIGlmIChGT1JDRUQpIGZvciAoa2V5IGluIG1ldGhvZHMpIHtcbiAgICAgIGlmICghKGtleSBpbiBwcm90bykpIHJlZGVmaW5lKHByb3RvLCBrZXksIG1ldGhvZHNba2V5XSk7XG4gICAgfSBlbHNlICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKEJVR0dZIHx8IFZBTFVFU19CVUcpLCBOQU1FLCBtZXRob2RzKTtcbiAgfVxuICByZXR1cm4gbWV0aG9kcztcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///70\n")},function(module,exports,__webpack_require__){eval("// helper for String#{startsWith, endsWith, includes}\nvar isRegExp = __webpack_require__(72);\nvar defined = __webpack_require__(24);\n\nmodule.exports = function (that, searchString, NAME) {\n  if (isRegExp(searchString)) throw TypeError('String#' + NAME + \" doesn't accept regex!\");\n  return String(defined(that));\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zdHJpbmctY29udGV4dC5qcz9kMmM4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGhlbHBlciBmb3IgU3RyaW5nI3tzdGFydHNXaXRoLCBlbmRzV2l0aCwgaW5jbHVkZXN9XG52YXIgaXNSZWdFeHAgPSByZXF1aXJlKCcuL19pcy1yZWdleHAnKTtcbnZhciBkZWZpbmVkID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0aGF0LCBzZWFyY2hTdHJpbmcsIE5BTUUpIHtcbiAgaWYgKGlzUmVnRXhwKHNlYXJjaFN0cmluZykpIHRocm93IFR5cGVFcnJvcignU3RyaW5nIycgKyBOQU1FICsgXCIgZG9lc24ndCBhY2NlcHQgcmVnZXghXCIpO1xuICByZXR1cm4gU3RyaW5nKGRlZmluZWQodGhhdCkpO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///71\n")},function(module,exports,__webpack_require__){eval("// 7.2.8 IsRegExp(argument)\nvar isObject = __webpack_require__(4);\nvar cof = __webpack_require__(23);\nvar MATCH = __webpack_require__(6)('match');\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : cof(it) == 'RegExp');\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pcy1yZWdleHAuanM/YWFlMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA3LjIuOCBJc1JlZ0V4cChhcmd1bWVudClcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIGNvZiA9IHJlcXVpcmUoJy4vX2NvZicpO1xudmFyIE1BVENIID0gcmVxdWlyZSgnLi9fd2tzJykoJ21hdGNoJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICB2YXIgaXNSZWdFeHA7XG4gIHJldHVybiBpc09iamVjdChpdCkgJiYgKChpc1JlZ0V4cCA9IGl0W01BVENIXSkgIT09IHVuZGVmaW5lZCA/ICEhaXNSZWdFeHAgOiBjb2YoaXQpID09ICdSZWdFeHAnKTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///72\n")},function(module,exports,__webpack_require__){eval("var MATCH = __webpack_require__(6)('match');\nmodule.exports = function (KEY) {\n  var re = /./;\n  try {\n    '/./'[KEY](re);\n  } catch (e) {\n    try {\n      re[MATCH] = false;\n      return !'/./'[KEY](re);\n    } catch (f) { /* empty */ }\n  } return true;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19mYWlscy1pcy1yZWdleHAuanM/NTE0NyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgTUFUQ0ggPSByZXF1aXJlKCcuL193a3MnKSgnbWF0Y2gnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEtFWSkge1xuICB2YXIgcmUgPSAvLi87XG4gIHRyeSB7XG4gICAgJy8uLydbS0VZXShyZSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0cnkge1xuICAgICAgcmVbTUFUQ0hdID0gZmFsc2U7XG4gICAgICByZXR1cm4gIScvLi8nW0tFWV0ocmUpO1xuICAgIH0gY2F0Y2ggKGYpIHsgLyogZW1wdHkgKi8gfVxuICB9IHJldHVybiB0cnVlO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///73\n")},function(module,exports,__webpack_require__){eval("// check on default Array iterator\nvar Iterators = __webpack_require__(38);\nvar ITERATOR = __webpack_require__(6)('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pcy1hcnJheS1pdGVyLmpzPzMzYTQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gY2hlY2sgb24gZGVmYXVsdCBBcnJheSBpdGVyYXRvclxudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4vX2l0ZXJhdG9ycycpO1xudmFyIElURVJBVE9SID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyk7XG52YXIgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///74\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $defineProperty = __webpack_require__(7);\nvar createDesc = __webpack_require__(29);\n\nmodule.exports = function (object, index, value) {\n  if (index in object) $defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19jcmVhdGUtcHJvcGVydHkuanM/ZjFhZSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGRlZmluZVByb3BlcnR5ID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob2JqZWN0LCBpbmRleCwgdmFsdWUpIHtcbiAgaWYgKGluZGV4IGluIG9iamVjdCkgJGRlZmluZVByb3BlcnR5LmYob2JqZWN0LCBpbmRleCwgY3JlYXRlRGVzYygwLCB2YWx1ZSkpO1xuICBlbHNlIG9iamVjdFtpbmRleF0gPSB2YWx1ZTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///75\n")},function(module,exports,__webpack_require__){eval("var classof = __webpack_require__(48);\nvar ITERATOR = __webpack_require__(6)('iterator');\nvar Iterators = __webpack_require__(38);\nmodule.exports = __webpack_require__(9).getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZC5qcz8yN2VlIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBjbGFzc29mID0gcmVxdWlyZSgnLi9fY2xhc3NvZicpO1xudmFyIElURVJBVE9SID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyk7XG52YXIgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2NvcmUnKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoaXQgIT0gdW5kZWZpbmVkKSByZXR1cm4gaXRbSVRFUkFUT1JdXG4gICAgfHwgaXRbJ0BAaXRlcmF0b3InXVxuICAgIHx8IEl0ZXJhdG9yc1tjbGFzc29mKGl0KV07XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///76\n")},function(module,exports,__webpack_require__){"use strict";eval("// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\n\nvar toObject = __webpack_require__(16);\nvar toAbsoluteIndex = __webpack_require__(33);\nvar toLength = __webpack_require__(10);\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var aLen = arguments.length;\n  var index = toAbsoluteIndex(aLen > 1 ? arguments[1] : undefined, length);\n  var end = aLen > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19hcnJheS1maWxsLmpzPzM2YmQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjIuMS4zLjYgQXJyYXkucHJvdG90eXBlLmZpbGwodmFsdWUsIHN0YXJ0ID0gMCwgZW5kID0gdGhpcy5sZW5ndGgpXG4ndXNlIHN0cmljdCc7XG52YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuL190by1vYmplY3QnKTtcbnZhciB0b0Fic29sdXRlSW5kZXggPSByZXF1aXJlKCcuL190by1hYnNvbHV0ZS1pbmRleCcpO1xudmFyIHRvTGVuZ3RoID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGZpbGwodmFsdWUgLyogLCBzdGFydCA9IDAsIGVuZCA9IEBsZW5ndGggKi8pIHtcbiAgdmFyIE8gPSB0b09iamVjdCh0aGlzKTtcbiAgdmFyIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKTtcbiAgdmFyIGFMZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICB2YXIgaW5kZXggPSB0b0Fic29sdXRlSW5kZXgoYUxlbiA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQsIGxlbmd0aCk7XG4gIHZhciBlbmQgPSBhTGVuID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDtcbiAgdmFyIGVuZFBvcyA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuZ3RoIDogdG9BYnNvbHV0ZUluZGV4KGVuZCwgbGVuZ3RoKTtcbiAgd2hpbGUgKGVuZFBvcyA+IGluZGV4KSBPW2luZGV4KytdID0gdmFsdWU7XG4gIHJldHVybiBPO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///77\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar addToUnscopables = __webpack_require__(39);\nvar step = __webpack_require__(102);\nvar Iterators = __webpack_require__(38);\nvar toIObject = __webpack_require__(15);\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = __webpack_require__(70)(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzNi5hcnJheS5pdGVyYXRvci5qcz9jYWRmIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBhZGRUb1Vuc2NvcGFibGVzID0gcmVxdWlyZSgnLi9fYWRkLXRvLXVuc2NvcGFibGVzJyk7XG52YXIgc3RlcCA9IHJlcXVpcmUoJy4vX2l0ZXItc3RlcCcpO1xudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4vX2l0ZXJhdG9ycycpO1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcblxuLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKVxuLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzKClcbi8vIDIyLjEuMy4yOSBBcnJheS5wcm90b3R5cGUudmFsdWVzKClcbi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKVxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19pdGVyLWRlZmluZScpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbiAoaXRlcmF0ZWQsIGtpbmQpIHtcbiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldFxuICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleFxuICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgLy8ga2luZFxuLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbiAoKSB7XG4gIHZhciBPID0gdGhpcy5fdDtcbiAgdmFyIGtpbmQgPSB0aGlzLl9rO1xuICB2YXIgaW5kZXggPSB0aGlzLl9pKys7XG4gIGlmICghTyB8fCBpbmRleCA+PSBPLmxlbmd0aCkge1xuICAgIHRoaXMuX3QgPSB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIHN0ZXAoMSk7XG4gIH1cbiAgaWYgKGtpbmQgPT0gJ2tleXMnKSByZXR1cm4gc3RlcCgwLCBpbmRleCk7XG4gIGlmIChraW5kID09ICd2YWx1ZXMnKSByZXR1cm4gc3RlcCgwLCBPW2luZGV4XSk7XG4gIHJldHVybiBzdGVwKDAsIFtpbmRleCwgT1tpbmRleF1dKTtcbn0sICd2YWx1ZXMnKTtcblxuLy8gYXJndW1lbnRzTGlzdFtAQGl0ZXJhdG9yXSBpcyAlQXJyYXlQcm90b192YWx1ZXMlICg5LjQuNC42LCA5LjQuNC43KVxuSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTtcblxuYWRkVG9VbnNjb3BhYmxlcygna2V5cycpO1xuYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7XG5hZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///78\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 21.2.5.3 get RegExp.prototype.flags\nvar anObject = __webpack_require__(5);\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19mbGFncy5qcz8wYmZiIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIDIxLjIuNS4zIGdldCBSZWdFeHAucHJvdG90eXBlLmZsYWdzXG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdGhhdCA9IGFuT2JqZWN0KHRoaXMpO1xuICB2YXIgcmVzdWx0ID0gJyc7XG4gIGlmICh0aGF0Lmdsb2JhbCkgcmVzdWx0ICs9ICdnJztcbiAgaWYgKHRoYXQuaWdub3JlQ2FzZSkgcmVzdWx0ICs9ICdpJztcbiAgaWYgKHRoYXQubXVsdGlsaW5lKSByZXN1bHQgKz0gJ20nO1xuICBpZiAodGhhdC51bmljb2RlKSByZXN1bHQgKz0gJ3UnO1xuICBpZiAodGhhdC5zdGlja3kpIHJlc3VsdCArPSAneSc7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///79\n")},function(module,exports,__webpack_require__){eval("var ctx = __webpack_require__(21);\nvar invoke = __webpack_require__(91);\nvar html = __webpack_require__(63);\nvar cel = __webpack_require__(57);\nvar global = __webpack_require__(3);\nvar process = global.process;\nvar setTask = global.setImmediate;\nvar clearTask = global.clearImmediate;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\nvar run = function () {\n  var id = +this;\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function (event) {\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!setTask || !clearTask) {\n  setTask = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (__webpack_require__(23)(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if (MessageChannel) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n    defer = function (id) {\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in cel('script')) {\n    defer = function (id) {\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set: setTask,\n  clear: clearTask\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190YXNrLmpzPzE5OTEiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGN0eCA9IHJlcXVpcmUoJy4vX2N0eCcpO1xudmFyIGludm9rZSA9IHJlcXVpcmUoJy4vX2ludm9rZScpO1xudmFyIGh0bWwgPSByZXF1aXJlKCcuL19odG1sJyk7XG52YXIgY2VsID0gcmVxdWlyZSgnLi9fZG9tLWNyZWF0ZScpO1xudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIHByb2Nlc3MgPSBnbG9iYWwucHJvY2VzcztcbnZhciBzZXRUYXNrID0gZ2xvYmFsLnNldEltbWVkaWF0ZTtcbnZhciBjbGVhclRhc2sgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGU7XG52YXIgTWVzc2FnZUNoYW5uZWwgPSBnbG9iYWwuTWVzc2FnZUNoYW5uZWw7XG52YXIgRGlzcGF0Y2ggPSBnbG9iYWwuRGlzcGF0Y2g7XG52YXIgY291bnRlciA9IDA7XG52YXIgcXVldWUgPSB7fTtcbnZhciBPTlJFQURZU1RBVEVDSEFOR0UgPSAnb25yZWFkeXN0YXRlY2hhbmdlJztcbnZhciBkZWZlciwgY2hhbm5lbCwgcG9ydDtcbnZhciBydW4gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBpZCA9ICt0aGlzO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcHJvdG90eXBlLWJ1aWx0aW5zXG4gIGlmIChxdWV1ZS5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcbiAgICB2YXIgZm4gPSBxdWV1ZVtpZF07XG4gICAgZGVsZXRlIHF1ZXVlW2lkXTtcbiAgICBmbigpO1xuICB9XG59O1xudmFyIGxpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gIHJ1bi5jYWxsKGV2ZW50LmRhdGEpO1xufTtcbi8vIE5vZGUuanMgMC45KyAmIElFMTArIGhhcyBzZXRJbW1lZGlhdGUsIG90aGVyd2lzZTpcbmlmICghc2V0VGFzayB8fCAhY2xlYXJUYXNrKSB7XG4gIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIHZhciBpID0gMTtcbiAgICB3aGlsZSAoYXJndW1lbnRzLmxlbmd0aCA+IGkpIGFyZ3MucHVzaChhcmd1bWVudHNbaSsrXSk7XG4gICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1uZXctZnVuY1xuICAgICAgaW52b2tlKHR5cGVvZiBmbiA9PSAnZnVuY3Rpb24nID8gZm4gOiBGdW5jdGlvbihmbiksIGFyZ3MpO1xuICAgIH07XG4gICAgZGVmZXIoY291bnRlcik7XG4gICAgcmV0dXJuIGNvdW50ZXI7XG4gIH07XG4gIGNsZWFyVGFzayA9IGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGlkKSB7XG4gICAgZGVsZXRlIHF1ZXVlW2lkXTtcbiAgfTtcbiAgLy8gTm9kZS5qcyAwLjgtXG4gIGlmIChyZXF1aXJlKCcuL19jb2YnKShwcm9jZXNzKSA9PSAncHJvY2VzcycpIHtcbiAgICBkZWZlciA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpO1xuICAgIH07XG4gIC8vIFNwaGVyZSAoSlMgZ2FtZSBlbmdpbmUpIERpc3BhdGNoIEFQSVxuICB9IGVsc2UgaWYgKERpc3BhdGNoICYmIERpc3BhdGNoLm5vdykge1xuICAgIGRlZmVyID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICBEaXNwYXRjaC5ub3coY3R4KHJ1biwgaWQsIDEpKTtcbiAgICB9O1xuICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzXG4gIH0gZWxzZSBpZiAoTWVzc2FnZUNoYW5uZWwpIHtcbiAgICBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gICAgcG9ydCA9IGNoYW5uZWwucG9ydDI7XG4gICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBsaXN0ZW5lcjtcbiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTtcbiAgLy8gQnJvd3NlcnMgd2l0aCBwb3N0TWVzc2FnZSwgc2tpcCBXZWJXb3JrZXJzXG4gIC8vIElFOCBoYXMgcG9zdE1lc3NhZ2UsIGJ1dCBpdCdzIHN5bmMgJiB0eXBlb2YgaXRzIHBvc3RNZXNzYWdlIGlzICdvYmplY3QnXG4gIH0gZWxzZSBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIgJiYgdHlwZW9mIHBvc3RNZXNzYWdlID09ICdmdW5jdGlvbicgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKSB7XG4gICAgZGVmZXIgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpO1xuICAgIH07XG4gICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBsaXN0ZW5lciwgZmFsc2UpO1xuICAvLyBJRTgtXG4gIH0gZWxzZSBpZiAoT05SRUFEWVNUQVRFQ0hBTkdFIGluIGNlbCgnc2NyaXB0JykpIHtcbiAgICBkZWZlciA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgaHRtbC5hcHBlbmRDaGlsZChjZWwoJ3NjcmlwdCcpKVtPTlJFQURZU1RBVEVDSEFOR0VdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBodG1sLnJlbW92ZUNoaWxkKHRoaXMpO1xuICAgICAgICBydW4uY2FsbChpZCk7XG4gICAgICB9O1xuICAgIH07XG4gIC8vIFJlc3Qgb2xkIGJyb3dzZXJzXG4gIH0gZWxzZSB7XG4gICAgZGVmZXIgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgIHNldFRpbWVvdXQoY3R4KHJ1biwgaWQsIDEpLCAwKTtcbiAgICB9O1xuICB9XG59XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc2V0OiBzZXRUYXNrLFxuICBjbGVhcjogY2xlYXJUYXNrXG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///80\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar global = __webpack_require__(3);\nvar DESCRIPTORS = __webpack_require__(8);\nvar LIBRARY = __webpack_require__(31);\nvar $typed = __webpack_require__(56);\nvar hide = __webpack_require__(14);\nvar redefineAll = __webpack_require__(42);\nvar fails = __webpack_require__(2);\nvar anInstance = __webpack_require__(41);\nvar toInteger = __webpack_require__(25);\nvar toLength = __webpack_require__(10);\nvar toIndex = __webpack_require__(109);\nvar gOPN = __webpack_require__(35).f;\nvar dP = __webpack_require__(7).f;\nvar arrayFill = __webpack_require__(77);\nvar setToStringTag = __webpack_require__(37);\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar DATA_VIEW = 'DataView';\nvar PROTOTYPE = 'prototype';\nvar WRONG_LENGTH = 'Wrong length!';\nvar WRONG_INDEX = 'Wrong index!';\nvar $ArrayBuffer = global[ARRAY_BUFFER];\nvar $DataView = global[DATA_VIEW];\nvar Math = global.Math;\nvar RangeError = global.RangeError;\n// eslint-disable-next-line no-shadow-restricted-names\nvar Infinity = global.Infinity;\nvar BaseBuffer = $ArrayBuffer;\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar floor = Math.floor;\nvar log = Math.log;\nvar LN2 = Math.LN2;\nvar BUFFER = 'buffer';\nvar BYTE_LENGTH = 'byteLength';\nvar BYTE_OFFSET = 'byteOffset';\nvar $BUFFER = DESCRIPTORS ? '_b' : BUFFER;\nvar $LENGTH = DESCRIPTORS ? '_l' : BYTE_LENGTH;\nvar $OFFSET = DESCRIPTORS ? '_o' : BYTE_OFFSET;\n\n// IEEE754 conversions based on https://github.com/feross/ieee754\nfunction packIEEE754(value, mLen, nBytes) {\n  var buffer = new Array(nBytes);\n  var eLen = nBytes * 8 - mLen - 1;\n  var eMax = (1 << eLen) - 1;\n  var eBias = eMax >> 1;\n  var rt = mLen === 23 ? pow(2, -24) - pow(2, -77) : 0;\n  var i = 0;\n  var s = value < 0 || value === 0 && 1 / value < 0 ? 1 : 0;\n  var e, m, c;\n  value = abs(value);\n  // eslint-disable-next-line no-self-compare\n  if (value != value || value === Infinity) {\n    // eslint-disable-next-line no-self-compare\n    m = value != value ? 1 : 0;\n    e = eMax;\n  } else {\n    e = floor(log(value) / LN2);\n    if (value * (c = pow(2, -e)) < 1) {\n      e--;\n      c *= 2;\n    }\n    if (e + eBias >= 1) {\n      value += rt / c;\n    } else {\n      value += rt * pow(2, 1 - eBias);\n    }\n    if (value * c >= 2) {\n      e++;\n      c /= 2;\n    }\n    if (e + eBias >= eMax) {\n      m = 0;\n      e = eMax;\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * pow(2, mLen);\n      e = e + eBias;\n    } else {\n      m = value * pow(2, eBias - 1) * pow(2, mLen);\n      e = 0;\n    }\n  }\n  for (; mLen >= 8; buffer[i++] = m & 255, m /= 256, mLen -= 8);\n  e = e << mLen | m;\n  eLen += mLen;\n  for (; eLen > 0; buffer[i++] = e & 255, e /= 256, eLen -= 8);\n  buffer[--i] |= s * 128;\n  return buffer;\n}\nfunction unpackIEEE754(buffer, mLen, nBytes) {\n  var eLen = nBytes * 8 - mLen - 1;\n  var eMax = (1 << eLen) - 1;\n  var eBias = eMax >> 1;\n  var nBits = eLen - 7;\n  var i = nBytes - 1;\n  var s = buffer[i--];\n  var e = s & 127;\n  var m;\n  s >>= 7;\n  for (; nBits > 0; e = e * 256 + buffer[i], i--, nBits -= 8);\n  m = e & (1 << -nBits) - 1;\n  e >>= -nBits;\n  nBits += mLen;\n  for (; nBits > 0; m = m * 256 + buffer[i], i--, nBits -= 8);\n  if (e === 0) {\n    e = 1 - eBias;\n  } else if (e === eMax) {\n    return m ? NaN : s ? -Infinity : Infinity;\n  } else {\n    m = m + pow(2, mLen);\n    e = e - eBias;\n  } return (s ? -1 : 1) * m * pow(2, e - mLen);\n}\n\nfunction unpackI32(bytes) {\n  return bytes[3] << 24 | bytes[2] << 16 | bytes[1] << 8 | bytes[0];\n}\nfunction packI8(it) {\n  return [it & 0xff];\n}\nfunction packI16(it) {\n  return [it & 0xff, it >> 8 & 0xff];\n}\nfunction packI32(it) {\n  return [it & 0xff, it >> 8 & 0xff, it >> 16 & 0xff, it >> 24 & 0xff];\n}\nfunction packF64(it) {\n  return packIEEE754(it, 52, 8);\n}\nfunction packF32(it) {\n  return packIEEE754(it, 23, 4);\n}\n\nfunction addGetter(C, key, internal) {\n  dP(C[PROTOTYPE], key, { get: function () { return this[internal]; } });\n}\n\nfunction get(view, bytes, index, isLittleEndian) {\n  var numIndex = +index;\n  var intIndex = toIndex(numIndex);\n  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);\n  var store = view[$BUFFER]._b;\n  var start = intIndex + view[$OFFSET];\n  var pack = store.slice(start, start + bytes);\n  return isLittleEndian ? pack : pack.reverse();\n}\nfunction set(view, bytes, index, conversion, value, isLittleEndian) {\n  var numIndex = +index;\n  var intIndex = toIndex(numIndex);\n  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);\n  var store = view[$BUFFER]._b;\n  var start = intIndex + view[$OFFSET];\n  var pack = conversion(+value);\n  for (var i = 0; i < bytes; i++) store[start + i] = pack[isLittleEndian ? i : bytes - i - 1];\n}\n\nif (!$typed.ABV) {\n  $ArrayBuffer = function ArrayBuffer(length) {\n    anInstance(this, $ArrayBuffer, ARRAY_BUFFER);\n    var byteLength = toIndex(length);\n    this._b = arrayFill.call(new Array(byteLength), 0);\n    this[$LENGTH] = byteLength;\n  };\n\n  $DataView = function DataView(buffer, byteOffset, byteLength) {\n    anInstance(this, $DataView, DATA_VIEW);\n    anInstance(buffer, $ArrayBuffer, DATA_VIEW);\n    var bufferLength = buffer[$LENGTH];\n    var offset = toInteger(byteOffset);\n    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset!');\n    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);\n    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);\n    this[$BUFFER] = buffer;\n    this[$OFFSET] = offset;\n    this[$LENGTH] = byteLength;\n  };\n\n  if (DESCRIPTORS) {\n    addGetter($ArrayBuffer, BYTE_LENGTH, '_l');\n    addGetter($DataView, BUFFER, '_b');\n    addGetter($DataView, BYTE_LENGTH, '_l');\n    addGetter($DataView, BYTE_OFFSET, '_o');\n  }\n\n  redefineAll($DataView[PROTOTYPE], {\n    getInt8: function getInt8(byteOffset) {\n      return get(this, 1, byteOffset)[0] << 24 >> 24;\n    },\n    getUint8: function getUint8(byteOffset) {\n      return get(this, 1, byteOffset)[0];\n    },\n    getInt16: function getInt16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments[1]);\n      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;\n    },\n    getUint16: function getUint16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments[1]);\n      return bytes[1] << 8 | bytes[0];\n    },\n    getInt32: function getInt32(byteOffset /* , littleEndian */) {\n      return unpackI32(get(this, 4, byteOffset, arguments[1]));\n    },\n    getUint32: function getUint32(byteOffset /* , littleEndian */) {\n      return unpackI32(get(this, 4, byteOffset, arguments[1])) >>> 0;\n    },\n    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 4, byteOffset, arguments[1]), 23, 4);\n    },\n    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 8, byteOffset, arguments[1]), 52, 8);\n    },\n    setInt8: function setInt8(byteOffset, value) {\n      set(this, 1, byteOffset, packI8, value);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      set(this, 1, byteOffset, packI8, value);\n    },\n    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packI16, value, arguments[2]);\n    },\n    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packI16, value, arguments[2]);\n    },\n    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packI32, value, arguments[2]);\n    },\n    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packI32, value, arguments[2]);\n    },\n    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packF32, value, arguments[2]);\n    },\n    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {\n      set(this, 8, byteOffset, packF64, value, arguments[2]);\n    }\n  });\n} else {\n  if (!fails(function () {\n    $ArrayBuffer(1);\n  }) || !fails(function () {\n    new $ArrayBuffer(-1); // eslint-disable-line no-new\n  }) || fails(function () {\n    new $ArrayBuffer(); // eslint-disable-line no-new\n    new $ArrayBuffer(1.5); // eslint-disable-line no-new\n    new $ArrayBuffer(NaN); // eslint-disable-line no-new\n    return $ArrayBuffer.name != ARRAY_BUFFER;\n  })) {\n    $ArrayBuffer = function ArrayBuffer(length) {\n      anInstance(this, $ArrayBuffer);\n      return new BaseBuffer(toIndex(length));\n    };\n    var ArrayBufferProto = $ArrayBuffer[PROTOTYPE] = BaseBuffer[PROTOTYPE];\n    for (var keys = gOPN(BaseBuffer), j = 0, key; keys.length > j;) {\n      if (!((key = keys[j++]) in $ArrayBuffer)) hide($ArrayBuffer, key, BaseBuffer[key]);\n    }\n    if (!LIBRARY) ArrayBufferProto.constructor = $ArrayBuffer;\n  }\n  // iOS Safari 7.x bug\n  var view = new $DataView(new $ArrayBuffer(2));\n  var $setInt8 = $DataView[PROTOTYPE].setInt8;\n  view.setInt8(0, 2147483648);\n  view.setInt8(1, 2147483649);\n  if (view.getInt8(0) || !view.getInt8(1)) redefineAll($DataView[PROTOTYPE], {\n    setInt8: function setInt8(byteOffset, value) {\n      $setInt8.call(this, byteOffset, value << 24 >> 24);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      $setInt8.call(this, byteOffset, value << 24 >> 24);\n    }\n  }, true);\n}\nsetToStringTag($ArrayBuffer, ARRAY_BUFFER);\nsetToStringTag($DataView, DATA_VIEW);\nhide($DataView[PROTOTYPE], $typed.VIEW, true);\nexports[ARRAY_BUFFER] = $ArrayBuffer;\nexports[DATA_VIEW] = $DataView;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL190eXBlZC1idWZmZXIuanM/ZWQwYiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgREVTQ1JJUFRPUlMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpO1xudmFyIExJQlJBUlkgPSByZXF1aXJlKCcuL19saWJyYXJ5Jyk7XG52YXIgJHR5cGVkID0gcmVxdWlyZSgnLi9fdHlwZWQnKTtcbnZhciBoaWRlID0gcmVxdWlyZSgnLi9faGlkZScpO1xudmFyIHJlZGVmaW5lQWxsID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUtYWxsJyk7XG52YXIgZmFpbHMgPSByZXF1aXJlKCcuL19mYWlscycpO1xudmFyIGFuSW5zdGFuY2UgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpO1xudmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4vX3RvLWludGVnZXInKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpO1xudmFyIHRvSW5kZXggPSByZXF1aXJlKCcuL190by1pbmRleCcpO1xudmFyIGdPUE4gPSByZXF1aXJlKCcuL19vYmplY3QtZ29wbicpLmY7XG52YXIgZFAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mO1xudmFyIGFycmF5RmlsbCA9IHJlcXVpcmUoJy4vX2FycmF5LWZpbGwnKTtcbnZhciBzZXRUb1N0cmluZ1RhZyA9IHJlcXVpcmUoJy4vX3NldC10by1zdHJpbmctdGFnJyk7XG52YXIgQVJSQVlfQlVGRkVSID0gJ0FycmF5QnVmZmVyJztcbnZhciBEQVRBX1ZJRVcgPSAnRGF0YVZpZXcnO1xudmFyIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnO1xudmFyIFdST05HX0xFTkdUSCA9ICdXcm9uZyBsZW5ndGghJztcbnZhciBXUk9OR19JTkRFWCA9ICdXcm9uZyBpbmRleCEnO1xudmFyICRBcnJheUJ1ZmZlciA9IGdsb2JhbFtBUlJBWV9CVUZGRVJdO1xudmFyICREYXRhVmlldyA9IGdsb2JhbFtEQVRBX1ZJRVddO1xudmFyIE1hdGggPSBnbG9iYWwuTWF0aDtcbnZhciBSYW5nZUVycm9yID0gZ2xvYmFsLlJhbmdlRXJyb3I7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2hhZG93LXJlc3RyaWN0ZWQtbmFtZXNcbnZhciBJbmZpbml0eSA9IGdsb2JhbC5JbmZpbml0eTtcbnZhciBCYXNlQnVmZmVyID0gJEFycmF5QnVmZmVyO1xudmFyIGFicyA9IE1hdGguYWJzO1xudmFyIHBvdyA9IE1hdGgucG93O1xudmFyIGZsb29yID0gTWF0aC5mbG9vcjtcbnZhciBsb2cgPSBNYXRoLmxvZztcbnZhciBMTjIgPSBNYXRoLkxOMjtcbnZhciBCVUZGRVIgPSAnYnVmZmVyJztcbnZhciBCWVRFX0xFTkdUSCA9ICdieXRlTGVuZ3RoJztcbnZhciBCWVRFX09GRlNFVCA9ICdieXRlT2Zmc2V0JztcbnZhciAkQlVGRkVSID0gREVTQ1JJUFRPUlMgPyAnX2InIDogQlVGRkVSO1xudmFyICRMRU5HVEggPSBERVNDUklQVE9SUyA/ICdfbCcgOiBCWVRFX0xFTkdUSDtcbnZhciAkT0ZGU0VUID0gREVTQ1JJUFRPUlMgPyAnX28nIDogQllURV9PRkZTRVQ7XG5cbi8vIElFRUU3NTQgY29udmVyc2lvbnMgYmFzZWQgb24gaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9pZWVlNzU0XG5mdW5jdGlvbiBwYWNrSUVFRTc1NCh2YWx1ZSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBidWZmZXIgPSBuZXcgQXJyYXkobkJ5dGVzKTtcbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDE7XG4gIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxO1xuICB2YXIgZUJpYXMgPSBlTWF4ID4+IDE7XG4gIHZhciBydCA9IG1MZW4gPT09IDIzID8gcG93KDIsIC0yNCkgLSBwb3coMiwgLTc3KSA6IDA7XG4gIHZhciBpID0gMDtcbiAgdmFyIHMgPSB2YWx1ZSA8IDAgfHwgdmFsdWUgPT09IDAgJiYgMSAvIHZhbHVlIDwgMCA/IDEgOiAwO1xuICB2YXIgZSwgbSwgYztcbiAgdmFsdWUgPSBhYnModmFsdWUpO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gIGlmICh2YWx1ZSAhPSB2YWx1ZSB8fCB2YWx1ZSA9PT0gSW5maW5pdHkpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgbSA9IHZhbHVlICE9IHZhbHVlID8gMSA6IDA7XG4gICAgZSA9IGVNYXg7XG4gIH0gZWxzZSB7XG4gICAgZSA9IGZsb29yKGxvZyh2YWx1ZSkgLyBMTjIpO1xuICAgIGlmICh2YWx1ZSAqIChjID0gcG93KDIsIC1lKSkgPCAxKSB7XG4gICAgICBlLS07XG4gICAgICBjICo9IDI7XG4gICAgfVxuICAgIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgdmFsdWUgKz0gcnQgLyBjO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSArPSBydCAqIHBvdygyLCAxIC0gZUJpYXMpO1xuICAgIH1cbiAgICBpZiAodmFsdWUgKiBjID49IDIpIHtcbiAgICAgIGUrKztcbiAgICAgIGMgLz0gMjtcbiAgICB9XG4gICAgaWYgKGUgKyBlQmlhcyA+PSBlTWF4KSB7XG4gICAgICBtID0gMDtcbiAgICAgIGUgPSBlTWF4O1xuICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBwb3coMiwgbUxlbik7XG4gICAgICBlID0gZSArIGVCaWFzO1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gdmFsdWUgKiBwb3coMiwgZUJpYXMgLSAxKSAqIHBvdygyLCBtTGVuKTtcbiAgICAgIGUgPSAwO1xuICAgIH1cbiAgfVxuICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbaSsrXSA9IG0gJiAyNTUsIG0gLz0gMjU2LCBtTGVuIC09IDgpO1xuICBlID0gZSA8PCBtTGVuIHwgbTtcbiAgZUxlbiArPSBtTGVuO1xuICBmb3IgKDsgZUxlbiA+IDA7IGJ1ZmZlcltpKytdID0gZSAmIDI1NSwgZSAvPSAyNTYsIGVMZW4gLT0gOCk7XG4gIGJ1ZmZlclstLWldIHw9IHMgKiAxMjg7XG4gIHJldHVybiBidWZmZXI7XG59XG5mdW5jdGlvbiB1bnBhY2tJRUVFNzU0KGJ1ZmZlciwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxO1xuICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMTtcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxO1xuICB2YXIgbkJpdHMgPSBlTGVuIC0gNztcbiAgdmFyIGkgPSBuQnl0ZXMgLSAxO1xuICB2YXIgcyA9IGJ1ZmZlcltpLS1dO1xuICB2YXIgZSA9IHMgJiAxMjc7XG4gIHZhciBtO1xuICBzID4+PSA3O1xuICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gZSAqIDI1NiArIGJ1ZmZlcltpXSwgaS0tLCBuQml0cyAtPSA4KTtcbiAgbSA9IGUgJiAoMSA8PCAtbkJpdHMpIC0gMTtcbiAgZSA+Pj0gLW5CaXRzO1xuICBuQml0cyArPSBtTGVuO1xuICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltpXSwgaS0tLCBuQml0cyAtPSA4KTtcbiAgaWYgKGUgPT09IDApIHtcbiAgICBlID0gMSAtIGVCaWFzO1xuICB9IGVsc2UgaWYgKGUgPT09IGVNYXgpIHtcbiAgICByZXR1cm4gbSA/IE5hTiA6IHMgPyAtSW5maW5pdHkgOiBJbmZpbml0eTtcbiAgfSBlbHNlIHtcbiAgICBtID0gbSArIHBvdygyLCBtTGVuKTtcbiAgICBlID0gZSAtIGVCaWFzO1xuICB9IHJldHVybiAocyA/IC0xIDogMSkgKiBtICogcG93KDIsIGUgLSBtTGVuKTtcbn1cblxuZnVuY3Rpb24gdW5wYWNrSTMyKGJ5dGVzKSB7XG4gIHJldHVybiBieXRlc1szXSA8PCAyNCB8IGJ5dGVzWzJdIDw8IDE2IHwgYnl0ZXNbMV0gPDwgOCB8IGJ5dGVzWzBdO1xufVxuZnVuY3Rpb24gcGFja0k4KGl0KSB7XG4gIHJldHVybiBbaXQgJiAweGZmXTtcbn1cbmZ1bmN0aW9uIHBhY2tJMTYoaXQpIHtcbiAgcmV0dXJuIFtpdCAmIDB4ZmYsIGl0ID4+IDggJiAweGZmXTtcbn1cbmZ1bmN0aW9uIHBhY2tJMzIoaXQpIHtcbiAgcmV0dXJuIFtpdCAmIDB4ZmYsIGl0ID4+IDggJiAweGZmLCBpdCA+PiAxNiAmIDB4ZmYsIGl0ID4+IDI0ICYgMHhmZl07XG59XG5mdW5jdGlvbiBwYWNrRjY0KGl0KSB7XG4gIHJldHVybiBwYWNrSUVFRTc1NChpdCwgNTIsIDgpO1xufVxuZnVuY3Rpb24gcGFja0YzMihpdCkge1xuICByZXR1cm4gcGFja0lFRUU3NTQoaXQsIDIzLCA0KTtcbn1cblxuZnVuY3Rpb24gYWRkR2V0dGVyKEMsIGtleSwgaW50ZXJuYWwpIHtcbiAgZFAoQ1tQUk9UT1RZUEVdLCBrZXksIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzW2ludGVybmFsXTsgfSB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0KHZpZXcsIGJ5dGVzLCBpbmRleCwgaXNMaXR0bGVFbmRpYW4pIHtcbiAgdmFyIG51bUluZGV4ID0gK2luZGV4O1xuICB2YXIgaW50SW5kZXggPSB0b0luZGV4KG51bUluZGV4KTtcbiAgaWYgKGludEluZGV4ICsgYnl0ZXMgPiB2aWV3WyRMRU5HVEhdKSB0aHJvdyBSYW5nZUVycm9yKFdST05HX0lOREVYKTtcbiAgdmFyIHN0b3JlID0gdmlld1skQlVGRkVSXS5fYjtcbiAgdmFyIHN0YXJ0ID0gaW50SW5kZXggKyB2aWV3WyRPRkZTRVRdO1xuICB2YXIgcGFjayA9IHN0b3JlLnNsaWNlKHN0YXJ0LCBzdGFydCArIGJ5dGVzKTtcbiAgcmV0dXJuIGlzTGl0dGxlRW5kaWFuID8gcGFjayA6IHBhY2sucmV2ZXJzZSgpO1xufVxuZnVuY3Rpb24gc2V0KHZpZXcsIGJ5dGVzLCBpbmRleCwgY29udmVyc2lvbiwgdmFsdWUsIGlzTGl0dGxlRW5kaWFuKSB7XG4gIHZhciBudW1JbmRleCA9ICtpbmRleDtcbiAgdmFyIGludEluZGV4ID0gdG9JbmRleChudW1JbmRleCk7XG4gIGlmIChpbnRJbmRleCArIGJ5dGVzID4gdmlld1skTEVOR1RIXSkgdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19JTkRFWCk7XG4gIHZhciBzdG9yZSA9IHZpZXdbJEJVRkZFUl0uX2I7XG4gIHZhciBzdGFydCA9IGludEluZGV4ICsgdmlld1skT0ZGU0VUXTtcbiAgdmFyIHBhY2sgPSBjb252ZXJzaW9uKCt2YWx1ZSk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXM7IGkrKykgc3RvcmVbc3RhcnQgKyBpXSA9IHBhY2tbaXNMaXR0bGVFbmRpYW4gPyBpIDogYnl0ZXMgLSBpIC0gMV07XG59XG5cbmlmICghJHR5cGVkLkFCVikge1xuICAkQXJyYXlCdWZmZXIgPSBmdW5jdGlvbiBBcnJheUJ1ZmZlcihsZW5ndGgpIHtcbiAgICBhbkluc3RhbmNlKHRoaXMsICRBcnJheUJ1ZmZlciwgQVJSQVlfQlVGRkVSKTtcbiAgICB2YXIgYnl0ZUxlbmd0aCA9IHRvSW5kZXgobGVuZ3RoKTtcbiAgICB0aGlzLl9iID0gYXJyYXlGaWxsLmNhbGwobmV3IEFycmF5KGJ5dGVMZW5ndGgpLCAwKTtcbiAgICB0aGlzWyRMRU5HVEhdID0gYnl0ZUxlbmd0aDtcbiAgfTtcblxuICAkRGF0YVZpZXcgPSBmdW5jdGlvbiBEYXRhVmlldyhidWZmZXIsIGJ5dGVPZmZzZXQsIGJ5dGVMZW5ndGgpIHtcbiAgICBhbkluc3RhbmNlKHRoaXMsICREYXRhVmlldywgREFUQV9WSUVXKTtcbiAgICBhbkluc3RhbmNlKGJ1ZmZlciwgJEFycmF5QnVmZmVyLCBEQVRBX1ZJRVcpO1xuICAgIHZhciBidWZmZXJMZW5ndGggPSBidWZmZXJbJExFTkdUSF07XG4gICAgdmFyIG9mZnNldCA9IHRvSW50ZWdlcihieXRlT2Zmc2V0KTtcbiAgICBpZiAob2Zmc2V0IDwgMCB8fCBvZmZzZXQgPiBidWZmZXJMZW5ndGgpIHRocm93IFJhbmdlRXJyb3IoJ1dyb25nIG9mZnNldCEnKTtcbiAgICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA9PT0gdW5kZWZpbmVkID8gYnVmZmVyTGVuZ3RoIC0gb2Zmc2V0IDogdG9MZW5ndGgoYnl0ZUxlbmd0aCk7XG4gICAgaWYgKG9mZnNldCArIGJ5dGVMZW5ndGggPiBidWZmZXJMZW5ndGgpIHRocm93IFJhbmdlRXJyb3IoV1JPTkdfTEVOR1RIKTtcbiAgICB0aGlzWyRCVUZGRVJdID0gYnVmZmVyO1xuICAgIHRoaXNbJE9GRlNFVF0gPSBvZmZzZXQ7XG4gICAgdGhpc1skTEVOR1RIXSA9IGJ5dGVMZW5ndGg7XG4gIH07XG5cbiAgaWYgKERFU0NSSVBUT1JTKSB7XG4gICAgYWRkR2V0dGVyKCRBcnJheUJ1ZmZlciwgQllURV9MRU5HVEgsICdfbCcpO1xuICAgIGFkZEdldHRlcigkRGF0YVZpZXcsIEJVRkZFUiwgJ19iJyk7XG4gICAgYWRkR2V0dGVyKCREYXRhVmlldywgQllURV9MRU5HVEgsICdfbCcpO1xuICAgIGFkZEdldHRlcigkRGF0YVZpZXcsIEJZVEVfT0ZGU0VULCAnX28nKTtcbiAgfVxuXG4gIHJlZGVmaW5lQWxsKCREYXRhVmlld1tQUk9UT1RZUEVdLCB7XG4gICAgZ2V0SW50ODogZnVuY3Rpb24gZ2V0SW50OChieXRlT2Zmc2V0KSB7XG4gICAgICByZXR1cm4gZ2V0KHRoaXMsIDEsIGJ5dGVPZmZzZXQpWzBdIDw8IDI0ID4+IDI0O1xuICAgIH0sXG4gICAgZ2V0VWludDg6IGZ1bmN0aW9uIGdldFVpbnQ4KGJ5dGVPZmZzZXQpIHtcbiAgICAgIHJldHVybiBnZXQodGhpcywgMSwgYnl0ZU9mZnNldClbMF07XG4gICAgfSxcbiAgICBnZXRJbnQxNjogZnVuY3Rpb24gZ2V0SW50MTYoYnl0ZU9mZnNldCAvKiAsIGxpdHRsZUVuZGlhbiAqLykge1xuICAgICAgdmFyIGJ5dGVzID0gZ2V0KHRoaXMsIDIsIGJ5dGVPZmZzZXQsIGFyZ3VtZW50c1sxXSk7XG4gICAgICByZXR1cm4gKGJ5dGVzWzFdIDw8IDggfCBieXRlc1swXSkgPDwgMTYgPj4gMTY7XG4gICAgfSxcbiAgICBnZXRVaW50MTY6IGZ1bmN0aW9uIGdldFVpbnQxNihieXRlT2Zmc2V0IC8qICwgbGl0dGxlRW5kaWFuICovKSB7XG4gICAgICB2YXIgYnl0ZXMgPSBnZXQodGhpcywgMiwgYnl0ZU9mZnNldCwgYXJndW1lbnRzWzFdKTtcbiAgICAgIHJldHVybiBieXRlc1sxXSA8PCA4IHwgYnl0ZXNbMF07XG4gICAgfSxcbiAgICBnZXRJbnQzMjogZnVuY3Rpb24gZ2V0SW50MzIoYnl0ZU9mZnNldCAvKiAsIGxpdHRsZUVuZGlhbiAqLykge1xuICAgICAgcmV0dXJuIHVucGFja0kzMihnZXQodGhpcywgNCwgYnl0ZU9mZnNldCwgYXJndW1lbnRzWzFdKSk7XG4gICAgfSxcbiAgICBnZXRVaW50MzI6IGZ1bmN0aW9uIGdldFVpbnQzMihieXRlT2Zmc2V0IC8qICwgbGl0dGxlRW5kaWFuICovKSB7XG4gICAgICByZXR1cm4gdW5wYWNrSTMyKGdldCh0aGlzLCA0LCBieXRlT2Zmc2V0LCBhcmd1bWVudHNbMV0pKSA+Pj4gMDtcbiAgICB9LFxuICAgIGdldEZsb2F0MzI6IGZ1bmN0aW9uIGdldEZsb2F0MzIoYnl0ZU9mZnNldCAvKiAsIGxpdHRsZUVuZGlhbiAqLykge1xuICAgICAgcmV0dXJuIHVucGFja0lFRUU3NTQoZ2V0KHRoaXMsIDQsIGJ5dGVPZmZzZXQsIGFyZ3VtZW50c1sxXSksIDIzLCA0KTtcbiAgICB9LFxuICAgIGdldEZsb2F0NjQ6IGZ1bmN0aW9uIGdldEZsb2F0NjQoYnl0ZU9mZnNldCAvKiAsIGxpdHRsZUVuZGlhbiAqLykge1xuICAgICAgcmV0dXJuIHVucGFja0lFRUU3NTQoZ2V0KHRoaXMsIDgsIGJ5dGVPZmZzZXQsIGFyZ3VtZW50c1sxXSksIDUyLCA4KTtcbiAgICB9LFxuICAgIHNldEludDg6IGZ1bmN0aW9uIHNldEludDgoYnl0ZU9mZnNldCwgdmFsdWUpIHtcbiAgICAgIHNldCh0aGlzLCAxLCBieXRlT2Zmc2V0LCBwYWNrSTgsIHZhbHVlKTtcbiAgICB9LFxuICAgIHNldFVpbnQ4OiBmdW5jdGlvbiBzZXRVaW50OChieXRlT2Zmc2V0LCB2YWx1ZSkge1xuICAgICAgc2V0KHRoaXMsIDEsIGJ5dGVPZmZzZXQsIHBhY2tJOCwgdmFsdWUpO1xuICAgIH0sXG4gICAgc2V0SW50MTY6IGZ1bmN0aW9uIHNldEludDE2KGJ5dGVPZmZzZXQsIHZhbHVlIC8qICwgbGl0dGxlRW5kaWFuICovKSB7XG4gICAgICBzZXQodGhpcywgMiwgYnl0ZU9mZnNldCwgcGFja0kxNiwgdmFsdWUsIGFyZ3VtZW50c1syXSk7XG4gICAgfSxcbiAgICBzZXRVaW50MTY6IGZ1bmN0aW9uIHNldFVpbnQxNihieXRlT2Zmc2V0LCB2YWx1ZSAvKiAsIGxpdHRsZUVuZGlhbiAqLykge1xuICAgICAgc2V0KHRoaXMsIDIsIGJ5dGVPZmZzZXQsIHBhY2tJMTYsIHZhbHVlLCBhcmd1bWVudHNbMl0pO1xuICAgIH0sXG4gICAgc2V0SW50MzI6IGZ1bmN0aW9uIHNldEludDMyKGJ5dGVPZmZzZXQsIHZhbHVlIC8qICwgbGl0dGxlRW5kaWFuICovKSB7XG4gICAgICBzZXQodGhpcywgNCwgYnl0ZU9mZnNldCwgcGFja0kzMiwgdmFsdWUsIGFyZ3VtZW50c1syXSk7XG4gICAgfSxcbiAgICBzZXRVaW50MzI6IGZ1bmN0aW9uIHNldFVpbnQzMihieXRlT2Zmc2V0LCB2YWx1ZSAvKiAsIGxpdHRsZUVuZGlhbiAqLykge1xuICAgICAgc2V0KHRoaXMsIDQsIGJ5dGVPZmZzZXQsIHBhY2tJMzIsIHZhbHVlLCBhcmd1bWVudHNbMl0pO1xuICAgIH0sXG4gICAgc2V0RmxvYXQzMjogZnVuY3Rpb24gc2V0RmxvYXQzMihieXRlT2Zmc2V0LCB2YWx1ZSAvKiAsIGxpdHRsZUVuZGlhbiAqLykge1xuICAgICAgc2V0KHRoaXMsIDQsIGJ5dGVPZmZzZXQsIHBhY2tGMzIsIHZhbHVlLCBhcmd1bWVudHNbMl0pO1xuICAgIH0sXG4gICAgc2V0RmxvYXQ2NDogZnVuY3Rpb24gc2V0RmxvYXQ2NChieXRlT2Zmc2V0LCB2YWx1ZSAvKiAsIGxpdHRsZUVuZGlhbiAqLykge1xuICAgICAgc2V0KHRoaXMsIDgsIGJ5dGVPZmZzZXQsIHBhY2tGNjQsIHZhbHVlLCBhcmd1bWVudHNbMl0pO1xuICAgIH1cbiAgfSk7XG59IGVsc2Uge1xuICBpZiAoIWZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgICAkQXJyYXlCdWZmZXIoMSk7XG4gIH0pIHx8ICFmYWlscyhmdW5jdGlvbiAoKSB7XG4gICAgbmV3ICRBcnJheUJ1ZmZlcigtMSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3XG4gIH0pIHx8IGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgICBuZXcgJEFycmF5QnVmZmVyKCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3XG4gICAgbmV3ICRBcnJheUJ1ZmZlcigxLjUpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ld1xuICAgIG5ldyAkQXJyYXlCdWZmZXIoTmFOKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXdcbiAgICByZXR1cm4gJEFycmF5QnVmZmVyLm5hbWUgIT0gQVJSQVlfQlVGRkVSO1xuICB9KSkge1xuICAgICRBcnJheUJ1ZmZlciA9IGZ1bmN0aW9uIEFycmF5QnVmZmVyKGxlbmd0aCkge1xuICAgICAgYW5JbnN0YW5jZSh0aGlzLCAkQXJyYXlCdWZmZXIpO1xuICAgICAgcmV0dXJuIG5ldyBCYXNlQnVmZmVyKHRvSW5kZXgobGVuZ3RoKSk7XG4gICAgfTtcbiAgICB2YXIgQXJyYXlCdWZmZXJQcm90byA9ICRBcnJheUJ1ZmZlcltQUk9UT1RZUEVdID0gQmFzZUJ1ZmZlcltQUk9UT1RZUEVdO1xuICAgIGZvciAodmFyIGtleXMgPSBnT1BOKEJhc2VCdWZmZXIpLCBqID0gMCwga2V5OyBrZXlzLmxlbmd0aCA+IGo7KSB7XG4gICAgICBpZiAoISgoa2V5ID0ga2V5c1tqKytdKSBpbiAkQXJyYXlCdWZmZXIpKSBoaWRlKCRBcnJheUJ1ZmZlciwga2V5LCBCYXNlQnVmZmVyW2tleV0pO1xuICAgIH1cbiAgICBpZiAoIUxJQlJBUlkpIEFycmF5QnVmZmVyUHJvdG8uY29uc3RydWN0b3IgPSAkQXJyYXlCdWZmZXI7XG4gIH1cbiAgLy8gaU9TIFNhZmFyaSA3LnggYnVnXG4gIHZhciB2aWV3ID0gbmV3ICREYXRhVmlldyhuZXcgJEFycmF5QnVmZmVyKDIpKTtcbiAgdmFyICRzZXRJbnQ4ID0gJERhdGFWaWV3W1BST1RPVFlQRV0uc2V0SW50ODtcbiAgdmlldy5zZXRJbnQ4KDAsIDIxNDc0ODM2NDgpO1xuICB2aWV3LnNldEludDgoMSwgMjE0NzQ4MzY0OSk7XG4gIGlmICh2aWV3LmdldEludDgoMCkgfHwgIXZpZXcuZ2V0SW50OCgxKSkgcmVkZWZpbmVBbGwoJERhdGFWaWV3W1BST1RPVFlQRV0sIHtcbiAgICBzZXRJbnQ4OiBmdW5jdGlvbiBzZXRJbnQ4KGJ5dGVPZmZzZXQsIHZhbHVlKSB7XG4gICAgICAkc2V0SW50OC5jYWxsKHRoaXMsIGJ5dGVPZmZzZXQsIHZhbHVlIDw8IDI0ID4+IDI0KTtcbiAgICB9LFxuICAgIHNldFVpbnQ4OiBmdW5jdGlvbiBzZXRVaW50OChieXRlT2Zmc2V0LCB2YWx1ZSkge1xuICAgICAgJHNldEludDguY2FsbCh0aGlzLCBieXRlT2Zmc2V0LCB2YWx1ZSA8PCAyNCA+PiAyNCk7XG4gICAgfVxuICB9LCB0cnVlKTtcbn1cbnNldFRvU3RyaW5nVGFnKCRBcnJheUJ1ZmZlciwgQVJSQVlfQlVGRkVSKTtcbnNldFRvU3RyaW5nVGFnKCREYXRhVmlldywgREFUQV9WSUVXKTtcbmhpZGUoJERhdGFWaWV3W1BST1RPVFlQRV0sICR0eXBlZC5WSUVXLCB0cnVlKTtcbmV4cG9ydHNbQVJSQVlfQlVGRkVSXSA9ICRBcnJheUJ1ZmZlcjtcbmV4cG9ydHNbREFUQV9WSUVXXSA9ICREYXRhVmlldztcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///81\n")},function(module,exports){eval('//     proxy-observe v0.0.18\r\n//     Copyright (c) 2015, 2016 Simon Y. Blackwell, AnyWhichWay\r\n//     MIT License - http://opensource.org/licenses/mit-license.php\r\n(function() {\r\n\t"use strict";\r\n\t// Creates and returns a Proxy wrapping a target so that all changes can be trapped and forwarded to\r\n\t// a callback. The callback takes an array of changes just like the traditional original Chrome Object.observe\r\n\t// {object:<object changed>,name:<field changed>,type:add|update|delete|reconfigure|preventExtensions|setPrototype,oldValue:<old value if update | delete>}\r\n\t// The acceptlist can be add|update|delete|reconfigure|preventExtensions|setPrototype.\r\n\t// v 0.0.10 to support pausing and restarting observation two additional constructor arguments are available to Object.observe:\r\n\t// pausable - create the Observer so it can be paused\r\n\t// pause - create observer in paused state\r\n\t// if pausable is true then an additional method deliver(ignorePrevious) is available to start delivery\r\n\t// to pause delivery set a property called pause on the function deliver to true\r\n\t// pausable is optional to reduce the chance of shadowing a property or method on any existing code called deliver\r\n\tif(!Object.observe && typeof(Proxy)==="function") {\r\n\t\tfunction Observer(target,callback,acceptlist,pausable,pause,delay) {\r\n\t    \tvar me = this, proxy;\r\n\t    \tfunction deliver(ignorePrevious,delay) {\r\n\t    \t\tdeliver.delay = delay;\r\n\t    \t\tif(!deliver.pause) {\r\n\t        \t\tif(me.changeset.length>0) {\r\n\t        \t\t\tif(!ignorePrevious) {\r\n\t\t    \t    \t\tvar changes = me.changeset.filter(function(change) { return !acceptlist || acceptlist.indexOf(change.type)>=0; });\r\n\t\t        \t\t\tif(changes.length>0) {\r\n\t\t        \t\t\t\tcallback(changes);\r\n\t\t        \t\t\t}\r\n\t        \t\t\t}\r\n\t        \t\t\tme.changeset = [];\r\n\t        \t\t}\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \tdeliver.pause = pause;\r\n\t    \tdeliver.delay = delay;\r\n\t\t    me.get = function(target, property) {\r\n\t\t    \tif(property==="__observer__") {\r\n\t\t    \t\treturn me;\r\n\t\t    \t}\r\n\t\t    \tif(property==="unobserve") {\r\n\t\t    \t\treturn function() {\r\n\t\t    \t\t\tObject.unobserve(target);\r\n\t\t    \t\t\treturn target;\r\n\t\t    \t\t};\r\n\t\t    \t}\r\n\t\t    \tif(property==="deliver") {\r\n\t\t    \t\treturn deliver;\r\n\t\t    \t}\r\n\t\t    \treturn target[property];\r\n\t\t    }\r\n\t    \tme.target = target;\r\n\t    \tme.changeset = [];\r\n\t    \tif(!me.target.__observerCallbacks__) {\r\n\t    \t\t// __observerCallbacks__ is used as an index to get at the proxy which is the observer, so we can unobserve\r\n\t    \t\tObject.defineProperty(target,"__observerCallbacks__",{enumerable:false,configurable:true,writable:false,value:[]});\r\n\t    \t\tObject.defineProperty(target,"__observers__",{enumerable:false,configurable:true,writable:false,value:[]});\r\n\t    \t}\r\n\t    \tme.target.__observerCallbacks__.push(callback);\r\n\t    \tme.target.__observers__.push(this);\r\n\t    \tproxy = new Proxy(target,me);\r\n\t    \tdeliver(false,delay);\r\n\t    \treturn proxy;\r\n\t    }\r\n\t\tObserver.prototype.deliver = function() {\r\n\t\t\treturn this.get(null,"deliver");\r\n\t\t}\r\n\t    Observer.prototype.set = function(target, property, value) { // , receiver\r\n\t    \tvar oldvalue = target[property];\r\n\t    \tvar type = (oldvalue===undefined ? "add" : "update");\r\n\t    \ttarget[property] = value;\r\n\t    \tif(target.__observers__.indexOf(this)>=0 && (!this.acceptlist || this.acceptlist.indexOf(type)>=0)) {\r\n\t        \tvar change = {object:target,name:property,type:type},\r\n\t        \t\tstart = this.changeset.length === 0,\r\n\t        \t\tdeliver = this.deliver();\r\n\t        \tif(type==="update") {\r\n\t        \t\tchange.oldValue = oldvalue;\r\n\t        \t}\r\n\t        \tthis.changeset.push(change);\r\n\t        \tif(start) {\r\n\t        \t\tdeliver(false,(typeof(deliver.delay)==="number" ? deliver.delay : 10));\r\n\t        \t}\r\n\t    \t}\r\n\t    \treturn true;\r\n\t    };\r\n\t    Observer.prototype.deleteProperty = function(target, property) {\r\n\t    \tvar oldvalue = target[property];\r\n\t    \t//if(typeof(oldvalue)!=="undefined") {\r\n\t\t    \tdelete target[property];\r\n\t\t    \tif(target.__observers__.indexOf(this)>=0 && !this.acceptlist || this.acceptlist.indexOf("delete")>=0) {\r\n\t\t        \tvar change = {object:target,name:property,type:"delete",oldValue:oldvalue},\r\n\t\t        \t\tstart = this.changeset.length === 0,\r\n\t\t        \t\tdeliver = this.deliver();\r\n\t\t        \tthis.changeset.push(change);\r\n\t\t        \tif(start) {\r\n\t\t        \t\tdeliver(false,(typeof(deliver.delay)==="number" ? deliver.delay : 10));\r\n\t\t        \t}\r\n\t\t    \t}\r\n\t    \t//}\r\n\t    \treturn true;\r\n\t    };\r\n\t    Observer.prototype.defineProperty = function(target, property, descriptor) {\r\n\t    \tObject.defineProperty(target, property, descriptor);\r\n\t    \tif(target.__observers__.indexOf(this)>=0 && !this.acceptlist || this.acceptlist.indexOf("reconfigure")>=0) {\r\n\t        \tvar change = {object:target,name:property,type:"reconfigure"},\r\n        \t\t\tstart = this.changeset.length === 0,\r\n        \t\t\tdeliver = this.deliver();\r\n\t        \tthis.changeset.push(change);\r\n\t        \tif(start) {\r\n\t        \t\tdeliver(false,(typeof(deliver.delay)==="number" ? deliver.delay : 10));\r\n\t        \t}\r\n\t    \t}\r\n\t    \treturn true;\r\n\t    };\r\n\t    Observer.prototype.setPrototypeOf = function(target, prototype) {\r\n\t    \tvar oldvalue = Object.getPrototypeOf(target);\r\n\t    \tObject.setPrototypeOf(target, prototype);\r\n\t    \tif(target.__observers__.indexOf(this)>=0 && !this.acceptlist || this.acceptlist.indexOf("setPrototype")>=0) {\r\n\t        \tvar change = {object:target,name:"__proto__",type:"setPrototype",oldValue:oldvalue},\r\n    \t\t\t\tstart = this.changeset.length === 0,\r\n    \t\t\t\tdeliver = this.deliver();\r\n\t        \tthis.changeset.push(change);\r\n\t        \tif(start) {\r\n\t        \t\tdeliver(false,(typeof(deliver.delay)==="number" ? deliver.delay : 10));\r\n\t        \t}\r\n\t    \t}\r\n\t    \treturn true;\r\n\t    };\r\n\t    Observer.prototype.preventExtensions = function(target) {\r\n\t        Object.preventExtensions(target);\r\n\t    \tif(target.__observers__.indexOf(this)>=0 && !this.acceptlist || this.acceptlist.indexOf("preventExtensions")>=0) {\r\n\t        \tvar change = {object:target,type:"preventExtensions"},\r\n\t\t\t\t\tstart = this.changeset.length === 0,\r\n\t\t\t\t\tdeliver = this.deliver();\r\n\t        \tthis.changeset.push(change);\r\n\t        \tif(start) {\r\n\t        \t\tdeliver(false,(typeof(deliver.delay)==="number" ? deliver.delay : 10));\r\n\t        \t}\r\n\t    \t}\r\n\t    \treturn true;\r\n\t    };\r\n\t    Object.observe = function(object,callback,acceptlist,pausable,pause,delay) {\r\n\t    \treturn new Observer(object,callback,acceptlist,pausable,pause,delay);\r\n\t    };\r\n\t    Object.unobserve = function(object,callback) {\r\n\t    \tif(object.__observerCallbacks__) {\r\n\t    \t\tif(!callback) {\r\n\t    \t\t\tobject.__observerCallbacks__.splice(0,object.__observerCallbacks__.length);\r\n\t    \t\t\tobject.__observers__.splice(0,object.__observers__.length);\r\n\t    \t\t\treturn;\r\n\t    \t\t}\r\n\t    \t\tobject.__observerCallbacks__.forEach(function(observercallback,i) {\r\n\t    \t\t\tif(callback===observercallback) {\r\n\t    \t\t\t\tobject.__observerCallbacks__.splice(i,1);\r\n\t    \t\t\t\tdelete object.__observers__[i].callback;\r\n\t    \t\t\t\tobject.__observers__.splice(i,1);\r\n\t    \t\t\t}\r\n\t    \t\t});\r\n\t    \t}\r\n\t    };\r\n\t    Array.observe = function(object,callback,acceptlist,pausable,pause,delay) {\r\n\t    \tif(!(object instanceof Array) && !Array.isArray(object)) {\r\n\t    \t\tthrow new TypeError("First argument to Array.observer is not an Array");\r\n\t    \t}\r\n            \tacceptlist = acceptlist || ["add", "update", "delete", "splice"];\r\n\t    \tvar arrayproxy = new Proxy(object,{get: function(target,property) {\r\n\t    \t\tif(property==="unobserve") {\r\n\t\t    \t\treturn function(callback) {\r\n\t\t    \t\t\tif(callback) {\r\n\t\t    \t\t\t\treturn Object.unobserve(target,callback);\r\n\t\t    \t\t\t}\r\n\t\t    \t\t\treturn target.unobserve();\r\n\t\t    \t\t};\r\n\t\t    \t}\r\n\t    \t\tif(property==="splice") {\r\n\t    \t\t\treturn function(start,end) {\r\n\t    \t\t\t\tif(typeof(start)!=="number" || typeof(end)!=="number") {\r\n\t    \t\t\t\t\tthrow new TypeError("First two arguments to Array splice are not number, number");\r\n\t    \t\t\t\t}\r\n\t    \t    \t\tvar removed = this.slice(start,start+end),\r\n\t    \t    \t\t\taddedCount = (arguments.length > 1 ? arguments.length-2 : 0),\r\n\t    \t    \t\t\tchange =  {object:object,type:"splice",index:start,removed:removed,addedCount:addedCount};\r\n\t    \t    \t\ttarget.splice.apply(target,arguments);\r\n\t    \t    \t\tif(acceptlist.indexOf("splice")>=0) {\r\n\t    \t    \t\t\tvar start = proxy.__observer__.changeset.length === 0,\r\n\t    \t        \t\t\tdeliver = proxy.__observer__.deliver();\r\n\t    \t    \t\t\tproxy.__observer__.changeset.push(change);\r\n\t    \t    \t\t\tif(start) {\r\n\t    \t\t        \t\tdeliver(false,(typeof(deliver.delay)==="number" ? deliver.delay : 10));\r\n\t    \t\t        \t}\r\n\t    \t    \t\t}\r\n\t    \t    \t}\r\n\t    \t\t}\r\n\t    \t\tif(property==="push") {\r\n\t    \t\t\t return function(item) {\r\n\t    \t\t    \treturn this.splice(this.length,0,item);\r\n\t    \t\t    }\r\n\t    \t\t}\r\n\t    \t\tif(property==="pop") {\r\n\t    \t\t\t return function() {\r\n\t    \t\t    \treturn this.splice(this.length-1,1);\r\n\t    \t\t    }\r\n\t    \t\t}\r\n\t    \t\tif(property==="unshift") {\r\n\t    \t\t\t return function(item) {\r\n    \t\t    \t\treturn this.splice(0,0,item);\r\n    \t\t    \t}\r\n\t    \t\t}\r\n\t    \t\tif(property==="shift") {\r\n\t    \t\t\treturn function() {\r\n\t    \t    \t\treturn this.splice(0,1);\r\n\t    \t    \t}\r\n\t    \t\t}\r\n\t    \t\treturn target[property];\r\n\t    \t}});\r\n\t    \tvar proxy = Object.observe(arrayproxy,function(changeset) { \r\n\t    \t\tvar changes = changeset.filter(function(change) { return change.name!=="length" && change.name!=="add" && (!acceptlist || acceptlist.indexOf(change.type)>=0); });\r\n\t    \t\tif(changes.length>0) {\r\n\t    \t\t\tcallback(changes);\r\n\t    \t\t}\r\n\t    \t},acceptlist,pausable,pause,delay);\r\n\t    \treturn proxy;\r\n\t    };\r\n\t    Array.unobserve = function(object,callback) {\r\n\t\t  return object.unobserve(callback);\r\n\t    }\r\n\t}\r\n\tObject.deepObserve = function(object,callback,parts) {\r\n\r\n\t\tparts = (parts ? parts : []);\r\n\r\n\t\tvar toTypeName = function(obj) {\r\n\t\t\treturn ({}).toString.call(obj).match(/\\s([a-zA-Z]+)/)[1].toLowerCase()\r\n\t\t}\r\n\r\n\t\tfunction reobserve(value, parts) {\r\n\t\t\tvar keys = Object.keys(value);\r\n\t\t\tkeys.forEach(function(key) {\r\n\t\t\t\tif((toTypeName(value[key]) === \'object\' || toTypeName(value[key]) === \'array\') && !value[key].hasOwnProperty(\'__observers__\')) {\r\n\t\t\t\t\tvar newparts = parts.slice(0);\r\n\t\t\t\t\tnewparts.push(key);\r\n\t\t\t\t\tvalue[key] = Object.deepObserve(value[key],callback,newparts);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treobserve(object, parts);\r\n\r\n\t\tvar observed = Object.observe(object,function(changeset) {\r\n\t\t\tvar changes = [];\r\n\t\t\tfunction recurse(name,rootObject,oldObject,newObject,path) {\r\n\t\t\t\tif(newObject instanceof Object) {\r\n\t\t\t\t\tvar newkeys = Object.keys(newObject);\r\n\t\t\t\t\tnewkeys.forEach(function(key) {\r\n\t\t\t\t\t\tif(!oldObject || (oldObject[key]!==newObject[key])) {\r\n\t\t\t\t\t\t\tvar oldvalue = (oldObject && oldObject[key]!==undefined ? oldObject[key] : undefined),\r\n\t\t\t\t\t\t\t\tchange = (oldvalue===undefined ? "add" : "update"),\r\n\t\t\t\t\t\t\t\tkeypath = path + "." + key;\r\n\r\n\t\t\t\t\t\t\tchanges.push({name:name,object:rootObject,type:change,oldValue:oldvalue,newValue:newObject[key],keypath:keypath});\r\n\t\t\t\t\t\t\trecurse(name,rootObject,oldvalue,newObject[key],keypath);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if(oldObject instanceof Object) {\r\n\t\t\t\t\tvar oldkeys = Object.keys(oldObject);\r\n\t\t\t\t\toldkeys.forEach(function(key) {\r\n\t\t\t\t\t\tvar change = (newObject===null ? "update" : "delete"),\r\n\t\t\t\t\t\t\tkeypath = path + "." + key;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tchanges.push({name:name,object:rootObject,type:change,oldValue:oldObject[key],newValue:newObject,keypath:keypath});\r\n\t\t\t\t\t\trecurse(name,rootObject,oldObject[key],undefined,keypath);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchangeset.forEach(function(change) {\r\n\t\t\t\tvar keypath = (parts.length>0 ? parts.join(".") + "." : "") + change.name;\r\n\r\n\t\t\t\tif (change.type === "update" || change.type === "add") { \r\n\t\t\t\t\treobserve(change.object, parts);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tchanges.push({name:change.name,object:change.object,type:change.type,oldValue:change.oldValue,newValue:change.object[change.name],keypath:keypath});\r\n\t\t\t\trecurse(change.name,change.object,change.oldValue,change.object[change.name],keypath);\r\n\t\t\t});\r\n\t\t\tcallback(changes);\r\n\t\t});\r\n\t\treturn observed;\r\n\t};\r\n})();\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvcHJveHktb2JzZXJ2ZS9pbmRleC5qcz85NWViIl0sInNvdXJjZXNDb250ZW50IjpbIi8vICAgICBwcm94eS1vYnNlcnZlIHYwLjAuMThcclxuLy8gICAgIENvcHlyaWdodCAoYykgMjAxNSwgMjAxNiBTaW1vbiBZLiBCbGFja3dlbGwsIEFueVdoaWNoV2F5XHJcbi8vICAgICBNSVQgTGljZW5zZSAtIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuKGZ1bmN0aW9uKCkge1xyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdC8vIENyZWF0ZXMgYW5kIHJldHVybnMgYSBQcm94eSB3cmFwcGluZyBhIHRhcmdldCBzbyB0aGF0IGFsbCBjaGFuZ2VzIGNhbiBiZSB0cmFwcGVkIGFuZCBmb3J3YXJkZWQgdG9cclxuXHQvLyBhIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgdGFrZXMgYW4gYXJyYXkgb2YgY2hhbmdlcyBqdXN0IGxpa2UgdGhlIHRyYWRpdGlvbmFsIG9yaWdpbmFsIENocm9tZSBPYmplY3Qub2JzZXJ2ZVxyXG5cdC8vIHtvYmplY3Q6PG9iamVjdCBjaGFuZ2VkPixuYW1lOjxmaWVsZCBjaGFuZ2VkPix0eXBlOmFkZHx1cGRhdGV8ZGVsZXRlfHJlY29uZmlndXJlfHByZXZlbnRFeHRlbnNpb25zfHNldFByb3RvdHlwZSxvbGRWYWx1ZTo8b2xkIHZhbHVlIGlmIHVwZGF0ZSB8IGRlbGV0ZT59XHJcblx0Ly8gVGhlIGFjY2VwdGxpc3QgY2FuIGJlIGFkZHx1cGRhdGV8ZGVsZXRlfHJlY29uZmlndXJlfHByZXZlbnRFeHRlbnNpb25zfHNldFByb3RvdHlwZS5cclxuXHQvLyB2IDAuMC4xMCB0byBzdXBwb3J0IHBhdXNpbmcgYW5kIHJlc3RhcnRpbmcgb2JzZXJ2YXRpb24gdHdvIGFkZGl0aW9uYWwgY29uc3RydWN0b3IgYXJndW1lbnRzIGFyZSBhdmFpbGFibGUgdG8gT2JqZWN0Lm9ic2VydmU6XHJcblx0Ly8gcGF1c2FibGUgLSBjcmVhdGUgdGhlIE9ic2VydmVyIHNvIGl0IGNhbiBiZSBwYXVzZWRcclxuXHQvLyBwYXVzZSAtIGNyZWF0ZSBvYnNlcnZlciBpbiBwYXVzZWQgc3RhdGVcclxuXHQvLyBpZiBwYXVzYWJsZSBpcyB0cnVlIHRoZW4gYW4gYWRkaXRpb25hbCBtZXRob2QgZGVsaXZlcihpZ25vcmVQcmV2aW91cykgaXMgYXZhaWxhYmxlIHRvIHN0YXJ0IGRlbGl2ZXJ5XHJcblx0Ly8gdG8gcGF1c2UgZGVsaXZlcnkgc2V0IGEgcHJvcGVydHkgY2FsbGVkIHBhdXNlIG9uIHRoZSBmdW5jdGlvbiBkZWxpdmVyIHRvIHRydWVcclxuXHQvLyBwYXVzYWJsZSBpcyBvcHRpb25hbCB0byByZWR1Y2UgdGhlIGNoYW5jZSBvZiBzaGFkb3dpbmcgYSBwcm9wZXJ0eSBvciBtZXRob2Qgb24gYW55IGV4aXN0aW5nIGNvZGUgY2FsbGVkIGRlbGl2ZXJcclxuXHRpZighT2JqZWN0Lm9ic2VydmUgJiYgdHlwZW9mKFByb3h5KT09PVwiZnVuY3Rpb25cIikge1xyXG5cdFx0ZnVuY3Rpb24gT2JzZXJ2ZXIodGFyZ2V0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHtcclxuXHQgICAgXHR2YXIgbWUgPSB0aGlzLCBwcm94eTtcclxuXHQgICAgXHRmdW5jdGlvbiBkZWxpdmVyKGlnbm9yZVByZXZpb3VzLGRlbGF5KSB7XHJcblx0ICAgIFx0XHRkZWxpdmVyLmRlbGF5ID0gZGVsYXk7XHJcblx0ICAgIFx0XHRpZighZGVsaXZlci5wYXVzZSkge1xyXG5cdCAgICAgICAgXHRcdGlmKG1lLmNoYW5nZXNldC5sZW5ndGg+MCkge1xyXG5cdCAgICAgICAgXHRcdFx0aWYoIWlnbm9yZVByZXZpb3VzKSB7XHJcblx0XHQgICAgXHQgICAgXHRcdHZhciBjaGFuZ2VzID0gbWUuY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuICFhY2NlcHRsaXN0IHx8IGFjY2VwdGxpc3QuaW5kZXhPZihjaGFuZ2UudHlwZSk+PTA7IH0pO1xyXG5cdFx0ICAgICAgICBcdFx0XHRpZihjaGFuZ2VzLmxlbmd0aD4wKSB7XHJcblx0XHQgICAgICAgIFx0XHRcdFx0Y2FsbGJhY2soY2hhbmdlcyk7XHJcblx0XHQgICAgICAgIFx0XHRcdH1cclxuXHQgICAgICAgIFx0XHRcdH1cclxuXHQgICAgICAgIFx0XHRcdG1lLmNoYW5nZXNldCA9IFtdO1xyXG5cdCAgICAgICAgXHRcdH1cclxuXHQgICAgXHRcdH1cclxuXHQgICAgXHR9XHJcblx0ICAgIFx0ZGVsaXZlci5wYXVzZSA9IHBhdXNlO1xyXG5cdCAgICBcdGRlbGl2ZXIuZGVsYXkgPSBkZWxheTtcclxuXHRcdCAgICBtZS5nZXQgPSBmdW5jdGlvbih0YXJnZXQsIHByb3BlcnR5KSB7XHJcblx0XHQgICAgXHRpZihwcm9wZXJ0eT09PVwiX19vYnNlcnZlcl9fXCIpIHtcclxuXHRcdCAgICBcdFx0cmV0dXJuIG1lO1xyXG5cdFx0ICAgIFx0fVxyXG5cdFx0ICAgIFx0aWYocHJvcGVydHk9PT1cInVub2JzZXJ2ZVwiKSB7XHJcblx0XHQgICAgXHRcdHJldHVybiBmdW5jdGlvbigpIHtcclxuXHRcdCAgICBcdFx0XHRPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7XHJcblx0XHQgICAgXHRcdFx0cmV0dXJuIHRhcmdldDtcclxuXHRcdCAgICBcdFx0fTtcclxuXHRcdCAgICBcdH1cclxuXHRcdCAgICBcdGlmKHByb3BlcnR5PT09XCJkZWxpdmVyXCIpIHtcclxuXHRcdCAgICBcdFx0cmV0dXJuIGRlbGl2ZXI7XHJcblx0XHQgICAgXHR9XHJcblx0XHQgICAgXHRyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTtcclxuXHRcdCAgICB9XHJcblx0ICAgIFx0bWUudGFyZ2V0ID0gdGFyZ2V0O1xyXG5cdCAgICBcdG1lLmNoYW5nZXNldCA9IFtdO1xyXG5cdCAgICBcdGlmKCFtZS50YXJnZXQuX19vYnNlcnZlckNhbGxiYWNrc19fKSB7XHJcblx0ICAgIFx0XHQvLyBfX29ic2VydmVyQ2FsbGJhY2tzX18gaXMgdXNlZCBhcyBhbiBpbmRleCB0byBnZXQgYXQgdGhlIHByb3h5IHdoaWNoIGlzIHRoZSBvYnNlcnZlciwgc28gd2UgY2FuIHVub2JzZXJ2ZVxyXG5cdCAgICBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCxcIl9fb2JzZXJ2ZXJDYWxsYmFja3NfX1wiLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7XHJcblx0ICAgIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LFwiX19vYnNlcnZlcnNfX1wiLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7XHJcblx0ICAgIFx0fVxyXG5cdCAgICBcdG1lLnRhcmdldC5fX29ic2VydmVyQ2FsbGJhY2tzX18ucHVzaChjYWxsYmFjayk7XHJcblx0ICAgIFx0bWUudGFyZ2V0Ll9fb2JzZXJ2ZXJzX18ucHVzaCh0aGlzKTtcclxuXHQgICAgXHRwcm94eSA9IG5ldyBQcm94eSh0YXJnZXQsbWUpO1xyXG5cdCAgICBcdGRlbGl2ZXIoZmFsc2UsZGVsYXkpO1xyXG5cdCAgICBcdHJldHVybiBwcm94eTtcclxuXHQgICAgfVxyXG5cdFx0T2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0KG51bGwsXCJkZWxpdmVyXCIpO1xyXG5cdFx0fVxyXG5cdCAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgdmFsdWUpIHsgLy8gLCByZWNlaXZlclxyXG5cdCAgICBcdHZhciBvbGR2YWx1ZSA9IHRhcmdldFtwcm9wZXJ0eV07XHJcblx0ICAgIFx0dmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyBcImFkZFwiIDogXCJ1cGRhdGVcIik7XHJcblx0ICAgIFx0dGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlO1xyXG5cdCAgICBcdGlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgKCF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YodHlwZSk+PTApKSB7XHJcblx0ICAgICAgICBcdHZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6dHlwZX0sXHJcblx0ICAgICAgICBcdFx0c3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsXHJcblx0ICAgICAgICBcdFx0ZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpO1xyXG5cdCAgICAgICAgXHRpZih0eXBlPT09XCJ1cGRhdGVcIikge1xyXG5cdCAgICAgICAgXHRcdGNoYW5nZS5vbGRWYWx1ZSA9IG9sZHZhbHVlO1xyXG5cdCAgICAgICAgXHR9XHJcblx0ICAgICAgICBcdHRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTtcclxuXHQgICAgICAgIFx0aWYoc3RhcnQpIHtcclxuXHQgICAgICAgIFx0XHRkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT1cIm51bWJlclwiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7XHJcblx0ICAgICAgICBcdH1cclxuXHQgICAgXHR9XHJcblx0ICAgIFx0cmV0dXJuIHRydWU7XHJcblx0ICAgIH07XHJcblx0ICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHtcclxuXHQgICAgXHR2YXIgb2xkdmFsdWUgPSB0YXJnZXRbcHJvcGVydHldO1xyXG5cdCAgICBcdC8vaWYodHlwZW9mKG9sZHZhbHVlKSE9PVwidW5kZWZpbmVkXCIpIHtcclxuXHRcdCAgICBcdGRlbGV0ZSB0YXJnZXRbcHJvcGVydHldO1xyXG5cdFx0ICAgIFx0aWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKFwiZGVsZXRlXCIpPj0wKSB7XHJcblx0XHQgICAgICAgIFx0dmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTpcImRlbGV0ZVwiLG9sZFZhbHVlOm9sZHZhbHVlfSxcclxuXHRcdCAgICAgICAgXHRcdHN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLFxyXG5cdFx0ICAgICAgICBcdFx0ZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpO1xyXG5cdFx0ICAgICAgICBcdHRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTtcclxuXHRcdCAgICAgICAgXHRpZihzdGFydCkge1xyXG5cdFx0ICAgICAgICBcdFx0ZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09XCJudW1iZXJcIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpO1xyXG5cdFx0ICAgICAgICBcdH1cclxuXHRcdCAgICBcdH1cclxuXHQgICAgXHQvL31cclxuXHQgICAgXHRyZXR1cm4gdHJ1ZTtcclxuXHQgICAgfTtcclxuXHQgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcikge1xyXG5cdCAgICBcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCBkZXNjcmlwdG9yKTtcclxuXHQgICAgXHRpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoXCJyZWNvbmZpZ3VyZVwiKT49MCkge1xyXG5cdCAgICAgICAgXHR2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsbmFtZTpwcm9wZXJ0eSx0eXBlOlwicmVjb25maWd1cmVcIn0sXHJcbiAgICAgICAgXHRcdFx0c3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsXHJcbiAgICAgICAgXHRcdFx0ZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpO1xyXG5cdCAgICAgICAgXHR0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7XHJcblx0ICAgICAgICBcdGlmKHN0YXJ0KSB7XHJcblx0ICAgICAgICBcdFx0ZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09XCJudW1iZXJcIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpO1xyXG5cdCAgICAgICAgXHR9XHJcblx0ICAgIFx0fVxyXG5cdCAgICBcdHJldHVybiB0cnVlO1xyXG5cdCAgICB9O1xyXG5cdCAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkge1xyXG5cdCAgICBcdHZhciBvbGR2YWx1ZSA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0YXJnZXQpO1xyXG5cdCAgICBcdE9iamVjdC5zZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSk7XHJcblx0ICAgIFx0aWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKFwic2V0UHJvdG90eXBlXCIpPj0wKSB7XHJcblx0ICAgICAgICBcdHZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOlwiX19wcm90b19fXCIsdHlwZTpcInNldFByb3RvdHlwZVwiLG9sZFZhbHVlOm9sZHZhbHVlfSxcclxuICAgIFx0XHRcdFx0c3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsXHJcbiAgICBcdFx0XHRcdGRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTtcclxuXHQgICAgICAgIFx0dGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpO1xyXG5cdCAgICAgICAgXHRpZihzdGFydCkge1xyXG5cdCAgICAgICAgXHRcdGRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PVwibnVtYmVyXCIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTtcclxuXHQgICAgICAgIFx0fVxyXG5cdCAgICBcdH1cclxuXHQgICAgXHRyZXR1cm4gdHJ1ZTtcclxuXHQgICAgfTtcclxuXHQgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnByZXZlbnRFeHRlbnNpb25zID0gZnVuY3Rpb24odGFyZ2V0KSB7XHJcblx0ICAgICAgICBPYmplY3QucHJldmVudEV4dGVuc2lvbnModGFyZ2V0KTtcclxuXHQgICAgXHRpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoXCJwcmV2ZW50RXh0ZW5zaW9uc1wiKT49MCkge1xyXG5cdCAgICAgICAgXHR2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsdHlwZTpcInByZXZlbnRFeHRlbnNpb25zXCJ9LFxyXG5cdFx0XHRcdFx0c3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsXHJcblx0XHRcdFx0XHRkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7XHJcblx0ICAgICAgICBcdHRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTtcclxuXHQgICAgICAgIFx0aWYoc3RhcnQpIHtcclxuXHQgICAgICAgIFx0XHRkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT1cIm51bWJlclwiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7XHJcblx0ICAgICAgICBcdH1cclxuXHQgICAgXHR9XHJcblx0ICAgIFx0cmV0dXJuIHRydWU7XHJcblx0ICAgIH07XHJcblx0ICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHtcclxuXHQgICAgXHRyZXR1cm4gbmV3IE9ic2VydmVyKG9iamVjdCxjYWxsYmFjayxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KTtcclxuXHQgICAgfTtcclxuXHQgICAgT2JqZWN0LnVub2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjaykge1xyXG5cdCAgICBcdGlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHtcclxuXHQgICAgXHRcdGlmKCFjYWxsYmFjaykge1xyXG5cdCAgICBcdFx0XHRvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18ubGVuZ3RoKTtcclxuXHQgICAgXHRcdFx0b2JqZWN0Ll9fb2JzZXJ2ZXJzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJzX18ubGVuZ3RoKTtcclxuXHQgICAgXHRcdFx0cmV0dXJuO1xyXG5cdCAgICBcdFx0fVxyXG5cdCAgICBcdFx0b2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkge1xyXG5cdCAgICBcdFx0XHRpZihjYWxsYmFjaz09PW9ic2VydmVyY2FsbGJhY2spIHtcclxuXHQgICAgXHRcdFx0XHRvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpO1xyXG5cdCAgICBcdFx0XHRcdGRlbGV0ZSBvYmplY3QuX19vYnNlcnZlcnNfX1tpXS5jYWxsYmFjaztcclxuXHQgICAgXHRcdFx0XHRvYmplY3QuX19vYnNlcnZlcnNfXy5zcGxpY2UoaSwxKTtcclxuXHQgICAgXHRcdFx0fVxyXG5cdCAgICBcdFx0fSk7XHJcblx0ICAgIFx0fVxyXG5cdCAgICB9O1xyXG5cdCAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHtcclxuXHQgICAgXHRpZighKG9iamVjdCBpbnN0YW5jZW9mIEFycmF5KSAmJiAhQXJyYXkuaXNBcnJheShvYmplY3QpKSB7XHJcblx0ICAgIFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5XCIpO1xyXG5cdCAgICBcdH1cclxuICAgICAgICAgICAgXHRhY2NlcHRsaXN0ID0gYWNjZXB0bGlzdCB8fCBbXCJhZGRcIiwgXCJ1cGRhdGVcIiwgXCJkZWxldGVcIiwgXCJzcGxpY2VcIl07XHJcblx0ICAgIFx0dmFyIGFycmF5cHJveHkgPSBuZXcgUHJveHkob2JqZWN0LHtnZXQ6IGZ1bmN0aW9uKHRhcmdldCxwcm9wZXJ0eSkge1xyXG5cdCAgICBcdFx0aWYocHJvcGVydHk9PT1cInVub2JzZXJ2ZVwiKSB7XHJcblx0XHQgICAgXHRcdHJldHVybiBmdW5jdGlvbihjYWxsYmFjaykge1xyXG5cdFx0ICAgIFx0XHRcdGlmKGNhbGxiYWNrKSB7XHJcblx0XHQgICAgXHRcdFx0XHRyZXR1cm4gT2JqZWN0LnVub2JzZXJ2ZSh0YXJnZXQsY2FsbGJhY2spO1xyXG5cdFx0ICAgIFx0XHRcdH1cclxuXHRcdCAgICBcdFx0XHRyZXR1cm4gdGFyZ2V0LnVub2JzZXJ2ZSgpO1xyXG5cdFx0ICAgIFx0XHR9O1xyXG5cdFx0ICAgIFx0fVxyXG5cdCAgICBcdFx0aWYocHJvcGVydHk9PT1cInNwbGljZVwiKSB7XHJcblx0ICAgIFx0XHRcdHJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHtcclxuXHQgICAgXHRcdFx0XHRpZih0eXBlb2Yoc3RhcnQpIT09XCJudW1iZXJcIiB8fCB0eXBlb2YoZW5kKSE9PVwibnVtYmVyXCIpIHtcclxuXHQgICAgXHRcdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoXCJGaXJzdCB0d28gYXJndW1lbnRzIHRvIEFycmF5IHNwbGljZSBhcmUgbm90IG51bWJlciwgbnVtYmVyXCIpO1xyXG5cdCAgICBcdFx0XHRcdH1cclxuXHQgICAgXHQgICAgXHRcdHZhciByZW1vdmVkID0gdGhpcy5zbGljZShzdGFydCxzdGFydCtlbmQpLFxyXG5cdCAgICBcdCAgICBcdFx0XHRhZGRlZENvdW50ID0gKGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzLmxlbmd0aC0yIDogMCksXHJcblx0ICAgIFx0ICAgIFx0XHRcdGNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOlwic3BsaWNlXCIsaW5kZXg6c3RhcnQscmVtb3ZlZDpyZW1vdmVkLGFkZGVkQ291bnQ6YWRkZWRDb3VudH07XHJcblx0ICAgIFx0ICAgIFx0XHR0YXJnZXQuc3BsaWNlLmFwcGx5KHRhcmdldCxhcmd1bWVudHMpO1xyXG5cdCAgICBcdCAgICBcdFx0aWYoYWNjZXB0bGlzdC5pbmRleE9mKFwic3BsaWNlXCIpPj0wKSB7XHJcblx0ICAgIFx0ICAgIFx0XHRcdHZhciBzdGFydCA9IHByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLFxyXG5cdCAgICBcdCAgICAgICAgXHRcdFx0ZGVsaXZlciA9IHByb3h5Ll9fb2JzZXJ2ZXJfXy5kZWxpdmVyKCk7XHJcblx0ICAgIFx0ICAgIFx0XHRcdHByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpO1xyXG5cdCAgICBcdCAgICBcdFx0XHRpZihzdGFydCkge1xyXG5cdCAgICBcdFx0ICAgICAgICBcdFx0ZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09XCJudW1iZXJcIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpO1xyXG5cdCAgICBcdFx0ICAgICAgICBcdH1cclxuXHQgICAgXHQgICAgXHRcdH1cclxuXHQgICAgXHQgICAgXHR9XHJcblx0ICAgIFx0XHR9XHJcblx0ICAgIFx0XHRpZihwcm9wZXJ0eT09PVwicHVzaFwiKSB7XHJcblx0ICAgIFx0XHRcdCByZXR1cm4gZnVuY3Rpb24oaXRlbSkge1xyXG5cdCAgICBcdFx0ICAgIFx0cmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7XHJcblx0ICAgIFx0XHQgICAgfVxyXG5cdCAgICBcdFx0fVxyXG5cdCAgICBcdFx0aWYocHJvcGVydHk9PT1cInBvcFwiKSB7XHJcblx0ICAgIFx0XHRcdCByZXR1cm4gZnVuY3Rpb24oKSB7XHJcblx0ICAgIFx0XHQgICAgXHRyZXR1cm4gdGhpcy5zcGxpY2UodGhpcy5sZW5ndGgtMSwxKTtcclxuXHQgICAgXHRcdCAgICB9XHJcblx0ICAgIFx0XHR9XHJcblx0ICAgIFx0XHRpZihwcm9wZXJ0eT09PVwidW5zaGlmdFwiKSB7XHJcblx0ICAgIFx0XHRcdCByZXR1cm4gZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgXHRcdCAgICBcdFx0cmV0dXJuIHRoaXMuc3BsaWNlKDAsMCxpdGVtKTtcclxuICAgIFx0XHQgICAgXHR9XHJcblx0ICAgIFx0XHR9XHJcblx0ICAgIFx0XHRpZihwcm9wZXJ0eT09PVwic2hpZnRcIikge1xyXG5cdCAgICBcdFx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XHJcblx0ICAgIFx0ICAgIFx0XHRyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTtcclxuXHQgICAgXHQgICAgXHR9XHJcblx0ICAgIFx0XHR9XHJcblx0ICAgIFx0XHRyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTtcclxuXHQgICAgXHR9fSk7XHJcblx0ICAgIFx0dmFyIHByb3h5ID0gT2JqZWN0Lm9ic2VydmUoYXJyYXlwcm94eSxmdW5jdGlvbihjaGFuZ2VzZXQpIHsgXHJcblx0ICAgIFx0XHR2YXIgY2hhbmdlcyA9IGNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiBjaGFuZ2UubmFtZSE9PVwibGVuZ3RoXCIgJiYgY2hhbmdlLm5hbWUhPT1cImFkZFwiICYmICghYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wKTsgfSk7XHJcblx0ICAgIFx0XHRpZihjaGFuZ2VzLmxlbmd0aD4wKSB7XHJcblx0ICAgIFx0XHRcdGNhbGxiYWNrKGNoYW5nZXMpO1xyXG5cdCAgICBcdFx0fVxyXG5cdCAgICBcdH0sYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7XHJcblx0ICAgIFx0cmV0dXJuIHByb3h5O1xyXG5cdCAgICB9O1xyXG5cdCAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHtcclxuXHRcdCAgcmV0dXJuIG9iamVjdC51bm9ic2VydmUoY2FsbGJhY2spO1xyXG5cdCAgICB9XHJcblx0fVxyXG5cdE9iamVjdC5kZWVwT2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjayxwYXJ0cykge1xyXG5cclxuXHRcdHBhcnRzID0gKHBhcnRzID8gcGFydHMgOiBbXSk7XHJcblxyXG5cdFx0dmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHtcclxuXHRcdFx0cmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9cXHMoW2EtekEtWl0rKS8pWzFdLnRvTG93ZXJDYXNlKClcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiByZW9ic2VydmUodmFsdWUsIHBhcnRzKSB7XHJcblx0XHRcdHZhciBrZXlzID0gT2JqZWN0LmtleXModmFsdWUpO1xyXG5cdFx0XHRrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XHJcblx0XHRcdFx0aWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHtcclxuXHRcdFx0XHRcdHZhciBuZXdwYXJ0cyA9IHBhcnRzLnNsaWNlKDApO1xyXG5cdFx0XHRcdFx0bmV3cGFydHMucHVzaChrZXkpO1xyXG5cdFx0XHRcdFx0dmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJlb2JzZXJ2ZShvYmplY3QsIHBhcnRzKTtcclxuXHJcblx0XHR2YXIgb2JzZXJ2ZWQgPSBPYmplY3Qub2JzZXJ2ZShvYmplY3QsZnVuY3Rpb24oY2hhbmdlc2V0KSB7XHJcblx0XHRcdHZhciBjaGFuZ2VzID0gW107XHJcblx0XHRcdGZ1bmN0aW9uIHJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdCxuZXdPYmplY3QscGF0aCkge1xyXG5cdFx0XHRcdGlmKG5ld09iamVjdCBpbnN0YW5jZW9mIE9iamVjdCkge1xyXG5cdFx0XHRcdFx0dmFyIG5ld2tleXMgPSBPYmplY3Qua2V5cyhuZXdPYmplY3QpO1xyXG5cdFx0XHRcdFx0bmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xyXG5cdFx0XHRcdFx0XHRpZighb2xkT2JqZWN0IHx8IChvbGRPYmplY3Rba2V5XSE9PW5ld09iamVjdFtrZXldKSkge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBvbGR2YWx1ZSA9IChvbGRPYmplY3QgJiYgb2xkT2JqZWN0W2tleV0hPT11bmRlZmluZWQgPyBvbGRPYmplY3Rba2V5XSA6IHVuZGVmaW5lZCksXHJcblx0XHRcdFx0XHRcdFx0XHRjaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyBcImFkZFwiIDogXCJ1cGRhdGVcIiksXHJcblx0XHRcdFx0XHRcdFx0XHRrZXlwYXRoID0gcGF0aCArIFwiLlwiICsga2V5O1xyXG5cclxuXHRcdFx0XHRcdFx0XHRjaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTtcclxuXHRcdFx0XHRcdFx0XHRyZWN1cnNlKG5hbWUscm9vdE9iamVjdCxvbGR2YWx1ZSxuZXdPYmplY3Rba2V5XSxrZXlwYXRoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKG9sZE9iamVjdCBpbnN0YW5jZW9mIE9iamVjdCkge1xyXG5cdFx0XHRcdFx0dmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpO1xyXG5cdFx0XHRcdFx0b2xka2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgY2hhbmdlID0gKG5ld09iamVjdD09PW51bGwgPyBcInVwZGF0ZVwiIDogXCJkZWxldGVcIiksXHJcblx0XHRcdFx0XHRcdFx0a2V5cGF0aCA9IHBhdGggKyBcIi5cIiArIGtleTtcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0Y2hhbmdlcy5wdXNoKHtuYW1lOm5hbWUsb2JqZWN0OnJvb3RPYmplY3QsdHlwZTpjaGFuZ2Usb2xkVmFsdWU6b2xkT2JqZWN0W2tleV0sbmV3VmFsdWU6bmV3T2JqZWN0LGtleXBhdGg6a2V5cGF0aH0pO1xyXG5cdFx0XHRcdFx0XHRyZWN1cnNlKG5hbWUscm9vdE9iamVjdCxvbGRPYmplY3Rba2V5XSx1bmRlZmluZWQsa2V5cGF0aCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0Y2hhbmdlc2V0LmZvckVhY2goZnVuY3Rpb24oY2hhbmdlKSB7XHJcblx0XHRcdFx0dmFyIGtleXBhdGggPSAocGFydHMubGVuZ3RoPjAgPyBwYXJ0cy5qb2luKFwiLlwiKSArIFwiLlwiIDogXCJcIikgKyBjaGFuZ2UubmFtZTtcclxuXHJcblx0XHRcdFx0aWYgKGNoYW5nZS50eXBlID09PSBcInVwZGF0ZVwiIHx8IGNoYW5nZS50eXBlID09PSBcImFkZFwiKSB7IFxyXG5cdFx0XHRcdFx0cmVvYnNlcnZlKGNoYW5nZS5vYmplY3QsIHBhcnRzKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGNoYW5nZXMucHVzaCh7bmFtZTpjaGFuZ2UubmFtZSxvYmplY3Q6Y2hhbmdlLm9iamVjdCx0eXBlOmNoYW5nZS50eXBlLG9sZFZhbHVlOmNoYW5nZS5vbGRWYWx1ZSxuZXdWYWx1ZTpjaGFuZ2Uub2JqZWN0W2NoYW5nZS5uYW1lXSxrZXlwYXRoOmtleXBhdGh9KTtcclxuXHRcdFx0XHRyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0Y2FsbGJhY2soY2hhbmdlcyk7XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiBvYnNlcnZlZDtcclxuXHR9O1xyXG59KSgpO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///82\n')},function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\r\nAuthor: Geraint Luff and others\r\nYear: 2013\r\n\r\nThis code is released into the "public domain" by its author(s).  Anybody may use, alter and distribute the code without restriction.  The author makes no guarantees, and takes no liability of any kind for use of this code.\r\n\r\nIf you find a bug or make an improvement, it would be courteous to let the author know, but it is not compulsory.\r\n*/\r\n(function (global, factory) {\r\n  if (true) {\r\n    // AMD. Register as an anonymous module.\r\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === \'function\' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\r\n  } else {}\r\n}(this, function () {\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FObject%2Fkeys\r\nif (!Object.keys) {\r\n\tObject.keys = (function () {\r\n\t\tvar hasOwnProperty = Object.prototype.hasOwnProperty,\r\n\t\t\thasDontEnumBug = !({toString: null}).propertyIsEnumerable(\'toString\'),\r\n\t\t\tdontEnums = [\r\n\t\t\t\t\'toString\',\r\n\t\t\t\t\'toLocaleString\',\r\n\t\t\t\t\'valueOf\',\r\n\t\t\t\t\'hasOwnProperty\',\r\n\t\t\t\t\'isPrototypeOf\',\r\n\t\t\t\t\'propertyIsEnumerable\',\r\n\t\t\t\t\'constructor\'\r\n\t\t\t],\r\n\t\t\tdontEnumsLength = dontEnums.length;\r\n\r\n\t\treturn function (obj) {\r\n\t\t\tif (typeof obj !== \'object\' && typeof obj !== \'function\' || obj === null) {\r\n\t\t\t\tthrow new TypeError(\'Object.keys called on non-object\');\r\n\t\t\t}\r\n\r\n\t\t\tvar result = [];\r\n\r\n\t\t\tfor (var prop in obj) {\r\n\t\t\t\tif (hasOwnProperty.call(obj, prop)) {\r\n\t\t\t\t\tresult.push(prop);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (hasDontEnumBug) {\r\n\t\t\t\tfor (var i=0; i < dontEnumsLength; i++) {\r\n\t\t\t\t\tif (hasOwnProperty.call(obj, dontEnums[i])) {\r\n\t\t\t\t\t\tresult.push(dontEnums[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t};\r\n\t})();\r\n}\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create\r\nif (!Object.create) {\r\n\tObject.create = (function(){\r\n\t\tfunction F(){}\r\n\r\n\t\treturn function(o){\r\n\t\t\tif (arguments.length !== 1) {\r\n\t\t\t\tthrow new Error(\'Object.create implementation only accepts one parameter.\');\r\n\t\t\t}\r\n\t\t\tF.prototype = o;\r\n\t\t\treturn new F();\r\n\t\t};\r\n\t})();\r\n}\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray%2FisArray\r\nif(!Array.isArray) {\r\n\tArray.isArray = function (vArg) {\r\n\t\treturn Object.prototype.toString.call(vArg) === "[object Array]";\r\n\t};\r\n}\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray%2FindexOf\r\nif (!Array.prototype.indexOf) {\r\n\tArray.prototype.indexOf = function (searchElement /*, fromIndex */ ) {\r\n\t\tif (this === null) {\r\n\t\t\tthrow new TypeError();\r\n\t\t}\r\n\t\tvar t = Object(this);\r\n\t\tvar len = t.length >>> 0;\r\n\r\n\t\tif (len === 0) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar n = 0;\r\n\t\tif (arguments.length > 1) {\r\n\t\t\tn = Number(arguments[1]);\r\n\t\t\tif (n !== n) { // shortcut for verifying if it\'s NaN\r\n\t\t\t\tn = 0;\r\n\t\t\t} else if (n !== 0 && n !== Infinity && n !== -Infinity) {\r\n\t\t\t\tn = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (n >= len) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\r\n\t\tfor (; k < len; k++) {\r\n\t\t\tif (k in t && t[k] === searchElement) {\r\n\t\t\t\treturn k;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t};\r\n}\r\n\r\n// Grungey Object.isFrozen hack\r\nif (!Object.isFrozen) {\r\n\tObject.isFrozen = function (obj) {\r\n\t\tvar key = "tv4_test_frozen_key";\r\n\t\twhile (obj.hasOwnProperty(key)) {\r\n\t\t\tkey += Math.random();\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tobj[key] = true;\r\n\t\t\tdelete obj[key];\r\n\t\t\treturn false;\r\n\t\t} catch (e) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t};\r\n}\r\n// Based on: https://github.com/geraintluff/uri-templates, but with all the de-substitution stuff removed\r\n\r\nvar uriTemplateGlobalModifiers = {\r\n\t"+": true,\r\n\t"#": true,\r\n\t".": true,\r\n\t"/": true,\r\n\t";": true,\r\n\t"?": true,\r\n\t"&": true\r\n};\r\nvar uriTemplateSuffices = {\r\n\t"*": true\r\n};\r\n\r\nfunction notReallyPercentEncode(string) {\r\n\treturn encodeURI(string).replace(/%25[0-9][0-9]/g, function (doubleEncoded) {\r\n\t\treturn "%" + doubleEncoded.substring(3);\r\n\t});\r\n}\r\n\r\nfunction uriTemplateSubstitution(spec) {\r\n\tvar modifier = "";\r\n\tif (uriTemplateGlobalModifiers[spec.charAt(0)]) {\r\n\t\tmodifier = spec.charAt(0);\r\n\t\tspec = spec.substring(1);\r\n\t}\r\n\tvar separator = "";\r\n\tvar prefix = "";\r\n\tvar shouldEscape = true;\r\n\tvar showVariables = false;\r\n\tvar trimEmptyString = false;\r\n\tif (modifier === \'+\') {\r\n\t\tshouldEscape = false;\r\n\t} else if (modifier === ".") {\r\n\t\tprefix = ".";\r\n\t\tseparator = ".";\r\n\t} else if (modifier === "/") {\r\n\t\tprefix = "/";\r\n\t\tseparator = "/";\r\n\t} else if (modifier === \'#\') {\r\n\t\tprefix = "#";\r\n\t\tshouldEscape = false;\r\n\t} else if (modifier === \';\') {\r\n\t\tprefix = ";";\r\n\t\tseparator = ";";\r\n\t\tshowVariables = true;\r\n\t\ttrimEmptyString = true;\r\n\t} else if (modifier === \'?\') {\r\n\t\tprefix = "?";\r\n\t\tseparator = "&";\r\n\t\tshowVariables = true;\r\n\t} else if (modifier === \'&\') {\r\n\t\tprefix = "&";\r\n\t\tseparator = "&";\r\n\t\tshowVariables = true;\r\n\t}\r\n\r\n\tvar varNames = [];\r\n\tvar varList = spec.split(",");\r\n\tvar varSpecs = [];\r\n\tvar varSpecMap = {};\r\n\tfor (var i = 0; i < varList.length; i++) {\r\n\t\tvar varName = varList[i];\r\n\t\tvar truncate = null;\r\n\t\tif (varName.indexOf(":") !== -1) {\r\n\t\t\tvar parts = varName.split(":");\r\n\t\t\tvarName = parts[0];\r\n\t\t\ttruncate = parseInt(parts[1], 10);\r\n\t\t}\r\n\t\tvar suffices = {};\r\n\t\twhile (uriTemplateSuffices[varName.charAt(varName.length - 1)]) {\r\n\t\t\tsuffices[varName.charAt(varName.length - 1)] = true;\r\n\t\t\tvarName = varName.substring(0, varName.length - 1);\r\n\t\t}\r\n\t\tvar varSpec = {\r\n\t\t\ttruncate: truncate,\r\n\t\t\tname: varName,\r\n\t\t\tsuffices: suffices\r\n\t\t};\r\n\t\tvarSpecs.push(varSpec);\r\n\t\tvarSpecMap[varName] = varSpec;\r\n\t\tvarNames.push(varName);\r\n\t}\r\n\tvar subFunction = function (valueFunction) {\r\n\t\tvar result = "";\r\n\t\tvar startIndex = 0;\r\n\t\tfor (var i = 0; i < varSpecs.length; i++) {\r\n\t\t\tvar varSpec = varSpecs[i];\r\n\t\t\tvar value = valueFunction(varSpec.name);\r\n\t\t\tif (value === null || value === undefined || (Array.isArray(value) && value.length === 0) || (typeof value === \'object\' && Object.keys(value).length === 0)) {\r\n\t\t\t\tstartIndex++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (i === startIndex) {\r\n\t\t\t\tresult += prefix;\r\n\t\t\t} else {\r\n\t\t\t\tresult += (separator || ",");\r\n\t\t\t}\r\n\t\t\tif (Array.isArray(value)) {\r\n\t\t\t\tif (showVariables) {\r\n\t\t\t\t\tresult += varSpec.name + "=";\r\n\t\t\t\t}\r\n\t\t\t\tfor (var j = 0; j < value.length; j++) {\r\n\t\t\t\t\tif (j > 0) {\r\n\t\t\t\t\t\tresult += varSpec.suffices[\'*\'] ? (separator || ",") : ",";\r\n\t\t\t\t\t\tif (varSpec.suffices[\'*\'] && showVariables) {\r\n\t\t\t\t\t\t\tresult += varSpec.name + "=";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(value[j]).replace(/!/g, "%21") : notReallyPercentEncode(value[j]);\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof value === "object") {\r\n\t\t\t\tif (showVariables && !varSpec.suffices[\'*\']) {\r\n\t\t\t\t\tresult += varSpec.name + "=";\r\n\t\t\t\t}\r\n\t\t\t\tvar first = true;\r\n\t\t\t\tfor (var key in value) {\r\n\t\t\t\t\tif (!first) {\r\n\t\t\t\t\t\tresult += varSpec.suffices[\'*\'] ? (separator || ",") : ",";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfirst = false;\r\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(key).replace(/!/g, "%21") : notReallyPercentEncode(key);\r\n\t\t\t\t\tresult += varSpec.suffices[\'*\'] ? \'=\' : ",";\r\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(value[key]).replace(/!/g, "%21") : notReallyPercentEncode(value[key]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (showVariables) {\r\n\t\t\t\t\tresult += varSpec.name;\r\n\t\t\t\t\tif (!trimEmptyString || value !== "") {\r\n\t\t\t\t\t\tresult += "=";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (varSpec.truncate != null) {\r\n\t\t\t\t\tvalue = value.substring(0, varSpec.truncate);\r\n\t\t\t\t}\r\n\t\t\t\tresult += shouldEscape ? encodeURIComponent(value).replace(/!/g, "%21"): notReallyPercentEncode(value);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\tsubFunction.varNames = varNames;\r\n\treturn {\r\n\t\tprefix: prefix,\r\n\t\tsubstitution: subFunction\r\n\t};\r\n}\r\n\r\nfunction UriTemplate(template) {\r\n\tif (!(this instanceof UriTemplate)) {\r\n\t\treturn new UriTemplate(template);\r\n\t}\r\n\tvar parts = template.split("{");\r\n\tvar textParts = [parts.shift()];\r\n\tvar prefixes = [];\r\n\tvar substitutions = [];\r\n\tvar varNames = [];\r\n\twhile (parts.length > 0) {\r\n\t\tvar part = parts.shift();\r\n\t\tvar spec = part.split("}")[0];\r\n\t\tvar remainder = part.substring(spec.length + 1);\r\n\t\tvar funcs = uriTemplateSubstitution(spec);\r\n\t\tsubstitutions.push(funcs.substitution);\r\n\t\tprefixes.push(funcs.prefix);\r\n\t\ttextParts.push(remainder);\r\n\t\tvarNames = varNames.concat(funcs.substitution.varNames);\r\n\t}\r\n\tthis.fill = function (valueFunction) {\r\n\t\tvar result = textParts[0];\r\n\t\tfor (var i = 0; i < substitutions.length; i++) {\r\n\t\t\tvar substitution = substitutions[i];\r\n\t\t\tresult += substitution(valueFunction);\r\n\t\t\tresult += textParts[i + 1];\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\tthis.varNames = varNames;\r\n\tthis.template = template;\r\n}\r\nUriTemplate.prototype = {\r\n\ttoString: function () {\r\n\t\treturn this.template;\r\n\t},\r\n\tfillFromObject: function (obj) {\r\n\t\treturn this.fill(function (varName) {\r\n\t\t\treturn obj[varName];\r\n\t\t});\r\n\t}\r\n};\r\nvar ValidatorContext = function ValidatorContext(parent, collectMultiple, errorReporter, checkRecursive, trackUnknownProperties) {\r\n\tthis.missing = [];\r\n\tthis.missingMap = {};\r\n\tthis.formatValidators = parent ? Object.create(parent.formatValidators) : {};\r\n\tthis.schemas = parent ? Object.create(parent.schemas) : {};\r\n\tthis.collectMultiple = collectMultiple;\r\n\tthis.errors = [];\r\n\tthis.handleError = collectMultiple ? this.collectError : this.returnError;\r\n\tif (checkRecursive) {\r\n\t\tthis.checkRecursive = true;\r\n\t\tthis.scanned = [];\r\n\t\tthis.scannedFrozen = [];\r\n\t\tthis.scannedFrozenSchemas = [];\r\n\t\tthis.scannedFrozenValidationErrors = [];\r\n\t\tthis.validatedSchemasKey = \'tv4_validation_id\';\r\n\t\tthis.validationErrorsKey = \'tv4_validation_errors_id\';\r\n\t}\r\n\tif (trackUnknownProperties) {\r\n\t\tthis.trackUnknownProperties = true;\r\n\t\tthis.knownPropertyPaths = {};\r\n\t\tthis.unknownPropertyPaths = {};\r\n\t}\r\n\tthis.errorReporter = errorReporter || defaultErrorReporter(\'en\');\r\n\tif (typeof this.errorReporter === \'string\') {\r\n\t\tthrow new Error(\'debug\');\r\n\t}\r\n\tthis.definedKeywords = {};\r\n\tif (parent) {\r\n\t\tfor (var key in parent.definedKeywords) {\r\n\t\t\tthis.definedKeywords[key] = parent.definedKeywords[key].slice(0);\r\n\t\t}\r\n\t}\r\n};\r\nValidatorContext.prototype.defineKeyword = function (keyword, keywordFunction) {\r\n\tthis.definedKeywords[keyword] = this.definedKeywords[keyword] || [];\r\n\tthis.definedKeywords[keyword].push(keywordFunction);\r\n};\r\nValidatorContext.prototype.createError = function (code, messageParams, dataPath, schemaPath, subErrors, data, schema) {\r\n\tvar error = new ValidationError(code, messageParams, dataPath, schemaPath, subErrors);\r\n\terror.message = this.errorReporter(error, data, schema);\r\n\treturn error;\r\n};\r\nValidatorContext.prototype.returnError = function (error) {\r\n\treturn error;\r\n};\r\nValidatorContext.prototype.collectError = function (error) {\r\n\tif (error) {\r\n\t\tthis.errors.push(error);\r\n\t}\r\n\treturn null;\r\n};\r\nValidatorContext.prototype.prefixErrors = function (startIndex, dataPath, schemaPath) {\r\n\tfor (var i = startIndex; i < this.errors.length; i++) {\r\n\t\tthis.errors[i] = this.errors[i].prefixWith(dataPath, schemaPath);\r\n\t}\r\n\treturn this;\r\n};\r\nValidatorContext.prototype.banUnknownProperties = function (data, schema) {\r\n\tfor (var unknownPath in this.unknownPropertyPaths) {\r\n\t\tvar error = this.createError(ErrorCodes.UNKNOWN_PROPERTY, {path: unknownPath}, unknownPath, "", null, data, schema);\r\n\t\tvar result = this.handleError(error);\r\n\t\tif (result) {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.addFormat = function (format, validator) {\r\n\tif (typeof format === \'object\') {\r\n\t\tfor (var key in format) {\r\n\t\t\tthis.addFormat(key, format[key]);\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\tthis.formatValidators[format] = validator;\r\n};\r\nValidatorContext.prototype.resolveRefs = function (schema, urlHistory) {\r\n\tif (schema[\'$ref\'] !== undefined) {\r\n\t\turlHistory = urlHistory || {};\r\n\t\tif (urlHistory[schema[\'$ref\']]) {\r\n\t\t\treturn this.createError(ErrorCodes.CIRCULAR_REFERENCE, {urls: Object.keys(urlHistory).join(\', \')}, \'\', \'\', null, undefined, schema);\r\n\t\t}\r\n\t\turlHistory[schema[\'$ref\']] = true;\r\n\t\tschema = this.getSchema(schema[\'$ref\'], urlHistory);\r\n\t}\r\n\treturn schema;\r\n};\r\nValidatorContext.prototype.getSchema = function (url, urlHistory) {\r\n\tvar schema;\r\n\tif (this.schemas[url] !== undefined) {\r\n\t\tschema = this.schemas[url];\r\n\t\treturn this.resolveRefs(schema, urlHistory);\r\n\t}\r\n\tvar baseUrl = url;\r\n\tvar fragment = "";\r\n\tif (url.indexOf(\'#\') !== -1) {\r\n\t\tfragment = url.substring(url.indexOf("#") + 1);\r\n\t\tbaseUrl = url.substring(0, url.indexOf("#"));\r\n\t}\r\n\tif (typeof this.schemas[baseUrl] === \'object\') {\r\n\t\tschema = this.schemas[baseUrl];\r\n\t\tvar pointerPath = decodeURIComponent(fragment);\r\n\t\tif (pointerPath === "") {\r\n\t\t\treturn this.resolveRefs(schema, urlHistory);\r\n\t\t} else if (pointerPath.charAt(0) !== "/") {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\tvar parts = pointerPath.split("/").slice(1);\r\n\t\tfor (var i = 0; i < parts.length; i++) {\r\n\t\t\tvar component = parts[i].replace(/~1/g, "/").replace(/~0/g, "~");\r\n\t\t\tif (schema[component] === undefined) {\r\n\t\t\t\tschema = undefined;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tschema = schema[component];\r\n\t\t}\r\n\t\tif (schema !== undefined) {\r\n\t\t\treturn this.resolveRefs(schema, urlHistory);\r\n\t\t}\r\n\t}\r\n\tif (this.missing[baseUrl] === undefined) {\r\n\t\tthis.missing.push(baseUrl);\r\n\t\tthis.missing[baseUrl] = baseUrl;\r\n\t\tthis.missingMap[baseUrl] = baseUrl;\r\n\t}\r\n};\r\nValidatorContext.prototype.searchSchemas = function (schema, url) {\r\n\tif (Array.isArray(schema)) {\r\n\t\tfor (var i = 0; i < schema.length; i++) {\r\n\t\t\tthis.searchSchemas(schema[i], url);\r\n\t\t}\r\n\t} else if (schema && typeof schema === "object") {\r\n\t\tif (typeof schema.id === "string") {\r\n\t\t\tif (isTrustedUrl(url, schema.id)) {\r\n\t\t\t\tif (this.schemas[schema.id] === undefined) {\r\n\t\t\t\t\tthis.schemas[schema.id] = schema;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var key in schema) {\r\n\t\t\tif (key !== "enum") {\r\n\t\t\t\tif (typeof schema[key] === "object") {\r\n\t\t\t\t\tthis.searchSchemas(schema[key], url);\r\n\t\t\t\t} else if (key === "$ref") {\r\n\t\t\t\t\tvar uri = getDocumentUri(schema[key]);\r\n\t\t\t\t\tif (uri && this.schemas[uri] === undefined && this.missingMap[uri] === undefined) {\r\n\t\t\t\t\t\tthis.missingMap[uri] = uri;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\nValidatorContext.prototype.addSchema = function (url, schema) {\r\n\t//overload\r\n\tif (typeof url !== \'string\' || typeof schema === \'undefined\') {\r\n\t\tif (typeof url === \'object\' && typeof url.id === \'string\') {\r\n\t\t\tschema = url;\r\n\t\t\turl = schema.id;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif (url === getDocumentUri(url) + "#") {\r\n\t\t// Remove empty fragment\r\n\t\turl = getDocumentUri(url);\r\n\t}\r\n\tthis.schemas[url] = schema;\r\n\tdelete this.missingMap[url];\r\n\tnormSchema(schema, url);\r\n\tthis.searchSchemas(schema, url);\r\n};\r\n\r\nValidatorContext.prototype.getSchemaMap = function () {\r\n\tvar map = {};\r\n\tfor (var key in this.schemas) {\r\n\t\tmap[key] = this.schemas[key];\r\n\t}\r\n\treturn map;\r\n};\r\n\r\nValidatorContext.prototype.getSchemaUris = function (filterRegExp) {\r\n\tvar list = [];\r\n\tfor (var key in this.schemas) {\r\n\t\tif (!filterRegExp || filterRegExp.test(key)) {\r\n\t\t\tlist.push(key);\r\n\t\t}\r\n\t}\r\n\treturn list;\r\n};\r\n\r\nValidatorContext.prototype.getMissingUris = function (filterRegExp) {\r\n\tvar list = [];\r\n\tfor (var key in this.missingMap) {\r\n\t\tif (!filterRegExp || filterRegExp.test(key)) {\r\n\t\t\tlist.push(key);\r\n\t\t}\r\n\t}\r\n\treturn list;\r\n};\r\n\r\nValidatorContext.prototype.dropSchemas = function () {\r\n\tthis.schemas = {};\r\n\tthis.reset();\r\n};\r\nValidatorContext.prototype.reset = function () {\r\n\tthis.missing = [];\r\n\tthis.missingMap = {};\r\n\tthis.errors = [];\r\n};\r\n\r\nValidatorContext.prototype.validateAll = function (data, schema, dataPathParts, schemaPathParts, dataPointerPath) {\r\n\tvar topLevel;\r\n\tschema = this.resolveRefs(schema);\r\n\tif (!schema) {\r\n\t\treturn null;\r\n\t} else if (schema instanceof ValidationError) {\r\n\t\tthis.errors.push(schema);\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tvar startErrorCount = this.errors.length;\r\n\tvar frozenIndex, scannedFrozenSchemaIndex = null, scannedSchemasIndex = null;\r\n\tif (this.checkRecursive && data && typeof data === \'object\') {\r\n\t\ttopLevel = !this.scanned.length;\r\n\t\tif (data[this.validatedSchemasKey]) {\r\n\t\t\tvar schemaIndex = data[this.validatedSchemasKey].indexOf(schema);\r\n\t\t\tif (schemaIndex !== -1) {\r\n\t\t\t\tthis.errors = this.errors.concat(data[this.validationErrorsKey][schemaIndex]);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (Object.isFrozen(data)) {\r\n\t\t\tfrozenIndex = this.scannedFrozen.indexOf(data);\r\n\t\t\tif (frozenIndex !== -1) {\r\n\t\t\t\tvar frozenSchemaIndex = this.scannedFrozenSchemas[frozenIndex].indexOf(schema);\r\n\t\t\t\tif (frozenSchemaIndex !== -1) {\r\n\t\t\t\t\tthis.errors = this.errors.concat(this.scannedFrozenValidationErrors[frozenIndex][frozenSchemaIndex]);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.scanned.push(data);\r\n\t\tif (Object.isFrozen(data)) {\r\n\t\t\tif (frozenIndex === -1) {\r\n\t\t\t\tfrozenIndex = this.scannedFrozen.length;\r\n\t\t\t\tthis.scannedFrozen.push(data);\r\n\t\t\t\tthis.scannedFrozenSchemas.push([]);\r\n\t\t\t}\r\n\t\t\tscannedFrozenSchemaIndex = this.scannedFrozenSchemas[frozenIndex].length;\r\n\t\t\tthis.scannedFrozenSchemas[frozenIndex][scannedFrozenSchemaIndex] = schema;\r\n\t\t\tthis.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex] = [];\r\n\t\t} else {\r\n\t\t\tif (!data[this.validatedSchemasKey]) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tObject.defineProperty(data, this.validatedSchemasKey, {\r\n\t\t\t\t\t\tvalue: [],\r\n\t\t\t\t\t\tconfigurable: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\tObject.defineProperty(data, this.validationErrorsKey, {\r\n\t\t\t\t\t\tvalue: [],\r\n\t\t\t\t\t\tconfigurable: true\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\t//IE 7/8 workaround\r\n\t\t\t\t\tdata[this.validatedSchemasKey] = [];\r\n\t\t\t\t\tdata[this.validationErrorsKey] = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tscannedSchemasIndex = data[this.validatedSchemasKey].length;\r\n\t\t\tdata[this.validatedSchemasKey][scannedSchemasIndex] = schema;\r\n\t\t\tdata[this.validationErrorsKey][scannedSchemasIndex] = [];\r\n\t\t}\r\n\t}\r\n\r\n\tvar errorCount = this.errors.length;\r\n\tvar error = this.validateBasic(data, schema, dataPointerPath)\r\n\t\t|| this.validateNumeric(data, schema, dataPointerPath)\r\n\t\t|| this.validateString(data, schema, dataPointerPath)\r\n\t\t|| this.validateArray(data, schema, dataPointerPath)\r\n\t\t|| this.validateObject(data, schema, dataPointerPath)\r\n\t\t|| this.validateCombinations(data, schema, dataPointerPath)\r\n\t\t|| this.validateHypermedia(data, schema, dataPointerPath)\r\n\t\t|| this.validateFormat(data, schema, dataPointerPath)\r\n\t\t|| this.validateDefinedKeywords(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n\r\n\tif (topLevel) {\r\n\t\twhile (this.scanned.length) {\r\n\t\t\tvar item = this.scanned.pop();\r\n\t\t\tdelete item[this.validatedSchemasKey];\r\n\t\t}\r\n\t\tthis.scannedFrozen = [];\r\n\t\tthis.scannedFrozenSchemas = [];\r\n\t}\r\n\r\n\tif (error || errorCount !== this.errors.length) {\r\n\t\twhile ((dataPathParts && dataPathParts.length) || (schemaPathParts && schemaPathParts.length)) {\r\n\t\t\tvar dataPart = (dataPathParts && dataPathParts.length) ? "" + dataPathParts.pop() : null;\r\n\t\t\tvar schemaPart = (schemaPathParts && schemaPathParts.length) ? "" + schemaPathParts.pop() : null;\r\n\t\t\tif (error) {\r\n\t\t\t\terror = error.prefixWith(dataPart, schemaPart);\r\n\t\t\t}\r\n\t\t\tthis.prefixErrors(errorCount, dataPart, schemaPart);\r\n\t\t}\r\n\t}\r\n\r\n\tif (scannedFrozenSchemaIndex !== null) {\r\n\t\tthis.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex] = this.errors.slice(startErrorCount);\r\n\t} else if (scannedSchemasIndex !== null) {\r\n\t\tdata[this.validationErrorsKey][scannedSchemasIndex] = this.errors.slice(startErrorCount);\r\n\t}\r\n\r\n\treturn this.handleError(error);\r\n};\r\nValidatorContext.prototype.validateFormat = function (data, schema) {\r\n\tif (typeof schema.format !== \'string\' || !this.formatValidators[schema.format]) {\r\n\t\treturn null;\r\n\t}\r\n\tvar errorMessage = this.formatValidators[schema.format].call(null, data, schema);\r\n\tif (typeof errorMessage === \'string\' || typeof errorMessage === \'number\') {\r\n\t\treturn this.createError(ErrorCodes.FORMAT_CUSTOM, {message: errorMessage}, \'\', \'/format\', null, data, schema);\r\n\t} else if (errorMessage && typeof errorMessage === \'object\') {\r\n\t\treturn this.createError(ErrorCodes.FORMAT_CUSTOM, {message: errorMessage.message || "?"}, errorMessage.dataPath || \'\', errorMessage.schemaPath || "/format", null, data, schema);\r\n\t}\r\n\treturn null;\r\n};\r\nValidatorContext.prototype.validateDefinedKeywords = function (data, schema, dataPointerPath) {\r\n\tfor (var key in this.definedKeywords) {\r\n\t\tif (typeof schema[key] === \'undefined\') {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tvar validationFunctions = this.definedKeywords[key];\r\n\t\tfor (var i = 0; i < validationFunctions.length; i++) {\r\n\t\t\tvar func = validationFunctions[i];\r\n\t\t\tvar result = func(data, schema[key], schema, dataPointerPath);\r\n\t\t\tif (typeof result === \'string\' || typeof result === \'number\') {\r\n\t\t\t\treturn this.createError(ErrorCodes.KEYWORD_CUSTOM, {key: key, message: result}, \'\', \'\', null, data, schema).prefixWith(null, key);\r\n\t\t\t} else if (result && typeof result === \'object\') {\r\n\t\t\t\tvar code = result.code;\r\n\t\t\t\tif (typeof code === \'string\') {\r\n\t\t\t\t\tif (!ErrorCodes[code]) {\r\n\t\t\t\t\t\tthrow new Error(\'Undefined error code (use defineError): \' + code);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcode = ErrorCodes[code];\r\n\t\t\t\t} else if (typeof code !== \'number\') {\r\n\t\t\t\t\tcode = ErrorCodes.KEYWORD_CUSTOM;\r\n\t\t\t\t}\r\n\t\t\t\tvar messageParams = (typeof result.message === \'object\') ? result.message : {key: key, message: result.message || "?"};\r\n\t\t\t\tvar schemaPath = result.schemaPath || ("/" + key.replace(/~/g, \'~0\').replace(/\\//g, \'~1\'));\r\n\t\t\t\treturn this.createError(code, messageParams, result.dataPath || null, schemaPath, null, data, schema);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nfunction recursiveCompare(A, B) {\r\n\tif (A === B) {\r\n\t\treturn true;\r\n\t}\r\n\tif (A && B && typeof A === "object" && typeof B === "object") {\r\n\t\tif (Array.isArray(A) !== Array.isArray(B)) {\r\n\t\t\treturn false;\r\n\t\t} else if (Array.isArray(A)) {\r\n\t\t\tif (A.length !== B.length) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < A.length; i++) {\r\n\t\t\t\tif (!recursiveCompare(A[i], B[i])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar key;\r\n\t\t\tfor (key in A) {\r\n\t\t\t\tif (B[key] === undefined && A[key] !== undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (key in B) {\r\n\t\t\t\tif (A[key] === undefined && B[key] !== undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (key in A) {\r\n\t\t\t\tif (!recursiveCompare(A[key], B[key])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValidatorContext.prototype.validateBasic = function validateBasic(data, schema, dataPointerPath) {\r\n\tvar error;\r\n\tif (error = this.validateType(data, schema, dataPointerPath)) {\r\n\t\treturn error.prefixWith(null, "type");\r\n\t}\r\n\tif (error = this.validateEnum(data, schema, dataPointerPath)) {\r\n\t\treturn error.prefixWith(null, "type");\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateType = function validateType(data, schema) {\r\n\tif (schema.type === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar dataType = typeof data;\r\n\tif (data === null) {\r\n\t\tdataType = "null";\r\n\t} else if (Array.isArray(data)) {\r\n\t\tdataType = "array";\r\n\t}\r\n\tvar allowedTypes = schema.type;\r\n\tif (!Array.isArray(allowedTypes)) {\r\n\t\tallowedTypes = [allowedTypes];\r\n\t}\r\n\r\n\tfor (var i = 0; i < allowedTypes.length; i++) {\r\n\t\tvar type = allowedTypes[i];\r\n\t\tif (type === dataType || (type === "integer" && dataType === "number" && (data % 1 === 0))) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\treturn this.createError(ErrorCodes.INVALID_TYPE, {type: dataType, expected: allowedTypes.join("/")}, \'\', \'\', null, data, schema);\r\n};\r\n\r\nValidatorContext.prototype.validateEnum = function validateEnum(data, schema) {\r\n\tif (schema["enum"] === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tfor (var i = 0; i < schema["enum"].length; i++) {\r\n\t\tvar enumVal = schema["enum"][i];\r\n\t\tif (recursiveCompare(data, enumVal)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\treturn this.createError(ErrorCodes.ENUM_MISMATCH, {value: (typeof JSON !== \'undefined\') ? JSON.stringify(data) : data}, \'\', \'\', null, data, schema);\r\n};\r\n\r\nValidatorContext.prototype.validateNumeric = function validateNumeric(data, schema, dataPointerPath) {\r\n\treturn this.validateMultipleOf(data, schema, dataPointerPath)\r\n\t\t|| this.validateMinMax(data, schema, dataPointerPath)\r\n\t\t|| this.validateNaN(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nvar CLOSE_ENOUGH_LOW = Math.pow(2, -51);\r\nvar CLOSE_ENOUGH_HIGH = 1 - CLOSE_ENOUGH_LOW;\r\nValidatorContext.prototype.validateMultipleOf = function validateMultipleOf(data, schema) {\r\n\tvar multipleOf = schema.multipleOf || schema.divisibleBy;\r\n\tif (multipleOf === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tif (typeof data === "number") {\r\n\t\tvar remainder = (data/multipleOf)%1;\r\n\t\tif (remainder >= CLOSE_ENOUGH_LOW && remainder < CLOSE_ENOUGH_HIGH) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MULTIPLE_OF, {value: data, multipleOf: multipleOf}, \'\', \'\', null, data, schema);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateMinMax = function validateMinMax(data, schema) {\r\n\tif (typeof data !== "number") {\r\n\t\treturn null;\r\n\t}\r\n\tif (schema.minimum !== undefined) {\r\n\t\tif (data < schema.minimum) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MINIMUM, {value: data, minimum: schema.minimum}, \'\', \'/minimum\', null, data, schema);\r\n\t\t}\r\n\t\tif (schema.exclusiveMinimum && data === schema.minimum) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MINIMUM_EXCLUSIVE, {value: data, minimum: schema.minimum}, \'\', \'/exclusiveMinimum\', null, data, schema);\r\n\t\t}\r\n\t}\r\n\tif (schema.maximum !== undefined) {\r\n\t\tif (data > schema.maximum) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MAXIMUM, {value: data, maximum: schema.maximum}, \'\', \'/maximum\', null, data, schema);\r\n\t\t}\r\n\t\tif (schema.exclusiveMaximum && data === schema.maximum) {\r\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MAXIMUM_EXCLUSIVE, {value: data, maximum: schema.maximum}, \'\', \'/exclusiveMaximum\', null, data, schema);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateNaN = function validateNaN(data, schema) {\r\n\tif (typeof data !== "number") {\r\n\t\treturn null;\r\n\t}\r\n\tif (isNaN(data) === true || data === Infinity || data === -Infinity) {\r\n\t\treturn this.createError(ErrorCodes.NUMBER_NOT_A_NUMBER, {value: data}, \'\', \'/type\', null, data, schema);\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateString = function validateString(data, schema, dataPointerPath) {\r\n\treturn this.validateStringLength(data, schema, dataPointerPath)\r\n\t\t|| this.validateStringPattern(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nValidatorContext.prototype.validateStringLength = function validateStringLength(data, schema) {\r\n\tif (typeof data !== "string") {\r\n\t\treturn null;\r\n\t}\r\n\tif (schema.minLength !== undefined) {\r\n\t\tif (data.length < schema.minLength) {\r\n\t\t\treturn this.createError(ErrorCodes.STRING_LENGTH_SHORT, {length: data.length, minimum: schema.minLength}, \'\', \'/minLength\', null, data, schema);\r\n\t\t}\r\n\t}\r\n\tif (schema.maxLength !== undefined) {\r\n\t\tif (data.length > schema.maxLength) {\r\n\t\t\treturn this.createError(ErrorCodes.STRING_LENGTH_LONG, {length: data.length, maximum: schema.maxLength}, \'\', \'/maxLength\', null, data, schema);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateStringPattern = function validateStringPattern(data, schema) {\r\n\tif (typeof data !== "string" || (typeof schema.pattern !== "string" && !(schema.pattern instanceof RegExp))) {\r\n\t\treturn null;\r\n\t}\r\n\tvar regexp;\r\n\tif (schema.pattern instanceof RegExp) {\r\n\t  regexp = schema.pattern;\r\n\t}\r\n\telse {\r\n\t  var body, flags = \'\';\r\n\t  // Check for regular expression literals\r\n\t  // @see http://www.ecma-international.org/ecma-262/5.1/#sec-7.8.5\r\n\t  var literal = schema.pattern.match(/^\\/(.+)\\/([img]*)$/);\r\n\t  if (literal) {\r\n\t    body = literal[1];\r\n\t    flags = literal[2];\r\n\t  }\r\n\t  else {\r\n\t    body = schema.pattern;\r\n\t  }\r\n\t  regexp = new RegExp(body, flags);\r\n\t}\r\n\tif (!regexp.test(data)) {\r\n\t\treturn this.createError(ErrorCodes.STRING_PATTERN, {pattern: schema.pattern}, \'\', \'/pattern\', null, data, schema);\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateArray = function validateArray(data, schema, dataPointerPath) {\r\n\tif (!Array.isArray(data)) {\r\n\t\treturn null;\r\n\t}\r\n\treturn this.validateArrayLength(data, schema, dataPointerPath)\r\n\t\t|| this.validateArrayUniqueItems(data, schema, dataPointerPath)\r\n\t\t|| this.validateArrayItems(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nValidatorContext.prototype.validateArrayLength = function validateArrayLength(data, schema) {\r\n\tvar error;\r\n\tif (schema.minItems !== undefined) {\r\n\t\tif (data.length < schema.minItems) {\r\n\t\t\terror = this.createError(ErrorCodes.ARRAY_LENGTH_SHORT, {length: data.length, minimum: schema.minItems}, \'\', \'/minItems\', null, data, schema);\r\n\t\t\tif (this.handleError(error)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (schema.maxItems !== undefined) {\r\n\t\tif (data.length > schema.maxItems) {\r\n\t\t\terror = this.createError(ErrorCodes.ARRAY_LENGTH_LONG, {length: data.length, maximum: schema.maxItems}, \'\', \'/maxItems\', null, data, schema);\r\n\t\t\tif (this.handleError(error)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateArrayUniqueItems = function validateArrayUniqueItems(data, schema) {\r\n\tif (schema.uniqueItems) {\r\n\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\tfor (var j = i + 1; j < data.length; j++) {\r\n\t\t\t\tif (recursiveCompare(data[i], data[j])) {\r\n\t\t\t\t\tvar error = this.createError(ErrorCodes.ARRAY_UNIQUE, {match1: i, match2: j}, \'\', \'/uniqueItems\', null, data, schema);\r\n\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateArrayItems = function validateArrayItems(data, schema, dataPointerPath) {\r\n\tif (schema.items === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar error, i;\r\n\tif (Array.isArray(schema.items)) {\r\n\t\tfor (i = 0; i < data.length; i++) {\r\n\t\t\tif (i < schema.items.length) {\r\n\t\t\t\tif (error = this.validateAll(data[i], schema.items[i], [i], ["items", i], dataPointerPath + "/" + i)) {\r\n\t\t\t\t\treturn error;\r\n\t\t\t\t}\r\n\t\t\t} else if (schema.additionalItems !== undefined) {\r\n\t\t\t\tif (typeof schema.additionalItems === "boolean") {\r\n\t\t\t\t\tif (!schema.additionalItems) {\r\n\t\t\t\t\t\terror = (this.createError(ErrorCodes.ARRAY_ADDITIONAL_ITEMS, {}, \'/\' + i, \'/additionalItems\', null, data, schema));\r\n\t\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (error = this.validateAll(data[i], schema.additionalItems, [i], ["additionalItems"], dataPointerPath + "/" + i)) {\r\n\t\t\t\t\treturn error;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (i = 0; i < data.length; i++) {\r\n\t\t\tif (error = this.validateAll(data[i], schema.items, [i], ["items"], dataPointerPath + "/" + i)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateObject = function validateObject(data, schema, dataPointerPath) {\r\n\tif (typeof data !== "object" || data === null || Array.isArray(data)) {\r\n\t\treturn null;\r\n\t}\r\n\treturn this.validateObjectMinMaxProperties(data, schema, dataPointerPath)\r\n\t\t|| this.validateObjectRequiredProperties(data, schema, dataPointerPath)\r\n\t\t|| this.validateObjectProperties(data, schema, dataPointerPath)\r\n\t\t|| this.validateObjectDependencies(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nValidatorContext.prototype.validateObjectMinMaxProperties = function validateObjectMinMaxProperties(data, schema) {\r\n\tvar keys = Object.keys(data);\r\n\tvar error;\r\n\tif (schema.minProperties !== undefined) {\r\n\t\tif (keys.length < schema.minProperties) {\r\n\t\t\terror = this.createError(ErrorCodes.OBJECT_PROPERTIES_MINIMUM, {propertyCount: keys.length, minimum: schema.minProperties}, \'\', \'/minProperties\', null, data, schema);\r\n\t\t\tif (this.handleError(error)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (schema.maxProperties !== undefined) {\r\n\t\tif (keys.length > schema.maxProperties) {\r\n\t\t\terror = this.createError(ErrorCodes.OBJECT_PROPERTIES_MAXIMUM, {propertyCount: keys.length, maximum: schema.maxProperties}, \'\', \'/maxProperties\', null, data, schema);\r\n\t\t\tif (this.handleError(error)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateObjectRequiredProperties = function validateObjectRequiredProperties(data, schema) {\r\n\tif (schema.required !== undefined) {\r\n\t\tfor (var i = 0; i < schema.required.length; i++) {\r\n\t\t\tvar key = schema.required[i];\r\n\t\t\tif (data[key] === undefined) {\r\n\t\t\t\tvar error = this.createError(ErrorCodes.OBJECT_REQUIRED, {key: key}, \'\', \'/required/\' + i, null, data, schema);\r\n\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\treturn error;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateObjectProperties = function validateObjectProperties(data, schema, dataPointerPath) {\r\n\tvar error;\r\n\tfor (var key in data) {\r\n\t\tvar keyPointerPath = dataPointerPath + "/" + key.replace(/~/g, \'~0\').replace(/\\//g, \'~1\');\r\n\t\tvar foundMatch = false;\r\n\t\tif (schema.properties !== undefined && schema.properties[key] !== undefined) {\r\n\t\t\tfoundMatch = true;\r\n\t\t\tif (error = this.validateAll(data[key], schema.properties[key], [key], ["properties", key], keyPointerPath)) {\r\n\t\t\t\treturn error;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (schema.patternProperties !== undefined) {\r\n\t\t\tfor (var patternKey in schema.patternProperties) {\r\n\t\t\t\tvar regexp = new RegExp(patternKey);\r\n\t\t\t\tif (regexp.test(key)) {\r\n\t\t\t\t\tfoundMatch = true;\r\n\t\t\t\t\tif (error = this.validateAll(data[key], schema.patternProperties[patternKey], [key], ["patternProperties", patternKey], keyPointerPath)) {\r\n\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!foundMatch) {\r\n\t\t\tif (schema.additionalProperties !== undefined) {\r\n\t\t\t\tif (this.trackUnknownProperties) {\r\n\t\t\t\t\tthis.knownPropertyPaths[keyPointerPath] = true;\r\n\t\t\t\t\tdelete this.unknownPropertyPaths[keyPointerPath];\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof schema.additionalProperties === "boolean") {\r\n\t\t\t\t\tif (!schema.additionalProperties) {\r\n\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_ADDITIONAL_PROPERTIES, {key: key}, \'\', \'/additionalProperties\', null, data, schema).prefixWith(key, null);\r\n\t\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (error = this.validateAll(data[key], schema.additionalProperties, [key], ["additionalProperties"], keyPointerPath)) {\r\n\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (this.trackUnknownProperties && !this.knownPropertyPaths[keyPointerPath]) {\r\n\t\t\t\tthis.unknownPropertyPaths[keyPointerPath] = true;\r\n\t\t\t}\r\n\t\t} else if (this.trackUnknownProperties) {\r\n\t\t\tthis.knownPropertyPaths[keyPointerPath] = true;\r\n\t\t\tdelete this.unknownPropertyPaths[keyPointerPath];\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateObjectDependencies = function validateObjectDependencies(data, schema, dataPointerPath) {\r\n\tvar error;\r\n\tif (schema.dependencies !== undefined) {\r\n\t\tfor (var depKey in schema.dependencies) {\r\n\t\t\tif (data[depKey] !== undefined) {\r\n\t\t\t\tvar dep = schema.dependencies[depKey];\r\n\t\t\t\tif (typeof dep === "string") {\r\n\t\t\t\t\tif (data[dep] === undefined) {\r\n\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY, {key: depKey, missing: dep}, \'\', \'\', null, data, schema).prefixWith(null, depKey).prefixWith(null, "dependencies");\r\n\t\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (Array.isArray(dep)) {\r\n\t\t\t\t\tfor (var i = 0; i < dep.length; i++) {\r\n\t\t\t\t\t\tvar requiredKey = dep[i];\r\n\t\t\t\t\t\tif (data[requiredKey] === undefined) {\r\n\t\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY, {key: depKey, missing: requiredKey}, \'\', \'/\' + i, null, data, schema).prefixWith(null, depKey).prefixWith(null, "dependencies");\r\n\t\t\t\t\t\t\tif (this.handleError(error)) {\r\n\t\t\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (error = this.validateAll(data, dep, [], ["dependencies", depKey], dataPointerPath)) {\r\n\t\t\t\t\t\treturn error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateCombinations = function validateCombinations(data, schema, dataPointerPath) {\r\n\treturn this.validateAllOf(data, schema, dataPointerPath)\r\n\t\t|| this.validateAnyOf(data, schema, dataPointerPath)\r\n\t\t|| this.validateOneOf(data, schema, dataPointerPath)\r\n\t\t|| this.validateNot(data, schema, dataPointerPath)\r\n\t\t|| null;\r\n};\r\n\r\nValidatorContext.prototype.validateAllOf = function validateAllOf(data, schema, dataPointerPath) {\r\n\tif (schema.allOf === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar error;\r\n\tfor (var i = 0; i < schema.allOf.length; i++) {\r\n\t\tvar subSchema = schema.allOf[i];\r\n\t\tif (error = this.validateAll(data, subSchema, [], ["allOf", i], dataPointerPath)) {\r\n\t\t\treturn error;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateAnyOf = function validateAnyOf(data, schema, dataPointerPath) {\r\n\tif (schema.anyOf === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar errors = [];\r\n\tvar startErrorCount = this.errors.length;\r\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\r\n\tif (this.trackUnknownProperties) {\r\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\r\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\r\n\t}\r\n\tvar errorAtEnd = true;\r\n\tfor (var i = 0; i < schema.anyOf.length; i++) {\r\n\t\tif (this.trackUnknownProperties) {\r\n\t\t\tthis.unknownPropertyPaths = {};\r\n\t\t\tthis.knownPropertyPaths = {};\r\n\t\t}\r\n\t\tvar subSchema = schema.anyOf[i];\r\n\r\n\t\tvar errorCount = this.errors.length;\r\n\t\tvar error = this.validateAll(data, subSchema, [], ["anyOf", i], dataPointerPath);\r\n\r\n\t\tif (error === null && errorCount === this.errors.length) {\r\n\t\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\r\n\t\t\tif (this.trackUnknownProperties) {\r\n\t\t\t\tfor (var knownKey in this.knownPropertyPaths) {\r\n\t\t\t\t\toldKnownPropertyPaths[knownKey] = true;\r\n\t\t\t\t\tdelete oldUnknownPropertyPaths[knownKey];\r\n\t\t\t\t}\r\n\t\t\t\tfor (var unknownKey in this.unknownPropertyPaths) {\r\n\t\t\t\t\tif (!oldKnownPropertyPaths[unknownKey]) {\r\n\t\t\t\t\t\toldUnknownPropertyPaths[unknownKey] = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// We need to continue looping so we catch all the property definitions, but we don\'t want to return an error\r\n\t\t\t\terrorAtEnd = false;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (error) {\r\n\t\t\terrors.push(error.prefixWith(null, "" + i).prefixWith(null, "anyOf"));\r\n\t\t}\r\n\t}\r\n\tif (this.trackUnknownProperties) {\r\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\r\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\r\n\t}\r\n\tif (errorAtEnd) {\r\n\t\terrors = errors.concat(this.errors.slice(startErrorCount));\r\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\t\treturn this.createError(ErrorCodes.ANY_OF_MISSING, {}, "", "/anyOf", errors, data, schema);\r\n\t}\r\n};\r\n\r\nValidatorContext.prototype.validateOneOf = function validateOneOf(data, schema, dataPointerPath) {\r\n\tif (schema.oneOf === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar validIndex = null;\r\n\tvar errors = [];\r\n\tvar startErrorCount = this.errors.length;\r\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\r\n\tif (this.trackUnknownProperties) {\r\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\r\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\r\n\t}\r\n\tfor (var i = 0; i < schema.oneOf.length; i++) {\r\n\t\tif (this.trackUnknownProperties) {\r\n\t\t\tthis.unknownPropertyPaths = {};\r\n\t\t\tthis.knownPropertyPaths = {};\r\n\t\t}\r\n\t\tvar subSchema = schema.oneOf[i];\r\n\r\n\t\tvar errorCount = this.errors.length;\r\n\t\tvar error = this.validateAll(data, subSchema, [], ["oneOf", i], dataPointerPath);\r\n\r\n\t\tif (error === null && errorCount === this.errors.length) {\r\n\t\t\tif (validIndex === null) {\r\n\t\t\t\tvalidIndex = i;\r\n\t\t\t} else {\r\n\t\t\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\t\t\t\treturn this.createError(ErrorCodes.ONE_OF_MULTIPLE, {index1: validIndex, index2: i}, "", "/oneOf", null, data, schema);\r\n\t\t\t}\r\n\t\t\tif (this.trackUnknownProperties) {\r\n\t\t\t\tfor (var knownKey in this.knownPropertyPaths) {\r\n\t\t\t\t\toldKnownPropertyPaths[knownKey] = true;\r\n\t\t\t\t\tdelete oldUnknownPropertyPaths[knownKey];\r\n\t\t\t\t}\r\n\t\t\t\tfor (var unknownKey in this.unknownPropertyPaths) {\r\n\t\t\t\t\tif (!oldKnownPropertyPaths[unknownKey]) {\r\n\t\t\t\t\t\toldUnknownPropertyPaths[unknownKey] = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (error) {\r\n\t\t\terrors.push(error);\r\n\t\t}\r\n\t}\r\n\tif (this.trackUnknownProperties) {\r\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\r\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\r\n\t}\r\n\tif (validIndex === null) {\r\n\t\terrors = errors.concat(this.errors.slice(startErrorCount));\r\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\t\treturn this.createError(ErrorCodes.ONE_OF_MISSING, {}, "", "/oneOf", errors, data, schema);\r\n\t} else {\r\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateNot = function validateNot(data, schema, dataPointerPath) {\r\n\tif (schema.not === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\tvar oldErrorCount = this.errors.length;\r\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\r\n\tif (this.trackUnknownProperties) {\r\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\r\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\r\n\t\tthis.unknownPropertyPaths = {};\r\n\t\tthis.knownPropertyPaths = {};\r\n\t}\r\n\tvar error = this.validateAll(data, schema.not, null, null, dataPointerPath);\r\n\tvar notErrors = this.errors.slice(oldErrorCount);\r\n\tthis.errors = this.errors.slice(0, oldErrorCount);\r\n\tif (this.trackUnknownProperties) {\r\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\r\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\r\n\t}\r\n\tif (error === null && notErrors.length === 0) {\r\n\t\treturn this.createError(ErrorCodes.NOT_PASSED, {}, "", "/not", null, data, schema);\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nValidatorContext.prototype.validateHypermedia = function validateCombinations(data, schema, dataPointerPath) {\r\n\tif (!schema.links) {\r\n\t\treturn null;\r\n\t}\r\n\tvar error;\r\n\tfor (var i = 0; i < schema.links.length; i++) {\r\n\t\tvar ldo = schema.links[i];\r\n\t\tif (ldo.rel === "describedby") {\r\n\t\t\tvar template = new UriTemplate(ldo.href);\r\n\t\t\tvar allPresent = true;\r\n\t\t\tfor (var j = 0; j < template.varNames.length; j++) {\r\n\t\t\t\tif (!(template.varNames[j] in data)) {\r\n\t\t\t\t\tallPresent = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (allPresent) {\r\n\t\t\t\tvar schemaUrl = template.fillFromObject(data);\r\n\t\t\t\tvar subSchema = {"$ref": schemaUrl};\r\n\t\t\t\tif (error = this.validateAll(data, subSchema, [], ["links", i], dataPointerPath)) {\r\n\t\t\t\t\treturn error;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// parseURI() and resolveUrl() are from https://gist.github.com/1088850\r\n//   -  released as public domain by author ("Yaffle") - see comments on gist\r\n\r\nfunction parseURI(url) {\r\n\tvar m = String(url).replace(/^\\s+|\\s+$/g, \'\').match(/^([^:\\/?#]+:)?(\\/\\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\\/?#]*)(?::(\\d*))?))?([^?#]*)(\\?[^#]*)?(#[\\s\\S]*)?/);\r\n\t// authority = \'//\' + user + \':\' + pass \'@\' + hostname + \':\' port\r\n\treturn (m ? {\r\n\t\thref     : m[0] || \'\',\r\n\t\tprotocol : m[1] || \'\',\r\n\t\tauthority: m[2] || \'\',\r\n\t\thost     : m[3] || \'\',\r\n\t\thostname : m[4] || \'\',\r\n\t\tport     : m[5] || \'\',\r\n\t\tpathname : m[6] || \'\',\r\n\t\tsearch   : m[7] || \'\',\r\n\t\thash     : m[8] || \'\'\r\n\t} : null);\r\n}\r\n\r\nfunction resolveUrl(base, href) {// RFC 3986\r\n\r\n\tfunction removeDotSegments(input) {\r\n\t\tvar output = [];\r\n\t\tinput.replace(/^(\\.\\.?(\\/|$))+/, \'\')\r\n\t\t\t.replace(/\\/(\\.(\\/|$))+/g, \'/\')\r\n\t\t\t.replace(/\\/\\.\\.$/, \'/../\')\r\n\t\t\t.replace(/\\/?[^\\/]*/g, function (p) {\r\n\t\t\t\tif (p === \'/..\') {\r\n\t\t\t\t\toutput.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\toutput.push(p);\r\n\t\t\t\t}\r\n\t\t});\r\n\t\treturn output.join(\'\').replace(/^\\//, input.charAt(0) === \'/\' ? \'/\' : \'\');\r\n\t}\r\n\r\n\thref = parseURI(href || \'\');\r\n\tbase = parseURI(base || \'\');\r\n\r\n\treturn !href || !base ? null : (href.protocol || base.protocol) +\r\n\t\t(href.protocol || href.authority ? href.authority : base.authority) +\r\n\t\tremoveDotSegments(href.protocol || href.authority || href.pathname.charAt(0) === \'/\' ? href.pathname : (href.pathname ? ((base.authority && !base.pathname ? \'/\' : \'\') + base.pathname.slice(0, base.pathname.lastIndexOf(\'/\') + 1) + href.pathname) : base.pathname)) +\r\n\t\t(href.protocol || href.authority || href.pathname ? href.search : (href.search || base.search)) +\r\n\t\thref.hash;\r\n}\r\n\r\nfunction getDocumentUri(uri) {\r\n\treturn uri.split(\'#\')[0];\r\n}\r\nfunction normSchema(schema, baseUri) {\r\n\tif (schema && typeof schema === "object") {\r\n\t\tif (baseUri === undefined) {\r\n\t\t\tbaseUri = schema.id;\r\n\t\t} else if (typeof schema.id === "string") {\r\n\t\t\tbaseUri = resolveUrl(baseUri, schema.id);\r\n\t\t\tschema.id = baseUri;\r\n\t\t}\r\n\t\tif (Array.isArray(schema)) {\r\n\t\t\tfor (var i = 0; i < schema.length; i++) {\r\n\t\t\t\tnormSchema(schema[i], baseUri);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (typeof schema[\'$ref\'] === "string") {\r\n\t\t\t\tschema[\'$ref\'] = resolveUrl(baseUri, schema[\'$ref\']);\r\n\t\t\t}\r\n\t\t\tfor (var key in schema) {\r\n\t\t\t\tif (key !== "enum") {\r\n\t\t\t\t\tnormSchema(schema[key], baseUri);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction defaultErrorReporter(language) {\r\n\tlanguage = language || \'en\';\r\n\r\n\tvar errorMessages = languages[language];\r\n\r\n\treturn function (error) {\r\n\t\tvar messageTemplate = errorMessages[error.code] || ErrorMessagesDefault[error.code];\r\n\t\tif (typeof messageTemplate !== \'string\') {\r\n\t\t\treturn "Unknown error code " + error.code + ": " + JSON.stringify(error.messageParams);\r\n\t\t}\r\n\t\tvar messageParams = error.params;\r\n\t\t// Adapted from Crockford\'s supplant()\r\n\t\treturn messageTemplate.replace(/\\{([^{}]*)\\}/g, function (whole, varName) {\r\n\t\t\tvar subValue = messageParams[varName];\r\n\t\t\treturn typeof subValue === \'string\' || typeof subValue === \'number\' ? subValue : whole;\r\n\t\t});\r\n\t};\r\n}\r\n\r\nvar ErrorCodes = {\r\n\tINVALID_TYPE: 0,\r\n\tENUM_MISMATCH: 1,\r\n\tANY_OF_MISSING: 10,\r\n\tONE_OF_MISSING: 11,\r\n\tONE_OF_MULTIPLE: 12,\r\n\tNOT_PASSED: 13,\r\n\t// Numeric errors\r\n\tNUMBER_MULTIPLE_OF: 100,\r\n\tNUMBER_MINIMUM: 101,\r\n\tNUMBER_MINIMUM_EXCLUSIVE: 102,\r\n\tNUMBER_MAXIMUM: 103,\r\n\tNUMBER_MAXIMUM_EXCLUSIVE: 104,\r\n\tNUMBER_NOT_A_NUMBER: 105,\r\n\t// String errors\r\n\tSTRING_LENGTH_SHORT: 200,\r\n\tSTRING_LENGTH_LONG: 201,\r\n\tSTRING_PATTERN: 202,\r\n\t// Object errors\r\n\tOBJECT_PROPERTIES_MINIMUM: 300,\r\n\tOBJECT_PROPERTIES_MAXIMUM: 301,\r\n\tOBJECT_REQUIRED: 302,\r\n\tOBJECT_ADDITIONAL_PROPERTIES: 303,\r\n\tOBJECT_DEPENDENCY_KEY: 304,\r\n\t// Array errors\r\n\tARRAY_LENGTH_SHORT: 400,\r\n\tARRAY_LENGTH_LONG: 401,\r\n\tARRAY_UNIQUE: 402,\r\n\tARRAY_ADDITIONAL_ITEMS: 403,\r\n\t// Custom/user-defined errors\r\n\tFORMAT_CUSTOM: 500,\r\n\tKEYWORD_CUSTOM: 501,\r\n\t// Schema structure\r\n\tCIRCULAR_REFERENCE: 600,\r\n\t// Non-standard validation options\r\n\tUNKNOWN_PROPERTY: 1000\r\n};\r\nvar ErrorCodeLookup = {};\r\nfor (var key in ErrorCodes) {\r\n\tErrorCodeLookup[ErrorCodes[key]] = key;\r\n}\r\nvar ErrorMessagesDefault = {\r\n\tINVALID_TYPE: "Invalid type: {type} (expected {expected})",\r\n\tENUM_MISMATCH: "No enum match for: {value}",\r\n\tANY_OF_MISSING: "Data does not match any schemas from \\"anyOf\\"",\r\n\tONE_OF_MISSING: "Data does not match any schemas from \\"oneOf\\"",\r\n\tONE_OF_MULTIPLE: "Data is valid against more than one schema from \\"oneOf\\": indices {index1} and {index2}",\r\n\tNOT_PASSED: "Data matches schema from \\"not\\"",\r\n\t// Numeric errors\r\n\tNUMBER_MULTIPLE_OF: "Value {value} is not a multiple of {multipleOf}",\r\n\tNUMBER_MINIMUM: "Value {value} is less than minimum {minimum}",\r\n\tNUMBER_MINIMUM_EXCLUSIVE: "Value {value} is equal to exclusive minimum {minimum}",\r\n\tNUMBER_MAXIMUM: "Value {value} is greater than maximum {maximum}",\r\n\tNUMBER_MAXIMUM_EXCLUSIVE: "Value {value} is equal to exclusive maximum {maximum}",\r\n\tNUMBER_NOT_A_NUMBER: "Value {value} is not a valid number",\r\n\t// String errors\r\n\tSTRING_LENGTH_SHORT: "String is too short ({length} chars), minimum {minimum}",\r\n\tSTRING_LENGTH_LONG: "String is too long ({length} chars), maximum {maximum}",\r\n\tSTRING_PATTERN: "String does not match pattern: {pattern}",\r\n\t// Object errors\r\n\tOBJECT_PROPERTIES_MINIMUM: "Too few properties defined ({propertyCount}), minimum {minimum}",\r\n\tOBJECT_PROPERTIES_MAXIMUM: "Too many properties defined ({propertyCount}), maximum {maximum}",\r\n\tOBJECT_REQUIRED: "Missing required property: {key}",\r\n\tOBJECT_ADDITIONAL_PROPERTIES: "Additional properties not allowed",\r\n\tOBJECT_DEPENDENCY_KEY: "Dependency failed - key must exist: {missing} (due to key: {key})",\r\n\t// Array errors\r\n\tARRAY_LENGTH_SHORT: "Array is too short ({length}), minimum {minimum}",\r\n\tARRAY_LENGTH_LONG: "Array is too long ({length}), maximum {maximum}",\r\n\tARRAY_UNIQUE: "Array items are not unique (indices {match1} and {match2})",\r\n\tARRAY_ADDITIONAL_ITEMS: "Additional items not allowed",\r\n\t// Format errors\r\n\tFORMAT_CUSTOM: "Format validation failed ({message})",\r\n\tKEYWORD_CUSTOM: "Keyword failed: {key} ({message})",\r\n\t// Schema structure\r\n\tCIRCULAR_REFERENCE: "Circular $refs: {urls}",\r\n\t// Non-standard validation options\r\n\tUNKNOWN_PROPERTY: "Unknown property (not in schema)"\r\n};\r\n\r\nfunction ValidationError(code, params, dataPath, schemaPath, subErrors) {\r\n\tError.call(this);\r\n\tif (code === undefined) {\r\n\t\tthrow new Error ("No error code supplied: " + schemaPath);\r\n\t}\r\n\tthis.message = \'\';\r\n\tthis.params = params;\r\n\tthis.code = code;\r\n\tthis.dataPath = dataPath || "";\r\n\tthis.schemaPath = schemaPath || "";\r\n\tthis.subErrors = subErrors || null;\r\n\r\n\tvar err = new Error(this.message);\r\n\tthis.stack = err.stack || err.stacktrace;\r\n\tif (!this.stack) {\r\n\t\ttry {\r\n\t\t\tthrow err;\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthis.stack = err.stack || err.stacktrace;\r\n\t\t}\r\n\t}\r\n}\r\nValidationError.prototype = Object.create(Error.prototype);\r\nValidationError.prototype.constructor = ValidationError;\r\nValidationError.prototype.name = \'ValidationError\';\r\n\r\nValidationError.prototype.prefixWith = function (dataPrefix, schemaPrefix) {\r\n\tif (dataPrefix !== null) {\r\n\t\tdataPrefix = dataPrefix.replace(/~/g, "~0").replace(/\\//g, "~1");\r\n\t\tthis.dataPath = "/" + dataPrefix + this.dataPath;\r\n\t}\r\n\tif (schemaPrefix !== null) {\r\n\t\tschemaPrefix = schemaPrefix.replace(/~/g, "~0").replace(/\\//g, "~1");\r\n\t\tthis.schemaPath = "/" + schemaPrefix + this.schemaPath;\r\n\t}\r\n\tif (this.subErrors !== null) {\r\n\t\tfor (var i = 0; i < this.subErrors.length; i++) {\r\n\t\t\tthis.subErrors[i].prefixWith(dataPrefix, schemaPrefix);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nfunction isTrustedUrl(baseUrl, testUrl) {\r\n\tif(testUrl.substring(0, baseUrl.length) === baseUrl){\r\n\t\tvar remainder = testUrl.substring(baseUrl.length);\r\n\t\tif ((testUrl.length > 0 && testUrl.charAt(baseUrl.length - 1) === "/")\r\n\t\t\t|| remainder.charAt(0) === "#"\r\n\t\t\t|| remainder.charAt(0) === "?") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nvar languages = {};\r\nfunction createApi(language) {\r\n\tvar globalContext = new ValidatorContext();\r\n\tvar currentLanguage;\r\n\tvar customErrorReporter;\r\n\tvar api = {\r\n\t\tsetErrorReporter: function (reporter) {\r\n\t\t\tif (typeof reporter === \'string\') {\r\n\t\t\t\treturn this.language(reporter);\r\n\t\t\t}\r\n\t\t\tcustomErrorReporter = reporter;\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\taddFormat: function () {\r\n\t\t\tglobalContext.addFormat.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tlanguage: function (code) {\r\n\t\t\tif (!code) {\r\n\t\t\t\treturn currentLanguage;\r\n\t\t\t}\r\n\t\t\tif (!languages[code]) {\r\n\t\t\t\tcode = code.split(\'-\')[0]; // fall back to base language\r\n\t\t\t}\r\n\t\t\tif (languages[code]) {\r\n\t\t\t\tcurrentLanguage = code;\r\n\t\t\t\treturn code; // so you can tell if fall-back has happened\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\taddLanguage: function (code, messageMap) {\r\n\t\t\tvar key;\r\n\t\t\tfor (key in ErrorCodes) {\r\n\t\t\t\tif (messageMap[key] && !messageMap[ErrorCodes[key]]) {\r\n\t\t\t\t\tmessageMap[ErrorCodes[key]] = messageMap[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar rootCode = code.split(\'-\')[0];\r\n\t\t\tif (!languages[rootCode]) { // use for base language if not yet defined\r\n\t\t\t\tlanguages[code] = messageMap;\r\n\t\t\t\tlanguages[rootCode] = messageMap;\r\n\t\t\t} else {\r\n\t\t\t\tlanguages[code] = Object.create(languages[rootCode]);\r\n\t\t\t\tfor (key in messageMap) {\r\n\t\t\t\t\tif (typeof languages[rootCode][key] === \'undefined\') {\r\n\t\t\t\t\t\tlanguages[rootCode][key] = messageMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlanguages[code][key] = messageMap[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\tfreshApi: function (language) {\r\n\t\t\tvar result = createApi();\r\n\t\t\tif (language) {\r\n\t\t\t\tresult.language(language);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tvalidate: function (data, schema, checkRecursive, banUnknownProperties) {\r\n\t\t\tvar def = defaultErrorReporter(currentLanguage);\r\n\t\t\tvar errorReporter = customErrorReporter ? function (error, data, schema) {\r\n\t\t\t\treturn customErrorReporter(error, data, schema) || def(error, data, schema);\r\n\t\t\t} : def;\r\n\t\t\tvar context = new ValidatorContext(globalContext, false, errorReporter, checkRecursive, banUnknownProperties);\r\n\t\t\tif (typeof schema === "string") {\r\n\t\t\t\tschema = {"$ref": schema};\r\n\t\t\t}\r\n\t\t\tcontext.addSchema("", schema);\r\n\t\t\tvar error = context.validateAll(data, schema, null, null, "");\r\n\t\t\tif (!error && banUnknownProperties) {\r\n\t\t\t\terror = context.banUnknownProperties(data, schema);\r\n\t\t\t}\r\n\t\t\tthis.error = error;\r\n\t\t\tthis.missing = context.missing;\r\n\t\t\tthis.valid = (error === null);\r\n\t\t\treturn this.valid;\r\n\t\t},\r\n\t\tvalidateResult: function () {\r\n\t\t\tvar result = {toString: function () {\r\n\t\t\t\treturn this.valid ? \'valid\' : this.error.message;\r\n\t\t\t}};\r\n\t\t\tthis.validate.apply(result, arguments);\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tvalidateMultiple: function (data, schema, checkRecursive, banUnknownProperties) {\r\n\t\t\tvar def = defaultErrorReporter(currentLanguage);\r\n\t\t\tvar errorReporter = customErrorReporter ? function (error, data, schema) {\r\n\t\t\t\treturn customErrorReporter(error, data, schema) || def(error, data, schema);\r\n\t\t\t} : def;\r\n\t\t\tvar context = new ValidatorContext(globalContext, true, errorReporter, checkRecursive, banUnknownProperties);\r\n\t\t\tif (typeof schema === "string") {\r\n\t\t\t\tschema = {"$ref": schema};\r\n\t\t\t}\r\n\t\t\tcontext.addSchema("", schema);\r\n\t\t\tcontext.validateAll(data, schema, null, null, "");\r\n\t\t\tif (banUnknownProperties) {\r\n\t\t\t\tcontext.banUnknownProperties(data, schema);\r\n\t\t\t}\r\n\t\t\tvar result = {toString: function () {\r\n\t\t\t\treturn this.valid ? \'valid\' : this.error.message;\r\n\t\t\t}};\r\n\t\t\tresult.errors = context.errors;\r\n\t\t\tresult.missing = context.missing;\r\n\t\t\tresult.valid = (result.errors.length === 0);\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\taddSchema: function () {\r\n\t\t\treturn globalContext.addSchema.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tgetSchema: function () {\r\n\t\t\treturn globalContext.getSchema.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tgetSchemaMap: function () {\r\n\t\t\treturn globalContext.getSchemaMap.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tgetSchemaUris: function () {\r\n\t\t\treturn globalContext.getSchemaUris.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tgetMissingUris: function () {\r\n\t\t\treturn globalContext.getMissingUris.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tdropSchemas: function () {\r\n\t\t\tglobalContext.dropSchemas.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tdefineKeyword: function () {\r\n\t\t\tglobalContext.defineKeyword.apply(globalContext, arguments);\r\n\t\t},\r\n\t\tdefineError: function (codeName, codeNumber, defaultMessage) {\r\n\t\t\tif (typeof codeName !== \'string\' || !/^[A-Z]+(_[A-Z]+)*$/.test(codeName)) {\r\n\t\t\t\tthrow new Error(\'Code name must be a string in UPPER_CASE_WITH_UNDERSCORES\');\r\n\t\t\t}\r\n\t\t\tif (typeof codeNumber !== \'number\' || codeNumber%1 !== 0 || codeNumber < 10000) {\r\n\t\t\t\tthrow new Error(\'Code number must be an integer > 10000\');\r\n\t\t\t}\r\n\t\t\tif (typeof ErrorCodes[codeName] !== \'undefined\') {\r\n\t\t\t\tthrow new Error(\'Error already defined: \' + codeName + \' as \' + ErrorCodes[codeName]);\r\n\t\t\t}\r\n\t\t\tif (typeof ErrorCodeLookup[codeNumber] !== \'undefined\') {\r\n\t\t\t\tthrow new Error(\'Error code already used: \' + ErrorCodeLookup[codeNumber] + \' as \' + codeNumber);\r\n\t\t\t}\r\n\t\t\tErrorCodes[codeName] = codeNumber;\r\n\t\t\tErrorCodeLookup[codeNumber] = codeName;\r\n\t\t\tErrorMessagesDefault[codeName] = ErrorMessagesDefault[codeNumber] = defaultMessage;\r\n\t\t\tfor (var langCode in languages) {\r\n\t\t\t\tvar language = languages[langCode];\r\n\t\t\t\tif (language[codeName]) {\r\n\t\t\t\t\tlanguage[codeNumber] = language[codeNumber] || language[codeName];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\treset: function () {\r\n\t\t\tglobalContext.reset();\r\n\t\t\tthis.error = null;\r\n\t\t\tthis.missing = [];\r\n\t\t\tthis.valid = true;\r\n\t\t},\r\n\t\tmissing: [],\r\n\t\terror: null,\r\n\t\tvalid: true,\r\n\t\tnormSchema: normSchema,\r\n\t\tresolveUrl: resolveUrl,\r\n\t\tgetDocumentUri: getDocumentUri,\r\n\t\terrorCodes: ErrorCodes\r\n\t};\r\n\tapi.language(language || \'en\');\r\n\treturn api;\r\n}\r\n\r\nvar tv4 = createApi();\r\ntv4.addLanguage(\'en-gb\', ErrorMessagesDefault);\r\n\r\n//legacy property\r\ntv4.tv4 = tv4;\r\n\r\nreturn tv4; // used by _header.js to globalise.\r\n\r\n}));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvdHY0L3R2NC5qcz84ZTUyIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbkF1dGhvcjogR2VyYWludCBMdWZmIGFuZCBvdGhlcnNcclxuWWVhcjogMjAxM1xyXG5cclxuVGhpcyBjb2RlIGlzIHJlbGVhc2VkIGludG8gdGhlIFwicHVibGljIGRvbWFpblwiIGJ5IGl0cyBhdXRob3IocykuICBBbnlib2R5IG1heSB1c2UsIGFsdGVyIGFuZCBkaXN0cmlidXRlIHRoZSBjb2RlIHdpdGhvdXQgcmVzdHJpY3Rpb24uICBUaGUgYXV0aG9yIG1ha2VzIG5vIGd1YXJhbnRlZXMsIGFuZCB0YWtlcyBubyBsaWFiaWxpdHkgb2YgYW55IGtpbmQgZm9yIHVzZSBvZiB0aGlzIGNvZGUuXHJcblxyXG5JZiB5b3UgZmluZCBhIGJ1ZyBvciBtYWtlIGFuIGltcHJvdmVtZW50LCBpdCB3b3VsZCBiZSBjb3VydGVvdXMgdG8gbGV0IHRoZSBhdXRob3Iga25vdywgYnV0IGl0IGlzIG5vdCBjb21wdWxzb3J5LlxyXG4qL1xyXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xyXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcclxuICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cclxuICAgIGRlZmluZShbXSwgZmFjdG9yeSk7XHJcbiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cyl7XHJcbiAgICAvLyBDb21tb25KUy4gRGVmaW5lIGV4cG9ydC5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBCcm93c2VyIGdsb2JhbHNcclxuICAgIGdsb2JhbC50djQgPSBmYWN0b3J5KCk7XHJcbiAgfVxyXG59KHRoaXMsIGZ1bmN0aW9uICgpIHtcclxuXHJcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9rZXlzP3JlZGlyZWN0bG9jYWxlPWVuLVVTJnJlZGlyZWN0c2x1Zz1KYXZhU2NyaXB0JTJGUmVmZXJlbmNlJTJGR2xvYmFsX09iamVjdHMlMkZPYmplY3QlMkZrZXlzXHJcbmlmICghT2JqZWN0LmtleXMpIHtcclxuXHRPYmplY3Qua2V5cyA9IChmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LFxyXG5cdFx0XHRoYXNEb250RW51bUJ1ZyA9ICEoe3RvU3RyaW5nOiBudWxsfSkucHJvcGVydHlJc0VudW1lcmFibGUoJ3RvU3RyaW5nJyksXHJcblx0XHRcdGRvbnRFbnVtcyA9IFtcclxuXHRcdFx0XHQndG9TdHJpbmcnLFxyXG5cdFx0XHRcdCd0b0xvY2FsZVN0cmluZycsXHJcblx0XHRcdFx0J3ZhbHVlT2YnLFxyXG5cdFx0XHRcdCdoYXNPd25Qcm9wZXJ0eScsXHJcblx0XHRcdFx0J2lzUHJvdG90eXBlT2YnLFxyXG5cdFx0XHRcdCdwcm9wZXJ0eUlzRW51bWVyYWJsZScsXHJcblx0XHRcdFx0J2NvbnN0cnVjdG9yJ1xyXG5cdFx0XHRdLFxyXG5cdFx0XHRkb250RW51bXNMZW5ndGggPSBkb250RW51bXMubGVuZ3RoO1xyXG5cclxuXHRcdHJldHVybiBmdW5jdGlvbiAob2JqKSB7XHJcblx0XHRcdGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyAmJiB0eXBlb2Ygb2JqICE9PSAnZnVuY3Rpb24nIHx8IG9iaiA9PT0gbnVsbCkge1xyXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5rZXlzIGNhbGxlZCBvbiBub24tb2JqZWN0Jyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciByZXN1bHQgPSBbXTtcclxuXHJcblx0XHRcdGZvciAodmFyIHByb3AgaW4gb2JqKSB7XHJcblx0XHRcdFx0aWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkge1xyXG5cdFx0XHRcdFx0cmVzdWx0LnB1c2gocHJvcCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoaGFzRG9udEVudW1CdWcpIHtcclxuXHRcdFx0XHRmb3IgKHZhciBpPTA7IGkgPCBkb250RW51bXNMZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0aWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqLCBkb250RW51bXNbaV0pKSB7XHJcblx0XHRcdFx0XHRcdHJlc3VsdC5wdXNoKGRvbnRFbnVtc1tpXSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiByZXN1bHQ7XHJcblx0XHR9O1xyXG5cdH0pKCk7XHJcbn1cclxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2NyZWF0ZVxyXG5pZiAoIU9iamVjdC5jcmVhdGUpIHtcclxuXHRPYmplY3QuY3JlYXRlID0gKGZ1bmN0aW9uKCl7XHJcblx0XHRmdW5jdGlvbiBGKCl7fVxyXG5cclxuXHRcdHJldHVybiBmdW5jdGlvbihvKXtcclxuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggIT09IDEpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09iamVjdC5jcmVhdGUgaW1wbGVtZW50YXRpb24gb25seSBhY2NlcHRzIG9uZSBwYXJhbWV0ZXIuJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ri5wcm90b3R5cGUgPSBvO1xyXG5cdFx0XHRyZXR1cm4gbmV3IEYoKTtcclxuXHRcdH07XHJcblx0fSkoKTtcclxufVxyXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9pc0FycmF5P3JlZGlyZWN0bG9jYWxlPWVuLVVTJnJlZGlyZWN0c2x1Zz1KYXZhU2NyaXB0JTJGUmVmZXJlbmNlJTJGR2xvYmFsX09iamVjdHMlMkZBcnJheSUyRmlzQXJyYXlcclxuaWYoIUFycmF5LmlzQXJyYXkpIHtcclxuXHRBcnJheS5pc0FycmF5ID0gZnVuY3Rpb24gKHZBcmcpIHtcclxuXHRcdHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodkFyZykgPT09IFwiW29iamVjdCBBcnJheV1cIjtcclxuXHR9O1xyXG59XHJcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L2luZGV4T2Y/cmVkaXJlY3Rsb2NhbGU9ZW4tVVMmcmVkaXJlY3RzbHVnPUphdmFTY3JpcHQlMkZSZWZlcmVuY2UlMkZHbG9iYWxfT2JqZWN0cyUyRkFycmF5JTJGaW5kZXhPZlxyXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XHJcblx0QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoc2VhcmNoRWxlbWVudCAvKiwgZnJvbUluZGV4ICovICkge1xyXG5cdFx0aWYgKHRoaXMgPT09IG51bGwpIHtcclxuXHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG5cdFx0fVxyXG5cdFx0dmFyIHQgPSBPYmplY3QodGhpcyk7XHJcblx0XHR2YXIgbGVuID0gdC5sZW5ndGggPj4+IDA7XHJcblxyXG5cdFx0aWYgKGxlbiA9PT0gMCkge1xyXG5cdFx0XHRyZXR1cm4gLTE7XHJcblx0XHR9XHJcblx0XHR2YXIgbiA9IDA7XHJcblx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcclxuXHRcdFx0biA9IE51bWJlcihhcmd1bWVudHNbMV0pO1xyXG5cdFx0XHRpZiAobiAhPT0gbikgeyAvLyBzaG9ydGN1dCBmb3IgdmVyaWZ5aW5nIGlmIGl0J3MgTmFOXHJcblx0XHRcdFx0biA9IDA7XHJcblx0XHRcdH0gZWxzZSBpZiAobiAhPT0gMCAmJiBuICE9PSBJbmZpbml0eSAmJiBuICE9PSAtSW5maW5pdHkpIHtcclxuXHRcdFx0XHRuID0gKG4gPiAwIHx8IC0xKSAqIE1hdGguZmxvb3IoTWF0aC5hYnMobikpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAobiA+PSBsZW4pIHtcclxuXHRcdFx0cmV0dXJuIC0xO1xyXG5cdFx0fVxyXG5cdFx0dmFyIGsgPSBuID49IDAgPyBuIDogTWF0aC5tYXgobGVuIC0gTWF0aC5hYnMobiksIDApO1xyXG5cdFx0Zm9yICg7IGsgPCBsZW47IGsrKykge1xyXG5cdFx0XHRpZiAoayBpbiB0ICYmIHRba10gPT09IHNlYXJjaEVsZW1lbnQpIHtcclxuXHRcdFx0XHRyZXR1cm4gaztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIC0xO1xyXG5cdH07XHJcbn1cclxuXHJcbi8vIEdydW5nZXkgT2JqZWN0LmlzRnJvemVuIGhhY2tcclxuaWYgKCFPYmplY3QuaXNGcm96ZW4pIHtcclxuXHRPYmplY3QuaXNGcm96ZW4gPSBmdW5jdGlvbiAob2JqKSB7XHJcblx0XHR2YXIga2V5ID0gXCJ0djRfdGVzdF9mcm96ZW5fa2V5XCI7XHJcblx0XHR3aGlsZSAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuXHRcdFx0a2V5ICs9IE1hdGgucmFuZG9tKCk7XHJcblx0XHR9XHJcblx0XHR0cnkge1xyXG5cdFx0XHRvYmpba2V5XSA9IHRydWU7XHJcblx0XHRcdGRlbGV0ZSBvYmpba2V5XTtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9O1xyXG59XHJcbi8vIEJhc2VkIG9uOiBodHRwczovL2dpdGh1Yi5jb20vZ2VyYWludGx1ZmYvdXJpLXRlbXBsYXRlcywgYnV0IHdpdGggYWxsIHRoZSBkZS1zdWJzdGl0dXRpb24gc3R1ZmYgcmVtb3ZlZFxyXG5cclxudmFyIHVyaVRlbXBsYXRlR2xvYmFsTW9kaWZpZXJzID0ge1xyXG5cdFwiK1wiOiB0cnVlLFxyXG5cdFwiI1wiOiB0cnVlLFxyXG5cdFwiLlwiOiB0cnVlLFxyXG5cdFwiL1wiOiB0cnVlLFxyXG5cdFwiO1wiOiB0cnVlLFxyXG5cdFwiP1wiOiB0cnVlLFxyXG5cdFwiJlwiOiB0cnVlXHJcbn07XHJcbnZhciB1cmlUZW1wbGF0ZVN1ZmZpY2VzID0ge1xyXG5cdFwiKlwiOiB0cnVlXHJcbn07XHJcblxyXG5mdW5jdGlvbiBub3RSZWFsbHlQZXJjZW50RW5jb2RlKHN0cmluZykge1xyXG5cdHJldHVybiBlbmNvZGVVUkkoc3RyaW5nKS5yZXBsYWNlKC8lMjVbMC05XVswLTldL2csIGZ1bmN0aW9uIChkb3VibGVFbmNvZGVkKSB7XHJcblx0XHRyZXR1cm4gXCIlXCIgKyBkb3VibGVFbmNvZGVkLnN1YnN0cmluZygzKTtcclxuXHR9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXJpVGVtcGxhdGVTdWJzdGl0dXRpb24oc3BlYykge1xyXG5cdHZhciBtb2RpZmllciA9IFwiXCI7XHJcblx0aWYgKHVyaVRlbXBsYXRlR2xvYmFsTW9kaWZpZXJzW3NwZWMuY2hhckF0KDApXSkge1xyXG5cdFx0bW9kaWZpZXIgPSBzcGVjLmNoYXJBdCgwKTtcclxuXHRcdHNwZWMgPSBzcGVjLnN1YnN0cmluZygxKTtcclxuXHR9XHJcblx0dmFyIHNlcGFyYXRvciA9IFwiXCI7XHJcblx0dmFyIHByZWZpeCA9IFwiXCI7XHJcblx0dmFyIHNob3VsZEVzY2FwZSA9IHRydWU7XHJcblx0dmFyIHNob3dWYXJpYWJsZXMgPSBmYWxzZTtcclxuXHR2YXIgdHJpbUVtcHR5U3RyaW5nID0gZmFsc2U7XHJcblx0aWYgKG1vZGlmaWVyID09PSAnKycpIHtcclxuXHRcdHNob3VsZEVzY2FwZSA9IGZhbHNlO1xyXG5cdH0gZWxzZSBpZiAobW9kaWZpZXIgPT09IFwiLlwiKSB7XHJcblx0XHRwcmVmaXggPSBcIi5cIjtcclxuXHRcdHNlcGFyYXRvciA9IFwiLlwiO1xyXG5cdH0gZWxzZSBpZiAobW9kaWZpZXIgPT09IFwiL1wiKSB7XHJcblx0XHRwcmVmaXggPSBcIi9cIjtcclxuXHRcdHNlcGFyYXRvciA9IFwiL1wiO1xyXG5cdH0gZWxzZSBpZiAobW9kaWZpZXIgPT09ICcjJykge1xyXG5cdFx0cHJlZml4ID0gXCIjXCI7XHJcblx0XHRzaG91bGRFc2NhcGUgPSBmYWxzZTtcclxuXHR9IGVsc2UgaWYgKG1vZGlmaWVyID09PSAnOycpIHtcclxuXHRcdHByZWZpeCA9IFwiO1wiO1xyXG5cdFx0c2VwYXJhdG9yID0gXCI7XCI7XHJcblx0XHRzaG93VmFyaWFibGVzID0gdHJ1ZTtcclxuXHRcdHRyaW1FbXB0eVN0cmluZyA9IHRydWU7XHJcblx0fSBlbHNlIGlmIChtb2RpZmllciA9PT0gJz8nKSB7XHJcblx0XHRwcmVmaXggPSBcIj9cIjtcclxuXHRcdHNlcGFyYXRvciA9IFwiJlwiO1xyXG5cdFx0c2hvd1ZhcmlhYmxlcyA9IHRydWU7XHJcblx0fSBlbHNlIGlmIChtb2RpZmllciA9PT0gJyYnKSB7XHJcblx0XHRwcmVmaXggPSBcIiZcIjtcclxuXHRcdHNlcGFyYXRvciA9IFwiJlwiO1xyXG5cdFx0c2hvd1ZhcmlhYmxlcyA9IHRydWU7XHJcblx0fVxyXG5cclxuXHR2YXIgdmFyTmFtZXMgPSBbXTtcclxuXHR2YXIgdmFyTGlzdCA9IHNwZWMuc3BsaXQoXCIsXCIpO1xyXG5cdHZhciB2YXJTcGVjcyA9IFtdO1xyXG5cdHZhciB2YXJTcGVjTWFwID0ge307XHJcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCB2YXJMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHR2YXIgdmFyTmFtZSA9IHZhckxpc3RbaV07XHJcblx0XHR2YXIgdHJ1bmNhdGUgPSBudWxsO1xyXG5cdFx0aWYgKHZhck5hbWUuaW5kZXhPZihcIjpcIikgIT09IC0xKSB7XHJcblx0XHRcdHZhciBwYXJ0cyA9IHZhck5hbWUuc3BsaXQoXCI6XCIpO1xyXG5cdFx0XHR2YXJOYW1lID0gcGFydHNbMF07XHJcblx0XHRcdHRydW5jYXRlID0gcGFyc2VJbnQocGFydHNbMV0sIDEwKTtcclxuXHRcdH1cclxuXHRcdHZhciBzdWZmaWNlcyA9IHt9O1xyXG5cdFx0d2hpbGUgKHVyaVRlbXBsYXRlU3VmZmljZXNbdmFyTmFtZS5jaGFyQXQodmFyTmFtZS5sZW5ndGggLSAxKV0pIHtcclxuXHRcdFx0c3VmZmljZXNbdmFyTmFtZS5jaGFyQXQodmFyTmFtZS5sZW5ndGggLSAxKV0gPSB0cnVlO1xyXG5cdFx0XHR2YXJOYW1lID0gdmFyTmFtZS5zdWJzdHJpbmcoMCwgdmFyTmFtZS5sZW5ndGggLSAxKTtcclxuXHRcdH1cclxuXHRcdHZhciB2YXJTcGVjID0ge1xyXG5cdFx0XHR0cnVuY2F0ZTogdHJ1bmNhdGUsXHJcblx0XHRcdG5hbWU6IHZhck5hbWUsXHJcblx0XHRcdHN1ZmZpY2VzOiBzdWZmaWNlc1xyXG5cdFx0fTtcclxuXHRcdHZhclNwZWNzLnB1c2godmFyU3BlYyk7XHJcblx0XHR2YXJTcGVjTWFwW3Zhck5hbWVdID0gdmFyU3BlYztcclxuXHRcdHZhck5hbWVzLnB1c2godmFyTmFtZSk7XHJcblx0fVxyXG5cdHZhciBzdWJGdW5jdGlvbiA9IGZ1bmN0aW9uICh2YWx1ZUZ1bmN0aW9uKSB7XHJcblx0XHR2YXIgcmVzdWx0ID0gXCJcIjtcclxuXHRcdHZhciBzdGFydEluZGV4ID0gMDtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdmFyU3BlY3MubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIHZhclNwZWMgPSB2YXJTcGVjc1tpXTtcclxuXHRcdFx0dmFyIHZhbHVlID0gdmFsdWVGdW5jdGlvbih2YXJTcGVjLm5hbWUpO1xyXG5cdFx0XHRpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID09PSAwKSB8fCAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiBPYmplY3Qua2V5cyh2YWx1ZSkubGVuZ3RoID09PSAwKSkge1xyXG5cdFx0XHRcdHN0YXJ0SW5kZXgrKztcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaSA9PT0gc3RhcnRJbmRleCkge1xyXG5cdFx0XHRcdHJlc3VsdCArPSBwcmVmaXg7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmVzdWx0ICs9IChzZXBhcmF0b3IgfHwgXCIsXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xyXG5cdFx0XHRcdGlmIChzaG93VmFyaWFibGVzKSB7XHJcblx0XHRcdFx0XHRyZXN1bHQgKz0gdmFyU3BlYy5uYW1lICsgXCI9XCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgdmFsdWUubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdGlmIChqID4gMCkge1xyXG5cdFx0XHRcdFx0XHRyZXN1bHQgKz0gdmFyU3BlYy5zdWZmaWNlc1snKiddID8gKHNlcGFyYXRvciB8fCBcIixcIikgOiBcIixcIjtcclxuXHRcdFx0XHRcdFx0aWYgKHZhclNwZWMuc3VmZmljZXNbJyonXSAmJiBzaG93VmFyaWFibGVzKSB7XHJcblx0XHRcdFx0XHRcdFx0cmVzdWx0ICs9IHZhclNwZWMubmFtZSArIFwiPVwiO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXN1bHQgKz0gc2hvdWxkRXNjYXBlID8gZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlW2pdKS5yZXBsYWNlKC8hL2csIFwiJTIxXCIpIDogbm90UmVhbGx5UGVyY2VudEVuY29kZSh2YWx1ZVtqXSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xyXG5cdFx0XHRcdGlmIChzaG93VmFyaWFibGVzICYmICF2YXJTcGVjLnN1ZmZpY2VzWycqJ10pIHtcclxuXHRcdFx0XHRcdHJlc3VsdCArPSB2YXJTcGVjLm5hbWUgKyBcIj1cIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIGZpcnN0ID0gdHJ1ZTtcclxuXHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcclxuXHRcdFx0XHRcdGlmICghZmlyc3QpIHtcclxuXHRcdFx0XHRcdFx0cmVzdWx0ICs9IHZhclNwZWMuc3VmZmljZXNbJyonXSA/IChzZXBhcmF0b3IgfHwgXCIsXCIpIDogXCIsXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRmaXJzdCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0cmVzdWx0ICs9IHNob3VsZEVzY2FwZSA/IGVuY29kZVVSSUNvbXBvbmVudChrZXkpLnJlcGxhY2UoLyEvZywgXCIlMjFcIikgOiBub3RSZWFsbHlQZXJjZW50RW5jb2RlKGtleSk7XHJcblx0XHRcdFx0XHRyZXN1bHQgKz0gdmFyU3BlYy5zdWZmaWNlc1snKiddID8gJz0nIDogXCIsXCI7XHJcblx0XHRcdFx0XHRyZXN1bHQgKz0gc2hvdWxkRXNjYXBlID8gZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlW2tleV0pLnJlcGxhY2UoLyEvZywgXCIlMjFcIikgOiBub3RSZWFsbHlQZXJjZW50RW5jb2RlKHZhbHVlW2tleV0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZiAoc2hvd1ZhcmlhYmxlcykge1xyXG5cdFx0XHRcdFx0cmVzdWx0ICs9IHZhclNwZWMubmFtZTtcclxuXHRcdFx0XHRcdGlmICghdHJpbUVtcHR5U3RyaW5nIHx8IHZhbHVlICE9PSBcIlwiKSB7XHJcblx0XHRcdFx0XHRcdHJlc3VsdCArPSBcIj1cIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHZhclNwZWMudHJ1bmNhdGUgIT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0dmFsdWUgPSB2YWx1ZS5zdWJzdHJpbmcoMCwgdmFyU3BlYy50cnVuY2F0ZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJlc3VsdCArPSBzaG91bGRFc2NhcGUgPyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpLnJlcGxhY2UoLyEvZywgXCIlMjFcIik6IG5vdFJlYWxseVBlcmNlbnRFbmNvZGUodmFsdWUpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdH07XHJcblx0c3ViRnVuY3Rpb24udmFyTmFtZXMgPSB2YXJOYW1lcztcclxuXHRyZXR1cm4ge1xyXG5cdFx0cHJlZml4OiBwcmVmaXgsXHJcblx0XHRzdWJzdGl0dXRpb246IHN1YkZ1bmN0aW9uXHJcblx0fTtcclxufVxyXG5cclxuZnVuY3Rpb24gVXJpVGVtcGxhdGUodGVtcGxhdGUpIHtcclxuXHRpZiAoISh0aGlzIGluc3RhbmNlb2YgVXJpVGVtcGxhdGUpKSB7XHJcblx0XHRyZXR1cm4gbmV3IFVyaVRlbXBsYXRlKHRlbXBsYXRlKTtcclxuXHR9XHJcblx0dmFyIHBhcnRzID0gdGVtcGxhdGUuc3BsaXQoXCJ7XCIpO1xyXG5cdHZhciB0ZXh0UGFydHMgPSBbcGFydHMuc2hpZnQoKV07XHJcblx0dmFyIHByZWZpeGVzID0gW107XHJcblx0dmFyIHN1YnN0aXR1dGlvbnMgPSBbXTtcclxuXHR2YXIgdmFyTmFtZXMgPSBbXTtcclxuXHR3aGlsZSAocGFydHMubGVuZ3RoID4gMCkge1xyXG5cdFx0dmFyIHBhcnQgPSBwYXJ0cy5zaGlmdCgpO1xyXG5cdFx0dmFyIHNwZWMgPSBwYXJ0LnNwbGl0KFwifVwiKVswXTtcclxuXHRcdHZhciByZW1haW5kZXIgPSBwYXJ0LnN1YnN0cmluZyhzcGVjLmxlbmd0aCArIDEpO1xyXG5cdFx0dmFyIGZ1bmNzID0gdXJpVGVtcGxhdGVTdWJzdGl0dXRpb24oc3BlYyk7XHJcblx0XHRzdWJzdGl0dXRpb25zLnB1c2goZnVuY3Muc3Vic3RpdHV0aW9uKTtcclxuXHRcdHByZWZpeGVzLnB1c2goZnVuY3MucHJlZml4KTtcclxuXHRcdHRleHRQYXJ0cy5wdXNoKHJlbWFpbmRlcik7XHJcblx0XHR2YXJOYW1lcyA9IHZhck5hbWVzLmNvbmNhdChmdW5jcy5zdWJzdGl0dXRpb24udmFyTmFtZXMpO1xyXG5cdH1cclxuXHR0aGlzLmZpbGwgPSBmdW5jdGlvbiAodmFsdWVGdW5jdGlvbikge1xyXG5cdFx0dmFyIHJlc3VsdCA9IHRleHRQYXJ0c1swXTtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc3Vic3RpdHV0aW9ucy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgc3Vic3RpdHV0aW9uID0gc3Vic3RpdHV0aW9uc1tpXTtcclxuXHRcdFx0cmVzdWx0ICs9IHN1YnN0aXR1dGlvbih2YWx1ZUZ1bmN0aW9uKTtcclxuXHRcdFx0cmVzdWx0ICs9IHRleHRQYXJ0c1tpICsgMV07XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdH07XHJcblx0dGhpcy52YXJOYW1lcyA9IHZhck5hbWVzO1xyXG5cdHRoaXMudGVtcGxhdGUgPSB0ZW1wbGF0ZTtcclxufVxyXG5VcmlUZW1wbGF0ZS5wcm90b3R5cGUgPSB7XHJcblx0dG9TdHJpbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLnRlbXBsYXRlO1xyXG5cdH0sXHJcblx0ZmlsbEZyb21PYmplY3Q6IGZ1bmN0aW9uIChvYmopIHtcclxuXHRcdHJldHVybiB0aGlzLmZpbGwoZnVuY3Rpb24gKHZhck5hbWUpIHtcclxuXHRcdFx0cmV0dXJuIG9ialt2YXJOYW1lXTtcclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxudmFyIFZhbGlkYXRvckNvbnRleHQgPSBmdW5jdGlvbiBWYWxpZGF0b3JDb250ZXh0KHBhcmVudCwgY29sbGVjdE11bHRpcGxlLCBlcnJvclJlcG9ydGVyLCBjaGVja1JlY3Vyc2l2ZSwgdHJhY2tVbmtub3duUHJvcGVydGllcykge1xyXG5cdHRoaXMubWlzc2luZyA9IFtdO1xyXG5cdHRoaXMubWlzc2luZ01hcCA9IHt9O1xyXG5cdHRoaXMuZm9ybWF0VmFsaWRhdG9ycyA9IHBhcmVudCA/IE9iamVjdC5jcmVhdGUocGFyZW50LmZvcm1hdFZhbGlkYXRvcnMpIDoge307XHJcblx0dGhpcy5zY2hlbWFzID0gcGFyZW50ID8gT2JqZWN0LmNyZWF0ZShwYXJlbnQuc2NoZW1hcykgOiB7fTtcclxuXHR0aGlzLmNvbGxlY3RNdWx0aXBsZSA9IGNvbGxlY3RNdWx0aXBsZTtcclxuXHR0aGlzLmVycm9ycyA9IFtdO1xyXG5cdHRoaXMuaGFuZGxlRXJyb3IgPSBjb2xsZWN0TXVsdGlwbGUgPyB0aGlzLmNvbGxlY3RFcnJvciA6IHRoaXMucmV0dXJuRXJyb3I7XHJcblx0aWYgKGNoZWNrUmVjdXJzaXZlKSB7XHJcblx0XHR0aGlzLmNoZWNrUmVjdXJzaXZlID0gdHJ1ZTtcclxuXHRcdHRoaXMuc2Nhbm5lZCA9IFtdO1xyXG5cdFx0dGhpcy5zY2FubmVkRnJvemVuID0gW107XHJcblx0XHR0aGlzLnNjYW5uZWRGcm96ZW5TY2hlbWFzID0gW107XHJcblx0XHR0aGlzLnNjYW5uZWRGcm96ZW5WYWxpZGF0aW9uRXJyb3JzID0gW107XHJcblx0XHR0aGlzLnZhbGlkYXRlZFNjaGVtYXNLZXkgPSAndHY0X3ZhbGlkYXRpb25faWQnO1xyXG5cdFx0dGhpcy52YWxpZGF0aW9uRXJyb3JzS2V5ID0gJ3R2NF92YWxpZGF0aW9uX2Vycm9yc19pZCc7XHJcblx0fVxyXG5cdGlmICh0cmFja1Vua25vd25Qcm9wZXJ0aWVzKSB7XHJcblx0XHR0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMgPSB0cnVlO1xyXG5cdFx0dGhpcy5rbm93blByb3BlcnR5UGF0aHMgPSB7fTtcclxuXHRcdHRoaXMudW5rbm93blByb3BlcnR5UGF0aHMgPSB7fTtcclxuXHR9XHJcblx0dGhpcy5lcnJvclJlcG9ydGVyID0gZXJyb3JSZXBvcnRlciB8fCBkZWZhdWx0RXJyb3JSZXBvcnRlcignZW4nKTtcclxuXHRpZiAodHlwZW9mIHRoaXMuZXJyb3JSZXBvcnRlciA9PT0gJ3N0cmluZycpIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcignZGVidWcnKTtcclxuXHR9XHJcblx0dGhpcy5kZWZpbmVkS2V5d29yZHMgPSB7fTtcclxuXHRpZiAocGFyZW50KSB7XHJcblx0XHRmb3IgKHZhciBrZXkgaW4gcGFyZW50LmRlZmluZWRLZXl3b3Jkcykge1xyXG5cdFx0XHR0aGlzLmRlZmluZWRLZXl3b3Jkc1trZXldID0gcGFyZW50LmRlZmluZWRLZXl3b3Jkc1trZXldLnNsaWNlKDApO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUuZGVmaW5lS2V5d29yZCA9IGZ1bmN0aW9uIChrZXl3b3JkLCBrZXl3b3JkRnVuY3Rpb24pIHtcclxuXHR0aGlzLmRlZmluZWRLZXl3b3Jkc1trZXl3b3JkXSA9IHRoaXMuZGVmaW5lZEtleXdvcmRzW2tleXdvcmRdIHx8IFtdO1xyXG5cdHRoaXMuZGVmaW5lZEtleXdvcmRzW2tleXdvcmRdLnB1c2goa2V5d29yZEZ1bmN0aW9uKTtcclxufTtcclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlRXJyb3IgPSBmdW5jdGlvbiAoY29kZSwgbWVzc2FnZVBhcmFtcywgZGF0YVBhdGgsIHNjaGVtYVBhdGgsIHN1YkVycm9ycywgZGF0YSwgc2NoZW1hKSB7XHJcblx0dmFyIGVycm9yID0gbmV3IFZhbGlkYXRpb25FcnJvcihjb2RlLCBtZXNzYWdlUGFyYW1zLCBkYXRhUGF0aCwgc2NoZW1hUGF0aCwgc3ViRXJyb3JzKTtcclxuXHRlcnJvci5tZXNzYWdlID0gdGhpcy5lcnJvclJlcG9ydGVyKGVycm9yLCBkYXRhLCBzY2hlbWEpO1xyXG5cdHJldHVybiBlcnJvcjtcclxufTtcclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUucmV0dXJuRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuXHRyZXR1cm4gZXJyb3I7XHJcbn07XHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLmNvbGxlY3RFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xyXG5cdGlmIChlcnJvcikge1xyXG5cdFx0dGhpcy5lcnJvcnMucHVzaChlcnJvcik7XHJcblx0fVxyXG5cdHJldHVybiBudWxsO1xyXG59O1xyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS5wcmVmaXhFcnJvcnMgPSBmdW5jdGlvbiAoc3RhcnRJbmRleCwgZGF0YVBhdGgsIHNjaGVtYVBhdGgpIHtcclxuXHRmb3IgKHZhciBpID0gc3RhcnRJbmRleDsgaSA8IHRoaXMuZXJyb3JzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHR0aGlzLmVycm9yc1tpXSA9IHRoaXMuZXJyb3JzW2ldLnByZWZpeFdpdGgoZGF0YVBhdGgsIHNjaGVtYVBhdGgpO1xyXG5cdH1cclxuXHRyZXR1cm4gdGhpcztcclxufTtcclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUuYmFuVW5rbm93blByb3BlcnRpZXMgPSBmdW5jdGlvbiAoZGF0YSwgc2NoZW1hKSB7XHJcblx0Zm9yICh2YXIgdW5rbm93blBhdGggaW4gdGhpcy51bmtub3duUHJvcGVydHlQYXRocykge1xyXG5cdFx0dmFyIGVycm9yID0gdGhpcy5jcmVhdGVFcnJvcihFcnJvckNvZGVzLlVOS05PV05fUFJPUEVSVFksIHtwYXRoOiB1bmtub3duUGF0aH0sIHVua25vd25QYXRoLCBcIlwiLCBudWxsLCBkYXRhLCBzY2hlbWEpO1xyXG5cdFx0dmFyIHJlc3VsdCA9IHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpO1xyXG5cdFx0aWYgKHJlc3VsdCkge1xyXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLmFkZEZvcm1hdCA9IGZ1bmN0aW9uIChmb3JtYXQsIHZhbGlkYXRvcikge1xyXG5cdGlmICh0eXBlb2YgZm9ybWF0ID09PSAnb2JqZWN0Jykge1xyXG5cdFx0Zm9yICh2YXIga2V5IGluIGZvcm1hdCkge1xyXG5cdFx0XHR0aGlzLmFkZEZvcm1hdChrZXksIGZvcm1hdFtrZXldKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxuXHR0aGlzLmZvcm1hdFZhbGlkYXRvcnNbZm9ybWF0XSA9IHZhbGlkYXRvcjtcclxufTtcclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUucmVzb2x2ZVJlZnMgPSBmdW5jdGlvbiAoc2NoZW1hLCB1cmxIaXN0b3J5KSB7XHJcblx0aWYgKHNjaGVtYVsnJHJlZiddICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdHVybEhpc3RvcnkgPSB1cmxIaXN0b3J5IHx8IHt9O1xyXG5cdFx0aWYgKHVybEhpc3Rvcnlbc2NoZW1hWyckcmVmJ11dKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuQ0lSQ1VMQVJfUkVGRVJFTkNFLCB7dXJsczogT2JqZWN0LmtleXModXJsSGlzdG9yeSkuam9pbignLCAnKX0sICcnLCAnJywgbnVsbCwgdW5kZWZpbmVkLCBzY2hlbWEpO1xyXG5cdFx0fVxyXG5cdFx0dXJsSGlzdG9yeVtzY2hlbWFbJyRyZWYnXV0gPSB0cnVlO1xyXG5cdFx0c2NoZW1hID0gdGhpcy5nZXRTY2hlbWEoc2NoZW1hWyckcmVmJ10sIHVybEhpc3RvcnkpO1xyXG5cdH1cclxuXHRyZXR1cm4gc2NoZW1hO1xyXG59O1xyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS5nZXRTY2hlbWEgPSBmdW5jdGlvbiAodXJsLCB1cmxIaXN0b3J5KSB7XHJcblx0dmFyIHNjaGVtYTtcclxuXHRpZiAodGhpcy5zY2hlbWFzW3VybF0gIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0c2NoZW1hID0gdGhpcy5zY2hlbWFzW3VybF07XHJcblx0XHRyZXR1cm4gdGhpcy5yZXNvbHZlUmVmcyhzY2hlbWEsIHVybEhpc3RvcnkpO1xyXG5cdH1cclxuXHR2YXIgYmFzZVVybCA9IHVybDtcclxuXHR2YXIgZnJhZ21lbnQgPSBcIlwiO1xyXG5cdGlmICh1cmwuaW5kZXhPZignIycpICE9PSAtMSkge1xyXG5cdFx0ZnJhZ21lbnQgPSB1cmwuc3Vic3RyaW5nKHVybC5pbmRleE9mKFwiI1wiKSArIDEpO1xyXG5cdFx0YmFzZVVybCA9IHVybC5zdWJzdHJpbmcoMCwgdXJsLmluZGV4T2YoXCIjXCIpKTtcclxuXHR9XHJcblx0aWYgKHR5cGVvZiB0aGlzLnNjaGVtYXNbYmFzZVVybF0gPT09ICdvYmplY3QnKSB7XHJcblx0XHRzY2hlbWEgPSB0aGlzLnNjaGVtYXNbYmFzZVVybF07XHJcblx0XHR2YXIgcG9pbnRlclBhdGggPSBkZWNvZGVVUklDb21wb25lbnQoZnJhZ21lbnQpO1xyXG5cdFx0aWYgKHBvaW50ZXJQYXRoID09PSBcIlwiKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnJlc29sdmVSZWZzKHNjaGVtYSwgdXJsSGlzdG9yeSk7XHJcblx0XHR9IGVsc2UgaWYgKHBvaW50ZXJQYXRoLmNoYXJBdCgwKSAhPT0gXCIvXCIpIHtcclxuXHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHRcdHZhciBwYXJ0cyA9IHBvaW50ZXJQYXRoLnNwbGl0KFwiL1wiKS5zbGljZSgxKTtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGNvbXBvbmVudCA9IHBhcnRzW2ldLnJlcGxhY2UoL34xL2csIFwiL1wiKS5yZXBsYWNlKC9+MC9nLCBcIn5cIik7XHJcblx0XHRcdGlmIChzY2hlbWFbY29tcG9uZW50XSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0c2NoZW1hID0gdW5kZWZpbmVkO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHRcdHNjaGVtYSA9IHNjaGVtYVtjb21wb25lbnRdO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHNjaGVtYSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnJlc29sdmVSZWZzKHNjaGVtYSwgdXJsSGlzdG9yeSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGlmICh0aGlzLm1pc3NpbmdbYmFzZVVybF0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0dGhpcy5taXNzaW5nLnB1c2goYmFzZVVybCk7XHJcblx0XHR0aGlzLm1pc3NpbmdbYmFzZVVybF0gPSBiYXNlVXJsO1xyXG5cdFx0dGhpcy5taXNzaW5nTWFwW2Jhc2VVcmxdID0gYmFzZVVybDtcclxuXHR9XHJcbn07XHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnNlYXJjaFNjaGVtYXMgPSBmdW5jdGlvbiAoc2NoZW1hLCB1cmwpIHtcclxuXHRpZiAoQXJyYXkuaXNBcnJheShzY2hlbWEpKSB7XHJcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNjaGVtYS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR0aGlzLnNlYXJjaFNjaGVtYXMoc2NoZW1hW2ldLCB1cmwpO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSBpZiAoc2NoZW1hICYmIHR5cGVvZiBzY2hlbWEgPT09IFwib2JqZWN0XCIpIHtcclxuXHRcdGlmICh0eXBlb2Ygc2NoZW1hLmlkID09PSBcInN0cmluZ1wiKSB7XHJcblx0XHRcdGlmIChpc1RydXN0ZWRVcmwodXJsLCBzY2hlbWEuaWQpKSB7XHJcblx0XHRcdFx0aWYgKHRoaXMuc2NoZW1hc1tzY2hlbWEuaWRdID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdHRoaXMuc2NoZW1hc1tzY2hlbWEuaWRdID0gc2NoZW1hO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Zm9yICh2YXIga2V5IGluIHNjaGVtYSkge1xyXG5cdFx0XHRpZiAoa2V5ICE9PSBcImVudW1cIikge1xyXG5cdFx0XHRcdGlmICh0eXBlb2Ygc2NoZW1hW2tleV0gPT09IFwib2JqZWN0XCIpIHtcclxuXHRcdFx0XHRcdHRoaXMuc2VhcmNoU2NoZW1hcyhzY2hlbWFba2V5XSwgdXJsKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKGtleSA9PT0gXCIkcmVmXCIpIHtcclxuXHRcdFx0XHRcdHZhciB1cmkgPSBnZXREb2N1bWVudFVyaShzY2hlbWFba2V5XSk7XHJcblx0XHRcdFx0XHRpZiAodXJpICYmIHRoaXMuc2NoZW1hc1t1cmldID09PSB1bmRlZmluZWQgJiYgdGhpcy5taXNzaW5nTWFwW3VyaV0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLm1pc3NpbmdNYXBbdXJpXSA9IHVyaTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLmFkZFNjaGVtYSA9IGZ1bmN0aW9uICh1cmwsIHNjaGVtYSkge1xyXG5cdC8vb3ZlcmxvYWRcclxuXHRpZiAodHlwZW9mIHVybCAhPT0gJ3N0cmluZycgfHwgdHlwZW9mIHNjaGVtYSA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuXHRcdGlmICh0eXBlb2YgdXJsID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdXJsLmlkID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRzY2hlbWEgPSB1cmw7XHJcblx0XHRcdHVybCA9IHNjaGVtYS5pZDtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0fVxyXG5cdGlmICh1cmwgPT09IGdldERvY3VtZW50VXJpKHVybCkgKyBcIiNcIikge1xyXG5cdFx0Ly8gUmVtb3ZlIGVtcHR5IGZyYWdtZW50XHJcblx0XHR1cmwgPSBnZXREb2N1bWVudFVyaSh1cmwpO1xyXG5cdH1cclxuXHR0aGlzLnNjaGVtYXNbdXJsXSA9IHNjaGVtYTtcclxuXHRkZWxldGUgdGhpcy5taXNzaW5nTWFwW3VybF07XHJcblx0bm9ybVNjaGVtYShzY2hlbWEsIHVybCk7XHJcblx0dGhpcy5zZWFyY2hTY2hlbWFzKHNjaGVtYSwgdXJsKTtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLmdldFNjaGVtYU1hcCA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgbWFwID0ge307XHJcblx0Zm9yICh2YXIga2V5IGluIHRoaXMuc2NoZW1hcykge1xyXG5cdFx0bWFwW2tleV0gPSB0aGlzLnNjaGVtYXNba2V5XTtcclxuXHR9XHJcblx0cmV0dXJuIG1hcDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLmdldFNjaGVtYVVyaXMgPSBmdW5jdGlvbiAoZmlsdGVyUmVnRXhwKSB7XHJcblx0dmFyIGxpc3QgPSBbXTtcclxuXHRmb3IgKHZhciBrZXkgaW4gdGhpcy5zY2hlbWFzKSB7XHJcblx0XHRpZiAoIWZpbHRlclJlZ0V4cCB8fCBmaWx0ZXJSZWdFeHAudGVzdChrZXkpKSB7XHJcblx0XHRcdGxpc3QucHVzaChrZXkpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbGlzdDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLmdldE1pc3NpbmdVcmlzID0gZnVuY3Rpb24gKGZpbHRlclJlZ0V4cCkge1xyXG5cdHZhciBsaXN0ID0gW107XHJcblx0Zm9yICh2YXIga2V5IGluIHRoaXMubWlzc2luZ01hcCkge1xyXG5cdFx0aWYgKCFmaWx0ZXJSZWdFeHAgfHwgZmlsdGVyUmVnRXhwLnRlc3Qoa2V5KSkge1xyXG5cdFx0XHRsaXN0LnB1c2goa2V5KTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIGxpc3Q7XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS5kcm9wU2NoZW1hcyA9IGZ1bmN0aW9uICgpIHtcclxuXHR0aGlzLnNjaGVtYXMgPSB7fTtcclxuXHR0aGlzLnJlc2V0KCk7XHJcbn07XHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG5cdHRoaXMubWlzc2luZyA9IFtdO1xyXG5cdHRoaXMubWlzc2luZ01hcCA9IHt9O1xyXG5cdHRoaXMuZXJyb3JzID0gW107XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZUFsbCA9IGZ1bmN0aW9uIChkYXRhLCBzY2hlbWEsIGRhdGFQYXRoUGFydHMsIHNjaGVtYVBhdGhQYXJ0cywgZGF0YVBvaW50ZXJQYXRoKSB7XHJcblx0dmFyIHRvcExldmVsO1xyXG5cdHNjaGVtYSA9IHRoaXMucmVzb2x2ZVJlZnMoc2NoZW1hKTtcclxuXHRpZiAoIXNjaGVtYSkge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fSBlbHNlIGlmIChzY2hlbWEgaW5zdGFuY2VvZiBWYWxpZGF0aW9uRXJyb3IpIHtcclxuXHRcdHRoaXMuZXJyb3JzLnB1c2goc2NoZW1hKTtcclxuXHRcdHJldHVybiBzY2hlbWE7XHJcblx0fVxyXG5cclxuXHR2YXIgc3RhcnRFcnJvckNvdW50ID0gdGhpcy5lcnJvcnMubGVuZ3RoO1xyXG5cdHZhciBmcm96ZW5JbmRleCwgc2Nhbm5lZEZyb3plblNjaGVtYUluZGV4ID0gbnVsbCwgc2Nhbm5lZFNjaGVtYXNJbmRleCA9IG51bGw7XHJcblx0aWYgKHRoaXMuY2hlY2tSZWN1cnNpdmUgJiYgZGF0YSAmJiB0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdHRvcExldmVsID0gIXRoaXMuc2Nhbm5lZC5sZW5ndGg7XHJcblx0XHRpZiAoZGF0YVt0aGlzLnZhbGlkYXRlZFNjaGVtYXNLZXldKSB7XHJcblx0XHRcdHZhciBzY2hlbWFJbmRleCA9IGRhdGFbdGhpcy52YWxpZGF0ZWRTY2hlbWFzS2V5XS5pbmRleE9mKHNjaGVtYSk7XHJcblx0XHRcdGlmIChzY2hlbWFJbmRleCAhPT0gLTEpIHtcclxuXHRcdFx0XHR0aGlzLmVycm9ycyA9IHRoaXMuZXJyb3JzLmNvbmNhdChkYXRhW3RoaXMudmFsaWRhdGlvbkVycm9yc0tleV1bc2NoZW1hSW5kZXhdKTtcclxuXHRcdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKE9iamVjdC5pc0Zyb3plbihkYXRhKSkge1xyXG5cdFx0XHRmcm96ZW5JbmRleCA9IHRoaXMuc2Nhbm5lZEZyb3plbi5pbmRleE9mKGRhdGEpO1xyXG5cdFx0XHRpZiAoZnJvemVuSW5kZXggIT09IC0xKSB7XHJcblx0XHRcdFx0dmFyIGZyb3plblNjaGVtYUluZGV4ID0gdGhpcy5zY2FubmVkRnJvemVuU2NoZW1hc1tmcm96ZW5JbmRleF0uaW5kZXhPZihzY2hlbWEpO1xyXG5cdFx0XHRcdGlmIChmcm96ZW5TY2hlbWFJbmRleCAhPT0gLTEpIHtcclxuXHRcdFx0XHRcdHRoaXMuZXJyb3JzID0gdGhpcy5lcnJvcnMuY29uY2F0KHRoaXMuc2Nhbm5lZEZyb3plblZhbGlkYXRpb25FcnJvcnNbZnJvemVuSW5kZXhdW2Zyb3plblNjaGVtYUluZGV4XSk7XHJcblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHRoaXMuc2Nhbm5lZC5wdXNoKGRhdGEpO1xyXG5cdFx0aWYgKE9iamVjdC5pc0Zyb3plbihkYXRhKSkge1xyXG5cdFx0XHRpZiAoZnJvemVuSW5kZXggPT09IC0xKSB7XHJcblx0XHRcdFx0ZnJvemVuSW5kZXggPSB0aGlzLnNjYW5uZWRGcm96ZW4ubGVuZ3RoO1xyXG5cdFx0XHRcdHRoaXMuc2Nhbm5lZEZyb3plbi5wdXNoKGRhdGEpO1xyXG5cdFx0XHRcdHRoaXMuc2Nhbm5lZEZyb3plblNjaGVtYXMucHVzaChbXSk7XHJcblx0XHRcdH1cclxuXHRcdFx0c2Nhbm5lZEZyb3plblNjaGVtYUluZGV4ID0gdGhpcy5zY2FubmVkRnJvemVuU2NoZW1hc1tmcm96ZW5JbmRleF0ubGVuZ3RoO1xyXG5cdFx0XHR0aGlzLnNjYW5uZWRGcm96ZW5TY2hlbWFzW2Zyb3plbkluZGV4XVtzY2FubmVkRnJvemVuU2NoZW1hSW5kZXhdID0gc2NoZW1hO1xyXG5cdFx0XHR0aGlzLnNjYW5uZWRGcm96ZW5WYWxpZGF0aW9uRXJyb3JzW2Zyb3plbkluZGV4XVtzY2FubmVkRnJvemVuU2NoZW1hSW5kZXhdID0gW107XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpZiAoIWRhdGFbdGhpcy52YWxpZGF0ZWRTY2hlbWFzS2V5XSkge1xyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZGF0YSwgdGhpcy52YWxpZGF0ZWRTY2hlbWFzS2V5LCB7XHJcblx0XHRcdFx0XHRcdHZhbHVlOiBbXSxcclxuXHRcdFx0XHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlXHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkYXRhLCB0aGlzLnZhbGlkYXRpb25FcnJvcnNLZXksIHtcclxuXHRcdFx0XHRcdFx0dmFsdWU6IFtdLFxyXG5cdFx0XHRcdFx0XHRjb25maWd1cmFibGU6IHRydWVcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRcdC8vSUUgNy84IHdvcmthcm91bmRcclxuXHRcdFx0XHRcdGRhdGFbdGhpcy52YWxpZGF0ZWRTY2hlbWFzS2V5XSA9IFtdO1xyXG5cdFx0XHRcdFx0ZGF0YVt0aGlzLnZhbGlkYXRpb25FcnJvcnNLZXldID0gW107XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHNjYW5uZWRTY2hlbWFzSW5kZXggPSBkYXRhW3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV0ubGVuZ3RoO1xyXG5cdFx0XHRkYXRhW3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV1bc2Nhbm5lZFNjaGVtYXNJbmRleF0gPSBzY2hlbWE7XHJcblx0XHRcdGRhdGFbdGhpcy52YWxpZGF0aW9uRXJyb3JzS2V5XVtzY2FubmVkU2NoZW1hc0luZGV4XSA9IFtdO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0dmFyIGVycm9yQ291bnQgPSB0aGlzLmVycm9ycy5sZW5ndGg7XHJcblx0dmFyIGVycm9yID0gdGhpcy52YWxpZGF0ZUJhc2ljKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgdGhpcy52YWxpZGF0ZU51bWVyaWMoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpXHJcblx0XHR8fCB0aGlzLnZhbGlkYXRlU3RyaW5nKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgdGhpcy52YWxpZGF0ZUFycmF5KGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgdGhpcy52YWxpZGF0ZU9iamVjdChkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aClcclxuXHRcdHx8IHRoaXMudmFsaWRhdGVDb21iaW5hdGlvbnMoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpXHJcblx0XHR8fCB0aGlzLnZhbGlkYXRlSHlwZXJtZWRpYShkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aClcclxuXHRcdHx8IHRoaXMudmFsaWRhdGVGb3JtYXQoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpXHJcblx0XHR8fCB0aGlzLnZhbGlkYXRlRGVmaW5lZEtleXdvcmRzKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgbnVsbDtcclxuXHJcblx0aWYgKHRvcExldmVsKSB7XHJcblx0XHR3aGlsZSAodGhpcy5zY2FubmVkLmxlbmd0aCkge1xyXG5cdFx0XHR2YXIgaXRlbSA9IHRoaXMuc2Nhbm5lZC5wb3AoKTtcclxuXHRcdFx0ZGVsZXRlIGl0ZW1bdGhpcy52YWxpZGF0ZWRTY2hlbWFzS2V5XTtcclxuXHRcdH1cclxuXHRcdHRoaXMuc2Nhbm5lZEZyb3plbiA9IFtdO1xyXG5cdFx0dGhpcy5zY2FubmVkRnJvemVuU2NoZW1hcyA9IFtdO1xyXG5cdH1cclxuXHJcblx0aWYgKGVycm9yIHx8IGVycm9yQ291bnQgIT09IHRoaXMuZXJyb3JzLmxlbmd0aCkge1xyXG5cdFx0d2hpbGUgKChkYXRhUGF0aFBhcnRzICYmIGRhdGFQYXRoUGFydHMubGVuZ3RoKSB8fCAoc2NoZW1hUGF0aFBhcnRzICYmIHNjaGVtYVBhdGhQYXJ0cy5sZW5ndGgpKSB7XHJcblx0XHRcdHZhciBkYXRhUGFydCA9IChkYXRhUGF0aFBhcnRzICYmIGRhdGFQYXRoUGFydHMubGVuZ3RoKSA/IFwiXCIgKyBkYXRhUGF0aFBhcnRzLnBvcCgpIDogbnVsbDtcclxuXHRcdFx0dmFyIHNjaGVtYVBhcnQgPSAoc2NoZW1hUGF0aFBhcnRzICYmIHNjaGVtYVBhdGhQYXJ0cy5sZW5ndGgpID8gXCJcIiArIHNjaGVtYVBhdGhQYXJ0cy5wb3AoKSA6IG51bGw7XHJcblx0XHRcdGlmIChlcnJvcikge1xyXG5cdFx0XHRcdGVycm9yID0gZXJyb3IucHJlZml4V2l0aChkYXRhUGFydCwgc2NoZW1hUGFydCk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5wcmVmaXhFcnJvcnMoZXJyb3JDb3VudCwgZGF0YVBhcnQsIHNjaGVtYVBhcnQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aWYgKHNjYW5uZWRGcm96ZW5TY2hlbWFJbmRleCAhPT0gbnVsbCkge1xyXG5cdFx0dGhpcy5zY2FubmVkRnJvemVuVmFsaWRhdGlvbkVycm9yc1tmcm96ZW5JbmRleF1bc2Nhbm5lZEZyb3plblNjaGVtYUluZGV4XSA9IHRoaXMuZXJyb3JzLnNsaWNlKHN0YXJ0RXJyb3JDb3VudCk7XHJcblx0fSBlbHNlIGlmIChzY2FubmVkU2NoZW1hc0luZGV4ICE9PSBudWxsKSB7XHJcblx0XHRkYXRhW3RoaXMudmFsaWRhdGlvbkVycm9yc0tleV1bc2Nhbm5lZFNjaGVtYXNJbmRleF0gPSB0aGlzLmVycm9ycy5zbGljZShzdGFydEVycm9yQ291bnQpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpO1xyXG59O1xyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZUZvcm1hdCA9IGZ1bmN0aW9uIChkYXRhLCBzY2hlbWEpIHtcclxuXHRpZiAodHlwZW9mIHNjaGVtYS5mb3JtYXQgIT09ICdzdHJpbmcnIHx8ICF0aGlzLmZvcm1hdFZhbGlkYXRvcnNbc2NoZW1hLmZvcm1hdF0pIHtcclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHR2YXIgZXJyb3JNZXNzYWdlID0gdGhpcy5mb3JtYXRWYWxpZGF0b3JzW3NjaGVtYS5mb3JtYXRdLmNhbGwobnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHRpZiAodHlwZW9mIGVycm9yTWVzc2FnZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIGVycm9yTWVzc2FnZSA9PT0gJ251bWJlcicpIHtcclxuXHRcdHJldHVybiB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuRk9STUFUX0NVU1RPTSwge21lc3NhZ2U6IGVycm9yTWVzc2FnZX0sICcnLCAnL2Zvcm1hdCcsIG51bGwsIGRhdGEsIHNjaGVtYSk7XHJcblx0fSBlbHNlIGlmIChlcnJvck1lc3NhZ2UgJiYgdHlwZW9mIGVycm9yTWVzc2FnZSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdHJldHVybiB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuRk9STUFUX0NVU1RPTSwge21lc3NhZ2U6IGVycm9yTWVzc2FnZS5tZXNzYWdlIHx8IFwiP1wifSwgZXJyb3JNZXNzYWdlLmRhdGFQYXRoIHx8ICcnLCBlcnJvck1lc3NhZ2Uuc2NoZW1hUGF0aCB8fCBcIi9mb3JtYXRcIiwgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHR9XHJcblx0cmV0dXJuIG51bGw7XHJcbn07XHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlRGVmaW5lZEtleXdvcmRzID0gZnVuY3Rpb24gKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKSB7XHJcblx0Zm9yICh2YXIga2V5IGluIHRoaXMuZGVmaW5lZEtleXdvcmRzKSB7XHJcblx0XHRpZiAodHlwZW9mIHNjaGVtYVtrZXldID09PSAndW5kZWZpbmVkJykge1xyXG5cdFx0XHRjb250aW51ZTtcclxuXHRcdH1cclxuXHRcdHZhciB2YWxpZGF0aW9uRnVuY3Rpb25zID0gdGhpcy5kZWZpbmVkS2V5d29yZHNba2V5XTtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdmFsaWRhdGlvbkZ1bmN0aW9ucy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgZnVuYyA9IHZhbGlkYXRpb25GdW5jdGlvbnNbaV07XHJcblx0XHRcdHZhciByZXN1bHQgPSBmdW5jKGRhdGEsIHNjaGVtYVtrZXldLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCk7XHJcblx0XHRcdGlmICh0eXBlb2YgcmVzdWx0ID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgcmVzdWx0ID09PSAnbnVtYmVyJykge1xyXG5cdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuS0VZV09SRF9DVVNUT00sIHtrZXk6IGtleSwgbWVzc2FnZTogcmVzdWx0fSwgJycsICcnLCBudWxsLCBkYXRhLCBzY2hlbWEpLnByZWZpeFdpdGgobnVsbCwga2V5KTtcclxuXHRcdFx0fSBlbHNlIGlmIChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdCA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0XHR2YXIgY29kZSA9IHJlc3VsdC5jb2RlO1xyXG5cdFx0XHRcdGlmICh0eXBlb2YgY29kZSA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdGlmICghRXJyb3JDb2Rlc1tjb2RlXSkge1xyXG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ1VuZGVmaW5lZCBlcnJvciBjb2RlICh1c2UgZGVmaW5lRXJyb3IpOiAnICsgY29kZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRjb2RlID0gRXJyb3JDb2Rlc1tjb2RlXTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKHR5cGVvZiBjb2RlICE9PSAnbnVtYmVyJykge1xyXG5cdFx0XHRcdFx0Y29kZSA9IEVycm9yQ29kZXMuS0VZV09SRF9DVVNUT007XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBtZXNzYWdlUGFyYW1zID0gKHR5cGVvZiByZXN1bHQubWVzc2FnZSA9PT0gJ29iamVjdCcpID8gcmVzdWx0Lm1lc3NhZ2UgOiB7a2V5OiBrZXksIG1lc3NhZ2U6IHJlc3VsdC5tZXNzYWdlIHx8IFwiP1wifTtcclxuXHRcdFx0XHR2YXIgc2NoZW1hUGF0aCA9IHJlc3VsdC5zY2hlbWFQYXRoIHx8IChcIi9cIiArIGtleS5yZXBsYWNlKC9+L2csICd+MCcpLnJlcGxhY2UoL1xcLy9nLCAnfjEnKSk7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlRXJyb3IoY29kZSwgbWVzc2FnZVBhcmFtcywgcmVzdWx0LmRhdGFQYXRoIHx8IG51bGwsIHNjaGVtYVBhdGgsIG51bGwsIGRhdGEsIHNjaGVtYSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5mdW5jdGlvbiByZWN1cnNpdmVDb21wYXJlKEEsIEIpIHtcclxuXHRpZiAoQSA9PT0gQikge1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cdGlmIChBICYmIEIgJiYgdHlwZW9mIEEgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIEIgPT09IFwib2JqZWN0XCIpIHtcclxuXHRcdGlmIChBcnJheS5pc0FycmF5KEEpICE9PSBBcnJheS5pc0FycmF5KEIpKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShBKSkge1xyXG5cdFx0XHRpZiAoQS5sZW5ndGggIT09IEIubGVuZ3RoKSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgQS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGlmICghcmVjdXJzaXZlQ29tcGFyZShBW2ldLCBCW2ldKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dmFyIGtleTtcclxuXHRcdFx0Zm9yIChrZXkgaW4gQSkge1xyXG5cdFx0XHRcdGlmIChCW2tleV0gPT09IHVuZGVmaW5lZCAmJiBBW2tleV0gIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IgKGtleSBpbiBCKSB7XHJcblx0XHRcdFx0aWYgKEFba2V5XSA9PT0gdW5kZWZpbmVkICYmIEJba2V5XSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZvciAoa2V5IGluIEEpIHtcclxuXHRcdFx0XHRpZiAoIXJlY3Vyc2l2ZUNvbXBhcmUoQVtrZXldLCBCW2tleV0pKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9XHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZUJhc2ljID0gZnVuY3Rpb24gdmFsaWRhdGVCYXNpYyhkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkge1xyXG5cdHZhciBlcnJvcjtcclxuXHRpZiAoZXJyb3IgPSB0aGlzLnZhbGlkYXRlVHlwZShkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkpIHtcclxuXHRcdHJldHVybiBlcnJvci5wcmVmaXhXaXRoKG51bGwsIFwidHlwZVwiKTtcclxuXHR9XHJcblx0aWYgKGVycm9yID0gdGhpcy52YWxpZGF0ZUVudW0oZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpKSB7XHJcblx0XHRyZXR1cm4gZXJyb3IucHJlZml4V2l0aChudWxsLCBcInR5cGVcIik7XHJcblx0fVxyXG5cdHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUudmFsaWRhdGVUeXBlID0gZnVuY3Rpb24gdmFsaWRhdGVUeXBlKGRhdGEsIHNjaGVtYSkge1xyXG5cdGlmIChzY2hlbWEudHlwZSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0dmFyIGRhdGFUeXBlID0gdHlwZW9mIGRhdGE7XHJcblx0aWYgKGRhdGEgPT09IG51bGwpIHtcclxuXHRcdGRhdGFUeXBlID0gXCJudWxsXCI7XHJcblx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7XHJcblx0XHRkYXRhVHlwZSA9IFwiYXJyYXlcIjtcclxuXHR9XHJcblx0dmFyIGFsbG93ZWRUeXBlcyA9IHNjaGVtYS50eXBlO1xyXG5cdGlmICghQXJyYXkuaXNBcnJheShhbGxvd2VkVHlwZXMpKSB7XHJcblx0XHRhbGxvd2VkVHlwZXMgPSBbYWxsb3dlZFR5cGVzXTtcclxuXHR9XHJcblxyXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgYWxsb3dlZFR5cGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHR2YXIgdHlwZSA9IGFsbG93ZWRUeXBlc1tpXTtcclxuXHRcdGlmICh0eXBlID09PSBkYXRhVHlwZSB8fCAodHlwZSA9PT0gXCJpbnRlZ2VyXCIgJiYgZGF0YVR5cGUgPT09IFwibnVtYmVyXCIgJiYgKGRhdGEgJSAxID09PSAwKSkpIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuSU5WQUxJRF9UWVBFLCB7dHlwZTogZGF0YVR5cGUsIGV4cGVjdGVkOiBhbGxvd2VkVHlwZXMuam9pbihcIi9cIil9LCAnJywgJycsIG51bGwsIGRhdGEsIHNjaGVtYSk7XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZUVudW0gPSBmdW5jdGlvbiB2YWxpZGF0ZUVudW0oZGF0YSwgc2NoZW1hKSB7XHJcblx0aWYgKHNjaGVtYVtcImVudW1cIl0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgc2NoZW1hW1wiZW51bVwiXS5sZW5ndGg7IGkrKykge1xyXG5cdFx0dmFyIGVudW1WYWwgPSBzY2hlbWFbXCJlbnVtXCJdW2ldO1xyXG5cdFx0aWYgKHJlY3Vyc2l2ZUNvbXBhcmUoZGF0YSwgZW51bVZhbCkpIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuRU5VTV9NSVNNQVRDSCwge3ZhbHVlOiAodHlwZW9mIEpTT04gIT09ICd1bmRlZmluZWQnKSA/IEpTT04uc3RyaW5naWZ5KGRhdGEpIDogZGF0YX0sICcnLCAnJywgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlTnVtZXJpYyA9IGZ1bmN0aW9uIHZhbGlkYXRlTnVtZXJpYyhkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkge1xyXG5cdHJldHVybiB0aGlzLnZhbGlkYXRlTXVsdGlwbGVPZihkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aClcclxuXHRcdHx8IHRoaXMudmFsaWRhdGVNaW5NYXgoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpXHJcblx0XHR8fCB0aGlzLnZhbGlkYXRlTmFOKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgbnVsbDtcclxufTtcclxuXHJcbnZhciBDTE9TRV9FTk9VR0hfTE9XID0gTWF0aC5wb3coMiwgLTUxKTtcclxudmFyIENMT1NFX0VOT1VHSF9ISUdIID0gMSAtIENMT1NFX0VOT1VHSF9MT1c7XHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlTXVsdGlwbGVPZiA9IGZ1bmN0aW9uIHZhbGlkYXRlTXVsdGlwbGVPZihkYXRhLCBzY2hlbWEpIHtcclxuXHR2YXIgbXVsdGlwbGVPZiA9IHNjaGVtYS5tdWx0aXBsZU9mIHx8IHNjaGVtYS5kaXZpc2libGVCeTtcclxuXHRpZiAobXVsdGlwbGVPZiA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0aWYgKHR5cGVvZiBkYXRhID09PSBcIm51bWJlclwiKSB7XHJcblx0XHR2YXIgcmVtYWluZGVyID0gKGRhdGEvbXVsdGlwbGVPZiklMTtcclxuXHRcdGlmIChyZW1haW5kZXIgPj0gQ0xPU0VfRU5PVUdIX0xPVyAmJiByZW1haW5kZXIgPCBDTE9TRV9FTk9VR0hfSElHSCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihFcnJvckNvZGVzLk5VTUJFUl9NVUxUSVBMRV9PRiwge3ZhbHVlOiBkYXRhLCBtdWx0aXBsZU9mOiBtdWx0aXBsZU9mfSwgJycsICcnLCBudWxsLCBkYXRhLCBzY2hlbWEpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlTWluTWF4ID0gZnVuY3Rpb24gdmFsaWRhdGVNaW5NYXgoZGF0YSwgc2NoZW1hKSB7XHJcblx0aWYgKHR5cGVvZiBkYXRhICE9PSBcIm51bWJlclwiKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0aWYgKHNjaGVtYS5taW5pbXVtICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdGlmIChkYXRhIDwgc2NoZW1hLm1pbmltdW0pIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5OVU1CRVJfTUlOSU1VTSwge3ZhbHVlOiBkYXRhLCBtaW5pbXVtOiBzY2hlbWEubWluaW11bX0sICcnLCAnL21pbmltdW0nLCBudWxsLCBkYXRhLCBzY2hlbWEpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHNjaGVtYS5leGNsdXNpdmVNaW5pbXVtICYmIGRhdGEgPT09IHNjaGVtYS5taW5pbXVtKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuTlVNQkVSX01JTklNVU1fRVhDTFVTSVZFLCB7dmFsdWU6IGRhdGEsIG1pbmltdW06IHNjaGVtYS5taW5pbXVtfSwgJycsICcvZXhjbHVzaXZlTWluaW11bScsIG51bGwsIGRhdGEsIHNjaGVtYSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGlmIChzY2hlbWEubWF4aW11bSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRpZiAoZGF0YSA+IHNjaGVtYS5tYXhpbXVtKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuTlVNQkVSX01BWElNVU0sIHt2YWx1ZTogZGF0YSwgbWF4aW11bTogc2NoZW1hLm1heGltdW19LCAnJywgJy9tYXhpbXVtJywgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHRcdH1cclxuXHRcdGlmIChzY2hlbWEuZXhjbHVzaXZlTWF4aW11bSAmJiBkYXRhID09PSBzY2hlbWEubWF4aW11bSkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihFcnJvckNvZGVzLk5VTUJFUl9NQVhJTVVNX0VYQ0xVU0lWRSwge3ZhbHVlOiBkYXRhLCBtYXhpbXVtOiBzY2hlbWEubWF4aW11bX0sICcnLCAnL2V4Y2x1c2l2ZU1heGltdW0nLCBudWxsLCBkYXRhLCBzY2hlbWEpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlTmFOID0gZnVuY3Rpb24gdmFsaWRhdGVOYU4oZGF0YSwgc2NoZW1hKSB7XHJcblx0aWYgKHR5cGVvZiBkYXRhICE9PSBcIm51bWJlclwiKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0aWYgKGlzTmFOKGRhdGEpID09PSB0cnVlIHx8IGRhdGEgPT09IEluZmluaXR5IHx8IGRhdGEgPT09IC1JbmZpbml0eSkge1xyXG5cdFx0cmV0dXJuIHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5OVU1CRVJfTk9UX0FfTlVNQkVSLCB7dmFsdWU6IGRhdGF9LCAnJywgJy90eXBlJywgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHR9XHJcblx0cmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZVN0cmluZyA9IGZ1bmN0aW9uIHZhbGlkYXRlU3RyaW5nKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKSB7XHJcblx0cmV0dXJuIHRoaXMudmFsaWRhdGVTdHJpbmdMZW5ndGgoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpXHJcblx0XHR8fCB0aGlzLnZhbGlkYXRlU3RyaW5nUGF0dGVybihkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aClcclxuXHRcdHx8IG51bGw7XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZVN0cmluZ0xlbmd0aCA9IGZ1bmN0aW9uIHZhbGlkYXRlU3RyaW5nTGVuZ3RoKGRhdGEsIHNjaGVtYSkge1xyXG5cdGlmICh0eXBlb2YgZGF0YSAhPT0gXCJzdHJpbmdcIikge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG5cdGlmIChzY2hlbWEubWluTGVuZ3RoICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdGlmIChkYXRhLmxlbmd0aCA8IHNjaGVtYS5taW5MZW5ndGgpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5TVFJJTkdfTEVOR1RIX1NIT1JULCB7bGVuZ3RoOiBkYXRhLmxlbmd0aCwgbWluaW11bTogc2NoZW1hLm1pbkxlbmd0aH0sICcnLCAnL21pbkxlbmd0aCcsIG51bGwsIGRhdGEsIHNjaGVtYSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGlmIChzY2hlbWEubWF4TGVuZ3RoICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdGlmIChkYXRhLmxlbmd0aCA+IHNjaGVtYS5tYXhMZW5ndGgpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5TVFJJTkdfTEVOR1RIX0xPTkcsIHtsZW5ndGg6IGRhdGEubGVuZ3RoLCBtYXhpbXVtOiBzY2hlbWEubWF4TGVuZ3RofSwgJycsICcvbWF4TGVuZ3RoJywgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZVN0cmluZ1BhdHRlcm4gPSBmdW5jdGlvbiB2YWxpZGF0ZVN0cmluZ1BhdHRlcm4oZGF0YSwgc2NoZW1hKSB7XHJcblx0aWYgKHR5cGVvZiBkYXRhICE9PSBcInN0cmluZ1wiIHx8ICh0eXBlb2Ygc2NoZW1hLnBhdHRlcm4gIT09IFwic3RyaW5nXCIgJiYgIShzY2hlbWEucGF0dGVybiBpbnN0YW5jZW9mIFJlZ0V4cCkpKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0dmFyIHJlZ2V4cDtcclxuXHRpZiAoc2NoZW1hLnBhdHRlcm4gaW5zdGFuY2VvZiBSZWdFeHApIHtcclxuXHQgIHJlZ2V4cCA9IHNjaGVtYS5wYXR0ZXJuO1xyXG5cdH1cclxuXHRlbHNlIHtcclxuXHQgIHZhciBib2R5LCBmbGFncyA9ICcnO1xyXG5cdCAgLy8gQ2hlY2sgZm9yIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsc1xyXG5cdCAgLy8gQHNlZSBodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtNy44LjVcclxuXHQgIHZhciBsaXRlcmFsID0gc2NoZW1hLnBhdHRlcm4ubWF0Y2goL15cXC8oLispXFwvKFtpbWddKikkLyk7XHJcblx0ICBpZiAobGl0ZXJhbCkge1xyXG5cdCAgICBib2R5ID0gbGl0ZXJhbFsxXTtcclxuXHQgICAgZmxhZ3MgPSBsaXRlcmFsWzJdO1xyXG5cdCAgfVxyXG5cdCAgZWxzZSB7XHJcblx0ICAgIGJvZHkgPSBzY2hlbWEucGF0dGVybjtcclxuXHQgIH1cclxuXHQgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoYm9keSwgZmxhZ3MpO1xyXG5cdH1cclxuXHRpZiAoIXJlZ2V4cC50ZXN0KGRhdGEpKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihFcnJvckNvZGVzLlNUUklOR19QQVRURVJOLCB7cGF0dGVybjogc2NoZW1hLnBhdHRlcm59LCAnJywgJy9wYXR0ZXJuJywgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHR9XHJcblx0cmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZUFycmF5ID0gZnVuY3Rpb24gdmFsaWRhdGVBcnJheShkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkge1xyXG5cdGlmICghQXJyYXkuaXNBcnJheShkYXRhKSkge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG5cdHJldHVybiB0aGlzLnZhbGlkYXRlQXJyYXlMZW5ndGgoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpXHJcblx0XHR8fCB0aGlzLnZhbGlkYXRlQXJyYXlVbmlxdWVJdGVtcyhkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aClcclxuXHRcdHx8IHRoaXMudmFsaWRhdGVBcnJheUl0ZW1zKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlQXJyYXlMZW5ndGggPSBmdW5jdGlvbiB2YWxpZGF0ZUFycmF5TGVuZ3RoKGRhdGEsIHNjaGVtYSkge1xyXG5cdHZhciBlcnJvcjtcclxuXHRpZiAoc2NoZW1hLm1pbkl0ZW1zICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdGlmIChkYXRhLmxlbmd0aCA8IHNjaGVtYS5taW5JdGVtcykge1xyXG5cdFx0XHRlcnJvciA9IHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5BUlJBWV9MRU5HVEhfU0hPUlQsIHtsZW5ndGg6IGRhdGEubGVuZ3RoLCBtaW5pbXVtOiBzY2hlbWEubWluSXRlbXN9LCAnJywgJy9taW5JdGVtcycsIG51bGwsIGRhdGEsIHNjaGVtYSk7XHJcblx0XHRcdGlmICh0aGlzLmhhbmRsZUVycm9yKGVycm9yKSkge1xyXG5cdFx0XHRcdHJldHVybiBlcnJvcjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRpZiAoc2NoZW1hLm1heEl0ZW1zICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdGlmIChkYXRhLmxlbmd0aCA+IHNjaGVtYS5tYXhJdGVtcykge1xyXG5cdFx0XHRlcnJvciA9IHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5BUlJBWV9MRU5HVEhfTE9ORywge2xlbmd0aDogZGF0YS5sZW5ndGgsIG1heGltdW06IHNjaGVtYS5tYXhJdGVtc30sICcnLCAnL21heEl0ZW1zJywgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHRcdFx0aWYgKHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpKSB7XHJcblx0XHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUudmFsaWRhdGVBcnJheVVuaXF1ZUl0ZW1zID0gZnVuY3Rpb24gdmFsaWRhdGVBcnJheVVuaXF1ZUl0ZW1zKGRhdGEsIHNjaGVtYSkge1xyXG5cdGlmIChzY2hlbWEudW5pcXVlSXRlbXMpIHtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRmb3IgKHZhciBqID0gaSArIDE7IGogPCBkYXRhLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0aWYgKHJlY3Vyc2l2ZUNvbXBhcmUoZGF0YVtpXSwgZGF0YVtqXSkpIHtcclxuXHRcdFx0XHRcdHZhciBlcnJvciA9IHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5BUlJBWV9VTklRVUUsIHttYXRjaDE6IGksIG1hdGNoMjogan0sICcnLCAnL3VuaXF1ZUl0ZW1zJywgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHRcdFx0XHRcdGlmICh0aGlzLmhhbmRsZUVycm9yKGVycm9yKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZXJyb3I7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUudmFsaWRhdGVBcnJheUl0ZW1zID0gZnVuY3Rpb24gdmFsaWRhdGVBcnJheUl0ZW1zKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKSB7XHJcblx0aWYgKHNjaGVtYS5pdGVtcyA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0dmFyIGVycm9yLCBpO1xyXG5cdGlmIChBcnJheS5pc0FycmF5KHNjaGVtYS5pdGVtcykpIHtcclxuXHRcdGZvciAoaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGlmIChpIDwgc2NoZW1hLml0ZW1zLmxlbmd0aCkge1xyXG5cdFx0XHRcdGlmIChlcnJvciA9IHRoaXMudmFsaWRhdGVBbGwoZGF0YVtpXSwgc2NoZW1hLml0ZW1zW2ldLCBbaV0sIFtcIml0ZW1zXCIsIGldLCBkYXRhUG9pbnRlclBhdGggKyBcIi9cIiArIGkpKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZXJyb3I7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2UgaWYgKHNjaGVtYS5hZGRpdGlvbmFsSXRlbXMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdGlmICh0eXBlb2Ygc2NoZW1hLmFkZGl0aW9uYWxJdGVtcyA9PT0gXCJib29sZWFuXCIpIHtcclxuXHRcdFx0XHRcdGlmICghc2NoZW1hLmFkZGl0aW9uYWxJdGVtcykge1xyXG5cdFx0XHRcdFx0XHRlcnJvciA9ICh0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuQVJSQVlfQURESVRJT05BTF9JVEVNUywge30sICcvJyArIGksICcvYWRkaXRpb25hbEl0ZW1zJywgbnVsbCwgZGF0YSwgc2NoZW1hKSk7XHJcblx0XHRcdFx0XHRcdGlmICh0aGlzLmhhbmRsZUVycm9yKGVycm9yKSkge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBlcnJvcjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSBpZiAoZXJyb3IgPSB0aGlzLnZhbGlkYXRlQWxsKGRhdGFbaV0sIHNjaGVtYS5hZGRpdGlvbmFsSXRlbXMsIFtpXSwgW1wiYWRkaXRpb25hbEl0ZW1zXCJdLCBkYXRhUG9pbnRlclBhdGggKyBcIi9cIiArIGkpKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZXJyb3I7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSBlbHNlIHtcclxuXHRcdGZvciAoaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGlmIChlcnJvciA9IHRoaXMudmFsaWRhdGVBbGwoZGF0YVtpXSwgc2NoZW1hLml0ZW1zLCBbaV0sIFtcIml0ZW1zXCJdLCBkYXRhUG9pbnRlclBhdGggKyBcIi9cIiArIGkpKSB7XHJcblx0XHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUudmFsaWRhdGVPYmplY3QgPSBmdW5jdGlvbiB2YWxpZGF0ZU9iamVjdChkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkge1xyXG5cdGlmICh0eXBlb2YgZGF0YSAhPT0gXCJvYmplY3RcIiB8fCBkYXRhID09PSBudWxsIHx8IEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHRyZXR1cm4gdGhpcy52YWxpZGF0ZU9iamVjdE1pbk1heFByb3BlcnRpZXMoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpXHJcblx0XHR8fCB0aGlzLnZhbGlkYXRlT2JqZWN0UmVxdWlyZWRQcm9wZXJ0aWVzKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgdGhpcy52YWxpZGF0ZU9iamVjdFByb3BlcnRpZXMoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpXHJcblx0XHR8fCB0aGlzLnZhbGlkYXRlT2JqZWN0RGVwZW5kZW5jaWVzKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlT2JqZWN0TWluTWF4UHJvcGVydGllcyA9IGZ1bmN0aW9uIHZhbGlkYXRlT2JqZWN0TWluTWF4UHJvcGVydGllcyhkYXRhLCBzY2hlbWEpIHtcclxuXHR2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRhdGEpO1xyXG5cdHZhciBlcnJvcjtcclxuXHRpZiAoc2NoZW1hLm1pblByb3BlcnRpZXMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0aWYgKGtleXMubGVuZ3RoIDwgc2NoZW1hLm1pblByb3BlcnRpZXMpIHtcclxuXHRcdFx0ZXJyb3IgPSB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuT0JKRUNUX1BST1BFUlRJRVNfTUlOSU1VTSwge3Byb3BlcnR5Q291bnQ6IGtleXMubGVuZ3RoLCBtaW5pbXVtOiBzY2hlbWEubWluUHJvcGVydGllc30sICcnLCAnL21pblByb3BlcnRpZXMnLCBudWxsLCBkYXRhLCBzY2hlbWEpO1xyXG5cdFx0XHRpZiAodGhpcy5oYW5kbGVFcnJvcihlcnJvcikpIHtcclxuXHRcdFx0XHRyZXR1cm4gZXJyb3I7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0aWYgKHNjaGVtYS5tYXhQcm9wZXJ0aWVzICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdGlmIChrZXlzLmxlbmd0aCA+IHNjaGVtYS5tYXhQcm9wZXJ0aWVzKSB7XHJcblx0XHRcdGVycm9yID0gdGhpcy5jcmVhdGVFcnJvcihFcnJvckNvZGVzLk9CSkVDVF9QUk9QRVJUSUVTX01BWElNVU0sIHtwcm9wZXJ0eUNvdW50OiBrZXlzLmxlbmd0aCwgbWF4aW11bTogc2NoZW1hLm1heFByb3BlcnRpZXN9LCAnJywgJy9tYXhQcm9wZXJ0aWVzJywgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHRcdFx0aWYgKHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpKSB7XHJcblx0XHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuVmFsaWRhdG9yQ29udGV4dC5wcm90b3R5cGUudmFsaWRhdGVPYmplY3RSZXF1aXJlZFByb3BlcnRpZXMgPSBmdW5jdGlvbiB2YWxpZGF0ZU9iamVjdFJlcXVpcmVkUHJvcGVydGllcyhkYXRhLCBzY2hlbWEpIHtcclxuXHRpZiAoc2NoZW1hLnJlcXVpcmVkICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc2NoZW1hLnJlcXVpcmVkLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBrZXkgPSBzY2hlbWEucmVxdWlyZWRbaV07XHJcblx0XHRcdGlmIChkYXRhW2tleV0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdHZhciBlcnJvciA9IHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5PQkpFQ1RfUkVRVUlSRUQsIHtrZXk6IGtleX0sICcnLCAnL3JlcXVpcmVkLycgKyBpLCBudWxsLCBkYXRhLCBzY2hlbWEpO1xyXG5cdFx0XHRcdGlmICh0aGlzLmhhbmRsZUVycm9yKGVycm9yKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlT2JqZWN0UHJvcGVydGllcyA9IGZ1bmN0aW9uIHZhbGlkYXRlT2JqZWN0UHJvcGVydGllcyhkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkge1xyXG5cdHZhciBlcnJvcjtcclxuXHRmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xyXG5cdFx0dmFyIGtleVBvaW50ZXJQYXRoID0gZGF0YVBvaW50ZXJQYXRoICsgXCIvXCIgKyBrZXkucmVwbGFjZSgvfi9nLCAnfjAnKS5yZXBsYWNlKC9cXC8vZywgJ34xJyk7XHJcblx0XHR2YXIgZm91bmRNYXRjaCA9IGZhbHNlO1xyXG5cdFx0aWYgKHNjaGVtYS5wcm9wZXJ0aWVzICE9PSB1bmRlZmluZWQgJiYgc2NoZW1hLnByb3BlcnRpZXNba2V5XSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdGZvdW5kTWF0Y2ggPSB0cnVlO1xyXG5cdFx0XHRpZiAoZXJyb3IgPSB0aGlzLnZhbGlkYXRlQWxsKGRhdGFba2V5XSwgc2NoZW1hLnByb3BlcnRpZXNba2V5XSwgW2tleV0sIFtcInByb3BlcnRpZXNcIiwga2V5XSwga2V5UG9pbnRlclBhdGgpKSB7XHJcblx0XHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoc2NoZW1hLnBhdHRlcm5Qcm9wZXJ0aWVzICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0Zm9yICh2YXIgcGF0dGVybktleSBpbiBzY2hlbWEucGF0dGVyblByb3BlcnRpZXMpIHtcclxuXHRcdFx0XHR2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cChwYXR0ZXJuS2V5KTtcclxuXHRcdFx0XHRpZiAocmVnZXhwLnRlc3Qoa2V5KSkge1xyXG5cdFx0XHRcdFx0Zm91bmRNYXRjaCA9IHRydWU7XHJcblx0XHRcdFx0XHRpZiAoZXJyb3IgPSB0aGlzLnZhbGlkYXRlQWxsKGRhdGFba2V5XSwgc2NoZW1hLnBhdHRlcm5Qcm9wZXJ0aWVzW3BhdHRlcm5LZXldLCBba2V5XSwgW1wicGF0dGVyblByb3BlcnRpZXNcIiwgcGF0dGVybktleV0sIGtleVBvaW50ZXJQYXRoKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZXJyb3I7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoIWZvdW5kTWF0Y2gpIHtcclxuXHRcdFx0aWYgKHNjaGVtYS5hZGRpdGlvbmFsUHJvcGVydGllcyAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0aWYgKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcykge1xyXG5cdFx0XHRcdFx0dGhpcy5rbm93blByb3BlcnR5UGF0aHNba2V5UG9pbnRlclBhdGhdID0gdHJ1ZTtcclxuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzW2tleVBvaW50ZXJQYXRoXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHR5cGVvZiBzY2hlbWEuYWRkaXRpb25hbFByb3BlcnRpZXMgPT09IFwiYm9vbGVhblwiKSB7XHJcblx0XHRcdFx0XHRpZiAoIXNjaGVtYS5hZGRpdGlvbmFsUHJvcGVydGllcykge1xyXG5cdFx0XHRcdFx0XHRlcnJvciA9IHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5PQkpFQ1RfQURESVRJT05BTF9QUk9QRVJUSUVTLCB7a2V5OiBrZXl9LCAnJywgJy9hZGRpdGlvbmFsUHJvcGVydGllcycsIG51bGwsIGRhdGEsIHNjaGVtYSkucHJlZml4V2l0aChrZXksIG51bGwpO1xyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5oYW5kbGVFcnJvcihlcnJvcikpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZXJyb3I7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYgKGVycm9yID0gdGhpcy52YWxpZGF0ZUFsbChkYXRhW2tleV0sIHNjaGVtYS5hZGRpdGlvbmFsUHJvcGVydGllcywgW2tleV0sIFtcImFkZGl0aW9uYWxQcm9wZXJ0aWVzXCJdLCBrZXlQb2ludGVyUGF0aCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIGlmICh0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMgJiYgIXRoaXMua25vd25Qcm9wZXJ0eVBhdGhzW2tleVBvaW50ZXJQYXRoXSkge1xyXG5cdFx0XHRcdHRoaXMudW5rbm93blByb3BlcnR5UGF0aHNba2V5UG9pbnRlclBhdGhdID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmICh0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMpIHtcclxuXHRcdFx0dGhpcy5rbm93blByb3BlcnR5UGF0aHNba2V5UG9pbnRlclBhdGhdID0gdHJ1ZTtcclxuXHRcdFx0ZGVsZXRlIHRoaXMudW5rbm93blByb3BlcnR5UGF0aHNba2V5UG9pbnRlclBhdGhdO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlT2JqZWN0RGVwZW5kZW5jaWVzID0gZnVuY3Rpb24gdmFsaWRhdGVPYmplY3REZXBlbmRlbmNpZXMoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpIHtcclxuXHR2YXIgZXJyb3I7XHJcblx0aWYgKHNjaGVtYS5kZXBlbmRlbmNpZXMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0Zm9yICh2YXIgZGVwS2V5IGluIHNjaGVtYS5kZXBlbmRlbmNpZXMpIHtcclxuXHRcdFx0aWYgKGRhdGFbZGVwS2V5XSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0dmFyIGRlcCA9IHNjaGVtYS5kZXBlbmRlbmNpZXNbZGVwS2V5XTtcclxuXHRcdFx0XHRpZiAodHlwZW9mIGRlcCA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHRcdFx0aWYgKGRhdGFbZGVwXSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdGVycm9yID0gdGhpcy5jcmVhdGVFcnJvcihFcnJvckNvZGVzLk9CSkVDVF9ERVBFTkRFTkNZX0tFWSwge2tleTogZGVwS2V5LCBtaXNzaW5nOiBkZXB9LCAnJywgJycsIG51bGwsIGRhdGEsIHNjaGVtYSkucHJlZml4V2l0aChudWxsLCBkZXBLZXkpLnByZWZpeFdpdGgobnVsbCwgXCJkZXBlbmRlbmNpZXNcIik7XHJcblx0XHRcdFx0XHRcdGlmICh0aGlzLmhhbmRsZUVycm9yKGVycm9yKSkge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBlcnJvcjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkZXApKSB7XHJcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRlcC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0XHR2YXIgcmVxdWlyZWRLZXkgPSBkZXBbaV07XHJcblx0XHRcdFx0XHRcdGlmIChkYXRhW3JlcXVpcmVkS2V5XSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRcdFx0ZXJyb3IgPSB0aGlzLmNyZWF0ZUVycm9yKEVycm9yQ29kZXMuT0JKRUNUX0RFUEVOREVOQ1lfS0VZLCB7a2V5OiBkZXBLZXksIG1pc3Npbmc6IHJlcXVpcmVkS2V5fSwgJycsICcvJyArIGksIG51bGwsIGRhdGEsIHNjaGVtYSkucHJlZml4V2l0aChudWxsLCBkZXBLZXkpLnByZWZpeFdpdGgobnVsbCwgXCJkZXBlbmRlbmNpZXNcIik7XHJcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZXJyb3I7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGlmIChlcnJvciA9IHRoaXMudmFsaWRhdGVBbGwoZGF0YSwgZGVwLCBbXSwgW1wiZGVwZW5kZW5jaWVzXCIsIGRlcEtleV0sIGRhdGFQb2ludGVyUGF0aCkpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlQ29tYmluYXRpb25zID0gZnVuY3Rpb24gdmFsaWRhdGVDb21iaW5hdGlvbnMoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpIHtcclxuXHRyZXR1cm4gdGhpcy52YWxpZGF0ZUFsbE9mKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgdGhpcy52YWxpZGF0ZUFueU9mKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgdGhpcy52YWxpZGF0ZU9uZU9mKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKVxyXG5cdFx0fHwgdGhpcy52YWxpZGF0ZU5vdChkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aClcclxuXHRcdHx8IG51bGw7XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZUFsbE9mID0gZnVuY3Rpb24gdmFsaWRhdGVBbGxPZihkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkge1xyXG5cdGlmIChzY2hlbWEuYWxsT2YgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG5cdHZhciBlcnJvcjtcclxuXHRmb3IgKHZhciBpID0gMDsgaSA8IHNjaGVtYS5hbGxPZi5sZW5ndGg7IGkrKykge1xyXG5cdFx0dmFyIHN1YlNjaGVtYSA9IHNjaGVtYS5hbGxPZltpXTtcclxuXHRcdGlmIChlcnJvciA9IHRoaXMudmFsaWRhdGVBbGwoZGF0YSwgc3ViU2NoZW1hLCBbXSwgW1wiYWxsT2ZcIiwgaV0sIGRhdGFQb2ludGVyUGF0aCkpIHtcclxuXHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlQW55T2YgPSBmdW5jdGlvbiB2YWxpZGF0ZUFueU9mKGRhdGEsIHNjaGVtYSwgZGF0YVBvaW50ZXJQYXRoKSB7XHJcblx0aWYgKHNjaGVtYS5hbnlPZiA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0dmFyIGVycm9ycyA9IFtdO1xyXG5cdHZhciBzdGFydEVycm9yQ291bnQgPSB0aGlzLmVycm9ycy5sZW5ndGg7XHJcblx0dmFyIG9sZFVua25vd25Qcm9wZXJ0eVBhdGhzLCBvbGRLbm93blByb3BlcnR5UGF0aHM7XHJcblx0aWYgKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcykge1xyXG5cdFx0b2xkVW5rbm93blByb3BlcnR5UGF0aHMgPSB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzO1xyXG5cdFx0b2xkS25vd25Qcm9wZXJ0eVBhdGhzID0gdGhpcy5rbm93blByb3BlcnR5UGF0aHM7XHJcblx0fVxyXG5cdHZhciBlcnJvckF0RW5kID0gdHJ1ZTtcclxuXHRmb3IgKHZhciBpID0gMDsgaSA8IHNjaGVtYS5hbnlPZi5sZW5ndGg7IGkrKykge1xyXG5cdFx0aWYgKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcykge1xyXG5cdFx0XHR0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzID0ge307XHJcblx0XHRcdHRoaXMua25vd25Qcm9wZXJ0eVBhdGhzID0ge307XHJcblx0XHR9XHJcblx0XHR2YXIgc3ViU2NoZW1hID0gc2NoZW1hLmFueU9mW2ldO1xyXG5cclxuXHRcdHZhciBlcnJvckNvdW50ID0gdGhpcy5lcnJvcnMubGVuZ3RoO1xyXG5cdFx0dmFyIGVycm9yID0gdGhpcy52YWxpZGF0ZUFsbChkYXRhLCBzdWJTY2hlbWEsIFtdLCBbXCJhbnlPZlwiLCBpXSwgZGF0YVBvaW50ZXJQYXRoKTtcclxuXHJcblx0XHRpZiAoZXJyb3IgPT09IG51bGwgJiYgZXJyb3JDb3VudCA9PT0gdGhpcy5lcnJvcnMubGVuZ3RoKSB7XHJcblx0XHRcdHRoaXMuZXJyb3JzID0gdGhpcy5lcnJvcnMuc2xpY2UoMCwgc3RhcnRFcnJvckNvdW50KTtcclxuXHJcblx0XHRcdGlmICh0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMpIHtcclxuXHRcdFx0XHRmb3IgKHZhciBrbm93bktleSBpbiB0aGlzLmtub3duUHJvcGVydHlQYXRocykge1xyXG5cdFx0XHRcdFx0b2xkS25vd25Qcm9wZXJ0eVBhdGhzW2tub3duS2V5XSA9IHRydWU7XHJcblx0XHRcdFx0XHRkZWxldGUgb2xkVW5rbm93blByb3BlcnR5UGF0aHNba25vd25LZXldO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRmb3IgKHZhciB1bmtub3duS2V5IGluIHRoaXMudW5rbm93blByb3BlcnR5UGF0aHMpIHtcclxuXHRcdFx0XHRcdGlmICghb2xkS25vd25Qcm9wZXJ0eVBhdGhzW3Vua25vd25LZXldKSB7XHJcblx0XHRcdFx0XHRcdG9sZFVua25vd25Qcm9wZXJ0eVBhdGhzW3Vua25vd25LZXldID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gV2UgbmVlZCB0byBjb250aW51ZSBsb29waW5nIHNvIHdlIGNhdGNoIGFsbCB0aGUgcHJvcGVydHkgZGVmaW5pdGlvbnMsIGJ1dCB3ZSBkb24ndCB3YW50IHRvIHJldHVybiBhbiBlcnJvclxyXG5cdFx0XHRcdGVycm9yQXRFbmQgPSBmYWxzZTtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0ZXJyb3JzLnB1c2goZXJyb3IucHJlZml4V2l0aChudWxsLCBcIlwiICsgaSkucHJlZml4V2l0aChudWxsLCBcImFueU9mXCIpKTtcclxuXHRcdH1cclxuXHR9XHJcblx0aWYgKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcykge1xyXG5cdFx0dGhpcy51bmtub3duUHJvcGVydHlQYXRocyA9IG9sZFVua25vd25Qcm9wZXJ0eVBhdGhzO1xyXG5cdFx0dGhpcy5rbm93blByb3BlcnR5UGF0aHMgPSBvbGRLbm93blByb3BlcnR5UGF0aHM7XHJcblx0fVxyXG5cdGlmIChlcnJvckF0RW5kKSB7XHJcblx0XHRlcnJvcnMgPSBlcnJvcnMuY29uY2F0KHRoaXMuZXJyb3JzLnNsaWNlKHN0YXJ0RXJyb3JDb3VudCkpO1xyXG5cdFx0dGhpcy5lcnJvcnMgPSB0aGlzLmVycm9ycy5zbGljZSgwLCBzdGFydEVycm9yQ291bnQpO1xyXG5cdFx0cmV0dXJuIHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5BTllfT0ZfTUlTU0lORywge30sIFwiXCIsIFwiL2FueU9mXCIsIGVycm9ycywgZGF0YSwgc2NoZW1hKTtcclxuXHR9XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZU9uZU9mID0gZnVuY3Rpb24gdmFsaWRhdGVPbmVPZihkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkge1xyXG5cdGlmIChzY2hlbWEub25lT2YgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG5cdHZhciB2YWxpZEluZGV4ID0gbnVsbDtcclxuXHR2YXIgZXJyb3JzID0gW107XHJcblx0dmFyIHN0YXJ0RXJyb3JDb3VudCA9IHRoaXMuZXJyb3JzLmxlbmd0aDtcclxuXHR2YXIgb2xkVW5rbm93blByb3BlcnR5UGF0aHMsIG9sZEtub3duUHJvcGVydHlQYXRocztcclxuXHRpZiAodGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzKSB7XHJcblx0XHRvbGRVbmtub3duUHJvcGVydHlQYXRocyA9IHRoaXMudW5rbm93blByb3BlcnR5UGF0aHM7XHJcblx0XHRvbGRLbm93blByb3BlcnR5UGF0aHMgPSB0aGlzLmtub3duUHJvcGVydHlQYXRocztcclxuXHR9XHJcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzY2hlbWEub25lT2YubGVuZ3RoOyBpKyspIHtcclxuXHRcdGlmICh0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMpIHtcclxuXHRcdFx0dGhpcy51bmtub3duUHJvcGVydHlQYXRocyA9IHt9O1xyXG5cdFx0XHR0aGlzLmtub3duUHJvcGVydHlQYXRocyA9IHt9O1xyXG5cdFx0fVxyXG5cdFx0dmFyIHN1YlNjaGVtYSA9IHNjaGVtYS5vbmVPZltpXTtcclxuXHJcblx0XHR2YXIgZXJyb3JDb3VudCA9IHRoaXMuZXJyb3JzLmxlbmd0aDtcclxuXHRcdHZhciBlcnJvciA9IHRoaXMudmFsaWRhdGVBbGwoZGF0YSwgc3ViU2NoZW1hLCBbXSwgW1wib25lT2ZcIiwgaV0sIGRhdGFQb2ludGVyUGF0aCk7XHJcblxyXG5cdFx0aWYgKGVycm9yID09PSBudWxsICYmIGVycm9yQ291bnQgPT09IHRoaXMuZXJyb3JzLmxlbmd0aCkge1xyXG5cdFx0XHRpZiAodmFsaWRJbmRleCA9PT0gbnVsbCkge1xyXG5cdFx0XHRcdHZhbGlkSW5kZXggPSBpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuZXJyb3JzID0gdGhpcy5lcnJvcnMuc2xpY2UoMCwgc3RhcnRFcnJvckNvdW50KTtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihFcnJvckNvZGVzLk9ORV9PRl9NVUxUSVBMRSwge2luZGV4MTogdmFsaWRJbmRleCwgaW5kZXgyOiBpfSwgXCJcIiwgXCIvb25lT2ZcIiwgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAodGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0Zm9yICh2YXIga25vd25LZXkgaW4gdGhpcy5rbm93blByb3BlcnR5UGF0aHMpIHtcclxuXHRcdFx0XHRcdG9sZEtub3duUHJvcGVydHlQYXRoc1trbm93bktleV0gPSB0cnVlO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIG9sZFVua25vd25Qcm9wZXJ0eVBhdGhzW2tub3duS2V5XTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Zm9yICh2YXIgdW5rbm93bktleSBpbiB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzKSB7XHJcblx0XHRcdFx0XHRpZiAoIW9sZEtub3duUHJvcGVydHlQYXRoc1t1bmtub3duS2V5XSkge1xyXG5cdFx0XHRcdFx0XHRvbGRVbmtub3duUHJvcGVydHlQYXRoc1t1bmtub3duS2V5XSA9IHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKGVycm9yKSB7XHJcblx0XHRcdGVycm9ycy5wdXNoKGVycm9yKTtcclxuXHRcdH1cclxuXHR9XHJcblx0aWYgKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcykge1xyXG5cdFx0dGhpcy51bmtub3duUHJvcGVydHlQYXRocyA9IG9sZFVua25vd25Qcm9wZXJ0eVBhdGhzO1xyXG5cdFx0dGhpcy5rbm93blByb3BlcnR5UGF0aHMgPSBvbGRLbm93blByb3BlcnR5UGF0aHM7XHJcblx0fVxyXG5cdGlmICh2YWxpZEluZGV4ID09PSBudWxsKSB7XHJcblx0XHRlcnJvcnMgPSBlcnJvcnMuY29uY2F0KHRoaXMuZXJyb3JzLnNsaWNlKHN0YXJ0RXJyb3JDb3VudCkpO1xyXG5cdFx0dGhpcy5lcnJvcnMgPSB0aGlzLmVycm9ycy5zbGljZSgwLCBzdGFydEVycm9yQ291bnQpO1xyXG5cdFx0cmV0dXJuIHRoaXMuY3JlYXRlRXJyb3IoRXJyb3JDb2Rlcy5PTkVfT0ZfTUlTU0lORywge30sIFwiXCIsIFwiL29uZU9mXCIsIGVycm9ycywgZGF0YSwgc2NoZW1hKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dGhpcy5lcnJvcnMgPSB0aGlzLmVycm9ycy5zbGljZSgwLCBzdGFydEVycm9yQ291bnQpO1xyXG5cdH1cclxuXHRyZXR1cm4gbnVsbDtcclxufTtcclxuXHJcblZhbGlkYXRvckNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlTm90ID0gZnVuY3Rpb24gdmFsaWRhdGVOb3QoZGF0YSwgc2NoZW1hLCBkYXRhUG9pbnRlclBhdGgpIHtcclxuXHRpZiAoc2NoZW1hLm5vdCA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0dmFyIG9sZEVycm9yQ291bnQgPSB0aGlzLmVycm9ycy5sZW5ndGg7XHJcblx0dmFyIG9sZFVua25vd25Qcm9wZXJ0eVBhdGhzLCBvbGRLbm93blByb3BlcnR5UGF0aHM7XHJcblx0aWYgKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcykge1xyXG5cdFx0b2xkVW5rbm93blByb3BlcnR5UGF0aHMgPSB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzO1xyXG5cdFx0b2xkS25vd25Qcm9wZXJ0eVBhdGhzID0gdGhpcy5rbm93blByb3BlcnR5UGF0aHM7XHJcblx0XHR0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzID0ge307XHJcblx0XHR0aGlzLmtub3duUHJvcGVydHlQYXRocyA9IHt9O1xyXG5cdH1cclxuXHR2YXIgZXJyb3IgPSB0aGlzLnZhbGlkYXRlQWxsKGRhdGEsIHNjaGVtYS5ub3QsIG51bGwsIG51bGwsIGRhdGFQb2ludGVyUGF0aCk7XHJcblx0dmFyIG5vdEVycm9ycyA9IHRoaXMuZXJyb3JzLnNsaWNlKG9sZEVycm9yQ291bnQpO1xyXG5cdHRoaXMuZXJyb3JzID0gdGhpcy5lcnJvcnMuc2xpY2UoMCwgb2xkRXJyb3JDb3VudCk7XHJcblx0aWYgKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcykge1xyXG5cdFx0dGhpcy51bmtub3duUHJvcGVydHlQYXRocyA9IG9sZFVua25vd25Qcm9wZXJ0eVBhdGhzO1xyXG5cdFx0dGhpcy5rbm93blByb3BlcnR5UGF0aHMgPSBvbGRLbm93blByb3BlcnR5UGF0aHM7XHJcblx0fVxyXG5cdGlmIChlcnJvciA9PT0gbnVsbCAmJiBub3RFcnJvcnMubGVuZ3RoID09PSAwKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihFcnJvckNvZGVzLk5PVF9QQVNTRUQsIHt9LCBcIlwiLCBcIi9ub3RcIiwgbnVsbCwgZGF0YSwgc2NoZW1hKTtcclxuXHR9XHJcblx0cmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5WYWxpZGF0b3JDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZUh5cGVybWVkaWEgPSBmdW5jdGlvbiB2YWxpZGF0ZUNvbWJpbmF0aW9ucyhkYXRhLCBzY2hlbWEsIGRhdGFQb2ludGVyUGF0aCkge1xyXG5cdGlmICghc2NoZW1hLmxpbmtzKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0dmFyIGVycm9yO1xyXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgc2NoZW1hLmxpbmtzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHR2YXIgbGRvID0gc2NoZW1hLmxpbmtzW2ldO1xyXG5cdFx0aWYgKGxkby5yZWwgPT09IFwiZGVzY3JpYmVkYnlcIikge1xyXG5cdFx0XHR2YXIgdGVtcGxhdGUgPSBuZXcgVXJpVGVtcGxhdGUobGRvLmhyZWYpO1xyXG5cdFx0XHR2YXIgYWxsUHJlc2VudCA9IHRydWU7XHJcblx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgdGVtcGxhdGUudmFyTmFtZXMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRpZiAoISh0ZW1wbGF0ZS52YXJOYW1lc1tqXSBpbiBkYXRhKSkge1xyXG5cdFx0XHRcdFx0YWxsUHJlc2VudCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChhbGxQcmVzZW50KSB7XHJcblx0XHRcdFx0dmFyIHNjaGVtYVVybCA9IHRlbXBsYXRlLmZpbGxGcm9tT2JqZWN0KGRhdGEpO1xyXG5cdFx0XHRcdHZhciBzdWJTY2hlbWEgPSB7XCIkcmVmXCI6IHNjaGVtYVVybH07XHJcblx0XHRcdFx0aWYgKGVycm9yID0gdGhpcy52YWxpZGF0ZUFsbChkYXRhLCBzdWJTY2hlbWEsIFtdLCBbXCJsaW5rc1wiLCBpXSwgZGF0YVBvaW50ZXJQYXRoKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGVycm9yO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbi8vIHBhcnNlVVJJKCkgYW5kIHJlc29sdmVVcmwoKSBhcmUgZnJvbSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS8xMDg4ODUwXHJcbi8vICAgLSAgcmVsZWFzZWQgYXMgcHVibGljIGRvbWFpbiBieSBhdXRob3IgKFwiWWFmZmxlXCIpIC0gc2VlIGNvbW1lbnRzIG9uIGdpc3RcclxuXHJcbmZ1bmN0aW9uIHBhcnNlVVJJKHVybCkge1xyXG5cdHZhciBtID0gU3RyaW5nKHVybCkucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpLm1hdGNoKC9eKFteOlxcLz8jXSs6KT8oXFwvXFwvKD86W146QF0qKD86OlteOkBdKik/QCk/KChbXjpcXC8/I10qKSg/OjooXFxkKikpPykpPyhbXj8jXSopKFxcP1teI10qKT8oI1tcXHNcXFNdKik/Lyk7XHJcblx0Ly8gYXV0aG9yaXR5ID0gJy8vJyArIHVzZXIgKyAnOicgKyBwYXNzICdAJyArIGhvc3RuYW1lICsgJzonIHBvcnRcclxuXHRyZXR1cm4gKG0gPyB7XHJcblx0XHRocmVmICAgICA6IG1bMF0gfHwgJycsXHJcblx0XHRwcm90b2NvbCA6IG1bMV0gfHwgJycsXHJcblx0XHRhdXRob3JpdHk6IG1bMl0gfHwgJycsXHJcblx0XHRob3N0ICAgICA6IG1bM10gfHwgJycsXHJcblx0XHRob3N0bmFtZSA6IG1bNF0gfHwgJycsXHJcblx0XHRwb3J0ICAgICA6IG1bNV0gfHwgJycsXHJcblx0XHRwYXRobmFtZSA6IG1bNl0gfHwgJycsXHJcblx0XHRzZWFyY2ggICA6IG1bN10gfHwgJycsXHJcblx0XHRoYXNoICAgICA6IG1bOF0gfHwgJydcclxuXHR9IDogbnVsbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc29sdmVVcmwoYmFzZSwgaHJlZikgey8vIFJGQyAzOTg2XHJcblxyXG5cdGZ1bmN0aW9uIHJlbW92ZURvdFNlZ21lbnRzKGlucHV0KSB7XHJcblx0XHR2YXIgb3V0cHV0ID0gW107XHJcblx0XHRpbnB1dC5yZXBsYWNlKC9eKFxcLlxcLj8oXFwvfCQpKSsvLCAnJylcclxuXHRcdFx0LnJlcGxhY2UoL1xcLyhcXC4oXFwvfCQpKSsvZywgJy8nKVxyXG5cdFx0XHQucmVwbGFjZSgvXFwvXFwuXFwuJC8sICcvLi4vJylcclxuXHRcdFx0LnJlcGxhY2UoL1xcLz9bXlxcL10qL2csIGZ1bmN0aW9uIChwKSB7XHJcblx0XHRcdFx0aWYgKHAgPT09ICcvLi4nKSB7XHJcblx0XHRcdFx0XHRvdXRwdXQucG9wKCk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdG91dHB1dC5wdXNoKHApO1xyXG5cdFx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIG91dHB1dC5qb2luKCcnKS5yZXBsYWNlKC9eXFwvLywgaW5wdXQuY2hhckF0KDApID09PSAnLycgPyAnLycgOiAnJyk7XHJcblx0fVxyXG5cclxuXHRocmVmID0gcGFyc2VVUkkoaHJlZiB8fCAnJyk7XHJcblx0YmFzZSA9IHBhcnNlVVJJKGJhc2UgfHwgJycpO1xyXG5cclxuXHRyZXR1cm4gIWhyZWYgfHwgIWJhc2UgPyBudWxsIDogKGhyZWYucHJvdG9jb2wgfHwgYmFzZS5wcm90b2NvbCkgK1xyXG5cdFx0KGhyZWYucHJvdG9jb2wgfHwgaHJlZi5hdXRob3JpdHkgPyBocmVmLmF1dGhvcml0eSA6IGJhc2UuYXV0aG9yaXR5KSArXHJcblx0XHRyZW1vdmVEb3RTZWdtZW50cyhocmVmLnByb3RvY29sIHx8IGhyZWYuYXV0aG9yaXR5IHx8IGhyZWYucGF0aG5hbWUuY2hhckF0KDApID09PSAnLycgPyBocmVmLnBhdGhuYW1lIDogKGhyZWYucGF0aG5hbWUgPyAoKGJhc2UuYXV0aG9yaXR5ICYmICFiYXNlLnBhdGhuYW1lID8gJy8nIDogJycpICsgYmFzZS5wYXRobmFtZS5zbGljZSgwLCBiYXNlLnBhdGhuYW1lLmxhc3RJbmRleE9mKCcvJykgKyAxKSArIGhyZWYucGF0aG5hbWUpIDogYmFzZS5wYXRobmFtZSkpICtcclxuXHRcdChocmVmLnByb3RvY29sIHx8IGhyZWYuYXV0aG9yaXR5IHx8IGhyZWYucGF0aG5hbWUgPyBocmVmLnNlYXJjaCA6IChocmVmLnNlYXJjaCB8fCBiYXNlLnNlYXJjaCkpICtcclxuXHRcdGhyZWYuaGFzaDtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0RG9jdW1lbnRVcmkodXJpKSB7XHJcblx0cmV0dXJuIHVyaS5zcGxpdCgnIycpWzBdO1xyXG59XHJcbmZ1bmN0aW9uIG5vcm1TY2hlbWEoc2NoZW1hLCBiYXNlVXJpKSB7XHJcblx0aWYgKHNjaGVtYSAmJiB0eXBlb2Ygc2NoZW1hID09PSBcIm9iamVjdFwiKSB7XHJcblx0XHRpZiAoYmFzZVVyaSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdGJhc2VVcmkgPSBzY2hlbWEuaWQ7XHJcblx0XHR9IGVsc2UgaWYgKHR5cGVvZiBzY2hlbWEuaWQgPT09IFwic3RyaW5nXCIpIHtcclxuXHRcdFx0YmFzZVVyaSA9IHJlc29sdmVVcmwoYmFzZVVyaSwgc2NoZW1hLmlkKTtcclxuXHRcdFx0c2NoZW1hLmlkID0gYmFzZVVyaTtcclxuXHRcdH1cclxuXHRcdGlmIChBcnJheS5pc0FycmF5KHNjaGVtYSkpIHtcclxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzY2hlbWEubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRub3JtU2NoZW1hKHNjaGVtYVtpXSwgYmFzZVVyaSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlmICh0eXBlb2Ygc2NoZW1hWyckcmVmJ10gPT09IFwic3RyaW5nXCIpIHtcclxuXHRcdFx0XHRzY2hlbWFbJyRyZWYnXSA9IHJlc29sdmVVcmwoYmFzZVVyaSwgc2NoZW1hWyckcmVmJ10pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZvciAodmFyIGtleSBpbiBzY2hlbWEpIHtcclxuXHRcdFx0XHRpZiAoa2V5ICE9PSBcImVudW1cIikge1xyXG5cdFx0XHRcdFx0bm9ybVNjaGVtYShzY2hlbWFba2V5XSwgYmFzZVVyaSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBkZWZhdWx0RXJyb3JSZXBvcnRlcihsYW5ndWFnZSkge1xyXG5cdGxhbmd1YWdlID0gbGFuZ3VhZ2UgfHwgJ2VuJztcclxuXHJcblx0dmFyIGVycm9yTWVzc2FnZXMgPSBsYW5ndWFnZXNbbGFuZ3VhZ2VdO1xyXG5cclxuXHRyZXR1cm4gZnVuY3Rpb24gKGVycm9yKSB7XHJcblx0XHR2YXIgbWVzc2FnZVRlbXBsYXRlID0gZXJyb3JNZXNzYWdlc1tlcnJvci5jb2RlXSB8fCBFcnJvck1lc3NhZ2VzRGVmYXVsdFtlcnJvci5jb2RlXTtcclxuXHRcdGlmICh0eXBlb2YgbWVzc2FnZVRlbXBsYXRlICE9PSAnc3RyaW5nJykge1xyXG5cdFx0XHRyZXR1cm4gXCJVbmtub3duIGVycm9yIGNvZGUgXCIgKyBlcnJvci5jb2RlICsgXCI6IFwiICsgSlNPTi5zdHJpbmdpZnkoZXJyb3IubWVzc2FnZVBhcmFtcyk7XHJcblx0XHR9XHJcblx0XHR2YXIgbWVzc2FnZVBhcmFtcyA9IGVycm9yLnBhcmFtcztcclxuXHRcdC8vIEFkYXB0ZWQgZnJvbSBDcm9ja2ZvcmQncyBzdXBwbGFudCgpXHJcblx0XHRyZXR1cm4gbWVzc2FnZVRlbXBsYXRlLnJlcGxhY2UoL1xceyhbXnt9XSopXFx9L2csIGZ1bmN0aW9uICh3aG9sZSwgdmFyTmFtZSkge1xyXG5cdFx0XHR2YXIgc3ViVmFsdWUgPSBtZXNzYWdlUGFyYW1zW3Zhck5hbWVdO1xyXG5cdFx0XHRyZXR1cm4gdHlwZW9mIHN1YlZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2Ygc3ViVmFsdWUgPT09ICdudW1iZXInID8gc3ViVmFsdWUgOiB3aG9sZTtcclxuXHRcdH0pO1xyXG5cdH07XHJcbn1cclxuXHJcbnZhciBFcnJvckNvZGVzID0ge1xyXG5cdElOVkFMSURfVFlQRTogMCxcclxuXHRFTlVNX01JU01BVENIOiAxLFxyXG5cdEFOWV9PRl9NSVNTSU5HOiAxMCxcclxuXHRPTkVfT0ZfTUlTU0lORzogMTEsXHJcblx0T05FX09GX01VTFRJUExFOiAxMixcclxuXHROT1RfUEFTU0VEOiAxMyxcclxuXHQvLyBOdW1lcmljIGVycm9yc1xyXG5cdE5VTUJFUl9NVUxUSVBMRV9PRjogMTAwLFxyXG5cdE5VTUJFUl9NSU5JTVVNOiAxMDEsXHJcblx0TlVNQkVSX01JTklNVU1fRVhDTFVTSVZFOiAxMDIsXHJcblx0TlVNQkVSX01BWElNVU06IDEwMyxcclxuXHROVU1CRVJfTUFYSU1VTV9FWENMVVNJVkU6IDEwNCxcclxuXHROVU1CRVJfTk9UX0FfTlVNQkVSOiAxMDUsXHJcblx0Ly8gU3RyaW5nIGVycm9yc1xyXG5cdFNUUklOR19MRU5HVEhfU0hPUlQ6IDIwMCxcclxuXHRTVFJJTkdfTEVOR1RIX0xPTkc6IDIwMSxcclxuXHRTVFJJTkdfUEFUVEVSTjogMjAyLFxyXG5cdC8vIE9iamVjdCBlcnJvcnNcclxuXHRPQkpFQ1RfUFJPUEVSVElFU19NSU5JTVVNOiAzMDAsXHJcblx0T0JKRUNUX1BST1BFUlRJRVNfTUFYSU1VTTogMzAxLFxyXG5cdE9CSkVDVF9SRVFVSVJFRDogMzAyLFxyXG5cdE9CSkVDVF9BRERJVElPTkFMX1BST1BFUlRJRVM6IDMwMyxcclxuXHRPQkpFQ1RfREVQRU5ERU5DWV9LRVk6IDMwNCxcclxuXHQvLyBBcnJheSBlcnJvcnNcclxuXHRBUlJBWV9MRU5HVEhfU0hPUlQ6IDQwMCxcclxuXHRBUlJBWV9MRU5HVEhfTE9ORzogNDAxLFxyXG5cdEFSUkFZX1VOSVFVRTogNDAyLFxyXG5cdEFSUkFZX0FERElUSU9OQUxfSVRFTVM6IDQwMyxcclxuXHQvLyBDdXN0b20vdXNlci1kZWZpbmVkIGVycm9yc1xyXG5cdEZPUk1BVF9DVVNUT006IDUwMCxcclxuXHRLRVlXT1JEX0NVU1RPTTogNTAxLFxyXG5cdC8vIFNjaGVtYSBzdHJ1Y3R1cmVcclxuXHRDSVJDVUxBUl9SRUZFUkVOQ0U6IDYwMCxcclxuXHQvLyBOb24tc3RhbmRhcmQgdmFsaWRhdGlvbiBvcHRpb25zXHJcblx0VU5LTk9XTl9QUk9QRVJUWTogMTAwMFxyXG59O1xyXG52YXIgRXJyb3JDb2RlTG9va3VwID0ge307XHJcbmZvciAodmFyIGtleSBpbiBFcnJvckNvZGVzKSB7XHJcblx0RXJyb3JDb2RlTG9va3VwW0Vycm9yQ29kZXNba2V5XV0gPSBrZXk7XHJcbn1cclxudmFyIEVycm9yTWVzc2FnZXNEZWZhdWx0ID0ge1xyXG5cdElOVkFMSURfVFlQRTogXCJJbnZhbGlkIHR5cGU6IHt0eXBlfSAoZXhwZWN0ZWQge2V4cGVjdGVkfSlcIixcclxuXHRFTlVNX01JU01BVENIOiBcIk5vIGVudW0gbWF0Y2ggZm9yOiB7dmFsdWV9XCIsXHJcblx0QU5ZX09GX01JU1NJTkc6IFwiRGF0YSBkb2VzIG5vdCBtYXRjaCBhbnkgc2NoZW1hcyBmcm9tIFxcXCJhbnlPZlxcXCJcIixcclxuXHRPTkVfT0ZfTUlTU0lORzogXCJEYXRhIGRvZXMgbm90IG1hdGNoIGFueSBzY2hlbWFzIGZyb20gXFxcIm9uZU9mXFxcIlwiLFxyXG5cdE9ORV9PRl9NVUxUSVBMRTogXCJEYXRhIGlzIHZhbGlkIGFnYWluc3QgbW9yZSB0aGFuIG9uZSBzY2hlbWEgZnJvbSBcXFwib25lT2ZcXFwiOiBpbmRpY2VzIHtpbmRleDF9IGFuZCB7aW5kZXgyfVwiLFxyXG5cdE5PVF9QQVNTRUQ6IFwiRGF0YSBtYXRjaGVzIHNjaGVtYSBmcm9tIFxcXCJub3RcXFwiXCIsXHJcblx0Ly8gTnVtZXJpYyBlcnJvcnNcclxuXHROVU1CRVJfTVVMVElQTEVfT0Y6IFwiVmFsdWUge3ZhbHVlfSBpcyBub3QgYSBtdWx0aXBsZSBvZiB7bXVsdGlwbGVPZn1cIixcclxuXHROVU1CRVJfTUlOSU1VTTogXCJWYWx1ZSB7dmFsdWV9IGlzIGxlc3MgdGhhbiBtaW5pbXVtIHttaW5pbXVtfVwiLFxyXG5cdE5VTUJFUl9NSU5JTVVNX0VYQ0xVU0lWRTogXCJWYWx1ZSB7dmFsdWV9IGlzIGVxdWFsIHRvIGV4Y2x1c2l2ZSBtaW5pbXVtIHttaW5pbXVtfVwiLFxyXG5cdE5VTUJFUl9NQVhJTVVNOiBcIlZhbHVlIHt2YWx1ZX0gaXMgZ3JlYXRlciB0aGFuIG1heGltdW0ge21heGltdW19XCIsXHJcblx0TlVNQkVSX01BWElNVU1fRVhDTFVTSVZFOiBcIlZhbHVlIHt2YWx1ZX0gaXMgZXF1YWwgdG8gZXhjbHVzaXZlIG1heGltdW0ge21heGltdW19XCIsXHJcblx0TlVNQkVSX05PVF9BX05VTUJFUjogXCJWYWx1ZSB7dmFsdWV9IGlzIG5vdCBhIHZhbGlkIG51bWJlclwiLFxyXG5cdC8vIFN0cmluZyBlcnJvcnNcclxuXHRTVFJJTkdfTEVOR1RIX1NIT1JUOiBcIlN0cmluZyBpcyB0b28gc2hvcnQgKHtsZW5ndGh9IGNoYXJzKSwgbWluaW11bSB7bWluaW11bX1cIixcclxuXHRTVFJJTkdfTEVOR1RIX0xPTkc6IFwiU3RyaW5nIGlzIHRvbyBsb25nICh7bGVuZ3RofSBjaGFycyksIG1heGltdW0ge21heGltdW19XCIsXHJcblx0U1RSSU5HX1BBVFRFUk46IFwiU3RyaW5nIGRvZXMgbm90IG1hdGNoIHBhdHRlcm46IHtwYXR0ZXJufVwiLFxyXG5cdC8vIE9iamVjdCBlcnJvcnNcclxuXHRPQkpFQ1RfUFJPUEVSVElFU19NSU5JTVVNOiBcIlRvbyBmZXcgcHJvcGVydGllcyBkZWZpbmVkICh7cHJvcGVydHlDb3VudH0pLCBtaW5pbXVtIHttaW5pbXVtfVwiLFxyXG5cdE9CSkVDVF9QUk9QRVJUSUVTX01BWElNVU06IFwiVG9vIG1hbnkgcHJvcGVydGllcyBkZWZpbmVkICh7cHJvcGVydHlDb3VudH0pLCBtYXhpbXVtIHttYXhpbXVtfVwiLFxyXG5cdE9CSkVDVF9SRVFVSVJFRDogXCJNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5OiB7a2V5fVwiLFxyXG5cdE9CSkVDVF9BRERJVElPTkFMX1BST1BFUlRJRVM6IFwiQWRkaXRpb25hbCBwcm9wZXJ0aWVzIG5vdCBhbGxvd2VkXCIsXHJcblx0T0JKRUNUX0RFUEVOREVOQ1lfS0VZOiBcIkRlcGVuZGVuY3kgZmFpbGVkIC0ga2V5IG11c3QgZXhpc3Q6IHttaXNzaW5nfSAoZHVlIHRvIGtleToge2tleX0pXCIsXHJcblx0Ly8gQXJyYXkgZXJyb3JzXHJcblx0QVJSQVlfTEVOR1RIX1NIT1JUOiBcIkFycmF5IGlzIHRvbyBzaG9ydCAoe2xlbmd0aH0pLCBtaW5pbXVtIHttaW5pbXVtfVwiLFxyXG5cdEFSUkFZX0xFTkdUSF9MT05HOiBcIkFycmF5IGlzIHRvbyBsb25nICh7bGVuZ3RofSksIG1heGltdW0ge21heGltdW19XCIsXHJcblx0QVJSQVlfVU5JUVVFOiBcIkFycmF5IGl0ZW1zIGFyZSBub3QgdW5pcXVlIChpbmRpY2VzIHttYXRjaDF9IGFuZCB7bWF0Y2gyfSlcIixcclxuXHRBUlJBWV9BRERJVElPTkFMX0lURU1TOiBcIkFkZGl0aW9uYWwgaXRlbXMgbm90IGFsbG93ZWRcIixcclxuXHQvLyBGb3JtYXQgZXJyb3JzXHJcblx0Rk9STUFUX0NVU1RPTTogXCJGb3JtYXQgdmFsaWRhdGlvbiBmYWlsZWQgKHttZXNzYWdlfSlcIixcclxuXHRLRVlXT1JEX0NVU1RPTTogXCJLZXl3b3JkIGZhaWxlZDoge2tleX0gKHttZXNzYWdlfSlcIixcclxuXHQvLyBTY2hlbWEgc3RydWN0dXJlXHJcblx0Q0lSQ1VMQVJfUkVGRVJFTkNFOiBcIkNpcmN1bGFyICRyZWZzOiB7dXJsc31cIixcclxuXHQvLyBOb24tc3RhbmRhcmQgdmFsaWRhdGlvbiBvcHRpb25zXHJcblx0VU5LTk9XTl9QUk9QRVJUWTogXCJVbmtub3duIHByb3BlcnR5IChub3QgaW4gc2NoZW1hKVwiXHJcbn07XHJcblxyXG5mdW5jdGlvbiBWYWxpZGF0aW9uRXJyb3IoY29kZSwgcGFyYW1zLCBkYXRhUGF0aCwgc2NoZW1hUGF0aCwgc3ViRXJyb3JzKSB7XHJcblx0RXJyb3IuY2FsbCh0aGlzKTtcclxuXHRpZiAoY29kZSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IgKFwiTm8gZXJyb3IgY29kZSBzdXBwbGllZDogXCIgKyBzY2hlbWFQYXRoKTtcclxuXHR9XHJcblx0dGhpcy5tZXNzYWdlID0gJyc7XHJcblx0dGhpcy5wYXJhbXMgPSBwYXJhbXM7XHJcblx0dGhpcy5jb2RlID0gY29kZTtcclxuXHR0aGlzLmRhdGFQYXRoID0gZGF0YVBhdGggfHwgXCJcIjtcclxuXHR0aGlzLnNjaGVtYVBhdGggPSBzY2hlbWFQYXRoIHx8IFwiXCI7XHJcblx0dGhpcy5zdWJFcnJvcnMgPSBzdWJFcnJvcnMgfHwgbnVsbDtcclxuXHJcblx0dmFyIGVyciA9IG5ldyBFcnJvcih0aGlzLm1lc3NhZ2UpO1xyXG5cdHRoaXMuc3RhY2sgPSBlcnIuc3RhY2sgfHwgZXJyLnN0YWNrdHJhY2U7XHJcblx0aWYgKCF0aGlzLnN0YWNrKSB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHR0aHJvdyBlcnI7XHJcblx0XHR9XHJcblx0XHRjYXRjaChlcnIpIHtcclxuXHRcdFx0dGhpcy5zdGFjayA9IGVyci5zdGFjayB8fCBlcnIuc3RhY2t0cmFjZTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuVmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcclxuVmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFZhbGlkYXRpb25FcnJvcjtcclxuVmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS5uYW1lID0gJ1ZhbGlkYXRpb25FcnJvcic7XHJcblxyXG5WYWxpZGF0aW9uRXJyb3IucHJvdG90eXBlLnByZWZpeFdpdGggPSBmdW5jdGlvbiAoZGF0YVByZWZpeCwgc2NoZW1hUHJlZml4KSB7XHJcblx0aWYgKGRhdGFQcmVmaXggIT09IG51bGwpIHtcclxuXHRcdGRhdGFQcmVmaXggPSBkYXRhUHJlZml4LnJlcGxhY2UoL34vZywgXCJ+MFwiKS5yZXBsYWNlKC9cXC8vZywgXCJ+MVwiKTtcclxuXHRcdHRoaXMuZGF0YVBhdGggPSBcIi9cIiArIGRhdGFQcmVmaXggKyB0aGlzLmRhdGFQYXRoO1xyXG5cdH1cclxuXHRpZiAoc2NoZW1hUHJlZml4ICE9PSBudWxsKSB7XHJcblx0XHRzY2hlbWFQcmVmaXggPSBzY2hlbWFQcmVmaXgucmVwbGFjZSgvfi9nLCBcIn4wXCIpLnJlcGxhY2UoL1xcLy9nLCBcIn4xXCIpO1xyXG5cdFx0dGhpcy5zY2hlbWFQYXRoID0gXCIvXCIgKyBzY2hlbWFQcmVmaXggKyB0aGlzLnNjaGVtYVBhdGg7XHJcblx0fVxyXG5cdGlmICh0aGlzLnN1YkVycm9ycyAhPT0gbnVsbCkge1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnN1YkVycm9ycy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR0aGlzLnN1YkVycm9yc1tpXS5wcmVmaXhXaXRoKGRhdGFQcmVmaXgsIHNjaGVtYVByZWZpeCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gaXNUcnVzdGVkVXJsKGJhc2VVcmwsIHRlc3RVcmwpIHtcclxuXHRpZih0ZXN0VXJsLnN1YnN0cmluZygwLCBiYXNlVXJsLmxlbmd0aCkgPT09IGJhc2VVcmwpe1xyXG5cdFx0dmFyIHJlbWFpbmRlciA9IHRlc3RVcmwuc3Vic3RyaW5nKGJhc2VVcmwubGVuZ3RoKTtcclxuXHRcdGlmICgodGVzdFVybC5sZW5ndGggPiAwICYmIHRlc3RVcmwuY2hhckF0KGJhc2VVcmwubGVuZ3RoIC0gMSkgPT09IFwiL1wiKVxyXG5cdFx0XHR8fCByZW1haW5kZXIuY2hhckF0KDApID09PSBcIiNcIlxyXG5cdFx0XHR8fCByZW1haW5kZXIuY2hhckF0KDApID09PSBcIj9cIikge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG52YXIgbGFuZ3VhZ2VzID0ge307XHJcbmZ1bmN0aW9uIGNyZWF0ZUFwaShsYW5ndWFnZSkge1xyXG5cdHZhciBnbG9iYWxDb250ZXh0ID0gbmV3IFZhbGlkYXRvckNvbnRleHQoKTtcclxuXHR2YXIgY3VycmVudExhbmd1YWdlO1xyXG5cdHZhciBjdXN0b21FcnJvclJlcG9ydGVyO1xyXG5cdHZhciBhcGkgPSB7XHJcblx0XHRzZXRFcnJvclJlcG9ydGVyOiBmdW5jdGlvbiAocmVwb3J0ZXIpIHtcclxuXHRcdFx0aWYgKHR5cGVvZiByZXBvcnRlciA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5sYW5ndWFnZShyZXBvcnRlcik7XHJcblx0XHRcdH1cclxuXHRcdFx0Y3VzdG9tRXJyb3JSZXBvcnRlciA9IHJlcG9ydGVyO1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH0sXHJcblx0XHRhZGRGb3JtYXQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0Z2xvYmFsQ29udGV4dC5hZGRGb3JtYXQuYXBwbHkoZ2xvYmFsQ29udGV4dCwgYXJndW1lbnRzKTtcclxuXHRcdH0sXHJcblx0XHRsYW5ndWFnZTogZnVuY3Rpb24gKGNvZGUpIHtcclxuXHRcdFx0aWYgKCFjb2RlKSB7XHJcblx0XHRcdFx0cmV0dXJuIGN1cnJlbnRMYW5ndWFnZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIWxhbmd1YWdlc1tjb2RlXSkge1xyXG5cdFx0XHRcdGNvZGUgPSBjb2RlLnNwbGl0KCctJylbMF07IC8vIGZhbGwgYmFjayB0byBiYXNlIGxhbmd1YWdlXHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKGxhbmd1YWdlc1tjb2RlXSkge1xyXG5cdFx0XHRcdGN1cnJlbnRMYW5ndWFnZSA9IGNvZGU7XHJcblx0XHRcdFx0cmV0dXJuIGNvZGU7IC8vIHNvIHlvdSBjYW4gdGVsbCBpZiBmYWxsLWJhY2sgaGFzIGhhcHBlbmVkXHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fSxcclxuXHRcdGFkZExhbmd1YWdlOiBmdW5jdGlvbiAoY29kZSwgbWVzc2FnZU1hcCkge1xyXG5cdFx0XHR2YXIga2V5O1xyXG5cdFx0XHRmb3IgKGtleSBpbiBFcnJvckNvZGVzKSB7XHJcblx0XHRcdFx0aWYgKG1lc3NhZ2VNYXBba2V5XSAmJiAhbWVzc2FnZU1hcFtFcnJvckNvZGVzW2tleV1dKSB7XHJcblx0XHRcdFx0XHRtZXNzYWdlTWFwW0Vycm9yQ29kZXNba2V5XV0gPSBtZXNzYWdlTWFwW2tleV07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHZhciByb290Q29kZSA9IGNvZGUuc3BsaXQoJy0nKVswXTtcclxuXHRcdFx0aWYgKCFsYW5ndWFnZXNbcm9vdENvZGVdKSB7IC8vIHVzZSBmb3IgYmFzZSBsYW5ndWFnZSBpZiBub3QgeWV0IGRlZmluZWRcclxuXHRcdFx0XHRsYW5ndWFnZXNbY29kZV0gPSBtZXNzYWdlTWFwO1xyXG5cdFx0XHRcdGxhbmd1YWdlc1tyb290Q29kZV0gPSBtZXNzYWdlTWFwO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGxhbmd1YWdlc1tjb2RlXSA9IE9iamVjdC5jcmVhdGUobGFuZ3VhZ2VzW3Jvb3RDb2RlXSk7XHJcblx0XHRcdFx0Zm9yIChrZXkgaW4gbWVzc2FnZU1hcCkge1xyXG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBsYW5ndWFnZXNbcm9vdENvZGVdW2tleV0gPT09ICd1bmRlZmluZWQnKSB7XHJcblx0XHRcdFx0XHRcdGxhbmd1YWdlc1tyb290Q29kZV1ba2V5XSA9IG1lc3NhZ2VNYXBba2V5XTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGxhbmd1YWdlc1tjb2RlXVtrZXldID0gbWVzc2FnZU1hcFtrZXldO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH0sXHJcblx0XHRmcmVzaEFwaTogZnVuY3Rpb24gKGxhbmd1YWdlKSB7XHJcblx0XHRcdHZhciByZXN1bHQgPSBjcmVhdGVBcGkoKTtcclxuXHRcdFx0aWYgKGxhbmd1YWdlKSB7XHJcblx0XHRcdFx0cmVzdWx0Lmxhbmd1YWdlKGxhbmd1YWdlKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0fSxcclxuXHRcdHZhbGlkYXRlOiBmdW5jdGlvbiAoZGF0YSwgc2NoZW1hLCBjaGVja1JlY3Vyc2l2ZSwgYmFuVW5rbm93blByb3BlcnRpZXMpIHtcclxuXHRcdFx0dmFyIGRlZiA9IGRlZmF1bHRFcnJvclJlcG9ydGVyKGN1cnJlbnRMYW5ndWFnZSk7XHJcblx0XHRcdHZhciBlcnJvclJlcG9ydGVyID0gY3VzdG9tRXJyb3JSZXBvcnRlciA/IGZ1bmN0aW9uIChlcnJvciwgZGF0YSwgc2NoZW1hKSB7XHJcblx0XHRcdFx0cmV0dXJuIGN1c3RvbUVycm9yUmVwb3J0ZXIoZXJyb3IsIGRhdGEsIHNjaGVtYSkgfHwgZGVmKGVycm9yLCBkYXRhLCBzY2hlbWEpO1xyXG5cdFx0XHR9IDogZGVmO1xyXG5cdFx0XHR2YXIgY29udGV4dCA9IG5ldyBWYWxpZGF0b3JDb250ZXh0KGdsb2JhbENvbnRleHQsIGZhbHNlLCBlcnJvclJlcG9ydGVyLCBjaGVja1JlY3Vyc2l2ZSwgYmFuVW5rbm93blByb3BlcnRpZXMpO1xyXG5cdFx0XHRpZiAodHlwZW9mIHNjaGVtYSA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHRcdHNjaGVtYSA9IHtcIiRyZWZcIjogc2NoZW1hfTtcclxuXHRcdFx0fVxyXG5cdFx0XHRjb250ZXh0LmFkZFNjaGVtYShcIlwiLCBzY2hlbWEpO1xyXG5cdFx0XHR2YXIgZXJyb3IgPSBjb250ZXh0LnZhbGlkYXRlQWxsKGRhdGEsIHNjaGVtYSwgbnVsbCwgbnVsbCwgXCJcIik7XHJcblx0XHRcdGlmICghZXJyb3IgJiYgYmFuVW5rbm93blByb3BlcnRpZXMpIHtcclxuXHRcdFx0XHRlcnJvciA9IGNvbnRleHQuYmFuVW5rbm93blByb3BlcnRpZXMoZGF0YSwgc2NoZW1hKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmVycm9yID0gZXJyb3I7XHJcblx0XHRcdHRoaXMubWlzc2luZyA9IGNvbnRleHQubWlzc2luZztcclxuXHRcdFx0dGhpcy52YWxpZCA9IChlcnJvciA9PT0gbnVsbCk7XHJcblx0XHRcdHJldHVybiB0aGlzLnZhbGlkO1xyXG5cdFx0fSxcclxuXHRcdHZhbGlkYXRlUmVzdWx0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHZhciByZXN1bHQgPSB7dG9TdHJpbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy52YWxpZCA/ICd2YWxpZCcgOiB0aGlzLmVycm9yLm1lc3NhZ2U7XHJcblx0XHRcdH19O1xyXG5cdFx0XHR0aGlzLnZhbGlkYXRlLmFwcGx5KHJlc3VsdCwgYXJndW1lbnRzKTtcclxuXHRcdFx0cmV0dXJuIHJlc3VsdDtcclxuXHRcdH0sXHJcblx0XHR2YWxpZGF0ZU11bHRpcGxlOiBmdW5jdGlvbiAoZGF0YSwgc2NoZW1hLCBjaGVja1JlY3Vyc2l2ZSwgYmFuVW5rbm93blByb3BlcnRpZXMpIHtcclxuXHRcdFx0dmFyIGRlZiA9IGRlZmF1bHRFcnJvclJlcG9ydGVyKGN1cnJlbnRMYW5ndWFnZSk7XHJcblx0XHRcdHZhciBlcnJvclJlcG9ydGVyID0gY3VzdG9tRXJyb3JSZXBvcnRlciA/IGZ1bmN0aW9uIChlcnJvciwgZGF0YSwgc2NoZW1hKSB7XHJcblx0XHRcdFx0cmV0dXJuIGN1c3RvbUVycm9yUmVwb3J0ZXIoZXJyb3IsIGRhdGEsIHNjaGVtYSkgfHwgZGVmKGVycm9yLCBkYXRhLCBzY2hlbWEpO1xyXG5cdFx0XHR9IDogZGVmO1xyXG5cdFx0XHR2YXIgY29udGV4dCA9IG5ldyBWYWxpZGF0b3JDb250ZXh0KGdsb2JhbENvbnRleHQsIHRydWUsIGVycm9yUmVwb3J0ZXIsIGNoZWNrUmVjdXJzaXZlLCBiYW5Vbmtub3duUHJvcGVydGllcyk7XHJcblx0XHRcdGlmICh0eXBlb2Ygc2NoZW1hID09PSBcInN0cmluZ1wiKSB7XHJcblx0XHRcdFx0c2NoZW1hID0ge1wiJHJlZlwiOiBzY2hlbWF9O1xyXG5cdFx0XHR9XHJcblx0XHRcdGNvbnRleHQuYWRkU2NoZW1hKFwiXCIsIHNjaGVtYSk7XHJcblx0XHRcdGNvbnRleHQudmFsaWRhdGVBbGwoZGF0YSwgc2NoZW1hLCBudWxsLCBudWxsLCBcIlwiKTtcclxuXHRcdFx0aWYgKGJhblVua25vd25Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0Y29udGV4dC5iYW5Vbmtub3duUHJvcGVydGllcyhkYXRhLCBzY2hlbWEpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciByZXN1bHQgPSB7dG9TdHJpbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy52YWxpZCA/ICd2YWxpZCcgOiB0aGlzLmVycm9yLm1lc3NhZ2U7XHJcblx0XHRcdH19O1xyXG5cdFx0XHRyZXN1bHQuZXJyb3JzID0gY29udGV4dC5lcnJvcnM7XHJcblx0XHRcdHJlc3VsdC5taXNzaW5nID0gY29udGV4dC5taXNzaW5nO1xyXG5cdFx0XHRyZXN1bHQudmFsaWQgPSAocmVzdWx0LmVycm9ycy5sZW5ndGggPT09IDApO1xyXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0fSxcclxuXHRcdGFkZFNjaGVtYTogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRyZXR1cm4gZ2xvYmFsQ29udGV4dC5hZGRTY2hlbWEuYXBwbHkoZ2xvYmFsQ29udGV4dCwgYXJndW1lbnRzKTtcclxuXHRcdH0sXHJcblx0XHRnZXRTY2hlbWE6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIGdsb2JhbENvbnRleHQuZ2V0U2NoZW1hLmFwcGx5KGdsb2JhbENvbnRleHQsIGFyZ3VtZW50cyk7XHJcblx0XHR9LFxyXG5cdFx0Z2V0U2NoZW1hTWFwOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiBnbG9iYWxDb250ZXh0LmdldFNjaGVtYU1hcC5hcHBseShnbG9iYWxDb250ZXh0LCBhcmd1bWVudHMpO1xyXG5cdFx0fSxcclxuXHRcdGdldFNjaGVtYVVyaXM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIGdsb2JhbENvbnRleHQuZ2V0U2NoZW1hVXJpcy5hcHBseShnbG9iYWxDb250ZXh0LCBhcmd1bWVudHMpO1xyXG5cdFx0fSxcclxuXHRcdGdldE1pc3NpbmdVcmlzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiBnbG9iYWxDb250ZXh0LmdldE1pc3NpbmdVcmlzLmFwcGx5KGdsb2JhbENvbnRleHQsIGFyZ3VtZW50cyk7XHJcblx0XHR9LFxyXG5cdFx0ZHJvcFNjaGVtYXM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0Z2xvYmFsQ29udGV4dC5kcm9wU2NoZW1hcy5hcHBseShnbG9iYWxDb250ZXh0LCBhcmd1bWVudHMpO1xyXG5cdFx0fSxcclxuXHRcdGRlZmluZUtleXdvcmQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0Z2xvYmFsQ29udGV4dC5kZWZpbmVLZXl3b3JkLmFwcGx5KGdsb2JhbENvbnRleHQsIGFyZ3VtZW50cyk7XHJcblx0XHR9LFxyXG5cdFx0ZGVmaW5lRXJyb3I6IGZ1bmN0aW9uIChjb2RlTmFtZSwgY29kZU51bWJlciwgZGVmYXVsdE1lc3NhZ2UpIHtcclxuXHRcdFx0aWYgKHR5cGVvZiBjb2RlTmFtZSAhPT0gJ3N0cmluZycgfHwgIS9eW0EtWl0rKF9bQS1aXSspKiQvLnRlc3QoY29kZU5hbWUpKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDb2RlIG5hbWUgbXVzdCBiZSBhIHN0cmluZyBpbiBVUFBFUl9DQVNFX1dJVEhfVU5ERVJTQ09SRVMnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAodHlwZW9mIGNvZGVOdW1iZXIgIT09ICdudW1iZXInIHx8IGNvZGVOdW1iZXIlMSAhPT0gMCB8fCBjb2RlTnVtYmVyIDwgMTAwMDApIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NvZGUgbnVtYmVyIG11c3QgYmUgYW4gaW50ZWdlciA+IDEwMDAwJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHR5cGVvZiBFcnJvckNvZGVzW2NvZGVOYW1lXSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0Vycm9yIGFscmVhZHkgZGVmaW5lZDogJyArIGNvZGVOYW1lICsgJyBhcyAnICsgRXJyb3JDb2Rlc1tjb2RlTmFtZV0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0eXBlb2YgRXJyb3JDb2RlTG9va3VwW2NvZGVOdW1iZXJdICE9PSAndW5kZWZpbmVkJykge1xyXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignRXJyb3IgY29kZSBhbHJlYWR5IHVzZWQ6ICcgKyBFcnJvckNvZGVMb29rdXBbY29kZU51bWJlcl0gKyAnIGFzICcgKyBjb2RlTnVtYmVyKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRFcnJvckNvZGVzW2NvZGVOYW1lXSA9IGNvZGVOdW1iZXI7XHJcblx0XHRcdEVycm9yQ29kZUxvb2t1cFtjb2RlTnVtYmVyXSA9IGNvZGVOYW1lO1xyXG5cdFx0XHRFcnJvck1lc3NhZ2VzRGVmYXVsdFtjb2RlTmFtZV0gPSBFcnJvck1lc3NhZ2VzRGVmYXVsdFtjb2RlTnVtYmVyXSA9IGRlZmF1bHRNZXNzYWdlO1xyXG5cdFx0XHRmb3IgKHZhciBsYW5nQ29kZSBpbiBsYW5ndWFnZXMpIHtcclxuXHRcdFx0XHR2YXIgbGFuZ3VhZ2UgPSBsYW5ndWFnZXNbbGFuZ0NvZGVdO1xyXG5cdFx0XHRcdGlmIChsYW5ndWFnZVtjb2RlTmFtZV0pIHtcclxuXHRcdFx0XHRcdGxhbmd1YWdlW2NvZGVOdW1iZXJdID0gbGFuZ3VhZ2VbY29kZU51bWJlcl0gfHwgbGFuZ3VhZ2VbY29kZU5hbWVdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdHJlc2V0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGdsb2JhbENvbnRleHQucmVzZXQoKTtcclxuXHRcdFx0dGhpcy5lcnJvciA9IG51bGw7XHJcblx0XHRcdHRoaXMubWlzc2luZyA9IFtdO1xyXG5cdFx0XHR0aGlzLnZhbGlkID0gdHJ1ZTtcclxuXHRcdH0sXHJcblx0XHRtaXNzaW5nOiBbXSxcclxuXHRcdGVycm9yOiBudWxsLFxyXG5cdFx0dmFsaWQ6IHRydWUsXHJcblx0XHRub3JtU2NoZW1hOiBub3JtU2NoZW1hLFxyXG5cdFx0cmVzb2x2ZVVybDogcmVzb2x2ZVVybCxcclxuXHRcdGdldERvY3VtZW50VXJpOiBnZXREb2N1bWVudFVyaSxcclxuXHRcdGVycm9yQ29kZXM6IEVycm9yQ29kZXNcclxuXHR9O1xyXG5cdGFwaS5sYW5ndWFnZShsYW5ndWFnZSB8fCAnZW4nKTtcclxuXHRyZXR1cm4gYXBpO1xyXG59XHJcblxyXG52YXIgdHY0ID0gY3JlYXRlQXBpKCk7XHJcbnR2NC5hZGRMYW5ndWFnZSgnZW4tZ2InLCBFcnJvck1lc3NhZ2VzRGVmYXVsdCk7XHJcblxyXG4vL2xlZ2FjeSBwcm9wZXJ0eVxyXG50djQudHY0ID0gdHY0O1xyXG5cclxucmV0dXJuIHR2NDsgLy8gdXNlZCBieSBfaGVhZGVyLmpzIHRvIGdsb2JhbGlzZS5cclxuXHJcbn0pKTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBLFdBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///83\n')},function(module,exports,__webpack_require__){eval("module.exports = !__webpack_require__(8) && !__webpack_require__(2)(function () {\n  return Object.defineProperty(__webpack_require__(57)('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pZTgtZG9tLWRlZmluZS5qcz9jNjlhIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gIXJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgJiYgIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlcXVpcmUoJy4vX2RvbS1jcmVhdGUnKSgnZGl2JyksICdhJywgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDc7IH0gfSkuYSAhPSA3O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///84\n")},function(module,exports,__webpack_require__){eval("var global = __webpack_require__(3);\nvar core = __webpack_require__(9);\nvar LIBRARY = __webpack_require__(31);\nvar wksExt = __webpack_require__(59);\nvar defineProperty = __webpack_require__(7).f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL193a3MtZGVmaW5lLmpzPzNhNzIiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGNvcmUgPSByZXF1aXJlKCcuL19jb3JlJyk7XG52YXIgTElCUkFSWSA9IHJlcXVpcmUoJy4vX2xpYnJhcnknKTtcbnZhciB3a3NFeHQgPSByZXF1aXJlKCcuL193a3MtZXh0Jyk7XG52YXIgZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobmFtZSkge1xuICB2YXIgJFN5bWJvbCA9IGNvcmUuU3ltYm9sIHx8IChjb3JlLlN5bWJvbCA9IExJQlJBUlkgPyB7fSA6IGdsb2JhbC5TeW1ib2wgfHwge30pO1xuICBpZiAobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSkgZGVmaW5lUHJvcGVydHkoJFN5bWJvbCwgbmFtZSwgeyB2YWx1ZTogd2tzRXh0LmYobmFtZSkgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///85\n")},function(module,exports,__webpack_require__){eval("var has = __webpack_require__(13);\nvar toIObject = __webpack_require__(15);\nvar arrayIndexOf = __webpack_require__(46)(false);\nvar IE_PROTO = __webpack_require__(60)('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3Qta2V5cy1pbnRlcm5hbC5qcz9jZTEwIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbnZhciB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0Jyk7XG52YXIgYXJyYXlJbmRleE9mID0gcmVxdWlyZSgnLi9fYXJyYXktaW5jbHVkZXMnKShmYWxzZSk7XG52YXIgSUVfUFJPVE8gPSByZXF1aXJlKCcuL19zaGFyZWQta2V5JykoJ0lFX1BST1RPJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iamVjdCwgbmFtZXMpIHtcbiAgdmFyIE8gPSB0b0lPYmplY3Qob2JqZWN0KTtcbiAgdmFyIGkgPSAwO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIHZhciBrZXk7XG4gIGZvciAoa2V5IGluIE8pIGlmIChrZXkgIT0gSUVfUFJPVE8pIGhhcyhPLCBrZXkpICYmIHJlc3VsdC5wdXNoKGtleSk7XG4gIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXNcbiAgd2hpbGUgKG5hbWVzLmxlbmd0aCA+IGkpIGlmIChoYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpIHtcbiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///86\n")},function(module,exports,__webpack_require__){eval("var dP = __webpack_require__(7);\nvar anObject = __webpack_require__(5);\nvar getKeys = __webpack_require__(32);\n\nmodule.exports = __webpack_require__(8) ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtZHBzLmpzPzE0OTUiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBnZXRLZXlzID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpIHtcbiAgYW5PYmplY3QoTyk7XG4gIHZhciBrZXlzID0gZ2V0S2V5cyhQcm9wZXJ0aWVzKTtcbiAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICB2YXIgaSA9IDA7XG4gIHZhciBQO1xuICB3aGlsZSAobGVuZ3RoID4gaSkgZFAuZihPLCBQID0ga2V5c1tpKytdLCBQcm9wZXJ0aWVzW1BdKTtcbiAgcmV0dXJuIE87XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///87\n")},function(module,exports,__webpack_require__){eval("// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = __webpack_require__(15);\nvar gOPN = __webpack_require__(35).f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtZ29wbi1leHQuanM/N2JiYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBmYWxsYmFjayBmb3IgSUUxMSBidWdneSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB3aXRoIGlmcmFtZSBhbmQgd2luZG93XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyIGdPUE4gPSByZXF1aXJlKCcuL19vYmplY3QtZ29wbicpLmY7XG52YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxudmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXNcbiAgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW107XG5cbnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uIChpdCkge1xuICB0cnkge1xuICAgIHJldHVybiBnT1BOKGl0KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB3aW5kb3dOYW1lcy5zbGljZSgpO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCkge1xuICByZXR1cm4gd2luZG93TmFtZXMgJiYgdG9TdHJpbmcuY2FsbChpdCkgPT0gJ1tvYmplY3QgV2luZG93XScgPyBnZXRXaW5kb3dOYW1lcyhpdCkgOiBnT1BOKHRvSU9iamVjdChpdCkpO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///88\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 19.1.2.1 Object.assign(target, source, ...)\nvar getKeys = __webpack_require__(32);\nvar gOPS = __webpack_require__(47);\nvar pIE = __webpack_require__(45);\nvar toObject = __webpack_require__(16);\nvar IObject = __webpack_require__(44);\nvar $assign = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || __webpack_require__(2)(function () {\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line no-undef\n  var S = Symbol();\n  var K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function (k) { B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars\n  var T = toObject(target);\n  var aLen = arguments.length;\n  var index = 1;\n  var getSymbols = gOPS.f;\n  var isEnum = pIE.f;\n  while (aLen > index) {\n    var S = IObject(arguments[index++]);\n    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) if (isEnum.call(S, key = keys[j++])) T[key] = S[key];\n  } return T;\n} : $assign;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19vYmplY3QtYXNzaWduLmpzPzczMzMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8gMTkuMS4yLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSwgLi4uKVxudmFyIGdldEtleXMgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpO1xudmFyIGdPUFMgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wcycpO1xudmFyIHBJRSA9IHJlcXVpcmUoJy4vX29iamVjdC1waWUnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyIElPYmplY3QgPSByZXF1aXJlKCcuL19pb2JqZWN0Jyk7XG52YXIgJGFzc2lnbiA9IE9iamVjdC5hc3NpZ247XG5cbi8vIHNob3VsZCB3b3JrIHdpdGggc3ltYm9scyBhbmQgc2hvdWxkIGhhdmUgZGV0ZXJtaW5pc3RpYyBwcm9wZXJ0eSBvcmRlciAoVjggYnVnKVxubW9kdWxlLmV4cG9ydHMgPSAhJGFzc2lnbiB8fCByZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uICgpIHtcbiAgdmFyIEEgPSB7fTtcbiAgdmFyIEIgPSB7fTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gIHZhciBTID0gU3ltYm9sKCk7XG4gIHZhciBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JztcbiAgQVtTXSA9IDc7XG4gIEsuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24gKGspIHsgQltrXSA9IGs7IH0pO1xuICByZXR1cm4gJGFzc2lnbih7fSwgQSlbU10gIT0gNyB8fCBPYmplY3Qua2V5cygkYXNzaWduKHt9LCBCKSkuam9pbignJykgIT0gSztcbn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgdmFyIFQgPSB0b09iamVjdCh0YXJnZXQpO1xuICB2YXIgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gIHZhciBpbmRleCA9IDE7XG4gIHZhciBnZXRTeW1ib2xzID0gZ09QUy5mO1xuICB2YXIgaXNFbnVtID0gcElFLmY7XG4gIHdoaWxlIChhTGVuID4gaW5kZXgpIHtcbiAgICB2YXIgUyA9IElPYmplY3QoYXJndW1lbnRzW2luZGV4KytdKTtcbiAgICB2YXIga2V5cyA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUyk7XG4gICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIHZhciBqID0gMDtcbiAgICB2YXIga2V5O1xuICAgIHdoaWxlIChsZW5ndGggPiBqKSBpZiAoaXNFbnVtLmNhbGwoUywga2V5ID0ga2V5c1tqKytdKSkgVFtrZXldID0gU1trZXldO1xuICB9IHJldHVybiBUO1xufSA6ICRhc3NpZ247XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///89\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar aFunction = __webpack_require__(22);\nvar isObject = __webpack_require__(4);\nvar invoke = __webpack_require__(91);\nvar arraySlice = [].slice;\nvar factories = {};\n\nvar construct = function (F, len, args) {\n  if (!(len in factories)) {\n    for (var n = [], i = 0; i < len; i++) n[i] = 'a[' + i + ']';\n    // eslint-disable-next-line no-new-func\n    factories[len] = Function('F,a', 'return new F(' + n.join(',') + ')');\n  } return factories[len](F, args);\n};\n\nmodule.exports = Function.bind || function bind(that /* , ...args */) {\n  var fn = aFunction(this);\n  var partArgs = arraySlice.call(arguments, 1);\n  var bound = function (/* args... */) {\n    var args = partArgs.concat(arraySlice.call(arguments));\n    return this instanceof bound ? construct(fn, args.length, args) : invoke(fn, args, that);\n  };\n  if (isObject(fn.prototype)) bound.prototype = fn.prototype;\n  return bound;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19iaW5kLmpzP2YwYzEiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIGFGdW5jdGlvbiA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKTtcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIGludm9rZSA9IHJlcXVpcmUoJy4vX2ludm9rZScpO1xudmFyIGFycmF5U2xpY2UgPSBbXS5zbGljZTtcbnZhciBmYWN0b3JpZXMgPSB7fTtcblxudmFyIGNvbnN0cnVjdCA9IGZ1bmN0aW9uIChGLCBsZW4sIGFyZ3MpIHtcbiAgaWYgKCEobGVuIGluIGZhY3RvcmllcykpIHtcbiAgICBmb3IgKHZhciBuID0gW10sIGkgPSAwOyBpIDwgbGVuOyBpKyspIG5baV0gPSAnYVsnICsgaSArICddJztcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmV3LWZ1bmNcbiAgICBmYWN0b3JpZXNbbGVuXSA9IEZ1bmN0aW9uKCdGLGEnLCAncmV0dXJuIG5ldyBGKCcgKyBuLmpvaW4oJywnKSArICcpJyk7XG4gIH0gcmV0dXJuIGZhY3Rvcmllc1tsZW5dKEYsIGFyZ3MpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBGdW5jdGlvbi5iaW5kIHx8IGZ1bmN0aW9uIGJpbmQodGhhdCAvKiAsIC4uLmFyZ3MgKi8pIHtcbiAgdmFyIGZuID0gYUZ1bmN0aW9uKHRoaXMpO1xuICB2YXIgcGFydEFyZ3MgPSBhcnJheVNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgdmFyIGJvdW5kID0gZnVuY3Rpb24gKC8qIGFyZ3MuLi4gKi8pIHtcbiAgICB2YXIgYXJncyA9IHBhcnRBcmdzLmNvbmNhdChhcnJheVNsaWNlLmNhbGwoYXJndW1lbnRzKSk7XG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBib3VuZCA/IGNvbnN0cnVjdChmbiwgYXJncy5sZW5ndGgsIGFyZ3MpIDogaW52b2tlKGZuLCBhcmdzLCB0aGF0KTtcbiAgfTtcbiAgaWYgKGlzT2JqZWN0KGZuLnByb3RvdHlwZSkpIGJvdW5kLnByb3RvdHlwZSA9IGZuLnByb3RvdHlwZTtcbiAgcmV0dXJuIGJvdW5kO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///90\n")},function(module,exports){eval("// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function (fn, args, that) {\n  var un = that === undefined;\n  switch (args.length) {\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return fn.apply(that, args);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pbnZva2UuanM/MzFmNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBmYXN0IGFwcGx5LCBodHRwOi8vanNwZXJmLmxua2l0LmNvbS9mYXN0LWFwcGx5LzVcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGZuLCBhcmdzLCB0aGF0KSB7XG4gIHZhciB1biA9IHRoYXQgPT09IHVuZGVmaW5lZDtcbiAgc3dpdGNoIChhcmdzLmxlbmd0aCkge1xuICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKVxuICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTtcbiAgICBjYXNlIDE6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0pXG4gICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pO1xuICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSlcbiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSk7XG4gICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKVxuICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICBjYXNlIDQ6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pXG4gICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pO1xuICB9IHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmdzKTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///91\n")},function(module,exports,__webpack_require__){eval("var $parseInt = __webpack_require__(3).parseInt;\nvar $trim = __webpack_require__(49).trim;\nvar ws = __webpack_require__(65);\nvar hex = /^[-+]?0[xX]/;\n\nmodule.exports = $parseInt(ws + '08') !== 8 || $parseInt(ws + '0x16') !== 22 ? function parseInt(str, radix) {\n  var string = $trim(String(str), 3);\n  return $parseInt(string, (radix >>> 0) || (hex.test(string) ? 16 : 10));\n} : $parseInt;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19wYXJzZS1pbnQuanM/M2NhNSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgJHBhcnNlSW50ID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykucGFyc2VJbnQ7XG52YXIgJHRyaW0gPSByZXF1aXJlKCcuL19zdHJpbmctdHJpbScpLnRyaW07XG52YXIgd3MgPSByZXF1aXJlKCcuL19zdHJpbmctd3MnKTtcbnZhciBoZXggPSAvXlstK10/MFt4WF0vO1xuXG5tb2R1bGUuZXhwb3J0cyA9ICRwYXJzZUludCh3cyArICcwOCcpICE9PSA4IHx8ICRwYXJzZUludCh3cyArICcweDE2JykgIT09IDIyID8gZnVuY3Rpb24gcGFyc2VJbnQoc3RyLCByYWRpeCkge1xuICB2YXIgc3RyaW5nID0gJHRyaW0oU3RyaW5nKHN0ciksIDMpO1xuICByZXR1cm4gJHBhcnNlSW50KHN0cmluZywgKHJhZGl4ID4+PiAwKSB8fCAoaGV4LnRlc3Qoc3RyaW5nKSA/IDE2IDogMTApKTtcbn0gOiAkcGFyc2VJbnQ7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///92\n")},function(module,exports,__webpack_require__){eval("var $parseFloat = __webpack_require__(3).parseFloat;\nvar $trim = __webpack_require__(49).trim;\n\nmodule.exports = 1 / $parseFloat(__webpack_require__(65) + '-0') !== -Infinity ? function parseFloat(str) {\n  var string = $trim(String(str), 3);\n  var result = $parseFloat(string);\n  return result === 0 && string.charAt(0) == '-' ? -0 : result;\n} : $parseFloat;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19wYXJzZS1mbG9hdC5qcz9kNzUyIl0sInNvdXJjZXNDb250ZW50IjpbInZhciAkcGFyc2VGbG9hdCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpLnBhcnNlRmxvYXQ7XG52YXIgJHRyaW0gPSByZXF1aXJlKCcuL19zdHJpbmctdHJpbScpLnRyaW07XG5cbm1vZHVsZS5leHBvcnRzID0gMSAvICRwYXJzZUZsb2F0KHJlcXVpcmUoJy4vX3N0cmluZy13cycpICsgJy0wJykgIT09IC1JbmZpbml0eSA/IGZ1bmN0aW9uIHBhcnNlRmxvYXQoc3RyKSB7XG4gIHZhciBzdHJpbmcgPSAkdHJpbShTdHJpbmcoc3RyKSwgMyk7XG4gIHZhciByZXN1bHQgPSAkcGFyc2VGbG9hdChzdHJpbmcpO1xuICByZXR1cm4gcmVzdWx0ID09PSAwICYmIHN0cmluZy5jaGFyQXQoMCkgPT0gJy0nID8gLTAgOiByZXN1bHQ7XG59IDogJHBhcnNlRmxvYXQ7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///93\n")},function(module,exports,__webpack_require__){eval("var cof = __webpack_require__(23);\nmodule.exports = function (it, msg) {\n  if (typeof it != 'number' && cof(it) != 'Number') throw TypeError(msg);\n  return +it;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19hLW51bWJlci12YWx1ZS5qcz9iZWY5Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBjb2YgPSByZXF1aXJlKCcuL19jb2YnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCBtc2cpIHtcbiAgaWYgKHR5cGVvZiBpdCAhPSAnbnVtYmVyJyAmJiBjb2YoaXQpICE9ICdOdW1iZXInKSB0aHJvdyBUeXBlRXJyb3IobXNnKTtcbiAgcmV0dXJuICtpdDtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///94\n")},function(module,exports,__webpack_require__){eval("// 20.1.2.3 Number.isInteger(number)\nvar isObject = __webpack_require__(4);\nvar floor = Math.floor;\nmodule.exports = function isInteger(it) {\n  return !isObject(it) && isFinite(it) && floor(it) === it;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pcy1pbnRlZ2VyLmpzPzljMTIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMS4yLjMgTnVtYmVyLmlzSW50ZWdlcihudW1iZXIpXG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbnZhciBmbG9vciA9IE1hdGguZmxvb3I7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzSW50ZWdlcihpdCkge1xuICByZXR1cm4gIWlzT2JqZWN0KGl0KSAmJiBpc0Zpbml0ZShpdCkgJiYgZmxvb3IoaXQpID09PSBpdDtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///95\n")},function(module,exports){eval("// 20.2.2.20 Math.log1p(x)\nmodule.exports = Math.log1p || function log1p(x) {\n  return (x = +x) > -1e-8 && x < 1e-8 ? x - x * x / 2 : Math.log(1 + x);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19tYXRoLWxvZzFwLmpzP2Q2YzYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjIwIE1hdGgubG9nMXAoeClcbm1vZHVsZS5leHBvcnRzID0gTWF0aC5sb2cxcCB8fCBmdW5jdGlvbiBsb2cxcCh4KSB7XG4gIHJldHVybiAoeCA9ICt4KSA+IC0xZS04ICYmIHggPCAxZS04ID8geCAtIHggKiB4IC8gMiA6IE1hdGgubG9nKDEgKyB4KTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///96\n")},function(module,exports,__webpack_require__){eval("var toInteger = __webpack_require__(25);\nvar defined = __webpack_require__(24);\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19zdHJpbmctYXQuanM/MDJmNCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdG9JbnRlZ2VyID0gcmVxdWlyZSgnLi9fdG8taW50ZWdlcicpO1xudmFyIGRlZmluZWQgPSByZXF1aXJlKCcuL19kZWZpbmVkJyk7XG4vLyB0cnVlICAtPiBTdHJpbmcjYXRcbi8vIGZhbHNlIC0+IFN0cmluZyNjb2RlUG9pbnRBdFxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoVE9fU1RSSU5HKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGhhdCwgcG9zKSB7XG4gICAgdmFyIHMgPSBTdHJpbmcoZGVmaW5lZCh0aGF0KSk7XG4gICAgdmFyIGkgPSB0b0ludGVnZXIocG9zKTtcbiAgICB2YXIgbCA9IHMubGVuZ3RoO1xuICAgIHZhciBhLCBiO1xuICAgIGlmIChpIDwgMCB8fCBpID49IGwpIHJldHVybiBUT19TVFJJTkcgPyAnJyA6IHVuZGVmaW5lZDtcbiAgICBhID0gcy5jaGFyQ29kZUF0KGkpO1xuICAgIHJldHVybiBhIDwgMHhkODAwIHx8IGEgPiAweGRiZmYgfHwgaSArIDEgPT09IGwgfHwgKGIgPSBzLmNoYXJDb2RlQXQoaSArIDEpKSA8IDB4ZGMwMCB8fCBiID4gMHhkZmZmXG4gICAgICA/IFRPX1NUUklORyA/IHMuY2hhckF0KGkpIDogYVxuICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7XG4gIH07XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///97\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar create = __webpack_require__(34);\nvar descriptor = __webpack_require__(29);\nvar setToStringTag = __webpack_require__(37);\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\n__webpack_require__(14)(IteratorPrototype, __webpack_require__(6)('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pdGVyLWNyZWF0ZS5qcz80MWEwIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBjcmVhdGUgPSByZXF1aXJlKCcuL19vYmplY3QtY3JlYXRlJyk7XG52YXIgZGVzY3JpcHRvciA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcbnZhciBzZXRUb1N0cmluZ1RhZyA9IHJlcXVpcmUoJy4vX3NldC10by1zdHJpbmctdGFnJyk7XG52YXIgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTtcblxuLy8gMjUuMS4yLjEuMSAlSXRlcmF0b3JQcm90b3R5cGUlW0BAaXRlcmF0b3JdKClcbnJlcXVpcmUoJy4vX2hpZGUnKShJdGVyYXRvclByb3RvdHlwZSwgcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCkge1xuICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHsgbmV4dDogZGVzY3JpcHRvcigxLCBuZXh0KSB9KTtcbiAgc2V0VG9TdHJpbmdUYWcoQ29uc3RydWN0b3IsIE5BTUUgKyAnIEl0ZXJhdG9yJyk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///98\n")},function(module,exports,__webpack_require__){eval("// call something on iterator step with safe closing on error\nvar anObject = __webpack_require__(5);\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL19pdGVyLWNhbGwuanM/MWZhOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBjYWxsIHNvbWV0aGluZyBvbiBpdGVyYXRvciBzdGVwIHdpdGggc2FmZSBjbG9zaW5nIG9uIGVycm9yXG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIGVudHJpZXMpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZW50cmllcyA/IGZuKGFuT2JqZWN0KHZhbHVlKVswXSwgdmFsdWVbMV0pIDogZm4odmFsdWUpO1xuICAvLyA3LjQuNiBJdGVyYXRvckNsb3NlKGl0ZXJhdG9yLCBjb21wbGV0aW9uKVxuICB9IGNhdGNoIChlKSB7XG4gICAgdmFyIHJldCA9IGl0ZXJhdG9yWydyZXR1cm4nXTtcbiAgICBpZiAocmV0ICE9PSB1bmRlZmluZWQpIGFuT2JqZWN0KHJldC5jYWxsKGl0ZXJhdG9yKSk7XG4gICAgdGhyb3cgZTtcbiAgfVxufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///99\n")},function(module,exports,__webpack_require__){eval("var aFunction = __webpack_require__(22);\nvar toObject = __webpack_require__(16);\nvar IObject = __webpack_require__(44);\nvar toLength = __webpack_require__(10);\n\nmodule.exports = function (that, callbackfn, aLen, memo, isRight) {\n  aFunction(callbackfn);\n  var O = toObject(that);\n  var self = IObject(O);\n  var length = toLength(O.length);\n  var index = isRight ? length - 1 : 0;\n  var i = isRight ? -1 : 1;\n  if (aLen < 2) for (;;) {\n    if (index in self) {\n      memo = self[index];\n      index += i;\n      break;\n    }\n    index += i;\n    if (isRight ? index < 0 : length <= index) {\n      throw TypeError('Reduce of empty array with no initial value');\n    }\n  }\n  for (;isRight ? index >= 0 : length > index; index += i) if (index in self) {\n    memo = callbackfn(memo, self[index], index, O);\n  }\n  return memo;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fYXJyYXktcmVkdWNlLmpzPzdiMjMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGFGdW5jdGlvbiA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyIElPYmplY3QgPSByZXF1aXJlKCcuL19pb2JqZWN0Jyk7XG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodGhhdCwgY2FsbGJhY2tmbiwgYUxlbiwgbWVtbywgaXNSaWdodCkge1xuICBhRnVuY3Rpb24oY2FsbGJhY2tmbik7XG4gIHZhciBPID0gdG9PYmplY3QodGhhdCk7XG4gIHZhciBzZWxmID0gSU9iamVjdChPKTtcbiAgdmFyIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKTtcbiAgdmFyIGluZGV4ID0gaXNSaWdodCA/IGxlbmd0aCAtIDEgOiAwO1xuICB2YXIgaSA9IGlzUmlnaHQgPyAtMSA6IDE7XG4gIGlmIChhTGVuIDwgMikgZm9yICg7Oykge1xuICAgIGlmIChpbmRleCBpbiBzZWxmKSB7XG4gICAgICBtZW1vID0gc2VsZltpbmRleF07XG4gICAgICBpbmRleCArPSBpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGluZGV4ICs9IGk7XG4gICAgaWYgKGlzUmlnaHQgPyBpbmRleCA8IDAgOiBsZW5ndGggPD0gaW5kZXgpIHtcbiAgICAgIHRocm93IFR5cGVFcnJvcignUmVkdWNlIG9mIGVtcHR5IGFycmF5IHdpdGggbm8gaW5pdGlhbCB2YWx1ZScpO1xuICAgIH1cbiAgfVxuICBmb3IgKDtpc1JpZ2h0ID8gaW5kZXggPj0gMCA6IGxlbmd0aCA+IGluZGV4OyBpbmRleCArPSBpKSBpZiAoaW5kZXggaW4gc2VsZikge1xuICAgIG1lbW8gPSBjYWxsYmFja2ZuKG1lbW8sIHNlbGZbaW5kZXhdLCBpbmRleCwgTyk7XG4gIH1cbiAgcmV0dXJuIG1lbW87XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///100\n")},function(module,exports,__webpack_require__){"use strict";eval("// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)\n\nvar toObject = __webpack_require__(16);\nvar toAbsoluteIndex = __webpack_require__(33);\nvar toLength = __webpack_require__(10);\n\nmodule.exports = [].copyWithin || function copyWithin(target /* = 0 */, start /* = 0, end = @length */) {\n  var O = toObject(this);\n  var len = toLength(O.length);\n  var to = toAbsoluteIndex(target, len);\n  var from = toAbsoluteIndex(start, len);\n  var end = arguments.length > 2 ? arguments[2] : undefined;\n  var count = Math.min((end === undefined ? len : toAbsoluteIndex(end, len)) - from, len - to);\n  var inc = 1;\n  if (from < to && to < from + count) {\n    inc = -1;\n    from += count - 1;\n    to += count - 1;\n  }\n  while (count-- > 0) {\n    if (from in O) O[to] = O[from];\n    else delete O[to];\n    to += inc;\n    from += inc;\n  } return O;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fYXJyYXktY29weS13aXRoaW4uanM/YmE5MiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMi4xLjMuMyBBcnJheS5wcm90b3R5cGUuY29weVdpdGhpbih0YXJnZXQsIHN0YXJ0LCBlbmQgPSB0aGlzLmxlbmd0aClcbid1c2Ugc3RyaWN0JztcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyIHRvQWJzb2x1dGVJbmRleCA9IHJlcXVpcmUoJy4vX3RvLWFic29sdXRlLWluZGV4Jyk7XG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBbXS5jb3B5V2l0aGluIHx8IGZ1bmN0aW9uIGNvcHlXaXRoaW4odGFyZ2V0IC8qID0gMCAqLywgc3RhcnQgLyogPSAwLCBlbmQgPSBAbGVuZ3RoICovKSB7XG4gIHZhciBPID0gdG9PYmplY3QodGhpcyk7XG4gIHZhciBsZW4gPSB0b0xlbmd0aChPLmxlbmd0aCk7XG4gIHZhciB0byA9IHRvQWJzb2x1dGVJbmRleCh0YXJnZXQsIGxlbik7XG4gIHZhciBmcm9tID0gdG9BYnNvbHV0ZUluZGV4KHN0YXJ0LCBsZW4pO1xuICB2YXIgZW5kID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7XG4gIHZhciBjb3VudCA9IE1hdGgubWluKChlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IHRvQWJzb2x1dGVJbmRleChlbmQsIGxlbikpIC0gZnJvbSwgbGVuIC0gdG8pO1xuICB2YXIgaW5jID0gMTtcbiAgaWYgKGZyb20gPCB0byAmJiB0byA8IGZyb20gKyBjb3VudCkge1xuICAgIGluYyA9IC0xO1xuICAgIGZyb20gKz0gY291bnQgLSAxO1xuICAgIHRvICs9IGNvdW50IC0gMTtcbiAgfVxuICB3aGlsZSAoY291bnQtLSA+IDApIHtcbiAgICBpZiAoZnJvbSBpbiBPKSBPW3RvXSA9IE9bZnJvbV07XG4gICAgZWxzZSBkZWxldGUgT1t0b107XG4gICAgdG8gKz0gaW5jO1xuICAgIGZyb20gKz0gaW5jO1xuICB9IHJldHVybiBPO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///101\n")},function(module,exports){eval("module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9faXRlci1zdGVwLmpzP2Q1M2IiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZG9uZSwgdmFsdWUpIHtcbiAgcmV0dXJuIHsgdmFsdWU6IHZhbHVlLCBkb25lOiAhIWRvbmUgfTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///102\n")},function(module,exports,__webpack_require__){eval("// 21.2.5.3 get RegExp.prototype.flags()\nif (__webpack_require__(8) && /./g.flags != 'g') __webpack_require__(7).f(RegExp.prototype, 'flags', {\n  configurable: true,\n  get: __webpack_require__(79)\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVnZXhwLmZsYWdzLmpzPzM4NDYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjEuMi41LjMgZ2V0IFJlZ0V4cC5wcm90b3R5cGUuZmxhZ3MoKVxuaWYgKHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgJiYgLy4vZy5mbGFncyAhPSAnZycpIHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmYoUmVnRXhwLnByb3RvdHlwZSwgJ2ZsYWdzJywge1xuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGdldDogcmVxdWlyZSgnLi9fZmxhZ3MnKVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///103\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar LIBRARY = __webpack_require__(31);\nvar global = __webpack_require__(3);\nvar ctx = __webpack_require__(21);\nvar classof = __webpack_require__(48);\nvar $export = __webpack_require__(1);\nvar isObject = __webpack_require__(4);\nvar aFunction = __webpack_require__(22);\nvar anInstance = __webpack_require__(41);\nvar forOf = __webpack_require__(52);\nvar speciesConstructor = __webpack_require__(53);\nvar task = __webpack_require__(80).set;\nvar microtask = __webpack_require__(229)();\nvar newPromiseCapabilityModule = __webpack_require__(105);\nvar perform = __webpack_require__(230);\nvar userAgent = __webpack_require__(54);\nvar promiseResolve = __webpack_require__(106);\nvar PROMISE = 'Promise';\nvar TypeError = global.TypeError;\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8 || '';\nvar $Promise = global[PROMISE];\nvar isNode = classof(process) == 'process';\nvar empty = function () { /* empty */ };\nvar Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;\nvar newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;\n\nvar USE_NATIVE = !!function () {\n  try {\n    // correct subclassing with @@species support\n    var promise = $Promise.resolve(1);\n    var FakePromise = (promise.constructor = {})[__webpack_require__(6)('species')] = function (exec) {\n      exec(empty, empty);\n    };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function')\n      && promise.then(empty) instanceof FakePromise\n      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n      // we can't detect it synchronously, so just check versions\n      && v8.indexOf('6.6') !== 0\n      && userAgent.indexOf('Chrome/66') === -1;\n  } catch (e) { /* empty */ }\n}();\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar notify = function (promise, isReject) {\n  if (promise._n) return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function () {\n    var value = promise._v;\n    var ok = promise._s == 1;\n    var i = 0;\n    var run = function (reaction) {\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (promise._h == 2) onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // may throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (e) {\n        if (domain && !exited) domain.exit();\n        reject(e);\n      }\n    };\n    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if (isReject && !promise._h) onUnhandled(promise);\n  });\n};\nvar onUnhandled = function (promise) {\n  task.call(global, function () {\n    var value = promise._v;\n    var unhandled = isUnhandled(promise);\n    var result, handler, console;\n    if (unhandled) {\n      result = perform(function () {\n        if (isNode) {\n          process.emit('unhandledRejection', value, promise);\n        } else if (handler = global.onunhandledrejection) {\n          handler({ promise: promise, reason: value });\n        } else if ((console = global.console) && console.error) {\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if (unhandled && result.e) throw result.v;\n  });\n};\nvar isUnhandled = function (promise) {\n  return promise._h !== 1 && (promise._a || promise._c).length === 0;\n};\nvar onHandleUnhandled = function (promise) {\n  task.call(global, function () {\n    var handler;\n    if (isNode) {\n      process.emit('rejectionHandled', promise);\n    } else if (handler = global.onrejectionhandled) {\n      handler({ promise: promise, reason: promise._v });\n    }\n  });\n};\nvar $reject = function (value) {\n  var promise = this;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if (!promise._a) promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function (value) {\n  var promise = this;\n  var then;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if (promise === value) throw TypeError(\"Promise can't be resolved itself\");\n    if (then = isThenable(value)) {\n      microtask(function () {\n        var wrapper = { _w: promise, _d: false }; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch (e) {\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch (e) {\n    $reject.call({ _w: promise, _d: false }, e); // wrap\n  }\n};\n\n// constructor polyfill\nif (!USE_NATIVE) {\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor) {\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch (err) {\n      $reject.call(this, err);\n    }\n  };\n  // eslint-disable-next-line no-unused-vars\n  Internal = function Promise(executor) {\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = __webpack_require__(42)($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected) {\n      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if (this._a) this._a.push(reaction);\n      if (this._s) notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject = ctx($reject, promise, 1);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === $Promise || C === Wrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });\n__webpack_require__(37)($Promise, PROMISE);\n__webpack_require__(40)(PROMISE);\nWrapper = __webpack_require__(9)[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    var $$reject = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x) {\n    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && __webpack_require__(50)(function (iter) {\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var values = [];\n      var index = 0;\n      var remaining = 1;\n      forOf(iterable, false, function (promise) {\n        var $index = index++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      forOf(iterable, false, function (promise) {\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucHJvbWlzZS5qcz81NTFjIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBMSUJSQVJZID0gcmVxdWlyZSgnLi9fbGlicmFyeScpO1xudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGN0eCA9IHJlcXVpcmUoJy4vX2N0eCcpO1xudmFyIGNsYXNzb2YgPSByZXF1aXJlKCcuL19jbGFzc29mJyk7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpO1xudmFyIGFuSW5zdGFuY2UgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpO1xudmFyIGZvck9mID0gcmVxdWlyZSgnLi9fZm9yLW9mJyk7XG52YXIgc3BlY2llc0NvbnN0cnVjdG9yID0gcmVxdWlyZSgnLi9fc3BlY2llcy1jb25zdHJ1Y3RvcicpO1xudmFyIHRhc2sgPSByZXF1aXJlKCcuL190YXNrJykuc2V0O1xudmFyIG1pY3JvdGFzayA9IHJlcXVpcmUoJy4vX21pY3JvdGFzaycpKCk7XG52YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHlNb2R1bGUgPSByZXF1aXJlKCcuL19uZXctcHJvbWlzZS1jYXBhYmlsaXR5Jyk7XG52YXIgcGVyZm9ybSA9IHJlcXVpcmUoJy4vX3BlcmZvcm0nKTtcbnZhciB1c2VyQWdlbnQgPSByZXF1aXJlKCcuL191c2VyLWFnZW50Jyk7XG52YXIgcHJvbWlzZVJlc29sdmUgPSByZXF1aXJlKCcuL19wcm9taXNlLXJlc29sdmUnKTtcbnZhciBQUk9NSVNFID0gJ1Byb21pc2UnO1xudmFyIFR5cGVFcnJvciA9IGdsb2JhbC5UeXBlRXJyb3I7XG52YXIgcHJvY2VzcyA9IGdsb2JhbC5wcm9jZXNzO1xudmFyIHZlcnNpb25zID0gcHJvY2VzcyAmJiBwcm9jZXNzLnZlcnNpb25zO1xudmFyIHY4ID0gdmVyc2lvbnMgJiYgdmVyc2lvbnMudjggfHwgJyc7XG52YXIgJFByb21pc2UgPSBnbG9iYWxbUFJPTUlTRV07XG52YXIgaXNOb2RlID0gY2xhc3NvZihwcm9jZXNzKSA9PSAncHJvY2Vzcyc7XG52YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7IC8qIGVtcHR5ICovIH07XG52YXIgSW50ZXJuYWwsIG5ld0dlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgT3duUHJvbWlzZUNhcGFiaWxpdHksIFdyYXBwZXI7XG52YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSBuZXdHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eU1vZHVsZS5mO1xuXG52YXIgVVNFX05BVElWRSA9ICEhZnVuY3Rpb24gKCkge1xuICB0cnkge1xuICAgIC8vIGNvcnJlY3Qgc3ViY2xhc3Npbmcgd2l0aCBAQHNwZWNpZXMgc3VwcG9ydFxuICAgIHZhciBwcm9taXNlID0gJFByb21pc2UucmVzb2x2ZSgxKTtcbiAgICB2YXIgRmFrZVByb21pc2UgPSAocHJvbWlzZS5jb25zdHJ1Y3RvciA9IHt9KVtyZXF1aXJlKCcuL193a3MnKSgnc3BlY2llcycpXSA9IGZ1bmN0aW9uIChleGVjKSB7XG4gICAgICBleGVjKGVtcHR5LCBlbXB0eSk7XG4gICAgfTtcbiAgICAvLyB1bmhhbmRsZWQgcmVqZWN0aW9ucyB0cmFja2luZyBzdXBwb3J0LCBOb2RlSlMgUHJvbWlzZSB3aXRob3V0IGl0IGZhaWxzIEBAc3BlY2llcyB0ZXN0XG4gICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKVxuICAgICAgJiYgcHJvbWlzZS50aGVuKGVtcHR5KSBpbnN0YW5jZW9mIEZha2VQcm9taXNlXG4gICAgICAvLyB2OCA2LjYgKE5vZGUgMTAgYW5kIENocm9tZSA2NikgaGF2ZSBhIGJ1ZyB3aXRoIHJlc29sdmluZyBjdXN0b20gdGhlbmFibGVzXG4gICAgICAvLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD04MzA1NjVcbiAgICAgIC8vIHdlIGNhbid0IGRldGVjdCBpdCBzeW5jaHJvbm91c2x5LCBzbyBqdXN0IGNoZWNrIHZlcnNpb25zXG4gICAgICAmJiB2OC5pbmRleE9mKCc2LjYnKSAhPT0gMFxuICAgICAgJiYgdXNlckFnZW50LmluZGV4T2YoJ0Nocm9tZS82NicpID09PSAtMTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG59KCk7XG5cbi8vIGhlbHBlcnNcbnZhciBpc1RoZW5hYmxlID0gZnVuY3Rpb24gKGl0KSB7XG4gIHZhciB0aGVuO1xuICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7XG59O1xudmFyIG5vdGlmeSA9IGZ1bmN0aW9uIChwcm9taXNlLCBpc1JlamVjdCkge1xuICBpZiAocHJvbWlzZS5fbikgcmV0dXJuO1xuICBwcm9taXNlLl9uID0gdHJ1ZTtcbiAgdmFyIGNoYWluID0gcHJvbWlzZS5fYztcbiAgbWljcm90YXNrKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92O1xuICAgIHZhciBvayA9IHByb21pc2UuX3MgPT0gMTtcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uIChyZWFjdGlvbikge1xuICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbDtcbiAgICAgIHZhciByZXNvbHZlID0gcmVhY3Rpb24ucmVzb2x2ZTtcbiAgICAgIHZhciByZWplY3QgPSByZWFjdGlvbi5yZWplY3Q7XG4gICAgICB2YXIgZG9tYWluID0gcmVhY3Rpb24uZG9tYWluO1xuICAgICAgdmFyIHJlc3VsdCwgdGhlbiwgZXhpdGVkO1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgICBpZiAoIW9rKSB7XG4gICAgICAgICAgICBpZiAocHJvbWlzZS5faCA9PSAyKSBvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTtcbiAgICAgICAgICAgIHByb21pc2UuX2ggPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaGFuZGxlciA9PT0gdHJ1ZSkgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZG9tYWluKSBkb21haW4uZW50ZXIoKTtcbiAgICAgICAgICAgIHJlc3VsdCA9IGhhbmRsZXIodmFsdWUpOyAvLyBtYXkgdGhyb3dcbiAgICAgICAgICAgIGlmIChkb21haW4pIHtcbiAgICAgICAgICAgICAgZG9tYWluLmV4aXQoKTtcbiAgICAgICAgICAgICAgZXhpdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJlc3VsdCA9PT0gcmVhY3Rpb24ucHJvbWlzZSkge1xuICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRoZW4gPSBpc1RoZW5hYmxlKHJlc3VsdCkpIHtcbiAgICAgICAgICAgIHRoZW4uY2FsbChyZXN1bHQsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSBlbHNlIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChkb21haW4gJiYgIWV4aXRlZCkgZG9tYWluLmV4aXQoKTtcbiAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH07XG4gICAgd2hpbGUgKGNoYWluLmxlbmd0aCA+IGkpIHJ1bihjaGFpbltpKytdKTsgLy8gdmFyaWFibGUgbGVuZ3RoIC0gY2FuJ3QgdXNlIGZvckVhY2hcbiAgICBwcm9taXNlLl9jID0gW107XG4gICAgcHJvbWlzZS5fbiA9IGZhbHNlO1xuICAgIGlmIChpc1JlamVjdCAmJiAhcHJvbWlzZS5faCkgb25VbmhhbmRsZWQocHJvbWlzZSk7XG4gIH0pO1xufTtcbnZhciBvblVuaGFuZGxlZCA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92O1xuICAgIHZhciB1bmhhbmRsZWQgPSBpc1VuaGFuZGxlZChwcm9taXNlKTtcbiAgICB2YXIgcmVzdWx0LCBoYW5kbGVyLCBjb25zb2xlO1xuICAgIGlmICh1bmhhbmRsZWQpIHtcbiAgICAgIHJlc3VsdCA9IHBlcmZvcm0oZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoaXNOb2RlKSB7XG4gICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlciA9IGdsb2JhbC5vbnVuaGFuZGxlZHJlamVjdGlvbikge1xuICAgICAgICAgIGhhbmRsZXIoeyBwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHZhbHVlIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKChjb25zb2xlID0gZ2xvYmFsLmNvbnNvbGUpICYmIGNvbnNvbGUuZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24nLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gQnJvd3NlcnMgc2hvdWxkIG5vdCB0cmlnZ2VyIGByZWplY3Rpb25IYW5kbGVkYCBldmVudCBpZiBpdCB3YXMgaGFuZGxlZCBoZXJlLCBOb2RlSlMgLSBzaG91bGRcbiAgICAgIHByb21pc2UuX2ggPSBpc05vZGUgfHwgaXNVbmhhbmRsZWQocHJvbWlzZSkgPyAyIDogMTtcbiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHVuaGFuZGxlZCAmJiByZXN1bHQuZSkgdGhyb3cgcmVzdWx0LnY7XG4gIH0pO1xufTtcbnZhciBpc1VuaGFuZGxlZCA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gIHJldHVybiBwcm9taXNlLl9oICE9PSAxICYmIChwcm9taXNlLl9hIHx8IHByb21pc2UuX2MpLmxlbmd0aCA9PT0gMDtcbn07XG52YXIgb25IYW5kbGVVbmhhbmRsZWQgPSBmdW5jdGlvbiAocHJvbWlzZSkge1xuICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGhhbmRsZXI7XG4gICAgaWYgKGlzTm9kZSkge1xuICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7XG4gICAgfSBlbHNlIGlmIChoYW5kbGVyID0gZ2xvYmFsLm9ucmVqZWN0aW9uaGFuZGxlZCkge1xuICAgICAgaGFuZGxlcih7IHByb21pc2U6IHByb21pc2UsIHJlYXNvbjogcHJvbWlzZS5fdiB9KTtcbiAgICB9XG4gIH0pO1xufTtcbnZhciAkcmVqZWN0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gIHZhciBwcm9taXNlID0gdGhpcztcbiAgaWYgKHByb21pc2UuX2QpIHJldHVybjtcbiAgcHJvbWlzZS5fZCA9IHRydWU7XG4gIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcFxuICBwcm9taXNlLl92ID0gdmFsdWU7XG4gIHByb21pc2UuX3MgPSAyO1xuICBpZiAoIXByb21pc2UuX2EpIHByb21pc2UuX2EgPSBwcm9taXNlLl9jLnNsaWNlKCk7XG4gIG5vdGlmeShwcm9taXNlLCB0cnVlKTtcbn07XG52YXIgJHJlc29sdmUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgdmFyIHByb21pc2UgPSB0aGlzO1xuICB2YXIgdGhlbjtcbiAgaWYgKHByb21pc2UuX2QpIHJldHVybjtcbiAgcHJvbWlzZS5fZCA9IHRydWU7XG4gIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcFxuICB0cnkge1xuICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkgdGhyb3cgVHlwZUVycm9yKFwiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGZcIik7XG4gICAgaWYgKHRoZW4gPSBpc1RoZW5hYmxlKHZhbHVlKSkge1xuICAgICAgbWljcm90YXNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSB7IF93OiBwcm9taXNlLCBfZDogZmFsc2UgfTsgLy8gd3JhcFxuICAgICAgICB0cnkge1xuICAgICAgICAgIHRoZW4uY2FsbCh2YWx1ZSwgY3R4KCRyZXNvbHZlLCB3cmFwcGVyLCAxKSwgY3R4KCRyZWplY3QsIHdyYXBwZXIsIDEpKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByb21pc2UuX3YgPSB2YWx1ZTtcbiAgICAgIHByb21pc2UuX3MgPSAxO1xuICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAkcmVqZWN0LmNhbGwoeyBfdzogcHJvbWlzZSwgX2Q6IGZhbHNlIH0sIGUpOyAvLyB3cmFwXG4gIH1cbn07XG5cbi8vIGNvbnN0cnVjdG9yIHBvbHlmaWxsXG5pZiAoIVVTRV9OQVRJVkUpIHtcbiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcilcbiAgJFByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKSB7XG4gICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7XG4gICAgYUZ1bmN0aW9uKGV4ZWN1dG9yKTtcbiAgICBJbnRlcm5hbC5jYWxsKHRoaXMpO1xuICAgIHRyeSB7XG4gICAgICBleGVjdXRvcihjdHgoJHJlc29sdmUsIHRoaXMsIDEpLCBjdHgoJHJlamVjdCwgdGhpcywgMSkpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgJHJlamVjdC5jYWxsKHRoaXMsIGVycik7XG4gICAgfVxuICB9O1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKSB7XG4gICAgdGhpcy5fYyA9IFtdOyAgICAgICAgICAgICAvLyA8LSBhd2FpdGluZyByZWFjdGlvbnNcbiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zXG4gICAgdGhpcy5fcyA9IDA7ICAgICAgICAgICAgICAvLyA8LSBzdGF0ZVxuICAgIHRoaXMuX2QgPSBmYWxzZTsgICAgICAgICAgLy8gPC0gZG9uZVxuICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWVcbiAgICB0aGlzLl9oID0gMDsgICAgICAgICAgICAgIC8vIDwtIHJlamVjdGlvbiBzdGF0ZSwgMCAtIGRlZmF1bHQsIDEgLSBoYW5kbGVkLCAyIC0gdW5oYW5kbGVkXG4gICAgdGhpcy5fbiA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBub3RpZnlcbiAgfTtcbiAgSW50ZXJuYWwucHJvdG90eXBlID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUtYWxsJykoJFByb21pc2UucHJvdG90eXBlLCB7XG4gICAgLy8gMjUuNC41LjMgUHJvbWlzZS5wcm90b3R5cGUudGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZClcbiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG4gICAgICB2YXIgcmVhY3Rpb24gPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgJFByb21pc2UpKTtcbiAgICAgIHJlYWN0aW9uLm9rID0gdHlwZW9mIG9uRnVsZmlsbGVkID09ICdmdW5jdGlvbicgPyBvbkZ1bGZpbGxlZCA6IHRydWU7XG4gICAgICByZWFjdGlvbi5mYWlsID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT0gJ2Z1bmN0aW9uJyAmJiBvblJlamVjdGVkO1xuICAgICAgcmVhY3Rpb24uZG9tYWluID0gaXNOb2RlID8gcHJvY2Vzcy5kb21haW4gOiB1bmRlZmluZWQ7XG4gICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pO1xuICAgICAgaWYgKHRoaXMuX2EpIHRoaXMuX2EucHVzaChyZWFjdGlvbik7XG4gICAgICBpZiAodGhpcy5fcykgbm90aWZ5KHRoaXMsIGZhbHNlKTtcbiAgICAgIHJldHVybiByZWFjdGlvbi5wcm9taXNlO1xuICAgIH0sXG4gICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZClcbiAgICAnY2F0Y2gnOiBmdW5jdGlvbiAob25SZWplY3RlZCkge1xuICAgICAgcmV0dXJuIHRoaXMudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpO1xuICAgIH1cbiAgfSk7XG4gIE93blByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBwcm9taXNlID0gbmV3IEludGVybmFsKCk7XG4gICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTtcbiAgICB0aGlzLnJlc29sdmUgPSBjdHgoJHJlc29sdmUsIHByb21pc2UsIDEpO1xuICAgIHRoaXMucmVqZWN0ID0gY3R4KCRyZWplY3QsIHByb21pc2UsIDEpO1xuICB9O1xuICBuZXdQcm9taXNlQ2FwYWJpbGl0eU1vZHVsZS5mID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbiAoQykge1xuICAgIHJldHVybiBDID09PSAkUHJvbWlzZSB8fCBDID09PSBXcmFwcGVyXG4gICAgICA/IG5ldyBPd25Qcm9taXNlQ2FwYWJpbGl0eShDKVxuICAgICAgOiBuZXdHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkoQyk7XG4gIH07XG59XG5cbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHsgUHJvbWlzZTogJFByb21pc2UgfSk7XG5yZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpKCRQcm9taXNlLCBQUk9NSVNFKTtcbnJlcXVpcmUoJy4vX3NldC1zcGVjaWVzJykoUFJPTUlTRSk7XG5XcmFwcGVyID0gcmVxdWlyZSgnLi9fY29yZScpW1BST01JU0VdO1xuXG4vLyBzdGF0aWNzXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7XG4gIC8vIDI1LjQuNC41IFByb21pc2UucmVqZWN0KHIpXG4gIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHIpIHtcbiAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpO1xuICAgIHZhciAkJHJlamVjdCA9IGNhcGFiaWxpdHkucmVqZWN0O1xuICAgICQkcmVqZWN0KHIpO1xuICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7XG4gIH1cbn0pO1xuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHtcbiAgLy8gMjUuNC40LjYgUHJvbWlzZS5yZXNvbHZlKHgpXG4gIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoeCkge1xuICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZShMSUJSQVJZICYmIHRoaXMgPT09IFdyYXBwZXIgPyAkUHJvbWlzZSA6IHRoaXMsIHgpO1xuICB9XG59KTtcbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIShVU0VfTkFUSVZFICYmIHJlcXVpcmUoJy4vX2l0ZXItZGV0ZWN0JykoZnVuY3Rpb24gKGl0ZXIpIHtcbiAgJFByb21pc2UuYWxsKGl0ZXIpWydjYXRjaCddKGVtcHR5KTtcbn0pKSwgUFJPTUlTRSwge1xuICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSlcbiAgYWxsOiBmdW5jdGlvbiBhbGwoaXRlcmFibGUpIHtcbiAgICB2YXIgQyA9IHRoaXM7XG4gICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKTtcbiAgICB2YXIgcmVzb2x2ZSA9IGNhcGFiaWxpdHkucmVzb2x2ZTtcbiAgICB2YXIgcmVqZWN0ID0gY2FwYWJpbGl0eS5yZWplY3Q7XG4gICAgdmFyIHJlc3VsdCA9IHBlcmZvcm0oZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgIHZhciByZW1haW5pbmcgPSAxO1xuICAgICAgZm9yT2YoaXRlcmFibGUsIGZhbHNlLCBmdW5jdGlvbiAocHJvbWlzZSkge1xuICAgICAgICB2YXIgJGluZGV4ID0gaW5kZXgrKztcbiAgICAgICAgdmFyIGFscmVhZHlDYWxsZWQgPSBmYWxzZTtcbiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTtcbiAgICAgICAgcmVtYWluaW5nKys7XG4gICAgICAgIEMucmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIGlmIChhbHJlYWR5Q2FsbGVkKSByZXR1cm47XG4gICAgICAgICAgYWxyZWFkeUNhbGxlZCA9IHRydWU7XG4gICAgICAgICAgdmFsdWVzWyRpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgIH0sIHJlamVjdCk7XG4gICAgICB9KTtcbiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTtcbiAgICB9KTtcbiAgICBpZiAocmVzdWx0LmUpIHJlamVjdChyZXN1bHQudik7XG4gICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTtcbiAgfSxcbiAgLy8gMjUuNC40LjQgUHJvbWlzZS5yYWNlKGl0ZXJhYmxlKVxuICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKSB7XG4gICAgdmFyIEMgPSB0aGlzO1xuICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQyk7XG4gICAgdmFyIHJlamVjdCA9IGNhcGFiaWxpdHkucmVqZWN0O1xuICAgIHZhciByZXN1bHQgPSBwZXJmb3JtKGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24gKHByb21pc2UpIHtcbiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaWYgKHJlc3VsdC5lKSByZWplY3QocmVzdWx0LnYpO1xuICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///104\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 25.4.1.5 NewPromiseCapability(C)\nvar aFunction = __webpack_require__(22);\n\nfunction PromiseCapability(C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n}\n\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fbmV3LXByb21pc2UtY2FwYWJpbGl0eS5qcz9hNWI4Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIDI1LjQuMS41IE5ld1Byb21pc2VDYXBhYmlsaXR5KEMpXG52YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpO1xuXG5mdW5jdGlvbiBQcm9taXNlQ2FwYWJpbGl0eShDKSB7XG4gIHZhciByZXNvbHZlLCByZWplY3Q7XG4gIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uICgkJHJlc29sdmUsICQkcmVqZWN0KSB7XG4gICAgaWYgKHJlc29sdmUgIT09IHVuZGVmaW5lZCB8fCByZWplY3QgIT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCdCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvcicpO1xuICAgIHJlc29sdmUgPSAkJHJlc29sdmU7XG4gICAgcmVqZWN0ID0gJCRyZWplY3Q7XG4gIH0pO1xuICB0aGlzLnJlc29sdmUgPSBhRnVuY3Rpb24ocmVzb2x2ZSk7XG4gIHRoaXMucmVqZWN0ID0gYUZ1bmN0aW9uKHJlamVjdCk7XG59XG5cbm1vZHVsZS5leHBvcnRzLmYgPSBmdW5jdGlvbiAoQykge1xuICByZXR1cm4gbmV3IFByb21pc2VDYXBhYmlsaXR5KEMpO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///105\n")},function(module,exports,__webpack_require__){eval("var anObject = __webpack_require__(5);\nvar isObject = __webpack_require__(4);\nvar newPromiseCapability = __webpack_require__(105);\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fcHJvbWlzZS1yZXNvbHZlLmpzP2JjYWEiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IHJlcXVpcmUoJy4vX25ldy1wcm9taXNlLWNhcGFiaWxpdHknKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQywgeCkge1xuICBhbk9iamVjdChDKTtcbiAgaWYgKGlzT2JqZWN0KHgpICYmIHguY29uc3RydWN0b3IgPT09IEMpIHJldHVybiB4O1xuICB2YXIgcHJvbWlzZUNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eS5mKEMpO1xuICB2YXIgcmVzb2x2ZSA9IHByb21pc2VDYXBhYmlsaXR5LnJlc29sdmU7XG4gIHJlc29sdmUoeCk7XG4gIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eS5wcm9taXNlO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///106\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar dP = __webpack_require__(7).f;\nvar create = __webpack_require__(34);\nvar redefineAll = __webpack_require__(42);\nvar ctx = __webpack_require__(21);\nvar anInstance = __webpack_require__(41);\nvar forOf = __webpack_require__(52);\nvar $iterDefine = __webpack_require__(70);\nvar step = __webpack_require__(102);\nvar setSpecies = __webpack_require__(40);\nvar DESCRIPTORS = __webpack_require__(8);\nvar fastKey = __webpack_require__(28).fastKey;\nvar validate = __webpack_require__(43);\nvar SIZE = DESCRIPTORS ? '_s' : 'size';\n\nvar getEntry = function (that, key) {\n  // fast case\n  var index = fastKey(key);\n  var entry;\n  if (index !== 'F') return that._i[index];\n  // frozen object case\n  for (entry = that._f; entry; entry = entry.n) {\n    if (entry.k == key) return entry;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, NAME, '_i');\n      that._t = NAME;         // collection type\n      that._i = create(null); // index\n      that._f = undefined;    // first entry\n      that._l = undefined;    // last entry\n      that[SIZE] = 0;         // size\n      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear() {\n        for (var that = validate(this, NAME), data = that._i, entry = that._f; entry; entry = entry.n) {\n          entry.r = true;\n          if (entry.p) entry.p = entry.p.n = undefined;\n          delete data[entry.i];\n        }\n        that._f = that._l = undefined;\n        that[SIZE] = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function (key) {\n        var that = validate(this, NAME);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.n;\n          var prev = entry.p;\n          delete that._i[entry.i];\n          entry.r = true;\n          if (prev) prev.n = next;\n          if (next) next.p = prev;\n          if (that._f == entry) that._f = next;\n          if (that._l == entry) that._l = prev;\n          that[SIZE]--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        validate(this, NAME);\n        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);\n        var entry;\n        while (entry = entry ? entry.n : this._f) {\n          f(entry.v, entry.k, this);\n          // revert to the last existing entry\n          while (entry && entry.r) entry = entry.p;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key) {\n        return !!getEntry(validate(this, NAME), key);\n      }\n    });\n    if (DESCRIPTORS) dP(C.prototype, 'size', {\n      get: function () {\n        return validate(this, NAME)[SIZE];\n      }\n    });\n    return C;\n  },\n  def: function (that, key, value) {\n    var entry = getEntry(that, key);\n    var prev, index;\n    // change existing entry\n    if (entry) {\n      entry.v = value;\n    // create new entry\n    } else {\n      that._l = entry = {\n        i: index = fastKey(key, true), // <- index\n        k: key,                        // <- key\n        v: value,                      // <- value\n        p: prev = that._l,             // <- previous entry\n        n: undefined,                  // <- next entry\n        r: false                       // <- removed\n      };\n      if (!that._f) that._f = entry;\n      if (prev) prev.n = entry;\n      that[SIZE]++;\n      // add to index\n      if (index !== 'F') that._i[index] = entry;\n    } return that;\n  },\n  getEntry: getEntry,\n  setStrong: function (C, NAME, IS_MAP) {\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    $iterDefine(C, NAME, function (iterated, kind) {\n      this._t = validate(iterated, NAME); // target\n      this._k = kind;                     // kind\n      this._l = undefined;                // previous\n    }, function () {\n      var that = this;\n      var kind = that._k;\n      var entry = that._l;\n      // revert to the last existing entry\n      while (entry && entry.r) entry = entry.p;\n      // get next entry\n      if (!that._t || !(that._l = entry = entry ? entry.n : that._t._f)) {\n        // or finish the iteration\n        that._t = undefined;\n        return step(1);\n      }\n      // return step by kind\n      if (kind == 'keys') return step(0, entry.k);\n      if (kind == 'values') return step(0, entry.v);\n      return step(0, [entry.k, entry.v]);\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(NAME);\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fY29sbGVjdGlvbi1zdHJvbmcuanM/YzI2YiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgZFAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mO1xudmFyIGNyZWF0ZSA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKTtcbnZhciByZWRlZmluZUFsbCA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lLWFsbCcpO1xudmFyIGN0eCA9IHJlcXVpcmUoJy4vX2N0eCcpO1xudmFyIGFuSW5zdGFuY2UgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpO1xudmFyIGZvck9mID0gcmVxdWlyZSgnLi9fZm9yLW9mJyk7XG52YXIgJGl0ZXJEZWZpbmUgPSByZXF1aXJlKCcuL19pdGVyLWRlZmluZScpO1xudmFyIHN0ZXAgPSByZXF1aXJlKCcuL19pdGVyLXN0ZXAnKTtcbnZhciBzZXRTcGVjaWVzID0gcmVxdWlyZSgnLi9fc2V0LXNwZWNpZXMnKTtcbnZhciBERVNDUklQVE9SUyA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJyk7XG52YXIgZmFzdEtleSA9IHJlcXVpcmUoJy4vX21ldGEnKS5mYXN0S2V5O1xudmFyIHZhbGlkYXRlID0gcmVxdWlyZSgnLi9fdmFsaWRhdGUtY29sbGVjdGlvbicpO1xudmFyIFNJWkUgPSBERVNDUklQVE9SUyA/ICdfcycgOiAnc2l6ZSc7XG5cbnZhciBnZXRFbnRyeSA9IGZ1bmN0aW9uICh0aGF0LCBrZXkpIHtcbiAgLy8gZmFzdCBjYXNlXG4gIHZhciBpbmRleCA9IGZhc3RLZXkoa2V5KTtcbiAgdmFyIGVudHJ5O1xuICBpZiAoaW5kZXggIT09ICdGJykgcmV0dXJuIHRoYXQuX2lbaW5kZXhdO1xuICAvLyBmcm96ZW4gb2JqZWN0IGNhc2VcbiAgZm9yIChlbnRyeSA9IHRoYXQuX2Y7IGVudHJ5OyBlbnRyeSA9IGVudHJ5Lm4pIHtcbiAgICBpZiAoZW50cnkuayA9PSBrZXkpIHJldHVybiBlbnRyeTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGdldENvbnN0cnVjdG9yOiBmdW5jdGlvbiAod3JhcHBlciwgTkFNRSwgSVNfTUFQLCBBRERFUikge1xuICAgIHZhciBDID0gd3JhcHBlcihmdW5jdGlvbiAodGhhdCwgaXRlcmFibGUpIHtcbiAgICAgIGFuSW5zdGFuY2UodGhhdCwgQywgTkFNRSwgJ19pJyk7XG4gICAgICB0aGF0Ll90ID0gTkFNRTsgICAgICAgICAvLyBjb2xsZWN0aW9uIHR5cGVcbiAgICAgIHRoYXQuX2kgPSBjcmVhdGUobnVsbCk7IC8vIGluZGV4XG4gICAgICB0aGF0Ll9mID0gdW5kZWZpbmVkOyAgICAvLyBmaXJzdCBlbnRyeVxuICAgICAgdGhhdC5fbCA9IHVuZGVmaW5lZDsgICAgLy8gbGFzdCBlbnRyeVxuICAgICAgdGhhdFtTSVpFXSA9IDA7ICAgICAgICAgLy8gc2l6ZVxuICAgICAgaWYgKGl0ZXJhYmxlICE9IHVuZGVmaW5lZCkgZm9yT2YoaXRlcmFibGUsIElTX01BUCwgdGhhdFtBRERFUl0sIHRoYXQpO1xuICAgIH0pO1xuICAgIHJlZGVmaW5lQWxsKEMucHJvdG90eXBlLCB7XG4gICAgICAvLyAyMy4xLjMuMSBNYXAucHJvdG90eXBlLmNsZWFyKClcbiAgICAgIC8vIDIzLjIuMy4yIFNldC5wcm90b3R5cGUuY2xlYXIoKVxuICAgICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkge1xuICAgICAgICBmb3IgKHZhciB0aGF0ID0gdmFsaWRhdGUodGhpcywgTkFNRSksIGRhdGEgPSB0aGF0Ll9pLCBlbnRyeSA9IHRoYXQuX2Y7IGVudHJ5OyBlbnRyeSA9IGVudHJ5Lm4pIHtcbiAgICAgICAgICBlbnRyeS5yID0gdHJ1ZTtcbiAgICAgICAgICBpZiAoZW50cnkucCkgZW50cnkucCA9IGVudHJ5LnAubiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBkZWxldGUgZGF0YVtlbnRyeS5pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGF0Ll9mID0gdGhhdC5fbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhhdFtTSVpFXSA9IDA7XG4gICAgICB9LFxuICAgICAgLy8gMjMuMS4zLjMgTWFwLnByb3RvdHlwZS5kZWxldGUoa2V5KVxuICAgICAgLy8gMjMuMi4zLjQgU2V0LnByb3RvdHlwZS5kZWxldGUodmFsdWUpXG4gICAgICAnZGVsZXRlJzogZnVuY3Rpb24gKGtleSkge1xuICAgICAgICB2YXIgdGhhdCA9IHZhbGlkYXRlKHRoaXMsIE5BTUUpO1xuICAgICAgICB2YXIgZW50cnkgPSBnZXRFbnRyeSh0aGF0LCBrZXkpO1xuICAgICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgICB2YXIgbmV4dCA9IGVudHJ5Lm47XG4gICAgICAgICAgdmFyIHByZXYgPSBlbnRyeS5wO1xuICAgICAgICAgIGRlbGV0ZSB0aGF0Ll9pW2VudHJ5LmldO1xuICAgICAgICAgIGVudHJ5LnIgPSB0cnVlO1xuICAgICAgICAgIGlmIChwcmV2KSBwcmV2Lm4gPSBuZXh0O1xuICAgICAgICAgIGlmIChuZXh0KSBuZXh0LnAgPSBwcmV2O1xuICAgICAgICAgIGlmICh0aGF0Ll9mID09IGVudHJ5KSB0aGF0Ll9mID0gbmV4dDtcbiAgICAgICAgICBpZiAodGhhdC5fbCA9PSBlbnRyeSkgdGhhdC5fbCA9IHByZXY7XG4gICAgICAgICAgdGhhdFtTSVpFXS0tO1xuICAgICAgICB9IHJldHVybiAhIWVudHJ5O1xuICAgICAgfSxcbiAgICAgIC8vIDIzLjIuMy42IFNldC5wcm90b3R5cGUuZm9yRWFjaChjYWxsYmFja2ZuLCB0aGlzQXJnID0gdW5kZWZpbmVkKVxuICAgICAgLy8gMjMuMS4zLjUgTWFwLnByb3RvdHlwZS5mb3JFYWNoKGNhbGxiYWNrZm4sIHRoaXNBcmcgPSB1bmRlZmluZWQpXG4gICAgICBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGNhbGxiYWNrZm4gLyogLCB0aGF0ID0gdW5kZWZpbmVkICovKSB7XG4gICAgICAgIHZhbGlkYXRlKHRoaXMsIE5BTUUpO1xuICAgICAgICB2YXIgZiA9IGN0eChjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCwgMyk7XG4gICAgICAgIHZhciBlbnRyeTtcbiAgICAgICAgd2hpbGUgKGVudHJ5ID0gZW50cnkgPyBlbnRyeS5uIDogdGhpcy5fZikge1xuICAgICAgICAgIGYoZW50cnkudiwgZW50cnkuaywgdGhpcyk7XG4gICAgICAgICAgLy8gcmV2ZXJ0IHRvIHRoZSBsYXN0IGV4aXN0aW5nIGVudHJ5XG4gICAgICAgICAgd2hpbGUgKGVudHJ5ICYmIGVudHJ5LnIpIGVudHJ5ID0gZW50cnkucDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIDIzLjEuMy43IE1hcC5wcm90b3R5cGUuaGFzKGtleSlcbiAgICAgIC8vIDIzLjIuMy43IFNldC5wcm90b3R5cGUuaGFzKHZhbHVlKVxuICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KSB7XG4gICAgICAgIHJldHVybiAhIWdldEVudHJ5KHZhbGlkYXRlKHRoaXMsIE5BTUUpLCBrZXkpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChERVNDUklQVE9SUykgZFAoQy5wcm90b3R5cGUsICdzaXplJywge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZSh0aGlzLCBOQU1FKVtTSVpFXTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gQztcbiAgfSxcbiAgZGVmOiBmdW5jdGlvbiAodGhhdCwga2V5LCB2YWx1ZSkge1xuICAgIHZhciBlbnRyeSA9IGdldEVudHJ5KHRoYXQsIGtleSk7XG4gICAgdmFyIHByZXYsIGluZGV4O1xuICAgIC8vIGNoYW5nZSBleGlzdGluZyBlbnRyeVxuICAgIGlmIChlbnRyeSkge1xuICAgICAgZW50cnkudiA9IHZhbHVlO1xuICAgIC8vIGNyZWF0ZSBuZXcgZW50cnlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhhdC5fbCA9IGVudHJ5ID0ge1xuICAgICAgICBpOiBpbmRleCA9IGZhc3RLZXkoa2V5LCB0cnVlKSwgLy8gPC0gaW5kZXhcbiAgICAgICAgazoga2V5LCAgICAgICAgICAgICAgICAgICAgICAgIC8vIDwtIGtleVxuICAgICAgICB2OiB2YWx1ZSwgICAgICAgICAgICAgICAgICAgICAgLy8gPC0gdmFsdWVcbiAgICAgICAgcDogcHJldiA9IHRoYXQuX2wsICAgICAgICAgICAgIC8vIDwtIHByZXZpb3VzIGVudHJ5XG4gICAgICAgIG46IHVuZGVmaW5lZCwgICAgICAgICAgICAgICAgICAvLyA8LSBuZXh0IGVudHJ5XG4gICAgICAgIHI6IGZhbHNlICAgICAgICAgICAgICAgICAgICAgICAvLyA8LSByZW1vdmVkXG4gICAgICB9O1xuICAgICAgaWYgKCF0aGF0Ll9mKSB0aGF0Ll9mID0gZW50cnk7XG4gICAgICBpZiAocHJldikgcHJldi5uID0gZW50cnk7XG4gICAgICB0aGF0W1NJWkVdKys7XG4gICAgICAvLyBhZGQgdG8gaW5kZXhcbiAgICAgIGlmIChpbmRleCAhPT0gJ0YnKSB0aGF0Ll9pW2luZGV4XSA9IGVudHJ5O1xuICAgIH0gcmV0dXJuIHRoYXQ7XG4gIH0sXG4gIGdldEVudHJ5OiBnZXRFbnRyeSxcbiAgc2V0U3Ryb25nOiBmdW5jdGlvbiAoQywgTkFNRSwgSVNfTUFQKSB7XG4gICAgLy8gYWRkIC5rZXlzLCAudmFsdWVzLCAuZW50cmllcywgW0BAaXRlcmF0b3JdXG4gICAgLy8gMjMuMS4zLjQsIDIzLjEuMy44LCAyMy4xLjMuMTEsIDIzLjEuMy4xMiwgMjMuMi4zLjUsIDIzLjIuMy44LCAyMy4yLjMuMTAsIDIzLjIuMy4xMVxuICAgICRpdGVyRGVmaW5lKEMsIE5BTUUsIGZ1bmN0aW9uIChpdGVyYXRlZCwga2luZCkge1xuICAgICAgdGhpcy5fdCA9IHZhbGlkYXRlKGl0ZXJhdGVkLCBOQU1FKTsgLy8gdGFyZ2V0XG4gICAgICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgICAgICAvLyBraW5kXG4gICAgICB0aGlzLl9sID0gdW5kZWZpbmVkOyAgICAgICAgICAgICAgICAvLyBwcmV2aW91c1xuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgIHZhciBraW5kID0gdGhhdC5faztcbiAgICAgIHZhciBlbnRyeSA9IHRoYXQuX2w7XG4gICAgICAvLyByZXZlcnQgdG8gdGhlIGxhc3QgZXhpc3RpbmcgZW50cnlcbiAgICAgIHdoaWxlIChlbnRyeSAmJiBlbnRyeS5yKSBlbnRyeSA9IGVudHJ5LnA7XG4gICAgICAvLyBnZXQgbmV4dCBlbnRyeVxuICAgICAgaWYgKCF0aGF0Ll90IHx8ICEodGhhdC5fbCA9IGVudHJ5ID0gZW50cnkgPyBlbnRyeS5uIDogdGhhdC5fdC5fZikpIHtcbiAgICAgICAgLy8gb3IgZmluaXNoIHRoZSBpdGVyYXRpb25cbiAgICAgICAgdGhhdC5fdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHN0ZXAoMSk7XG4gICAgICB9XG4gICAgICAvLyByZXR1cm4gc3RlcCBieSBraW5kXG4gICAgICBpZiAoa2luZCA9PSAna2V5cycpIHJldHVybiBzdGVwKDAsIGVudHJ5LmspO1xuICAgICAgaWYgKGtpbmQgPT0gJ3ZhbHVlcycpIHJldHVybiBzdGVwKDAsIGVudHJ5LnYpO1xuICAgICAgcmV0dXJuIHN0ZXAoMCwgW2VudHJ5LmssIGVudHJ5LnZdKTtcbiAgICB9LCBJU19NQVAgPyAnZW50cmllcycgOiAndmFsdWVzJywgIUlTX01BUCwgdHJ1ZSk7XG5cbiAgICAvLyBhZGQgW0BAc3BlY2llc10sIDIzLjEuMi4yLCAyMy4yLjIuMlxuICAgIHNldFNwZWNpZXMoTkFNRSk7XG4gIH1cbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///107\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar redefineAll = __webpack_require__(42);\nvar getWeak = __webpack_require__(28).getWeak;\nvar anObject = __webpack_require__(5);\nvar isObject = __webpack_require__(4);\nvar anInstance = __webpack_require__(41);\nvar forOf = __webpack_require__(52);\nvar createArrayMethod = __webpack_require__(20);\nvar $has = __webpack_require__(13);\nvar validate = __webpack_require__(43);\nvar arrayFind = createArrayMethod(5);\nvar arrayFindIndex = createArrayMethod(6);\nvar id = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function (that) {\n  return that._l || (that._l = new UncaughtFrozenStore());\n};\nvar UncaughtFrozenStore = function () {\n  this.a = [];\n};\nvar findUncaughtFrozen = function (store, key) {\n  return arrayFind(store.a, function (it) {\n    return it[0] === key;\n  });\n};\nUncaughtFrozenStore.prototype = {\n  get: function (key) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) return entry[1];\n  },\n  has: function (key) {\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function (key, value) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) entry[1] = value;\n    else this.a.push([key, value]);\n  },\n  'delete': function (key) {\n    var index = arrayFindIndex(this.a, function (it) {\n      return it[0] === key;\n    });\n    if (~index) this.a.splice(index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, NAME, '_i');\n      that._t = NAME;      // collection type\n      that._i = id++;      // collection id\n      that._l = undefined; // leak store for uncaught frozen objects\n      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.3.3.2 WeakMap.prototype.delete(key)\n      // 23.4.3.3 WeakSet.prototype.delete(value)\n      'delete': function (key) {\n        if (!isObject(key)) return false;\n        var data = getWeak(key);\n        if (data === true) return uncaughtFrozenStore(validate(this, NAME))['delete'](key);\n        return data && $has(data, this._i) && delete data[this._i];\n      },\n      // 23.3.3.4 WeakMap.prototype.has(key)\n      // 23.4.3.4 WeakSet.prototype.has(value)\n      has: function has(key) {\n        if (!isObject(key)) return false;\n        var data = getWeak(key);\n        if (data === true) return uncaughtFrozenStore(validate(this, NAME)).has(key);\n        return data && $has(data, this._i);\n      }\n    });\n    return C;\n  },\n  def: function (that, key, value) {\n    var data = getWeak(anObject(key), true);\n    if (data === true) uncaughtFrozenStore(that).set(key, value);\n    else data[that._i] = value;\n    return that;\n  },\n  ufstore: uncaughtFrozenStore\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fY29sbGVjdGlvbi13ZWFrLmpzPzY0M2UiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIHJlZGVmaW5lQWxsID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUtYWxsJyk7XG52YXIgZ2V0V2VhayA9IHJlcXVpcmUoJy4vX21ldGEnKS5nZXRXZWFrO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbnZhciBhbkluc3RhbmNlID0gcmVxdWlyZSgnLi9fYW4taW5zdGFuY2UnKTtcbnZhciBmb3JPZiA9IHJlcXVpcmUoJy4vX2Zvci1vZicpO1xudmFyIGNyZWF0ZUFycmF5TWV0aG9kID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpO1xudmFyICRoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbnZhciB2YWxpZGF0ZSA9IHJlcXVpcmUoJy4vX3ZhbGlkYXRlLWNvbGxlY3Rpb24nKTtcbnZhciBhcnJheUZpbmQgPSBjcmVhdGVBcnJheU1ldGhvZCg1KTtcbnZhciBhcnJheUZpbmRJbmRleCA9IGNyZWF0ZUFycmF5TWV0aG9kKDYpO1xudmFyIGlkID0gMDtcblxuLy8gZmFsbGJhY2sgZm9yIHVuY2F1Z2h0IGZyb3plbiBrZXlzXG52YXIgdW5jYXVnaHRGcm96ZW5TdG9yZSA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gIHJldHVybiB0aGF0Ll9sIHx8ICh0aGF0Ll9sID0gbmV3IFVuY2F1Z2h0RnJvemVuU3RvcmUoKSk7XG59O1xudmFyIFVuY2F1Z2h0RnJvemVuU3RvcmUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuYSA9IFtdO1xufTtcbnZhciBmaW5kVW5jYXVnaHRGcm96ZW4gPSBmdW5jdGlvbiAoc3RvcmUsIGtleSkge1xuICByZXR1cm4gYXJyYXlGaW5kKHN0b3JlLmEsIGZ1bmN0aW9uIChpdCkge1xuICAgIHJldHVybiBpdFswXSA9PT0ga2V5O1xuICB9KTtcbn07XG5VbmNhdWdodEZyb3plblN0b3JlLnByb3RvdHlwZSA9IHtcbiAgZ2V0OiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgdmFyIGVudHJ5ID0gZmluZFVuY2F1Z2h0RnJvemVuKHRoaXMsIGtleSk7XG4gICAgaWYgKGVudHJ5KSByZXR1cm4gZW50cnlbMV07XG4gIH0sXG4gIGhhczogZnVuY3Rpb24gKGtleSkge1xuICAgIHJldHVybiAhIWZpbmRVbmNhdWdodEZyb3plbih0aGlzLCBrZXkpO1xuICB9LFxuICBzZXQ6IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgdmFyIGVudHJ5ID0gZmluZFVuY2F1Z2h0RnJvemVuKHRoaXMsIGtleSk7XG4gICAgaWYgKGVudHJ5KSBlbnRyeVsxXSA9IHZhbHVlO1xuICAgIGVsc2UgdGhpcy5hLnB1c2goW2tleSwgdmFsdWVdKTtcbiAgfSxcbiAgJ2RlbGV0ZSc6IGZ1bmN0aW9uIChrZXkpIHtcbiAgICB2YXIgaW5kZXggPSBhcnJheUZpbmRJbmRleCh0aGlzLmEsIGZ1bmN0aW9uIChpdCkge1xuICAgICAgcmV0dXJuIGl0WzBdID09PSBrZXk7XG4gICAgfSk7XG4gICAgaWYgKH5pbmRleCkgdGhpcy5hLnNwbGljZShpbmRleCwgMSk7XG4gICAgcmV0dXJuICEhfmluZGV4O1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZ2V0Q29uc3RydWN0b3I6IGZ1bmN0aW9uICh3cmFwcGVyLCBOQU1FLCBJU19NQVAsIEFEREVSKSB7XG4gICAgdmFyIEMgPSB3cmFwcGVyKGZ1bmN0aW9uICh0aGF0LCBpdGVyYWJsZSkge1xuICAgICAgYW5JbnN0YW5jZSh0aGF0LCBDLCBOQU1FLCAnX2knKTtcbiAgICAgIHRoYXQuX3QgPSBOQU1FOyAgICAgIC8vIGNvbGxlY3Rpb24gdHlwZVxuICAgICAgdGhhdC5faSA9IGlkKys7ICAgICAgLy8gY29sbGVjdGlvbiBpZFxuICAgICAgdGhhdC5fbCA9IHVuZGVmaW5lZDsgLy8gbGVhayBzdG9yZSBmb3IgdW5jYXVnaHQgZnJvemVuIG9iamVjdHNcbiAgICAgIGlmIChpdGVyYWJsZSAhPSB1bmRlZmluZWQpIGZvck9mKGl0ZXJhYmxlLCBJU19NQVAsIHRoYXRbQURERVJdLCB0aGF0KTtcbiAgICB9KTtcbiAgICByZWRlZmluZUFsbChDLnByb3RvdHlwZSwge1xuICAgICAgLy8gMjMuMy4zLjIgV2Vha01hcC5wcm90b3R5cGUuZGVsZXRlKGtleSlcbiAgICAgIC8vIDIzLjQuMy4zIFdlYWtTZXQucHJvdG90eXBlLmRlbGV0ZSh2YWx1ZSlcbiAgICAgICdkZWxldGUnOiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIGlmICghaXNPYmplY3Qoa2V5KSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICB2YXIgZGF0YSA9IGdldFdlYWsoa2V5KTtcbiAgICAgICAgaWYgKGRhdGEgPT09IHRydWUpIHJldHVybiB1bmNhdWdodEZyb3plblN0b3JlKHZhbGlkYXRlKHRoaXMsIE5BTUUpKVsnZGVsZXRlJ10oa2V5KTtcbiAgICAgICAgcmV0dXJuIGRhdGEgJiYgJGhhcyhkYXRhLCB0aGlzLl9pKSAmJiBkZWxldGUgZGF0YVt0aGlzLl9pXTtcbiAgICAgIH0sXG4gICAgICAvLyAyMy4zLjMuNCBXZWFrTWFwLnByb3RvdHlwZS5oYXMoa2V5KVxuICAgICAgLy8gMjMuNC4zLjQgV2Vha1NldC5wcm90b3R5cGUuaGFzKHZhbHVlKVxuICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KSB7XG4gICAgICAgIGlmICghaXNPYmplY3Qoa2V5KSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICB2YXIgZGF0YSA9IGdldFdlYWsoa2V5KTtcbiAgICAgICAgaWYgKGRhdGEgPT09IHRydWUpIHJldHVybiB1bmNhdWdodEZyb3plblN0b3JlKHZhbGlkYXRlKHRoaXMsIE5BTUUpKS5oYXMoa2V5KTtcbiAgICAgICAgcmV0dXJuIGRhdGEgJiYgJGhhcyhkYXRhLCB0aGlzLl9pKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gQztcbiAgfSxcbiAgZGVmOiBmdW5jdGlvbiAodGhhdCwga2V5LCB2YWx1ZSkge1xuICAgIHZhciBkYXRhID0gZ2V0V2Vhayhhbk9iamVjdChrZXkpLCB0cnVlKTtcbiAgICBpZiAoZGF0YSA9PT0gdHJ1ZSkgdW5jYXVnaHRGcm96ZW5TdG9yZSh0aGF0KS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgZWxzZSBkYXRhW3RoYXQuX2ldID0gdmFsdWU7XG4gICAgcmV0dXJuIHRoYXQ7XG4gIH0sXG4gIHVmc3RvcmU6IHVuY2F1Z2h0RnJvemVuU3RvcmVcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///108\n")},function(module,exports,__webpack_require__){eval("// https://tc39.github.io/ecma262/#sec-toindex\nvar toInteger = __webpack_require__(25);\nvar toLength = __webpack_require__(10);\nmodule.exports = function (it) {\n  if (it === undefined) return 0;\n  var number = toInteger(it);\n  var length = toLength(number);\n  if (number !== length) throw RangeError('Wrong length!');\n  return length;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fdG8taW5kZXguanM/MDlmYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy10b2luZGV4XG52YXIgdG9JbnRlZ2VyID0gcmVxdWlyZSgnLi9fdG8taW50ZWdlcicpO1xudmFyIHRvTGVuZ3RoID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoaXQgPT09IHVuZGVmaW5lZCkgcmV0dXJuIDA7XG4gIHZhciBudW1iZXIgPSB0b0ludGVnZXIoaXQpO1xuICB2YXIgbGVuZ3RoID0gdG9MZW5ndGgobnVtYmVyKTtcbiAgaWYgKG51bWJlciAhPT0gbGVuZ3RoKSB0aHJvdyBSYW5nZUVycm9yKCdXcm9uZyBsZW5ndGghJyk7XG4gIHJldHVybiBsZW5ndGg7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///109\n")},function(module,exports,__webpack_require__){eval("// all object keys, includes non-enumerable and symbols\nvar gOPN = __webpack_require__(35);\nvar gOPS = __webpack_require__(47);\nvar anObject = __webpack_require__(5);\nvar Reflect = __webpack_require__(3).Reflect;\nmodule.exports = Reflect && Reflect.ownKeys || function ownKeys(it) {\n  var keys = gOPN.f(anObject(it));\n  var getSymbols = gOPS.f;\n  return getSymbols ? keys.concat(getSymbols(it)) : keys;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fb3duLWtleXMuanM/OTkwYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhbGwgb2JqZWN0IGtleXMsIGluY2x1ZGVzIG5vbi1lbnVtZXJhYmxlIGFuZCBzeW1ib2xzXG52YXIgZ09QTiA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BuJyk7XG52YXIgZ09QUyA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BzJyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBSZWZsZWN0ID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykuUmVmbGVjdDtcbm1vZHVsZS5leHBvcnRzID0gUmVmbGVjdCAmJiBSZWZsZWN0Lm93bktleXMgfHwgZnVuY3Rpb24gb3duS2V5cyhpdCkge1xuICB2YXIga2V5cyA9IGdPUE4uZihhbk9iamVjdChpdCkpO1xuICB2YXIgZ2V0U3ltYm9scyA9IGdPUFMuZjtcbiAgcmV0dXJuIGdldFN5bWJvbHMgPyBrZXlzLmNvbmNhdChnZXRTeW1ib2xzKGl0KSkgOiBrZXlzO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///110\n")},function(module,exports,__webpack_require__){eval("// https://github.com/tc39/proposal-string-pad-start-end\nvar toLength = __webpack_require__(10);\nvar repeat = __webpack_require__(67);\nvar defined = __webpack_require__(24);\n\nmodule.exports = function (that, maxLength, fillString, left) {\n  var S = String(defined(that));\n  var stringLength = S.length;\n  var fillStr = fillString === undefined ? ' ' : String(fillString);\n  var intMaxLength = toLength(maxLength);\n  if (intMaxLength <= stringLength || fillStr == '') return S;\n  var fillLen = intMaxLength - stringLength;\n  var stringFiller = repeat.call(fillStr, Math.ceil(fillLen / fillStr.length));\n  if (stringFiller.length > fillLen) stringFiller = stringFiller.slice(0, fillLen);\n  return left ? stringFiller + S : S + stringFiller;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTExLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fc3RyaW5nLXBhZC5qcz8yZTA4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLXN0cmluZy1wYWQtc3RhcnQtZW5kXG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcbnZhciByZXBlYXQgPSByZXF1aXJlKCcuL19zdHJpbmctcmVwZWF0Jyk7XG52YXIgZGVmaW5lZCA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodGhhdCwgbWF4TGVuZ3RoLCBmaWxsU3RyaW5nLCBsZWZ0KSB7XG4gIHZhciBTID0gU3RyaW5nKGRlZmluZWQodGhhdCkpO1xuICB2YXIgc3RyaW5nTGVuZ3RoID0gUy5sZW5ndGg7XG4gIHZhciBmaWxsU3RyID0gZmlsbFN0cmluZyA9PT0gdW5kZWZpbmVkID8gJyAnIDogU3RyaW5nKGZpbGxTdHJpbmcpO1xuICB2YXIgaW50TWF4TGVuZ3RoID0gdG9MZW5ndGgobWF4TGVuZ3RoKTtcbiAgaWYgKGludE1heExlbmd0aCA8PSBzdHJpbmdMZW5ndGggfHwgZmlsbFN0ciA9PSAnJykgcmV0dXJuIFM7XG4gIHZhciBmaWxsTGVuID0gaW50TWF4TGVuZ3RoIC0gc3RyaW5nTGVuZ3RoO1xuICB2YXIgc3RyaW5nRmlsbGVyID0gcmVwZWF0LmNhbGwoZmlsbFN0ciwgTWF0aC5jZWlsKGZpbGxMZW4gLyBmaWxsU3RyLmxlbmd0aCkpO1xuICBpZiAoc3RyaW5nRmlsbGVyLmxlbmd0aCA+IGZpbGxMZW4pIHN0cmluZ0ZpbGxlciA9IHN0cmluZ0ZpbGxlci5zbGljZSgwLCBmaWxsTGVuKTtcbiAgcmV0dXJuIGxlZnQgPyBzdHJpbmdGaWxsZXIgKyBTIDogUyArIHN0cmluZ0ZpbGxlcjtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///111\n")},function(module,exports,__webpack_require__){eval("var getKeys = __webpack_require__(32);\nvar toIObject = __webpack_require__(15);\nvar isEnum = __webpack_require__(45).f;\nmodule.exports = function (isEntries) {\n  return function (it) {\n    var O = toIObject(it);\n    var keys = getKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) if (isEnum.call(O, key = keys[i++])) {\n      result.push(isEntries ? [key, O[key]] : O[key]);\n    } return result;\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fb2JqZWN0LXRvLWFycmF5LmpzPzUwNGMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGdldEtleXMgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpO1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcbnZhciBpc0VudW0gPSByZXF1aXJlKCcuL19vYmplY3QtcGllJykuZjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGlzRW50cmllcykge1xuICByZXR1cm4gZnVuY3Rpb24gKGl0KSB7XG4gICAgdmFyIE8gPSB0b0lPYmplY3QoaXQpO1xuICAgIHZhciBrZXlzID0gZ2V0S2V5cyhPKTtcbiAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIga2V5O1xuICAgIHdoaWxlIChsZW5ndGggPiBpKSBpZiAoaXNFbnVtLmNhbGwoTywga2V5ID0ga2V5c1tpKytdKSkge1xuICAgICAgcmVzdWx0LnB1c2goaXNFbnRyaWVzID8gW2tleSwgT1trZXldXSA6IE9ba2V5XSk7XG4gICAgfSByZXR1cm4gcmVzdWx0O1xuICB9O1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///112\n")},function(c,e,n){n(114),c.exports=n(283)},function(module,exports,__webpack_require__){"use strict";eval('/* WEBPACK VAR INJECTION */(function(global) {\n\n__webpack_require__(116);\n\n__webpack_require__(260);\n\n__webpack_require__(262);\n\n__webpack_require__(264);\n\n__webpack_require__(266);\n\n__webpack_require__(268);\n\n__webpack_require__(270);\n\n__webpack_require__(272);\n\n__webpack_require__(274);\n\n__webpack_require__(276);\n\n__webpack_require__(280);\n\nif (global._babelPolyfill && typeof console !== "undefined" && console.warn) {\n  console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended " + "and may have consequences if different versions of the polyfills are applied sequentially. " + "If you do need to load the polyfill more than once, use @babel/polyfill/noConflict " + "instead to bypass the warning.");\n}\n\nglobal._babelPolyfill = true;\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(115)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTE0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL0BiYWJlbC9wb2x5ZmlsbC9saWIvaW5kZXguanM/ZTc5MiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxucmVxdWlyZShcImNvcmUtanMvZXM2XCIpO1xuXG5yZXF1aXJlKFwiY29yZS1qcy9mbi9hcnJheS9pbmNsdWRlc1wiKTtcblxucmVxdWlyZShcImNvcmUtanMvZm4vc3RyaW5nL3BhZC1zdGFydFwiKTtcblxucmVxdWlyZShcImNvcmUtanMvZm4vc3RyaW5nL3BhZC1lbmRcIik7XG5cbnJlcXVpcmUoXCJjb3JlLWpzL2ZuL3N5bWJvbC9hc3luYy1pdGVyYXRvclwiKTtcblxucmVxdWlyZShcImNvcmUtanMvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnNcIik7XG5cbnJlcXVpcmUoXCJjb3JlLWpzL2ZuL29iamVjdC92YWx1ZXNcIik7XG5cbnJlcXVpcmUoXCJjb3JlLWpzL2ZuL29iamVjdC9lbnRyaWVzXCIpO1xuXG5yZXF1aXJlKFwiY29yZS1qcy9mbi9wcm9taXNlL2ZpbmFsbHlcIik7XG5cbnJlcXVpcmUoXCJjb3JlLWpzL3dlYlwiKTtcblxucmVxdWlyZShcInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZVwiKTtcblxuaWYgKGdsb2JhbC5fYmFiZWxQb2x5ZmlsbCAmJiB0eXBlb2YgY29uc29sZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjb25zb2xlLndhcm4pIHtcbiAgY29uc29sZS53YXJuKFwiQGJhYmVsL3BvbHlmaWxsIGlzIGxvYWRlZCBtb3JlIHRoYW4gb25jZSBvbiB0aGlzIHBhZ2UuIFRoaXMgaXMgcHJvYmFibHkgbm90IGRlc2lyYWJsZS9pbnRlbmRlZCBcIiArIFwiYW5kIG1heSBoYXZlIGNvbnNlcXVlbmNlcyBpZiBkaWZmZXJlbnQgdmVyc2lvbnMgb2YgdGhlIHBvbHlmaWxscyBhcmUgYXBwbGllZCBzZXF1ZW50aWFsbHkuIFwiICsgXCJJZiB5b3UgZG8gbmVlZCB0byBsb2FkIHRoZSBwb2x5ZmlsbCBtb3JlIHRoYW4gb25jZSwgdXNlIEBiYWJlbC9wb2x5ZmlsbC9ub0NvbmZsaWN0IFwiICsgXCJpbnN0ZWFkIHRvIGJ5cGFzcyB0aGUgd2FybmluZy5cIik7XG59XG5cbmdsb2JhbC5fYmFiZWxQb2x5ZmlsbCA9IHRydWU7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///114\n')},function(module,exports){eval('var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function("return this")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === "object") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it\'s\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTE1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLyh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qcz9jZDAwIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBnO1xuXG4vLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZVxuZyA9IChmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXM7XG59KSgpO1xuXG50cnkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIGV2YWwgaXMgYWxsb3dlZCAoc2VlIENTUClcblx0ZyA9IGcgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcbn0gY2F0Y2ggKGUpIHtcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcblx0aWYgKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIpIGcgPSB3aW5kb3c7XG59XG5cbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cbi8vIFdlIHJldHVybiB1bmRlZmluZWQsIGluc3RlYWQgb2Ygbm90aGluZyBoZXJlLCBzbyBpdCdzXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XG5cbm1vZHVsZS5leHBvcnRzID0gZztcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///115\n')},function(module,exports,__webpack_require__){eval("__webpack_require__(117);\n__webpack_require__(119);\n__webpack_require__(120);\n__webpack_require__(121);\n__webpack_require__(122);\n__webpack_require__(123);\n__webpack_require__(124);\n__webpack_require__(125);\n__webpack_require__(126);\n__webpack_require__(127);\n__webpack_require__(128);\n__webpack_require__(129);\n__webpack_require__(130);\n__webpack_require__(131);\n__webpack_require__(132);\n__webpack_require__(133);\n__webpack_require__(135);\n__webpack_require__(136);\n__webpack_require__(137);\n__webpack_require__(138);\n__webpack_require__(139);\n__webpack_require__(140);\n__webpack_require__(141);\n__webpack_require__(142);\n__webpack_require__(143);\n__webpack_require__(144);\n__webpack_require__(145);\n__webpack_require__(146);\n__webpack_require__(147);\n__webpack_require__(148);\n__webpack_require__(149);\n__webpack_require__(150);\n__webpack_require__(151);\n__webpack_require__(152);\n__webpack_require__(153);\n__webpack_require__(154);\n__webpack_require__(155);\n__webpack_require__(156);\n__webpack_require__(157);\n__webpack_require__(158);\n__webpack_require__(159);\n__webpack_require__(160);\n__webpack_require__(161);\n__webpack_require__(163);\n__webpack_require__(164);\n__webpack_require__(165);\n__webpack_require__(166);\n__webpack_require__(167);\n__webpack_require__(168);\n__webpack_require__(169);\n__webpack_require__(170);\n__webpack_require__(171);\n__webpack_require__(172);\n__webpack_require__(173);\n__webpack_require__(174);\n__webpack_require__(175);\n__webpack_require__(176);\n__webpack_require__(177);\n__webpack_require__(178);\n__webpack_require__(179);\n__webpack_require__(180);\n__webpack_require__(181);\n__webpack_require__(182);\n__webpack_require__(183);\n__webpack_require__(184);\n__webpack_require__(185);\n__webpack_require__(186);\n__webpack_require__(187);\n__webpack_require__(188);\n__webpack_require__(189);\n__webpack_require__(190);\n__webpack_require__(191);\n__webpack_require__(192);\n__webpack_require__(193);\n__webpack_require__(194);\n__webpack_require__(195);\n__webpack_require__(196);\n__webpack_require__(198);\n__webpack_require__(199);\n__webpack_require__(201);\n__webpack_require__(202);\n__webpack_require__(203);\n__webpack_require__(204);\n__webpack_require__(205);\n__webpack_require__(206);\n__webpack_require__(207);\n__webpack_require__(210);\n__webpack_require__(211);\n__webpack_require__(212);\n__webpack_require__(213);\n__webpack_require__(214);\n__webpack_require__(215);\n__webpack_require__(216);\n__webpack_require__(217);\n__webpack_require__(218);\n__webpack_require__(219);\n__webpack_require__(220);\n__webpack_require__(221);\n__webpack_require__(222);\n__webpack_require__(78);\n__webpack_require__(223);\n__webpack_require__(224);\n__webpack_require__(103);\n__webpack_require__(225);\n__webpack_require__(226);\n__webpack_require__(227);\n__webpack_require__(228);\n__webpack_require__(104);\n__webpack_require__(231);\n__webpack_require__(232);\n__webpack_require__(233);\n__webpack_require__(234);\n__webpack_require__(235);\n__webpack_require__(236);\n__webpack_require__(237);\n__webpack_require__(238);\n__webpack_require__(239);\n__webpack_require__(240);\n__webpack_require__(241);\n__webpack_require__(242);\n__webpack_require__(243);\n__webpack_require__(244);\n__webpack_require__(245);\n__webpack_require__(246);\n__webpack_require__(247);\n__webpack_require__(248);\n__webpack_require__(249);\n__webpack_require__(250);\n__webpack_require__(251);\n__webpack_require__(252);\n__webpack_require__(253);\n__webpack_require__(254);\n__webpack_require__(255);\n__webpack_require__(256);\n__webpack_require__(257);\n__webpack_require__(258);\n__webpack_require__(259);\nmodule.exports = __webpack_require__(9);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTE2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZXM2L2luZGV4LmpzPzViZDciXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3ltYm9sJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QuY3JlYXRlJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QuZGVmaW5lLXByb3BlcnR5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QuZGVmaW5lLXByb3BlcnRpZXMnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3InKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtcHJvdG90eXBlLW9mJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3Qua2V5cycpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktbmFtZXMnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm9iamVjdC5mcmVlemUnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm9iamVjdC5zZWFsJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QucHJldmVudC1leHRlbnNpb25zJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QuaXMtZnJvemVuJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QuaXMtc2VhbGVkJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QuaXMtZXh0ZW5zaWJsZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYub2JqZWN0LmFzc2lnbicpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYub2JqZWN0LmlzJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZicpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZycpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuZnVuY3Rpb24uYmluZCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuZnVuY3Rpb24ubmFtZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuZnVuY3Rpb24uaGFzLWluc3RhbmNlJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5wYXJzZS1pbnQnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnBhcnNlLWZsb2F0Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5udW1iZXIuY29uc3RydWN0b3InKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm51bWJlci50by1maXhlZCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubnVtYmVyLnRvLXByZWNpc2lvbicpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubnVtYmVyLmVwc2lsb24nKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm51bWJlci5pcy1maW5pdGUnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm51bWJlci5pcy1pbnRlZ2VyJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5udW1iZXIuaXMtbmFuJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5udW1iZXIuaXMtc2FmZS1pbnRlZ2VyJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5udW1iZXIubWF4LXNhZmUtaW50ZWdlcicpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubnVtYmVyLm1pbi1zYWZlLWludGVnZXInKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm51bWJlci5wYXJzZS1mbG9hdCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubnVtYmVyLnBhcnNlLWludCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubWF0aC5hY29zaCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubWF0aC5hc2luaCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubWF0aC5hdGFuaCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubWF0aC5jYnJ0Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5tYXRoLmNsejMyJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5tYXRoLmNvc2gnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm1hdGguZXhwbTEnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm1hdGguZnJvdW5kJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5tYXRoLmh5cG90Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5tYXRoLmltdWwnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm1hdGgubG9nMTAnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm1hdGgubG9nMXAnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm1hdGgubG9nMicpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubWF0aC5zaWduJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5tYXRoLnNpbmgnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm1hdGgudGFuaCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubWF0aC50cnVuYycpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLmZyb20tY29kZS1wb2ludCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLnJhdycpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLnRyaW0nKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5pdGVyYXRvcicpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLmNvZGUtcG9pbnQtYXQnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5lbmRzLXdpdGgnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5pbmNsdWRlcycpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLnJlcGVhdCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLnN0YXJ0cy13aXRoJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5zdHJpbmcuYW5jaG9yJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5zdHJpbmcuYmlnJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5zdHJpbmcuYmxpbmsnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5ib2xkJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5zdHJpbmcuZml4ZWQnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5mb250Y29sb3InKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5mb250c2l6ZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0YWxpY3MnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5saW5rJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5zdHJpbmcuc21hbGwnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5zdHJpa2UnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5zdWInKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5zdXAnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmRhdGUubm93Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5kYXRlLnRvLWpzb24nKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmRhdGUudG8taXNvLXN0cmluZycpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuZGF0ZS50by1zdHJpbmcnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmRhdGUudG8tcHJpbWl0aXZlJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5pcy1hcnJheScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuYXJyYXkuZnJvbScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuYXJyYXkub2YnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmFycmF5LmpvaW4nKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmFycmF5LnNsaWNlJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5zb3J0Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5mb3ItZWFjaCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuYXJyYXkubWFwJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5maWx0ZXInKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmFycmF5LnNvbWUnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmFycmF5LmV2ZXJ5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5yZWR1Y2UnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmFycmF5LnJlZHVjZS1yaWdodCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuYXJyYXkuaW5kZXgtb2YnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmFycmF5Lmxhc3QtaW5kZXgtb2YnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LmFycmF5LmNvcHktd2l0aGluJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5maWxsJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5maW5kJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5maW5kLWluZGV4Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5zcGVjaWVzJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5hcnJheS5pdGVyYXRvcicpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYucmVnZXhwLmNvbnN0cnVjdG9yJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5yZWdleHAudG8tc3RyaW5nJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5yZWdleHAuZmxhZ3MnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnJlZ2V4cC5tYXRjaCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYucmVnZXhwLnJlcGxhY2UnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnJlZ2V4cC5zZWFyY2gnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnJlZ2V4cC5zcGxpdCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYucHJvbWlzZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYubWFwJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5zZXQnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LndlYWstbWFwJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi53ZWFrLXNldCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYudHlwZWQuYXJyYXktYnVmZmVyJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi50eXBlZC5kYXRhLXZpZXcnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnR5cGVkLmludDgtYXJyYXknKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnR5cGVkLnVpbnQ4LWFycmF5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi50eXBlZC51aW50OC1jbGFtcGVkLWFycmF5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi50eXBlZC5pbnQxNi1hcnJheScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYudHlwZWQudWludDE2LWFycmF5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi50eXBlZC5pbnQzMi1hcnJheScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYudHlwZWQudWludDMyLWFycmF5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi50eXBlZC5mbG9hdDMyLWFycmF5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi50eXBlZC5mbG9hdDY0LWFycmF5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmFwcGx5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmNvbnN0cnVjdCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYucmVmbGVjdC5kZWZpbmUtcHJvcGVydHknKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnJlZmxlY3QuZGVsZXRlLXByb3BlcnR5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmVudW1lcmF0ZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYucmVmbGVjdC5nZXQnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnJlZmxlY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmdldC1wcm90b3R5cGUtb2YnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnJlZmxlY3QuaGFzJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmlzLWV4dGVuc2libGUnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnJlZmxlY3Qub3duLWtleXMnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnJlZmxlY3QucHJldmVudC1leHRlbnNpb25zJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5yZWZsZWN0LnNldCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYucmVmbGVjdC5zZXQtcHJvdG90eXBlLW9mJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uL21vZHVsZXMvX2NvcmUnKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///116\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// ECMAScript 6 symbols shim\nvar global = __webpack_require__(3);\nvar has = __webpack_require__(13);\nvar DESCRIPTORS = __webpack_require__(8);\nvar $export = __webpack_require__(1);\nvar redefine = __webpack_require__(11);\nvar META = __webpack_require__(28).KEY;\nvar $fails = __webpack_require__(2);\nvar shared = __webpack_require__(58);\nvar setToStringTag = __webpack_require__(37);\nvar uid = __webpack_require__(30);\nvar wks = __webpack_require__(6);\nvar wksExt = __webpack_require__(59);\nvar wksDefine = __webpack_require__(85);\nvar enumKeys = __webpack_require__(118);\nvar isArray = __webpack_require__(62);\nvar anObject = __webpack_require__(5);\nvar isObject = __webpack_require__(4);\nvar toIObject = __webpack_require__(15);\nvar toPrimitive = __webpack_require__(27);\nvar createDesc = __webpack_require__(29);\nvar _create = __webpack_require__(34);\nvar gOPNExt = __webpack_require__(88);\nvar $GOPD = __webpack_require__(18);\nvar $DP = __webpack_require__(7);\nvar $keys = __webpack_require__(32);\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function';\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  __webpack_require__(35).f = gOPNExt.f = $getOwnPropertyNames;\n  __webpack_require__(45).f = $propertyIsEnumerable;\n  __webpack_require__(47).f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !__webpack_require__(31)) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');\n    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    $replacer = replacer = args[1];\n    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    if (!isArray(replacer)) replacer = function (key, value) {\n      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || __webpack_require__(14)($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTE3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3ltYm9sLmpzPzhhODEiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8gRUNNQVNjcmlwdCA2IHN5bWJvbHMgc2hpbVxudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIERFU0NSSVBUT1JTID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKTtcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgcmVkZWZpbmUgPSByZXF1aXJlKCcuL19yZWRlZmluZScpO1xudmFyIE1FVEEgPSByZXF1aXJlKCcuL19tZXRhJykuS0VZO1xudmFyICRmYWlscyA9IHJlcXVpcmUoJy4vX2ZhaWxzJyk7XG52YXIgc2hhcmVkID0gcmVxdWlyZSgnLi9fc2hhcmVkJyk7XG52YXIgc2V0VG9TdHJpbmdUYWcgPSByZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpO1xudmFyIHVpZCA9IHJlcXVpcmUoJy4vX3VpZCcpO1xudmFyIHdrcyA9IHJlcXVpcmUoJy4vX3drcycpO1xudmFyIHdrc0V4dCA9IHJlcXVpcmUoJy4vX3drcy1leHQnKTtcbnZhciB3a3NEZWZpbmUgPSByZXF1aXJlKCcuL193a3MtZGVmaW5lJyk7XG52YXIgZW51bUtleXMgPSByZXF1aXJlKCcuL19lbnVtLWtleXMnKTtcbnZhciBpc0FycmF5ID0gcmVxdWlyZSgnLi9faXMtYXJyYXknKTtcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJyk7XG52YXIgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcbnZhciBfY3JlYXRlID0gcmVxdWlyZSgnLi9fb2JqZWN0LWNyZWF0ZScpO1xudmFyIGdPUE5FeHQgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wbi1leHQnKTtcbnZhciAkR09QRCA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJyk7XG52YXIgJERQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgJGtleXMgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpO1xudmFyIGdPUEQgPSAkR09QRC5mO1xudmFyIGRQID0gJERQLmY7XG52YXIgZ09QTiA9IGdPUE5FeHQuZjtcbnZhciAkU3ltYm9sID0gZ2xvYmFsLlN5bWJvbDtcbnZhciAkSlNPTiA9IGdsb2JhbC5KU09OO1xudmFyIF9zdHJpbmdpZnkgPSAkSlNPTiAmJiAkSlNPTi5zdHJpbmdpZnk7XG52YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7XG52YXIgSElEREVOID0gd2tzKCdfaGlkZGVuJyk7XG52YXIgVE9fUFJJTUlUSVZFID0gd2tzKCd0b1ByaW1pdGl2ZScpO1xudmFyIGlzRW51bSA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKTtcbnZhciBBbGxTeW1ib2xzID0gc2hhcmVkKCdzeW1ib2xzJyk7XG52YXIgT1BTeW1ib2xzID0gc2hhcmVkKCdvcC1zeW1ib2xzJyk7XG52YXIgT2JqZWN0UHJvdG8gPSBPYmplY3RbUFJPVE9UWVBFXTtcbnZhciBVU0VfTkFUSVZFID0gdHlwZW9mICRTeW1ib2wgPT0gJ2Z1bmN0aW9uJztcbnZhciBRT2JqZWN0ID0gZ2xvYmFsLlFPYmplY3Q7XG4vLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzNcbnZhciBzZXR0ZXIgPSAhUU9iamVjdCB8fCAhUU9iamVjdFtQUk9UT1RZUEVdIHx8ICFRT2JqZWN0W1BST1RPVFlQRV0uZmluZENoaWxkO1xuXG4vLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODdcbnZhciBzZXRTeW1ib2xEZXNjID0gREVTQ1JJUFRPUlMgJiYgJGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIF9jcmVhdGUoZFAoe30sICdhJywge1xuICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gZFAodGhpcywgJ2EnLCB7IHZhbHVlOiA3IH0pLmE7IH1cbiAgfSkpLmEgIT0gNztcbn0pID8gZnVuY3Rpb24gKGl0LCBrZXksIEQpIHtcbiAgdmFyIHByb3RvRGVzYyA9IGdPUEQoT2JqZWN0UHJvdG8sIGtleSk7XG4gIGlmIChwcm90b0Rlc2MpIGRlbGV0ZSBPYmplY3RQcm90b1trZXldO1xuICBkUChpdCwga2V5LCBEKTtcbiAgaWYgKHByb3RvRGVzYyAmJiBpdCAhPT0gT2JqZWN0UHJvdG8pIGRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7XG59IDogZFA7XG5cbnZhciB3cmFwID0gZnVuY3Rpb24gKHRhZykge1xuICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pO1xuICBzeW0uX2sgPSB0YWc7XG4gIHJldHVybiBzeW07XG59O1xuXG52YXIgaXNTeW1ib2wgPSBVU0VfTkFUSVZFICYmIHR5cGVvZiAkU3ltYm9sLml0ZXJhdG9yID09ICdzeW1ib2wnID8gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCc7XG59IDogZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7XG59O1xuXG52YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCkge1xuICBpZiAoaXQgPT09IE9iamVjdFByb3RvKSAkZGVmaW5lUHJvcGVydHkoT1BTeW1ib2xzLCBrZXksIEQpO1xuICBhbk9iamVjdChpdCk7XG4gIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7XG4gIGFuT2JqZWN0KEQpO1xuICBpZiAoaGFzKEFsbFN5bWJvbHMsIGtleSkpIHtcbiAgICBpZiAoIUQuZW51bWVyYWJsZSkge1xuICAgICAgaWYgKCFoYXMoaXQsIEhJRERFTikpIGRQKGl0LCBISURERU4sIGNyZWF0ZURlc2MoMSwge30pKTtcbiAgICAgIGl0W0hJRERFTl1ba2V5XSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChoYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKSBpdFtISURERU5dW2tleV0gPSBmYWxzZTtcbiAgICAgIEQgPSBfY3JlYXRlKEQsIHsgZW51bWVyYWJsZTogY3JlYXRlRGVzYygwLCBmYWxzZSkgfSk7XG4gICAgfSByZXR1cm4gc2V0U3ltYm9sRGVzYyhpdCwga2V5LCBEKTtcbiAgfSByZXR1cm4gZFAoaXQsIGtleSwgRCk7XG59O1xudmFyICRkZWZpbmVQcm9wZXJ0aWVzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhpdCwgUCkge1xuICBhbk9iamVjdChpdCk7XG4gIHZhciBrZXlzID0gZW51bUtleXMoUCA9IHRvSU9iamVjdChQKSk7XG4gIHZhciBpID0gMDtcbiAgdmFyIGwgPSBrZXlzLmxlbmd0aDtcbiAgdmFyIGtleTtcbiAgd2hpbGUgKGwgPiBpKSAkZGVmaW5lUHJvcGVydHkoaXQsIGtleSA9IGtleXNbaSsrXSwgUFtrZXldKTtcbiAgcmV0dXJuIGl0O1xufTtcbnZhciAkY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGl0LCBQKSB7XG4gIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTtcbn07XG52YXIgJHByb3BlcnR5SXNFbnVtZXJhYmxlID0gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoa2V5KSB7XG4gIHZhciBFID0gaXNFbnVtLmNhbGwodGhpcywga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKSk7XG4gIGlmICh0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gRSB8fCAhaGFzKHRoaXMsIGtleSkgfHwgIWhhcyhBbGxTeW1ib2xzLCBrZXkpIHx8IGhhcyh0aGlzLCBISURERU4pICYmIHRoaXNbSElEREVOXVtrZXldID8gRSA6IHRydWU7XG59O1xudmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSkge1xuICBpdCA9IHRvSU9iamVjdChpdCk7XG4gIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7XG4gIGlmIChpdCA9PT0gT2JqZWN0UHJvdG8gJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIWhhcyhPUFN5bWJvbHMsIGtleSkpIHJldHVybjtcbiAgdmFyIEQgPSBnT1BEKGl0LCBrZXkpO1xuICBpZiAoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKSBELmVudW1lcmFibGUgPSB0cnVlO1xuICByZXR1cm4gRDtcbn07XG52YXIgJGdldE93blByb3BlcnR5TmFtZXMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KSB7XG4gIHZhciBuYW1lcyA9IGdPUE4odG9JT2JqZWN0KGl0KSk7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIGkgPSAwO1xuICB2YXIga2V5O1xuICB3aGlsZSAobmFtZXMubGVuZ3RoID4gaSkge1xuICAgIGlmICghaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIGtleSAhPSBISURERU4gJiYga2V5ICE9IE1FVEEpIHJlc3VsdC5wdXNoKGtleSk7XG4gIH0gcmV0dXJuIHJlc3VsdDtcbn07XG52YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCkge1xuICB2YXIgSVNfT1AgPSBpdCA9PT0gT2JqZWN0UHJvdG87XG4gIHZhciBuYW1lcyA9IGdPUE4oSVNfT1AgPyBPUFN5bWJvbHMgOiB0b0lPYmplY3QoaXQpKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIgaSA9IDA7XG4gIHZhciBrZXk7XG4gIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKSB7XG4gICAgaWYgKGhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiAoSVNfT1AgPyBoYXMoT2JqZWN0UHJvdG8sIGtleSkgOiB0cnVlKSkgcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcblxuLy8gMTkuNC4xLjEgU3ltYm9sKFtkZXNjcmlwdGlvbl0pXG5pZiAoIVVTRV9OQVRJVkUpIHtcbiAgJFN5bWJvbCA9IGZ1bmN0aW9uIFN5bWJvbCgpIHtcbiAgICBpZiAodGhpcyBpbnN0YW5jZW9mICRTeW1ib2wpIHRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpO1xuICAgIHZhciB0YWcgPSB1aWQoYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpO1xuICAgIHZhciAkc2V0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICBpZiAodGhpcyA9PT0gT2JqZWN0UHJvdG8pICRzZXQuY2FsbChPUFN5bWJvbHMsIHZhbHVlKTtcbiAgICAgIGlmIChoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKSB0aGlzW0hJRERFTl1bdGFnXSA9IGZhbHNlO1xuICAgICAgc2V0U3ltYm9sRGVzYyh0aGlzLCB0YWcsIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTtcbiAgICB9O1xuICAgIGlmIChERVNDUklQVE9SUyAmJiBzZXR0ZXIpIHNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywgeyBjb25maWd1cmFibGU6IHRydWUsIHNldDogJHNldCB9KTtcbiAgICByZXR1cm4gd3JhcCh0YWcpO1xuICB9O1xuICByZWRlZmluZSgkU3ltYm9sW1BST1RPVFlQRV0sICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiB0aGlzLl9rO1xuICB9KTtcblxuICAkR09QRC5mID0gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgJERQLmYgPSAkZGVmaW5lUHJvcGVydHk7XG4gIHJlcXVpcmUoJy4vX29iamVjdC1nb3BuJykuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzO1xuICByZXF1aXJlKCcuL19vYmplY3QtcGllJykuZiA9ICRwcm9wZXJ0eUlzRW51bWVyYWJsZTtcbiAgcmVxdWlyZSgnLi9fb2JqZWN0LWdvcHMnKS5mID0gJGdldE93blByb3BlcnR5U3ltYm9scztcblxuICBpZiAoREVTQ1JJUFRPUlMgJiYgIXJlcXVpcmUoJy4vX2xpYnJhcnknKSkge1xuICAgIHJlZGVmaW5lKE9iamVjdFByb3RvLCAncHJvcGVydHlJc0VudW1lcmFibGUnLCAkcHJvcGVydHlJc0VudW1lcmFibGUsIHRydWUpO1xuICB9XG5cbiAgd2tzRXh0LmYgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHJldHVybiB3cmFwKHdrcyhuYW1lKSk7XG4gIH07XG59XG5cbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHsgU3ltYm9sOiAkU3ltYm9sIH0pO1xuXG5mb3IgKHZhciBlczZTeW1ib2xzID0gKFxuICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNFxuICAnaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMnXG4pLnNwbGl0KCcsJyksIGogPSAwOyBlczZTeW1ib2xzLmxlbmd0aCA+IGo7KXdrcyhlczZTeW1ib2xzW2orK10pO1xuXG5mb3IgKHZhciB3ZWxsS25vd25TeW1ib2xzID0gJGtleXMod2tzLnN0b3JlKSwgayA9IDA7IHdlbGxLbm93blN5bWJvbHMubGVuZ3RoID4gazspIHdrc0RlZmluZSh3ZWxsS25vd25TeW1ib2xzW2srK10pO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywge1xuICAvLyAxOS40LjIuMSBTeW1ib2wuZm9yKGtleSlcbiAgJ2Zvcic6IGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gaGFzKFN5bWJvbFJlZ2lzdHJ5LCBrZXkgKz0gJycpXG4gICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV1cbiAgICAgIDogU3ltYm9sUmVnaXN0cnlba2V5XSA9ICRTeW1ib2woa2V5KTtcbiAgfSxcbiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pXG4gIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKHN5bSkge1xuICAgIGlmICghaXNTeW1ib2woc3ltKSkgdGhyb3cgVHlwZUVycm9yKHN5bSArICcgaXMgbm90IGEgc3ltYm9sIScpO1xuICAgIGZvciAodmFyIGtleSBpbiBTeW1ib2xSZWdpc3RyeSkgaWYgKFN5bWJvbFJlZ2lzdHJ5W2tleV0gPT09IHN5bSkgcmV0dXJuIGtleTtcbiAgfSxcbiAgdXNlU2V0dGVyOiBmdW5jdGlvbiAoKSB7IHNldHRlciA9IHRydWU7IH0sXG4gIHVzZVNpbXBsZTogZnVuY3Rpb24gKCkgeyBzZXR0ZXIgPSBmYWxzZTsgfVxufSk7XG5cbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsICdPYmplY3QnLCB7XG4gIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSlcbiAgY3JlYXRlOiAkY3JlYXRlLFxuICAvLyAxOS4xLjIuNCBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcylcbiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSxcbiAgLy8gMTkuMS4yLjMgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcylcbiAgZGVmaW5lUHJvcGVydGllczogJGRlZmluZVByb3BlcnRpZXMsXG4gIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUClcbiAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLFxuICAvLyAxOS4xLjIuNyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKVxuICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcyxcbiAgLy8gMTkuMS4yLjggT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhPKVxuICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHNcbn0pO1xuXG4vLyAyNC4zLjIgSlNPTi5zdHJpbmdpZnkodmFsdWUgWywgcmVwbGFjZXIgWywgc3BhY2VdXSlcbiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbiAoKSB7XG4gIHZhciBTID0gJFN5bWJvbCgpO1xuICAvLyBNUyBFZGdlIGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyB7fVxuICAvLyBXZWJLaXQgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIG51bGxcbiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHNcbiAgcmV0dXJuIF9zdHJpbmdpZnkoW1NdKSAhPSAnW251bGxdJyB8fCBfc3RyaW5naWZ5KHsgYTogUyB9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nO1xufSkpLCAnSlNPTicsIHtcbiAgc3RyaW5naWZ5OiBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpIHtcbiAgICB2YXIgYXJncyA9IFtpdF07XG4gICAgdmFyIGkgPSAxO1xuICAgIHZhciByZXBsYWNlciwgJHJlcGxhY2VyO1xuICAgIHdoaWxlIChhcmd1bWVudHMubGVuZ3RoID4gaSkgYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTtcbiAgICAkcmVwbGFjZXIgPSByZXBsYWNlciA9IGFyZ3NbMV07XG4gICAgaWYgKCFpc09iamVjdChyZXBsYWNlcikgJiYgaXQgPT09IHVuZGVmaW5lZCB8fCBpc1N5bWJvbChpdCkpIHJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZFxuICAgIGlmICghaXNBcnJheShyZXBsYWNlcikpIHJlcGxhY2VyID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgIGlmICh0eXBlb2YgJHJlcGxhY2VyID09ICdmdW5jdGlvbicpIHZhbHVlID0gJHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSk7XG4gICAgICBpZiAoIWlzU3ltYm9sKHZhbHVlKSkgcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gICAgYXJnc1sxXSA9IHJlcGxhY2VyO1xuICAgIHJldHVybiBfc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmdzKTtcbiAgfVxufSk7XG5cbi8vIDE5LjQuMy40IFN5bWJvbC5wcm90b3R5cGVbQEB0b1ByaW1pdGl2ZV0oaGludClcbiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IHJlcXVpcmUoJy4vX2hpZGUnKSgkU3ltYm9sW1BST1RPVFlQRV0sIFRPX1BSSU1JVElWRSwgJFN5bWJvbFtQUk9UT1RZUEVdLnZhbHVlT2YpO1xuLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXVxuc2V0VG9TdHJpbmdUYWcoJFN5bWJvbCwgJ1N5bWJvbCcpO1xuLy8gMjAuMi4xLjkgTWF0aFtAQHRvU3RyaW5nVGFnXVxuc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTtcbi8vIDI0LjMuMyBKU09OW0BAdG9TdHJpbmdUYWddXG5zZXRUb1N0cmluZ1RhZyhnbG9iYWwuSlNPTiwgJ0pTT04nLCB0cnVlKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///117\n")},function(module,exports,__webpack_require__){eval("// all enumerable object keys, includes symbols\nvar getKeys = __webpack_require__(32);\nvar gOPS = __webpack_require__(47);\nvar pIE = __webpack_require__(45);\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTE4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fZW51bS1rZXlzLmpzP2Q0YzAiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHNcbnZhciBnZXRLZXlzID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMnKTtcbnZhciBnT1BTID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcHMnKTtcbnZhciBwSUUgPSByZXF1aXJlKCcuL19vYmplY3QtcGllJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICB2YXIgcmVzdWx0ID0gZ2V0S2V5cyhpdCk7XG4gIHZhciBnZXRTeW1ib2xzID0gZ09QUy5mO1xuICBpZiAoZ2V0U3ltYm9scykge1xuICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCk7XG4gICAgdmFyIGlzRW51bSA9IHBJRS5mO1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIga2V5O1xuICAgIHdoaWxlIChzeW1ib2xzLmxlbmd0aCA+IGkpIGlmIChpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSkgcmVzdWx0LnB1c2goa2V5KTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///118\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', { create: __webpack_require__(34) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTE5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmNyZWF0ZS5qcz84NDc4Il0sInNvdXJjZXNDb250ZW50IjpbInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG4vLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSlcbiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0JywgeyBjcmVhdGU6IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///119\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !__webpack_require__(8), 'Object', { defineProperty: __webpack_require__(7).f });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eS5qcz8xYzAxIl0sInNvdXJjZXNDb250ZW50IjpbInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG4vLyAxOS4xLjIuNCAvIDE1LjIuMy42IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKVxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSwgJ09iamVjdCcsIHsgZGVmaW5lUHJvcGVydHk6IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmYgfSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///120\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\n// 19.1.2.3 / 15.2.3.7 Object.defineProperties(O, Properties)\n$export($export.S + $export.F * !__webpack_require__(8), 'Object', { defineProperties: __webpack_require__(87) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0aWVzLmpzPzU4YjIiXSwic291cmNlc0NvbnRlbnQiOlsidmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbi8vIDE5LjEuMi4zIC8gMTUuMi4zLjcgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcylcbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJyksICdPYmplY3QnLCB7IGRlZmluZVByb3BlcnRpZXM6IHJlcXVpcmUoJy4vX29iamVjdC1kcHMnKSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///121\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = __webpack_require__(15);\nvar $getOwnPropertyDescriptor = __webpack_require__(18).f;\n\n__webpack_require__(19)('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvci5qcz85OTg2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUClcbnZhciB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0Jyk7XG52YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykuZjtcblxucmVxdWlyZSgnLi9fb2JqZWN0LXNhcCcpKCdnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3InLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSkge1xuICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///122\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject = __webpack_require__(16);\nvar $getPrototypeOf = __webpack_require__(36);\n\n__webpack_require__(19)('getPrototypeOf', function () {\n  return function getPrototypeOf(it) {\n    return $getPrototypeOf(toObject(it));\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmdldC1wcm90b3R5cGUtb2YuanM/ZTRmNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAxOS4xLjIuOSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTylcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyICRnZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKTtcblxucmVxdWlyZSgnLi9fb2JqZWN0LXNhcCcpKCdnZXRQcm90b3R5cGVPZicsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKGl0KSB7XG4gICAgcmV0dXJuICRnZXRQcm90b3R5cGVPZih0b09iamVjdChpdCkpO1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///123\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.14 Object.keys(O)\nvar toObject = __webpack_require__(16);\nvar $keys = __webpack_require__(32);\n\n__webpack_require__(19)('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTI0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmtleXMuanM/NDU2ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAxOS4xLjIuMTQgT2JqZWN0LmtleXMoTylcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyICRrZXlzID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMnKTtcblxucmVxdWlyZSgnLi9fb2JqZWN0LXNhcCcpKCdrZXlzJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZnVuY3Rpb24ga2V5cyhpdCkge1xuICAgIHJldHVybiAka2V5cyh0b09iamVjdChpdCkpO1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///124\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.7 Object.getOwnPropertyNames(O)\n__webpack_require__(19)('getOwnPropertyNames', function () {\n  return __webpack_require__(88).f;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTI1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktbmFtZXMuanM/MjVkYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAxOS4xLjIuNyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKVxucmVxdWlyZSgnLi9fb2JqZWN0LXNhcCcpKCdnZXRPd25Qcm9wZXJ0eU5hbWVzJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4tZXh0JykuZjtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///125\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.5 Object.freeze(O)\nvar isObject = __webpack_require__(4);\nvar meta = __webpack_require__(28).onFreeze;\n\n__webpack_require__(19)('freeze', function ($freeze) {\n  return function freeze(it) {\n    return $freeze && isObject(it) ? $freeze(meta(it)) : it;\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTI2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmZyZWV6ZS5qcz8wZDZkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi41IE9iamVjdC5mcmVlemUoTylcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIG1ldGEgPSByZXF1aXJlKCcuL19tZXRhJykub25GcmVlemU7XG5cbnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnZnJlZXplJywgZnVuY3Rpb24gKCRmcmVlemUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGZyZWV6ZShpdCkge1xuICAgIHJldHVybiAkZnJlZXplICYmIGlzT2JqZWN0KGl0KSA/ICRmcmVlemUobWV0YShpdCkpIDogaXQ7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///126\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.17 Object.seal(O)\nvar isObject = __webpack_require__(4);\nvar meta = __webpack_require__(28).onFreeze;\n\n__webpack_require__(19)('seal', function ($seal) {\n  return function seal(it) {\n    return $seal && isObject(it) ? $seal(meta(it)) : it;\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTI3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LnNlYWwuanM/Y2Y2YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAxOS4xLjIuMTcgT2JqZWN0LnNlYWwoTylcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIG1ldGEgPSByZXF1aXJlKCcuL19tZXRhJykub25GcmVlemU7XG5cbnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnc2VhbCcsIGZ1bmN0aW9uICgkc2VhbCkge1xuICByZXR1cm4gZnVuY3Rpb24gc2VhbChpdCkge1xuICAgIHJldHVybiAkc2VhbCAmJiBpc09iamVjdChpdCkgPyAkc2VhbChtZXRhKGl0KSkgOiBpdDtcbiAgfTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///127\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.15 Object.preventExtensions(O)\nvar isObject = __webpack_require__(4);\nvar meta = __webpack_require__(28).onFreeze;\n\n__webpack_require__(19)('preventExtensions', function ($preventExtensions) {\n  return function preventExtensions(it) {\n    return $preventExtensions && isObject(it) ? $preventExtensions(meta(it)) : it;\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTI4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LnByZXZlbnQtZXh0ZW5zaW9ucy5qcz85YWVhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi4xNSBPYmplY3QucHJldmVudEV4dGVuc2lvbnMoTylcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIG1ldGEgPSByZXF1aXJlKCcuL19tZXRhJykub25GcmVlemU7XG5cbnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgncHJldmVudEV4dGVuc2lvbnMnLCBmdW5jdGlvbiAoJHByZXZlbnRFeHRlbnNpb25zKSB7XG4gIHJldHVybiBmdW5jdGlvbiBwcmV2ZW50RXh0ZW5zaW9ucyhpdCkge1xuICAgIHJldHVybiAkcHJldmVudEV4dGVuc2lvbnMgJiYgaXNPYmplY3QoaXQpID8gJHByZXZlbnRFeHRlbnNpb25zKG1ldGEoaXQpKSA6IGl0O1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///128\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.12 Object.isFrozen(O)\nvar isObject = __webpack_require__(4);\n\n__webpack_require__(19)('isFrozen', function ($isFrozen) {\n  return function isFrozen(it) {\n    return isObject(it) ? $isFrozen ? $isFrozen(it) : false : true;\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTI5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmlzLWZyb3plbi5qcz82NmM4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi4xMiBPYmplY3QuaXNGcm96ZW4oTylcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xuXG5yZXF1aXJlKCcuL19vYmplY3Qtc2FwJykoJ2lzRnJvemVuJywgZnVuY3Rpb24gKCRpc0Zyb3plbikge1xuICByZXR1cm4gZnVuY3Rpb24gaXNGcm96ZW4oaXQpIHtcbiAgICByZXR1cm4gaXNPYmplY3QoaXQpID8gJGlzRnJvemVuID8gJGlzRnJvemVuKGl0KSA6IGZhbHNlIDogdHJ1ZTtcbiAgfTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///129\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.13 Object.isSealed(O)\nvar isObject = __webpack_require__(4);\n\n__webpack_require__(19)('isSealed', function ($isSealed) {\n  return function isSealed(it) {\n    return isObject(it) ? $isSealed ? $isSealed(it) : false : true;\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmlzLXNlYWxlZC5qcz81N2YwIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi4xMyBPYmplY3QuaXNTZWFsZWQoTylcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xuXG5yZXF1aXJlKCcuL19vYmplY3Qtc2FwJykoJ2lzU2VhbGVkJywgZnVuY3Rpb24gKCRpc1NlYWxlZCkge1xuICByZXR1cm4gZnVuY3Rpb24gaXNTZWFsZWQoaXQpIHtcbiAgICByZXR1cm4gaXNPYmplY3QoaXQpID8gJGlzU2VhbGVkID8gJGlzU2VhbGVkKGl0KSA6IGZhbHNlIDogdHJ1ZTtcbiAgfTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///130\n")},function(module,exports,__webpack_require__){eval("// 19.1.2.11 Object.isExtensible(O)\nvar isObject = __webpack_require__(4);\n\n__webpack_require__(19)('isExtensible', function ($isExtensible) {\n  return function isExtensible(it) {\n    return isObject(it) ? $isExtensible ? $isExtensible(it) : true : false;\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmlzLWV4dGVuc2libGUuanM/MTY1YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAxOS4xLjIuMTEgT2JqZWN0LmlzRXh0ZW5zaWJsZShPKVxudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG5cbnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnaXNFeHRlbnNpYmxlJywgZnVuY3Rpb24gKCRpc0V4dGVuc2libGUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGlzRXh0ZW5zaWJsZShpdCkge1xuICAgIHJldHVybiBpc09iamVjdChpdCkgPyAkaXNFeHRlbnNpYmxlID8gJGlzRXh0ZW5zaWJsZShpdCkgOiB0cnVlIDogZmFsc2U7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///131\n")},function(module,exports,__webpack_require__){eval("// 19.1.3.1 Object.assign(target, source)\nvar $export = __webpack_require__(1);\n\n$export($export.S + $export.F, 'Object', { assign: __webpack_require__(89) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmFzc2lnbi5qcz9mNzUxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMy4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiwgJ09iamVjdCcsIHsgYXNzaWduOiByZXF1aXJlKCcuL19vYmplY3QtYXNzaWduJykgfSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///132\n")},function(module,exports,__webpack_require__){eval("// 19.1.3.10 Object.is(value1, value2)\nvar $export = __webpack_require__(1);\n$export($export.S, 'Object', { is: __webpack_require__(134) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmlzLmpzP2RiOTciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMTkuMS4zLjEwIE9iamVjdC5pcyh2YWx1ZTEsIHZhbHVlMilcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG4kZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHsgaXM6IHJlcXVpcmUoJy4vX3NhbWUtdmFsdWUnKSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///133\n")},function(module,exports){eval("// 7.2.9 SameValue(x, y)\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fc2FtZS12YWx1ZS5qcz84M2ExIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDcuMi45IFNhbWVWYWx1ZSh4LCB5KVxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuaXMgfHwgZnVuY3Rpb24gaXMoeCwgeSkge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gIHJldHVybiB4ID09PSB5ID8geCAhPT0gMCB8fCAxIC8geCA9PT0gMSAvIHkgOiB4ICE9IHggJiYgeSAhPSB5O1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///134\n")},function(module,exports,__webpack_require__){eval("// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = __webpack_require__(1);\n$export($export.S, 'Object', { setPrototypeOf: __webpack_require__(64).set });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LnNldC1wcm90b3R5cGUtb2YuanM/ZmQyNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAxOS4xLjMuMTkgT2JqZWN0LnNldFByb3RvdHlwZU9mKE8sIHByb3RvKVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0JywgeyBzZXRQcm90b3R5cGVPZjogcmVxdWlyZSgnLi9fc2V0LXByb3RvJykuc2V0IH0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///135\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 19.1.3.6 Object.prototype.toString()\nvar classof = __webpack_require__(48);\nvar test = {};\ntest[__webpack_require__(6)('toStringTag')] = 'z';\nif (test + '' != '[object z]') {\n  __webpack_require__(11)(Object.prototype, 'toString', function toString() {\n    return '[object ' + classof(this) + ']';\n  }, true);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZy5qcz8wNmRiIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKVxudmFyIGNsYXNzb2YgPSByZXF1aXJlKCcuL19jbGFzc29mJyk7XG52YXIgdGVzdCA9IHt9O1xudGVzdFtyZXF1aXJlKCcuL193a3MnKSgndG9TdHJpbmdUYWcnKV0gPSAneic7XG5pZiAodGVzdCArICcnICE9ICdbb2JqZWN0IHpdJykge1xuICByZXF1aXJlKCcuL19yZWRlZmluZScpKE9iamVjdC5wcm90b3R5cGUsICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiAnW29iamVjdCAnICsgY2xhc3NvZih0aGlzKSArICddJztcbiAgfSwgdHJ1ZSk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///136\n")},function(module,exports,__webpack_require__){eval("// 19.2.3.2 / 15.3.4.5 Function.prototype.bind(thisArg, args...)\nvar $export = __webpack_require__(1);\n\n$export($export.P, 'Function', { bind: __webpack_require__(90) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuZnVuY3Rpb24uYmluZC5qcz9kOTJhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjIuMy4yIC8gMTUuMy40LjUgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQodGhpc0FyZywgYXJncy4uLilcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QLCAnRnVuY3Rpb24nLCB7IGJpbmQ6IHJlcXVpcmUoJy4vX2JpbmQnKSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///137\n")},function(module,exports,__webpack_require__){eval("var dP = __webpack_require__(7).f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || __webpack_require__(8) && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuZnVuY3Rpb24ubmFtZS5qcz83ZjdmIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBkUCA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmY7XG52YXIgRlByb3RvID0gRnVuY3Rpb24ucHJvdG90eXBlO1xudmFyIG5hbWVSRSA9IC9eXFxzKmZ1bmN0aW9uIChbXiAoXSopLztcbnZhciBOQU1FID0gJ25hbWUnO1xuXG4vLyAxOS4yLjQuMiBuYW1lXG5OQU1FIGluIEZQcm90byB8fCByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpICYmIGRQKEZQcm90bywgTkFNRSwge1xuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gKCcnICsgdGhpcykubWF0Y2gobmFtZVJFKVsxXTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///138\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar isObject = __webpack_require__(4);\nvar getPrototypeOf = __webpack_require__(36);\nvar HAS_INSTANCE = __webpack_require__(6)('hasInstance');\nvar FunctionProto = Function.prototype;\n// 19.2.3.6 Function.prototype[@@hasInstance](V)\nif (!(HAS_INSTANCE in FunctionProto)) __webpack_require__(7).f(FunctionProto, HAS_INSTANCE, { value: function (O) {\n  if (typeof this != 'function' || !isObject(O)) return false;\n  if (!isObject(this.prototype)) return O instanceof this;\n  // for environment w/o native `@@hasInstance` logic enough `instanceof`, but add this:\n  while (O = getPrototypeOf(O)) if (this.prototype === O) return true;\n  return false;\n} });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuZnVuY3Rpb24uaGFzLWluc3RhbmNlLmpzPzIxN2IiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJyk7XG52YXIgSEFTX0lOU1RBTkNFID0gcmVxdWlyZSgnLi9fd2tzJykoJ2hhc0luc3RhbmNlJyk7XG52YXIgRnVuY3Rpb25Qcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcbi8vIDE5LjIuMy42IEZ1bmN0aW9uLnByb3RvdHlwZVtAQGhhc0luc3RhbmNlXShWKVxuaWYgKCEoSEFTX0lOU1RBTkNFIGluIEZ1bmN0aW9uUHJvdG8pKSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mKEZ1bmN0aW9uUHJvdG8sIEhBU19JTlNUQU5DRSwgeyB2YWx1ZTogZnVuY3Rpb24gKE8pIHtcbiAgaWYgKHR5cGVvZiB0aGlzICE9ICdmdW5jdGlvbicgfHwgIWlzT2JqZWN0KE8pKSByZXR1cm4gZmFsc2U7XG4gIGlmICghaXNPYmplY3QodGhpcy5wcm90b3R5cGUpKSByZXR1cm4gTyBpbnN0YW5jZW9mIHRoaXM7XG4gIC8vIGZvciBlbnZpcm9ubWVudCB3L28gbmF0aXZlIGBAQGhhc0luc3RhbmNlYCBsb2dpYyBlbm91Z2ggYGluc3RhbmNlb2ZgLCBidXQgYWRkIHRoaXM6XG4gIHdoaWxlIChPID0gZ2V0UHJvdG90eXBlT2YoTykpIGlmICh0aGlzLnByb3RvdHlwZSA9PT0gTykgcmV0dXJuIHRydWU7XG4gIHJldHVybiBmYWxzZTtcbn0gfSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///139\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar $parseInt = __webpack_require__(92);\n// 18.2.5 parseInt(string, radix)\n$export($export.G + $export.F * (parseInt != $parseInt), { parseInt: $parseInt });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucGFyc2UtaW50LmpzPzE4ZDAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkcGFyc2VJbnQgPSByZXF1aXJlKCcuL19wYXJzZS1pbnQnKTtcbi8vIDE4LjIuNSBwYXJzZUludChzdHJpbmcsIHJhZGl4KVxuJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LkYgKiAocGFyc2VJbnQgIT0gJHBhcnNlSW50KSwgeyBwYXJzZUludDogJHBhcnNlSW50IH0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///140\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar $parseFloat = __webpack_require__(93);\n// 18.2.4 parseFloat(string)\n$export($export.G + $export.F * (parseFloat != $parseFloat), { parseFloat: $parseFloat });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucGFyc2UtZmxvYXQuanM/YjcyYyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyICRwYXJzZUZsb2F0ID0gcmVxdWlyZSgnLi9fcGFyc2UtZmxvYXQnKTtcbi8vIDE4LjIuNCBwYXJzZUZsb2F0KHN0cmluZylcbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5GICogKHBhcnNlRmxvYXQgIT0gJHBhcnNlRmxvYXQpLCB7IHBhcnNlRmxvYXQ6ICRwYXJzZUZsb2F0IH0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///141\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar global = __webpack_require__(3);\nvar has = __webpack_require__(13);\nvar cof = __webpack_require__(23);\nvar inheritIfRequired = __webpack_require__(66);\nvar toPrimitive = __webpack_require__(27);\nvar fails = __webpack_require__(2);\nvar gOPN = __webpack_require__(35).f;\nvar gOPD = __webpack_require__(18).f;\nvar dP = __webpack_require__(7).f;\nvar $trim = __webpack_require__(49).trim;\nvar NUMBER = 'Number';\nvar $Number = global[NUMBER];\nvar Base = $Number;\nvar proto = $Number.prototype;\n// Opera ~12 has broken Object#toString\nvar BROKEN_COF = cof(__webpack_require__(34)(proto)) == NUMBER;\nvar TRIM = 'trim' in String.prototype;\n\n// 7.1.3 ToNumber(argument)\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  if (typeof it == 'string' && it.length > 2) {\n    it = TRIM ? it.trim() : $trim(it, 3);\n    var first = it.charCodeAt(0);\n    var third, radix, maxCode;\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal /^0o[0-7]+$/i\n        default: return +it;\n      }\n      for (var digits = it.slice(2), i = 0, l = digits.length, code; i < l; i++) {\n        code = digits.charCodeAt(i);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\nif (!$Number(' 0o1') || !$Number('0b1') || $Number('+0x1')) {\n  $Number = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var that = this;\n    return that instanceof $Number\n      // check on 1..constructor(foo) case\n      && (BROKEN_COF ? fails(function () { proto.valueOf.call(that); }) : cof(that) != NUMBER)\n        ? inheritIfRequired(new Base(toNumber(it)), that, $Number) : toNumber(it);\n  };\n  for (var keys = __webpack_require__(8) ? gOPN(Base) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES6 (in case, if modules with ES6 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(Base, key = keys[j]) && !has($Number, key)) {\n      dP($Number, key, gOPD(Base, key));\n    }\n  }\n  $Number.prototype = proto;\n  proto.constructor = $Number;\n  __webpack_require__(11)(global, NUMBER, $Number);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLmNvbnN0cnVjdG9yLmpzP2M1ZjYiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIGNvZiA9IHJlcXVpcmUoJy4vX2NvZicpO1xudmFyIGluaGVyaXRJZlJlcXVpcmVkID0gcmVxdWlyZSgnLi9faW5oZXJpdC1pZi1yZXF1aXJlZCcpO1xudmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJyk7XG52YXIgZmFpbHMgPSByZXF1aXJlKCcuL19mYWlscycpO1xudmFyIGdPUE4gPSByZXF1aXJlKCcuL19vYmplY3QtZ29wbicpLmY7XG52YXIgZ09QRCA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykuZjtcbnZhciBkUCA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmY7XG52YXIgJHRyaW0gPSByZXF1aXJlKCcuL19zdHJpbmctdHJpbScpLnRyaW07XG52YXIgTlVNQkVSID0gJ051bWJlcic7XG52YXIgJE51bWJlciA9IGdsb2JhbFtOVU1CRVJdO1xudmFyIEJhc2UgPSAkTnVtYmVyO1xudmFyIHByb3RvID0gJE51bWJlci5wcm90b3R5cGU7XG4vLyBPcGVyYSB+MTIgaGFzIGJyb2tlbiBPYmplY3QjdG9TdHJpbmdcbnZhciBCUk9LRU5fQ09GID0gY29mKHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKShwcm90bykpID09IE5VTUJFUjtcbnZhciBUUklNID0gJ3RyaW0nIGluIFN0cmluZy5wcm90b3R5cGU7XG5cbi8vIDcuMS4zIFRvTnVtYmVyKGFyZ3VtZW50KVxudmFyIHRvTnVtYmVyID0gZnVuY3Rpb24gKGFyZ3VtZW50KSB7XG4gIHZhciBpdCA9IHRvUHJpbWl0aXZlKGFyZ3VtZW50LCBmYWxzZSk7XG4gIGlmICh0eXBlb2YgaXQgPT0gJ3N0cmluZycgJiYgaXQubGVuZ3RoID4gMikge1xuICAgIGl0ID0gVFJJTSA/IGl0LnRyaW0oKSA6ICR0cmltKGl0LCAzKTtcbiAgICB2YXIgZmlyc3QgPSBpdC5jaGFyQ29kZUF0KDApO1xuICAgIHZhciB0aGlyZCwgcmFkaXgsIG1heENvZGU7XG4gICAgaWYgKGZpcnN0ID09PSA0MyB8fCBmaXJzdCA9PT0gNDUpIHtcbiAgICAgIHRoaXJkID0gaXQuY2hhckNvZGVBdCgyKTtcbiAgICAgIGlmICh0aGlyZCA9PT0gODggfHwgdGhpcmQgPT09IDEyMCkgcmV0dXJuIE5hTjsgLy8gTnVtYmVyKCcrMHgxJykgc2hvdWxkIGJlIE5hTiwgb2xkIFY4IGZpeFxuICAgIH0gZWxzZSBpZiAoZmlyc3QgPT09IDQ4KSB7XG4gICAgICBzd2l0Y2ggKGl0LmNoYXJDb2RlQXQoMSkpIHtcbiAgICAgICAgY2FzZSA2NjogY2FzZSA5ODogcmFkaXggPSAyOyBtYXhDb2RlID0gNDk7IGJyZWFrOyAvLyBmYXN0IGVxdWFsIC9eMGJbMDFdKyQvaVxuICAgICAgICBjYXNlIDc5OiBjYXNlIDExMTogcmFkaXggPSA4OyBtYXhDb2RlID0gNTU7IGJyZWFrOyAvLyBmYXN0IGVxdWFsIC9eMG9bMC03XSskL2lcbiAgICAgICAgZGVmYXVsdDogcmV0dXJuICtpdDtcbiAgICAgIH1cbiAgICAgIGZvciAodmFyIGRpZ2l0cyA9IGl0LnNsaWNlKDIpLCBpID0gMCwgbCA9IGRpZ2l0cy5sZW5ndGgsIGNvZGU7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgY29kZSA9IGRpZ2l0cy5jaGFyQ29kZUF0KGkpO1xuICAgICAgICAvLyBwYXJzZUludCBwYXJzZXMgYSBzdHJpbmcgdG8gYSBmaXJzdCB1bmF2YWlsYWJsZSBzeW1ib2xcbiAgICAgICAgLy8gYnV0IFRvTnVtYmVyIHNob3VsZCByZXR1cm4gTmFOIGlmIGEgc3RyaW5nIGNvbnRhaW5zIHVuYXZhaWxhYmxlIHN5bWJvbHNcbiAgICAgICAgaWYgKGNvZGUgPCA0OCB8fCBjb2RlID4gbWF4Q29kZSkgcmV0dXJuIE5hTjtcbiAgICAgIH0gcmV0dXJuIHBhcnNlSW50KGRpZ2l0cywgcmFkaXgpO1xuICAgIH1cbiAgfSByZXR1cm4gK2l0O1xufTtcblxuaWYgKCEkTnVtYmVyKCcgMG8xJykgfHwgISROdW1iZXIoJzBiMScpIHx8ICROdW1iZXIoJysweDEnKSkge1xuICAkTnVtYmVyID0gZnVuY3Rpb24gTnVtYmVyKHZhbHVlKSB7XG4gICAgdmFyIGl0ID0gYXJndW1lbnRzLmxlbmd0aCA8IDEgPyAwIDogdmFsdWU7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHJldHVybiB0aGF0IGluc3RhbmNlb2YgJE51bWJlclxuICAgICAgLy8gY2hlY2sgb24gMS4uY29uc3RydWN0b3IoZm9vKSBjYXNlXG4gICAgICAmJiAoQlJPS0VOX0NPRiA/IGZhaWxzKGZ1bmN0aW9uICgpIHsgcHJvdG8udmFsdWVPZi5jYWxsKHRoYXQpOyB9KSA6IGNvZih0aGF0KSAhPSBOVU1CRVIpXG4gICAgICAgID8gaW5oZXJpdElmUmVxdWlyZWQobmV3IEJhc2UodG9OdW1iZXIoaXQpKSwgdGhhdCwgJE51bWJlcikgOiB0b051bWJlcihpdCk7XG4gIH07XG4gIGZvciAodmFyIGtleXMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpID8gZ09QTihCYXNlKSA6IChcbiAgICAvLyBFUzM6XG4gICAgJ01BWF9WQUxVRSxNSU5fVkFMVUUsTmFOLE5FR0FUSVZFX0lORklOSVRZLFBPU0lUSVZFX0lORklOSVRZLCcgK1xuICAgIC8vIEVTNiAoaW4gY2FzZSwgaWYgbW9kdWxlcyB3aXRoIEVTNiBOdW1iZXIgc3RhdGljcyByZXF1aXJlZCBiZWZvcmUpOlxuICAgICdFUFNJTE9OLGlzRmluaXRlLGlzSW50ZWdlcixpc05hTixpc1NhZmVJbnRlZ2VyLE1BWF9TQUZFX0lOVEVHRVIsJyArXG4gICAgJ01JTl9TQUZFX0lOVEVHRVIscGFyc2VGbG9hdCxwYXJzZUludCxpc0ludGVnZXInXG4gICkuc3BsaXQoJywnKSwgaiA9IDAsIGtleTsga2V5cy5sZW5ndGggPiBqOyBqKyspIHtcbiAgICBpZiAoaGFzKEJhc2UsIGtleSA9IGtleXNbal0pICYmICFoYXMoJE51bWJlciwga2V5KSkge1xuICAgICAgZFAoJE51bWJlciwga2V5LCBnT1BEKEJhc2UsIGtleSkpO1xuICAgIH1cbiAgfVxuICAkTnVtYmVyLnByb3RvdHlwZSA9IHByb3RvO1xuICBwcm90by5jb25zdHJ1Y3RvciA9ICROdW1iZXI7XG4gIHJlcXVpcmUoJy4vX3JlZGVmaW5lJykoZ2xvYmFsLCBOVU1CRVIsICROdW1iZXIpO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///142\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar toInteger = __webpack_require__(25);\nvar aNumberValue = __webpack_require__(94);\nvar repeat = __webpack_require__(67);\nvar $toFixed = 1.0.toFixed;\nvar floor = Math.floor;\nvar data = [0, 0, 0, 0, 0, 0];\nvar ERROR = 'Number.toFixed: incorrect invocation!';\nvar ZERO = '0';\n\nvar multiply = function (n, c) {\n  var i = -1;\n  var c2 = c;\n  while (++i < 6) {\n    c2 += n * data[i];\n    data[i] = c2 % 1e7;\n    c2 = floor(c2 / 1e7);\n  }\n};\nvar divide = function (n) {\n  var i = 6;\n  var c = 0;\n  while (--i >= 0) {\n    c += data[i];\n    data[i] = floor(c / n);\n    c = (c % n) * 1e7;\n  }\n};\nvar numToString = function () {\n  var i = 6;\n  var s = '';\n  while (--i >= 0) {\n    if (s !== '' || i === 0 || data[i] !== 0) {\n      var t = String(data[i]);\n      s = s === '' ? t : s + repeat.call(ZERO, 7 - t.length) + t;\n    }\n  } return s;\n};\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\n$export($export.P + $export.F * (!!$toFixed && (\n  0.00008.toFixed(3) !== '0.000' ||\n  0.9.toFixed(0) !== '1' ||\n  1.255.toFixed(2) !== '1.25' ||\n  1000000000000000128.0.toFixed(0) !== '1000000000000000128'\n) || !__webpack_require__(2)(function () {\n  // V8 ~ Android 4.3-\n  $toFixed.call({});\n})), 'Number', {\n  toFixed: function toFixed(fractionDigits) {\n    var x = aNumberValue(this, ERROR);\n    var f = toInteger(fractionDigits);\n    var s = '';\n    var m = ZERO;\n    var e, z, j, k;\n    if (f < 0 || f > 20) throw RangeError(ERROR);\n    // eslint-disable-next-line no-self-compare\n    if (x != x) return 'NaN';\n    if (x <= -1e21 || x >= 1e21) return String(x);\n    if (x < 0) {\n      s = '-';\n      x = -x;\n    }\n    if (x > 1e-21) {\n      e = log(x * pow(2, 69, 1)) - 69;\n      z = e < 0 ? x * pow(2, -e, 1) : x / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(0, z);\n        j = f;\n        while (j >= 7) {\n          multiply(1e7, 0);\n          j -= 7;\n        }\n        multiply(pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(1 << 23);\n          j -= 23;\n        }\n        divide(1 << j);\n        multiply(1, 1);\n        divide(2);\n        m = numToString();\n      } else {\n        multiply(0, z);\n        multiply(1 << -e, 0);\n        m = numToString() + repeat.call(ZERO, f);\n      }\n    }\n    if (f > 0) {\n      k = m.length;\n      m = s + (k <= f ? '0.' + repeat.call(ZERO, f - k) + m : m.slice(0, k - f) + '.' + m.slice(k - f));\n    } else {\n      m = s + m;\n    } return m;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLnRvLWZpeGVkLmpzPzAzNmMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJyk7XG52YXIgYU51bWJlclZhbHVlID0gcmVxdWlyZSgnLi9fYS1udW1iZXItdmFsdWUnKTtcbnZhciByZXBlYXQgPSByZXF1aXJlKCcuL19zdHJpbmctcmVwZWF0Jyk7XG52YXIgJHRvRml4ZWQgPSAxLjAudG9GaXhlZDtcbnZhciBmbG9vciA9IE1hdGguZmxvb3I7XG52YXIgZGF0YSA9IFswLCAwLCAwLCAwLCAwLCAwXTtcbnZhciBFUlJPUiA9ICdOdW1iZXIudG9GaXhlZDogaW5jb3JyZWN0IGludm9jYXRpb24hJztcbnZhciBaRVJPID0gJzAnO1xuXG52YXIgbXVsdGlwbHkgPSBmdW5jdGlvbiAobiwgYykge1xuICB2YXIgaSA9IC0xO1xuICB2YXIgYzIgPSBjO1xuICB3aGlsZSAoKytpIDwgNikge1xuICAgIGMyICs9IG4gKiBkYXRhW2ldO1xuICAgIGRhdGFbaV0gPSBjMiAlIDFlNztcbiAgICBjMiA9IGZsb29yKGMyIC8gMWU3KTtcbiAgfVxufTtcbnZhciBkaXZpZGUgPSBmdW5jdGlvbiAobikge1xuICB2YXIgaSA9IDY7XG4gIHZhciBjID0gMDtcbiAgd2hpbGUgKC0taSA+PSAwKSB7XG4gICAgYyArPSBkYXRhW2ldO1xuICAgIGRhdGFbaV0gPSBmbG9vcihjIC8gbik7XG4gICAgYyA9IChjICUgbikgKiAxZTc7XG4gIH1cbn07XG52YXIgbnVtVG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBpID0gNjtcbiAgdmFyIHMgPSAnJztcbiAgd2hpbGUgKC0taSA+PSAwKSB7XG4gICAgaWYgKHMgIT09ICcnIHx8IGkgPT09IDAgfHwgZGF0YVtpXSAhPT0gMCkge1xuICAgICAgdmFyIHQgPSBTdHJpbmcoZGF0YVtpXSk7XG4gICAgICBzID0gcyA9PT0gJycgPyB0IDogcyArIHJlcGVhdC5jYWxsKFpFUk8sIDcgLSB0Lmxlbmd0aCkgKyB0O1xuICAgIH1cbiAgfSByZXR1cm4gcztcbn07XG52YXIgcG93ID0gZnVuY3Rpb24gKHgsIG4sIGFjYykge1xuICByZXR1cm4gbiA9PT0gMCA/IGFjYyA6IG4gJSAyID09PSAxID8gcG93KHgsIG4gLSAxLCBhY2MgKiB4KSA6IHBvdyh4ICogeCwgbiAvIDIsIGFjYyk7XG59O1xudmFyIGxvZyA9IGZ1bmN0aW9uICh4KSB7XG4gIHZhciBuID0gMDtcbiAgdmFyIHgyID0geDtcbiAgd2hpbGUgKHgyID49IDQwOTYpIHtcbiAgICBuICs9IDEyO1xuICAgIHgyIC89IDQwOTY7XG4gIH1cbiAgd2hpbGUgKHgyID49IDIpIHtcbiAgICBuICs9IDE7XG4gICAgeDIgLz0gMjtcbiAgfSByZXR1cm4gbjtcbn07XG5cbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKCEhJHRvRml4ZWQgJiYgKFxuICAwLjAwMDA4LnRvRml4ZWQoMykgIT09ICcwLjAwMCcgfHxcbiAgMC45LnRvRml4ZWQoMCkgIT09ICcxJyB8fFxuICAxLjI1NS50b0ZpeGVkKDIpICE9PSAnMS4yNScgfHxcbiAgMTAwMDAwMDAwMDAwMDAwMDEyOC4wLnRvRml4ZWQoMCkgIT09ICcxMDAwMDAwMDAwMDAwMDAwMTI4J1xuKSB8fCAhcmVxdWlyZSgnLi9fZmFpbHMnKShmdW5jdGlvbiAoKSB7XG4gIC8vIFY4IH4gQW5kcm9pZCA0LjMtXG4gICR0b0ZpeGVkLmNhbGwoe30pO1xufSkpLCAnTnVtYmVyJywge1xuICB0b0ZpeGVkOiBmdW5jdGlvbiB0b0ZpeGVkKGZyYWN0aW9uRGlnaXRzKSB7XG4gICAgdmFyIHggPSBhTnVtYmVyVmFsdWUodGhpcywgRVJST1IpO1xuICAgIHZhciBmID0gdG9JbnRlZ2VyKGZyYWN0aW9uRGlnaXRzKTtcbiAgICB2YXIgcyA9ICcnO1xuICAgIHZhciBtID0gWkVSTztcbiAgICB2YXIgZSwgeiwgaiwgaztcbiAgICBpZiAoZiA8IDAgfHwgZiA+IDIwKSB0aHJvdyBSYW5nZUVycm9yKEVSUk9SKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgaWYgKHggIT0geCkgcmV0dXJuICdOYU4nO1xuICAgIGlmICh4IDw9IC0xZTIxIHx8IHggPj0gMWUyMSkgcmV0dXJuIFN0cmluZyh4KTtcbiAgICBpZiAoeCA8IDApIHtcbiAgICAgIHMgPSAnLSc7XG4gICAgICB4ID0gLXg7XG4gICAgfVxuICAgIGlmICh4ID4gMWUtMjEpIHtcbiAgICAgIGUgPSBsb2coeCAqIHBvdygyLCA2OSwgMSkpIC0gNjk7XG4gICAgICB6ID0gZSA8IDAgPyB4ICogcG93KDIsIC1lLCAxKSA6IHggLyBwb3coMiwgZSwgMSk7XG4gICAgICB6ICo9IDB4MTAwMDAwMDAwMDAwMDA7XG4gICAgICBlID0gNTIgLSBlO1xuICAgICAgaWYgKGUgPiAwKSB7XG4gICAgICAgIG11bHRpcGx5KDAsIHopO1xuICAgICAgICBqID0gZjtcbiAgICAgICAgd2hpbGUgKGogPj0gNykge1xuICAgICAgICAgIG11bHRpcGx5KDFlNywgMCk7XG4gICAgICAgICAgaiAtPSA3O1xuICAgICAgICB9XG4gICAgICAgIG11bHRpcGx5KHBvdygxMCwgaiwgMSksIDApO1xuICAgICAgICBqID0gZSAtIDE7XG4gICAgICAgIHdoaWxlIChqID49IDIzKSB7XG4gICAgICAgICAgZGl2aWRlKDEgPDwgMjMpO1xuICAgICAgICAgIGogLT0gMjM7XG4gICAgICAgIH1cbiAgICAgICAgZGl2aWRlKDEgPDwgaik7XG4gICAgICAgIG11bHRpcGx5KDEsIDEpO1xuICAgICAgICBkaXZpZGUoMik7XG4gICAgICAgIG0gPSBudW1Ub1N0cmluZygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbXVsdGlwbHkoMCwgeik7XG4gICAgICAgIG11bHRpcGx5KDEgPDwgLWUsIDApO1xuICAgICAgICBtID0gbnVtVG9TdHJpbmcoKSArIHJlcGVhdC5jYWxsKFpFUk8sIGYpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZiA+IDApIHtcbiAgICAgIGsgPSBtLmxlbmd0aDtcbiAgICAgIG0gPSBzICsgKGsgPD0gZiA/ICcwLicgKyByZXBlYXQuY2FsbChaRVJPLCBmIC0gaykgKyBtIDogbS5zbGljZSgwLCBrIC0gZikgKyAnLicgKyBtLnNsaWNlKGsgLSBmKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSBzICsgbTtcbiAgICB9IHJldHVybiBtO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///143\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $fails = __webpack_require__(2);\nvar aNumberValue = __webpack_require__(94);\nvar $toPrecision = 1.0.toPrecision;\n\n$export($export.P + $export.F * ($fails(function () {\n  // IE7-\n  return $toPrecision.call(1, undefined) !== '1';\n}) || !$fails(function () {\n  // V8 ~ Android 4.3-\n  $toPrecision.call({});\n})), 'Number', {\n  toPrecision: function toPrecision(precision) {\n    var that = aNumberValue(this, 'Number#toPrecision: incorrect invocation!');\n    return precision === undefined ? $toPrecision.call(that) : $toPrecision.call(that, precision);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQ0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLnRvLXByZWNpc2lvbi5qcz81NGE4Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgJGZhaWxzID0gcmVxdWlyZSgnLi9fZmFpbHMnKTtcbnZhciBhTnVtYmVyVmFsdWUgPSByZXF1aXJlKCcuL19hLW51bWJlci12YWx1ZScpO1xudmFyICR0b1ByZWNpc2lvbiA9IDEuMC50b1ByZWNpc2lvbjtcblxuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAoJGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgLy8gSUU3LVxuICByZXR1cm4gJHRvUHJlY2lzaW9uLmNhbGwoMSwgdW5kZWZpbmVkKSAhPT0gJzEnO1xufSkgfHwgISRmYWlscyhmdW5jdGlvbiAoKSB7XG4gIC8vIFY4IH4gQW5kcm9pZCA0LjMtXG4gICR0b1ByZWNpc2lvbi5jYWxsKHt9KTtcbn0pKSwgJ051bWJlcicsIHtcbiAgdG9QcmVjaXNpb246IGZ1bmN0aW9uIHRvUHJlY2lzaW9uKHByZWNpc2lvbikge1xuICAgIHZhciB0aGF0ID0gYU51bWJlclZhbHVlKHRoaXMsICdOdW1iZXIjdG9QcmVjaXNpb246IGluY29ycmVjdCBpbnZvY2F0aW9uIScpO1xuICAgIHJldHVybiBwcmVjaXNpb24gPT09IHVuZGVmaW5lZCA/ICR0b1ByZWNpc2lvbi5jYWxsKHRoYXQpIDogJHRvUHJlY2lzaW9uLmNhbGwodGhhdCwgcHJlY2lzaW9uKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///144\n")},function(module,exports,__webpack_require__){eval("// 20.1.2.1 Number.EPSILON\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Number', { EPSILON: Math.pow(2, -52) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQ1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLmVwc2lsb24uanM/MmUzNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMC4xLjIuMSBOdW1iZXIuRVBTSUxPTlxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdOdW1iZXInLCB7IEVQU0lMT046IE1hdGgucG93KDIsIC01MikgfSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///145\n")},function(module,exports,__webpack_require__){eval("// 20.1.2.2 Number.isFinite(number)\nvar $export = __webpack_require__(1);\nvar _isFinite = __webpack_require__(3).isFinite;\n\n$export($export.S, 'Number', {\n  isFinite: function isFinite(it) {\n    return typeof it == 'number' && _isFinite(it);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQ2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLmlzLWZpbml0ZS5qcz9mY2EwIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjEuMi4yIE51bWJlci5pc0Zpbml0ZShudW1iZXIpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIF9pc0Zpbml0ZSA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpLmlzRmluaXRlO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ051bWJlcicsIHtcbiAgaXNGaW5pdGU6IGZ1bmN0aW9uIGlzRmluaXRlKGl0KSB7XG4gICAgcmV0dXJuIHR5cGVvZiBpdCA9PSAnbnVtYmVyJyAmJiBfaXNGaW5pdGUoaXQpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///146\n")},function(module,exports,__webpack_require__){eval("// 20.1.2.3 Number.isInteger(number)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Number', { isInteger: __webpack_require__(95) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQ3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLmlzLWludGVnZXIuanM/N2NkZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMC4xLjIuMyBOdW1iZXIuaXNJbnRlZ2VyKG51bWJlcilcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnTnVtYmVyJywgeyBpc0ludGVnZXI6IHJlcXVpcmUoJy4vX2lzLWludGVnZXInKSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///147\n")},function(module,exports,__webpack_require__){eval("// 20.1.2.4 Number.isNaN(number)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Number', {\n  isNaN: function isNaN(number) {\n    // eslint-disable-next-line no-self-compare\n    return number != number;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQ4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLmlzLW5hbi5qcz9lZTFkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjEuMi40IE51bWJlci5pc05hTihudW1iZXIpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ051bWJlcicsIHtcbiAgaXNOYU46IGZ1bmN0aW9uIGlzTmFOKG51bWJlcikge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWNvbXBhcmVcbiAgICByZXR1cm4gbnVtYmVyICE9IG51bWJlcjtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///148\n")},function(module,exports,__webpack_require__){eval("// 20.1.2.5 Number.isSafeInteger(number)\nvar $export = __webpack_require__(1);\nvar isInteger = __webpack_require__(95);\nvar abs = Math.abs;\n\n$export($export.S, 'Number', {\n  isSafeInteger: function isSafeInteger(number) {\n    return isInteger(number) && abs(number) <= 0x1fffffffffffff;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQ5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLmlzLXNhZmUtaW50ZWdlci5qcz9iMWIxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjEuMi41IE51bWJlci5pc1NhZmVJbnRlZ2VyKG51bWJlcilcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgaXNJbnRlZ2VyID0gcmVxdWlyZSgnLi9faXMtaW50ZWdlcicpO1xudmFyIGFicyA9IE1hdGguYWJzO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ051bWJlcicsIHtcbiAgaXNTYWZlSW50ZWdlcjogZnVuY3Rpb24gaXNTYWZlSW50ZWdlcihudW1iZXIpIHtcbiAgICByZXR1cm4gaXNJbnRlZ2VyKG51bWJlcikgJiYgYWJzKG51bWJlcikgPD0gMHgxZmZmZmZmZmZmZmZmZjtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///149\n")},function(module,exports,__webpack_require__){eval("// 20.1.2.6 Number.MAX_SAFE_INTEGER\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Number', { MAX_SAFE_INTEGER: 0x1fffffffffffff });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLm1heC1zYWZlLWludGVnZXIuanM/ODdmMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMC4xLjIuNiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUlxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdOdW1iZXInLCB7IE1BWF9TQUZFX0lOVEVHRVI6IDB4MWZmZmZmZmZmZmZmZmYgfSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///150\n")},function(module,exports,__webpack_require__){eval("// 20.1.2.10 Number.MIN_SAFE_INTEGER\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Number', { MIN_SAFE_INTEGER: -0x1fffffffffffff });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLm1pbi1zYWZlLWludGVnZXIuanM/OTI3OCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMC4xLjIuMTAgTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVJcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnTnVtYmVyJywgeyBNSU5fU0FGRV9JTlRFR0VSOiAtMHgxZmZmZmZmZmZmZmZmZiB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///151\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar $parseFloat = __webpack_require__(93);\n// 20.1.2.12 Number.parseFloat(string)\n$export($export.S + $export.F * (Number.parseFloat != $parseFloat), 'Number', { parseFloat: $parseFloat });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLnBhcnNlLWZsb2F0LmpzPzVkZjIiXSwic291cmNlc0NvbnRlbnQiOlsidmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkcGFyc2VGbG9hdCA9IHJlcXVpcmUoJy4vX3BhcnNlLWZsb2F0Jyk7XG4vLyAyMC4xLjIuMTIgTnVtYmVyLnBhcnNlRmxvYXQoc3RyaW5nKVxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTnVtYmVyLnBhcnNlRmxvYXQgIT0gJHBhcnNlRmxvYXQpLCAnTnVtYmVyJywgeyBwYXJzZUZsb2F0OiAkcGFyc2VGbG9hdCB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///152\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar $parseInt = __webpack_require__(92);\n// 20.1.2.13 Number.parseInt(string, radix)\n$export($export.S + $export.F * (Number.parseInt != $parseInt), 'Number', { parseInt: $parseInt });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubnVtYmVyLnBhcnNlLWludC5qcz8wNGZmIl0sInNvdXJjZXNDb250ZW50IjpbInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgJHBhcnNlSW50ID0gcmVxdWlyZSgnLi9fcGFyc2UtaW50Jyk7XG4vLyAyMC4xLjIuMTMgTnVtYmVyLnBhcnNlSW50KHN0cmluZywgcmFkaXgpXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIChOdW1iZXIucGFyc2VJbnQgIT0gJHBhcnNlSW50KSwgJ051bWJlcicsIHsgcGFyc2VJbnQ6ICRwYXJzZUludCB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///153\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.3 Math.acosh(x)\nvar $export = __webpack_require__(1);\nvar log1p = __webpack_require__(96);\nvar sqrt = Math.sqrt;\nvar $acosh = Math.acosh;\n\n$export($export.S + $export.F * !($acosh\n  // V8 bug: https://code.google.com/p/v8/issues/detail?id=3509\n  && Math.floor($acosh(Number.MAX_VALUE)) == 710\n  // Tor Browser bug: Math.acosh(Infinity) -> NaN\n  && $acosh(Infinity) == Infinity\n), 'Math', {\n  acosh: function acosh(x) {\n    return (x = +x) < 1 ? NaN : x > 94906265.62425156\n      ? Math.log(x) + Math.LN2\n      : log1p(x - 1 + sqrt(x - 1) * sqrt(x + 1));\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTU0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5hY29zaC5qcz83ZjI1Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi4zIE1hdGguYWNvc2goeClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgbG9nMXAgPSByZXF1aXJlKCcuL19tYXRoLWxvZzFwJyk7XG52YXIgc3FydCA9IE1hdGguc3FydDtcbnZhciAkYWNvc2ggPSBNYXRoLmFjb3NoO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoJGFjb3NoXG4gIC8vIFY4IGJ1ZzogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTM1MDlcbiAgJiYgTWF0aC5mbG9vcigkYWNvc2goTnVtYmVyLk1BWF9WQUxVRSkpID09IDcxMFxuICAvLyBUb3IgQnJvd3NlciBidWc6IE1hdGguYWNvc2goSW5maW5pdHkpIC0+IE5hTlxuICAmJiAkYWNvc2goSW5maW5pdHkpID09IEluZmluaXR5XG4pLCAnTWF0aCcsIHtcbiAgYWNvc2g6IGZ1bmN0aW9uIGFjb3NoKHgpIHtcbiAgICByZXR1cm4gKHggPSAreCkgPCAxID8gTmFOIDogeCA+IDk0OTA2MjY1LjYyNDI1MTU2XG4gICAgICA/IE1hdGgubG9nKHgpICsgTWF0aC5MTjJcbiAgICAgIDogbG9nMXAoeCAtIDEgKyBzcXJ0KHggLSAxKSAqIHNxcnQoeCArIDEpKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///154\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.5 Math.asinh(x)\nvar $export = __webpack_require__(1);\nvar $asinh = Math.asinh;\n\nfunction asinh(x) {\n  return !isFinite(x = +x) || x == 0 ? x : x < 0 ? -asinh(-x) : Math.log(x + Math.sqrt(x * x + 1));\n}\n\n// Tor Browser bug: Math.asinh(0) -> -0\n$export($export.S + $export.F * !($asinh && 1 / $asinh(0) > 0), 'Math', { asinh: asinh });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTU1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5hc2luaC5qcz81MzZiIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi41IE1hdGguYXNpbmgoeClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgJGFzaW5oID0gTWF0aC5hc2luaDtcblxuZnVuY3Rpb24gYXNpbmgoeCkge1xuICByZXR1cm4gIWlzRmluaXRlKHggPSAreCkgfHwgeCA9PSAwID8geCA6IHggPCAwID8gLWFzaW5oKC14KSA6IE1hdGgubG9nKHggKyBNYXRoLnNxcnQoeCAqIHggKyAxKSk7XG59XG5cbi8vIFRvciBCcm93c2VyIGJ1ZzogTWF0aC5hc2luaCgwKSAtPiAtMFxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhKCRhc2luaCAmJiAxIC8gJGFzaW5oKDApID4gMCksICdNYXRoJywgeyBhc2luaDogYXNpbmggfSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///155\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.7 Math.atanh(x)\nvar $export = __webpack_require__(1);\nvar $atanh = Math.atanh;\n\n// Tor Browser bug: Math.atanh(-0) -> 0\n$export($export.S + $export.F * !($atanh && 1 / $atanh(-0) < 0), 'Math', {\n  atanh: function atanh(x) {\n    return (x = +x) == 0 ? x : Math.log((1 + x) / (1 - x)) / 2;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTU2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5hdGFuaC5qcz9kOWFiIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi43IE1hdGguYXRhbmgoeClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgJGF0YW5oID0gTWF0aC5hdGFuaDtcblxuLy8gVG9yIEJyb3dzZXIgYnVnOiBNYXRoLmF0YW5oKC0wKSAtPiAwXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoJGF0YW5oICYmIDEgLyAkYXRhbmgoLTApIDwgMCksICdNYXRoJywge1xuICBhdGFuaDogZnVuY3Rpb24gYXRhbmgoeCkge1xuICAgIHJldHVybiAoeCA9ICt4KSA9PSAwID8geCA6IE1hdGgubG9nKCgxICsgeCkgLyAoMSAtIHgpKSAvIDI7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///156\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.9 Math.cbrt(x)\nvar $export = __webpack_require__(1);\nvar sign = __webpack_require__(68);\n\n$export($export.S, 'Math', {\n  cbrt: function cbrt(x) {\n    return sign(x = +x) * Math.pow(Math.abs(x), 1 / 3);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTU3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5jYnJ0LmpzP2Y5YWIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjkgTWF0aC5jYnJ0KHgpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIHNpZ24gPSByZXF1aXJlKCcuL19tYXRoLXNpZ24nKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywge1xuICBjYnJ0OiBmdW5jdGlvbiBjYnJ0KHgpIHtcbiAgICByZXR1cm4gc2lnbih4ID0gK3gpICogTWF0aC5wb3coTWF0aC5hYnMoeCksIDEgLyAzKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///157\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.11 Math.clz32(x)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Math', {\n  clz32: function clz32(x) {\n    return (x >>>= 0) ? 31 - Math.floor(Math.log(x + 0.5) * Math.LOG2E) : 32;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTU4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5jbHozMi5qcz8zMmQ3Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi4xMSBNYXRoLmNsejMyKHgpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7XG4gIGNsejMyOiBmdW5jdGlvbiBjbHozMih4KSB7XG4gICAgcmV0dXJuICh4ID4+Pj0gMCkgPyAzMSAtIE1hdGguZmxvb3IoTWF0aC5sb2coeCArIDAuNSkgKiBNYXRoLkxPRzJFKSA6IDMyO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///158\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.12 Math.cosh(x)\nvar $export = __webpack_require__(1);\nvar exp = Math.exp;\n\n$export($export.S, 'Math', {\n  cosh: function cosh(x) {\n    return (exp(x = +x) + exp(-x)) / 2;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTU5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5jb3NoLmpzPzI1YzkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjEyIE1hdGguY29zaCh4KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBleHAgPSBNYXRoLmV4cDtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywge1xuICBjb3NoOiBmdW5jdGlvbiBjb3NoKHgpIHtcbiAgICByZXR1cm4gKGV4cCh4ID0gK3gpICsgZXhwKC14KSkgLyAyO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///159\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.14 Math.expm1(x)\nvar $export = __webpack_require__(1);\nvar $expm1 = __webpack_require__(69);\n\n$export($export.S + $export.F * ($expm1 != Math.expm1), 'Math', { expm1: $expm1 });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5leHBtMS5qcz85ZjNjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi4xNCBNYXRoLmV4cG0xKHgpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyICRleHBtMSA9IHJlcXVpcmUoJy4vX21hdGgtZXhwbTEnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoJGV4cG0xICE9IE1hdGguZXhwbTEpLCAnTWF0aCcsIHsgZXhwbTE6ICRleHBtMSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///160\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.16 Math.fround(x)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Math', { fround: __webpack_require__(162) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5mcm91bmQuanM/MDQyZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMC4yLjIuMTYgTWF0aC5mcm91bmQoeClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnTWF0aCcsIHsgZnJvdW5kOiByZXF1aXJlKCcuL19tYXRoLWZyb3VuZCcpIH0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///161\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.16 Math.fround(x)\nvar sign = __webpack_require__(68);\nvar pow = Math.pow;\nvar EPSILON = pow(2, -52);\nvar EPSILON32 = pow(2, -23);\nvar MAX32 = pow(2, 127) * (2 - EPSILON32);\nvar MIN32 = pow(2, -126);\n\nvar roundTiesToEven = function (n) {\n  return n + 1 / EPSILON - 1 / EPSILON;\n};\n\nmodule.exports = Math.fround || function fround(x) {\n  var $abs = Math.abs(x);\n  var $sign = sign(x);\n  var a, result;\n  if ($abs < MIN32) return $sign * roundTiesToEven($abs / MIN32 / EPSILON32) * MIN32 * EPSILON32;\n  a = (1 + EPSILON32 / EPSILON) * $abs;\n  result = a - (a - $abs);\n  // eslint-disable-next-line no-self-compare\n  if (result > MAX32 || result != result) return $sign * Infinity;\n  return $sign * result;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fbWF0aC1mcm91bmQuanM/OTFjYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMC4yLjIuMTYgTWF0aC5mcm91bmQoeClcbnZhciBzaWduID0gcmVxdWlyZSgnLi9fbWF0aC1zaWduJyk7XG52YXIgcG93ID0gTWF0aC5wb3c7XG52YXIgRVBTSUxPTiA9IHBvdygyLCAtNTIpO1xudmFyIEVQU0lMT04zMiA9IHBvdygyLCAtMjMpO1xudmFyIE1BWDMyID0gcG93KDIsIDEyNykgKiAoMiAtIEVQU0lMT04zMik7XG52YXIgTUlOMzIgPSBwb3coMiwgLTEyNik7XG5cbnZhciByb3VuZFRpZXNUb0V2ZW4gPSBmdW5jdGlvbiAobikge1xuICByZXR1cm4gbiArIDEgLyBFUFNJTE9OIC0gMSAvIEVQU0lMT047XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1hdGguZnJvdW5kIHx8IGZ1bmN0aW9uIGZyb3VuZCh4KSB7XG4gIHZhciAkYWJzID0gTWF0aC5hYnMoeCk7XG4gIHZhciAkc2lnbiA9IHNpZ24oeCk7XG4gIHZhciBhLCByZXN1bHQ7XG4gIGlmICgkYWJzIDwgTUlOMzIpIHJldHVybiAkc2lnbiAqIHJvdW5kVGllc1RvRXZlbigkYWJzIC8gTUlOMzIgLyBFUFNJTE9OMzIpICogTUlOMzIgKiBFUFNJTE9OMzI7XG4gIGEgPSAoMSArIEVQU0lMT04zMiAvIEVQU0lMT04pICogJGFicztcbiAgcmVzdWx0ID0gYSAtIChhIC0gJGFicyk7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWNvbXBhcmVcbiAgaWYgKHJlc3VsdCA+IE1BWDMyIHx8IHJlc3VsdCAhPSByZXN1bHQpIHJldHVybiAkc2lnbiAqIEluZmluaXR5O1xuICByZXR1cm4gJHNpZ24gKiByZXN1bHQ7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///162\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.17 Math.hypot([value1[, value2[, … ]]])\nvar $export = __webpack_require__(1);\nvar abs = Math.abs;\n\n$export($export.S, 'Math', {\n  hypot: function hypot(value1, value2) { // eslint-disable-line no-unused-vars\n    var sum = 0;\n    var i = 0;\n    var aLen = arguments.length;\n    var larg = 0;\n    var arg, div;\n    while (i < aLen) {\n      arg = abs(arguments[i++]);\n      if (larg < arg) {\n        div = larg / arg;\n        sum = sum * div * div + 1;\n        larg = arg;\n      } else if (arg > 0) {\n        div = arg / larg;\n        sum += div * div;\n      } else sum += arg;\n    }\n    return larg === Infinity ? Infinity : larg * Math.sqrt(sum);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5oeXBvdC5qcz9jN2M2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi4xNyBNYXRoLmh5cG90KFt2YWx1ZTFbLCB2YWx1ZTJbLCDigKYgXV1dKVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBhYnMgPSBNYXRoLmFicztcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywge1xuICBoeXBvdDogZnVuY3Rpb24gaHlwb3QodmFsdWUxLCB2YWx1ZTIpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgIHZhciBzdW0gPSAwO1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgdmFyIGxhcmcgPSAwO1xuICAgIHZhciBhcmcsIGRpdjtcbiAgICB3aGlsZSAoaSA8IGFMZW4pIHtcbiAgICAgIGFyZyA9IGFicyhhcmd1bWVudHNbaSsrXSk7XG4gICAgICBpZiAobGFyZyA8IGFyZykge1xuICAgICAgICBkaXYgPSBsYXJnIC8gYXJnO1xuICAgICAgICBzdW0gPSBzdW0gKiBkaXYgKiBkaXYgKyAxO1xuICAgICAgICBsYXJnID0gYXJnO1xuICAgICAgfSBlbHNlIGlmIChhcmcgPiAwKSB7XG4gICAgICAgIGRpdiA9IGFyZyAvIGxhcmc7XG4gICAgICAgIHN1bSArPSBkaXYgKiBkaXY7XG4gICAgICB9IGVsc2Ugc3VtICs9IGFyZztcbiAgICB9XG4gICAgcmV0dXJuIGxhcmcgPT09IEluZmluaXR5ID8gSW5maW5pdHkgOiBsYXJnICogTWF0aC5zcXJ0KHN1bSk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///163\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.18 Math.imul(x, y)\nvar $export = __webpack_require__(1);\nvar $imul = Math.imul;\n\n// some WebKit versions fails with big numbers, some has wrong arity\n$export($export.S + $export.F * __webpack_require__(2)(function () {\n  return $imul(0xffffffff, 5) != -5 || $imul.length != 2;\n}), 'Math', {\n  imul: function imul(x, y) {\n    var UINT16 = 0xffff;\n    var xn = +x;\n    var yn = +y;\n    var xl = UINT16 & xn;\n    var yl = UINT16 & yn;\n    return 0 | xl * yl + ((UINT16 & xn >>> 16) * yl + xl * (UINT16 & yn >>> 16) << 16 >>> 0);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTY0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5pbXVsLmpzP2Y0ZmYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjE4IE1hdGguaW11bCh4LCB5KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkaW11bCA9IE1hdGguaW11bDtcblxuLy8gc29tZSBXZWJLaXQgdmVyc2lvbnMgZmFpbHMgd2l0aCBiaWcgbnVtYmVycywgc29tZSBoYXMgd3JvbmcgYXJpdHlcbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogcmVxdWlyZSgnLi9fZmFpbHMnKShmdW5jdGlvbiAoKSB7XG4gIHJldHVybiAkaW11bCgweGZmZmZmZmZmLCA1KSAhPSAtNSB8fCAkaW11bC5sZW5ndGggIT0gMjtcbn0pLCAnTWF0aCcsIHtcbiAgaW11bDogZnVuY3Rpb24gaW11bCh4LCB5KSB7XG4gICAgdmFyIFVJTlQxNiA9IDB4ZmZmZjtcbiAgICB2YXIgeG4gPSAreDtcbiAgICB2YXIgeW4gPSAreTtcbiAgICB2YXIgeGwgPSBVSU5UMTYgJiB4bjtcbiAgICB2YXIgeWwgPSBVSU5UMTYgJiB5bjtcbiAgICByZXR1cm4gMCB8IHhsICogeWwgKyAoKFVJTlQxNiAmIHhuID4+PiAxNikgKiB5bCArIHhsICogKFVJTlQxNiAmIHluID4+PiAxNikgPDwgMTYgPj4+IDApO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///164\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.21 Math.log10(x)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Math', {\n  log10: function log10(x) {\n    return Math.log(x) * Math.LOG10E;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTY1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5sb2cxMC5qcz83ODcyIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi4yMSBNYXRoLmxvZzEwKHgpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7XG4gIGxvZzEwOiBmdW5jdGlvbiBsb2cxMCh4KSB7XG4gICAgcmV0dXJuIE1hdGgubG9nKHgpICogTWF0aC5MT0cxMEU7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///165\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.20 Math.log1p(x)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Math', { log1p: __webpack_require__(96) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTY2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5sb2cxcC5qcz8wNDlmIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi4yMCBNYXRoLmxvZzFwKHgpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7IGxvZzFwOiByZXF1aXJlKCcuL19tYXRoLWxvZzFwJykgfSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///166\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.22 Math.log2(x)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Math', {\n  log2: function log2(x) {\n    return Math.log(x) / Math.LN2;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTY3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5sb2cyLmpzP2E2OWYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjIyIE1hdGgubG9nMih4KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywge1xuICBsb2cyOiBmdW5jdGlvbiBsb2cyKHgpIHtcbiAgICByZXR1cm4gTWF0aC5sb2coeCkgLyBNYXRoLkxOMjtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///167\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.28 Math.sign(x)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Math', { sign: __webpack_require__(68) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTY4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5zaWduLmpzPzBiMjEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjI4IE1hdGguc2lnbih4KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywgeyBzaWduOiByZXF1aXJlKCcuL19tYXRoLXNpZ24nKSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///168\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.30 Math.sinh(x)\nvar $export = __webpack_require__(1);\nvar expm1 = __webpack_require__(69);\nvar exp = Math.exp;\n\n// V8 near Chromium 38 has a problem with very small numbers\n$export($export.S + $export.F * __webpack_require__(2)(function () {\n  return !Math.sinh(-2e-17) != -2e-17;\n}), 'Math', {\n  sinh: function sinh(x) {\n    return Math.abs(x = +x) < 1\n      ? (expm1(x) - expm1(-x)) / 2\n      : (exp(x - 1) - exp(-x - 1)) * (Math.E / 2);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTY5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC5zaW5oLmpzPzZjMWEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjMwIE1hdGguc2luaCh4KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBleHBtMSA9IHJlcXVpcmUoJy4vX21hdGgtZXhwbTEnKTtcbnZhciBleHAgPSBNYXRoLmV4cDtcblxuLy8gVjggbmVhciBDaHJvbWl1bSAzOCBoYXMgYSBwcm9ibGVtIHdpdGggdmVyeSBzbWFsbCBudW1iZXJzXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gIU1hdGguc2luaCgtMmUtMTcpICE9IC0yZS0xNztcbn0pLCAnTWF0aCcsIHtcbiAgc2luaDogZnVuY3Rpb24gc2luaCh4KSB7XG4gICAgcmV0dXJuIE1hdGguYWJzKHggPSAreCkgPCAxXG4gICAgICA/IChleHBtMSh4KSAtIGV4cG0xKC14KSkgLyAyXG4gICAgICA6IChleHAoeCAtIDEpIC0gZXhwKC14IC0gMSkpICogKE1hdGguRSAvIDIpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///169\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.33 Math.tanh(x)\nvar $export = __webpack_require__(1);\nvar expm1 = __webpack_require__(69);\nvar exp = Math.exp;\n\n$export($export.S, 'Math', {\n  tanh: function tanh(x) {\n    var a = expm1(x = +x);\n    var b = expm1(-x);\n    return a == Infinity ? 1 : b == Infinity ? -1 : (a - b) / (exp(x) + exp(-x));\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC50YW5oLmpzP2M3YzYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMi4yLjMzIE1hdGgudGFuaCh4KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBleHBtMSA9IHJlcXVpcmUoJy4vX21hdGgtZXhwbTEnKTtcbnZhciBleHAgPSBNYXRoLmV4cDtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywge1xuICB0YW5oOiBmdW5jdGlvbiB0YW5oKHgpIHtcbiAgICB2YXIgYSA9IGV4cG0xKHggPSAreCk7XG4gICAgdmFyIGIgPSBleHBtMSgteCk7XG4gICAgcmV0dXJuIGEgPT0gSW5maW5pdHkgPyAxIDogYiA9PSBJbmZpbml0eSA/IC0xIDogKGEgLSBiKSAvIChleHAoeCkgKyBleHAoLXgpKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///170\n")},function(module,exports,__webpack_require__){eval("// 20.2.2.34 Math.trunc(x)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Math', {\n  trunc: function trunc(it) {\n    return (it > 0 ? Math.floor : Math.ceil)(it);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWF0aC50cnVuYy5qcz84NGI0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIwLjIuMi4zNCBNYXRoLnRydW5jKHgpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7XG4gIHRydW5jOiBmdW5jdGlvbiB0cnVuYyhpdCkge1xuICAgIHJldHVybiAoaXQgPiAwID8gTWF0aC5mbG9vciA6IE1hdGguY2VpbCkoaXQpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///171\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar toAbsoluteIndex = __webpack_require__(33);\nvar fromCharCode = String.fromCharCode;\nvar $fromCodePoint = String.fromCodePoint;\n\n// length should be 1, old FF problem\n$export($export.S + $export.F * (!!$fromCodePoint && $fromCodePoint.length != 1), 'String', {\n  // 21.1.2.2 String.fromCodePoint(...codePoints)\n  fromCodePoint: function fromCodePoint(x) { // eslint-disable-line no-unused-vars\n    var res = [];\n    var aLen = arguments.length;\n    var i = 0;\n    var code;\n    while (aLen > i) {\n      code = +arguments[i++];\n      if (toAbsoluteIndex(code, 0x10ffff) !== code) throw RangeError(code + ' is not a valid code point');\n      res.push(code < 0x10000\n        ? fromCharCode(code)\n        : fromCharCode(((code -= 0x10000) >> 10) + 0xd800, code % 0x400 + 0xdc00)\n      );\n    } return res.join('');\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmZyb20tY29kZS1wb2ludC5qcz81Njk1Il0sInNvdXJjZXNDb250ZW50IjpbInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgdG9BYnNvbHV0ZUluZGV4ID0gcmVxdWlyZSgnLi9fdG8tYWJzb2x1dGUtaW5kZXgnKTtcbnZhciBmcm9tQ2hhckNvZGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlO1xudmFyICRmcm9tQ29kZVBvaW50ID0gU3RyaW5nLmZyb21Db2RlUG9pbnQ7XG5cbi8vIGxlbmd0aCBzaG91bGQgYmUgMSwgb2xkIEZGIHByb2JsZW1cbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCEhJGZyb21Db2RlUG9pbnQgJiYgJGZyb21Db2RlUG9pbnQubGVuZ3RoICE9IDEpLCAnU3RyaW5nJywge1xuICAvLyAyMS4xLjIuMiBTdHJpbmcuZnJvbUNvZGVQb2ludCguLi5jb2RlUG9pbnRzKVxuICBmcm9tQ29kZVBvaW50OiBmdW5jdGlvbiBmcm9tQ29kZVBvaW50KHgpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgIHZhciByZXMgPSBbXTtcbiAgICB2YXIgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBjb2RlO1xuICAgIHdoaWxlIChhTGVuID4gaSkge1xuICAgICAgY29kZSA9ICthcmd1bWVudHNbaSsrXTtcbiAgICAgIGlmICh0b0Fic29sdXRlSW5kZXgoY29kZSwgMHgxMGZmZmYpICE9PSBjb2RlKSB0aHJvdyBSYW5nZUVycm9yKGNvZGUgKyAnIGlzIG5vdCBhIHZhbGlkIGNvZGUgcG9pbnQnKTtcbiAgICAgIHJlcy5wdXNoKGNvZGUgPCAweDEwMDAwXG4gICAgICAgID8gZnJvbUNoYXJDb2RlKGNvZGUpXG4gICAgICAgIDogZnJvbUNoYXJDb2RlKCgoY29kZSAtPSAweDEwMDAwKSA+PiAxMCkgKyAweGQ4MDAsIGNvZGUgJSAweDQwMCArIDB4ZGMwMClcbiAgICAgICk7XG4gICAgfSByZXR1cm4gcmVzLmpvaW4oJycpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///172\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar toIObject = __webpack_require__(15);\nvar toLength = __webpack_require__(10);\n\n$export($export.S, 'String', {\n  // 21.1.2.4 String.raw(callSite, ...substitutions)\n  raw: function raw(callSite) {\n    var tpl = toIObject(callSite.raw);\n    var len = toLength(tpl.length);\n    var aLen = arguments.length;\n    var res = [];\n    var i = 0;\n    while (len > i) {\n      res.push(String(tpl[i++]));\n      if (i < aLen) res.push(String(arguments[i]));\n    } return res.join('');\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTczLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnJhdy5qcz83ODhkIl0sInNvdXJjZXNDb250ZW50IjpbInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyIHRvTGVuZ3RoID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnU3RyaW5nJywge1xuICAvLyAyMS4xLjIuNCBTdHJpbmcucmF3KGNhbGxTaXRlLCAuLi5zdWJzdGl0dXRpb25zKVxuICByYXc6IGZ1bmN0aW9uIHJhdyhjYWxsU2l0ZSkge1xuICAgIHZhciB0cGwgPSB0b0lPYmplY3QoY2FsbFNpdGUucmF3KTtcbiAgICB2YXIgbGVuID0gdG9MZW5ndGgodHBsLmxlbmd0aCk7XG4gICAgdmFyIGFMZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIHZhciByZXMgPSBbXTtcbiAgICB2YXIgaSA9IDA7XG4gICAgd2hpbGUgKGxlbiA+IGkpIHtcbiAgICAgIHJlcy5wdXNoKFN0cmluZyh0cGxbaSsrXSkpO1xuICAgICAgaWYgKGkgPCBhTGVuKSByZXMucHVzaChTdHJpbmcoYXJndW1lbnRzW2ldKSk7XG4gICAgfSByZXR1cm4gcmVzLmpvaW4oJycpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///173\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 21.1.3.25 String.prototype.trim()\n__webpack_require__(49)('trim', function ($trim) {\n  return function trim() {\n    return $trim(this, 3);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTc0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnRyaW0uanM/NGYzNyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyAyMS4xLjMuMjUgU3RyaW5nLnByb3RvdHlwZS50cmltKClcbnJlcXVpcmUoJy4vX3N0cmluZy10cmltJykoJ3RyaW0nLCBmdW5jdGlvbiAoJHRyaW0pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHRyaW0oKSB7XG4gICAgcmV0dXJuICR0cmltKHRoaXMsIDMpO1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///174\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $at = __webpack_require__(97)(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\n__webpack_require__(70)(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTc1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yLmpzPzVkZjMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyICRhdCA9IHJlcXVpcmUoJy4vX3N0cmluZy1hdCcpKHRydWUpO1xuXG4vLyAyMS4xLjMuMjcgU3RyaW5nLnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpXG5yZXF1aXJlKCcuL19pdGVyLWRlZmluZScpKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uIChpdGVyYXRlZCkge1xuICB0aGlzLl90ID0gU3RyaW5nKGl0ZXJhdGVkKTsgLy8gdGFyZ2V0XG4gIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4XG4vLyAyMS4xLjUuMi4xICVTdHJpbmdJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbiAoKSB7XG4gIHZhciBPID0gdGhpcy5fdDtcbiAgdmFyIGluZGV4ID0gdGhpcy5faTtcbiAgdmFyIHBvaW50O1xuICBpZiAoaW5kZXggPj0gTy5sZW5ndGgpIHJldHVybiB7IHZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWUgfTtcbiAgcG9pbnQgPSAkYXQoTywgaW5kZXgpO1xuICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDtcbiAgcmV0dXJuIHsgdmFsdWU6IHBvaW50LCBkb25lOiBmYWxzZSB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///175\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $at = __webpack_require__(97)(false);\n$export($export.P, 'String', {\n  // 21.1.3.3 String.prototype.codePointAt(pos)\n  codePointAt: function codePointAt(pos) {\n    return $at(this, pos);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTc2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmNvZGUtcG9pbnQtYXQuanM/YTAzMiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyICRhdCA9IHJlcXVpcmUoJy4vX3N0cmluZy1hdCcpKGZhbHNlKTtcbiRleHBvcnQoJGV4cG9ydC5QLCAnU3RyaW5nJywge1xuICAvLyAyMS4xLjMuMyBTdHJpbmcucHJvdG90eXBlLmNvZGVQb2ludEF0KHBvcylcbiAgY29kZVBvaW50QXQ6IGZ1bmN0aW9uIGNvZGVQb2ludEF0KHBvcykge1xuICAgIHJldHVybiAkYXQodGhpcywgcG9zKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///176\n")},function(module,exports,__webpack_require__){"use strict";eval("// 21.1.3.6 String.prototype.endsWith(searchString [, endPosition])\n\nvar $export = __webpack_require__(1);\nvar toLength = __webpack_require__(10);\nvar context = __webpack_require__(71);\nvar ENDS_WITH = 'endsWith';\nvar $endsWith = ''[ENDS_WITH];\n\n$export($export.P + $export.F * __webpack_require__(73)(ENDS_WITH), 'String', {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = context(this, searchString, ENDS_WITH);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = toLength(that.length);\n    var end = endPosition === undefined ? len : Math.min(toLength(endPosition), len);\n    var search = String(searchString);\n    return $endsWith\n      ? $endsWith.call(that, search, end)\n      : that.slice(end - search.length, end) === search;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTc3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmVuZHMtd2l0aC5qcz9hZWY2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIxLjEuMy42IFN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGgoc2VhcmNoU3RyaW5nIFssIGVuZFBvc2l0aW9uXSlcbid1c2Ugc3RyaWN0JztcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSgnLi9fc3RyaW5nLWNvbnRleHQnKTtcbnZhciBFTkRTX1dJVEggPSAnZW5kc1dpdGgnO1xudmFyICRlbmRzV2l0aCA9ICcnW0VORFNfV0lUSF07XG5cbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogcmVxdWlyZSgnLi9fZmFpbHMtaXMtcmVnZXhwJykoRU5EU19XSVRIKSwgJ1N0cmluZycsIHtcbiAgZW5kc1dpdGg6IGZ1bmN0aW9uIGVuZHNXaXRoKHNlYXJjaFN0cmluZyAvKiAsIGVuZFBvc2l0aW9uID0gQGxlbmd0aCAqLykge1xuICAgIHZhciB0aGF0ID0gY29udGV4dCh0aGlzLCBzZWFyY2hTdHJpbmcsIEVORFNfV0lUSCk7XG4gICAgdmFyIGVuZFBvc2l0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIGxlbiA9IHRvTGVuZ3RoKHRoYXQubGVuZ3RoKTtcbiAgICB2YXIgZW5kID0gZW5kUG9zaXRpb24gPT09IHVuZGVmaW5lZCA/IGxlbiA6IE1hdGgubWluKHRvTGVuZ3RoKGVuZFBvc2l0aW9uKSwgbGVuKTtcbiAgICB2YXIgc2VhcmNoID0gU3RyaW5nKHNlYXJjaFN0cmluZyk7XG4gICAgcmV0dXJuICRlbmRzV2l0aFxuICAgICAgPyAkZW5kc1dpdGguY2FsbCh0aGF0LCBzZWFyY2gsIGVuZClcbiAgICAgIDogdGhhdC5zbGljZShlbmQgLSBzZWFyY2gubGVuZ3RoLCBlbmQpID09PSBzZWFyY2g7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///177\n")},function(module,exports,__webpack_require__){"use strict";eval("// 21.1.3.7 String.prototype.includes(searchString, position = 0)\n\nvar $export = __webpack_require__(1);\nvar context = __webpack_require__(71);\nvar INCLUDES = 'includes';\n\n$export($export.P + $export.F * __webpack_require__(73)(INCLUDES), 'String', {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~context(this, searchString, INCLUDES)\n      .indexOf(searchString, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTc4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmluY2x1ZGVzLmpzPzJmZGIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjEuMS4zLjcgU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlcyhzZWFyY2hTdHJpbmcsIHBvc2l0aW9uID0gMClcbid1c2Ugc3RyaWN0JztcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgY29udGV4dCA9IHJlcXVpcmUoJy4vX3N0cmluZy1jb250ZXh0Jyk7XG52YXIgSU5DTFVERVMgPSAnaW5jbHVkZXMnO1xuXG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIHJlcXVpcmUoJy4vX2ZhaWxzLWlzLXJlZ2V4cCcpKElOQ0xVREVTKSwgJ1N0cmluZycsIHtcbiAgaW5jbHVkZXM6IGZ1bmN0aW9uIGluY2x1ZGVzKHNlYXJjaFN0cmluZyAvKiAsIHBvc2l0aW9uID0gMCAqLykge1xuICAgIHJldHVybiAhIX5jb250ZXh0KHRoaXMsIHNlYXJjaFN0cmluZywgSU5DTFVERVMpXG4gICAgICAuaW5kZXhPZihzZWFyY2hTdHJpbmcsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///178\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\n\n$export($export.P, 'String', {\n  // 21.1.3.13 String.prototype.repeat(count)\n  repeat: __webpack_require__(67)\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTc5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnJlcGVhdC5qcz8xNGI5Il0sInNvdXJjZXNDb250ZW50IjpbInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QLCAnU3RyaW5nJywge1xuICAvLyAyMS4xLjMuMTMgU3RyaW5nLnByb3RvdHlwZS5yZXBlYXQoY291bnQpXG4gIHJlcGVhdDogcmVxdWlyZSgnLi9fc3RyaW5nLXJlcGVhdCcpXG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///179\n")},function(module,exports,__webpack_require__){"use strict";eval("// 21.1.3.18 String.prototype.startsWith(searchString [, position ])\n\nvar $export = __webpack_require__(1);\nvar toLength = __webpack_require__(10);\nvar context = __webpack_require__(71);\nvar STARTS_WITH = 'startsWith';\nvar $startsWith = ''[STARTS_WITH];\n\n$export($export.P + $export.F * __webpack_require__(73)(STARTS_WITH), 'String', {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = context(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return $startsWith\n      ? $startsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTgwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnN0YXJ0cy13aXRoLmpzP2Y1NTkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjEuMS4zLjE4IFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aChzZWFyY2hTdHJpbmcgWywgcG9zaXRpb24gXSlcbid1c2Ugc3RyaWN0JztcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSgnLi9fc3RyaW5nLWNvbnRleHQnKTtcbnZhciBTVEFSVFNfV0lUSCA9ICdzdGFydHNXaXRoJztcbnZhciAkc3RhcnRzV2l0aCA9ICcnW1NUQVJUU19XSVRIXTtcblxuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiByZXF1aXJlKCcuL19mYWlscy1pcy1yZWdleHAnKShTVEFSVFNfV0lUSCksICdTdHJpbmcnLCB7XG4gIHN0YXJ0c1dpdGg6IGZ1bmN0aW9uIHN0YXJ0c1dpdGgoc2VhcmNoU3RyaW5nIC8qICwgcG9zaXRpb24gPSAwICovKSB7XG4gICAgdmFyIHRoYXQgPSBjb250ZXh0KHRoaXMsIHNlYXJjaFN0cmluZywgU1RBUlRTX1dJVEgpO1xuICAgIHZhciBpbmRleCA9IHRvTGVuZ3RoKE1hdGgubWluKGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkLCB0aGF0Lmxlbmd0aCkpO1xuICAgIHZhciBzZWFyY2ggPSBTdHJpbmcoc2VhcmNoU3RyaW5nKTtcbiAgICByZXR1cm4gJHN0YXJ0c1dpdGhcbiAgICAgID8gJHN0YXJ0c1dpdGguY2FsbCh0aGF0LCBzZWFyY2gsIGluZGV4KVxuICAgICAgOiB0aGF0LnNsaWNlKGluZGV4LCBpbmRleCArIHNlYXJjaC5sZW5ndGgpID09PSBzZWFyY2g7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///180\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.2 String.prototype.anchor(name)\n__webpack_require__(12)('anchor', function (createHTML) {\n  return function anchor(name) {\n    return createHTML(this, 'a', 'name', name);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTgxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmFuY2hvci5qcz84NDQ5Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIEIuMi4zLjIgU3RyaW5nLnByb3RvdHlwZS5hbmNob3IobmFtZSlcbnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ2FuY2hvcicsIGZ1bmN0aW9uIChjcmVhdGVIVE1MKSB7XG4gIHJldHVybiBmdW5jdGlvbiBhbmNob3IobmFtZSkge1xuICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICdhJywgJ25hbWUnLCBuYW1lKTtcbiAgfTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///181\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.3 String.prototype.big()\n__webpack_require__(12)('big', function (createHTML) {\n  return function big() {\n    return createHTML(this, 'big', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTgyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmJpZy5qcz85Yzg2Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIEIuMi4zLjMgU3RyaW5nLnByb3RvdHlwZS5iaWcoKVxucmVxdWlyZSgnLi9fc3RyaW5nLWh0bWwnKSgnYmlnJywgZnVuY3Rpb24gKGNyZWF0ZUhUTUwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGJpZygpIHtcbiAgICByZXR1cm4gY3JlYXRlSFRNTCh0aGlzLCAnYmlnJywgJycsICcnKTtcbiAgfTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///182\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.4 String.prototype.blink()\n__webpack_require__(12)('blink', function (createHTML) {\n  return function blink() {\n    return createHTML(this, 'blink', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTgzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmJsaW5rLmpzP2ZhODMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8gQi4yLjMuNCBTdHJpbmcucHJvdG90eXBlLmJsaW5rKClcbnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ2JsaW5rJywgZnVuY3Rpb24gKGNyZWF0ZUhUTUwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGJsaW5rKCkge1xuICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICdibGluaycsICcnLCAnJyk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///183\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.5 String.prototype.bold()\n__webpack_require__(12)('bold', function (createHTML) {\n  return function bold() {\n    return createHTML(this, 'b', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTg0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmJvbGQuanM/NDhjMCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyBCLjIuMy41IFN0cmluZy5wcm90b3R5cGUuYm9sZCgpXG5yZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdib2xkJywgZnVuY3Rpb24gKGNyZWF0ZUhUTUwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGJvbGQoKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ2InLCAnJywgJycpO1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///184\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.6 String.prototype.fixed()\n__webpack_require__(12)('fixed', function (createHTML) {\n  return function fixed() {\n    return createHTML(this, 'tt', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTg1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmZpeGVkLmpzP2QyNjMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8gQi4yLjMuNiBTdHJpbmcucHJvdG90eXBlLmZpeGVkKClcbnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ2ZpeGVkJywgZnVuY3Rpb24gKGNyZWF0ZUhUTUwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGZpeGVkKCkge1xuICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICd0dCcsICcnLCAnJyk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///185\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.7 String.prototype.fontcolor(color)\n__webpack_require__(12)('fontcolor', function (createHTML) {\n  return function fontcolor(color) {\n    return createHTML(this, 'font', 'color', color);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTg2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmZvbnRjb2xvci5qcz82YzM3Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIEIuMi4zLjcgU3RyaW5nLnByb3RvdHlwZS5mb250Y29sb3IoY29sb3IpXG5yZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdmb250Y29sb3InLCBmdW5jdGlvbiAoY3JlYXRlSFRNTCkge1xuICByZXR1cm4gZnVuY3Rpb24gZm9udGNvbG9yKGNvbG9yKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ2ZvbnQnLCAnY29sb3InLCBjb2xvcik7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///186\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.8 String.prototype.fontsize(size)\n__webpack_require__(12)('fontsize', function (createHTML) {\n  return function fontsize(size) {\n    return createHTML(this, 'font', 'size', size);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTg3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmZvbnRzaXplLmpzPzllYzgiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8gQi4yLjMuOCBTdHJpbmcucHJvdG90eXBlLmZvbnRzaXplKHNpemUpXG5yZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdmb250c2l6ZScsIGZ1bmN0aW9uIChjcmVhdGVIVE1MKSB7XG4gIHJldHVybiBmdW5jdGlvbiBmb250c2l6ZShzaXplKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ2ZvbnQnLCAnc2l6ZScsIHNpemUpO1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///187\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.9 String.prototype.italics()\n__webpack_require__(12)('italics', function (createHTML) {\n  return function italics() {\n    return createHTML(this, 'i', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTg4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLml0YWxpY3MuanM/ZDBiMCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyBCLjIuMy45IFN0cmluZy5wcm90b3R5cGUuaXRhbGljcygpXG5yZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdpdGFsaWNzJywgZnVuY3Rpb24gKGNyZWF0ZUhUTUwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGl0YWxpY3MoKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ2knLCAnJywgJycpO1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///188\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.10 String.prototype.link(url)\n__webpack_require__(12)('link', function (createHTML) {\n  return function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTg5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLmxpbmsuanM/YjU0YSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyBCLjIuMy4xMCBTdHJpbmcucHJvdG90eXBlLmxpbmsodXJsKVxucmVxdWlyZSgnLi9fc3RyaW5nLWh0bWwnKSgnbGluaycsIGZ1bmN0aW9uIChjcmVhdGVIVE1MKSB7XG4gIHJldHVybiBmdW5jdGlvbiBsaW5rKHVybCkge1xuICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICdhJywgJ2hyZWYnLCB1cmwpO1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///189\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.11 String.prototype.small()\n__webpack_require__(12)('small', function (createHTML) {\n  return function small() {\n    return createHTML(this, 'small', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnNtYWxsLmpzP2YzODYiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8gQi4yLjMuMTEgU3RyaW5nLnByb3RvdHlwZS5zbWFsbCgpXG5yZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdzbWFsbCcsIGZ1bmN0aW9uIChjcmVhdGVIVE1MKSB7XG4gIHJldHVybiBmdW5jdGlvbiBzbWFsbCgpIHtcbiAgICByZXR1cm4gY3JlYXRlSFRNTCh0aGlzLCAnc21hbGwnLCAnJywgJycpO1xuICB9O1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///190\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.12 String.prototype.strike()\n__webpack_require__(12)('strike', function (createHTML) {\n  return function strike() {\n    return createHTML(this, 'strike', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnN0cmlrZS5qcz8xNDQ4Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIEIuMi4zLjEyIFN0cmluZy5wcm90b3R5cGUuc3RyaWtlKClcbnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ3N0cmlrZScsIGZ1bmN0aW9uIChjcmVhdGVIVE1MKSB7XG4gIHJldHVybiBmdW5jdGlvbiBzdHJpa2UoKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ3N0cmlrZScsICcnLCAnJyk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///191\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.13 String.prototype.sub()\n__webpack_require__(12)('sub', function (createHTML) {\n  return function sub() {\n    return createHTML(this, 'sub', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnN1Yi5qcz82NzNlIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIEIuMi4zLjEzIFN0cmluZy5wcm90b3R5cGUuc3ViKClcbnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ3N1YicsIGZ1bmN0aW9uIChjcmVhdGVIVE1MKSB7XG4gIHJldHVybiBmdW5jdGlvbiBzdWIoKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ3N1YicsICcnLCAnJyk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///192\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// B.2.3.14 String.prototype.sup()\n__webpack_require__(12)('sup', function (createHTML) {\n  return function sup() {\n    return createHTML(this, 'sup', '', '');\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnN1cC5qcz8yNDJhIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIEIuMi4zLjE0IFN0cmluZy5wcm90b3R5cGUuc3VwKClcbnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ3N1cCcsIGZ1bmN0aW9uIChjcmVhdGVIVE1MKSB7XG4gIHJldHVybiBmdW5jdGlvbiBzdXAoKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ3N1cCcsICcnLCAnJyk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///193\n")},function(module,exports,__webpack_require__){eval("// 20.3.3.1 / 15.9.4.4 Date.now()\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Date', { now: function () { return new Date().getTime(); } });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuZGF0ZS5ub3cuanM/NzhjZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMC4zLjMuMSAvIDE1LjkuNC40IERhdGUubm93KClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnRGF0ZScsIHsgbm93OiBmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgfSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///194\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar toObject = __webpack_require__(16);\nvar toPrimitive = __webpack_require__(27);\n\n$export($export.P + $export.F * __webpack_require__(2)(function () {\n  return new Date(NaN).toJSON() !== null\n    || Date.prototype.toJSON.call({ toISOString: function () { return 1; } }) !== 1;\n}), 'Date', {\n  // eslint-disable-next-line no-unused-vars\n  toJSON: function toJSON(key) {\n    var O = toObject(this);\n    var pv = toPrimitive(O);\n    return typeof pv == 'number' && !isFinite(pv) ? null : O.toISOString();\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuZGF0ZS50by1qc29uLmpzPzAyOTgiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogcmVxdWlyZSgnLi9fZmFpbHMnKShmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBuZXcgRGF0ZShOYU4pLnRvSlNPTigpICE9PSBudWxsXG4gICAgfHwgRGF0ZS5wcm90b3R5cGUudG9KU09OLmNhbGwoeyB0b0lTT1N0cmluZzogZnVuY3Rpb24gKCkgeyByZXR1cm4gMTsgfSB9KSAhPT0gMTtcbn0pLCAnRGF0ZScsIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIHRvSlNPTjogZnVuY3Rpb24gdG9KU09OKGtleSkge1xuICAgIHZhciBPID0gdG9PYmplY3QodGhpcyk7XG4gICAgdmFyIHB2ID0gdG9QcmltaXRpdmUoTyk7XG4gICAgcmV0dXJuIHR5cGVvZiBwdiA9PSAnbnVtYmVyJyAmJiAhaXNGaW5pdGUocHYpID8gbnVsbCA6IE8udG9JU09TdHJpbmcoKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///195\n")},function(module,exports,__webpack_require__){eval("// 20.3.4.36 / 15.9.5.43 Date.prototype.toISOString()\nvar $export = __webpack_require__(1);\nvar toISOString = __webpack_require__(197);\n\n// PhantomJS / old WebKit has a broken implementations\n$export($export.P + $export.F * (Date.prototype.toISOString !== toISOString), 'Date', {\n  toISOString: toISOString\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuZGF0ZS50by1pc28tc3RyaW5nLmpzPzhlYTUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjAuMy40LjM2IC8gMTUuOS41LjQzIERhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nKClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgdG9JU09TdHJpbmcgPSByZXF1aXJlKCcuL19kYXRlLXRvLWlzby1zdHJpbmcnKTtcblxuLy8gUGhhbnRvbUpTIC8gb2xkIFdlYktpdCBoYXMgYSBicm9rZW4gaW1wbGVtZW50YXRpb25zXG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChEYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZyAhPT0gdG9JU09TdHJpbmcpLCAnRGF0ZScsIHtcbiAgdG9JU09TdHJpbmc6IHRvSVNPU3RyaW5nXG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///196\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 20.3.4.36 / 15.9.5.43 Date.prototype.toISOString()\nvar fails = __webpack_require__(2);\nvar getTime = Date.prototype.getTime;\nvar $toISOString = Date.prototype.toISOString;\n\nvar lz = function (num) {\n  return num > 9 ? num : '0' + num;\n};\n\n// PhantomJS / old WebKit has a broken implementations\nmodule.exports = (fails(function () {\n  return $toISOString.call(new Date(-5e13 - 1)) != '0385-07-25T07:06:39.999Z';\n}) || !fails(function () {\n  $toISOString.call(new Date(NaN));\n})) ? function toISOString() {\n  if (!isFinite(getTime.call(this))) throw RangeError('Invalid time value');\n  var d = this;\n  var y = d.getUTCFullYear();\n  var m = d.getUTCMilliseconds();\n  var s = y < 0 ? '-' : y > 9999 ? '+' : '';\n  return s + ('00000' + Math.abs(y)).slice(s ? -6 : -4) +\n    '-' + lz(d.getUTCMonth() + 1) + '-' + lz(d.getUTCDate()) +\n    'T' + lz(d.getUTCHours()) + ':' + lz(d.getUTCMinutes()) +\n    ':' + lz(d.getUTCSeconds()) + '.' + (m > 99 ? m : '0' + lz(m)) + 'Z';\n} : $toISOString;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fZGF0ZS10by1pc28tc3RyaW5nLmpzPzhlZDAiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8gMjAuMy40LjM2IC8gMTUuOS41LjQzIERhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nKClcbnZhciBmYWlscyA9IHJlcXVpcmUoJy4vX2ZhaWxzJyk7XG52YXIgZ2V0VGltZSA9IERhdGUucHJvdG90eXBlLmdldFRpbWU7XG52YXIgJHRvSVNPU3RyaW5nID0gRGF0ZS5wcm90b3R5cGUudG9JU09TdHJpbmc7XG5cbnZhciBseiA9IGZ1bmN0aW9uIChudW0pIHtcbiAgcmV0dXJuIG51bSA+IDkgPyBudW0gOiAnMCcgKyBudW07XG59O1xuXG4vLyBQaGFudG9tSlMgLyBvbGQgV2ViS2l0IGhhcyBhIGJyb2tlbiBpbXBsZW1lbnRhdGlvbnNcbm1vZHVsZS5leHBvcnRzID0gKGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuICR0b0lTT1N0cmluZy5jYWxsKG5ldyBEYXRlKC01ZTEzIC0gMSkpICE9ICcwMzg1LTA3LTI1VDA3OjA2OjM5Ljk5OVonO1xufSkgfHwgIWZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgJHRvSVNPU3RyaW5nLmNhbGwobmV3IERhdGUoTmFOKSk7XG59KSkgPyBmdW5jdGlvbiB0b0lTT1N0cmluZygpIHtcbiAgaWYgKCFpc0Zpbml0ZShnZXRUaW1lLmNhbGwodGhpcykpKSB0aHJvdyBSYW5nZUVycm9yKCdJbnZhbGlkIHRpbWUgdmFsdWUnKTtcbiAgdmFyIGQgPSB0aGlzO1xuICB2YXIgeSA9IGQuZ2V0VVRDRnVsbFllYXIoKTtcbiAgdmFyIG0gPSBkLmdldFVUQ01pbGxpc2Vjb25kcygpO1xuICB2YXIgcyA9IHkgPCAwID8gJy0nIDogeSA+IDk5OTkgPyAnKycgOiAnJztcbiAgcmV0dXJuIHMgKyAoJzAwMDAwJyArIE1hdGguYWJzKHkpKS5zbGljZShzID8gLTYgOiAtNCkgK1xuICAgICctJyArIGx6KGQuZ2V0VVRDTW9udGgoKSArIDEpICsgJy0nICsgbHooZC5nZXRVVENEYXRlKCkpICtcbiAgICAnVCcgKyBseihkLmdldFVUQ0hvdXJzKCkpICsgJzonICsgbHooZC5nZXRVVENNaW51dGVzKCkpICtcbiAgICAnOicgKyBseihkLmdldFVUQ1NlY29uZHMoKSkgKyAnLicgKyAobSA+IDk5ID8gbSA6ICcwJyArIGx6KG0pKSArICdaJztcbn0gOiAkdG9JU09TdHJpbmc7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///197\n")},function(module,exports,__webpack_require__){eval("var DateProto = Date.prototype;\nvar INVALID_DATE = 'Invalid Date';\nvar TO_STRING = 'toString';\nvar $toString = DateProto[TO_STRING];\nvar getTime = DateProto.getTime;\nif (new Date(NaN) + '' != INVALID_DATE) {\n  __webpack_require__(11)(DateProto, TO_STRING, function toString() {\n    var value = getTime.call(this);\n    // eslint-disable-next-line no-self-compare\n    return value === value ? $toString.call(this) : INVALID_DATE;\n  });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuZGF0ZS50by1zdHJpbmcuanM/ODdiMyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgRGF0ZVByb3RvID0gRGF0ZS5wcm90b3R5cGU7XG52YXIgSU5WQUxJRF9EQVRFID0gJ0ludmFsaWQgRGF0ZSc7XG52YXIgVE9fU1RSSU5HID0gJ3RvU3RyaW5nJztcbnZhciAkdG9TdHJpbmcgPSBEYXRlUHJvdG9bVE9fU1RSSU5HXTtcbnZhciBnZXRUaW1lID0gRGF0ZVByb3RvLmdldFRpbWU7XG5pZiAobmV3IERhdGUoTmFOKSArICcnICE9IElOVkFMSURfREFURSkge1xuICByZXF1aXJlKCcuL19yZWRlZmluZScpKERhdGVQcm90bywgVE9fU1RSSU5HLCBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICB2YXIgdmFsdWUgPSBnZXRUaW1lLmNhbGwodGhpcyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtY29tcGFyZVxuICAgIHJldHVybiB2YWx1ZSA9PT0gdmFsdWUgPyAkdG9TdHJpbmcuY2FsbCh0aGlzKSA6IElOVkFMSURfREFURTtcbiAgfSk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///198\n")},function(module,exports,__webpack_require__){eval("var TO_PRIMITIVE = __webpack_require__(6)('toPrimitive');\nvar proto = Date.prototype;\n\nif (!(TO_PRIMITIVE in proto)) __webpack_require__(14)(proto, TO_PRIMITIVE, __webpack_require__(200));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuZGF0ZS50by1wcmltaXRpdmUuanM/YzhjZSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgVE9fUFJJTUlUSVZFID0gcmVxdWlyZSgnLi9fd2tzJykoJ3RvUHJpbWl0aXZlJyk7XG52YXIgcHJvdG8gPSBEYXRlLnByb3RvdHlwZTtcblxuaWYgKCEoVE9fUFJJTUlUSVZFIGluIHByb3RvKSkgcmVxdWlyZSgnLi9faGlkZScpKHByb3RvLCBUT19QUklNSVRJVkUsIHJlcXVpcmUoJy4vX2RhdGUtdG8tcHJpbWl0aXZlJykpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///199\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar anObject = __webpack_require__(5);\nvar toPrimitive = __webpack_require__(27);\nvar NUMBER = 'number';\n\nmodule.exports = function (hint) {\n  if (hint !== 'string' && hint !== NUMBER && hint !== 'default') throw TypeError('Incorrect hint');\n  return toPrimitive(anObject(this), hint != NUMBER);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fZGF0ZS10by1wcmltaXRpdmUuanM/ODM4MSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciB0b1ByaW1pdGl2ZSA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpO1xudmFyIE5VTUJFUiA9ICdudW1iZXInO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChoaW50KSB7XG4gIGlmIChoaW50ICE9PSAnc3RyaW5nJyAmJiBoaW50ICE9PSBOVU1CRVIgJiYgaGludCAhPT0gJ2RlZmF1bHQnKSB0aHJvdyBUeXBlRXJyb3IoJ0luY29ycmVjdCBoaW50Jyk7XG4gIHJldHVybiB0b1ByaW1pdGl2ZShhbk9iamVjdCh0aGlzKSwgaGludCAhPSBOVU1CRVIpO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///200\n")},function(module,exports,__webpack_require__){eval("// 22.1.2.2 / 15.4.3.2 Array.isArray(arg)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Array', { isArray: __webpack_require__(62) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuaXMtYXJyYXkuanM/MmNhZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMi4xLjIuMiAvIDE1LjQuMy4yIEFycmF5LmlzQXJyYXkoYXJnKVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdBcnJheScsIHsgaXNBcnJheTogcmVxdWlyZSgnLi9faXMtYXJyYXknKSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///201\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar ctx = __webpack_require__(21);\nvar $export = __webpack_require__(1);\nvar toObject = __webpack_require__(16);\nvar call = __webpack_require__(99);\nvar isArrayIter = __webpack_require__(74);\nvar toLength = __webpack_require__(10);\nvar createProperty = __webpack_require__(75);\nvar getIterFn = __webpack_require__(76);\n\n$export($export.S + $export.F * !__webpack_require__(50)(function (iter) { Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n    var O = toObject(arrayLike);\n    var C = typeof this == 'function' ? this : Array;\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var index = 0;\n    var iterFn = getIterFn(O);\n    var length, result, step, iterator;\n    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {\n      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {\n        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);\n      }\n    } else {\n      length = toLength(O.length);\n      for (result = new C(length); length > index; index++) {\n        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuZnJvbS5qcz8xYzRjIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBjdHggPSByZXF1aXJlKCcuL19jdHgnKTtcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuL190by1vYmplY3QnKTtcbnZhciBjYWxsID0gcmVxdWlyZSgnLi9faXRlci1jYWxsJyk7XG52YXIgaXNBcnJheUl0ZXIgPSByZXF1aXJlKCcuL19pcy1hcnJheS1pdGVyJyk7XG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcbnZhciBjcmVhdGVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX2NyZWF0ZS1wcm9wZXJ0eScpO1xudmFyIGdldEl0ZXJGbiA9IHJlcXVpcmUoJy4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kJyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX2l0ZXItZGV0ZWN0JykoZnVuY3Rpb24gKGl0ZXIpIHsgQXJyYXkuZnJvbShpdGVyKTsgfSksICdBcnJheScsIHtcbiAgLy8gMjIuMS4yLjEgQXJyYXkuZnJvbShhcnJheUxpa2UsIG1hcGZuID0gdW5kZWZpbmVkLCB0aGlzQXJnID0gdW5kZWZpbmVkKVxuICBmcm9tOiBmdW5jdGlvbiBmcm9tKGFycmF5TGlrZSAvKiAsIG1hcGZuID0gdW5kZWZpbmVkLCB0aGlzQXJnID0gdW5kZWZpbmVkICovKSB7XG4gICAgdmFyIE8gPSB0b09iamVjdChhcnJheUxpa2UpO1xuICAgIHZhciBDID0gdHlwZW9mIHRoaXMgPT0gJ2Z1bmN0aW9uJyA/IHRoaXMgOiBBcnJheTtcbiAgICB2YXIgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgdmFyIG1hcGZuID0gYUxlbiA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIG1hcHBpbmcgPSBtYXBmbiAhPT0gdW5kZWZpbmVkO1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIGl0ZXJGbiA9IGdldEl0ZXJGbihPKTtcbiAgICB2YXIgbGVuZ3RoLCByZXN1bHQsIHN0ZXAsIGl0ZXJhdG9yO1xuICAgIGlmIChtYXBwaW5nKSBtYXBmbiA9IGN0eChtYXBmbiwgYUxlbiA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQsIDIpO1xuICAgIC8vIGlmIG9iamVjdCBpc24ndCBpdGVyYWJsZSBvciBpdCdzIGFycmF5IHdpdGggZGVmYXVsdCBpdGVyYXRvciAtIHVzZSBzaW1wbGUgY2FzZVxuICAgIGlmIChpdGVyRm4gIT0gdW5kZWZpbmVkICYmICEoQyA9PSBBcnJheSAmJiBpc0FycmF5SXRlcihpdGVyRm4pKSkge1xuICAgICAgZm9yIChpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKE8pLCByZXN1bHQgPSBuZXcgQygpOyAhKHN0ZXAgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmU7IGluZGV4KyspIHtcbiAgICAgICAgY3JlYXRlUHJvcGVydHkocmVzdWx0LCBpbmRleCwgbWFwcGluZyA/IGNhbGwoaXRlcmF0b3IsIG1hcGZuLCBbc3RlcC52YWx1ZSwgaW5kZXhdLCB0cnVlKSA6IHN0ZXAudmFsdWUpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCk7XG4gICAgICBmb3IgKHJlc3VsdCA9IG5ldyBDKGxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKSB7XG4gICAgICAgIGNyZWF0ZVByb3BlcnR5KHJlc3VsdCwgaW5kZXgsIG1hcHBpbmcgPyBtYXBmbihPW2luZGV4XSwgaW5kZXgpIDogT1tpbmRleF0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXN1bHQubGVuZ3RoID0gaW5kZXg7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///202\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar createProperty = __webpack_require__(75);\n\n// WebKit Array.of isn't generic\n$export($export.S + $export.F * __webpack_require__(2)(function () {\n  function F() { /* empty */ }\n  return !(Array.of.call(F) instanceof F);\n}), 'Array', {\n  // 22.1.2.3 Array.of( ...items)\n  of: function of(/* ...args */) {\n    var index = 0;\n    var aLen = arguments.length;\n    var result = new (typeof this == 'function' ? this : Array)(aLen);\n    while (aLen > index) createProperty(result, index, arguments[index++]);\n    result.length = aLen;\n    return result;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkub2YuanM/ZTgwNCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGNyZWF0ZVByb3BlcnR5ID0gcmVxdWlyZSgnLi9fY3JlYXRlLXByb3BlcnR5Jyk7XG5cbi8vIFdlYktpdCBBcnJheS5vZiBpc24ndCBnZW5lcmljXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBGKCkgeyAvKiBlbXB0eSAqLyB9XG4gIHJldHVybiAhKEFycmF5Lm9mLmNhbGwoRikgaW5zdGFuY2VvZiBGKTtcbn0pLCAnQXJyYXknLCB7XG4gIC8vIDIyLjEuMi4zIEFycmF5Lm9mKCAuLi5pdGVtcylcbiAgb2Y6IGZ1bmN0aW9uIG9mKC8qIC4uLmFyZ3MgKi8pIHtcbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBhTGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICB2YXIgcmVzdWx0ID0gbmV3ICh0eXBlb2YgdGhpcyA9PSAnZnVuY3Rpb24nID8gdGhpcyA6IEFycmF5KShhTGVuKTtcbiAgICB3aGlsZSAoYUxlbiA+IGluZGV4KSBjcmVhdGVQcm9wZXJ0eShyZXN1bHQsIGluZGV4LCBhcmd1bWVudHNbaW5kZXgrK10pO1xuICAgIHJlc3VsdC5sZW5ndGggPSBhTGVuO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///203\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 22.1.3.13 Array.prototype.join(separator)\nvar $export = __webpack_require__(1);\nvar toIObject = __webpack_require__(15);\nvar arrayJoin = [].join;\n\n// fallback for not array-like strings\n$export($export.P + $export.F * (__webpack_require__(44) != Object || !__webpack_require__(17)(arrayJoin)), 'Array', {\n  join: function join(separator) {\n    return arrayJoin.call(toIObject(this), separator === undefined ? ',' : separator);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjA0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuam9pbi5qcz8zNzNmIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIDIyLjEuMy4xMyBBcnJheS5wcm90b3R5cGUuam9pbihzZXBhcmF0b3IpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcbnZhciBhcnJheUpvaW4gPSBbXS5qb2luO1xuXG4vLyBmYWxsYmFjayBmb3Igbm90IGFycmF5LWxpa2Ugc3RyaW5nc1xuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAocmVxdWlyZSgnLi9faW9iamVjdCcpICE9IE9iamVjdCB8fCAhcmVxdWlyZSgnLi9fc3RyaWN0LW1ldGhvZCcpKGFycmF5Sm9pbikpLCAnQXJyYXknLCB7XG4gIGpvaW46IGZ1bmN0aW9uIGpvaW4oc2VwYXJhdG9yKSB7XG4gICAgcmV0dXJuIGFycmF5Sm9pbi5jYWxsKHRvSU9iamVjdCh0aGlzKSwgc2VwYXJhdG9yID09PSB1bmRlZmluZWQgPyAnLCcgOiBzZXBhcmF0b3IpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///204\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar html = __webpack_require__(63);\nvar cof = __webpack_require__(23);\nvar toAbsoluteIndex = __webpack_require__(33);\nvar toLength = __webpack_require__(10);\nvar arraySlice = [].slice;\n\n// fallback for not array-like ES3 strings and DOM objects\n$export($export.P + $export.F * __webpack_require__(2)(function () {\n  if (html) arraySlice.call(html);\n}), 'Array', {\n  slice: function slice(begin, end) {\n    var len = toLength(this.length);\n    var klass = cof(this);\n    end = end === undefined ? len : end;\n    if (klass == 'Array') return arraySlice.call(this, begin, end);\n    var start = toAbsoluteIndex(begin, len);\n    var upTo = toAbsoluteIndex(end, len);\n    var size = toLength(upTo - start);\n    var cloned = new Array(size);\n    var i = 0;\n    for (; i < size; i++) cloned[i] = klass == 'String'\n      ? this.charAt(start + i)\n      : this[start + i];\n    return cloned;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjA1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuc2xpY2UuanM/MjNiZiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGh0bWwgPSByZXF1aXJlKCcuL19odG1sJyk7XG52YXIgY29mID0gcmVxdWlyZSgnLi9fY29mJyk7XG52YXIgdG9BYnNvbHV0ZUluZGV4ID0gcmVxdWlyZSgnLi9fdG8tYWJzb2x1dGUtaW5kZXgnKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpO1xudmFyIGFycmF5U2xpY2UgPSBbXS5zbGljZTtcblxuLy8gZmFsbGJhY2sgZm9yIG5vdCBhcnJheS1saWtlIEVTMyBzdHJpbmdzIGFuZCBET00gb2JqZWN0c1xuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiByZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uICgpIHtcbiAgaWYgKGh0bWwpIGFycmF5U2xpY2UuY2FsbChodG1sKTtcbn0pLCAnQXJyYXknLCB7XG4gIHNsaWNlOiBmdW5jdGlvbiBzbGljZShiZWdpbiwgZW5kKSB7XG4gICAgdmFyIGxlbiA9IHRvTGVuZ3RoKHRoaXMubGVuZ3RoKTtcbiAgICB2YXIga2xhc3MgPSBjb2YodGhpcyk7XG4gICAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgPyBsZW4gOiBlbmQ7XG4gICAgaWYgKGtsYXNzID09ICdBcnJheScpIHJldHVybiBhcnJheVNsaWNlLmNhbGwodGhpcywgYmVnaW4sIGVuZCk7XG4gICAgdmFyIHN0YXJ0ID0gdG9BYnNvbHV0ZUluZGV4KGJlZ2luLCBsZW4pO1xuICAgIHZhciB1cFRvID0gdG9BYnNvbHV0ZUluZGV4KGVuZCwgbGVuKTtcbiAgICB2YXIgc2l6ZSA9IHRvTGVuZ3RoKHVwVG8gLSBzdGFydCk7XG4gICAgdmFyIGNsb25lZCA9IG5ldyBBcnJheShzaXplKTtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBzaXplOyBpKyspIGNsb25lZFtpXSA9IGtsYXNzID09ICdTdHJpbmcnXG4gICAgICA/IHRoaXMuY2hhckF0KHN0YXJ0ICsgaSlcbiAgICAgIDogdGhpc1tzdGFydCArIGldO1xuICAgIHJldHVybiBjbG9uZWQ7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///205\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar aFunction = __webpack_require__(22);\nvar toObject = __webpack_require__(16);\nvar fails = __webpack_require__(2);\nvar $sort = [].sort;\nvar test = [1, 2, 3];\n\n$export($export.P + $export.F * (fails(function () {\n  // IE8-\n  test.sort(undefined);\n}) || !fails(function () {\n  // V8 bug\n  test.sort(null);\n  // Old WebKit\n}) || !__webpack_require__(17)($sort)), 'Array', {\n  // 22.1.3.25 Array.prototype.sort(comparefn)\n  sort: function sort(comparefn) {\n    return comparefn === undefined\n      ? $sort.call(toObject(this))\n      : $sort.call(toObject(this), aFunction(comparefn));\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjA2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuc29ydC5qcz81NWRkIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpO1xudmFyIHRvT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8tb2JqZWN0Jyk7XG52YXIgZmFpbHMgPSByZXF1aXJlKCcuL19mYWlscycpO1xudmFyICRzb3J0ID0gW10uc29ydDtcbnZhciB0ZXN0ID0gWzEsIDIsIDNdO1xuXG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChmYWlscyhmdW5jdGlvbiAoKSB7XG4gIC8vIElFOC1cbiAgdGVzdC5zb3J0KHVuZGVmaW5lZCk7XG59KSB8fCAhZmFpbHMoZnVuY3Rpb24gKCkge1xuICAvLyBWOCBidWdcbiAgdGVzdC5zb3J0KG51bGwpO1xuICAvLyBPbGQgV2ViS2l0XG59KSB8fCAhcmVxdWlyZSgnLi9fc3RyaWN0LW1ldGhvZCcpKCRzb3J0KSksICdBcnJheScsIHtcbiAgLy8gMjIuMS4zLjI1IEFycmF5LnByb3RvdHlwZS5zb3J0KGNvbXBhcmVmbilcbiAgc29ydDogZnVuY3Rpb24gc29ydChjb21wYXJlZm4pIHtcbiAgICByZXR1cm4gY29tcGFyZWZuID09PSB1bmRlZmluZWRcbiAgICAgID8gJHNvcnQuY2FsbCh0b09iamVjdCh0aGlzKSlcbiAgICAgIDogJHNvcnQuY2FsbCh0b09iamVjdCh0aGlzKSwgYUZ1bmN0aW9uKGNvbXBhcmVmbikpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///206\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $forEach = __webpack_require__(20)(0);\nvar STRICT = __webpack_require__(17)([].forEach, true);\n\n$export($export.P + $export.F * !STRICT, 'Array', {\n  // 22.1.3.10 / 15.4.4.18 Array.prototype.forEach(callbackfn [, thisArg])\n  forEach: function forEach(callbackfn /* , thisArg */) {\n    return $forEach(this, callbackfn, arguments[1]);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjA3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuZm9yLWVhY2guanM/ZjNlMiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyICRmb3JFYWNoID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpKDApO1xudmFyIFNUUklDVCA9IHJlcXVpcmUoJy4vX3N0cmljdC1tZXRob2QnKShbXS5mb3JFYWNoLCB0cnVlKTtcblxuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAhU1RSSUNULCAnQXJyYXknLCB7XG4gIC8vIDIyLjEuMy4xMCAvIDE1LjQuNC4xOCBBcnJheS5wcm90b3R5cGUuZm9yRWFjaChjYWxsYmFja2ZuIFssIHRoaXNBcmddKVxuICBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGNhbGxiYWNrZm4gLyogLCB0aGlzQXJnICovKSB7XG4gICAgcmV0dXJuICRmb3JFYWNoKHRoaXMsIGNhbGxiYWNrZm4sIGFyZ3VtZW50c1sxXSk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///207\n")},function(module,exports,__webpack_require__){eval("// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = __webpack_require__(209);\n\nmodule.exports = function (original, length) {\n  return new (speciesConstructor(original))(length);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjA4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fYXJyYXktc3BlY2llcy1jcmVhdGUuanM/Y2QxYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA5LjQuMi4zIEFycmF5U3BlY2llc0NyZWF0ZShvcmlnaW5hbEFycmF5LCBsZW5ndGgpXG52YXIgc3BlY2llc0NvbnN0cnVjdG9yID0gcmVxdWlyZSgnLi9fYXJyYXktc3BlY2llcy1jb25zdHJ1Y3RvcicpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbGVuZ3RoKSB7XG4gIHJldHVybiBuZXcgKHNwZWNpZXNDb25zdHJ1Y3RvcihvcmlnaW5hbCkpKGxlbmd0aCk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///208\n")},function(module,exports,__webpack_require__){eval("var isObject = __webpack_require__(4);\nvar isArray = __webpack_require__(62);\nvar SPECIES = __webpack_require__(6)('species');\n\nmodule.exports = function (original) {\n  var C;\n  if (isArray(original)) {\n    C = original.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjA5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fYXJyYXktc3BlY2llcy1jb25zdHJ1Y3Rvci5qcz9lODUzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIGlzQXJyYXkgPSByZXF1aXJlKCcuL19pcy1hcnJheScpO1xudmFyIFNQRUNJRVMgPSByZXF1aXJlKCcuL193a3MnKSgnc3BlY2llcycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvcmlnaW5hbCkge1xuICB2YXIgQztcbiAgaWYgKGlzQXJyYXkob3JpZ2luYWwpKSB7XG4gICAgQyA9IG9yaWdpbmFsLmNvbnN0cnVjdG9yO1xuICAgIC8vIGNyb3NzLXJlYWxtIGZhbGxiYWNrXG4gICAgaWYgKHR5cGVvZiBDID09ICdmdW5jdGlvbicgJiYgKEMgPT09IEFycmF5IHx8IGlzQXJyYXkoQy5wcm90b3R5cGUpKSkgQyA9IHVuZGVmaW5lZDtcbiAgICBpZiAoaXNPYmplY3QoQykpIHtcbiAgICAgIEMgPSBDW1NQRUNJRVNdO1xuICAgICAgaWYgKEMgPT09IG51bGwpIEMgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9IHJldHVybiBDID09PSB1bmRlZmluZWQgPyBBcnJheSA6IEM7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///209\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $map = __webpack_require__(20)(1);\n\n$export($export.P + $export.F * !__webpack_require__(17)([].map, true), 'Array', {\n  // 22.1.3.15 / 15.4.4.19 Array.prototype.map(callbackfn [, thisArg])\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments[1]);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjEwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkubWFwLmpzPzZkNjciXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkbWFwID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpKDEpO1xuXG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqICFyZXF1aXJlKCcuL19zdHJpY3QtbWV0aG9kJykoW10ubWFwLCB0cnVlKSwgJ0FycmF5Jywge1xuICAvLyAyMi4xLjMuMTUgLyAxNS40LjQuMTkgQXJyYXkucHJvdG90eXBlLm1hcChjYWxsYmFja2ZuIFssIHRoaXNBcmddKVxuICBtYXA6IGZ1bmN0aW9uIG1hcChjYWxsYmFja2ZuIC8qICwgdGhpc0FyZyAqLykge1xuICAgIHJldHVybiAkbWFwKHRoaXMsIGNhbGxiYWNrZm4sIGFyZ3VtZW50c1sxXSk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///210\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $filter = __webpack_require__(20)(2);\n\n$export($export.P + $export.F * !__webpack_require__(17)([].filter, true), 'Array', {\n  // 22.1.3.7 / 15.4.4.20 Array.prototype.filter(callbackfn [, thisArg])\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments[1]);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjExLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuZmlsdGVyLmpzP2QyNWYiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkZmlsdGVyID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpKDIpO1xuXG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqICFyZXF1aXJlKCcuL19zdHJpY3QtbWV0aG9kJykoW10uZmlsdGVyLCB0cnVlKSwgJ0FycmF5Jywge1xuICAvLyAyMi4xLjMuNyAvIDE1LjQuNC4yMCBBcnJheS5wcm90b3R5cGUuZmlsdGVyKGNhbGxiYWNrZm4gWywgdGhpc0FyZ10pXG4gIGZpbHRlcjogZnVuY3Rpb24gZmlsdGVyKGNhbGxiYWNrZm4gLyogLCB0aGlzQXJnICovKSB7XG4gICAgcmV0dXJuICRmaWx0ZXIodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzWzFdKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///211\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $some = __webpack_require__(20)(3);\n\n$export($export.P + $export.F * !__webpack_require__(17)([].some, true), 'Array', {\n  // 22.1.3.23 / 15.4.4.17 Array.prototype.some(callbackfn [, thisArg])\n  some: function some(callbackfn /* , thisArg */) {\n    return $some(this, callbackfn, arguments[1]);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjEyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuc29tZS5qcz83NTlmIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgJHNvbWUgPSByZXF1aXJlKCcuL19hcnJheS1tZXRob2RzJykoMyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX3N0cmljdC1tZXRob2QnKShbXS5zb21lLCB0cnVlKSwgJ0FycmF5Jywge1xuICAvLyAyMi4xLjMuMjMgLyAxNS40LjQuMTcgQXJyYXkucHJvdG90eXBlLnNvbWUoY2FsbGJhY2tmbiBbLCB0aGlzQXJnXSlcbiAgc29tZTogZnVuY3Rpb24gc29tZShjYWxsYmFja2ZuIC8qICwgdGhpc0FyZyAqLykge1xuICAgIHJldHVybiAkc29tZSh0aGlzLCBjYWxsYmFja2ZuLCBhcmd1bWVudHNbMV0pO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///212\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $every = __webpack_require__(20)(4);\n\n$export($export.P + $export.F * !__webpack_require__(17)([].every, true), 'Array', {\n  // 22.1.3.5 / 15.4.4.16 Array.prototype.every(callbackfn [, thisArg])\n  every: function every(callbackfn /* , thisArg */) {\n    return $every(this, callbackfn, arguments[1]);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjEzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuZXZlcnkuanM/NjA5NSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyICRldmVyeSA9IHJlcXVpcmUoJy4vX2FycmF5LW1ldGhvZHMnKSg0KTtcblxuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAhcmVxdWlyZSgnLi9fc3RyaWN0LW1ldGhvZCcpKFtdLmV2ZXJ5LCB0cnVlKSwgJ0FycmF5Jywge1xuICAvLyAyMi4xLjMuNSAvIDE1LjQuNC4xNiBBcnJheS5wcm90b3R5cGUuZXZlcnkoY2FsbGJhY2tmbiBbLCB0aGlzQXJnXSlcbiAgZXZlcnk6IGZ1bmN0aW9uIGV2ZXJ5KGNhbGxiYWNrZm4gLyogLCB0aGlzQXJnICovKSB7XG4gICAgcmV0dXJuICRldmVyeSh0aGlzLCBjYWxsYmFja2ZuLCBhcmd1bWVudHNbMV0pO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///213\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $reduce = __webpack_require__(100);\n\n$export($export.P + $export.F * !__webpack_require__(17)([].reduce, true), 'Array', {\n  // 22.1.3.18 / 15.4.4.21 Array.prototype.reduce(callbackfn [, initialValue])\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    return $reduce(this, callbackfn, arguments.length, arguments[1], false);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjE0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkucmVkdWNlLmpzPzBjZDgiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkcmVkdWNlID0gcmVxdWlyZSgnLi9fYXJyYXktcmVkdWNlJyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX3N0cmljdC1tZXRob2QnKShbXS5yZWR1Y2UsIHRydWUpLCAnQXJyYXknLCB7XG4gIC8vIDIyLjEuMy4xOCAvIDE1LjQuNC4yMSBBcnJheS5wcm90b3R5cGUucmVkdWNlKGNhbGxiYWNrZm4gWywgaW5pdGlhbFZhbHVlXSlcbiAgcmVkdWNlOiBmdW5jdGlvbiByZWR1Y2UoY2FsbGJhY2tmbiAvKiAsIGluaXRpYWxWYWx1ZSAqLykge1xuICAgIHJldHVybiAkcmVkdWNlKHRoaXMsIGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3VtZW50c1sxXSwgZmFsc2UpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///214\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $reduce = __webpack_require__(100);\n\n$export($export.P + $export.F * !__webpack_require__(17)([].reduceRight, true), 'Array', {\n  // 22.1.3.19 / 15.4.4.22 Array.prototype.reduceRight(callbackfn [, initialValue])\n  reduceRight: function reduceRight(callbackfn /* , initialValue */) {\n    return $reduce(this, callbackfn, arguments.length, arguments[1], true);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjE1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkucmVkdWNlLXJpZ2h0LmpzPzQ4ZjgiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkcmVkdWNlID0gcmVxdWlyZSgnLi9fYXJyYXktcmVkdWNlJyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX3N0cmljdC1tZXRob2QnKShbXS5yZWR1Y2VSaWdodCwgdHJ1ZSksICdBcnJheScsIHtcbiAgLy8gMjIuMS4zLjE5IC8gMTUuNC40LjIyIEFycmF5LnByb3RvdHlwZS5yZWR1Y2VSaWdodChjYWxsYmFja2ZuIFssIGluaXRpYWxWYWx1ZV0pXG4gIHJlZHVjZVJpZ2h0OiBmdW5jdGlvbiByZWR1Y2VSaWdodChjYWxsYmFja2ZuIC8qICwgaW5pdGlhbFZhbHVlICovKSB7XG4gICAgcmV0dXJuICRyZWR1Y2UodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCwgYXJndW1lbnRzWzFdLCB0cnVlKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///215\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $indexOf = __webpack_require__(46)(false);\nvar $native = [].indexOf;\nvar NEGATIVE_ZERO = !!$native && 1 / [1].indexOf(1, -0) < 0;\n\n$export($export.P + $export.F * (NEGATIVE_ZERO || !__webpack_require__(17)($native)), 'Array', {\n  // 22.1.3.11 / 15.4.4.14 Array.prototype.indexOf(searchElement [, fromIndex])\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? $native.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments[1]);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjE2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuaW5kZXgtb2YuanM/NTdlNyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyICRpbmRleE9mID0gcmVxdWlyZSgnLi9fYXJyYXktaW5jbHVkZXMnKShmYWxzZSk7XG52YXIgJG5hdGl2ZSA9IFtdLmluZGV4T2Y7XG52YXIgTkVHQVRJVkVfWkVSTyA9ICEhJG5hdGl2ZSAmJiAxIC8gWzFdLmluZGV4T2YoMSwgLTApIDwgMDtcblxuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAoTkVHQVRJVkVfWkVSTyB8fCAhcmVxdWlyZSgnLi9fc3RyaWN0LW1ldGhvZCcpKCRuYXRpdmUpKSwgJ0FycmF5Jywge1xuICAvLyAyMi4xLjMuMTEgLyAxNS40LjQuMTQgQXJyYXkucHJvdG90eXBlLmluZGV4T2Yoc2VhcmNoRWxlbWVudCBbLCBmcm9tSW5kZXhdKVxuICBpbmRleE9mOiBmdW5jdGlvbiBpbmRleE9mKHNlYXJjaEVsZW1lbnQgLyogLCBmcm9tSW5kZXggPSAwICovKSB7XG4gICAgcmV0dXJuIE5FR0FUSVZFX1pFUk9cbiAgICAgIC8vIGNvbnZlcnQgLTAgdG8gKzBcbiAgICAgID8gJG5hdGl2ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IDBcbiAgICAgIDogJGluZGV4T2YodGhpcywgc2VhcmNoRWxlbWVudCwgYXJndW1lbnRzWzFdKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///216\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar toIObject = __webpack_require__(15);\nvar toInteger = __webpack_require__(25);\nvar toLength = __webpack_require__(10);\nvar $native = [].lastIndexOf;\nvar NEGATIVE_ZERO = !!$native && 1 / [1].lastIndexOf(1, -0) < 0;\n\n$export($export.P + $export.F * (NEGATIVE_ZERO || !__webpack_require__(17)($native)), 'Array', {\n  // 22.1.3.14 / 15.4.4.15 Array.prototype.lastIndexOf(searchElement [, fromIndex])\n  lastIndexOf: function lastIndexOf(searchElement /* , fromIndex = @[*-1] */) {\n    // convert -0 to +0\n    if (NEGATIVE_ZERO) return $native.apply(this, arguments) || 0;\n    var O = toIObject(this);\n    var length = toLength(O.length);\n    var index = length - 1;\n    if (arguments.length > 1) index = Math.min(index, toInteger(arguments[1]));\n    if (index < 0) index = length + index;\n    for (;index >= 0; index--) if (index in O) if (O[index] === searchElement) return index || 0;\n    return -1;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjE3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkubGFzdC1pbmRleC1vZi5qcz85ODY1Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4vX3RvLWludGVnZXInKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpO1xudmFyICRuYXRpdmUgPSBbXS5sYXN0SW5kZXhPZjtcbnZhciBORUdBVElWRV9aRVJPID0gISEkbmF0aXZlICYmIDEgLyBbMV0ubGFzdEluZGV4T2YoMSwgLTApIDwgMDtcblxuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAoTkVHQVRJVkVfWkVSTyB8fCAhcmVxdWlyZSgnLi9fc3RyaWN0LW1ldGhvZCcpKCRuYXRpdmUpKSwgJ0FycmF5Jywge1xuICAvLyAyMi4xLjMuMTQgLyAxNS40LjQuMTUgQXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mKHNlYXJjaEVsZW1lbnQgWywgZnJvbUluZGV4XSlcbiAgbGFzdEluZGV4T2Y6IGZ1bmN0aW9uIGxhc3RJbmRleE9mKHNlYXJjaEVsZW1lbnQgLyogLCBmcm9tSW5kZXggPSBAWyotMV0gKi8pIHtcbiAgICAvLyBjb252ZXJ0IC0wIHRvICswXG4gICAgaWYgKE5FR0FUSVZFX1pFUk8pIHJldHVybiAkbmF0aXZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgMDtcbiAgICB2YXIgTyA9IHRvSU9iamVjdCh0aGlzKTtcbiAgICB2YXIgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpO1xuICAgIHZhciBpbmRleCA9IGxlbmd0aCAtIDE7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSBpbmRleCA9IE1hdGgubWluKGluZGV4LCB0b0ludGVnZXIoYXJndW1lbnRzWzFdKSk7XG4gICAgaWYgKGluZGV4IDwgMCkgaW5kZXggPSBsZW5ndGggKyBpbmRleDtcbiAgICBmb3IgKDtpbmRleCA+PSAwOyBpbmRleC0tKSBpZiAoaW5kZXggaW4gTykgaWYgKE9baW5kZXhdID09PSBzZWFyY2hFbGVtZW50KSByZXR1cm4gaW5kZXggfHwgMDtcbiAgICByZXR1cm4gLTE7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///217\n")},function(module,exports,__webpack_require__){eval("// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)\nvar $export = __webpack_require__(1);\n\n$export($export.P, 'Array', { copyWithin: __webpack_require__(101) });\n\n__webpack_require__(39)('copyWithin');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjE4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuY29weS13aXRoaW4uanM/NzQ0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyMi4xLjMuMyBBcnJheS5wcm90b3R5cGUuY29weVdpdGhpbih0YXJnZXQsIHN0YXJ0LCBlbmQgPSB0aGlzLmxlbmd0aClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QLCAnQXJyYXknLCB7IGNvcHlXaXRoaW46IHJlcXVpcmUoJy4vX2FycmF5LWNvcHktd2l0aGluJykgfSk7XG5cbnJlcXVpcmUoJy4vX2FkZC10by11bnNjb3BhYmxlcycpKCdjb3B5V2l0aGluJyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///218\n")},function(module,exports,__webpack_require__){eval("// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\nvar $export = __webpack_require__(1);\n\n$export($export.P, 'Array', { fill: __webpack_require__(77) });\n\n__webpack_require__(39)('fill');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjE5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuZmlsbC5qcz82YzdiIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDIyLjEuMy42IEFycmF5LnByb3RvdHlwZS5maWxsKHZhbHVlLCBzdGFydCA9IDAsIGVuZCA9IHRoaXMubGVuZ3RoKVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlAsICdBcnJheScsIHsgZmlsbDogcmVxdWlyZSgnLi9fYXJyYXktZmlsbCcpIH0pO1xuXG5yZXF1aXJlKCcuL19hZGQtdG8tdW5zY29wYWJsZXMnKSgnZmlsbCcpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///219\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = __webpack_require__(1);\nvar $find = __webpack_require__(20)(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n__webpack_require__(39)(KEY);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuZmluZC5qcz83NTE0Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIDIyLjEuMy44IEFycmF5LnByb3RvdHlwZS5maW5kKHByZWRpY2F0ZSwgdGhpc0FyZyA9IHVuZGVmaW5lZClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgJGZpbmQgPSByZXF1aXJlKCcuL19hcnJheS1tZXRob2RzJykoNSk7XG52YXIgS0VZID0gJ2ZpbmQnO1xudmFyIGZvcmNlZCA9IHRydWU7XG4vLyBTaG91bGRuJ3Qgc2tpcCBob2xlc1xuaWYgKEtFWSBpbiBbXSkgQXJyYXkoMSlbS0VZXShmdW5jdGlvbiAoKSB7IGZvcmNlZCA9IGZhbHNlOyB9KTtcbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogZm9yY2VkLCAnQXJyYXknLCB7XG4gIGZpbmQ6IGZ1bmN0aW9uIGZpbmQoY2FsbGJhY2tmbiAvKiAsIHRoYXQgPSB1bmRlZmluZWQgKi8pIHtcbiAgICByZXR1cm4gJGZpbmQodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpO1xuICB9XG59KTtcbnJlcXVpcmUoJy4vX2FkZC10by11bnNjb3BhYmxlcycpKEtFWSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///220\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = __webpack_require__(1);\nvar $find = __webpack_require__(20)(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n__webpack_require__(39)(KEY);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuZmluZC1pbmRleC5qcz8yMGQ2Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIDIyLjEuMy45IEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgocHJlZGljYXRlLCB0aGlzQXJnID0gdW5kZWZpbmVkKVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkZmluZCA9IHJlcXVpcmUoJy4vX2FycmF5LW1ldGhvZHMnKSg2KTtcbnZhciBLRVkgPSAnZmluZEluZGV4JztcbnZhciBmb3JjZWQgPSB0cnVlO1xuLy8gU2hvdWxkbid0IHNraXAgaG9sZXNcbmlmIChLRVkgaW4gW10pIEFycmF5KDEpW0tFWV0oZnVuY3Rpb24gKCkgeyBmb3JjZWQgPSBmYWxzZTsgfSk7XG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIGZvcmNlZCwgJ0FycmF5Jywge1xuICBmaW5kSW5kZXg6IGZ1bmN0aW9uIGZpbmRJbmRleChjYWxsYmFja2ZuIC8qICwgdGhhdCA9IHVuZGVmaW5lZCAqLykge1xuICAgIHJldHVybiAkZmluZCh0aGlzLCBjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7XG4gIH1cbn0pO1xucmVxdWlyZSgnLi9fYWRkLXRvLXVuc2NvcGFibGVzJykoS0VZKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///221\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(40)('Array');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuc3BlY2llcy5qcz9kMDRmIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4vX3NldC1zcGVjaWVzJykoJ0FycmF5Jyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///222\n")},function(module,exports,__webpack_require__){eval("var global = __webpack_require__(3);\nvar inheritIfRequired = __webpack_require__(66);\nvar dP = __webpack_require__(7).f;\nvar gOPN = __webpack_require__(35).f;\nvar isRegExp = __webpack_require__(72);\nvar $flags = __webpack_require__(79);\nvar $RegExp = global.RegExp;\nvar Base = $RegExp;\nvar proto = $RegExp.prototype;\nvar re1 = /a/g;\nvar re2 = /a/g;\n// \"new\" creates a new object, old webkit buggy here\nvar CORRECT_NEW = new $RegExp(re1) !== re1;\n\nif (__webpack_require__(8) && (!CORRECT_NEW || __webpack_require__(2)(function () {\n  re2[__webpack_require__(6)('match')] = false;\n  // RegExp constructor can alter flags and IsRegExp works correct with @@match\n  return $RegExp(re1) != re1 || $RegExp(re2) == re2 || $RegExp(re1, 'i') != '/a/i';\n}))) {\n  $RegExp = function RegExp(p, f) {\n    var tiRE = this instanceof $RegExp;\n    var piRE = isRegExp(p);\n    var fiU = f === undefined;\n    return !tiRE && piRE && p.constructor === $RegExp && fiU ? p\n      : inheritIfRequired(CORRECT_NEW\n        ? new Base(piRE && !fiU ? p.source : p, f)\n        : Base((piRE = p instanceof $RegExp) ? p.source : p, piRE && fiU ? $flags.call(p) : f)\n      , tiRE ? this : proto, $RegExp);\n  };\n  var proxy = function (key) {\n    key in $RegExp || dP($RegExp, key, {\n      configurable: true,\n      get: function () { return Base[key]; },\n      set: function (it) { Base[key] = it; }\n    });\n  };\n  for (var keys = gOPN(Base), i = 0; keys.length > i;) proxy(keys[i++]);\n  proto.constructor = $RegExp;\n  $RegExp.prototype = proto;\n  __webpack_require__(11)(global, 'RegExp', $RegExp);\n}\n\n__webpack_require__(40)('RegExp');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVnZXhwLmNvbnN0cnVjdG9yLmpzPzNiMmIiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGluaGVyaXRJZlJlcXVpcmVkID0gcmVxdWlyZSgnLi9faW5oZXJpdC1pZi1yZXF1aXJlZCcpO1xudmFyIGRQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykuZjtcbnZhciBnT1BOID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4nKS5mO1xudmFyIGlzUmVnRXhwID0gcmVxdWlyZSgnLi9faXMtcmVnZXhwJyk7XG52YXIgJGZsYWdzID0gcmVxdWlyZSgnLi9fZmxhZ3MnKTtcbnZhciAkUmVnRXhwID0gZ2xvYmFsLlJlZ0V4cDtcbnZhciBCYXNlID0gJFJlZ0V4cDtcbnZhciBwcm90byA9ICRSZWdFeHAucHJvdG90eXBlO1xudmFyIHJlMSA9IC9hL2c7XG52YXIgcmUyID0gL2EvZztcbi8vIFwibmV3XCIgY3JlYXRlcyBhIG5ldyBvYmplY3QsIG9sZCB3ZWJraXQgYnVnZ3kgaGVyZVxudmFyIENPUlJFQ1RfTkVXID0gbmV3ICRSZWdFeHAocmUxKSAhPT0gcmUxO1xuXG5pZiAocmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSAmJiAoIUNPUlJFQ1RfTkVXIHx8IHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByZTJbcmVxdWlyZSgnLi9fd2tzJykoJ21hdGNoJyldID0gZmFsc2U7XG4gIC8vIFJlZ0V4cCBjb25zdHJ1Y3RvciBjYW4gYWx0ZXIgZmxhZ3MgYW5kIElzUmVnRXhwIHdvcmtzIGNvcnJlY3Qgd2l0aCBAQG1hdGNoXG4gIHJldHVybiAkUmVnRXhwKHJlMSkgIT0gcmUxIHx8ICRSZWdFeHAocmUyKSA9PSByZTIgfHwgJFJlZ0V4cChyZTEsICdpJykgIT0gJy9hL2knO1xufSkpKSB7XG4gICRSZWdFeHAgPSBmdW5jdGlvbiBSZWdFeHAocCwgZikge1xuICAgIHZhciB0aVJFID0gdGhpcyBpbnN0YW5jZW9mICRSZWdFeHA7XG4gICAgdmFyIHBpUkUgPSBpc1JlZ0V4cChwKTtcbiAgICB2YXIgZmlVID0gZiA9PT0gdW5kZWZpbmVkO1xuICAgIHJldHVybiAhdGlSRSAmJiBwaVJFICYmIHAuY29uc3RydWN0b3IgPT09ICRSZWdFeHAgJiYgZmlVID8gcFxuICAgICAgOiBpbmhlcml0SWZSZXF1aXJlZChDT1JSRUNUX05FV1xuICAgICAgICA/IG5ldyBCYXNlKHBpUkUgJiYgIWZpVSA/IHAuc291cmNlIDogcCwgZilcbiAgICAgICAgOiBCYXNlKChwaVJFID0gcCBpbnN0YW5jZW9mICRSZWdFeHApID8gcC5zb3VyY2UgOiBwLCBwaVJFICYmIGZpVSA/ICRmbGFncy5jYWxsKHApIDogZilcbiAgICAgICwgdGlSRSA/IHRoaXMgOiBwcm90bywgJFJlZ0V4cCk7XG4gIH07XG4gIHZhciBwcm94eSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICBrZXkgaW4gJFJlZ0V4cCB8fCBkUCgkUmVnRXhwLCBrZXksIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gQmFzZVtrZXldOyB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAoaXQpIHsgQmFzZVtrZXldID0gaXQ7IH1cbiAgICB9KTtcbiAgfTtcbiAgZm9yICh2YXIga2V5cyA9IGdPUE4oQmFzZSksIGkgPSAwOyBrZXlzLmxlbmd0aCA+IGk7KSBwcm94eShrZXlzW2krK10pO1xuICBwcm90by5jb25zdHJ1Y3RvciA9ICRSZWdFeHA7XG4gICRSZWdFeHAucHJvdG90eXBlID0gcHJvdG87XG4gIHJlcXVpcmUoJy4vX3JlZGVmaW5lJykoZ2xvYmFsLCAnUmVnRXhwJywgJFJlZ0V4cCk7XG59XG5cbnJlcXVpcmUoJy4vX3NldC1zcGVjaWVzJykoJ1JlZ0V4cCcpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///223\n")},function(module,exports,__webpack_require__){"use strict";eval("\n__webpack_require__(103);\nvar anObject = __webpack_require__(5);\nvar $flags = __webpack_require__(79);\nvar DESCRIPTORS = __webpack_require__(8);\nvar TO_STRING = 'toString';\nvar $toString = /./[TO_STRING];\n\nvar define = function (fn) {\n  __webpack_require__(11)(RegExp.prototype, TO_STRING, fn, true);\n};\n\n// 21.2.5.14 RegExp.prototype.toString()\nif (__webpack_require__(2)(function () { return $toString.call({ source: 'a', flags: 'b' }) != '/a/b'; })) {\n  define(function toString() {\n    var R = anObject(this);\n    return '/'.concat(R.source, '/',\n      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? $flags.call(R) : undefined);\n  });\n// FF44- RegExp#toString has a wrong name\n} else if ($toString.name != TO_STRING) {\n  define(function toString() {\n    return $toString.call(this);\n  });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVnZXhwLnRvLXN0cmluZy5qcz82YjU0Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnJlcXVpcmUoJy4vZXM2LnJlZ2V4cC5mbGFncycpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgJGZsYWdzID0gcmVxdWlyZSgnLi9fZmxhZ3MnKTtcbnZhciBERVNDUklQVE9SUyA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJyk7XG52YXIgVE9fU1RSSU5HID0gJ3RvU3RyaW5nJztcbnZhciAkdG9TdHJpbmcgPSAvLi9bVE9fU1RSSU5HXTtcblxudmFyIGRlZmluZSA9IGZ1bmN0aW9uIChmbikge1xuICByZXF1aXJlKCcuL19yZWRlZmluZScpKFJlZ0V4cC5wcm90b3R5cGUsIFRPX1NUUklORywgZm4sIHRydWUpO1xufTtcblxuLy8gMjEuMi41LjE0IFJlZ0V4cC5wcm90b3R5cGUudG9TdHJpbmcoKVxuaWYgKHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkgeyByZXR1cm4gJHRvU3RyaW5nLmNhbGwoeyBzb3VyY2U6ICdhJywgZmxhZ3M6ICdiJyB9KSAhPSAnL2EvYic7IH0pKSB7XG4gIGRlZmluZShmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICB2YXIgUiA9IGFuT2JqZWN0KHRoaXMpO1xuICAgIHJldHVybiAnLycuY29uY2F0KFIuc291cmNlLCAnLycsXG4gICAgICAnZmxhZ3MnIGluIFIgPyBSLmZsYWdzIDogIURFU0NSSVBUT1JTICYmIFIgaW5zdGFuY2VvZiBSZWdFeHAgPyAkZmxhZ3MuY2FsbChSKSA6IHVuZGVmaW5lZCk7XG4gIH0pO1xuLy8gRkY0NC0gUmVnRXhwI3RvU3RyaW5nIGhhcyBhIHdyb25nIG5hbWVcbn0gZWxzZSBpZiAoJHRvU3RyaW5nLm5hbWUgIT0gVE9fU1RSSU5HKSB7XG4gIGRlZmluZShmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gJHRvU3RyaW5nLmNhbGwodGhpcyk7XG4gIH0pO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///224\n")},function(module,exports,__webpack_require__){eval("// @@match logic\n__webpack_require__(51)('match', 1, function (defined, MATCH, $match) {\n  // 21.1.3.11 String.prototype.match(regexp)\n  return [function match(regexp) {\n    'use strict';\n    var O = defined(this);\n    var fn = regexp == undefined ? undefined : regexp[MATCH];\n    return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n  }, $match];\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVnZXhwLm1hdGNoLmpzPzQ5MTciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQEBtYXRjaCBsb2dpY1xucmVxdWlyZSgnLi9fZml4LXJlLXdrcycpKCdtYXRjaCcsIDEsIGZ1bmN0aW9uIChkZWZpbmVkLCBNQVRDSCwgJG1hdGNoKSB7XG4gIC8vIDIxLjEuMy4xMSBTdHJpbmcucHJvdG90eXBlLm1hdGNoKHJlZ2V4cClcbiAgcmV0dXJuIFtmdW5jdGlvbiBtYXRjaChyZWdleHApIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIE8gPSBkZWZpbmVkKHRoaXMpO1xuICAgIHZhciBmbiA9IHJlZ2V4cCA9PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiByZWdleHBbTUFUQ0hdO1xuICAgIHJldHVybiBmbiAhPT0gdW5kZWZpbmVkID8gZm4uY2FsbChyZWdleHAsIE8pIDogbmV3IFJlZ0V4cChyZWdleHApW01BVENIXShTdHJpbmcoTykpO1xuICB9LCAkbWF0Y2hdO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///225\n")},function(module,exports,__webpack_require__){eval("// @@replace logic\n__webpack_require__(51)('replace', 2, function (defined, REPLACE, $replace) {\n  // 21.1.3.14 String.prototype.replace(searchValue, replaceValue)\n  return [function replace(searchValue, replaceValue) {\n    'use strict';\n    var O = defined(this);\n    var fn = searchValue == undefined ? undefined : searchValue[REPLACE];\n    return fn !== undefined\n      ? fn.call(searchValue, O, replaceValue)\n      : $replace.call(String(O), searchValue, replaceValue);\n  }, $replace];\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVnZXhwLnJlcGxhY2UuanM/YTQ4MSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAQHJlcGxhY2UgbG9naWNcbnJlcXVpcmUoJy4vX2ZpeC1yZS13a3MnKSgncmVwbGFjZScsIDIsIGZ1bmN0aW9uIChkZWZpbmVkLCBSRVBMQUNFLCAkcmVwbGFjZSkge1xuICAvLyAyMS4xLjMuMTQgU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlKHNlYXJjaFZhbHVlLCByZXBsYWNlVmFsdWUpXG4gIHJldHVybiBbZnVuY3Rpb24gcmVwbGFjZShzZWFyY2hWYWx1ZSwgcmVwbGFjZVZhbHVlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciBPID0gZGVmaW5lZCh0aGlzKTtcbiAgICB2YXIgZm4gPSBzZWFyY2hWYWx1ZSA9PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBzZWFyY2hWYWx1ZVtSRVBMQUNFXTtcbiAgICByZXR1cm4gZm4gIT09IHVuZGVmaW5lZFxuICAgICAgPyBmbi5jYWxsKHNlYXJjaFZhbHVlLCBPLCByZXBsYWNlVmFsdWUpXG4gICAgICA6ICRyZXBsYWNlLmNhbGwoU3RyaW5nKE8pLCBzZWFyY2hWYWx1ZSwgcmVwbGFjZVZhbHVlKTtcbiAgfSwgJHJlcGxhY2VdO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///226\n")},function(module,exports,__webpack_require__){eval("// @@search logic\n__webpack_require__(51)('search', 1, function (defined, SEARCH, $search) {\n  // 21.1.3.15 String.prototype.search(regexp)\n  return [function search(regexp) {\n    'use strict';\n    var O = defined(this);\n    var fn = regexp == undefined ? undefined : regexp[SEARCH];\n    return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n  }, $search];\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVnZXhwLnNlYXJjaC5qcz8zODZkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEBAc2VhcmNoIGxvZ2ljXG5yZXF1aXJlKCcuL19maXgtcmUtd2tzJykoJ3NlYXJjaCcsIDEsIGZ1bmN0aW9uIChkZWZpbmVkLCBTRUFSQ0gsICRzZWFyY2gpIHtcbiAgLy8gMjEuMS4zLjE1IFN0cmluZy5wcm90b3R5cGUuc2VhcmNoKHJlZ2V4cClcbiAgcmV0dXJuIFtmdW5jdGlvbiBzZWFyY2gocmVnZXhwKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciBPID0gZGVmaW5lZCh0aGlzKTtcbiAgICB2YXIgZm4gPSByZWdleHAgPT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogcmVnZXhwW1NFQVJDSF07XG4gICAgcmV0dXJuIGZuICE9PSB1bmRlZmluZWQgPyBmbi5jYWxsKHJlZ2V4cCwgTykgOiBuZXcgUmVnRXhwKHJlZ2V4cClbU0VBUkNIXShTdHJpbmcoTykpO1xuICB9LCAkc2VhcmNoXTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///227\n")},function(module,exports,__webpack_require__){eval("// @@split logic\n__webpack_require__(51)('split', 2, function (defined, SPLIT, $split) {\n  'use strict';\n  var isRegExp = __webpack_require__(72);\n  var _split = $split;\n  var $push = [].push;\n  var $SPLIT = 'split';\n  var LENGTH = 'length';\n  var LAST_INDEX = 'lastIndex';\n  if (\n    'abbc'[$SPLIT](/(b)*/)[1] == 'c' ||\n    'test'[$SPLIT](/(?:)/, -1)[LENGTH] != 4 ||\n    'ab'[$SPLIT](/(?:ab)*/)[LENGTH] != 2 ||\n    '.'[$SPLIT](/(.?)(.?)/)[LENGTH] != 4 ||\n    '.'[$SPLIT](/()()/)[LENGTH] > 1 ||\n    ''[$SPLIT](/.?/)[LENGTH]\n  ) {\n    var NPCG = /()??/.exec('')[1] === undefined; // nonparticipating capturing group\n    // based on es5-shim implementation, need to rework it\n    $split = function (separator, limit) {\n      var string = String(this);\n      if (separator === undefined && limit === 0) return [];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) return _split.call(string, separator, limit);\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      var splitLimit = limit === undefined ? 4294967295 : limit >>> 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var separator2, match, lastIndex, lastLength, i;\n      // Doesn't need flags gy, but they don't hurt\n      if (!NPCG) separator2 = new RegExp('^' + separatorCopy.source + '$(?!\\\\s)', flags);\n      while (match = separatorCopy.exec(string)) {\n        // `separatorCopy.lastIndex` is not reliable cross-browser\n        lastIndex = match.index + match[0][LENGTH];\n        if (lastIndex > lastLastIndex) {\n          output.push(string.slice(lastLastIndex, match.index));\n          // Fix browsers whose `exec` methods don't consistently return `undefined` for NPCG\n          // eslint-disable-next-line no-loop-func\n          if (!NPCG && match[LENGTH] > 1) match[0].replace(separator2, function () {\n            for (i = 1; i < arguments[LENGTH] - 2; i++) if (arguments[i] === undefined) match[i] = undefined;\n          });\n          if (match[LENGTH] > 1 && match.index < string[LENGTH]) $push.apply(output, match.slice(1));\n          lastLength = match[0][LENGTH];\n          lastLastIndex = lastIndex;\n          if (output[LENGTH] >= splitLimit) break;\n        }\n        if (separatorCopy[LAST_INDEX] === match.index) separatorCopy[LAST_INDEX]++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string[LENGTH]) {\n        if (lastLength || !separatorCopy.test('')) output.push('');\n      } else output.push(string.slice(lastLastIndex));\n      return output[LENGTH] > splitLimit ? output.slice(0, splitLimit) : output;\n    };\n  // Chakra, V8\n  } else if ('0'[$SPLIT](undefined, 0)[LENGTH]) {\n    $split = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : _split.call(this, separator, limit);\n    };\n  }\n  // 21.1.3.17 String.prototype.split(separator, limit)\n  return [function split(separator, limit) {\n    var O = defined(this);\n    var fn = separator == undefined ? undefined : separator[SPLIT];\n    return fn !== undefined ? fn.call(separator, O, limit) : $split.call(String(O), separator, limit);\n  }, $split];\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVnZXhwLnNwbGl0LmpzPzI4YTUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQEBzcGxpdCBsb2dpY1xucmVxdWlyZSgnLi9fZml4LXJlLXdrcycpKCdzcGxpdCcsIDIsIGZ1bmN0aW9uIChkZWZpbmVkLCBTUExJVCwgJHNwbGl0KSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyIGlzUmVnRXhwID0gcmVxdWlyZSgnLi9faXMtcmVnZXhwJyk7XG4gIHZhciBfc3BsaXQgPSAkc3BsaXQ7XG4gIHZhciAkcHVzaCA9IFtdLnB1c2g7XG4gIHZhciAkU1BMSVQgPSAnc3BsaXQnO1xuICB2YXIgTEVOR1RIID0gJ2xlbmd0aCc7XG4gIHZhciBMQVNUX0lOREVYID0gJ2xhc3RJbmRleCc7XG4gIGlmIChcbiAgICAnYWJiYydbJFNQTElUXSgvKGIpKi8pWzFdID09ICdjJyB8fFxuICAgICd0ZXN0J1skU1BMSVRdKC8oPzopLywgLTEpW0xFTkdUSF0gIT0gNCB8fFxuICAgICdhYidbJFNQTElUXSgvKD86YWIpKi8pW0xFTkdUSF0gIT0gMiB8fFxuICAgICcuJ1skU1BMSVRdKC8oLj8pKC4/KS8pW0xFTkdUSF0gIT0gNCB8fFxuICAgICcuJ1skU1BMSVRdKC8oKSgpLylbTEVOR1RIXSA+IDEgfHxcbiAgICAnJ1skU1BMSVRdKC8uPy8pW0xFTkdUSF1cbiAgKSB7XG4gICAgdmFyIE5QQ0cgPSAvKCk/Py8uZXhlYygnJylbMV0gPT09IHVuZGVmaW5lZDsgLy8gbm9ucGFydGljaXBhdGluZyBjYXB0dXJpbmcgZ3JvdXBcbiAgICAvLyBiYXNlZCBvbiBlczUtc2hpbSBpbXBsZW1lbnRhdGlvbiwgbmVlZCB0byByZXdvcmsgaXRcbiAgICAkc3BsaXQgPSBmdW5jdGlvbiAoc2VwYXJhdG9yLCBsaW1pdCkge1xuICAgICAgdmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTtcbiAgICAgIGlmIChzZXBhcmF0b3IgPT09IHVuZGVmaW5lZCAmJiBsaW1pdCA9PT0gMCkgcmV0dXJuIFtdO1xuICAgICAgLy8gSWYgYHNlcGFyYXRvcmAgaXMgbm90IGEgcmVnZXgsIHVzZSBuYXRpdmUgc3BsaXRcbiAgICAgIGlmICghaXNSZWdFeHAoc2VwYXJhdG9yKSkgcmV0dXJuIF9zcGxpdC5jYWxsKHN0cmluZywgc2VwYXJhdG9yLCBsaW1pdCk7XG4gICAgICB2YXIgb3V0cHV0ID0gW107XG4gICAgICB2YXIgZmxhZ3MgPSAoc2VwYXJhdG9yLmlnbm9yZUNhc2UgPyAnaScgOiAnJykgK1xuICAgICAgICAgICAgICAgICAgKHNlcGFyYXRvci5tdWx0aWxpbmUgPyAnbScgOiAnJykgK1xuICAgICAgICAgICAgICAgICAgKHNlcGFyYXRvci51bmljb2RlID8gJ3UnIDogJycpICtcbiAgICAgICAgICAgICAgICAgIChzZXBhcmF0b3Iuc3RpY2t5ID8gJ3knIDogJycpO1xuICAgICAgdmFyIGxhc3RMYXN0SW5kZXggPSAwO1xuICAgICAgdmFyIHNwbGl0TGltaXQgPSBsaW1pdCA9PT0gdW5kZWZpbmVkID8gNDI5NDk2NzI5NSA6IGxpbWl0ID4+PiAwO1xuICAgICAgLy8gTWFrZSBgZ2xvYmFsYCBhbmQgYXZvaWQgYGxhc3RJbmRleGAgaXNzdWVzIGJ5IHdvcmtpbmcgd2l0aCBhIGNvcHlcbiAgICAgIHZhciBzZXBhcmF0b3JDb3B5ID0gbmV3IFJlZ0V4cChzZXBhcmF0b3Iuc291cmNlLCBmbGFncyArICdnJyk7XG4gICAgICB2YXIgc2VwYXJhdG9yMiwgbWF0Y2gsIGxhc3RJbmRleCwgbGFzdExlbmd0aCwgaTtcbiAgICAgIC8vIERvZXNuJ3QgbmVlZCBmbGFncyBneSwgYnV0IHRoZXkgZG9uJ3QgaHVydFxuICAgICAgaWYgKCFOUENHKSBzZXBhcmF0b3IyID0gbmV3IFJlZ0V4cCgnXicgKyBzZXBhcmF0b3JDb3B5LnNvdXJjZSArICckKD8hXFxcXHMpJywgZmxhZ3MpO1xuICAgICAgd2hpbGUgKG1hdGNoID0gc2VwYXJhdG9yQ29weS5leGVjKHN0cmluZykpIHtcbiAgICAgICAgLy8gYHNlcGFyYXRvckNvcHkubGFzdEluZGV4YCBpcyBub3QgcmVsaWFibGUgY3Jvc3MtYnJvd3NlclxuICAgICAgICBsYXN0SW5kZXggPSBtYXRjaC5pbmRleCArIG1hdGNoWzBdW0xFTkdUSF07XG4gICAgICAgIGlmIChsYXN0SW5kZXggPiBsYXN0TGFzdEluZGV4KSB7XG4gICAgICAgICAgb3V0cHV0LnB1c2goc3RyaW5nLnNsaWNlKGxhc3RMYXN0SW5kZXgsIG1hdGNoLmluZGV4KSk7XG4gICAgICAgICAgLy8gRml4IGJyb3dzZXJzIHdob3NlIGBleGVjYCBtZXRob2RzIGRvbid0IGNvbnNpc3RlbnRseSByZXR1cm4gYHVuZGVmaW5lZGAgZm9yIE5QQ0dcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbG9vcC1mdW5jXG4gICAgICAgICAgaWYgKCFOUENHICYmIG1hdGNoW0xFTkdUSF0gPiAxKSBtYXRjaFswXS5yZXBsYWNlKHNlcGFyYXRvcjIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCBhcmd1bWVudHNbTEVOR1RIXSAtIDI7IGkrKykgaWYgKGFyZ3VtZW50c1tpXSA9PT0gdW5kZWZpbmVkKSBtYXRjaFtpXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAobWF0Y2hbTEVOR1RIXSA+IDEgJiYgbWF0Y2guaW5kZXggPCBzdHJpbmdbTEVOR1RIXSkgJHB1c2guYXBwbHkob3V0cHV0LCBtYXRjaC5zbGljZSgxKSk7XG4gICAgICAgICAgbGFzdExlbmd0aCA9IG1hdGNoWzBdW0xFTkdUSF07XG4gICAgICAgICAgbGFzdExhc3RJbmRleCA9IGxhc3RJbmRleDtcbiAgICAgICAgICBpZiAob3V0cHV0W0xFTkdUSF0gPj0gc3BsaXRMaW1pdCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlcGFyYXRvckNvcHlbTEFTVF9JTkRFWF0gPT09IG1hdGNoLmluZGV4KSBzZXBhcmF0b3JDb3B5W0xBU1RfSU5ERVhdKys7IC8vIEF2b2lkIGFuIGluZmluaXRlIGxvb3BcbiAgICAgIH1cbiAgICAgIGlmIChsYXN0TGFzdEluZGV4ID09PSBzdHJpbmdbTEVOR1RIXSkge1xuICAgICAgICBpZiAobGFzdExlbmd0aCB8fCAhc2VwYXJhdG9yQ29weS50ZXN0KCcnKSkgb3V0cHV0LnB1c2goJycpO1xuICAgICAgfSBlbHNlIG91dHB1dC5wdXNoKHN0cmluZy5zbGljZShsYXN0TGFzdEluZGV4KSk7XG4gICAgICByZXR1cm4gb3V0cHV0W0xFTkdUSF0gPiBzcGxpdExpbWl0ID8gb3V0cHV0LnNsaWNlKDAsIHNwbGl0TGltaXQpIDogb3V0cHV0O1xuICAgIH07XG4gIC8vIENoYWtyYSwgVjhcbiAgfSBlbHNlIGlmICgnMCdbJFNQTElUXSh1bmRlZmluZWQsIDApW0xFTkdUSF0pIHtcbiAgICAkc3BsaXQgPSBmdW5jdGlvbiAoc2VwYXJhdG9yLCBsaW1pdCkge1xuICAgICAgcmV0dXJuIHNlcGFyYXRvciA9PT0gdW5kZWZpbmVkICYmIGxpbWl0ID09PSAwID8gW10gOiBfc3BsaXQuY2FsbCh0aGlzLCBzZXBhcmF0b3IsIGxpbWl0KTtcbiAgICB9O1xuICB9XG4gIC8vIDIxLjEuMy4xNyBTdHJpbmcucHJvdG90eXBlLnNwbGl0KHNlcGFyYXRvciwgbGltaXQpXG4gIHJldHVybiBbZnVuY3Rpb24gc3BsaXQoc2VwYXJhdG9yLCBsaW1pdCkge1xuICAgIHZhciBPID0gZGVmaW5lZCh0aGlzKTtcbiAgICB2YXIgZm4gPSBzZXBhcmF0b3IgPT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogc2VwYXJhdG9yW1NQTElUXTtcbiAgICByZXR1cm4gZm4gIT09IHVuZGVmaW5lZCA/IGZuLmNhbGwoc2VwYXJhdG9yLCBPLCBsaW1pdCkgOiAkc3BsaXQuY2FsbChTdHJpbmcoTyksIHNlcGFyYXRvciwgbGltaXQpO1xuICB9LCAkc3BsaXRdO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///228\n")},function(module,exports,__webpack_require__){eval("var global = __webpack_require__(3);\nvar macrotask = __webpack_require__(80).set;\nvar Observer = global.MutationObserver || global.WebKitMutationObserver;\nvar process = global.process;\nvar Promise = global.Promise;\nvar isNode = __webpack_require__(23)(process) == 'process';\n\nmodule.exports = function () {\n  var head, last, notify;\n\n  var flush = function () {\n    var parent, fn;\n    if (isNode && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (e) {\n        if (head) notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // Node.js\n  if (isNode) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339\n  } else if (Observer && !(global.navigator && global.navigator.standalone)) {\n    var toggle = true;\n    var node = document.createTextNode('');\n    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    var promise = Promise.resolve(undefined);\n    notify = function () {\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function (fn) {\n    var task = { fn: fn, next: undefined };\n    if (last) last.next = task;\n    if (!head) {\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fbWljcm90YXNrLmpzPzgwNzkiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIG1hY3JvdGFzayA9IHJlcXVpcmUoJy4vX3Rhc2snKS5zZXQ7XG52YXIgT2JzZXJ2ZXIgPSBnbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBnbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcjtcbnZhciBwcm9jZXNzID0gZ2xvYmFsLnByb2Nlc3M7XG52YXIgUHJvbWlzZSA9IGdsb2JhbC5Qcm9taXNlO1xudmFyIGlzTm9kZSA9IHJlcXVpcmUoJy4vX2NvZicpKHByb2Nlc3MpID09ICdwcm9jZXNzJztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7XG5cbiAgdmFyIGZsdXNoID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBwYXJlbnQsIGZuO1xuICAgIGlmIChpc05vZGUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSkgcGFyZW50LmV4aXQoKTtcbiAgICB3aGlsZSAoaGVhZCkge1xuICAgICAgZm4gPSBoZWFkLmZuO1xuICAgICAgaGVhZCA9IGhlYWQubmV4dDtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZuKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChoZWFkKSBub3RpZnkoKTtcbiAgICAgICAgZWxzZSBsYXN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aHJvdyBlO1xuICAgICAgfVxuICAgIH0gbGFzdCA9IHVuZGVmaW5lZDtcbiAgICBpZiAocGFyZW50KSBwYXJlbnQuZW50ZXIoKTtcbiAgfTtcblxuICAvLyBOb2RlLmpzXG4gIGlmIChpc05vZGUpIHtcbiAgICBub3RpZnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTtcbiAgICB9O1xuICAvLyBicm93c2VycyB3aXRoIE11dGF0aW9uT2JzZXJ2ZXIsIGV4Y2VwdCBpT1MgU2FmYXJpIC0gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzMzOVxuICB9IGVsc2UgaWYgKE9ic2VydmVyICYmICEoZ2xvYmFsLm5hdmlnYXRvciAmJiBnbG9iYWwubmF2aWdhdG9yLnN0YW5kYWxvbmUpKSB7XG4gICAgdmFyIHRvZ2dsZSA9IHRydWU7XG4gICAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7XG4gICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHsgY2hhcmFjdGVyRGF0YTogdHJ1ZSB9KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXdcbiAgICBub3RpZnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlO1xuICAgIH07XG4gIC8vIGVudmlyb25tZW50cyB3aXRoIG1heWJlIG5vbi1jb21wbGV0ZWx5IGNvcnJlY3QsIGJ1dCBleGlzdGVudCBQcm9taXNlXG4gIH0gZWxzZSBpZiAoUHJvbWlzZSAmJiBQcm9taXNlLnJlc29sdmUpIHtcbiAgICAvLyBQcm9taXNlLnJlc29sdmUgd2l0aG91dCBhbiBhcmd1bWVudCB0aHJvd3MgYW4gZXJyb3IgaW4gTEcgV2ViT1MgMlxuICAgIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgbm90aWZ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTtcbiAgICB9O1xuICAvLyBmb3Igb3RoZXIgZW52aXJvbm1lbnRzIC0gbWFjcm90YXNrIGJhc2VkIG9uOlxuICAvLyAtIHNldEltbWVkaWF0ZVxuICAvLyAtIE1lc3NhZ2VDaGFubmVsXG4gIC8vIC0gd2luZG93LnBvc3RNZXNzYWdcbiAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2VcbiAgLy8gLSBzZXRUaW1lb3V0XG4gIH0gZWxzZSB7XG4gICAgbm90aWZ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKVxuICAgICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoZm4pIHtcbiAgICB2YXIgdGFzayA9IHsgZm46IGZuLCBuZXh0OiB1bmRlZmluZWQgfTtcbiAgICBpZiAobGFzdCkgbGFzdC5uZXh0ID0gdGFzaztcbiAgICBpZiAoIWhlYWQpIHtcbiAgICAgIGhlYWQgPSB0YXNrO1xuICAgICAgbm90aWZ5KCk7XG4gICAgfSBsYXN0ID0gdGFzaztcbiAgfTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///229\n")},function(module,exports){eval("module.exports = function (exec) {\n  try {\n    return { e: false, v: exec() };\n  } catch (e) {\n    return { e: true, v: e };\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9fcGVyZm9ybS5qcz85YzgwIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGV4ZWMpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4geyBlOiBmYWxzZSwgdjogZXhlYygpIH07XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4geyBlOiB0cnVlLCB2OiBlIH07XG4gIH1cbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///230\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar strong = __webpack_require__(107);\nvar validate = __webpack_require__(43);\nvar MAP = 'Map';\n\n// 23.1 Map Objects\nmodule.exports = __webpack_require__(55)(MAP, function (get) {\n  return function Map() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.1.3.6 Map.prototype.get(key)\n  get: function get(key) {\n    var entry = strong.getEntry(validate(this, MAP), key);\n    return entry && entry.v;\n  },\n  // 23.1.3.9 Map.prototype.set(key, value)\n  set: function set(key, value) {\n    return strong.def(validate(this, MAP), key === 0 ? 0 : key, value);\n  }\n}, strong, true);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYubWFwLmpzP2Y0MDAiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIHN0cm9uZyA9IHJlcXVpcmUoJy4vX2NvbGxlY3Rpb24tc3Ryb25nJyk7XG52YXIgdmFsaWRhdGUgPSByZXF1aXJlKCcuL192YWxpZGF0ZS1jb2xsZWN0aW9uJyk7XG52YXIgTUFQID0gJ01hcCc7XG5cbi8vIDIzLjEgTWFwIE9iamVjdHNcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fY29sbGVjdGlvbicpKE1BUCwgZnVuY3Rpb24gKGdldCkge1xuICByZXR1cm4gZnVuY3Rpb24gTWFwKCkgeyByZXR1cm4gZ2V0KHRoaXMsIGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsgfTtcbn0sIHtcbiAgLy8gMjMuMS4zLjYgTWFwLnByb3RvdHlwZS5nZXQoa2V5KVxuICBnZXQ6IGZ1bmN0aW9uIGdldChrZXkpIHtcbiAgICB2YXIgZW50cnkgPSBzdHJvbmcuZ2V0RW50cnkodmFsaWRhdGUodGhpcywgTUFQKSwga2V5KTtcbiAgICByZXR1cm4gZW50cnkgJiYgZW50cnkudjtcbiAgfSxcbiAgLy8gMjMuMS4zLjkgTWFwLnByb3RvdHlwZS5zZXQoa2V5LCB2YWx1ZSlcbiAgc2V0OiBmdW5jdGlvbiBzZXQoa2V5LCB2YWx1ZSkge1xuICAgIHJldHVybiBzdHJvbmcuZGVmKHZhbGlkYXRlKHRoaXMsIE1BUCksIGtleSA9PT0gMCA/IDAgOiBrZXksIHZhbHVlKTtcbiAgfVxufSwgc3Ryb25nLCB0cnVlKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///231\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar strong = __webpack_require__(107);\nvar validate = __webpack_require__(43);\nvar SET = 'Set';\n\n// 23.2 Set Objects\nmodule.exports = __webpack_require__(55)(SET, function (get) {\n  return function Set() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.2.3.1 Set.prototype.add(value)\n  add: function add(value) {\n    return strong.def(validate(this, SET), value = value === 0 ? 0 : value, value);\n  }\n}, strong);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYuc2V0LmpzPzRmN2YiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIHN0cm9uZyA9IHJlcXVpcmUoJy4vX2NvbGxlY3Rpb24tc3Ryb25nJyk7XG52YXIgdmFsaWRhdGUgPSByZXF1aXJlKCcuL192YWxpZGF0ZS1jb2xsZWN0aW9uJyk7XG52YXIgU0VUID0gJ1NldCc7XG5cbi8vIDIzLjIgU2V0IE9iamVjdHNcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fY29sbGVjdGlvbicpKFNFVCwgZnVuY3Rpb24gKGdldCkge1xuICByZXR1cm4gZnVuY3Rpb24gU2V0KCkgeyByZXR1cm4gZ2V0KHRoaXMsIGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsgfTtcbn0sIHtcbiAgLy8gMjMuMi4zLjEgU2V0LnByb3RvdHlwZS5hZGQodmFsdWUpXG4gIGFkZDogZnVuY3Rpb24gYWRkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHN0cm9uZy5kZWYodmFsaWRhdGUodGhpcywgU0VUKSwgdmFsdWUgPSB2YWx1ZSA9PT0gMCA/IDAgOiB2YWx1ZSwgdmFsdWUpO1xuICB9XG59LCBzdHJvbmcpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///232\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar each = __webpack_require__(20)(0);\nvar redefine = __webpack_require__(11);\nvar meta = __webpack_require__(28);\nvar assign = __webpack_require__(89);\nvar weak = __webpack_require__(108);\nvar isObject = __webpack_require__(4);\nvar fails = __webpack_require__(2);\nvar validate = __webpack_require__(43);\nvar WEAK_MAP = 'WeakMap';\nvar getWeak = meta.getWeak;\nvar isExtensible = Object.isExtensible;\nvar uncaughtFrozenStore = weak.ufstore;\nvar tmp = {};\nvar InternalMap;\n\nvar wrapper = function (get) {\n  return function WeakMap() {\n    return get(this, arguments.length > 0 ? arguments[0] : undefined);\n  };\n};\n\nvar methods = {\n  // 23.3.3.3 WeakMap.prototype.get(key)\n  get: function get(key) {\n    if (isObject(key)) {\n      var data = getWeak(key);\n      if (data === true) return uncaughtFrozenStore(validate(this, WEAK_MAP)).get(key);\n      return data ? data[this._i] : undefined;\n    }\n  },\n  // 23.3.3.5 WeakMap.prototype.set(key, value)\n  set: function set(key, value) {\n    return weak.def(validate(this, WEAK_MAP), key, value);\n  }\n};\n\n// 23.3 WeakMap Objects\nvar $WeakMap = module.exports = __webpack_require__(55)(WEAK_MAP, wrapper, methods, weak, true, true);\n\n// IE11 WeakMap frozen keys fix\nif (fails(function () { return new $WeakMap().set((Object.freeze || Object)(tmp), 7).get(tmp) != 7; })) {\n  InternalMap = weak.getConstructor(wrapper, WEAK_MAP);\n  assign(InternalMap.prototype, methods);\n  meta.NEED = true;\n  each(['delete', 'has', 'get', 'set'], function (key) {\n    var proto = $WeakMap.prototype;\n    var method = proto[key];\n    redefine(proto, key, function (a, b) {\n      // store frozen objects on internal weakmap shim\n      if (isObject(a) && !isExtensible(a)) {\n        if (!this._f) this._f = new InternalMap();\n        var result = this._f[key](a, b);\n        return key == 'set' ? this : result;\n      // store all the rest on native weakmap\n      } return method.call(this, a, b);\n    });\n  });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYud2Vhay1tYXAuanM/MTBhZCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgZWFjaCA9IHJlcXVpcmUoJy4vX2FycmF5LW1ldGhvZHMnKSgwKTtcbnZhciByZWRlZmluZSA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJyk7XG52YXIgbWV0YSA9IHJlcXVpcmUoJy4vX21ldGEnKTtcbnZhciBhc3NpZ24gPSByZXF1aXJlKCcuL19vYmplY3QtYXNzaWduJyk7XG52YXIgd2VhayA9IHJlcXVpcmUoJy4vX2NvbGxlY3Rpb24td2VhaycpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgZmFpbHMgPSByZXF1aXJlKCcuL19mYWlscycpO1xudmFyIHZhbGlkYXRlID0gcmVxdWlyZSgnLi9fdmFsaWRhdGUtY29sbGVjdGlvbicpO1xudmFyIFdFQUtfTUFQID0gJ1dlYWtNYXAnO1xudmFyIGdldFdlYWsgPSBtZXRhLmdldFdlYWs7XG52YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZTtcbnZhciB1bmNhdWdodEZyb3plblN0b3JlID0gd2Vhay51ZnN0b3JlO1xudmFyIHRtcCA9IHt9O1xudmFyIEludGVybmFsTWFwO1xuXG52YXIgd3JhcHBlciA9IGZ1bmN0aW9uIChnZXQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIFdlYWtNYXAoKSB7XG4gICAgcmV0dXJuIGdldCh0aGlzLCBhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7XG4gIH07XG59O1xuXG52YXIgbWV0aG9kcyA9IHtcbiAgLy8gMjMuMy4zLjMgV2Vha01hcC5wcm90b3R5cGUuZ2V0KGtleSlcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7XG4gICAgaWYgKGlzT2JqZWN0KGtleSkpIHtcbiAgICAgIHZhciBkYXRhID0gZ2V0V2VhayhrZXkpO1xuICAgICAgaWYgKGRhdGEgPT09IHRydWUpIHJldHVybiB1bmNhdWdodEZyb3plblN0b3JlKHZhbGlkYXRlKHRoaXMsIFdFQUtfTUFQKSkuZ2V0KGtleSk7XG4gICAgICByZXR1cm4gZGF0YSA/IGRhdGFbdGhpcy5faV0gOiB1bmRlZmluZWQ7XG4gICAgfVxuICB9LFxuICAvLyAyMy4zLjMuNSBXZWFrTWFwLnByb3RvdHlwZS5zZXQoa2V5LCB2YWx1ZSlcbiAgc2V0OiBmdW5jdGlvbiBzZXQoa2V5LCB2YWx1ZSkge1xuICAgIHJldHVybiB3ZWFrLmRlZih2YWxpZGF0ZSh0aGlzLCBXRUFLX01BUCksIGtleSwgdmFsdWUpO1xuICB9XG59O1xuXG4vLyAyMy4zIFdlYWtNYXAgT2JqZWN0c1xudmFyICRXZWFrTWFwID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19jb2xsZWN0aW9uJykoV0VBS19NQVAsIHdyYXBwZXIsIG1ldGhvZHMsIHdlYWssIHRydWUsIHRydWUpO1xuXG4vLyBJRTExIFdlYWtNYXAgZnJvemVuIGtleXMgZml4XG5pZiAoZmFpbHMoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3ICRXZWFrTWFwKCkuc2V0KChPYmplY3QuZnJlZXplIHx8IE9iamVjdCkodG1wKSwgNykuZ2V0KHRtcCkgIT0gNzsgfSkpIHtcbiAgSW50ZXJuYWxNYXAgPSB3ZWFrLmdldENvbnN0cnVjdG9yKHdyYXBwZXIsIFdFQUtfTUFQKTtcbiAgYXNzaWduKEludGVybmFsTWFwLnByb3RvdHlwZSwgbWV0aG9kcyk7XG4gIG1ldGEuTkVFRCA9IHRydWU7XG4gIGVhY2goWydkZWxldGUnLCAnaGFzJywgJ2dldCcsICdzZXQnXSwgZnVuY3Rpb24gKGtleSkge1xuICAgIHZhciBwcm90byA9ICRXZWFrTWFwLnByb3RvdHlwZTtcbiAgICB2YXIgbWV0aG9kID0gcHJvdG9ba2V5XTtcbiAgICByZWRlZmluZShwcm90bywga2V5LCBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgLy8gc3RvcmUgZnJvemVuIG9iamVjdHMgb24gaW50ZXJuYWwgd2Vha21hcCBzaGltXG4gICAgICBpZiAoaXNPYmplY3QoYSkgJiYgIWlzRXh0ZW5zaWJsZShhKSkge1xuICAgICAgICBpZiAoIXRoaXMuX2YpIHRoaXMuX2YgPSBuZXcgSW50ZXJuYWxNYXAoKTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2Zba2V5XShhLCBiKTtcbiAgICAgICAgcmV0dXJuIGtleSA9PSAnc2V0JyA/IHRoaXMgOiByZXN1bHQ7XG4gICAgICAvLyBzdG9yZSBhbGwgdGhlIHJlc3Qgb24gbmF0aXZlIHdlYWttYXBcbiAgICAgIH0gcmV0dXJuIG1ldGhvZC5jYWxsKHRoaXMsIGEsIGIpO1xuICAgIH0pO1xuICB9KTtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///233\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar weak = __webpack_require__(108);\nvar validate = __webpack_require__(43);\nvar WEAK_SET = 'WeakSet';\n\n// 23.4 WeakSet Objects\n__webpack_require__(55)(WEAK_SET, function (get) {\n  return function WeakSet() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.4.3.1 WeakSet.prototype.add(value)\n  add: function add(value) {\n    return weak.def(validate(this, WEAK_SET), value, true);\n  }\n}, weak, false, true);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYud2Vhay1zZXQuanM/YzAyYiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgd2VhayA9IHJlcXVpcmUoJy4vX2NvbGxlY3Rpb24td2VhaycpO1xudmFyIHZhbGlkYXRlID0gcmVxdWlyZSgnLi9fdmFsaWRhdGUtY29sbGVjdGlvbicpO1xudmFyIFdFQUtfU0VUID0gJ1dlYWtTZXQnO1xuXG4vLyAyMy40IFdlYWtTZXQgT2JqZWN0c1xucmVxdWlyZSgnLi9fY29sbGVjdGlvbicpKFdFQUtfU0VULCBmdW5jdGlvbiAoZ2V0KSB7XG4gIHJldHVybiBmdW5jdGlvbiBXZWFrU2V0KCkgeyByZXR1cm4gZ2V0KHRoaXMsIGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsgfTtcbn0sIHtcbiAgLy8gMjMuNC4zLjEgV2Vha1NldC5wcm90b3R5cGUuYWRkKHZhbHVlKVxuICBhZGQ6IGZ1bmN0aW9uIGFkZCh2YWx1ZSkge1xuICAgIHJldHVybiB3ZWFrLmRlZih2YWxpZGF0ZSh0aGlzLCBXRUFLX1NFVCksIHZhbHVlLCB0cnVlKTtcbiAgfVxufSwgd2VhaywgZmFsc2UsIHRydWUpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///234\n")},function(module,exports,__webpack_require__){"use strict";eval("\nvar $export = __webpack_require__(1);\nvar $typed = __webpack_require__(56);\nvar buffer = __webpack_require__(81);\nvar anObject = __webpack_require__(5);\nvar toAbsoluteIndex = __webpack_require__(33);\nvar toLength = __webpack_require__(10);\nvar isObject = __webpack_require__(4);\nvar ArrayBuffer = __webpack_require__(3).ArrayBuffer;\nvar speciesConstructor = __webpack_require__(53);\nvar $ArrayBuffer = buffer.ArrayBuffer;\nvar $DataView = buffer.DataView;\nvar $isView = $typed.ABV && ArrayBuffer.isView;\nvar $slice = $ArrayBuffer.prototype.slice;\nvar VIEW = $typed.VIEW;\nvar ARRAY_BUFFER = 'ArrayBuffer';\n\n$export($export.G + $export.W + $export.F * (ArrayBuffer !== $ArrayBuffer), { ArrayBuffer: $ArrayBuffer });\n\n$export($export.S + $export.F * !$typed.CONSTR, ARRAY_BUFFER, {\n  // 24.1.3.1 ArrayBuffer.isView(arg)\n  isView: function isView(it) {\n    return $isView && $isView(it) || isObject(it) && VIEW in it;\n  }\n});\n\n$export($export.P + $export.U + $export.F * __webpack_require__(2)(function () {\n  return !new $ArrayBuffer(2).slice(1, undefined).byteLength;\n}), ARRAY_BUFFER, {\n  // 24.1.4.3 ArrayBuffer.prototype.slice(start, end)\n  slice: function slice(start, end) {\n    if ($slice !== undefined && end === undefined) return $slice.call(anObject(this), start); // FF fix\n    var len = anObject(this).byteLength;\n    var first = toAbsoluteIndex(start, len);\n    var fin = toAbsoluteIndex(end === undefined ? len : end, len);\n    var result = new (speciesConstructor(this, $ArrayBuffer))(toLength(fin - first));\n    var viewS = new $DataView(this);\n    var viewT = new $DataView(result);\n    var index = 0;\n    while (first < fin) {\n      viewT.setUint8(index++, viewS.getUint8(first++));\n    } return result;\n  }\n});\n\n__webpack_require__(40)(ARRAY_BUFFER);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQuYXJyYXktYnVmZmVyLmpzP2M2NmYiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkdHlwZWQgPSByZXF1aXJlKCcuL190eXBlZCcpO1xudmFyIGJ1ZmZlciA9IHJlcXVpcmUoJy4vX3R5cGVkLWJ1ZmZlcicpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgdG9BYnNvbHV0ZUluZGV4ID0gcmVxdWlyZSgnLi9fdG8tYWJzb2x1dGUtaW5kZXgnKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgQXJyYXlCdWZmZXIgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5BcnJheUJ1ZmZlcjtcbnZhciBzcGVjaWVzQ29uc3RydWN0b3IgPSByZXF1aXJlKCcuL19zcGVjaWVzLWNvbnN0cnVjdG9yJyk7XG52YXIgJEFycmF5QnVmZmVyID0gYnVmZmVyLkFycmF5QnVmZmVyO1xudmFyICREYXRhVmlldyA9IGJ1ZmZlci5EYXRhVmlldztcbnZhciAkaXNWaWV3ID0gJHR5cGVkLkFCViAmJiBBcnJheUJ1ZmZlci5pc1ZpZXc7XG52YXIgJHNsaWNlID0gJEFycmF5QnVmZmVyLnByb3RvdHlwZS5zbGljZTtcbnZhciBWSUVXID0gJHR5cGVkLlZJRVc7XG52YXIgQVJSQVlfQlVGRkVSID0gJ0FycmF5QnVmZmVyJztcblxuJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAoQXJyYXlCdWZmZXIgIT09ICRBcnJheUJ1ZmZlciksIHsgQXJyYXlCdWZmZXI6ICRBcnJheUJ1ZmZlciB9KTtcblxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhJHR5cGVkLkNPTlNUUiwgQVJSQVlfQlVGRkVSLCB7XG4gIC8vIDI0LjEuMy4xIEFycmF5QnVmZmVyLmlzVmlldyhhcmcpXG4gIGlzVmlldzogZnVuY3Rpb24gaXNWaWV3KGl0KSB7XG4gICAgcmV0dXJuICRpc1ZpZXcgJiYgJGlzVmlldyhpdCkgfHwgaXNPYmplY3QoaXQpICYmIFZJRVcgaW4gaXQ7XG4gIH1cbn0pO1xuXG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuVSArICRleHBvcnQuRiAqIHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gIW5ldyAkQXJyYXlCdWZmZXIoMikuc2xpY2UoMSwgdW5kZWZpbmVkKS5ieXRlTGVuZ3RoO1xufSksIEFSUkFZX0JVRkZFUiwge1xuICAvLyAyNC4xLjQuMyBBcnJheUJ1ZmZlci5wcm90b3R5cGUuc2xpY2Uoc3RhcnQsIGVuZClcbiAgc2xpY2U6IGZ1bmN0aW9uIHNsaWNlKHN0YXJ0LCBlbmQpIHtcbiAgICBpZiAoJHNsaWNlICE9PSB1bmRlZmluZWQgJiYgZW5kID09PSB1bmRlZmluZWQpIHJldHVybiAkc2xpY2UuY2FsbChhbk9iamVjdCh0aGlzKSwgc3RhcnQpOyAvLyBGRiBmaXhcbiAgICB2YXIgbGVuID0gYW5PYmplY3QodGhpcykuYnl0ZUxlbmd0aDtcbiAgICB2YXIgZmlyc3QgPSB0b0Fic29sdXRlSW5kZXgoc3RhcnQsIGxlbik7XG4gICAgdmFyIGZpbiA9IHRvQWJzb2x1dGVJbmRleChlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IGVuZCwgbGVuKTtcbiAgICB2YXIgcmVzdWx0ID0gbmV3IChzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgJEFycmF5QnVmZmVyKSkodG9MZW5ndGgoZmluIC0gZmlyc3QpKTtcbiAgICB2YXIgdmlld1MgPSBuZXcgJERhdGFWaWV3KHRoaXMpO1xuICAgIHZhciB2aWV3VCA9IG5ldyAkRGF0YVZpZXcocmVzdWx0KTtcbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHdoaWxlIChmaXJzdCA8IGZpbikge1xuICAgICAgdmlld1Quc2V0VWludDgoaW5kZXgrKywgdmlld1MuZ2V0VWludDgoZmlyc3QrKykpO1xuICAgIH0gcmV0dXJuIHJlc3VsdDtcbiAgfVxufSk7XG5cbnJlcXVpcmUoJy4vX3NldC1zcGVjaWVzJykoQVJSQVlfQlVGRkVSKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///235\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\n$export($export.G + $export.W + $export.F * !__webpack_require__(56).ABV, {\n  DataView: __webpack_require__(81).DataView\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQuZGF0YS12aWV3LmpzPzI2MmYiXSwic291cmNlc0NvbnRlbnQiOlsidmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX3R5cGVkJykuQUJWLCB7XG4gIERhdGFWaWV3OiByZXF1aXJlKCcuL190eXBlZC1idWZmZXInKS5EYXRhVmlld1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///236\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Int8', 1, function (init) {\n  return function Int8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQuaW50OC1hcnJheS5qcz9iMDVjIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4vX3R5cGVkLWFycmF5JykoJ0ludDgnLCAxLCBmdW5jdGlvbiAoaW5pdCkge1xuICByZXR1cm4gZnVuY3Rpb24gSW50OEFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///237\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Uint8', 1, function (init) {\n  return function Uint8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQudWludDgtYXJyYXkuanM/MzRlZiJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuL190eXBlZC1hcnJheScpKCdVaW50OCcsIDEsIGZ1bmN0aW9uIChpbml0KSB7XG4gIHJldHVybiBmdW5jdGlvbiBVaW50OEFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///238\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Uint8', 1, function (init) {\n  return function Uint8ClampedArray(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n}, true);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQudWludDgtY2xhbXBlZC1hcnJheS5qcz82YWEyIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4vX3R5cGVkLWFycmF5JykoJ1VpbnQ4JywgMSwgZnVuY3Rpb24gKGluaXQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIFVpbnQ4Q2xhbXBlZEFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59LCB0cnVlKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///239\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Int16', 2, function (init) {\n  return function Int16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQuaW50MTYtYXJyYXkuanM/MTVhYyJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuL190eXBlZC1hcnJheScpKCdJbnQxNicsIDIsIGZ1bmN0aW9uIChpbml0KSB7XG4gIHJldHVybiBmdW5jdGlvbiBJbnQxNkFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///240\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Uint16', 2, function (init) {\n  return function Uint16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQudWludDE2LWFycmF5LmpzP2FmNTYiXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi9fdHlwZWQtYXJyYXknKSgnVWludDE2JywgMiwgZnVuY3Rpb24gKGluaXQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIFVpbnQxNkFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///241\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Int32', 4, function (init) {\n  return function Int32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQuaW50MzItYXJyYXkuanM/YjZlNCJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuL190eXBlZC1hcnJheScpKCdJbnQzMicsIDQsIGZ1bmN0aW9uIChpbml0KSB7XG4gIHJldHVybiBmdW5jdGlvbiBJbnQzMkFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///242\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Uint32', 4, function (init) {\n  return function Uint32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQudWludDMyLWFycmF5LmpzPzljMjkiXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi9fdHlwZWQtYXJyYXknKSgnVWludDMyJywgNCwgZnVuY3Rpb24gKGluaXQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIFVpbnQzMkFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///243\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Float32', 4, function (init) {\n  return function Float32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQuZmxvYXQzMi1hcnJheS5qcz82M2Q5Il0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4vX3R5cGVkLWFycmF5JykoJ0Zsb2F0MzInLCA0LCBmdW5jdGlvbiAoaW5pdCkge1xuICByZXR1cm4gZnVuY3Rpb24gRmxvYXQzMkFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///244\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(26)('Float64', 8, function (init) {\n  return function Float64Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYudHlwZWQuZmxvYXQ2NC1hcnJheS5qcz80ZGRhIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4vX3R5cGVkLWFycmF5JykoJ0Zsb2F0NjQnLCA4LCBmdW5jdGlvbiAoaW5pdCkge1xuICByZXR1cm4gZnVuY3Rpb24gRmxvYXQ2NEFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7XG4gIH07XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///245\n")},function(module,exports,__webpack_require__){eval("// 26.1.1 Reflect.apply(target, thisArgument, argumentsList)\nvar $export = __webpack_require__(1);\nvar aFunction = __webpack_require__(22);\nvar anObject = __webpack_require__(5);\nvar rApply = (__webpack_require__(3).Reflect || {}).apply;\nvar fApply = Function.apply;\n// MS Edge argumentsList argument is optional\n$export($export.S + $export.F * !__webpack_require__(2)(function () {\n  rApply(function () { /* empty */ });\n}), 'Reflect', {\n  apply: function apply(target, thisArgument, argumentsList) {\n    var T = aFunction(target);\n    var L = anObject(argumentsList);\n    return rApply ? rApply(T, thisArgument, L) : fApply.call(T, thisArgument, L);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5hcHBseS5qcz9kZjFiIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDI2LjEuMSBSZWZsZWN0LmFwcGx5KHRhcmdldCwgdGhpc0FyZ3VtZW50LCBhcmd1bWVudHNMaXN0KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciByQXBwbHkgPSAocmVxdWlyZSgnLi9fZ2xvYmFsJykuUmVmbGVjdCB8fCB7fSkuYXBwbHk7XG52YXIgZkFwcGx5ID0gRnVuY3Rpb24uYXBwbHk7XG4vLyBNUyBFZGdlIGFyZ3VtZW50c0xpc3QgYXJndW1lbnQgaXMgb3B0aW9uYWxcbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByQXBwbHkoZnVuY3Rpb24gKCkgeyAvKiBlbXB0eSAqLyB9KTtcbn0pLCAnUmVmbGVjdCcsIHtcbiAgYXBwbHk6IGZ1bmN0aW9uIGFwcGx5KHRhcmdldCwgdGhpc0FyZ3VtZW50LCBhcmd1bWVudHNMaXN0KSB7XG4gICAgdmFyIFQgPSBhRnVuY3Rpb24odGFyZ2V0KTtcbiAgICB2YXIgTCA9IGFuT2JqZWN0KGFyZ3VtZW50c0xpc3QpO1xuICAgIHJldHVybiByQXBwbHkgPyByQXBwbHkoVCwgdGhpc0FyZ3VtZW50LCBMKSA6IGZBcHBseS5jYWxsKFQsIHRoaXNBcmd1bWVudCwgTCk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///246\n")},function(module,exports,__webpack_require__){eval("// 26.1.2 Reflect.construct(target, argumentsList [, newTarget])\nvar $export = __webpack_require__(1);\nvar create = __webpack_require__(34);\nvar aFunction = __webpack_require__(22);\nvar anObject = __webpack_require__(5);\nvar isObject = __webpack_require__(4);\nvar fails = __webpack_require__(2);\nvar bind = __webpack_require__(90);\nvar rConstruct = (__webpack_require__(3).Reflect || {}).construct;\n\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(rConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\nvar ARGS_BUG = !fails(function () {\n  rConstruct(function () { /* empty */ });\n});\n\n$export($export.S + $export.F * (NEW_TARGET_BUG || ARGS_BUG), 'Reflect', {\n  construct: function construct(Target, args /* , newTarget */) {\n    aFunction(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return rConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      $args.push.apply($args, args);\n      return new (bind.apply(Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : Object.prototype);\n    var result = Function.apply.call(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5jb25zdHJ1Y3QuanM/MjM5NyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyNi4xLjIgUmVmbGVjdC5jb25zdHJ1Y3QodGFyZ2V0LCBhcmd1bWVudHNMaXN0IFssIG5ld1RhcmdldF0pXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGNyZWF0ZSA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKTtcbnZhciBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIGZhaWxzID0gcmVxdWlyZSgnLi9fZmFpbHMnKTtcbnZhciBiaW5kID0gcmVxdWlyZSgnLi9fYmluZCcpO1xudmFyIHJDb25zdHJ1Y3QgPSAocmVxdWlyZSgnLi9fZ2xvYmFsJykuUmVmbGVjdCB8fCB7fSkuY29uc3RydWN0O1xuXG4vLyBNUyBFZGdlIHN1cHBvcnRzIG9ubHkgMiBhcmd1bWVudHMgYW5kIGFyZ3VtZW50c0xpc3QgYXJndW1lbnQgaXMgb3B0aW9uYWxcbi8vIEZGIE5pZ2h0bHkgc2V0cyB0aGlyZCBhcmd1bWVudCBhcyBgbmV3LnRhcmdldGAsIGJ1dCBkb2VzIG5vdCBjcmVhdGUgYHRoaXNgIGZyb20gaXRcbnZhciBORVdfVEFSR0VUX0JVRyA9IGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRigpIHsgLyogZW1wdHkgKi8gfVxuICByZXR1cm4gIShyQ29uc3RydWN0KGZ1bmN0aW9uICgpIHsgLyogZW1wdHkgKi8gfSwgW10sIEYpIGluc3RhbmNlb2YgRik7XG59KTtcbnZhciBBUkdTX0JVRyA9ICFmYWlscyhmdW5jdGlvbiAoKSB7XG4gIHJDb25zdHJ1Y3QoZnVuY3Rpb24gKCkgeyAvKiBlbXB0eSAqLyB9KTtcbn0pO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIChORVdfVEFSR0VUX0JVRyB8fCBBUkdTX0JVRyksICdSZWZsZWN0Jywge1xuICBjb25zdHJ1Y3Q6IGZ1bmN0aW9uIGNvbnN0cnVjdChUYXJnZXQsIGFyZ3MgLyogLCBuZXdUYXJnZXQgKi8pIHtcbiAgICBhRnVuY3Rpb24oVGFyZ2V0KTtcbiAgICBhbk9iamVjdChhcmdzKTtcbiAgICB2YXIgbmV3VGFyZ2V0ID0gYXJndW1lbnRzLmxlbmd0aCA8IDMgPyBUYXJnZXQgOiBhRnVuY3Rpb24oYXJndW1lbnRzWzJdKTtcbiAgICBpZiAoQVJHU19CVUcgJiYgIU5FV19UQVJHRVRfQlVHKSByZXR1cm4gckNvbnN0cnVjdChUYXJnZXQsIGFyZ3MsIG5ld1RhcmdldCk7XG4gICAgaWYgKFRhcmdldCA9PSBuZXdUYXJnZXQpIHtcbiAgICAgIC8vIHcvbyBhbHRlcmVkIG5ld1RhcmdldCwgb3B0aW1pemF0aW9uIGZvciAwLTQgYXJndW1lbnRzXG4gICAgICBzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDogcmV0dXJuIG5ldyBUYXJnZXQoKTtcbiAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IFRhcmdldChhcmdzWzBdKTtcbiAgICAgICAgY2FzZSAyOiByZXR1cm4gbmV3IFRhcmdldChhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICAgICAgY2FzZSAzOiByZXR1cm4gbmV3IFRhcmdldChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICAgICAgY2FzZSA0OiByZXR1cm4gbmV3IFRhcmdldChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTtcbiAgICAgIH1cbiAgICAgIC8vIHcvbyBhbHRlcmVkIG5ld1RhcmdldCwgbG90IG9mIGFyZ3VtZW50cyBjYXNlXG4gICAgICB2YXIgJGFyZ3MgPSBbbnVsbF07XG4gICAgICAkYXJncy5wdXNoLmFwcGx5KCRhcmdzLCBhcmdzKTtcbiAgICAgIHJldHVybiBuZXcgKGJpbmQuYXBwbHkoVGFyZ2V0LCAkYXJncykpKCk7XG4gICAgfVxuICAgIC8vIHdpdGggYWx0ZXJlZCBuZXdUYXJnZXQsIG5vdCBzdXBwb3J0IGJ1aWx0LWluIGNvbnN0cnVjdG9yc1xuICAgIHZhciBwcm90byA9IG5ld1RhcmdldC5wcm90b3R5cGU7XG4gICAgdmFyIGluc3RhbmNlID0gY3JlYXRlKGlzT2JqZWN0KHByb3RvKSA/IHByb3RvIDogT2JqZWN0LnByb3RvdHlwZSk7XG4gICAgdmFyIHJlc3VsdCA9IEZ1bmN0aW9uLmFwcGx5LmNhbGwoVGFyZ2V0LCBpbnN0YW5jZSwgYXJncyk7XG4gICAgcmV0dXJuIGlzT2JqZWN0KHJlc3VsdCkgPyByZXN1bHQgOiBpbnN0YW5jZTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///247\n")},function(module,exports,__webpack_require__){eval("// 26.1.3 Reflect.defineProperty(target, propertyKey, attributes)\nvar dP = __webpack_require__(7);\nvar $export = __webpack_require__(1);\nvar anObject = __webpack_require__(5);\nvar toPrimitive = __webpack_require__(27);\n\n// MS Edge has broken Reflect.defineProperty - throwing instead of returning false\n$export($export.S + $export.F * __webpack_require__(2)(function () {\n  // eslint-disable-next-line no-undef\n  Reflect.defineProperty(dP.f({}, 1, { value: 1 }), 1, { value: 2 });\n}), 'Reflect', {\n  defineProperty: function defineProperty(target, propertyKey, attributes) {\n    anObject(target);\n    propertyKey = toPrimitive(propertyKey, true);\n    anObject(attributes);\n    try {\n      dP.f(target, propertyKey, attributes);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5kZWZpbmUtcHJvcGVydHkuanM/ODhjYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyNi4xLjMgUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5S2V5LCBhdHRyaWJ1dGVzKVxudmFyIGRQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgdG9QcmltaXRpdmUgPSByZXF1aXJlKCcuL190by1wcmltaXRpdmUnKTtcblxuLy8gTVMgRWRnZSBoYXMgYnJva2VuIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkgLSB0aHJvd2luZyBpbnN0ZWFkIG9mIHJldHVybmluZyBmYWxzZVxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiByZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uICgpIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkoZFAuZih7fSwgMSwgeyB2YWx1ZTogMSB9KSwgMSwgeyB2YWx1ZTogMiB9KTtcbn0pLCAnUmVmbGVjdCcsIHtcbiAgZGVmaW5lUHJvcGVydHk6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHlLZXksIGF0dHJpYnV0ZXMpIHtcbiAgICBhbk9iamVjdCh0YXJnZXQpO1xuICAgIHByb3BlcnR5S2V5ID0gdG9QcmltaXRpdmUocHJvcGVydHlLZXksIHRydWUpO1xuICAgIGFuT2JqZWN0KGF0dHJpYnV0ZXMpO1xuICAgIHRyeSB7XG4gICAgICBkUC5mKHRhcmdldCwgcHJvcGVydHlLZXksIGF0dHJpYnV0ZXMpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///248\n")},function(module,exports,__webpack_require__){eval("// 26.1.4 Reflect.deleteProperty(target, propertyKey)\nvar $export = __webpack_require__(1);\nvar gOPD = __webpack_require__(18).f;\nvar anObject = __webpack_require__(5);\n\n$export($export.S, 'Reflect', {\n  deleteProperty: function deleteProperty(target, propertyKey) {\n    var desc = gOPD(anObject(target), propertyKey);\n    return desc && !desc.configurable ? false : delete target[propertyKey];\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5kZWxldGUtcHJvcGVydHkuanM/YmExNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyNi4xLjQgUmVmbGVjdC5kZWxldGVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5S2V5KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBnT1BEID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKS5mO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHtcbiAgZGVsZXRlUHJvcGVydHk6IGZ1bmN0aW9uIGRlbGV0ZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHlLZXkpIHtcbiAgICB2YXIgZGVzYyA9IGdPUEQoYW5PYmplY3QodGFyZ2V0KSwgcHJvcGVydHlLZXkpO1xuICAgIHJldHVybiBkZXNjICYmICFkZXNjLmNvbmZpZ3VyYWJsZSA/IGZhbHNlIDogZGVsZXRlIHRhcmdldFtwcm9wZXJ0eUtleV07XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///249\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// 26.1.5 Reflect.enumerate(target)\nvar $export = __webpack_require__(1);\nvar anObject = __webpack_require__(5);\nvar Enumerate = function (iterated) {\n  this._t = anObject(iterated); // target\n  this._i = 0;                  // next index\n  var keys = this._k = [];      // keys\n  var key;\n  for (key in iterated) keys.push(key);\n};\n__webpack_require__(98)(Enumerate, 'Object', function () {\n  var that = this;\n  var keys = that._k;\n  var key;\n  do {\n    if (that._i >= keys.length) return { value: undefined, done: true };\n  } while (!((key = keys[that._i++]) in that._t));\n  return { value: key, done: false };\n});\n\n$export($export.S, 'Reflect', {\n  enumerate: function enumerate(target) {\n    return new Enumerate(target);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5lbnVtZXJhdGUuanM/N2ZmNiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyAyNi4xLjUgUmVmbGVjdC5lbnVtZXJhdGUodGFyZ2V0KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xudmFyIEVudW1lcmF0ZSA9IGZ1bmN0aW9uIChpdGVyYXRlZCkge1xuICB0aGlzLl90ID0gYW5PYmplY3QoaXRlcmF0ZWQpOyAvLyB0YXJnZXRcbiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleFxuICB2YXIga2V5cyA9IHRoaXMuX2sgPSBbXTsgICAgICAvLyBrZXlzXG4gIHZhciBrZXk7XG4gIGZvciAoa2V5IGluIGl0ZXJhdGVkKSBrZXlzLnB1c2goa2V5KTtcbn07XG5yZXF1aXJlKCcuL19pdGVyLWNyZWF0ZScpKEVudW1lcmF0ZSwgJ09iamVjdCcsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB2YXIga2V5cyA9IHRoYXQuX2s7XG4gIHZhciBrZXk7XG4gIGRvIHtcbiAgICBpZiAodGhhdC5faSA+PSBrZXlzLmxlbmd0aCkgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICB9IHdoaWxlICghKChrZXkgPSBrZXlzW3RoYXQuX2krK10pIGluIHRoYXQuX3QpKTtcbiAgcmV0dXJuIHsgdmFsdWU6IGtleSwgZG9uZTogZmFsc2UgfTtcbn0pO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCB7XG4gIGVudW1lcmF0ZTogZnVuY3Rpb24gZW51bWVyYXRlKHRhcmdldCkge1xuICAgIHJldHVybiBuZXcgRW51bWVyYXRlKHRhcmdldCk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///250\n")},function(module,exports,__webpack_require__){eval("// 26.1.6 Reflect.get(target, propertyKey [, receiver])\nvar gOPD = __webpack_require__(18);\nvar getPrototypeOf = __webpack_require__(36);\nvar has = __webpack_require__(13);\nvar $export = __webpack_require__(1);\nvar isObject = __webpack_require__(4);\nvar anObject = __webpack_require__(5);\n\nfunction get(target, propertyKey /* , receiver */) {\n  var receiver = arguments.length < 3 ? target : arguments[2];\n  var desc, proto;\n  if (anObject(target) === receiver) return target[propertyKey];\n  if (desc = gOPD.f(target, propertyKey)) return has(desc, 'value')\n    ? desc.value\n    : desc.get !== undefined\n      ? desc.get.call(receiver)\n      : undefined;\n  if (isObject(proto = getPrototypeOf(target))) return get(proto, propertyKey, receiver);\n}\n\n$export($export.S, 'Reflect', { get: get });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5nZXQuanM/ZDE4NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyNi4xLjYgUmVmbGVjdC5nZXQodGFyZ2V0LCBwcm9wZXJ0eUtleSBbLCByZWNlaXZlcl0pXG52YXIgZ09QRCA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJyk7XG52YXIgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJyk7XG52YXIgaGFzID0gcmVxdWlyZSgnLi9faGFzJyk7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcblxuZnVuY3Rpb24gZ2V0KHRhcmdldCwgcHJvcGVydHlLZXkgLyogLCByZWNlaXZlciAqLykge1xuICB2YXIgcmVjZWl2ZXIgPSBhcmd1bWVudHMubGVuZ3RoIDwgMyA/IHRhcmdldCA6IGFyZ3VtZW50c1syXTtcbiAgdmFyIGRlc2MsIHByb3RvO1xuICBpZiAoYW5PYmplY3QodGFyZ2V0KSA9PT0gcmVjZWl2ZXIpIHJldHVybiB0YXJnZXRbcHJvcGVydHlLZXldO1xuICBpZiAoZGVzYyA9IGdPUEQuZih0YXJnZXQsIHByb3BlcnR5S2V5KSkgcmV0dXJuIGhhcyhkZXNjLCAndmFsdWUnKVxuICAgID8gZGVzYy52YWx1ZVxuICAgIDogZGVzYy5nZXQgIT09IHVuZGVmaW5lZFxuICAgICAgPyBkZXNjLmdldC5jYWxsKHJlY2VpdmVyKVxuICAgICAgOiB1bmRlZmluZWQ7XG4gIGlmIChpc09iamVjdChwcm90byA9IGdldFByb3RvdHlwZU9mKHRhcmdldCkpKSByZXR1cm4gZ2V0KHByb3RvLCBwcm9wZXJ0eUtleSwgcmVjZWl2ZXIpO1xufVxuXG4kZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCB7IGdldDogZ2V0IH0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///251\n")},function(module,exports,__webpack_require__){eval("// 26.1.7 Reflect.getOwnPropertyDescriptor(target, propertyKey)\nvar gOPD = __webpack_require__(18);\nvar $export = __webpack_require__(1);\nvar anObject = __webpack_require__(5);\n\n$export($export.S, 'Reflect', {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(target, propertyKey) {\n    return gOPD.f(anObject(target), propertyKey);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanM/ZWJkZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyNi4xLjcgUmVmbGVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBwcm9wZXJ0eUtleSlcbnZhciBnT1BEID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKTtcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdSZWZsZWN0Jywge1xuICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIHByb3BlcnR5S2V5KSB7XG4gICAgcmV0dXJuIGdPUEQuZihhbk9iamVjdCh0YXJnZXQpLCBwcm9wZXJ0eUtleSk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///252\n")},function(module,exports,__webpack_require__){eval("// 26.1.8 Reflect.getPrototypeOf(target)\nvar $export = __webpack_require__(1);\nvar getProto = __webpack_require__(36);\nvar anObject = __webpack_require__(5);\n\n$export($export.S, 'Reflect', {\n  getPrototypeOf: function getPrototypeOf(target) {\n    return getProto(anObject(target));\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5nZXQtcHJvdG90eXBlLW9mLmpzPzJkMzQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjYuMS44IFJlZmxlY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBnZXRQcm90byA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKTtcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCB7XG4gIGdldFByb3RvdHlwZU9mOiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZih0YXJnZXQpIHtcbiAgICByZXR1cm4gZ2V0UHJvdG8oYW5PYmplY3QodGFyZ2V0KSk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///253\n")},function(module,exports,__webpack_require__){eval("// 26.1.9 Reflect.has(target, propertyKey)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Reflect', {\n  has: function has(target, propertyKey) {\n    return propertyKey in target;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5oYXMuanM/ZjZiMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyNi4xLjkgUmVmbGVjdC5oYXModGFyZ2V0LCBwcm9wZXJ0eUtleSlcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHtcbiAgaGFzOiBmdW5jdGlvbiBoYXModGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xuICAgIHJldHVybiBwcm9wZXJ0eUtleSBpbiB0YXJnZXQ7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///254\n")},function(module,exports,__webpack_require__){eval("// 26.1.10 Reflect.isExtensible(target)\nvar $export = __webpack_require__(1);\nvar anObject = __webpack_require__(5);\nvar $isExtensible = Object.isExtensible;\n\n$export($export.S, 'Reflect', {\n  isExtensible: function isExtensible(target) {\n    anObject(target);\n    return $isExtensible ? $isExtensible(target) : true;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5pcy1leHRlbnNpYmxlLmpzPzIyNTEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjYuMS4xMCBSZWZsZWN0LmlzRXh0ZW5zaWJsZSh0YXJnZXQpXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgJGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGU7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHtcbiAgaXNFeHRlbnNpYmxlOiBmdW5jdGlvbiBpc0V4dGVuc2libGUodGFyZ2V0KSB7XG4gICAgYW5PYmplY3QodGFyZ2V0KTtcbiAgICByZXR1cm4gJGlzRXh0ZW5zaWJsZSA/ICRpc0V4dGVuc2libGUodGFyZ2V0KSA6IHRydWU7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///255\n")},function(module,exports,__webpack_require__){eval("// 26.1.11 Reflect.ownKeys(target)\nvar $export = __webpack_require__(1);\n\n$export($export.S, 'Reflect', { ownKeys: __webpack_require__(110) });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5vd24ta2V5cy5qcz9jNjk4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDI2LjEuMTEgUmVmbGVjdC5vd25LZXlzKHRhcmdldClcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHsgb3duS2V5czogcmVxdWlyZSgnLi9fb3duLWtleXMnKSB9KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///256\n")},function(module,exports,__webpack_require__){eval("// 26.1.12 Reflect.preventExtensions(target)\nvar $export = __webpack_require__(1);\nvar anObject = __webpack_require__(5);\nvar $preventExtensions = Object.preventExtensions;\n\n$export($export.S, 'Reflect', {\n  preventExtensions: function preventExtensions(target) {\n    anObject(target);\n    try {\n      if ($preventExtensions) $preventExtensions(target);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5wcmV2ZW50LWV4dGVuc2lvbnMuanM/YTE5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyNi4xLjEyIFJlZmxlY3QucHJldmVudEV4dGVuc2lvbnModGFyZ2V0KVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xudmFyICRwcmV2ZW50RXh0ZW5zaW9ucyA9IE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucztcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdSZWZsZWN0Jywge1xuICBwcmV2ZW50RXh0ZW5zaW9uczogZnVuY3Rpb24gcHJldmVudEV4dGVuc2lvbnModGFyZ2V0KSB7XG4gICAgYW5PYmplY3QodGFyZ2V0KTtcbiAgICB0cnkge1xuICAgICAgaWYgKCRwcmV2ZW50RXh0ZW5zaW9ucykgJHByZXZlbnRFeHRlbnNpb25zKHRhcmdldCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///257\n")},function(module,exports,__webpack_require__){eval("// 26.1.13 Reflect.set(target, propertyKey, V [, receiver])\nvar dP = __webpack_require__(7);\nvar gOPD = __webpack_require__(18);\nvar getPrototypeOf = __webpack_require__(36);\nvar has = __webpack_require__(13);\nvar $export = __webpack_require__(1);\nvar createDesc = __webpack_require__(29);\nvar anObject = __webpack_require__(5);\nvar isObject = __webpack_require__(4);\n\nfunction set(target, propertyKey, V /* , receiver */) {\n  var receiver = arguments.length < 4 ? target : arguments[3];\n  var ownDesc = gOPD.f(anObject(target), propertyKey);\n  var existingDescriptor, proto;\n  if (!ownDesc) {\n    if (isObject(proto = getPrototypeOf(target))) {\n      return set(proto, propertyKey, V, receiver);\n    }\n    ownDesc = createDesc(0);\n  }\n  if (has(ownDesc, 'value')) {\n    if (ownDesc.writable === false || !isObject(receiver)) return false;\n    if (existingDescriptor = gOPD.f(receiver, propertyKey)) {\n      if (existingDescriptor.get || existingDescriptor.set || existingDescriptor.writable === false) return false;\n      existingDescriptor.value = V;\n      dP.f(receiver, propertyKey, existingDescriptor);\n    } else dP.f(receiver, propertyKey, createDesc(0, V));\n    return true;\n  }\n  return ownDesc.set === undefined ? false : (ownDesc.set.call(receiver, V), true);\n}\n\n$export($export.S, 'Reflect', { set: set });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5zZXQuanM/OTI1MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAyNi4xLjEzIFJlZmxlY3Quc2V0KHRhcmdldCwgcHJvcGVydHlLZXksIFYgWywgcmVjZWl2ZXJdKVxudmFyIGRQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgZ09QRCA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJyk7XG52YXIgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJyk7XG52YXIgaGFzID0gcmVxdWlyZSgnLi9faGFzJyk7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGNyZWF0ZURlc2MgPSByZXF1aXJlKCcuL19wcm9wZXJ0eS1kZXNjJyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xuXG5mdW5jdGlvbiBzZXQodGFyZ2V0LCBwcm9wZXJ0eUtleSwgViAvKiAsIHJlY2VpdmVyICovKSB7XG4gIHZhciByZWNlaXZlciA9IGFyZ3VtZW50cy5sZW5ndGggPCA0ID8gdGFyZ2V0IDogYXJndW1lbnRzWzNdO1xuICB2YXIgb3duRGVzYyA9IGdPUEQuZihhbk9iamVjdCh0YXJnZXQpLCBwcm9wZXJ0eUtleSk7XG4gIHZhciBleGlzdGluZ0Rlc2NyaXB0b3IsIHByb3RvO1xuICBpZiAoIW93bkRlc2MpIHtcbiAgICBpZiAoaXNPYmplY3QocHJvdG8gPSBnZXRQcm90b3R5cGVPZih0YXJnZXQpKSkge1xuICAgICAgcmV0dXJuIHNldChwcm90bywgcHJvcGVydHlLZXksIFYsIHJlY2VpdmVyKTtcbiAgICB9XG4gICAgb3duRGVzYyA9IGNyZWF0ZURlc2MoMCk7XG4gIH1cbiAgaWYgKGhhcyhvd25EZXNjLCAndmFsdWUnKSkge1xuICAgIGlmIChvd25EZXNjLndyaXRhYmxlID09PSBmYWxzZSB8fCAhaXNPYmplY3QocmVjZWl2ZXIpKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGV4aXN0aW5nRGVzY3JpcHRvciA9IGdPUEQuZihyZWNlaXZlciwgcHJvcGVydHlLZXkpKSB7XG4gICAgICBpZiAoZXhpc3RpbmdEZXNjcmlwdG9yLmdldCB8fCBleGlzdGluZ0Rlc2NyaXB0b3Iuc2V0IHx8IGV4aXN0aW5nRGVzY3JpcHRvci53cml0YWJsZSA9PT0gZmFsc2UpIHJldHVybiBmYWxzZTtcbiAgICAgIGV4aXN0aW5nRGVzY3JpcHRvci52YWx1ZSA9IFY7XG4gICAgICBkUC5mKHJlY2VpdmVyLCBwcm9wZXJ0eUtleSwgZXhpc3RpbmdEZXNjcmlwdG9yKTtcbiAgICB9IGVsc2UgZFAuZihyZWNlaXZlciwgcHJvcGVydHlLZXksIGNyZWF0ZURlc2MoMCwgVikpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBvd25EZXNjLnNldCA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiAob3duRGVzYy5zZXQuY2FsbChyZWNlaXZlciwgViksIHRydWUpO1xufVxuXG4kZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCB7IHNldDogc2V0IH0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///258\n")},function(module,exports,__webpack_require__){eval("// 26.1.14 Reflect.setPrototypeOf(target, proto)\nvar $export = __webpack_require__(1);\nvar setProto = __webpack_require__(64);\n\nif (setProto) $export($export.S, 'Reflect', {\n  setPrototypeOf: function setPrototypeOf(target, proto) {\n    setProto.check(target, proto);\n    try {\n      setProto.set(target, proto);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5zZXQtcHJvdG90eXBlLW9mLmpzPzkyNzUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMjYuMS4xNCBSZWZsZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG8pXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIHNldFByb3RvID0gcmVxdWlyZSgnLi9fc2V0LXByb3RvJyk7XG5cbmlmIChzZXRQcm90bykgJGV4cG9ydCgkZXhwb3J0LlMsICdSZWZsZWN0Jywge1xuICBzZXRQcm90b3R5cGVPZjogZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YodGFyZ2V0LCBwcm90bykge1xuICAgIHNldFByb3RvLmNoZWNrKHRhcmdldCwgcHJvdG8pO1xuICAgIHRyeSB7XG4gICAgICBzZXRQcm90by5zZXQodGFyZ2V0LCBwcm90byk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///259\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(261);\nmodule.exports = __webpack_require__(9).Array.includes;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZm4vYXJyYXkvaW5jbHVkZXMuanM/MTQzYSJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNy5hcnJheS5pbmNsdWRlcycpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuQXJyYXkuaW5jbHVkZXM7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///260\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// https://github.com/tc39/Array.prototype.includes\nvar $export = __webpack_require__(1);\nvar $includes = __webpack_require__(46)(true);\n\n$export($export.P, 'Array', {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n__webpack_require__(39)('includes');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcuYXJyYXkuaW5jbHVkZXMuanM/Njc2MiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9BcnJheS5wcm90b3R5cGUuaW5jbHVkZXNcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgJGluY2x1ZGVzID0gcmVxdWlyZSgnLi9fYXJyYXktaW5jbHVkZXMnKSh0cnVlKTtcblxuJGV4cG9ydCgkZXhwb3J0LlAsICdBcnJheScsIHtcbiAgaW5jbHVkZXM6IGZ1bmN0aW9uIGluY2x1ZGVzKGVsIC8qICwgZnJvbUluZGV4ID0gMCAqLykge1xuICAgIHJldHVybiAkaW5jbHVkZXModGhpcywgZWwsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTtcbiAgfVxufSk7XG5cbnJlcXVpcmUoJy4vX2FkZC10by11bnNjb3BhYmxlcycpKCdpbmNsdWRlcycpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///261\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(263);\nmodule.exports = __webpack_require__(9).String.padStart;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZm4vc3RyaW5nL3BhZC1zdGFydC5qcz9jMThjIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM3LnN0cmluZy5wYWQtc3RhcnQnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9fY29yZScpLlN0cmluZy5wYWRTdGFydDtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///262\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// https://github.com/tc39/proposal-string-pad-start-end\nvar $export = __webpack_require__(1);\nvar $pad = __webpack_require__(111);\nvar userAgent = __webpack_require__(54);\n\n// https://github.com/zloirock/core-js/issues/280\n$export($export.P + $export.F * /Version\\/10\\.\\d+(\\.\\d+)? Safari\\//.test(userAgent), 'String', {\n  padStart: function padStart(maxLength /* , fillString = ' ' */) {\n    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, true);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcuc3RyaW5nLnBhZC1zdGFydC5qcz9mNTc2Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0Jztcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLXN0cmluZy1wYWQtc3RhcnQtZW5kXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyICRwYWQgPSByZXF1aXJlKCcuL19zdHJpbmctcGFkJyk7XG52YXIgdXNlckFnZW50ID0gcmVxdWlyZSgnLi9fdXNlci1hZ2VudCcpO1xuXG4vLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvMjgwXG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIC9WZXJzaW9uXFwvMTBcXC5cXGQrKFxcLlxcZCspPyBTYWZhcmlcXC8vLnRlc3QodXNlckFnZW50KSwgJ1N0cmluZycsIHtcbiAgcGFkU3RhcnQ6IGZ1bmN0aW9uIHBhZFN0YXJ0KG1heExlbmd0aCAvKiAsIGZpbGxTdHJpbmcgPSAnICcgKi8pIHtcbiAgICByZXR1cm4gJHBhZCh0aGlzLCBtYXhMZW5ndGgsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkLCB0cnVlKTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///263\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(265);\nmodule.exports = __webpack_require__(9).String.padEnd;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZm4vc3RyaW5nL3BhZC1lbmQuanM/NDBkYyJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNy5zdHJpbmcucGFkLWVuZCcpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuU3RyaW5nLnBhZEVuZDtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///264\n")},function(module,exports,__webpack_require__){"use strict";eval("\n// https://github.com/tc39/proposal-string-pad-start-end\nvar $export = __webpack_require__(1);\nvar $pad = __webpack_require__(111);\nvar userAgent = __webpack_require__(54);\n\n// https://github.com/zloirock/core-js/issues/280\n$export($export.P + $export.F * /Version\\/10\\.\\d+(\\.\\d+)? Safari\\//.test(userAgent), 'String', {\n  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {\n    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, false);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcuc3RyaW5nLnBhZC1lbmQuanM/ZWQ1MCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1zdHJpbmctcGFkLXN0YXJ0LWVuZFxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkcGFkID0gcmVxdWlyZSgnLi9fc3RyaW5nLXBhZCcpO1xudmFyIHVzZXJBZ2VudCA9IHJlcXVpcmUoJy4vX3VzZXItYWdlbnQnKTtcblxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzI4MFxuJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAvVmVyc2lvblxcLzEwXFwuXFxkKyhcXC5cXGQrKT8gU2FmYXJpXFwvLy50ZXN0KHVzZXJBZ2VudCksICdTdHJpbmcnLCB7XG4gIHBhZEVuZDogZnVuY3Rpb24gcGFkRW5kKG1heExlbmd0aCAvKiAsIGZpbGxTdHJpbmcgPSAnICcgKi8pIHtcbiAgICByZXR1cm4gJHBhZCh0aGlzLCBtYXhMZW5ndGgsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkLCBmYWxzZSk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///265\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(267);\nmodule.exports = __webpack_require__(59).f('asyncIterator');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZm4vc3ltYm9sL2FzeW5jLWl0ZXJhdG9yLmpzP2MwM2MiXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczcuc3ltYm9sLmFzeW5jLWl0ZXJhdG9yJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX3drcy1leHQnKS5mKCdhc3luY0l0ZXJhdG9yJyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///266\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(85)('asyncIterator');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcuc3ltYm9sLmFzeW5jLWl0ZXJhdG9yLmpzP2FjNGQiXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi9fd2tzLWRlZmluZScpKCdhc3luY0l0ZXJhdG9yJyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///267\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(269);\nmodule.exports = __webpack_require__(9).Object.getOwnPropertyDescriptors;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMuanM/Zjk3OSJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycycpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///268\n")},function(module,exports,__webpack_require__){eval("// https://github.com/tc39/proposal-object-getownpropertydescriptors\nvar $export = __webpack_require__(1);\nvar ownKeys = __webpack_require__(110);\nvar toIObject = __webpack_require__(15);\nvar gOPD = __webpack_require__(18);\nvar createProperty = __webpack_require__(75);\n\n$export($export.S, 'Object', {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIObject(object);\n    var getDesc = gOPD.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var i = 0;\n    var key, desc;\n    while (keys.length > i) {\n      desc = getDesc(O, key = keys[i++]);\n      if (desc !== undefined) createProperty(result, key, desc);\n    }\n    return result;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMuanM/OGU2ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1vYmplY3QtZ2V0b3ducHJvcGVydHlkZXNjcmlwdG9yc1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBvd25LZXlzID0gcmVxdWlyZSgnLi9fb3duLWtleXMnKTtcbnZhciB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0Jyk7XG52YXIgZ09QRCA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJyk7XG52YXIgY3JlYXRlUHJvcGVydHkgPSByZXF1aXJlKCcuL19jcmVhdGUtcHJvcGVydHknKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7XG4gIGdldE93blByb3BlcnR5RGVzY3JpcHRvcnM6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcnMob2JqZWN0KSB7XG4gICAgdmFyIE8gPSB0b0lPYmplY3Qob2JqZWN0KTtcbiAgICB2YXIgZ2V0RGVzYyA9IGdPUEQuZjtcbiAgICB2YXIga2V5cyA9IG93bktleXMoTyk7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIga2V5LCBkZXNjO1xuICAgIHdoaWxlIChrZXlzLmxlbmd0aCA+IGkpIHtcbiAgICAgIGRlc2MgPSBnZXREZXNjKE8sIGtleSA9IGtleXNbaSsrXSk7XG4gICAgICBpZiAoZGVzYyAhPT0gdW5kZWZpbmVkKSBjcmVhdGVQcm9wZXJ0eShyZXN1bHQsIGtleSwgZGVzYyk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///269\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(271);\nmodule.exports = __webpack_require__(9).Object.values;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZm4vb2JqZWN0L3ZhbHVlcy5qcz9jYzUxIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM3Lm9iamVjdC52YWx1ZXMnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9fY29yZScpLk9iamVjdC52YWx1ZXM7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///270\n")},function(module,exports,__webpack_require__){eval("// https://github.com/tc39/proposal-object-values-entries\nvar $export = __webpack_require__(1);\nvar $values = __webpack_require__(112)(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcub2JqZWN0LnZhbHVlcy5qcz84NjE1Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLW9iamVjdC12YWx1ZXMtZW50cmllc1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkdmFsdWVzID0gcmVxdWlyZSgnLi9fb2JqZWN0LXRvLWFycmF5JykoZmFsc2UpO1xuXG4kZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtcbiAgdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoaXQpIHtcbiAgICByZXR1cm4gJHZhbHVlcyhpdCk7XG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///271\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(273);\nmodule.exports = __webpack_require__(9).Object.entries;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZm4vb2JqZWN0L2VudHJpZXMuanM/MjViNCJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNy5vYmplY3QuZW50cmllcycpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuT2JqZWN0LmVudHJpZXM7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///272\n")},function(module,exports,__webpack_require__){eval("// https://github.com/tc39/proposal-object-values-entries\nvar $export = __webpack_require__(1);\nvar $entries = __webpack_require__(112)(true);\n\n$export($export.S, 'Object', {\n  entries: function entries(it) {\n    return $entries(it);\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjczLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcub2JqZWN0LmVudHJpZXMuanM/ZmZjMSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1vYmplY3QtdmFsdWVzLWVudHJpZXNcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgJGVudHJpZXMgPSByZXF1aXJlKCcuL19vYmplY3QtdG8tYXJyYXknKSh0cnVlKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7XG4gIGVudHJpZXM6IGZ1bmN0aW9uIGVudHJpZXMoaXQpIHtcbiAgICByZXR1cm4gJGVudHJpZXMoaXQpO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///273\n")},function(module,exports,__webpack_require__){"use strict";eval("\n__webpack_require__(104);\n__webpack_require__(275);\nmodule.exports = __webpack_require__(9).Promise['finally'];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvZm4vcHJvbWlzZS9maW5hbGx5LmpzPzRjOGEiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xucmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYucHJvbWlzZScpO1xucmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczcucHJvbWlzZS5maW5hbGx5Jyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5Qcm9taXNlWydmaW5hbGx5J107XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///274\n")},function(module,exports,__webpack_require__){"use strict";eval("// https://github.com/tc39/proposal-promise-finally\n\nvar $export = __webpack_require__(1);\nvar core = __webpack_require__(9);\nvar global = __webpack_require__(3);\nvar speciesConstructor = __webpack_require__(53);\nvar promiseResolve = __webpack_require__(106);\n\n$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {\n  var C = speciesConstructor(this, core.Promise || global.Promise);\n  var isFunction = typeof onFinally == 'function';\n  return this.then(\n    isFunction ? function (x) {\n      return promiseResolve(C, onFinally()).then(function () { return x; });\n    } : onFinally,\n    isFunction ? function (e) {\n      return promiseResolve(C, onFinally()).then(function () { throw e; });\n    } : onFinally\n  );\n} });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcucHJvbWlzZS5maW5hbGx5LmpzPzA5N2QiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtcHJvbWlzZS1maW5hbGx5XG4ndXNlIHN0cmljdCc7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGNvcmUgPSByZXF1aXJlKCcuL19jb3JlJyk7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgc3BlY2llc0NvbnN0cnVjdG9yID0gcmVxdWlyZSgnLi9fc3BlY2llcy1jb25zdHJ1Y3RvcicpO1xudmFyIHByb21pc2VSZXNvbHZlID0gcmVxdWlyZSgnLi9fcHJvbWlzZS1yZXNvbHZlJyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5SLCAnUHJvbWlzZScsIHsgJ2ZpbmFsbHknOiBmdW5jdGlvbiAob25GaW5hbGx5KSB7XG4gIHZhciBDID0gc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsIGNvcmUuUHJvbWlzZSB8fCBnbG9iYWwuUHJvbWlzZSk7XG4gIHZhciBpc0Z1bmN0aW9uID0gdHlwZW9mIG9uRmluYWxseSA9PSAnZnVuY3Rpb24nO1xuICByZXR1cm4gdGhpcy50aGVuKFxuICAgIGlzRnVuY3Rpb24gPyBmdW5jdGlvbiAoeCkge1xuICAgICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKEMsIG9uRmluYWxseSgpKS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHg7IH0pO1xuICAgIH0gOiBvbkZpbmFsbHksXG4gICAgaXNGdW5jdGlvbiA/IGZ1bmN0aW9uIChlKSB7XG4gICAgICByZXR1cm4gcHJvbWlzZVJlc29sdmUoQywgb25GaW5hbGx5KCkpLnRoZW4oZnVuY3Rpb24gKCkgeyB0aHJvdyBlOyB9KTtcbiAgICB9IDogb25GaW5hbGx5XG4gICk7XG59IH0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///275\n")},function(module,exports,__webpack_require__){eval("__webpack_require__(277);\n__webpack_require__(278);\n__webpack_require__(279);\nmodule.exports = __webpack_require__(9);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvd2ViL2luZGV4LmpzPzE3MTUiXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi4vbW9kdWxlcy93ZWIudGltZXJzJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL3dlYi5pbW1lZGlhdGUnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZScpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi9tb2R1bGVzL19jb3JlJyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///276\n")},function(module,exports,__webpack_require__){eval("// ie9- setTimeout & setInterval additional parameters fix\nvar global = __webpack_require__(3);\nvar $export = __webpack_require__(1);\nvar userAgent = __webpack_require__(54);\nvar slice = [].slice;\nvar MSIE = /MSIE .\\./.test(userAgent); // <- dirty ie9- check\nvar wrap = function (set) {\n  return function (fn, time /* , ...args */) {\n    var boundArgs = arguments.length > 2;\n    var args = boundArgs ? slice.call(arguments, 2) : false;\n    return set(boundArgs ? function () {\n      // eslint-disable-next-line no-new-func\n      (typeof fn == 'function' ? fn : Function(fn)).apply(this, args);\n    } : fn, time);\n  };\n};\n$export($export.G + $export.B + $export.F * MSIE, {\n  setTimeout: wrap(global.setTimeout),\n  setInterval: wrap(global.setInterval)\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy93ZWIudGltZXJzLmpzPzQ3OTUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaWU5LSBzZXRUaW1lb3V0ICYgc2V0SW50ZXJ2YWwgYWRkaXRpb25hbCBwYXJhbWV0ZXJzIGZpeFxudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciB1c2VyQWdlbnQgPSByZXF1aXJlKCcuL191c2VyLWFnZW50Jyk7XG52YXIgc2xpY2UgPSBbXS5zbGljZTtcbnZhciBNU0lFID0gL01TSUUgLlxcLi8udGVzdCh1c2VyQWdlbnQpOyAvLyA8LSBkaXJ0eSBpZTktIGNoZWNrXG52YXIgd3JhcCA9IGZ1bmN0aW9uIChzZXQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChmbiwgdGltZSAvKiAsIC4uLmFyZ3MgKi8pIHtcbiAgICB2YXIgYm91bmRBcmdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDI7XG4gICAgdmFyIGFyZ3MgPSBib3VuZEFyZ3MgPyBzbGljZS5jYWxsKGFyZ3VtZW50cywgMikgOiBmYWxzZTtcbiAgICByZXR1cm4gc2V0KGJvdW5kQXJncyA/IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1uZXctZnVuY1xuICAgICAgKHR5cGVvZiBmbiA9PSAnZnVuY3Rpb24nID8gZm4gOiBGdW5jdGlvbihmbikpLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH0gOiBmbiwgdGltZSk7XG4gIH07XG59O1xuJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LkIgKyAkZXhwb3J0LkYgKiBNU0lFLCB7XG4gIHNldFRpbWVvdXQ6IHdyYXAoZ2xvYmFsLnNldFRpbWVvdXQpLFxuICBzZXRJbnRlcnZhbDogd3JhcChnbG9iYWwuc2V0SW50ZXJ2YWwpXG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///277\n")},function(module,exports,__webpack_require__){eval("var $export = __webpack_require__(1);\nvar $task = __webpack_require__(80);\n$export($export.G + $export.B, {\n  setImmediate: $task.set,\n  clearImmediate: $task.clear\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy93ZWIuaW1tZWRpYXRlLmpzPzEzMGYiXSwic291cmNlc0NvbnRlbnQiOlsidmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciAkdGFzayA9IHJlcXVpcmUoJy4vX3Rhc2snKTtcbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5CLCB7XG4gIHNldEltbWVkaWF0ZTogJHRhc2suc2V0LFxuICBjbGVhckltbWVkaWF0ZTogJHRhc2suY2xlYXJcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///278\n")},function(module,exports,__webpack_require__){eval("var $iterators = __webpack_require__(78);\nvar getKeys = __webpack_require__(32);\nvar redefine = __webpack_require__(11);\nvar global = __webpack_require__(3);\nvar hide = __webpack_require__(14);\nvar Iterators = __webpack_require__(38);\nvar wks = __webpack_require__(6);\nvar ITERATOR = wks('iterator');\nvar TO_STRING_TAG = wks('toStringTag');\nvar ArrayValues = Iterators.Array;\n\nvar DOMIterables = {\n  CSSRuleList: true, // TODO: Not spec compliant, should be false.\n  CSSStyleDeclaration: false,\n  CSSValueList: false,\n  ClientRectList: false,\n  DOMRectList: false,\n  DOMStringList: false,\n  DOMTokenList: true,\n  DataTransferItemList: false,\n  FileList: false,\n  HTMLAllCollection: false,\n  HTMLCollection: false,\n  HTMLFormElement: false,\n  HTMLSelectElement: false,\n  MediaList: true, // TODO: Not spec compliant, should be false.\n  MimeTypeArray: false,\n  NamedNodeMap: false,\n  NodeList: true,\n  PaintRequestList: false,\n  Plugin: false,\n  PluginArray: false,\n  SVGLengthList: false,\n  SVGNumberList: false,\n  SVGPathSegList: false,\n  SVGPointList: false,\n  SVGStringList: false,\n  SVGTransformList: false,\n  SourceBufferList: false,\n  StyleSheetList: true, // TODO: Not spec compliant, should be false.\n  TextTrackCueList: false,\n  TextTrackList: false,\n  TouchList: false\n};\n\nfor (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {\n  var NAME = collections[i];\n  var explicit = DOMIterables[NAME];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  var key;\n  if (proto) {\n    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);\n    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n    Iterators[NAME] = ArrayValues;\n    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);\n  }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlLmpzP2FjNmEiXSwic291cmNlc0NvbnRlbnQiOlsidmFyICRpdGVyYXRvcnMgPSByZXF1aXJlKCcuL2VzNi5hcnJheS5pdGVyYXRvcicpO1xudmFyIGdldEtleXMgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpO1xudmFyIHJlZGVmaW5lID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUnKTtcbnZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBoaWRlID0gcmVxdWlyZSgnLi9faGlkZScpO1xudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4vX2l0ZXJhdG9ycycpO1xudmFyIHdrcyA9IHJlcXVpcmUoJy4vX3drcycpO1xudmFyIElURVJBVE9SID0gd2tzKCdpdGVyYXRvcicpO1xudmFyIFRPX1NUUklOR19UQUcgPSB3a3MoJ3RvU3RyaW5nVGFnJyk7XG52YXIgQXJyYXlWYWx1ZXMgPSBJdGVyYXRvcnMuQXJyYXk7XG5cbnZhciBET01JdGVyYWJsZXMgPSB7XG4gIENTU1J1bGVMaXN0OiB0cnVlLCAvLyBUT0RPOiBOb3Qgc3BlYyBjb21wbGlhbnQsIHNob3VsZCBiZSBmYWxzZS5cbiAgQ1NTU3R5bGVEZWNsYXJhdGlvbjogZmFsc2UsXG4gIENTU1ZhbHVlTGlzdDogZmFsc2UsXG4gIENsaWVudFJlY3RMaXN0OiBmYWxzZSxcbiAgRE9NUmVjdExpc3Q6IGZhbHNlLFxuICBET01TdHJpbmdMaXN0OiBmYWxzZSxcbiAgRE9NVG9rZW5MaXN0OiB0cnVlLFxuICBEYXRhVHJhbnNmZXJJdGVtTGlzdDogZmFsc2UsXG4gIEZpbGVMaXN0OiBmYWxzZSxcbiAgSFRNTEFsbENvbGxlY3Rpb246IGZhbHNlLFxuICBIVE1MQ29sbGVjdGlvbjogZmFsc2UsXG4gIEhUTUxGb3JtRWxlbWVudDogZmFsc2UsXG4gIEhUTUxTZWxlY3RFbGVtZW50OiBmYWxzZSxcbiAgTWVkaWFMaXN0OiB0cnVlLCAvLyBUT0RPOiBOb3Qgc3BlYyBjb21wbGlhbnQsIHNob3VsZCBiZSBmYWxzZS5cbiAgTWltZVR5cGVBcnJheTogZmFsc2UsXG4gIE5hbWVkTm9kZU1hcDogZmFsc2UsXG4gIE5vZGVMaXN0OiB0cnVlLFxuICBQYWludFJlcXVlc3RMaXN0OiBmYWxzZSxcbiAgUGx1Z2luOiBmYWxzZSxcbiAgUGx1Z2luQXJyYXk6IGZhbHNlLFxuICBTVkdMZW5ndGhMaXN0OiBmYWxzZSxcbiAgU1ZHTnVtYmVyTGlzdDogZmFsc2UsXG4gIFNWR1BhdGhTZWdMaXN0OiBmYWxzZSxcbiAgU1ZHUG9pbnRMaXN0OiBmYWxzZSxcbiAgU1ZHU3RyaW5nTGlzdDogZmFsc2UsXG4gIFNWR1RyYW5zZm9ybUxpc3Q6IGZhbHNlLFxuICBTb3VyY2VCdWZmZXJMaXN0OiBmYWxzZSxcbiAgU3R5bGVTaGVldExpc3Q6IHRydWUsIC8vIFRPRE86IE5vdCBzcGVjIGNvbXBsaWFudCwgc2hvdWxkIGJlIGZhbHNlLlxuICBUZXh0VHJhY2tDdWVMaXN0OiBmYWxzZSxcbiAgVGV4dFRyYWNrTGlzdDogZmFsc2UsXG4gIFRvdWNoTGlzdDogZmFsc2Vcbn07XG5cbmZvciAodmFyIGNvbGxlY3Rpb25zID0gZ2V0S2V5cyhET01JdGVyYWJsZXMpLCBpID0gMDsgaSA8IGNvbGxlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gIHZhciBOQU1FID0gY29sbGVjdGlvbnNbaV07XG4gIHZhciBleHBsaWNpdCA9IERPTUl0ZXJhYmxlc1tOQU1FXTtcbiAgdmFyIENvbGxlY3Rpb24gPSBnbG9iYWxbTkFNRV07XG4gIHZhciBwcm90byA9IENvbGxlY3Rpb24gJiYgQ29sbGVjdGlvbi5wcm90b3R5cGU7XG4gIHZhciBrZXk7XG4gIGlmIChwcm90bykge1xuICAgIGlmICghcHJvdG9bSVRFUkFUT1JdKSBoaWRlKHByb3RvLCBJVEVSQVRPUiwgQXJyYXlWYWx1ZXMpO1xuICAgIGlmICghcHJvdG9bVE9fU1RSSU5HX1RBR10pIGhpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpO1xuICAgIEl0ZXJhdG9yc1tOQU1FXSA9IEFycmF5VmFsdWVzO1xuICAgIGlmIChleHBsaWNpdCkgZm9yIChrZXkgaW4gJGl0ZXJhdG9ycykgaWYgKCFwcm90b1trZXldKSByZWRlZmluZShwcm90bywga2V5LCAkaXRlcmF0b3JzW2tleV0sIHRydWUpO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///279\n")},function(module,exports){eval('/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n!(function(global) {\n  "use strict";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === "function" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || "@@iterator";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";\n  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";\n\n  var inModule = typeof module === "object";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we\'re in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don\'t bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we\'re in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there\'s no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don\'t have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: "normal", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: "throw", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = "suspendedStart";\n  var GenStateSuspendedYield = "suspendedYield";\n  var GenStateExecuting = "executing";\n  var GenStateCompleted = "completed";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don\'t natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = "GeneratorFunction";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    ["next", "throw", "return"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === "function" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === "GeneratorFunction"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = "GeneratorFunction";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, "__await")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === "throw") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === "object" &&\n            hasOwn.call(value, "__await")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke("next", value, resolve, reject);\n          }, function(err) {\n            invoke("throw", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration. If the Promise is rejected, however, the\n          // result for this iteration will be rejected with the same\n          // reason. Note that rejections of yielded Promises are not\n          // thrown back into the generator function, as is the case\n          // when an awaited Promise is rejected. This difference in\n          // behavior between yield and await is important, because it\n          // allows the consumer to decide what to do with the yielded\n          // rejection (swallow it and continue, manually .throw it back\n          // into the generator, abandon iteration, whatever). With\n          // await, by contrast, there is no opportunity to examine the\n          // rejection reason outside the generator function, so the\n          // only option is to throw it from the await expression, and\n          // let the generator function handle the exception.\n          result.value = unwrapped;\n          resolve(result);\n        }, reject);\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error("Generator is already running");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === "throw") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === "next") {\n          // Setting context._sent for legacy support of Babel\'s\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === "throw") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === "return") {\n          context.abrupt("return", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === "normal") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === "throw") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = "throw";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === "throw") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = "return";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === "throw") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // "return" to "throw", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = "throw";\n        context.arg = new TypeError(\n          "The iterator does not provide a \'throw\' method");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === "throw") {\n      context.method = "throw";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = "throw";\n      context.arg = new TypeError("iterator result is not an object");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was "throw" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was "next", forget context.arg since it has been\n      // "consumed" by the delegate iterator. If context.method was\n      // "return", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== "return") {\n        context.method = "next";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = "Generator";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers\' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn\'t happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return "[object Generator]";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = "normal";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: "root" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === "function") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel\'s\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = "next";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === "t" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === "throw") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = "throw";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = "next";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === "root") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle("end");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, "catchLoc");\n          var hasFinally = hasOwn.call(entry, "finallyLoc");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error("try statement without catch or finally");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, "finallyLoc") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === "break" ||\n           type === "continue") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = "next";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === "throw") {\n        throw record.arg;\n      }\n\n      if (record.type === "break" ||\n          record.type === "continue") {\n        this.next = record.arg;\n      } else if (record.type === "return") {\n        this.rval = this.arg = record.arg;\n        this.method = "return";\n        this.next = "end";\n      } else if (record.type === "normal" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    "catch": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === "throw") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error("illegal catch attempt");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === "next") {\n        // Deliberately forget the last sent value so that we don\'t\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // In sloppy mode, unbound `this` refers to the global object, fallback to\n  // Function constructor if we\'re in global strict mode. That is sadly a form\n  // of indirect eval which violates Content Security Policy.\n  (function() { return this })() || Function("return this")()\n);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL3JlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcz85NmNmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuIShmdW5jdGlvbihnbG9iYWwpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIE9wID0gT2JqZWN0LnByb3RvdHlwZTtcbiAgdmFyIGhhc093biA9IE9wLmhhc093blByb3BlcnR5O1xuICB2YXIgdW5kZWZpbmVkOyAvLyBNb3JlIGNvbXByZXNzaWJsZSB0aGFuIHZvaWQgMC5cbiAgdmFyICRTeW1ib2wgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgPyBTeW1ib2wgOiB7fTtcbiAgdmFyIGl0ZXJhdG9yU3ltYm9sID0gJFN5bWJvbC5pdGVyYXRvciB8fCBcIkBAaXRlcmF0b3JcIjtcbiAgdmFyIGFzeW5jSXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLmFzeW5jSXRlcmF0b3IgfHwgXCJAQGFzeW5jSXRlcmF0b3JcIjtcbiAgdmFyIHRvU3RyaW5nVGFnU3ltYm9sID0gJFN5bWJvbC50b1N0cmluZ1RhZyB8fCBcIkBAdG9TdHJpbmdUYWdcIjtcblxuICB2YXIgaW5Nb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiO1xuICB2YXIgcnVudGltZSA9IGdsb2JhbC5yZWdlbmVyYXRvclJ1bnRpbWU7XG4gIGlmIChydW50aW1lKSB7XG4gICAgaWYgKGluTW9kdWxlKSB7XG4gICAgICAvLyBJZiByZWdlbmVyYXRvclJ1bnRpbWUgaXMgZGVmaW5lZCBnbG9iYWxseSBhbmQgd2UncmUgaW4gYSBtb2R1bGUsXG4gICAgICAvLyBtYWtlIHRoZSBleHBvcnRzIG9iamVjdCBpZGVudGljYWwgdG8gcmVnZW5lcmF0b3JSdW50aW1lLlxuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBydW50aW1lO1xuICAgIH1cbiAgICAvLyBEb24ndCBib3RoZXIgZXZhbHVhdGluZyB0aGUgcmVzdCBvZiB0aGlzIGZpbGUgaWYgdGhlIHJ1bnRpbWUgd2FzXG4gICAgLy8gYWxyZWFkeSBkZWZpbmVkIGdsb2JhbGx5LlxuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIERlZmluZSB0aGUgcnVudGltZSBnbG9iYWxseSAoYXMgZXhwZWN0ZWQgYnkgZ2VuZXJhdGVkIGNvZGUpIGFzIGVpdGhlclxuICAvLyBtb2R1bGUuZXhwb3J0cyAoaWYgd2UncmUgaW4gYSBtb2R1bGUpIG9yIGEgbmV3LCBlbXB0eSBvYmplY3QuXG4gIHJ1bnRpbWUgPSBnbG9iYWwucmVnZW5lcmF0b3JSdW50aW1lID0gaW5Nb2R1bGUgPyBtb2R1bGUuZXhwb3J0cyA6IHt9O1xuXG4gIGZ1bmN0aW9uIHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpIHtcbiAgICAvLyBJZiBvdXRlckZuIHByb3ZpZGVkIGFuZCBvdXRlckZuLnByb3RvdHlwZSBpcyBhIEdlbmVyYXRvciwgdGhlbiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvci5cbiAgICB2YXIgcHJvdG9HZW5lcmF0b3IgPSBvdXRlckZuICYmIG91dGVyRm4ucHJvdG90eXBlIGluc3RhbmNlb2YgR2VuZXJhdG9yID8gb3V0ZXJGbiA6IEdlbmVyYXRvcjtcbiAgICB2YXIgZ2VuZXJhdG9yID0gT2JqZWN0LmNyZWF0ZShwcm90b0dlbmVyYXRvci5wcm90b3R5cGUpO1xuICAgIHZhciBjb250ZXh0ID0gbmV3IENvbnRleHQodHJ5TG9jc0xpc3QgfHwgW10pO1xuXG4gICAgLy8gVGhlIC5faW52b2tlIG1ldGhvZCB1bmlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcy5cbiAgICBnZW5lcmF0b3IuX2ludm9rZSA9IG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG5cbiAgICByZXR1cm4gZ2VuZXJhdG9yO1xuICB9XG4gIHJ1bnRpbWUud3JhcCA9IHdyYXA7XG5cbiAgLy8gVHJ5L2NhdGNoIGhlbHBlciB0byBtaW5pbWl6ZSBkZW9wdGltaXphdGlvbnMuIFJldHVybnMgYSBjb21wbGV0aW9uXG4gIC8vIHJlY29yZCBsaWtlIGNvbnRleHQudHJ5RW50cmllc1tpXS5jb21wbGV0aW9uLiBUaGlzIGludGVyZmFjZSBjb3VsZFxuICAvLyBoYXZlIGJlZW4gKGFuZCB3YXMgcHJldmlvdXNseSkgZGVzaWduZWQgdG8gdGFrZSBhIGNsb3N1cmUgdG8gYmVcbiAgLy8gaW52b2tlZCB3aXRob3V0IGFyZ3VtZW50cywgYnV0IGluIGFsbCB0aGUgY2FzZXMgd2UgY2FyZSBhYm91dCB3ZVxuICAvLyBhbHJlYWR5IGhhdmUgYW4gZXhpc3RpbmcgbWV0aG9kIHdlIHdhbnQgdG8gY2FsbCwgc28gdGhlcmUncyBubyBuZWVkXG4gIC8vIHRvIGNyZWF0ZSBhIG5ldyBmdW5jdGlvbiBvYmplY3QuIFdlIGNhbiBldmVuIGdldCBhd2F5IHdpdGggYXNzdW1pbmdcbiAgLy8gdGhlIG1ldGhvZCB0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCwgc2luY2UgdGhhdCBoYXBwZW5zIHRvIGJlIHRydWVcbiAgLy8gaW4gZXZlcnkgY2FzZSwgc28gd2UgZG9uJ3QgaGF2ZSB0byB0b3VjaCB0aGUgYXJndW1lbnRzIG9iamVjdC4gVGhlXG4gIC8vIG9ubHkgYWRkaXRpb25hbCBhbGxvY2F0aW9uIHJlcXVpcmVkIGlzIHRoZSBjb21wbGV0aW9uIHJlY29yZCwgd2hpY2hcbiAgLy8gaGFzIGEgc3RhYmxlIHNoYXBlIGFuZCBzbyBob3BlZnVsbHkgc2hvdWxkIGJlIGNoZWFwIHRvIGFsbG9jYXRlLlxuICBmdW5jdGlvbiB0cnlDYXRjaChmbiwgb2JqLCBhcmcpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJub3JtYWxcIiwgYXJnOiBmbi5jYWxsKG9iaiwgYXJnKSB9O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJ0aHJvd1wiLCBhcmc6IGVyciB9O1xuICAgIH1cbiAgfVxuXG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0ID0gXCJzdXNwZW5kZWRTdGFydFwiO1xuICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRZaWVsZCA9IFwic3VzcGVuZGVkWWllbGRcIjtcbiAgdmFyIEdlblN0YXRlRXhlY3V0aW5nID0gXCJleGVjdXRpbmdcIjtcbiAgdmFyIEdlblN0YXRlQ29tcGxldGVkID0gXCJjb21wbGV0ZWRcIjtcblxuICAvLyBSZXR1cm5pbmcgdGhpcyBvYmplY3QgZnJvbSB0aGUgaW5uZXJGbiBoYXMgdGhlIHNhbWUgZWZmZWN0IGFzXG4gIC8vIGJyZWFraW5nIG91dCBvZiB0aGUgZGlzcGF0Y2ggc3dpdGNoIHN0YXRlbWVudC5cbiAgdmFyIENvbnRpbnVlU2VudGluZWwgPSB7fTtcblxuICAvLyBEdW1teSBjb25zdHJ1Y3RvciBmdW5jdGlvbnMgdGhhdCB3ZSB1c2UgYXMgdGhlIC5jb25zdHJ1Y3RvciBhbmRcbiAgLy8gLmNvbnN0cnVjdG9yLnByb3RvdHlwZSBwcm9wZXJ0aWVzIGZvciBmdW5jdGlvbnMgdGhhdCByZXR1cm4gR2VuZXJhdG9yXG4gIC8vIG9iamVjdHMuIEZvciBmdWxsIHNwZWMgY29tcGxpYW5jZSwgeW91IG1heSB3aXNoIHRvIGNvbmZpZ3VyZSB5b3VyXG4gIC8vIG1pbmlmaWVyIG5vdCB0byBtYW5nbGUgdGhlIG5hbWVzIG9mIHRoZXNlIHR3byBmdW5jdGlvbnMuXG4gIGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9XG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUoKSB7fVxuXG4gIC8vIFRoaXMgaXMgYSBwb2x5ZmlsbCBmb3IgJUl0ZXJhdG9yUHJvdG90eXBlJSBmb3IgZW52aXJvbm1lbnRzIHRoYXRcbiAgLy8gZG9uJ3QgbmF0aXZlbHkgc3VwcG9ydCBpdC5cbiAgdmFyIEl0ZXJhdG9yUHJvdG90eXBlID0ge307XG4gIEl0ZXJhdG9yUHJvdG90eXBlW2l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICB2YXIgZ2V0UHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Y7XG4gIHZhciBOYXRpdmVJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvICYmIGdldFByb3RvKGdldFByb3RvKHZhbHVlcyhbXSkpKTtcbiAgaWYgKE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlICYmXG4gICAgICBOYXRpdmVJdGVyYXRvclByb3RvdHlwZSAhPT0gT3AgJiZcbiAgICAgIGhhc093bi5jYWxsKE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlLCBpdGVyYXRvclN5bWJvbCkpIHtcbiAgICAvLyBUaGlzIGVudmlyb25tZW50IGhhcyBhIG5hdGl2ZSAlSXRlcmF0b3JQcm90b3R5cGUlOyB1c2UgaXQgaW5zdGVhZFxuICAgIC8vIG9mIHRoZSBwb2x5ZmlsbC5cbiAgICBJdGVyYXRvclByb3RvdHlwZSA9IE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlO1xuICB9XG5cbiAgdmFyIEdwID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUucHJvdG90eXBlID1cbiAgICBHZW5lcmF0b3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSk7XG4gIEdlbmVyYXRvckZ1bmN0aW9uLnByb3RvdHlwZSA9IEdwLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb247XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlW3RvU3RyaW5nVGFnU3ltYm9sXSA9XG4gICAgR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG5cbiAgLy8gSGVscGVyIGZvciBkZWZpbmluZyB0aGUgLm5leHQsIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcyBvZiB0aGVcbiAgLy8gSXRlcmF0b3IgaW50ZXJmYWNlIGluIHRlcm1zIG9mIGEgc2luZ2xlIC5faW52b2tlIG1ldGhvZC5cbiAgZnVuY3Rpb24gZGVmaW5lSXRlcmF0b3JNZXRob2RzKHByb3RvdHlwZSkge1xuICAgIFtcIm5leHRcIiwgXCJ0aHJvd1wiLCBcInJldHVyblwiXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgcHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uID0gZnVuY3Rpb24oZ2VuRnVuKSB7XG4gICAgdmFyIGN0b3IgPSB0eXBlb2YgZ2VuRnVuID09PSBcImZ1bmN0aW9uXCIgJiYgZ2VuRnVuLmNvbnN0cnVjdG9yO1xuICAgIHJldHVybiBjdG9yXG4gICAgICA/IGN0b3IgPT09IEdlbmVyYXRvckZ1bmN0aW9uIHx8XG4gICAgICAgIC8vIEZvciB0aGUgbmF0aXZlIEdlbmVyYXRvckZ1bmN0aW9uIGNvbnN0cnVjdG9yLCB0aGUgYmVzdCB3ZSBjYW5cbiAgICAgICAgLy8gZG8gaXMgdG8gY2hlY2sgaXRzIC5uYW1lIHByb3BlcnR5LlxuICAgICAgICAoY3Rvci5kaXNwbGF5TmFtZSB8fCBjdG9yLm5hbWUpID09PSBcIkdlbmVyYXRvckZ1bmN0aW9uXCJcbiAgICAgIDogZmFsc2U7XG4gIH07XG5cbiAgcnVudGltZS5tYXJrID0gZnVuY3Rpb24oZ2VuRnVuKSB7XG4gICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikge1xuICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGdlbkZ1biwgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBnZW5GdW4uX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gICAgICBpZiAoISh0b1N0cmluZ1RhZ1N5bWJvbCBpbiBnZW5GdW4pKSB7XG4gICAgICAgIGdlbkZ1blt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKTtcbiAgICByZXR1cm4gZ2VuRnVuO1xuICB9O1xuXG4gIC8vIFdpdGhpbiB0aGUgYm9keSBvZiBhbnkgYXN5bmMgZnVuY3Rpb24sIGBhd2FpdCB4YCBpcyB0cmFuc2Zvcm1lZCB0b1xuICAvLyBgeWllbGQgcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHgpYCwgc28gdGhhdCB0aGUgcnVudGltZSBjYW4gdGVzdFxuICAvLyBgaGFzT3duLmNhbGwodmFsdWUsIFwiX19hd2FpdFwiKWAgdG8gZGV0ZXJtaW5lIGlmIHRoZSB5aWVsZGVkIHZhbHVlIGlzXG4gIC8vIG1lYW50IHRvIGJlIGF3YWl0ZWQuXG4gIHJ1bnRpbWUuYXdyYXAgPSBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4geyBfX2F3YWl0OiBhcmcgfTtcbiAgfTtcblxuICBmdW5jdGlvbiBBc3luY0l0ZXJhdG9yKGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goZ2VuZXJhdG9yW21ldGhvZF0sIGdlbmVyYXRvciwgYXJnKTtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHJlamVjdChyZWNvcmQuYXJnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciByZXN1bHQgPSByZWNvcmQuYXJnO1xuICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSAmJlxuICAgICAgICAgICAgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgICBoYXNPd24uY2FsbCh2YWx1ZSwgXCJfX2F3YWl0XCIpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZS5fX2F3YWl0KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICBpbnZva2UoXCJuZXh0XCIsIHZhbHVlLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgaW52b2tlKFwidGhyb3dcIiwgZXJyLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbih1bndyYXBwZWQpIHtcbiAgICAgICAgICAvLyBXaGVuIGEgeWllbGRlZCBQcm9taXNlIGlzIHJlc29sdmVkLCBpdHMgZmluYWwgdmFsdWUgYmVjb21lc1xuICAgICAgICAgIC8vIHRoZSAudmFsdWUgb2YgdGhlIFByb21pc2U8e3ZhbHVlLGRvbmV9PiByZXN1bHQgZm9yIHRoZVxuICAgICAgICAgIC8vIGN1cnJlbnQgaXRlcmF0aW9uLiBJZiB0aGUgUHJvbWlzZSBpcyByZWplY3RlZCwgaG93ZXZlciwgdGhlXG4gICAgICAgICAgLy8gcmVzdWx0IGZvciB0aGlzIGl0ZXJhdGlvbiB3aWxsIGJlIHJlamVjdGVkIHdpdGggdGhlIHNhbWVcbiAgICAgICAgICAvLyByZWFzb24uIE5vdGUgdGhhdCByZWplY3Rpb25zIG9mIHlpZWxkZWQgUHJvbWlzZXMgYXJlIG5vdFxuICAgICAgICAgIC8vIHRocm93biBiYWNrIGludG8gdGhlIGdlbmVyYXRvciBmdW5jdGlvbiwgYXMgaXMgdGhlIGNhc2VcbiAgICAgICAgICAvLyB3aGVuIGFuIGF3YWl0ZWQgUHJvbWlzZSBpcyByZWplY3RlZC4gVGhpcyBkaWZmZXJlbmNlIGluXG4gICAgICAgICAgLy8gYmVoYXZpb3IgYmV0d2VlbiB5aWVsZCBhbmQgYXdhaXQgaXMgaW1wb3J0YW50LCBiZWNhdXNlIGl0XG4gICAgICAgICAgLy8gYWxsb3dzIHRoZSBjb25zdW1lciB0byBkZWNpZGUgd2hhdCB0byBkbyB3aXRoIHRoZSB5aWVsZGVkXG4gICAgICAgICAgLy8gcmVqZWN0aW9uIChzd2FsbG93IGl0IGFuZCBjb250aW51ZSwgbWFudWFsbHkgLnRocm93IGl0IGJhY2tcbiAgICAgICAgICAvLyBpbnRvIHRoZSBnZW5lcmF0b3IsIGFiYW5kb24gaXRlcmF0aW9uLCB3aGF0ZXZlcikuIFdpdGhcbiAgICAgICAgICAvLyBhd2FpdCwgYnkgY29udHJhc3QsIHRoZXJlIGlzIG5vIG9wcG9ydHVuaXR5IHRvIGV4YW1pbmUgdGhlXG4gICAgICAgICAgLy8gcmVqZWN0aW9uIHJlYXNvbiBvdXRzaWRlIHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24sIHNvIHRoZVxuICAgICAgICAgIC8vIG9ubHkgb3B0aW9uIGlzIHRvIHRocm93IGl0IGZyb20gdGhlIGF3YWl0IGV4cHJlc3Npb24sIGFuZFxuICAgICAgICAgIC8vIGxldCB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uIGhhbmRsZSB0aGUgZXhjZXB0aW9uLlxuICAgICAgICAgIHJlc3VsdC52YWx1ZSA9IHVud3JhcHBlZDtcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgIH0sIHJlamVjdCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHByZXZpb3VzUHJvbWlzZTtcblxuICAgIGZ1bmN0aW9uIGVucXVldWUobWV0aG9kLCBhcmcpIHtcbiAgICAgIGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9XG4gICAgICAgIC8vIElmIGVucXVldWUgaGFzIGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiB3ZSB3YW50IHRvIHdhaXQgdW50aWxcbiAgICAgICAgLy8gYWxsIHByZXZpb3VzIFByb21pc2VzIGhhdmUgYmVlbiByZXNvbHZlZCBiZWZvcmUgY2FsbGluZyBpbnZva2UsXG4gICAgICAgIC8vIHNvIHRoYXQgcmVzdWx0cyBhcmUgYWx3YXlzIGRlbGl2ZXJlZCBpbiB0aGUgY29ycmVjdCBvcmRlci4gSWZcbiAgICAgICAgLy8gZW5xdWV1ZSBoYXMgbm90IGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiBpdCBpcyBpbXBvcnRhbnQgdG9cbiAgICAgICAgLy8gY2FsbCBpbnZva2UgaW1tZWRpYXRlbHksIHdpdGhvdXQgd2FpdGluZyBvbiBhIGNhbGxiYWNrIHRvIGZpcmUsXG4gICAgICAgIC8vIHNvIHRoYXQgdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGRvXG4gICAgICAgIC8vIGFueSBuZWNlc3Nhcnkgc2V0dXAgaW4gYSBwcmVkaWN0YWJsZSB3YXkuIFRoaXMgcHJlZGljdGFiaWxpdHlcbiAgICAgICAgLy8gaXMgd2h5IHRoZSBQcm9taXNlIGNvbnN0cnVjdG9yIHN5bmNocm9ub3VzbHkgaW52b2tlcyBpdHNcbiAgICAgICAgLy8gZXhlY3V0b3IgY2FsbGJhY2ssIGFuZCB3aHkgYXN5bmMgZnVuY3Rpb25zIHN5bmNocm9ub3VzbHlcbiAgICAgICAgLy8gZXhlY3V0ZSBjb2RlIGJlZm9yZSB0aGUgZmlyc3QgYXdhaXQuIFNpbmNlIHdlIGltcGxlbWVudCBzaW1wbGVcbiAgICAgICAgLy8gYXN5bmMgZnVuY3Rpb25zIGluIHRlcm1zIG9mIGFzeW5jIGdlbmVyYXRvcnMsIGl0IGlzIGVzcGVjaWFsbHlcbiAgICAgICAgLy8gaW1wb3J0YW50IHRvIGdldCB0aGlzIHJpZ2h0LCBldmVuIHRob3VnaCBpdCByZXF1aXJlcyBjYXJlLlxuICAgICAgICBwcmV2aW91c1Byb21pc2UgPyBwcmV2aW91c1Byb21pc2UudGhlbihcbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyxcbiAgICAgICAgICAvLyBBdm9pZCBwcm9wYWdhdGluZyBmYWlsdXJlcyB0byBQcm9taXNlcyByZXR1cm5lZCBieSBsYXRlclxuICAgICAgICAgIC8vIGludm9jYXRpb25zIG9mIHRoZSBpdGVyYXRvci5cbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZ1xuICAgICAgICApIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTtcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuICAgIHRoaXMuX2ludm9rZSA9IGVucXVldWU7XG4gIH1cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpO1xuICBBc3luY0l0ZXJhdG9yLnByb3RvdHlwZVthc3luY0l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgcnVudGltZS5Bc3luY0l0ZXJhdG9yID0gQXN5bmNJdGVyYXRvcjtcblxuICAvLyBOb3RlIHRoYXQgc2ltcGxlIGFzeW5jIGZ1bmN0aW9ucyBhcmUgaW1wbGVtZW50ZWQgb24gdG9wIG9mXG4gIC8vIEFzeW5jSXRlcmF0b3Igb2JqZWN0czsgdGhleSBqdXN0IHJldHVybiBhIFByb21pc2UgZm9yIHRoZSB2YWx1ZSBvZlxuICAvLyB0aGUgZmluYWwgcmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBpdGVyYXRvci5cbiAgcnVudGltZS5hc3luYyA9IGZ1bmN0aW9uKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgdmFyIGl0ZXIgPSBuZXcgQXN5bmNJdGVyYXRvcihcbiAgICAgIHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpXG4gICAgKTtcblxuICAgIHJldHVybiBydW50aW1lLmlzR2VuZXJhdG9yRnVuY3Rpb24ob3V0ZXJGbilcbiAgICAgID8gaXRlciAvLyBJZiBvdXRlckZuIGlzIGEgZ2VuZXJhdG9yLCByZXR1cm4gdGhlIGZ1bGwgaXRlcmF0b3IuXG4gICAgICA6IGl0ZXIubmV4dCgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdC5kb25lID8gcmVzdWx0LnZhbHVlIDogaXRlci5uZXh0KCk7XG4gICAgICAgIH0pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCkge1xuICAgIHZhciBzdGF0ZSA9IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlRXhlY3V0aW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmdcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVDb21wbGV0ZWQpIHtcbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgdGhyb3cgYXJnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmUgZm9yZ2l2aW5nLCBwZXIgMjUuMy4zLjMuMyBvZiB0aGUgc3BlYzpcbiAgICAgICAgLy8gaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWdlbmVyYXRvcnJlc3VtZVxuICAgICAgICByZXR1cm4gZG9uZVJlc3VsdCgpO1xuICAgICAgfVxuXG4gICAgICBjb250ZXh0Lm1ldGhvZCA9IG1ldGhvZDtcbiAgICAgIGNvbnRleHQuYXJnID0gYXJnO1xuXG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBjb250ZXh0LmRlbGVnYXRlO1xuICAgICAgICBpZiAoZGVsZWdhdGUpIHtcbiAgICAgICAgICB2YXIgZGVsZWdhdGVSZXN1bHQgPSBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KTtcbiAgICAgICAgICBpZiAoZGVsZWdhdGVSZXN1bHQpIHtcbiAgICAgICAgICAgIGlmIChkZWxlZ2F0ZVJlc3VsdCA9PT0gQ29udGludWVTZW50aW5lbCkgY29udGludWU7XG4gICAgICAgICAgICByZXR1cm4gZGVsZWdhdGVSZXN1bHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbnRleHQubWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAgIC8vIFNldHRpbmcgY29udGV4dC5fc2VudCBmb3IgbGVnYWN5IHN1cHBvcnQgb2YgQmFiZWwnc1xuICAgICAgICAgIC8vIGZ1bmN0aW9uLnNlbnQgaW1wbGVtZW50YXRpb24uXG4gICAgICAgICAgY29udGV4dC5zZW50ID0gY29udGV4dC5fc2VudCA9IGNvbnRleHQuYXJnO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoY29udGV4dC5tZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydCkge1xuICAgICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUNvbXBsZXRlZDtcbiAgICAgICAgICAgIHRocm93IGNvbnRleHQuYXJnO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oY29udGV4dC5hcmcpO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoY29udGV4dC5tZXRob2QgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgICBjb250ZXh0LmFicnVwdChcInJldHVyblwiLCBjb250ZXh0LmFyZyk7XG4gICAgICAgIH1cblxuICAgICAgICBzdGF0ZSA9IEdlblN0YXRlRXhlY3V0aW5nO1xuXG4gICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTtcbiAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcIm5vcm1hbFwiKSB7XG4gICAgICAgICAgLy8gSWYgYW4gZXhjZXB0aW9uIGlzIHRocm93biBmcm9tIGlubmVyRm4sIHdlIGxlYXZlIHN0YXRlID09PVxuICAgICAgICAgIC8vIEdlblN0YXRlRXhlY3V0aW5nIGFuZCBsb29wIGJhY2sgZm9yIGFub3RoZXIgaW52b2NhdGlvbi5cbiAgICAgICAgICBzdGF0ZSA9IGNvbnRleHQuZG9uZVxuICAgICAgICAgICAgPyBHZW5TdGF0ZUNvbXBsZXRlZFxuICAgICAgICAgICAgOiBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkO1xuXG4gICAgICAgICAgaWYgKHJlY29yZC5hcmcgPT09IENvbnRpbnVlU2VudGluZWwpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogcmVjb3JkLmFyZyxcbiAgICAgICAgICAgIGRvbmU6IGNvbnRleHQuZG9uZVxuICAgICAgICAgIH07XG5cbiAgICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUNvbXBsZXRlZDtcbiAgICAgICAgICAvLyBEaXNwYXRjaCB0aGUgZXhjZXB0aW9uIGJ5IGxvb3BpbmcgYmFjayBhcm91bmQgdG8gdGhlXG4gICAgICAgICAgLy8gY29udGV4dC5kaXNwYXRjaEV4Y2VwdGlvbihjb250ZXh0LmFyZykgY2FsbCBhYm92ZS5cbiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgICBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8gQ2FsbCBkZWxlZ2F0ZS5pdGVyYXRvcltjb250ZXh0Lm1ldGhvZF0oY29udGV4dC5hcmcpIGFuZCBoYW5kbGUgdGhlXG4gIC8vIHJlc3VsdCwgZWl0aGVyIGJ5IHJldHVybmluZyBhIHsgdmFsdWUsIGRvbmUgfSByZXN1bHQgZnJvbSB0aGVcbiAgLy8gZGVsZWdhdGUgaXRlcmF0b3IsIG9yIGJ5IG1vZGlmeWluZyBjb250ZXh0Lm1ldGhvZCBhbmQgY29udGV4dC5hcmcsXG4gIC8vIHNldHRpbmcgY29udGV4dC5kZWxlZ2F0ZSB0byBudWxsLCBhbmQgcmV0dXJuaW5nIHRoZSBDb250aW51ZVNlbnRpbmVsLlxuICBmdW5jdGlvbiBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KSB7XG4gICAgdmFyIG1ldGhvZCA9IGRlbGVnYXRlLml0ZXJhdG9yW2NvbnRleHQubWV0aG9kXTtcbiAgICBpZiAobWV0aG9kID09PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIEEgLnRocm93IG9yIC5yZXR1cm4gd2hlbiB0aGUgZGVsZWdhdGUgaXRlcmF0b3IgaGFzIG5vIC50aHJvd1xuICAgICAgLy8gbWV0aG9kIGFsd2F5cyB0ZXJtaW5hdGVzIHRoZSB5aWVsZCogbG9vcC5cbiAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICBpZiAoZGVsZWdhdGUuaXRlcmF0b3IucmV0dXJuKSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBhIHJldHVybiBtZXRob2QsIGdpdmUgaXQgYVxuICAgICAgICAgIC8vIGNoYW5jZSB0byBjbGVhbiB1cC5cbiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwicmV0dXJuXCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCk7XG5cbiAgICAgICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgLy8gSWYgbWF5YmVJbnZva2VEZWxlZ2F0ZShjb250ZXh0KSBjaGFuZ2VkIGNvbnRleHQubWV0aG9kIGZyb21cbiAgICAgICAgICAgIC8vIFwicmV0dXJuXCIgdG8gXCJ0aHJvd1wiLCBsZXQgdGhhdCBvdmVycmlkZSB0aGUgVHlwZUVycm9yIGJlbG93LlxuICAgICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcihcbiAgICAgICAgICBcIlRoZSBpdGVyYXRvciBkb2VzIG5vdCBwcm92aWRlIGEgJ3Rocm93JyBtZXRob2RcIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChtZXRob2QsIGRlbGVnYXRlLml0ZXJhdG9yLCBjb250ZXh0LmFyZyk7XG5cbiAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciBpbmZvID0gcmVjb3JkLmFyZztcblxuICAgIGlmICghIGluZm8pIHtcbiAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgY29udGV4dC5hcmcgPSBuZXcgVHlwZUVycm9yKFwiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3RcIik7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIGlmIChpbmZvLmRvbmUpIHtcbiAgICAgIC8vIEFzc2lnbiB0aGUgcmVzdWx0IG9mIHRoZSBmaW5pc2hlZCBkZWxlZ2F0ZSB0byB0aGUgdGVtcG9yYXJ5XG4gICAgICAvLyB2YXJpYWJsZSBzcGVjaWZpZWQgYnkgZGVsZWdhdGUucmVzdWx0TmFtZSAoc2VlIGRlbGVnYXRlWWllbGQpLlxuICAgICAgY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWU7XG5cbiAgICAgIC8vIFJlc3VtZSBleGVjdXRpb24gYXQgdGhlIGRlc2lyZWQgbG9jYXRpb24gKHNlZSBkZWxlZ2F0ZVlpZWxkKS5cbiAgICAgIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2M7XG5cbiAgICAgIC8vIElmIGNvbnRleHQubWV0aG9kIHdhcyBcInRocm93XCIgYnV0IHRoZSBkZWxlZ2F0ZSBoYW5kbGVkIHRoZVxuICAgICAgLy8gZXhjZXB0aW9uLCBsZXQgdGhlIG91dGVyIGdlbmVyYXRvciBwcm9jZWVkIG5vcm1hbGx5LiBJZlxuICAgICAgLy8gY29udGV4dC5tZXRob2Qgd2FzIFwibmV4dFwiLCBmb3JnZXQgY29udGV4dC5hcmcgc2luY2UgaXQgaGFzIGJlZW5cbiAgICAgIC8vIFwiY29uc3VtZWRcIiBieSB0aGUgZGVsZWdhdGUgaXRlcmF0b3IuIElmIGNvbnRleHQubWV0aG9kIHdhc1xuICAgICAgLy8gXCJyZXR1cm5cIiwgYWxsb3cgdGhlIG9yaWdpbmFsIC5yZXR1cm4gY2FsbCB0byBjb250aW51ZSBpbiB0aGVcbiAgICAgIC8vIG91dGVyIGdlbmVyYXRvci5cbiAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCAhPT0gXCJyZXR1cm5cIikge1xuICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZS15aWVsZCB0aGUgcmVzdWx0IHJldHVybmVkIGJ5IHRoZSBkZWxlZ2F0ZSBtZXRob2QuXG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9XG5cbiAgICAvLyBUaGUgZGVsZWdhdGUgaXRlcmF0b3IgaXMgZmluaXNoZWQsIHNvIGZvcmdldCBpdCBhbmQgY29udGludWUgd2l0aFxuICAgIC8vIHRoZSBvdXRlciBnZW5lcmF0b3IuXG4gICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gIH1cblxuICAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZVxuICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuXG4gIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCk7XG5cbiAgR3BbdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JcIjtcblxuICAvLyBBIEdlbmVyYXRvciBzaG91bGQgYWx3YXlzIHJldHVybiBpdHNlbGYgYXMgdGhlIGl0ZXJhdG9yIG9iamVjdCB3aGVuIHRoZVxuICAvLyBAQGl0ZXJhdG9yIGZ1bmN0aW9uIGlzIGNhbGxlZCBvbiBpdC4gU29tZSBicm93c2VycycgaW1wbGVtZW50YXRpb25zIG9mIHRoZVxuICAvLyBpdGVyYXRvciBwcm90b3R5cGUgY2hhaW4gaW5jb3JyZWN0bHkgaW1wbGVtZW50IHRoaXMsIGNhdXNpbmcgdGhlIEdlbmVyYXRvclxuICAvLyBvYmplY3QgdG8gbm90IGJlIHJldHVybmVkIGZyb20gdGhpcyBjYWxsLiBUaGlzIGVuc3VyZXMgdGhhdCBkb2Vzbid0IGhhcHBlbi5cbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWdlbmVyYXRvci9pc3N1ZXMvMjc0IGZvciBtb3JlIGRldGFpbHMuXG4gIEdwW2l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEdwLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIFwiW29iamVjdCBHZW5lcmF0b3JdXCI7XG4gIH07XG5cbiAgZnVuY3Rpb24gcHVzaFRyeUVudHJ5KGxvY3MpIHtcbiAgICB2YXIgZW50cnkgPSB7IHRyeUxvYzogbG9jc1swXSB9O1xuXG4gICAgaWYgKDEgaW4gbG9jcykge1xuICAgICAgZW50cnkuY2F0Y2hMb2MgPSBsb2NzWzFdO1xuICAgIH1cblxuICAgIGlmICgyIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmZpbmFsbHlMb2MgPSBsb2NzWzJdO1xuICAgICAgZW50cnkuYWZ0ZXJMb2MgPSBsb2NzWzNdO1xuICAgIH1cblxuICAgIHRoaXMudHJ5RW50cmllcy5wdXNoKGVudHJ5KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlc2V0VHJ5RW50cnkoZW50cnkpIHtcbiAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbiB8fCB7fTtcbiAgICByZWNvcmQudHlwZSA9IFwibm9ybWFsXCI7XG4gICAgZGVsZXRlIHJlY29yZC5hcmc7XG4gICAgZW50cnkuY29tcGxldGlvbiA9IHJlY29yZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIENvbnRleHQodHJ5TG9jc0xpc3QpIHtcbiAgICAvLyBUaGUgcm9vdCBlbnRyeSBvYmplY3QgKGVmZmVjdGl2ZWx5IGEgdHJ5IHN0YXRlbWVudCB3aXRob3V0IGEgY2F0Y2hcbiAgICAvLyBvciBhIGZpbmFsbHkgYmxvY2spIGdpdmVzIHVzIGEgcGxhY2UgdG8gc3RvcmUgdmFsdWVzIHRocm93biBmcm9tXG4gICAgLy8gbG9jYXRpb25zIHdoZXJlIHRoZXJlIGlzIG5vIGVuY2xvc2luZyB0cnkgc3RhdGVtZW50LlxuICAgIHRoaXMudHJ5RW50cmllcyA9IFt7IHRyeUxvYzogXCJyb290XCIgfV07XG4gICAgdHJ5TG9jc0xpc3QuZm9yRWFjaChwdXNoVHJ5RW50cnksIHRoaXMpO1xuICAgIHRoaXMucmVzZXQodHJ1ZSk7XG4gIH1cblxuICBydW50aW1lLmtleXMgPSBmdW5jdGlvbihvYmplY3QpIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHtcbiAgICAgIGtleXMucHVzaChrZXkpO1xuICAgIH1cbiAgICBrZXlzLnJldmVyc2UoKTtcblxuICAgIC8vIFJhdGhlciB0aGFuIHJldHVybmluZyBhbiBvYmplY3Qgd2l0aCBhIG5leHQgbWV0aG9kLCB3ZSBrZWVwXG4gICAgLy8gdGhpbmdzIHNpbXBsZSBhbmQgcmV0dXJuIHRoZSBuZXh0IGZ1bmN0aW9uIGl0c2VsZi5cbiAgICByZXR1cm4gZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgIHdoaWxlIChrZXlzLmxlbmd0aCkge1xuICAgICAgICB2YXIga2V5ID0ga2V5cy5wb3AoKTtcbiAgICAgICAgaWYgKGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICBuZXh0LnZhbHVlID0ga2V5O1xuICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRvIGF2b2lkIGNyZWF0aW5nIGFuIGFkZGl0aW9uYWwgb2JqZWN0LCB3ZSBqdXN0IGhhbmcgdGhlIC52YWx1ZVxuICAgICAgLy8gYW5kIC5kb25lIHByb3BlcnRpZXMgb2ZmIHRoZSBuZXh0IGZ1bmN0aW9uIG9iamVjdCBpdHNlbGYuIFRoaXNcbiAgICAgIC8vIGFsc28gZW5zdXJlcyB0aGF0IHRoZSBtaW5pZmllciB3aWxsIG5vdCBhbm9ueW1pemUgdGhlIGZ1bmN0aW9uLlxuICAgICAgbmV4dC5kb25lID0gdHJ1ZTtcbiAgICAgIHJldHVybiBuZXh0O1xuICAgIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gdmFsdWVzKGl0ZXJhYmxlKSB7XG4gICAgaWYgKGl0ZXJhYmxlKSB7XG4gICAgICB2YXIgaXRlcmF0b3JNZXRob2QgPSBpdGVyYWJsZVtpdGVyYXRvclN5bWJvbF07XG4gICAgICBpZiAoaXRlcmF0b3JNZXRob2QpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhdG9yTWV0aG9kLmNhbGwoaXRlcmFibGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGl0ZXJhYmxlLm5leHQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gaXRlcmFibGU7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXNOYU4oaXRlcmFibGUubGVuZ3RoKSkge1xuICAgICAgICB2YXIgaSA9IC0xLCBuZXh0ID0gZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgICB3aGlsZSAoKytpIDwgaXRlcmFibGUubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoaGFzT3duLmNhbGwoaXRlcmFibGUsIGkpKSB7XG4gICAgICAgICAgICAgIG5leHQudmFsdWUgPSBpdGVyYWJsZVtpXTtcbiAgICAgICAgICAgICAgbmV4dC5kb25lID0gZmFsc2U7XG4gICAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIG5leHQudmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgbmV4dC5kb25lID0gdHJ1ZTtcblxuICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBuZXh0Lm5leHQgPSBuZXh0O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldHVybiBhbiBpdGVyYXRvciB3aXRoIG5vIHZhbHVlcy5cbiAgICByZXR1cm4geyBuZXh0OiBkb25lUmVzdWx0IH07XG4gIH1cbiAgcnVudGltZS52YWx1ZXMgPSB2YWx1ZXM7XG5cbiAgZnVuY3Rpb24gZG9uZVJlc3VsdCgpIHtcbiAgICByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlIH07XG4gIH1cblxuICBDb250ZXh0LnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogQ29udGV4dCxcblxuICAgIHJlc2V0OiBmdW5jdGlvbihza2lwVGVtcFJlc2V0KSB7XG4gICAgICB0aGlzLnByZXYgPSAwO1xuICAgICAgdGhpcy5uZXh0ID0gMDtcbiAgICAgIC8vIFJlc2V0dGluZyBjb250ZXh0Ll9zZW50IGZvciBsZWdhY3kgc3VwcG9ydCBvZiBCYWJlbCdzXG4gICAgICAvLyBmdW5jdGlvbi5zZW50IGltcGxlbWVudGF0aW9uLlxuICAgICAgdGhpcy5zZW50ID0gdGhpcy5fc2VudCA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuICAgICAgdGhpcy5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIHRoaXMubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICB0aGlzLmFyZyA9IHVuZGVmaW5lZDtcblxuICAgICAgdGhpcy50cnlFbnRyaWVzLmZvckVhY2gocmVzZXRUcnlFbnRyeSk7XG5cbiAgICAgIGlmICghc2tpcFRlbXBSZXNldCkge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMpIHtcbiAgICAgICAgICAvLyBOb3Qgc3VyZSBhYm91dCB0aGUgb3B0aW1hbCBvcmRlciBvZiB0aGVzZSBjb25kaXRpb25zOlxuICAgICAgICAgIGlmIChuYW1lLmNoYXJBdCgwKSA9PT0gXCJ0XCIgJiZcbiAgICAgICAgICAgICAgaGFzT3duLmNhbGwodGhpcywgbmFtZSkgJiZcbiAgICAgICAgICAgICAgIWlzTmFOKCtuYW1lLnNsaWNlKDEpKSkge1xuICAgICAgICAgICAgdGhpc1tuYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuXG4gICAgICB2YXIgcm9vdEVudHJ5ID0gdGhpcy50cnlFbnRyaWVzWzBdO1xuICAgICAgdmFyIHJvb3RSZWNvcmQgPSByb290RW50cnkuY29tcGxldGlvbjtcbiAgICAgIGlmIChyb290UmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICB0aHJvdyByb290UmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucnZhbDtcbiAgICB9LFxuXG4gICAgZGlzcGF0Y2hFeGNlcHRpb246IGZ1bmN0aW9uKGV4Y2VwdGlvbikge1xuICAgICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgICB0aHJvdyBleGNlcHRpb247XG4gICAgICB9XG5cbiAgICAgIHZhciBjb250ZXh0ID0gdGhpcztcbiAgICAgIGZ1bmN0aW9uIGhhbmRsZShsb2MsIGNhdWdodCkge1xuICAgICAgICByZWNvcmQudHlwZSA9IFwidGhyb3dcIjtcbiAgICAgICAgcmVjb3JkLmFyZyA9IGV4Y2VwdGlvbjtcbiAgICAgICAgY29udGV4dC5uZXh0ID0gbG9jO1xuXG4gICAgICAgIGlmIChjYXVnaHQpIHtcbiAgICAgICAgICAvLyBJZiB0aGUgZGlzcGF0Y2hlZCBleGNlcHRpb24gd2FzIGNhdWdodCBieSBhIGNhdGNoIGJsb2NrLFxuICAgICAgICAgIC8vIHRoZW4gbGV0IHRoYXQgY2F0Y2ggYmxvY2sgaGFuZGxlIHRoZSBleGNlcHRpb24gbm9ybWFsbHkuXG4gICAgICAgICAgY29udGV4dC5tZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgICBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAhISBjYXVnaHQ7XG4gICAgICB9XG5cbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjtcblxuICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSBcInJvb3RcIikge1xuICAgICAgICAgIC8vIEV4Y2VwdGlvbiB0aHJvd24gb3V0c2lkZSBvZiBhbnkgdHJ5IGJsb2NrIHRoYXQgY291bGQgaGFuZGxlXG4gICAgICAgICAgLy8gaXQsIHNvIHNldCB0aGUgY29tcGxldGlvbiB2YWx1ZSBvZiB0aGUgZW50aXJlIGZ1bmN0aW9uIHRvXG4gICAgICAgICAgLy8gdGhyb3cgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAgICByZXR1cm4gaGFuZGxlKFwiZW5kXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYpIHtcbiAgICAgICAgICB2YXIgaGFzQ2F0Y2ggPSBoYXNPd24uY2FsbChlbnRyeSwgXCJjYXRjaExvY1wiKTtcbiAgICAgICAgICB2YXIgaGFzRmluYWxseSA9IGhhc093bi5jYWxsKGVudHJ5LCBcImZpbmFsbHlMb2NcIik7XG5cbiAgICAgICAgICBpZiAoaGFzQ2F0Y2ggJiYgaGFzRmluYWxseSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0NhdGNoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHlcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIGFicnVwdDogZnVuY3Rpb24odHlwZSwgYXJnKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYgJiZcbiAgICAgICAgICAgIGhhc093bi5jYWxsKGVudHJ5LCBcImZpbmFsbHlMb2NcIikgJiZcbiAgICAgICAgICAgIHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICB2YXIgZmluYWxseUVudHJ5ID0gZW50cnk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSAmJlxuICAgICAgICAgICh0eXBlID09PSBcImJyZWFrXCIgfHxcbiAgICAgICAgICAgdHlwZSA9PT0gXCJjb250aW51ZVwiKSAmJlxuICAgICAgICAgIGZpbmFsbHlFbnRyeS50cnlMb2MgPD0gYXJnICYmXG4gICAgICAgICAgYXJnIDw9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgIC8vIElnbm9yZSB0aGUgZmluYWxseSBlbnRyeSBpZiBjb250cm9sIGlzIG5vdCBqdW1waW5nIHRvIGFcbiAgICAgICAgLy8gbG9jYXRpb24gb3V0c2lkZSB0aGUgdHJ5L2NhdGNoIGJsb2NrLlxuICAgICAgICBmaW5hbGx5RW50cnkgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVjb3JkID0gZmluYWxseUVudHJ5ID8gZmluYWxseUVudHJ5LmNvbXBsZXRpb24gOiB7fTtcbiAgICAgIHJlY29yZC50eXBlID0gdHlwZTtcbiAgICAgIHJlY29yZC5hcmcgPSBhcmc7XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkpIHtcbiAgICAgICAgdGhpcy5tZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgdGhpcy5uZXh0ID0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2M7XG4gICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5jb21wbGV0ZShyZWNvcmQpO1xuICAgIH0sXG5cbiAgICBjb21wbGV0ZTogZnVuY3Rpb24ocmVjb3JkLCBhZnRlckxvYykge1xuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcImJyZWFrXCIgfHxcbiAgICAgICAgICByZWNvcmQudHlwZSA9PT0gXCJjb250aW51ZVwiKSB7XG4gICAgICAgIHRoaXMubmV4dCA9IHJlY29yZC5hcmc7XG4gICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcInJldHVyblwiKSB7XG4gICAgICAgIHRoaXMucnZhbCA9IHRoaXMuYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgdGhpcy5tZXRob2QgPSBcInJldHVyblwiO1xuICAgICAgICB0aGlzLm5leHQgPSBcImVuZFwiO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIiAmJiBhZnRlckxvYykge1xuICAgICAgICB0aGlzLm5leHQgPSBhZnRlckxvYztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfSxcblxuICAgIGZpbmlzaDogZnVuY3Rpb24oZmluYWxseUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS5maW5hbGx5TG9jID09PSBmaW5hbGx5TG9jKSB7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZShlbnRyeS5jb21wbGV0aW9uLCBlbnRyeS5hZnRlckxvYyk7XG4gICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgXCJjYXRjaFwiOiBmdW5jdGlvbih0cnlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSB0cnlMb2MpIHtcbiAgICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjtcbiAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgdmFyIHRocm93biA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRocm93bjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUaGUgY29udGV4dC5jYXRjaCBtZXRob2QgbXVzdCBvbmx5IGJlIGNhbGxlZCB3aXRoIGEgbG9jYXRpb25cbiAgICAgIC8vIGFyZ3VtZW50IHRoYXQgY29ycmVzcG9uZHMgdG8gYSBrbm93biBjYXRjaCBibG9jay5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdFwiKTtcbiAgICB9LFxuXG4gICAgZGVsZWdhdGVZaWVsZDogZnVuY3Rpb24oaXRlcmFibGUsIHJlc3VsdE5hbWUsIG5leHRMb2MpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSB7XG4gICAgICAgIGl0ZXJhdG9yOiB2YWx1ZXMoaXRlcmFibGUpLFxuICAgICAgICByZXN1bHROYW1lOiByZXN1bHROYW1lLFxuICAgICAgICBuZXh0TG9jOiBuZXh0TG9jXG4gICAgICB9O1xuXG4gICAgICBpZiAodGhpcy5tZXRob2QgPT09IFwibmV4dFwiKSB7XG4gICAgICAgIC8vIERlbGliZXJhdGVseSBmb3JnZXQgdGhlIGxhc3Qgc2VudCB2YWx1ZSBzbyB0aGF0IHdlIGRvbid0XG4gICAgICAgIC8vIGFjY2lkZW50YWxseSBwYXNzIGl0IG9uIHRvIHRoZSBkZWxlZ2F0ZS5cbiAgICAgICAgdGhpcy5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cbiAgfTtcbn0pKFxuICAvLyBJbiBzbG9wcHkgbW9kZSwgdW5ib3VuZCBgdGhpc2AgcmVmZXJzIHRvIHRoZSBnbG9iYWwgb2JqZWN0LCBmYWxsYmFjayB0b1xuICAvLyBGdW5jdGlvbiBjb25zdHJ1Y3RvciBpZiB3ZSdyZSBpbiBnbG9iYWwgc3RyaWN0IG1vZGUuIFRoYXQgaXMgc2FkbHkgYSBmb3JtXG4gIC8vIG9mIGluZGlyZWN0IGV2YWwgd2hpY2ggdmlvbGF0ZXMgQ29udGVudCBTZWN1cml0eSBQb2xpY3kuXG4gIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMgfSkoKSB8fCBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKClcbik7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///280\n')},function(module,exports,__webpack_require__){eval("/* WEBPACK VAR INJECTION */(function(process) {// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n};\n\n\nexports.basename = function(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\n\nexports.extname = function(path) {\n  return splitPath(path)[3];\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(282)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL3BhdGgtYnJvd3NlcmlmeS9pbmRleC5qcz9kZjdjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG4vLyByZXNvbHZlcyAuIGFuZCAuLiBlbGVtZW50cyBpbiBhIHBhdGggYXJyYXkgd2l0aCBkaXJlY3RvcnkgbmFtZXMgdGhlcmVcbi8vIG11c3QgYmUgbm8gc2xhc2hlcywgZW1wdHkgZWxlbWVudHMsIG9yIGRldmljZSBuYW1lcyAoYzpcXCkgaW4gdGhlIGFycmF5XG4vLyAoc28gYWxzbyBubyBsZWFkaW5nIGFuZCB0cmFpbGluZyBzbGFzaGVzIC0gaXQgZG9lcyBub3QgZGlzdGluZ3Vpc2hcbi8vIHJlbGF0aXZlIGFuZCBhYnNvbHV0ZSBwYXRocylcbmZ1bmN0aW9uIG5vcm1hbGl6ZUFycmF5KHBhcnRzLCBhbGxvd0Fib3ZlUm9vdCkge1xuICAvLyBpZiB0aGUgcGF0aCB0cmllcyB0byBnbyBhYm92ZSB0aGUgcm9vdCwgYHVwYCBlbmRzIHVwID4gMFxuICB2YXIgdXAgPSAwO1xuICBmb3IgKHZhciBpID0gcGFydHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICB2YXIgbGFzdCA9IHBhcnRzW2ldO1xuICAgIGlmIChsYXN0ID09PSAnLicpIHtcbiAgICAgIHBhcnRzLnNwbGljZShpLCAxKTtcbiAgICB9IGVsc2UgaWYgKGxhc3QgPT09ICcuLicpIHtcbiAgICAgIHBhcnRzLnNwbGljZShpLCAxKTtcbiAgICAgIHVwKys7XG4gICAgfSBlbHNlIGlmICh1cCkge1xuICAgICAgcGFydHMuc3BsaWNlKGksIDEpO1xuICAgICAgdXAtLTtcbiAgICB9XG4gIH1cblxuICAvLyBpZiB0aGUgcGF0aCBpcyBhbGxvd2VkIHRvIGdvIGFib3ZlIHRoZSByb290LCByZXN0b3JlIGxlYWRpbmcgLi5zXG4gIGlmIChhbGxvd0Fib3ZlUm9vdCkge1xuICAgIGZvciAoOyB1cC0tOyB1cCkge1xuICAgICAgcGFydHMudW5zaGlmdCgnLi4nKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcGFydHM7XG59XG5cbi8vIFNwbGl0IGEgZmlsZW5hbWUgaW50byBbcm9vdCwgZGlyLCBiYXNlbmFtZSwgZXh0XSwgdW5peCB2ZXJzaW9uXG4vLyAncm9vdCcgaXMganVzdCBhIHNsYXNoLCBvciBub3RoaW5nLlxudmFyIHNwbGl0UGF0aFJlID1cbiAgICAvXihcXC8/fCkoW1xcc1xcU10qPykoKD86XFwuezEsMn18W15cXC9dKz98KShcXC5bXi5cXC9dKnwpKSg/OltcXC9dKikkLztcbnZhciBzcGxpdFBhdGggPSBmdW5jdGlvbihmaWxlbmFtZSkge1xuICByZXR1cm4gc3BsaXRQYXRoUmUuZXhlYyhmaWxlbmFtZSkuc2xpY2UoMSk7XG59O1xuXG4vLyBwYXRoLnJlc29sdmUoW2Zyb20gLi4uXSwgdG8pXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLnJlc29sdmUgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHJlc29sdmVkUGF0aCA9ICcnLFxuICAgICAgcmVzb2x2ZWRBYnNvbHV0ZSA9IGZhbHNlO1xuXG4gIGZvciAodmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoIC0gMTsgaSA+PSAtMSAmJiAhcmVzb2x2ZWRBYnNvbHV0ZTsgaS0tKSB7XG4gICAgdmFyIHBhdGggPSAoaSA+PSAwKSA/IGFyZ3VtZW50c1tpXSA6IHByb2Nlc3MuY3dkKCk7XG5cbiAgICAvLyBTa2lwIGVtcHR5IGFuZCBpbnZhbGlkIGVudHJpZXNcbiAgICBpZiAodHlwZW9mIHBhdGggIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgdG8gcGF0aC5yZXNvbHZlIG11c3QgYmUgc3RyaW5ncycpO1xuICAgIH0gZWxzZSBpZiAoIXBhdGgpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIHJlc29sdmVkUGF0aCA9IHBhdGggKyAnLycgKyByZXNvbHZlZFBhdGg7XG4gICAgcmVzb2x2ZWRBYnNvbHV0ZSA9IHBhdGguY2hhckF0KDApID09PSAnLyc7XG4gIH1cblxuICAvLyBBdCB0aGlzIHBvaW50IHRoZSBwYXRoIHNob3VsZCBiZSByZXNvbHZlZCB0byBhIGZ1bGwgYWJzb2x1dGUgcGF0aCwgYnV0XG4gIC8vIGhhbmRsZSByZWxhdGl2ZSBwYXRocyB0byBiZSBzYWZlIChtaWdodCBoYXBwZW4gd2hlbiBwcm9jZXNzLmN3ZCgpIGZhaWxzKVxuXG4gIC8vIE5vcm1hbGl6ZSB0aGUgcGF0aFxuICByZXNvbHZlZFBhdGggPSBub3JtYWxpemVBcnJheShmaWx0ZXIocmVzb2x2ZWRQYXRoLnNwbGl0KCcvJyksIGZ1bmN0aW9uKHApIHtcbiAgICByZXR1cm4gISFwO1xuICB9KSwgIXJlc29sdmVkQWJzb2x1dGUpLmpvaW4oJy8nKTtcblxuICByZXR1cm4gKChyZXNvbHZlZEFic29sdXRlID8gJy8nIDogJycpICsgcmVzb2x2ZWRQYXRoKSB8fCAnLic7XG59O1xuXG4vLyBwYXRoLm5vcm1hbGl6ZShwYXRoKVxuLy8gcG9zaXggdmVyc2lvblxuZXhwb3J0cy5ub3JtYWxpemUgPSBmdW5jdGlvbihwYXRoKSB7XG4gIHZhciBpc0Fic29sdXRlID0gZXhwb3J0cy5pc0Fic29sdXRlKHBhdGgpLFxuICAgICAgdHJhaWxpbmdTbGFzaCA9IHN1YnN0cihwYXRoLCAtMSkgPT09ICcvJztcblxuICAvLyBOb3JtYWxpemUgdGhlIHBhdGhcbiAgcGF0aCA9IG5vcm1hbGl6ZUFycmF5KGZpbHRlcihwYXRoLnNwbGl0KCcvJyksIGZ1bmN0aW9uKHApIHtcbiAgICByZXR1cm4gISFwO1xuICB9KSwgIWlzQWJzb2x1dGUpLmpvaW4oJy8nKTtcblxuICBpZiAoIXBhdGggJiYgIWlzQWJzb2x1dGUpIHtcbiAgICBwYXRoID0gJy4nO1xuICB9XG4gIGlmIChwYXRoICYmIHRyYWlsaW5nU2xhc2gpIHtcbiAgICBwYXRoICs9ICcvJztcbiAgfVxuXG4gIHJldHVybiAoaXNBYnNvbHV0ZSA/ICcvJyA6ICcnKSArIHBhdGg7XG59O1xuXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLmlzQWJzb2x1dGUgPSBmdW5jdGlvbihwYXRoKSB7XG4gIHJldHVybiBwYXRoLmNoYXJBdCgwKSA9PT0gJy8nO1xufTtcblxuLy8gcG9zaXggdmVyc2lvblxuZXhwb3J0cy5qb2luID0gZnVuY3Rpb24oKSB7XG4gIHZhciBwYXRocyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG4gIHJldHVybiBleHBvcnRzLm5vcm1hbGl6ZShmaWx0ZXIocGF0aHMsIGZ1bmN0aW9uKHAsIGluZGV4KSB7XG4gICAgaWYgKHR5cGVvZiBwICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIHRvIHBhdGguam9pbiBtdXN0IGJlIHN0cmluZ3MnKTtcbiAgICB9XG4gICAgcmV0dXJuIHA7XG4gIH0pLmpvaW4oJy8nKSk7XG59O1xuXG5cbi8vIHBhdGgucmVsYXRpdmUoZnJvbSwgdG8pXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLnJlbGF0aXZlID0gZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgZnJvbSA9IGV4cG9ydHMucmVzb2x2ZShmcm9tKS5zdWJzdHIoMSk7XG4gIHRvID0gZXhwb3J0cy5yZXNvbHZlKHRvKS5zdWJzdHIoMSk7XG5cbiAgZnVuY3Rpb24gdHJpbShhcnIpIHtcbiAgICB2YXIgc3RhcnQgPSAwO1xuICAgIGZvciAoOyBzdGFydCA8IGFyci5sZW5ndGg7IHN0YXJ0KyspIHtcbiAgICAgIGlmIChhcnJbc3RhcnRdICE9PSAnJykgYnJlYWs7XG4gICAgfVxuXG4gICAgdmFyIGVuZCA9IGFyci5sZW5ndGggLSAxO1xuICAgIGZvciAoOyBlbmQgPj0gMDsgZW5kLS0pIHtcbiAgICAgIGlmIChhcnJbZW5kXSAhPT0gJycpIGJyZWFrO1xuICAgIH1cblxuICAgIGlmIChzdGFydCA+IGVuZCkgcmV0dXJuIFtdO1xuICAgIHJldHVybiBhcnIuc2xpY2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7XG4gIH1cblxuICB2YXIgZnJvbVBhcnRzID0gdHJpbShmcm9tLnNwbGl0KCcvJykpO1xuICB2YXIgdG9QYXJ0cyA9IHRyaW0odG8uc3BsaXQoJy8nKSk7XG5cbiAgdmFyIGxlbmd0aCA9IE1hdGgubWluKGZyb21QYXJ0cy5sZW5ndGgsIHRvUGFydHMubGVuZ3RoKTtcbiAgdmFyIHNhbWVQYXJ0c0xlbmd0aCA9IGxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGlmIChmcm9tUGFydHNbaV0gIT09IHRvUGFydHNbaV0pIHtcbiAgICAgIHNhbWVQYXJ0c0xlbmd0aCA9IGk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICB2YXIgb3V0cHV0UGFydHMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IHNhbWVQYXJ0c0xlbmd0aDsgaSA8IGZyb21QYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgIG91dHB1dFBhcnRzLnB1c2goJy4uJyk7XG4gIH1cblxuICBvdXRwdXRQYXJ0cyA9IG91dHB1dFBhcnRzLmNvbmNhdCh0b1BhcnRzLnNsaWNlKHNhbWVQYXJ0c0xlbmd0aCkpO1xuXG4gIHJldHVybiBvdXRwdXRQYXJ0cy5qb2luKCcvJyk7XG59O1xuXG5leHBvcnRzLnNlcCA9ICcvJztcbmV4cG9ydHMuZGVsaW1pdGVyID0gJzonO1xuXG5leHBvcnRzLmRpcm5hbWUgPSBmdW5jdGlvbihwYXRoKSB7XG4gIHZhciByZXN1bHQgPSBzcGxpdFBhdGgocGF0aCksXG4gICAgICByb290ID0gcmVzdWx0WzBdLFxuICAgICAgZGlyID0gcmVzdWx0WzFdO1xuXG4gIGlmICghcm9vdCAmJiAhZGlyKSB7XG4gICAgLy8gTm8gZGlybmFtZSB3aGF0c29ldmVyXG4gICAgcmV0dXJuICcuJztcbiAgfVxuXG4gIGlmIChkaXIpIHtcbiAgICAvLyBJdCBoYXMgYSBkaXJuYW1lLCBzdHJpcCB0cmFpbGluZyBzbGFzaFxuICAgIGRpciA9IGRpci5zdWJzdHIoMCwgZGlyLmxlbmd0aCAtIDEpO1xuICB9XG5cbiAgcmV0dXJuIHJvb3QgKyBkaXI7XG59O1xuXG5cbmV4cG9ydHMuYmFzZW5hbWUgPSBmdW5jdGlvbihwYXRoLCBleHQpIHtcbiAgdmFyIGYgPSBzcGxpdFBhdGgocGF0aClbMl07XG4gIC8vIFRPRE86IG1ha2UgdGhpcyBjb21wYXJpc29uIGNhc2UtaW5zZW5zaXRpdmUgb24gd2luZG93cz9cbiAgaWYgKGV4dCAmJiBmLnN1YnN0cigtMSAqIGV4dC5sZW5ndGgpID09PSBleHQpIHtcbiAgICBmID0gZi5zdWJzdHIoMCwgZi5sZW5ndGggLSBleHQubGVuZ3RoKTtcbiAgfVxuICByZXR1cm4gZjtcbn07XG5cblxuZXhwb3J0cy5leHRuYW1lID0gZnVuY3Rpb24ocGF0aCkge1xuICByZXR1cm4gc3BsaXRQYXRoKHBhdGgpWzNdO1xufTtcblxuZnVuY3Rpb24gZmlsdGVyICh4cywgZikge1xuICAgIGlmICh4cy5maWx0ZXIpIHJldHVybiB4cy5maWx0ZXIoZik7XG4gICAgdmFyIHJlcyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGYoeHNbaV0sIGksIHhzKSkgcmVzLnB1c2goeHNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuXG4vLyBTdHJpbmcucHJvdG90eXBlLnN1YnN0ciAtIG5lZ2F0aXZlIGluZGV4IGRvbid0IHdvcmsgaW4gSUU4XG52YXIgc3Vic3RyID0gJ2FiJy5zdWJzdHIoLTEpID09PSAnYidcbiAgICA/IGZ1bmN0aW9uIChzdHIsIHN0YXJ0LCBsZW4pIHsgcmV0dXJuIHN0ci5zdWJzdHIoc3RhcnQsIGxlbikgfVxuICAgIDogZnVuY3Rpb24gKHN0ciwgc3RhcnQsIGxlbikge1xuICAgICAgICBpZiAoc3RhcnQgPCAwKSBzdGFydCA9IHN0ci5sZW5ndGggKyBzdGFydDtcbiAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHIoc3RhcnQsIGxlbik7XG4gICAgfVxuO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///281\n")},function(module,exports){eval("// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcz9mMjhjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///282\n")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/loglevel/lib/loglevel.js\nvar loglevel = __webpack_require__(0);\nvar loglevel_default = /*#__PURE__*/__webpack_require__.n(loglevel);\n\n// CONCATENATED MODULE: ./src/logLevels.js\n\nvar a = loglevel_default.a.getLogger('address-allocation');\nvar b = loglevel_default.a.getLogger('Bus');\nvar c = loglevel_default.a.getLogger('MessageBus');\nvar d = loglevel_default.a.getLogger('CoreDiscovery');\nvar e = loglevel_default.a.getLogger('StorageManager');\nvar f = loglevel_default.a.getLogger('HypertyResourcesStorage');\nvar g = loglevel_default.a.getLogger('IdentityModule');\nvar h = loglevel_default.a.getLogger('PEP');\nvar logLevels_i = loglevel_default.a.getLogger('P2PConnectionResolve');\nvar j = loglevel_default.a.getLogger('Registry');\nvar k = loglevel_default.a.getLogger('RuntimeUA');\nvar l = loglevel_default.a.getLogger('Loader');\nvar m = loglevel_default.a.getLogger('Descriptors');\nvar n = loglevel_default.a.getLogger('DataObjectsStorage');\nvar o = loglevel_default.a.getLogger('Subscription');\nvar p = loglevel_default.a.getLogger('SubscriptionManager');\nvar q = loglevel_default.a.getLogger('ObserverObject');\nvar r = loglevel_default.a.getLogger('ReporterObject');\nvar s = loglevel_default.a.getLogger('SynSubscription');\nvar t = loglevel_default.a.getLogger('SyncherManager');\nvar u = loglevel_default.a.getLogger('IdentityHandler');\nvar v = loglevel_default.a.getLogger('CryptoManager');\nvar x = loglevel_default.a.getLogger('Pipeline');\nvar f1 = loglevel_default.a.getLogger('Syncher');\nvar f2 = loglevel_default.a.getLogger('RuntimeCatalogue');\n\n/**\r\n  0 actual logging methods, ordered and available as:\r\n\r\n      0 - log.trace(msg)\r\n      1 - log.debug(msg)\r\n      2 - log.info(msg)\r\n      3 - log.warn(msg)\r\n      4 - log.error(msg)\r\n\r\n  log.log(msg) is also available, as an alias for log.debug(msg), to improve compatibility with console, and make migration easier.\r\n\r\n  Exact output formatting of these will depend on the console available in the current context of your application. For example, many environments will include a full stack trace with all trace() calls, and icons or similar to highlight other calls.\r\n\r\n  These methods should never fail in any environment, even if no console object is currently available, and should always fall back to an available log method even if the specific method called (e.g. warn) isn't available.\r\n\r\n  Be aware that all this means that these method won't necessarily always produce exactly the output you expect in every environment; loglevel only guarantees that these methods will never explode on you, and that it will call the most relevant method it can find, with your argument. Firefox is a notable example here: due to a current Firefox bug log.trace(msg) calls in Firefox will print only the stacktrace, and won't include any passed message arguments.\r\n\r\n*/\n// address-allocation\n\na.setLevel(0); // Bus\n\nb.setLevel(3); // MessageBus\n\nc.setLevel(3); // CoreDiscovery\n\nd.setLevel(5); // StorageManager\n\ne.setLevel(0); // HypertyResourcesStorage\n\nf.setLevel(3); // IdentityModule\n\ng.setLevel(0); // PEP\n\nh.setLevel(3); // P2PConnectionResolve\n\nlogLevels_i.setLevel(3); // Registry\n\nj.setLevel(0); // RuntimeUA\n\nk.setLevel(0); // Loader\n\nl.setLevel(0); // Descriptors\n\nm.setLevel(3); // DataObjectsStorage\n\nn.setLevel(0); // Subscription\n\no.setLevel(3); // SubscriptionManager\n\np.setLevel(3); // ObserverObject\n\nq.setLevel(0); // ReporterObject\n\nr.setLevel(0); // SynSubscription\n\ns.setLevel(3); // SyncherManager\n\nt.setLevel(0); // IdentityHandler\n\nu.setLevel(3); // CryptoManager\n\nv.setLevel(0); // Pipeline\n\nx.setLevel(0); // Syncher\n\nf1.setLevel(0); // Syncher DataObjectObserver\n\nf1.setLevel(0); // RuntimeCatalogue\n\nf2.setLevel(0);\n// CONCATENATED MODULE: ./src/runtime/runtimeUtils.js\nvar runtimeUtils = {\n  runtimeDescriptor: {},\n  runtimeCapabilities: {\n    constraints: {}\n  }\n};\n// CONCATENATED MODULE: ./src/utils/utils.js\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n * Support module with some functions will be useful\r\n * @module utils\r\n */\n\n/**\r\n * @typedef divideURL\r\n * @type Object\r\n * @property {string} type The type of URL\r\n * @property {string} domain The domain of URL\r\n * @property {string} identity The identity of URL\r\n */\n\n/**\r\n * Divide an url in type, domain and identity\r\n * @param  {URL.URL} url - url address\r\n * @return {divideURL} the result of divideURL\r\n */\nfunction divideURL(url) {\n  function recurse(value) {\n    var regex = /([a-zA-Z-]*)(:\\/\\/(?:\\.)?|:)([-a-zA-Z0-9@:%._+~#=]{2,256})([-a-zA-Z0-9@:%._+~#=/]*)/gi;\n    var subst = '$1,$3,$4';\n    var parts = value.replace(regex, subst).split(',');\n    return parts;\n  }\n\n  var parts = recurse(url); // If the url has no scheme\n\n  if (parts[0] === url && !parts[0].includes('@')) {\n    var _result = {\n      type: '',\n      domain: url,\n      identity: ''\n    };\n    console.warn('[DivideURL] DivideURL don\\'t support url without scheme. Please review your url address', url);\n    return _result;\n  } // check if the url has the scheme and includes an @\n\n\n  if (parts[0] === url && parts[0].includes('@')) {\n    var scheme = parts[0] === url ? 'smtp' : parts[0];\n    parts = recurse(scheme + '://' + parts[0]);\n  } // if the domain includes an @, divide it to domain and identity respectively\n\n\n  if (parts[1].includes('@')) {\n    parts[2] = parts[0] + '://' + parts[1];\n    parts[1] = parts[1].substr(parts[1].indexOf('@') + 1);\n  }\n  /*else if (parts[2].includes('/')) {\r\n  parts[2] = parts[2].substr(parts[2].lastIndexOf('/')+1);\r\n  }*/\n\n\n  var result = {\n    type: parts[0],\n    domain: parts[1],\n    identity: parts[2]\n  };\n  return result;\n}\n/**\r\n * Check if an Object is empty\r\n * @param  {Object} object Object to be checked\r\n * @return {Boolean}       status of Object, empty or not (true|false);\r\n */\n\nfunction emptyObject(object) {\n  return Object.keys(object).length > 0 ? false : true;\n}\nfunction secondsSinceEpoch() {\n  return Math.floor(Date.now() / 1000);\n}\n/**\r\n * Make a COPY of the original data\r\n * @param  {Object}  obj - object to be cloned\r\n * @return {Object}\r\n */\n\nfunction deepClone(obj) {\n  //TODO: simple but inefficient JSON deep clone...\n  if (obj) return JSON.parse(JSON.stringify(obj));\n}\nfunction removePathFromURL(url) {\n  var splitURL = url.split('/');\n  return splitURL[0] + '//' + splitURL[2] + '/' + splitURL[3];\n}\n/**\r\n * Obtains the user URL that corresponds to a given email\r\n * @param  {string} userEmail The user email\r\n * @return {URL.URL} userURL The user URL\r\n */\n\nfunction getUserURLFromEmail(userEmail) {\n  var indexOfAt = userEmail.indexOf('@');\n  return 'user://' + userEmail.substring(indexOfAt + 1, userEmail.length) + '/' + userEmail.substring(0, indexOfAt);\n}\n/**\r\n * Obtains the user email that corresponds to a given URL\r\n * @param  {URL.URL} userURL The user URL\r\n * @return {string} userEmail The user email\r\n */\n\nfunction getUserEmailFromURL(userURL) {\n  var url = divideURL(userURL);\n  return url.identity.replace('/', '') + '@' + url.domain; // identity field has '/exampleID' instead of 'exampleID'\n}\n/**\r\n * Check if the user identifier is already in the URL format, if not, convert to URL format\r\n * @param  {string}   identifier  user identifier\r\n * @return {string}   userURL    the user URL\r\n */\n\nfunction convertToUserURL(identifier) {\n  // check if the identifier is already in the url format\n  if (identifier.substring(0, 7) === 'user://') {\n    var dividedURL = divideURL(identifier); //check if the url is well formated\n\n    if (dividedURL.domain && dividedURL.identity) {\n      return identifier;\n    } else {\n      throw 'userURL with wrong format';\n    } //if not, convert the user email to URL format\n\n  } else {\n    return getUserURLFromEmail(identifier);\n  }\n}\nfunction isDataObjectURL(url) {\n  var schemasToIgnore = ['domain-idp', 'runtime', 'domain', 'hyperty'];\n  var splitURL = url.split('://');\n  var urlSchema = splitURL[0];\n  return schemasToIgnore.indexOf(urlSchema) === -1;\n}\nfunction utils_isLegacy(url) {\n  if (url.split('@').length > 1) {\n    return true;\n  } else {\n    return false;\n  }\n}\nfunction isURL(url) {\n  return url.split('/').length >= 3;\n}\nfunction isUserURL(url) {\n  return divideURL(url).type === 'user';\n}\nfunction utils_isHypertyURL(url) {\n  return divideURL(url).type === 'hyperty';\n}\n/**\r\n * get information relative each component configured on runtime configuration;\r\n * @param  {object} configuration object with all configuration\r\n * @param  {string} component     string with the component to get the configuration, like, runtimeURLS, catalogueURLs, msgNodeURL, domainRegistryURL;\r\n * @param  {string} resource      type of resource to get, like, catalogue, runtimeUA, protocolstub, idpProxy\r\n * @return {object}               return an object with all configurations;\r\n */\n\nfunction getConfigurationResources(configuration, component, resource) {\n  var objectResource = configuration[component];\n  var resourceType = objectResource[resource];\n  return resourceType;\n}\n/**\r\n * Build a full url with the runtime configuration;\r\n * @param  {object} configuration object with all configuration\r\n * @param  {string} component     string with the component to get the configuration, like, runtimeURLS, catalogueURLs, msgNodeURL, domainRegistryURL;\r\n * @param  {string} resource      type of resource to get, like, catalogue, runtimeUA, protocolstub, idpProxy\r\n * @param  {string} type          resource to get, like a hyperty name or protocolstub name;\r\n * @param  {boolean} useFallback  if true the function will check if have a fallback url;\r\n * @return {string}               partial url to contact the resource;\r\n */\n\nfunction buildURL(configuration, component, resource, type) {\n  var useFallback = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n  var objectResource = configuration[component];\n  var url;\n\n  if (!objectResource.hasOwnProperty(resource)) {\n    throw Error('The configuration ' + JSON.stringify(objectResource, '', 2) + ' don\\'t have the ' + resource + ' resource you are looking for');\n  }\n\n  var resourceType = objectResource[resource];\n\n  if (type) {\n    url = resourceType.prefix + configuration.domain + resourceType.suffix + type;\n\n    if (resourceType.hasOwnProperty('fallback') && useFallback) {\n      if (resourceType.fallback.indexOf('%domain%')) {\n        url = resourceType.fallback.replace(/(%domain%)/g, configuration.domain) + type;\n      } else {\n        url = resourceType.fallback + type;\n      }\n    }\n  } else {\n    url = resourceType.prefix + configuration.domain + resourceType.suffix;\n  } // console.log(url);\n\n\n  return url;\n}\n/**\r\n * Generate a Global Unique ID\r\n *\r\n * @returns String;\r\n */\n\nfunction generateGUID() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }\n\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\nfunction getUserIdentityDomain(url) {\n  var dividedURL = divideURL(url);\n  var splitedDomain = dividedURL.domain.split('.');\n  var splitedLength = splitedDomain.length;\n\n  if (splitedLength == 1) {\n    return splitedDomain[splitedLength - 1];\n  }\n\n  var domain = splitedDomain[splitedLength - 2] + '.' + splitedDomain[splitedLength - 1];\n  return domain;\n}\n/**\r\n * Check if URL is from a backend service\r\n * @param  {string} url     URL to be processed\r\n * @return {boolean}\r\n */\n\nfunction isBackendServiceURL(url) {\n  var dividedURL = divideURL(url);\n  var splitedDomain = dividedURL.domain.split('.');\n  var backendSchemes = ['domain', 'global', 'domain-idp']; // should be defined in the runtime configuration\n\n  var backendSubDomains = ['registry', 'msg-node']; // should be defined in the runtime configuration\n\n  var subDomain;\n\n  if (splitedDomain.length > 1) {\n    subDomain = splitedDomain.filter(function (item) {\n      return backendSubDomains.indexOf(item) !== -1;\n    })[0];\n  }\n\n  if (subDomain && backendSubDomains.indexOf(subDomain) !== -1) {\n    return true;\n  }\n\n  if (dividedURL.type) {\n    return backendSchemes.indexOf(dividedURL.type) !== -1;\n  }\n\n  return false;\n}\nfunction divideEmail(email) {\n  var indexOfAt = email.indexOf('@');\n  var result = {\n    username: email.substring(0, indexOfAt),\n    domain: email.substring(indexOfAt + 1, email.length)\n  };\n  return result;\n}\nfunction utils_assign(obj, keyPath, value) {\n  if (!obj) obj = {};\n  if (typeof keyPath === 'string') keyPath = parseAttributes(keyPath);\n  var lastKeyIndex = keyPath.length - 1;\n\n  for (var i = 0; i < lastKeyIndex; ++i) {\n    var key = keyPath[i];\n\n    if (!(key in obj)) {\n      obj[key] = {};\n    }\n\n    obj = obj[key];\n  }\n\n  obj[keyPath[lastKeyIndex]] = value;\n}\nfunction splitObjectURL(dataObjectURL) {\n  console.info('[utils - splitObjectURL]: ', dataObjectURL);\n  var splitedURL = dataObjectURL.split('/');\n  var url = splitedURL[0] + '//' + splitedURL[2] + '/' + splitedURL[3];\n  var resource = splitedURL[5];\n  var result = {\n    url: url,\n    resource: resource\n  };\n  console.info('[utils - splitObjectURL]: ', result);\n  return result;\n}\nfunction checkAttribute(path) {\n  var regex = /((([a-zA-Z]+):\\/\\/([0-9a-zA-Z][-\\w]*[0-9a-zA-Z]\\.)+[a-zA-Z]{2,9})\\/[a-zA-Z0-9.]+@[a-zA-Z0-9]+(-)?[a-zA-Z0-9]+(\\.)?[a-zA-Z0-9]{2,10}?\\.[a-zA-Z]{2,10})(.+(?=.identity))?/gm;\n  var list = [];\n  var final = [];\n  var test = path.match(regex);\n\n  if (test == null) {\n    final = path.split('.');\n  } else {\n    var m;\n\n    while ((m = regex.exec(path)) !== null) {\n      // This is necessary to avoid infinite loops with zero-width matches\n      if (m.index === regex.lastIndex) {\n        regex.lastIndex++;\n      } // The result can be accessed through the `m`-variable.\n\n\n      m.forEach(function (match, groupIndex) {\n        if (groupIndex === 0) {\n          list.push(match);\n        }\n      });\n    }\n\n    var result;\n    list.forEach(function (url) {\n      result = path.replace(url, '*-*');\n      final = result.split('.').map(function (item) {\n        if (item === '*-*') {\n          return url;\n        }\n\n        return item;\n      });\n    });\n  }\n\n  console.log('[RuntimeCore.Utils.checkAttribute]', final);\n  return final;\n}\nfunction parseAttributes(path) {\n  var regex = /([0-9a-zA-Z][-\\w]*):\\/\\//g;\n  var string3 = 'identity';\n\n  if (!path.includes('://')) {\n    return path.split('.');\n  } else {\n    var string1 = path.split(regex)[0];\n    var array1 = string1.split('.');\n    var string2 = path.replace(string1, '');\n\n    if (path.includes(string3)) {\n      var array2 = string2.split(string3 + '.');\n      console.log('array2 ' + array2);\n      string2 = array2[0].slice('.', -1);\n      array2 = array2[1].split('.');\n      array1.push(string2, string3);\n      array1 = array1.concat(array2);\n    } else {\n      array1.push(string2);\n    }\n\n    return array1.filter(Boolean);\n  }\n}\nfunction isEmpty(obj) {\n  for (var prop in obj) {\n    if (obj.hasOwnProperty(prop)) {\n      return false;\n    }\n  }\n\n  return JSON.stringify(obj) === JSON.stringify({});\n}\nfunction chatkeysToStringCloner(sessionKeys) {\n  var dataObjectSessionKeysClone = {};\n  var fields = Object.keys(sessionKeys);\n\n  if (fields) {\n    try {\n      for (var i = 0; i < fields.length; i++) {\n        var field = fields[i];\n        dataObjectSessionKeysClone[field] = {};\n        dataObjectSessionKeysClone[field].sessionKey = sessionKeys[field].sessionKey.toString();\n        dataObjectSessionKeysClone[field].isToEncrypt = sessionKeys[field].isToEncrypt;\n      }\n    } catch (err) {\n      console.error('_chatkeysToStringCloner:err', err);\n    }\n  }\n\n  return dataObjectSessionKeysClone;\n}\nfunction chatkeysToArrayCloner(sessionKeys) {\n  var dataObjectSessionKeysClone = {};\n  var fields = Object.keys(sessionKeys);\n\n  if (fields) {\n    try {\n      for (var i = 0; i < fields.length; i++) {\n        var field = fields[i];\n        dataObjectSessionKeysClone[field] = {};\n        var arrayValues = JSON.parse('[' + sessionKeys[field].sessionKey + ']');\n        dataObjectSessionKeysClone[field].sessionKey = new Uint8Array(arrayValues);\n        dataObjectSessionKeysClone[field].isToEncrypt = sessionKeys[field].isToEncrypt;\n      }\n    } catch (err) {\n      console.error('_chatkeysToArrayCloner:err', err);\n    }\n  }\n\n  return dataObjectSessionKeysClone;\n}\nfunction parseMessageURL(URL) {\n  var splitedToURL = URL.split('/');\n\n  if (splitedToURL.length <= 6) {\n    return splitedToURL[0] + '//' + splitedToURL[2] + '/' + splitedToURL[3];\n  } else {\n    return splitedToURL[0] + '//' + splitedToURL[2] + '/' + splitedToURL[3] + '/' + splitedToURL[4];\n  }\n}\nfunction availableSpace(usage, quota) {\n  var available = (usage / quota).toFixed(2);\n  return {\n    quota: quota,\n    usage: usage,\n    percent: Number(available)\n  };\n}\n/**\r\n* Encodes a JS object to base 64 encode\r\n* @param   {Object}    value    byteArray value\r\n* @return  {string}   encoded value\r\n*/\n\nfunction encode(value) {\n  try {\n    var stringValue = stringify(value);\n    return btoa(stringValue);\n  } catch (err) {\n    console.error('[Utils.encode:err] ' + err);\n    throw err;\n  }\n}\n/**\r\n  * Decode a base64 string to object\r\n  * @param   {string_b64}    value    value encoded in base 64\r\n  * @return  {Object} decodedValue\r\n  */\n\nfunction decode(value) {\n  try {\n    return JSON.parse(atob(value));\n  } catch (err) {\n    console.log('[Utils.decode:err] ' + err);\n    throw err;\n  }\n}\n/**\r\n* Decode a base64 string to Uint8Array\r\n* @param   {string_b64}    value    byteArray value\r\n* @return  {Uint8Array}   encoded value\r\n*/\n\nfunction decodeToUint8Array(value) {\n  try {\n    return new Uint8Array(decode(value));\n  } catch (err) {\n    console.error('[Utils.decodeToUint8Array:err] ' + err);\n    throw err;\n  }\n}\n/**\r\n* Converts a JS object to string\r\n* NOTE: Special conversion for Uint8Arrays\r\n* @param   {Object}    value    byteArray value\r\n* @return  {Uint8Array}   encoded value\r\n*/\n\nfunction stringify(value) {\n  try {\n    var stringValue;\n\n    if (value.constructor === Uint8Array) {\n      stringValue = '[' + value.toString() + ']'; // the [] is for JSON.parse compatibility\n    } else {\n      stringValue = JSON.stringify(value);\n    }\n\n    return stringValue;\n  } catch (err) {\n    console.error('[Utils.stringify:err] ' + err);\n    throw err;\n  }\n}\n/**\r\n* Converts a stringified object to object\r\n* @param   {String}    value    byteArray value\r\n* @return  {Object}   encoded value\r\n*/\n\nfunction parse(value) {\n  try {\n    return JSON.parse(value);\n  } catch (err) {\n    console.error('[Utils.parse:err]' + err);\n    console.trace();\n    console.error('That that cause the error:', value);\n    throw err;\n  }\n}\n/**\r\n* Converts a stringified object to object\r\n* @param   {String}    value    byteArray value\r\n* @return  {Uint8Array}   encoded value\r\n*/\n\nfunction parseToUint8Array(value) {\n  try {\n    return new Uint8Array(parse(value));\n  } catch (err) {\n    console.error('[Utils.parseToUint8Array:err]' + err);\n    throw err;\n  }\n}\n// EXTERNAL MODULE: ./node_modules/proxy-observe/index.js\nvar proxy_observe = __webpack_require__(82);\n\n// CONCATENATED MODULE: ./src/syncher/ProxyObject.js\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\nvar ProxyObject_objectType = {\n  ARRAY: '[object Array]',\n  OBJECT: '[object Object]'\n};\n/**\r\n * @access private\r\n * Main class that maintains a JSON object, and observes changes in this object, recursively.\r\n * Internal objects and arrays are also observed.\r\n */\n\nvar ProxyObject_SyncObject =\n/*#__PURE__*/\nfunction () {\n  function SyncObject(initialData) {\n    _classCallCheck(this, SyncObject);\n\n    var _this = this;\n\n    _this._observers = [];\n    _this._filters = {};\n    this._data = initialData || {};\n\n    this._internalObserve(this._data);\n  }\n\n  _createClass(SyncObject, [{\n    key: \"observe\",\n    value: function observe(callback) {\n      this._observers.push(callback);\n    }\n  }, {\n    key: \"find\",\n    value: function find(path) {\n      var list = parseAttributes(path);\n      return this._findWithSplit(list);\n    }\n  }, {\n    key: \"findBefore\",\n    value: function findBefore(path) {\n      var result = {};\n      var list = parseAttributes(path);\n      result.last = list.pop();\n      result.obj = this._findWithSplit(list);\n      return result;\n    }\n  }, {\n    key: \"_findWithSplit\",\n    value: function _findWithSplit(list) {\n      var obj = this._data;\n      list.forEach(function (value) {\n        obj = obj[value];\n      });\n      return obj;\n    }\n  }, {\n    key: \"_internalObserve\",\n    value: function _internalObserve(object) {\n      var _this2 = this;\n\n      var handler = function handler(changeset) {\n        changeset.every(function (change) {\n          _this2._onChanges(change);\n        });\n      };\n\n      this._data = Object.deepObserve(object, handler);\n    }\n  }, {\n    key: \"_fireEvent\",\n    value: function _fireEvent(event) {\n      this._observers.forEach(function (callback) {\n        callback(event);\n      });\n    }\n  }, {\n    key: \"_onChanges\",\n    value: function _onChanges(change) {\n      var obj = change.object;\n      var objType;\n\n      if (obj.constructor === Object) {\n        objType = ObjectType.OBJECT;\n      }\n\n      if (obj.constructor === Array) {\n        objType = ObjectType.ARRAY;\n      }\n\n      var fieldString = change.keypath; // console.log('Field:', fieldString);\n      // console.log('type:', change.type);\n      //let oldValue = change.oldValue;\n\n      var newValue = obj[change.name]; // console.info(change.type + ' | Field: ' + fieldString + ' | New Value:', JSON.stringify(newValue), fieldString.includes('length'));\n\n      if (change.type === 'update' && !fieldString.includes('.length')) {\n        this._fireEvent({\n          cType: ChangeType.UPDATE,\n          oType: objType,\n          field: fieldString,\n          data: newValue\n        });\n      }\n\n      if (change.type === 'add') {\n        this._fireEvent({\n          cType: ChangeType.ADD,\n          oType: objType,\n          field: fieldString,\n          data: newValue\n        });\n      }\n\n      if (change.type === 'delete') {\n        this._fireEvent({\n          cType: ChangeType.REMOVE,\n          oType: objType,\n          field: fieldString\n        });\n      }\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    }\n  }]);\n\n  return SyncObject;\n}();\n\nvar ChangeType = {\n  UPDATE: 'update',\n  ADD: 'add',\n  REMOVE: 'remove'\n};\nvar ObjectType = {\n  OBJECT: 'object',\n  ARRAY: 'array'\n};\n/* harmony default export */ var ProxyObject = (ProxyObject_SyncObject);\n// CONCATENATED MODULE: ./src/syncher/DataObjectChild.js\nfunction DataObjectChild_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DataObjectChild_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction DataObjectChild_createClass(Constructor, protoProps, staticProps) { if (protoProps) DataObjectChild_defineProperties(Constructor.prototype, protoProps); if (staticProps) DataObjectChild_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar DataObjectChild_log = loglevel[\"getLogger\"]('DataObjectChild');\n\n\n/**\r\n * The class returned from the DataObject addChildren call or from onAddChildren if remotely created.\r\n */\n\nvar DataObjectChild_DataObjectChild\n/* implements SyncStatus */\n=\n/*#__PURE__*/\nfunction () {\n  /* private\r\n    ----event handlers----\r\n  _onResponseHandler: (event) => void\r\n  */\n\n  /**\r\n   * @ignore\r\n   * Should not be used directly by Hyperties. It's called by the DataObject.addChild\r\n   */\n  function DataObjectChild(input) {\n    DataObjectChild_classCallCheck(this, DataObjectChild);\n\n    var _this = this;\n\n    function throwMandatoryParmMissingError(par) {\n      throw '[DataObjectChild] ' + par + ' mandatory parameter is missing';\n    }\n\n    input.parent ? _this._parent = input.parent : throwMandatoryParmMissingError('parent');\n    input.url ? _this._url = input.url : throwMandatoryParmMissingError('url');\n    input.created ? _this._created = input.created : throwMandatoryParmMissingError('created');\n    input.reporter ? _this._reporter = input.reporter : throwMandatoryParmMissingError('reporter');\n    input.runtime ? _this._runtime = input.runtime : throwMandatoryParmMissingError('runtime');\n    input.schema ? _this._schema = input.schema : throwMandatoryParmMissingError('schema');\n    input.parentObject ? _this._parentObject = input.parentObject : throwMandatoryParmMissingError('parentObject');\n    if (input.name) _this._name = input.name;\n    if (input.description) _this._description = input.description;\n    if (input.tags) _this._tags = input.tags;\n    if (input.resources) _this._resources = input.resources;\n    if (input.observerStorage) _this._observerStorage = input.observerStorage;\n    if (input.publicObservation) _this._publicObservation = input.publicObservation;\n    _this._childId = input.url;\n\n    if (input.data) {\n      _this._syncObj = new ProxyObject(input.data);\n    } else {\n      _this._syncObj = new ProxyObject({});\n    }\n\n    DataObjectChild_log.log('[DataObjectChild -  Constructor] - ', _this._syncObj);\n    _this._bus = _this._parentObject._bus;\n    _this._owner = _this._parentObject._owner;\n\n    _this._allocateListeners();\n\n    _this._metadata = input; // delete _this._metadata.data;\n\n    delete _this._metadata.parentObject;\n    _this._sharingStatus = false;\n  }\n\n  DataObjectChild_createClass(DataObjectChild, [{\n    key: \"share\",\n\n    /**\r\n     * This function is used to share the child Object among authorised Hyperties\r\n     * @param  {boolean}     reporter  If true the child object is only shared to Parent reporter\r\n     * @return {Promise<JSON>}        It returns a promise with the sharing results.\r\n     */\n    value: function share(toReporter) {\n      var _this = this;\n\n      _this._sharingStatus = new Promise(function (resolve, reject) {\n        var to;\n        var reporter = toReporter;\n\n        if (reporter) {\n          to = _this.metadata.parent;\n        } else to = _this.metadata.parent + '/children/';\n\n        var childValue = _this.metadata;\n        childValue.data = _this.data; //FLOW-OUT: this message will be sent directly to a resource child address: MessageBus\n\n        var requestMsg = {\n          type: 'create',\n          from: _this.metadata.reporter,\n          to: to,\n          body: {\n            resource: childValue.url,\n            value: childValue\n          }\n        };\n\n        if (_this.identity) {\n          requestMsg.body.identity = _this.identity;\n        } //to be used to disable mutual authentication for legacy users\n\n\n        if (_this._parentObject.data.hasOwnProperty('mutual')) requestMsg.body.mutual = _this._parentObject.data.mutual;\n\n        if (_this._parentObject.metadata.reporter === _this.metadata.reporter) {\n          _this._bus.postMessage(deepClone(requestMsg));\n\n          return resolve();\n        } else {\n          var callback = function callback(reply) {\n            if (reply.to === _this._reporter) {\n              _this._bus.removeResponseListener(requestMsg.from, reply.id);\n\n              DataObjectChild_log.log('[Syncher.DataObjectChild.share] Parent reporter reply ', reply);\n              var result = {\n                code: reply.body && reply.body.code ? reply.body.code : 500,\n                desc: reply.body && reply.body.desc ? reply.body.desc : 'Unknown'\n              };\n\n              if (reply.body.code < 300) {\n                return resolve(result);\n              } else return reject(result);\n            }\n          };\n\n          var id = _this._bus.postMessage(deepClone(requestMsg), callback, false);\n\n          setTimeout(function () {\n            // If Reporter does  not reply the promise is rejected\n            _this._bus.removeResponseListener(requestMsg.from, id);\n\n            var result = {\n              code: 408,\n              desc: 'timout'\n            };\n            return reject(result);\n          }, 3000);\n        }\n      });\n    }\n    /**\r\n       * This function is used to share the child Object among authorised Hyperties\r\n       * @param  {boolean}     reporter  If true the child object is only shared to Parent reporter\r\n       * @return {Promise<JSON>}        It returns a promise with the sharing results.\r\n       */\n\n  }, {\n    key: \"store\",\n    value: function store() {\n      var _this = this;\n\n      var child = {};\n      var key = _this.metadata.children + '.' + _this.metadata.url;\n      child.value = _this.metadata;\n      child.identity = _this.identity;\n      var msg = {\n        from: _this.metadata.reporter,\n        to: _this._parentObject._syncher._subURL,\n        type: 'create',\n        body: {\n          resource: _this.metadata.parent,\n          attribute: key,\n          value: child\n        }\n      };\n      DataObjectChild_log.log('[DataObjectChild.store]:', msg);\n\n      _this._bus.postMessage(msg);\n    }\n  }, {\n    key: \"_allocateListeners\",\n    value: function _allocateListeners() {\n      var _this = this; //this is only needed for children reporters\n\n\n      if (_this._reporter === _this._owner) {\n        _this._listener = _this._bus.addListener(_this._reporter, function (msg) {\n          if (msg.type === 'response' && msg.id === _this._msgId) {\n            DataObjectChild_log.log('DataObjectChild.onResponse:', msg);\n\n            _this._onResponse(msg);\n          }\n        });\n      }\n    }\n  }, {\n    key: \"_releaseListeners\",\n    value: function _releaseListeners() {\n      var _this = this;\n\n      if (_this._listener) {\n        _this._listener.remove();\n      }\n    }\n    /**\r\n     * Release and delete object data\r\n     */\n\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      var _this = this;\n\n      _this._releaseListeners(); //TODO: send delete message ?\n      // nothing to be done\n      // return new Promise((resolve) => {\n      //   log.log('[DataObjectChild.delete]');\n      //   resolve();\n      // });\n\n    }\n    /**\r\n     * All Metadata about the Child Data Object\r\n     * @type {Object} -\r\n     */\n\n  }, {\n    key: \"onChange\",\n\n    /**\r\n     * Register the change listeners sent by the reporter child\r\n     * @param {function(event: MsgEvent)} callback\r\n     */\n    value: function onChange(callback) {\n      this._syncObj.observe(function (event) {\n        DataObjectChild_log.log('[DataObjectChild - observer] - ', event);\n        callback(event);\n      });\n    }\n    /**\r\n     * Setup the callback to process response notifications of the creates\r\n     * @param {function(event: MsgEvent)} callback\r\n     */\n\n  }, {\n    key: \"onResponse\",\n    value: function onResponse(callback) {\n      this._onResponseHandler = callback;\n    } //FLOW-IN: message received from a remote DataObject -> _onChildCreate\n\n  }, {\n    key: \"_onResponse\",\n    value: function _onResponse(msg) {\n      var _this = this;\n\n      var event = {\n        type: msg.type,\n        url: msg.body.source,\n        code: msg.body.code\n      };\n\n      if (_this._onResponseHandler) {\n        _this._onResponseHandler(event);\n      }\n    }\n  }, {\n    key: \"shareable\",\n    get: function get() {\n      var shareable = this.metadata;\n      shareable.data = this.data;\n      return shareable;\n    }\n  }, {\n    key: \"metadata\",\n    get: function get() {\n      return this._metadata;\n    }\n    /**\r\n     * Children ID generated on addChildren. Unique identifier\r\n     * @type {URL} - URL of the format <HypertyURL>#<numeric-sequence>\r\n     */\n\n  }, {\n    key: \"childId\",\n    get: function get() {\n      return this._childId;\n    }\n    /**\r\n     * Data Structure to be synchronized.\r\n     * @type {JSON} - JSON structure that should follow the defined schema, if any.\r\n     */\n\n  }, {\n    key: \"sharingStatus\",\n    get: function get() {\n      return this._sharingStatus;\n    }\n    /**\r\n      * Data Structure to be synchronized.\r\n      * @type {JSON} - JSON structure that should follow the defined schema, if any.\r\n      */\n\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._syncObj.data;\n    }\n    /**\r\n     * Set for this dataObjectChild an identity\r\n     * @method identity\r\n     * @param  {Identity} identity identity from who created the message\r\n     */\n\n  }, {\n    key: \"identity\",\n    set: function set(identity) {\n      this._identity = identity;\n    }\n    /**\r\n     * Get for this dataObjectChild an identity\r\n     * @method identity\r\n     * @return {Identity} identity from who created the message\r\n     */\n    ,\n    get: function get() {\n      return this._identity;\n    }\n  }]);\n\n  return DataObjectChild;\n}();\n\n/* harmony default export */ var syncher_DataObjectChild = (DataObjectChild_DataObjectChild);\n// CONCATENATED MODULE: ./src/syncher/HeartBeat.js\nfunction HeartBeat_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction HeartBeat_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction HeartBeat_createClass(Constructor, protoProps, staticProps) { if (protoProps) HeartBeat_defineProperties(Constructor.prototype, protoProps); if (staticProps) HeartBeat_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n/**\r\n * Class to handle Children Data Object Heart beats \r\n * required to manage synchronisation with remote storage servers.\r\n */\n\nvar HeartBeat_HeartBeat =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n    */\n\n  /**\r\n   * @ignore\r\n   * Should not be used directly by Hyperties. It's called by the DataObject constructor\r\n   */\n  function HeartBeat(bus, hypertyUrl, runtimeUrl, dataObject) {\n    var heartBeatRate = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 60;\n\n    HeartBeat_classCallCheck(this, HeartBeat);\n\n    var _this = this;\n\n    function throwMandatoryParmMissingError(par) {\n      throw '[HeartBeat] ' + par + ' mandatory parameter is missing';\n    }\n\n    bus ? _this._bus = bus : throwMandatoryParmMissingError('bus');\n    dataObject ? _this._dataObject = dataObject : throwMandatoryParmMissingError('dataObject');\n    heartBeatRate ? _this._heartBeatRate = heartBeatRate : throwMandatoryParmMissingError('heartBeatRate');\n    runtimeUrl ? _this._runtimeUrl = runtimeUrl : throwMandatoryParmMissingError('runtimeUrl');\n    hypertyUrl ? _this._hypertyUrl = hypertyUrl : throwMandatoryParmMissingError('hypertyUrl');\n    this.heartbeat = 0;\n    _this._stop = {\n      heartBeat: false,\n      sync: function sync(bus) {\n        var stopSyncMsg = {\n          from: hypertyUrl,\n          to: runtimeUrl + '/sm',\n          type: 'execute',\n          body: {\n            method: 'stopSync',\n            params: [dataObject.url]\n          }\n        };\n        console.log('[Heartbeat.stop.sync()] sending msg:', stopSyncMsg);\n        bus.postMessage(stopSyncMsg);\n      }\n    };\n  }\n\n  HeartBeat_createClass(HeartBeat, [{\n    key: \"start\",\n    value: function start(resume) {\n      var _this2 = this;\n\n      var isReporter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      console.log('[HeartBeat] starting. isReporter: ', isReporter);\n\n      if (resume || !isReporter) {\n        this._getLastHearBeat().then(function () {\n          var isHeartBeatActive = _this2._isHeartBeatActive(_this2.heartBeat, _this2._heartBeatRate * 2);\n\n          if (!isHeartBeatActive) {\n            console.log('[HeartBeat] heart beats are disabled for ', _this2._dataObject); // Is disabled: lets start observer heart beat and start synching with remote storage server\n\n            _this2._stop.heartBeat = _this2._startHeartBeat(_this2._heartBeatRate);\n            console.log('[HeartBeat]  ', _this2._hypertyUrl, ' started synching with remote storage server');\n\n            _this2._startSync();\n          } else {\n            //  heart beat is active, \n            // it means the data object is already being synchronised with remote storage server\n            // we only need to watch the heart beat and try to replace it in case it fails.\n            _this2._watchHeartBeat(_this2._heartBeatRate, true, _this2._onHertbeatStopped);\n          }\n        });\n      } else {\n        this._startHeartBeat(this._heartBeatRate);\n\n        this._startSync();\n      }\n    }\n  }, {\n    key: \"_getLastHearBeat\",\n    value: function _getLastHearBeat() {\n      var _this3 = this;\n\n      return new Promise(function (resolve) {\n        setTimeout(function () {\n          console.log('[HeartBeat._getLastHearBeat] stop waiting ');\n          resolve();\n        }, _this3._heartBeatRate * 1000 * 1.5);\n      });\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (this._stop.heartBeat) this._stop.heartBeat();\n\n      this._stop.sync(this._bus);\n    }\n  }, {\n    key: \"onNewHeartbeat\",\n    value: function onNewHeartbeat(heartbeat) {\n      this.heartbeat = heartbeat;\n    }\n  }, {\n    key: \"_isHeartBeatActive\",\n    value: function _isHeartBeatActive(lastHeartbeat, maxHeartBeatInterval) {\n      var lastHeartPeriodInterval = secondsSinceEpoch() - lastHeartbeat;\n      console.log('[HeartBeat._isHeartBeatActive] now - lastHeartBeat', lastHeartPeriodInterval);\n      console.log('[HeartBeat._isHeartBeatActive] ', !(lastHeartPeriodInterval > maxHeartBeatInterval * 2));\n      return !(lastHeartPeriodInterval > maxHeartBeatInterval * 2);\n    }\n  }, {\n    key: \"_startHeartBeat\",\n    value: function _startHeartBeat(rate) {\n      var _this = this;\n\n      var msg = {\n        from: _this._hypertyUrl,\n        to: _this._dataObject.url + '/children/',\n        type: 'create',\n        body: {\n          resource: 'heartbeat',\n          mutual: false,\n          value: secondsSinceEpoch()\n        }\n      };\n      console.log('[HeartBeat._startHeartBeat] starting ... ', msg.body.value);\n\n      this._bus.postMessage(msg);\n\n      this.heartbeat = secondsSinceEpoch();\n      var id = setInterval(function () {\n        var msg = {\n          from: _this._hypertyUrl,\n          to: _this._dataObject.url + '/children/',\n          type: 'create',\n          body: {\n            resource: 'heartbeat',\n            mutual: false,\n            value: secondsSinceEpoch()\n          }\n        };\n        console.log('[HeartBeat] ', msg);\n\n        _this._bus.postMessage(msg);\n\n        this.heartbeat = secondsSinceEpoch();\n      }, rate * 1000); // returns function to stop the heart beat\n\n      return function () {\n        clearInterval(id);\n      };\n    }\n  }, {\n    key: \"_startSync\",\n    value: function _startSync() {\n      console.log('[HeartBeat._startSync] starting observer sync ', this._dataObject.data);\n      var backupRevision = this._dataObject.data.backupRevision;\n      console.log('[HeartBeat._startSync] backupRevision ', backupRevision);\n      var msg = {\n        from: this._hypertyUrl,\n        to: this._runtimeUrl + '/sm',\n        type: 'execute',\n        body: {\n          method: 'sync',\n          params: [this._dataObject.url, backupRevision]\n        }\n      };\n      console.log('[HeartBeat._startSync] sending msg ', msg);\n\n      this._bus.postMessage(msg);\n    }\n  }, {\n    key: \"_watchHeartBeat\",\n    value: function _watchHeartBeat(rate, onWatchingIsEnabled, callback) {\n      //  qdo o heartBeat terminar chama callback \n      // usa heartBeat Rating para iniciar timer no respectivo \n      // campo do DO chamando isHeartBeatActive()\n      var _this = this;\n\n      var syncFun = callback;\n      console.log('[HeartBeat._watchHeartBeat] started watching ', _this.heartBeat); //let heartBeat = type + 'HeartBeat';\n\n      var watcher = setInterval(function () {\n        if (onWatchingIsEnabled && !_this._isHeartBeatActive(_this.heartBeat, _this._heartBeatRate)) {\n          console.log('[HeartBeat._watchHeartBeat] has stopped ', _this._dataObject.data);\n          clearInterval(watcher);\n          syncFun(_this);\n        } else if (!onWatchingIsEnabled && this._isHeartBeatActive(_this.heartBeat, _this._heartBeatRate)) {\n          console.log('[HeartBeat._watchHeartBeat] has changed to disabled ', _this._dataObject.data);\n          clearInterval(watcher);\n          syncFun();\n        }\n      }, rate * 1000 * 2);\n    }\n  }, {\n    key: \"_onHertbeatStopped\",\n    value: function _onHertbeatStopped(_this) {\n      _this._startHeartBeat(_this._heartBeatRate);\n\n      _this._startSync();\n    }\n  }, {\n    key: \"heartBeat\",\n    get: function get() {\n      if (this.heartbeat) return this.heartbeat;else return 0;\n    }\n  }]);\n\n  return HeartBeat;\n}();\n\n/* harmony default export */ var syncher_HeartBeat = (HeartBeat_HeartBeat);\n// CONCATENATED MODULE: ./src/hyperty-resource/HypertyResource.js\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction HypertyResource_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction HypertyResource_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction HypertyResource_createClass(Constructor, protoProps, staticProps) { if (protoProps) HypertyResource_defineProperties(Constructor.prototype, protoProps); if (staticProps) HypertyResource_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\r\n* The Hyperty Resource Data Model is used to model resouces handled by Hyperties and Data Objects including chat messages, files, real time human audio and video..\r\n*\r\n*/\n// Log System\n\nvar HypertyResource_log = loglevel[\"getLogger\"]('HypertyResource');\n\n\n\nvar HypertyResource_HypertyResource =\n/*#__PURE__*/\nfunction (_DataObjectChild) {\n  _inherits(HypertyResource, _DataObjectChild);\n\n  /**\r\n  * HypertyResource constructor\r\n  *\r\n  * @param  {URL} localRuntimeURL RuntimeURL of local runtime\r\n  * @param  {URL} input.owner HypertyURL of the Hyperty handling this resource\r\n  * @param  {URL} input.runtime Runtime URL where this resource is hosted\r\n  * @param  {Bus} input.bus sandbox message bus\r\n  * @param  {DataObject} input.parent Parent Data Object where the HypertyResource is handled as a child\r\n  * @param  {Boolean} isSender indicates if parent is Reporter or an Observer\r\n  * @param  {Array} input optional input parameters\r\n  */\n  function HypertyResource(isSender, input) {\n    var _this2;\n\n    HypertyResource_classCallCheck(this, HypertyResource);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(HypertyResource).call(this, input));\n\n    var _this = _assertThisInitialized(_assertThisInitialized(_this2));\n\n    _this.arraybufferSizeLimit = 5242880; //above this limit content is not saved as ArrayBuffer\n\n    _this._isSender = isSender;\n    _this._localStorageURL = _this._parentObject._syncher._runtimeUrl + '/storage';\n    return _this2;\n  }\n\n  HypertyResource_createClass(HypertyResource, [{\n    key: \"save\",\n\n    /*\r\n    set parent(parent) {\r\n      let _this = this;\r\n      _this._parent = parent;\r\n    }*/\n    value: function save() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var msg = {\n          from: _this._owner,\n          to: _this._localStorageURL,\n          type: 'create',\n          body: {\n            value: deepClone(_this._metadata)\n          }\n        };\n\n        var callback = function callback(reply) {\n          HypertyResource_log.info('[HypertyResource.save] reply: ', reply);\n\n          _this._bus.removeResponseListener(_this._owner, reply.id);\n\n          if (reply.body.code === 200) {\n            if (reply.body.value) {\n              if (!_this._metadata.contentURL) _this._metadata.contentURL = [];\n\n              _this._metadata.contentURL.push(reply.body.value);\n            }\n\n            resolve();\n          } else reject(reply.body.code + ' ' + reply.body.desc);\n        };\n\n        msg.body.value.content = _this._content;\n\n        _this._bus.postMessage(msg, callback, false);\n      });\n    }\n    /**\r\n    * Function to Read HypertyResource\r\n    *\r\n    * @param  {} callback callback to be called with progress information in terms of percentage\r\n    * @return  {Promise}  input optional input parameters\r\n    */\n\n  }, {\n    key: \"read\",\n    value: function read(callback) {\n      var _this = this;\n\n      HypertyResource_log.info('[HypertyResource.read] ', this);\n      return new Promise(function (resolve, reject) {\n        if (_this.content) {\n          resolve(_this);\n        } else {\n          //TODO: use an iteration to get online runtime storages when some are offline\n          var storage = _this._getBestContentURL(_this._metadata.contentURL);\n\n          HypertyResource_log.log('Storage:', storage);\n          var msg = {\n            from: _this._owner,\n            to: storage.url,\n            type: 'read',\n            body: {\n              resource: storage.url + '/' + storage.resource,\n              p2p: true\n            }\n          };\n\n          if (_this.metadata.p2pRequester && _this.metadata.p2pHandler) {\n            msg.body.p2pRequester = _this.metadata.p2pRequester;\n            msg.body.p2pHandler = _this.metadata.p2pHandler;\n          } // get the resource first on the Local Hyperty Resource Storage;\n\n\n          _this._getBestResource(msg, callback).then(function (reply) {\n            HypertyResource_log.info('[HypertyResource] - get locally the resource:', reply);\n            resolve(_this);\n          }).catch(function (reply) {\n            HypertyResource_log.warn('[HypertyResource] - get locally the resource fail', reply); // Generate new message to not use the same id of the last one;\n\n            var msg = {\n              from: _this._owner,\n              to: storage.remoteURL,\n              type: 'read',\n              body: {\n                resource: storage.remoteURL + '/' + storage.resource,\n                p2p: true\n              }\n            };\n\n            if (_this.metadata.p2pRequester && _this.metadata.p2pHandler) {\n              msg.body.p2pRequester = _this.metadata.p2pRequester;\n              msg.body.p2pHandler = _this.metadata.p2pHandler;\n            } // get the resource on the Remote Hyperty Resource Storage;\n\n\n            _this._getBestResource(msg, callback).then(function (reply) {\n              HypertyResource_log.warn('[HypertyResource] - get remotely the resource', reply);\n              resolve(_this);\n            }).catch(function (reply) {\n              HypertyResource_log.warn('[HypertyResource] - get remotely the resource fail', reply);\n              reject(reply.body.code + ' ' + reply.body.desc);\n            });\n          });\n        }\n      });\n    }\n  }, {\n    key: \"_getBestResource\",\n    value: function _getBestResource(msg, inProgressCallback) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var waitForResponse = setTimeout(function () {\n          // If Reporter does  not reply the promise is rejected\n          _this._bus.removeResponseListener(_this._owner, id);\n\n          msg.body.code = 408;\n          msg.body.desc = 'Response timeout';\n          return reject(msg);\n        }, 3000);\n\n        var callback = function callback(reply) {\n          HypertyResource_log.log('[HypertyResource.read] reply: ', reply);\n          var id = reply.id;\n          clearTimeout(waitForResponse);\n\n          switch (reply.body.code) {\n            case 200:\n              _this._content = reply.body.value.content; // save locally if not too big\n\n              if (reply.body.value.size < _this.arraybufferSizeLimit) {\n                _this.save();\n              }\n\n              _this._bus.removeResponseListener(_this._owner, id);\n\n              resolve(reply);\n              break;\n\n            case 183:\n              inProgressCallback(reply.body.value);\n              break;\n\n            default:\n              _this._bus.removeResponseListener(_this._owner, id);\n\n              reject(reply);\n              break;\n          }\n        };\n\n        var id = _this._bus.postMessage(msg, callback, false);\n      });\n    } // Remove Hyperty from the local storage\n\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      var _this = this;\n\n      HypertyResource_log.info('[HypertyResource.delete]', _this.metadata);\n      var msg = {\n        from: _this._owner,\n        to: _this._localStorageURL,\n        type: 'delete',\n        body: {\n          resources: _this.metadata.contentURL\n        }\n      };\n      return new Promise(function (resolve) {\n        _this._bus.postMessage(msg, function (reply) {\n          if (reply.body.code < 300) resolve(true);else resolve(false);\n        });\n      });\n    }\n  }, {\n    key: \"_getBestContentURL\",\n    value: function _getBestContentURL(contentURLList) {\n      var _this = this;\n\n      var contentURL = contentURLList[0];\n      var splitedResource = contentURL.substr(contentURL.lastIndexOf('/') + 1);\n      var url = _this._localStorageURL; // contentURL.substr(0, contentURL.lastIndexOf('/'));\n\n      var remoteResource = contentURL.substr(0, contentURL.lastIndexOf('/'));\n      return {\n        url: url,\n        resource: splitedResource,\n        remoteURL: remoteResource\n      };\n    }\n  }, {\n    key: \"resourceType\",\n    get: function get() {\n      var _this = this;\n\n      return _this.metadata.resourceType;\n    }\n  }, {\n    key: \"mimetype\",\n    get: function get() {\n      var _this = this;\n\n      return _this._metadata.type;\n    }\n  }, {\n    key: \"content\",\n    get: function get() {\n      var _this = this;\n\n      return _this._content;\n    }\n  }, {\n    key: \"contentURL\",\n    get: function get() {\n      var _this = this;\n\n      return _this._metadata.contentURL;\n    }\n  }, {\n    key: \"shareable\",\n    get: function get() {\n      var _this = this;\n\n      var shareable = _get(_getPrototypeOf(HypertyResource.prototype), \"metadata\", this);\n\n      shareable.resourceType = _this.resourceType;\n      return shareable;\n    }\n  }]);\n\n  return HypertyResource;\n}(syncher_DataObjectChild);\n\n/* harmony default export */ var hyperty_resource_HypertyResource = (HypertyResource_HypertyResource);\n// CONCATENATED MODULE: ./src/utils/ImageTools.js\nfunction ImageTools_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ImageTools_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ImageTools_createClass(Constructor, protoProps, staticProps) { if (protoProps) ImageTools_defineProperties(Constructor.prototype, protoProps); if (staticProps) ImageTools_defineProperties(Constructor, staticProps); return Constructor; }\n\nvar hasBlobConstructor = typeof Blob !== 'undefined' && function () {\n  try {\n    return Boolean(new Blob());\n  } catch (e) {\n    return false;\n  }\n}();\n\nvar hasArrayBufferViewSupport = hasBlobConstructor && typeof Uint8Array !== 'undefined' && function () {\n  try {\n    return new Blob([new Uint8Array(100)]).size === 100;\n  } catch (e) {\n    return false;\n  }\n}();\n\nvar hasToBlobSupport = typeof HTMLCanvasElement !== \"undefined\" ? HTMLCanvasElement.prototype.toBlob : false;\nvar hasBlobSupport = hasToBlobSupport || typeof Uint8Array !== 'undefined' && typeof ArrayBuffer !== 'undefined' && typeof atob !== 'undefined';\nvar hasReaderSupport = typeof FileReader !== 'undefined' || typeof URL !== 'undefined';\n\nvar ImageTools =\n/*#__PURE__*/\nfunction () {\n  function ImageTools() {\n    ImageTools_classCallCheck(this, ImageTools);\n  }\n\n  ImageTools_createClass(ImageTools, null, [{\n    key: \"resize\",\n    value: function resize(file, maxDimensions, callback) {\n      if (typeof maxDimensions === 'function') {\n        callback = maxDimensions;\n        maxDimensions = {\n          width: 640,\n          height: 480\n        };\n      }\n\n      var maxWidth = maxDimensions.width;\n      var maxHeight = maxDimensions.height;\n\n      if (!ImageTools.isSupported() || !file.type.match(/image.*/)) {\n        callback(file, false);\n        return false;\n      }\n\n      if (file.type.match(/image\\/gif/)) {\n        // Not attempting, could be an animated gif\n        callback(file, false); // TODO: use https://github.com/antimatter15/whammy to convert gif to webm\n\n        return false;\n      }\n\n      var image = document.createElement('img');\n\n      image.onload = function (imgEvt) {\n        var width = image.width;\n        var height = image.height;\n        var isTooLarge = false;\n\n        if (width >= height && width > maxDimensions.width) {\n          // width is the largest dimension, and it's too big.\n          height *= maxDimensions.width / width;\n          width = maxDimensions.width;\n          isTooLarge = true;\n        } else if (height > maxDimensions.height) {\n          // either width wasn't over-size or height is the largest dimension\n          // and the height is over-size\n          width *= maxDimensions.height / height;\n          height = maxDimensions.height;\n          isTooLarge = true;\n        }\n\n        if (!isTooLarge) {\n          // early exit; no need to resize\n          callback(file, false);\n          return;\n        }\n\n        var canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        var ctx = canvas.getContext('2d');\n        ctx.drawImage(image, 0, 0, width, height);\n\n        if (hasToBlobSupport) {\n          canvas.toBlob(function (blob) {\n            callback(blob, true);\n          }, file.type);\n        } else {\n          var blob = ImageTools._toBlob(canvas, file.type);\n\n          callback(blob, true);\n        }\n      };\n\n      ImageTools._loadImage(image, file);\n\n      return true;\n    }\n  }, {\n    key: \"_toBlob\",\n    value: function _toBlob(canvas, type) {\n      var dataURI = canvas.toDataURL(type);\n      var dataURIParts = dataURI.split(',');\n      var byteString;\n\n      if (dataURIParts[0].indexOf('base64') >= 0) {\n        // Convert base64 to raw binary data held in a string:\n        byteString = atob(dataURIParts[1]);\n      } else {\n        // Convert base64/URLEncoded data component to raw binary data:\n        byteString = decodeURIComponent(dataURIParts[1]);\n      }\n\n      var arrayBuffer = new ArrayBuffer(byteString.length);\n      var intArray = new Uint8Array(arrayBuffer);\n\n      for (var i = 0; i < byteString.length; i += 1) {\n        intArray[i] = byteString.charCodeAt(i);\n      }\n\n      var mimeString = dataURIParts[0].split(':')[1].split(';')[0];\n      var blob = null;\n\n      if (hasBlobConstructor) {\n        blob = new Blob([hasArrayBufferViewSupport ? intArray : arrayBuffer], {\n          type: mimeString\n        });\n      } else {\n        var bb = new BlobBuilder();\n        bb.append(arrayBuffer);\n        blob = bb.getBlob(mimeString);\n      }\n\n      return blob;\n    }\n  }, {\n    key: \"_loadImage\",\n    value: function _loadImage(image, file, callback) {\n      if (typeof URL === 'undefined') {\n        var reader = new FileReader();\n\n        reader.onload = function (evt) {\n          image.src = evt.target.result;\n\n          if (callback) {\n            callback();\n          }\n        };\n\n        reader.readAsDataURL(file);\n      } else {\n        image.src = URL.createObjectURL(file);\n\n        if (callback) {\n          callback();\n        }\n      }\n    }\n  }, {\n    key: \"isSupported\",\n    value: function isSupported() {\n      return typeof HTMLCanvasElement !== 'undefined' && hasBlobSupport && hasReaderSupport;\n    }\n  }]);\n\n  return ImageTools;\n}();\n\n\n// CONCATENATED MODULE: ./src/hyperty-resource/FileHypertyResource.js\nfunction FileHypertyResource_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { FileHypertyResource_typeof = function _typeof(obj) { return typeof obj; }; } else { FileHypertyResource_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return FileHypertyResource_typeof(obj); }\n\nfunction FileHypertyResource_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction FileHypertyResource_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction FileHypertyResource_createClass(Constructor, protoProps, staticProps) { if (protoProps) FileHypertyResource_defineProperties(Constructor.prototype, protoProps); if (staticProps) FileHypertyResource_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction FileHypertyResource_possibleConstructorReturn(self, call) { if (call && (FileHypertyResource_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return FileHypertyResource_assertThisInitialized(self); }\n\nfunction FileHypertyResource_getPrototypeOf(o) { FileHypertyResource_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return FileHypertyResource_getPrototypeOf(o); }\n\nfunction FileHypertyResource_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) FileHypertyResource_setPrototypeOf(subClass, superClass); }\n\nfunction FileHypertyResource_setPrototypeOf(o, p) { FileHypertyResource_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return FileHypertyResource_setPrototypeOf(o, p); }\n\nfunction FileHypertyResource_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\r\n* The Hyperty Resource Data Model is used to model resouces handled by Hyperties and Data Objects including chat messages, files, real time human audio and video..\r\n*\r\n*/\n// Log System\n\nvar FileHypertyResource_log = loglevel[\"getLogger\"]('FileHypertyResource');\n\n\n\n\nvar FileHypertyResource_FileHypertyResource =\n/*#__PURE__*/\nfunction (_HypertyResource) {\n  FileHypertyResource_inherits(FileHypertyResource, _HypertyResource);\n\n  /**\r\n  * FileHypertyResource constructor\r\n  *\r\n  * @param  {URL} owner HypertyURL of the Hyperty handling this resource\r\n  * @param  {URL} runtime Runtime URL where this resource is hosted\r\n  * @param  {Bus} bus sandbox message bus\r\n  * @param  {DataObject} parent Parent Data Object where the HypertyResource is handled as a child\r\n  * @param  {File} file file to be encoded as HypertyResource\r\n  * @param  {Boolean} isReporter indicates if parent is Reporter or an Observer\r\n  * @param  {Array} input optional input parameters\r\n  */\n  function FileHypertyResource(isSender, input) {\n    var _this2;\n\n    FileHypertyResource_classCallCheck(this, FileHypertyResource);\n\n    _this2 = FileHypertyResource_possibleConstructorReturn(this, FileHypertyResource_getPrototypeOf(FileHypertyResource).call(this, isSender, input));\n\n    var _this = FileHypertyResource_assertThisInitialized(FileHypertyResource_assertThisInitialized(_this2));\n\n    _this.metadata.resourceType = 'file';\n    return _this2;\n  }\n\n  FileHypertyResource_createClass(FileHypertyResource, [{\n    key: \"init\",\n    value: function init(file) {\n      var _this = this;\n\n      if (!file) throw new Error('[FileHypertyResource.constructor] missing mandatory *file* input ');\n      return new Promise(function (resolve, reject) {\n        _this._metadata.name = file.name;\n        _this._metadata.lastModified = file.lastModified;\n        _this._metadata.size = file.size;\n        _this._metadata.mimetype = file.type;\n        FileHypertyResource_log.log('[FileHypertyResource.init] file: ', file);\n\n        if (_this._isSender) {\n          var mimetype = file.type.split('/')[0];\n\n          switch (mimetype) {\n            case 'image':\n              _this._getImagePreview(file).then(function (preview) {\n                _this._metadata.preview = preview;\n                _this._content = file;\n                resolve();\n              });\n\n              break;\n\n            default:\n              _this._content = file;\n              resolve();\n              break;\n          } // if too big lets store as File and asArray Buffer\n          //  if (file.size > _this.arraybufferSizeLimit) {\n\n          /*  } else {\r\n                let reader = new FileReader();\r\n                reader.onload = function(theFile) {\r\n                  log.log('[FileHypertyResource.init] file loaded ', theFile);\r\n                  _this._content = theFile.target.result;\r\n                resolve();\r\n                }\r\n                reader.readAsArrayBuffer(file);\r\n              }*/\n\n        } else {\n          _this._content = file.content;\n          if (file.preview) _this._metadata.preview = file.preview;\n          resolve();\n        }\n      });\n    }\n  }, {\n    key: \"_getImagePreview\",\n    value: function _getImagePreview(image) {\n      var reader = new FileReader();\n      return new Promise(function (resolve, reject) {\n        ImageTools.resize(image, {\n          width: 100,\n          // maximum width\n          height: 100 // maximum height\n\n        }, function (blob, didItResize) {\n          // didItResize will be true if it managed to resize it, otherwise false (and will return the original file as 'blob')\n          if (didItResize) {\n            reader.readAsDataURL(blob);\n\n            reader.onload = function (theImage) {\n              resolve(theImage.target.result);\n            };\n          } else {\n            FileHypertyResource_log.warn('[FileHypertyResource._getImagePreview] unable to create image preview from original image ');\n            resolve(undefined);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"toMessage\",\n\n    /**\r\n    * Share file as a data object child of a data object parent\r\n    *\r\n    * @param  {string} children Data Object Parent children name where the file is shared\r\n    */\n\n    /*  share(children) {\r\n        let _this = this;\r\n    \r\n        return new Promise(function(resolve, reject) {\r\n          //to be improved and adapted\r\n    \r\n          if (!_this._isSender) return reject('[FileHypertyResource.share] Observers can not share files');\r\n    \r\n          let file2share = _this._metadata;\r\n          file2share.type = _this._type;\r\n    \r\n          _this._parent.addChild(children, file2share).then(function(dataObjectChild) {\r\n            log.log('[FileHypertyResource.share] object child: ', dataObjectChild);\r\n    \r\n            let sharedFile = dataObjectChild.data;\r\n    \r\n            resolve(sharedFile);\r\n    \r\n          }).catch(function(reason) {\r\n            log.error('Reason:', reason);\r\n            reject(reason);\r\n          });\r\n    \r\n        });\r\n    \r\n      }*/\n\n    /**\r\n    * Returns file content optimised to be displayed in a message line\r\n    *\r\n    * @param  {string} children Data Object Parent children name where the file is shared\r\n    */\n    value: function toMessage() {//TODO: to be implemented. It should return HTML with img attribute as a thumbnail plus the name.\n    }\n  }, {\n    key: \"name\",\n    get: function get() {\n      var _this = this;\n\n      return _this._metadata.name;\n    }\n  }, {\n    key: \"preview\",\n    get: function get() {\n      var _this = this;\n\n      return _this._metadata.preview;\n    }\n  }]);\n\n  return FileHypertyResource;\n}(hyperty_resource_HypertyResource);\n\n/* harmony default export */ var hyperty_resource_FileHypertyResource = (FileHypertyResource_FileHypertyResource);\n// CONCATENATED MODULE: ./src/hyperty-resource/HypertyResourceFactory.js\nfunction HypertyResourceFactory_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction HypertyResourceFactory_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction HypertyResourceFactory_createClass(Constructor, protoProps, staticProps) { if (protoProps) HypertyResourceFactory_defineProperties(Constructor.prototype, protoProps); if (staticProps) HypertyResourceFactory_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* The Hyperty Resource Data Model is used to model resouces handled by Hyperties and Data Objects including chat messages, files, real time human audio and video..\r\n*\r\n*/\n\n\nvar HypertyResourceFactory_HypertyResourceFactory =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * HypertyResourceFactory constructor\r\n  *\r\n  */\n  function HypertyResourceFactory() {\n    HypertyResourceFactory_classCallCheck(this, HypertyResourceFactory);\n  }\n\n  HypertyResourceFactory_createClass(HypertyResourceFactory, [{\n    key: \"createHypertyResource\",\n    value: function createHypertyResource(isSender, type, metadata) {\n      var newHypertyResource;\n\n      switch (type) {\n        case 'file':\n          newHypertyResource = new hyperty_resource_FileHypertyResource(isSender, metadata);\n          break;\n\n        default:\n          throw new Error('[HypertyResourceFactory.createHypertyResource] not supported type: ', type);\n          break;\n      }\n\n      return newHypertyResource;\n    }\n  }, {\n    key: \"createHypertyResourceWithContent\",\n    value: function createHypertyResourceWithContent(isSender, type, content, metadata) {\n      var newHypertyResource;\n      return new Promise(function (resolve) {\n        switch (type) {\n          case 'file':\n            newHypertyResource = new hyperty_resource_FileHypertyResource(isSender, metadata);\n            break;\n\n          default:\n            reject();\n            break;\n        }\n\n        newHypertyResource.init(content).then(function () {\n          return newHypertyResource.save(); // skip save?\n        }).then(function () {\n          resolve(newHypertyResource);\n        });\n      });\n    }\n  }]);\n\n  return HypertyResourceFactory;\n}();\n\n/* harmony default export */ var hyperty_resource_HypertyResourceFactory = (HypertyResourceFactory_HypertyResourceFactory);\n// CONCATENATED MODULE: ./src/syncher/DataObject.js\nfunction DataObject_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { DataObject_typeof = function _typeof(obj) { return typeof obj; }; } else { DataObject_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return DataObject_typeof(obj); }\n\nfunction DataObject_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DataObject_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction DataObject_createClass(Constructor, protoProps, staticProps) { if (protoProps) DataObject_defineProperties(Constructor.prototype, protoProps); if (staticProps) DataObject_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar DataObject_log = loglevel[\"getLogger\"]('DataObject');\n\n\n\n\n\n/**\r\n * Main extension class for observers and reporters, with common properties and methods.\r\n * Children management is common for observers and reporters.\r\n */\n\nvar DataObject_DataObject =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _version: number\r\n    _owner: HypertyURL\r\n  _url: ObjectURL\r\n  _schema: Schema\r\n  _bus: MiniBus\r\n  _status: on | paused\r\n  _syncObj: SyncData\r\n    _children: { id: DataObjectChild }\r\n  _childrenListener: [MsgListener]\r\n    ----event handlers----\r\n  _onAddChildHandler: (event) => void\r\n  */\n\n  /**\r\n   * @ignore\r\n   * Should not be used directly by Hyperties. It's called by the Syncher create or subscribe method's\r\n   */\n  function DataObject(input) {\n    DataObject_classCallCheck(this, DataObject);\n\n    var _this = this;\n\n    function throwMandatoryParmMissingError(par) {\n      throw '[DataObject] ' + par + ' mandatory parameter is missing';\n    }\n\n    input.syncher ? _this._syncher = input.syncher : throwMandatoryParmMissingError('syncher');\n    input.url ? _this._url = input.url : throwMandatoryParmMissingError('url');\n    input.created ? _this._created = input.created : throwMandatoryParmMissingError('created');\n    input.reporter ? _this._reporter = input.reporter : throwMandatoryParmMissingError('reporter');\n    input.runtime ? _this._runtime = input.runtime : throwMandatoryParmMissingError('runtime');\n    input.schema ? _this._schema = input.schema : throwMandatoryParmMissingError('schema');\n    input.name ? _this._name = input.name : throwMandatoryParmMissingError('name');\n    _this._status = input.status;\n\n    if (input.data) {\n      _this._syncObj = new ProxyObject(input.data);\n    } else {\n      _this._syncObj = new ProxyObject({});\n    }\n\n    _this._childrens = input.childrens; //TODO: For Further Study\n\n    _this._mutual = input.mutual;\n    _this._version = 0;\n    _this._childId = 1;\n    _this._childrenListener; //bus listener for children\n\n    _this._onAddChildrenHandler; //Hyperty side handlers to process child objects created by remote Hyperties\n\n    _this._resumed = input.resume;\n\n    if (input.resume) {\n      _this._version = input.version;\n    }\n\n    _this._owner = input.syncher._owner;\n    _this._bus = input.syncher._bus;\n    if (input.description) _this._description = input.description;\n    if (input.tags) _this._tags = input.tags;\n    if (input.resources) _this._resources = input.resources;\n    if (input.observerStorage) _this._observerStorage = input.observerStorage;\n    if (input.publicObservation) _this._publicObservation = input.publicObservation;\n    _this._metadata = Object.assign(input); //    console.log('[DataObject] mutual ', _this._metadata.mutual);\n\n    if (!input.hasOwnProperty('resume') || input.hasOwnProperty('resume') && !input.resume) {\n      _this._metadata.lastModified = _this._metadata.created;\n    }\n\n    delete _this._metadata.data;\n    delete _this._metadata.syncher;\n    delete _this._metadata.authorise;\n    _this._hypertyResourceFactory = new hyperty_resource_HypertyResourceFactory();\n    _this._childrenObjects = {};\n    _this._sharedChilds = []; //childObjects that were not sent yet to Reporters\n\n    if (input.backup && _this._childrens) {\n      var lastHeartbeat = input.hasOwnProperty('childrenObjects') && input.childrenObjects.hasOwnProperty('heartbeat') ? input.childrenObjects.heartbeat : 0;\n      _this._heartBeat = new syncher_HeartBeat(_this._bus, _this._owner, _this._syncher._runtimeUrl, this, 15, lastHeartbeat);\n      if (_this._resumed) _this._heartBeat.start(true, _this.metadata.isReporter);else _this._heartBeat.start(false, _this.metadata.isReporter);\n    }\n  }\n\n  DataObject_createClass(DataObject, [{\n    key: \"_getLastChildId\",\n    value: function _getLastChildId() {\n      var _this = this;\n\n      var childIdInt = 0;\n      var childIdString = _this._owner + '#' + childIdInt;\n      Object.keys(_this._childrens).filter(function (key) {\n        if (_this._childrens[key].childId > childIdString) {\n          childIdString = _this._childrens[key].childId;\n        }\n      });\n      return childIdInt = Number(childIdString.split('#')[1]);\n    }\n  }, {\n    key: \"_allocateListeners\",\n    value: function _allocateListeners() {\n      var _this2 = this;\n\n      var _this = this;\n\n      var childBaseURL = _this._url + '/children/';\n      DataObject_log.log('[Data Object - AllocateListeners] - ', _this._childrens);\n\n      if (_this._childrens) {\n        //      _this._childrens.forEach((child) => {\n        var childURL = childBaseURL;\n\n        var listener = _this._bus.addListener(childURL, function (msg) {\n          //ignore msg sent by himself\n          if (msg.from !== _this2._owner) {\n            DataObject_log.log('DataObject-Children-RCV: ', msg);\n\n            switch (msg.type) {\n              case 'create':\n                _this._onChildCreate(msg);\n\n                break;\n\n              case 'delete':\n                DataObject_log.log(msg);\n                break;\n\n              default:\n                _this._changeChildren(msg);\n\n                break;\n            }\n          } //        });\n\n\n          _this._childrenListener = listener;\n        });\n      }\n    }\n  }, {\n    key: \"_releaseListeners\",\n    value: function _releaseListeners() {\n      var _this = this;\n\n      if (_this._childrenListener) {\n        _this._childrenListener.remove();\n\n        Object.keys(_this._childrenObjects).forEach(function (child) {\n          /*      if (children === 'resources') {\r\n                  Object.keys(_this._childrenObjects[children]).forEach((child) => {\r\n                    _this._childrenObjects[children][child]._releaseListeners();\r\n                  });\r\n                } else {*/\n          _this._childrenObjects[child]._releaseListeners(); //      }\n\n        });\n      }\n    }\n    /**\r\n     * Sync Data Object Observer with last version of Data Object Reporter. Useful for Resumes\r\n     */\n\n  }, {\n    key: \"sync\",\n    value: function sync() {\n      var _this3 = this;\n\n      var _this = this;\n\n      DataObject_log.info('[DataObject.sync] synchronising ');\n      return new Promise(function (resolve, reject) {\n        var criteria = {};\n        if (_this3.metadata.backupRevision) criteria.backupRevision = _this3.metadata.backupRevision;\n\n        _this._syncher.read(_this._metadata.url, criteria).then(function (value) {\n          DataObject_log.info('[DataObject.sync] value to sync: ', value);\n          Object.assign(_this.data, deepClone(value.data));\n          _this._version = value.version;\n          _this._metadata.lastModified = value.lastModified; //TODO: check first if there are new childrenObjects to avoid overhead\n\n          if (value.childrenObjects) {\n            _this.resumeChildrens(value.childrenObjects);\n\n            _this._storeChildrens();\n\n            resolve(true);\n          } else resolve(true);\n          /*if (value.version != _this._version) {\r\n            log.info('[DataObject.sync] updating existing data: ', _this.data);\r\n              Object.assign(_this.data || {}, deepClone(value.data));\r\n              _this._metadata = deepClone(value);\r\n              delete _this._metadata.data;\r\n              _this._version = value.version;\r\n            } else {\r\n            log.info('[DataObject.sync] existing data is updated: ', value);\r\n          }*/\n\n        }).catch(function (reason) {\n          DataObject_log.info('[DataObject.sync] sync failed: ', reason);\n          resolve(false);\n        });\n      });\n    }\n    /**\r\n     *\r\n     */\n\n  }, {\n    key: \"resumeChildrens\",\n    value: function resumeChildrens(childrens) {\n      var _this4 = this;\n\n      var _this = this;\n\n      var childIdString = this._owner.split('/')[3] + '#' + this._childId; //setup childrens data from subscription\n      //    Object.keys(childrens).forEach((childrenResource) => {\n      //      let children = childrens[childrenResource];\n\n\n      var children = childrens; //_this._childrenObjects[childrenResource] = {};\n\n      Object.keys(children).forEach(function (childId) {\n        var newChild = false;\n        /*        if (!_this._childrenObjects.hasOwnProperty(childrenResource))\r\n                  _this._childrenObjects[childrenResource] = {};*/\n        // check if it is the last heartbeat\n\n        if (childId === 'heartbeat') {//          _this._heartBeat.onNewHeartbeat(children[childId].value);\n          //          _this._heartBeat.start(true);\n        } else if (children[childId].hasOwnProperty('value') && children[childId].value.resourceType && !_this._childrenObjects.hasOwnProperty(childId)) {\n          _this._childrenObjects[childId] = _this._resumeHypertyResource(children[childId]);\n          newChild = true;\n        } else if (!_this._childrenObjects.hasOwnProperty(childId)) {\n          _this._childrenObjects[childId] = _this._resumeChild(children[childId]);\n          DataObject_log.log('[DataObject.resumeChildrens] new DataObjectChild: ', _this._childrenObjects[childId]);\n          newChild = true;\n        }\n\n        if (newChild && childId > childIdString) {\n          childIdString = childId;\n          DataObject_log.log('[DataObjectReporter.resumeChildrens] - resuming: ', _this4._childrenObjects[childId]);\n        }\n      }); //    });\n\n      this._childId = Number(childIdString.split('#')[1]);\n    }\n  }, {\n    key: \"_resumeChild\",\n    value: function _resumeChild(input) {\n      var _this = this;\n\n      var childInput = input.value;\n      childInput.parentObject = _this;\n      childInput.parent = _this._url;\n      var child = new syncher_DataObjectChild(childInput);\n      child.identity = input.identity;\n      var event = {\n        type: 'create',\n        from: child.reporter,\n        url: child.parent,\n        value: child.data,\n        childId: child.url,\n        identity: child.identity,\n        child: child\n      };\n\n      if (child.resourceType) {\n        event.resource = child;\n      }\n\n      if (_this._onAddChildrenHandler) _this._onAddChildrenHandler(event);\n      return child;\n    }\n  }, {\n    key: \"_resumeHypertyResource\",\n    value: function _resumeHypertyResource(input) {\n      var _this = this;\n\n      var childInput = input.value;\n      childInput.parentObject = _this;\n      childInput.parent = _this._url;\n\n      var hypertyResource = _this._hypertyResourceFactory.createHypertyResource(false, childInput.resourceType, childInput);\n\n      hypertyResource.identity = input.identity;\n      var event = {\n        type: 'create',\n        from: hypertyResource.reporter,\n        url: hypertyResource.parent,\n        value: hypertyResource.data,\n        childId: hypertyResource.url,\n        identity: hypertyResource.identity,\n        child: hypertyResource\n      };\n\n      if (hypertyResource.resourceType) {\n        event.resource = hypertyResource;\n      }\n\n      if (_this._onAddChildrenHandler) _this._onAddChildrenHandler(event);\n      return hypertyResource;\n    }\n    /**\r\n     * All Metadata about the Data Object\r\n     * @type {Object} -\r\n     */\n\n  }, {\n    key: \"pause\",\n\n    /**\r\n     * @ignore\r\n     */\n    value: function pause() {\n      //TODO: this feature needs more analise\n      throw 'Not implemented';\n    }\n    /**\r\n     * @ignore\r\n     */\n\n  }, {\n    key: \"resume\",\n    value: function resume() {\n      //TODO: this feature needs more analise\n      throw 'Not implemented';\n    }\n    /**\r\n     * @ignore\r\n     */\n\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      //TODO: should remove the subscription and send message unsubscribe?\n      throw 'Not implemented';\n    }\n    /**\r\n     * Create and add a DataObjectChild to a children collection.\r\n     * @param {JSON} initialData - Initial data of the child\r\n     * @param  {MessageBodyIdentity} identity - (optional) identity data to be added to identity the user reporter. To be used for legacy identities.\r\n     * @param  {SyncChildMetadata} input - (optional) All additional metadata about the DataObjectChild.\r\n     * @return {Promise<DataObjectChild>} - Return Promise to a new DataObjectChild.\r\n     */\n\n  }, {\n    key: \"addChild\",\n    value: function addChild(initialData, identity, input) {\n      var _this = this;\n\n      var newChild; //returns promise, in the future, the API may change to asynchronous call\n\n      return new Promise(function (resolve) {\n        var msgChildPath = _this._url + '/children/';\n\n        var childInput = _this._getChildInput(input);\n\n        childInput.data = initialData; //      childInput.children = children;\n\n        newChild = new syncher_DataObjectChild(childInput);\n        if (identity) newChild.identity = identity;\n        newChild.share();\n        console.log('[DataObject.addChild] added ', newChild);\n        newChild.onChange(function (event) {\n          _this._onChange(event, {\n            path: msgChildPath,\n            childId: childInput.url\n          });\n        }); //     if (!_this._childrenObjects.hasOwnProperty(children)) _this._childrenObjects[children] = {};\n\n        _this._childrenObjects[childInput.url] = newChild;\n        resolve(newChild);\n      });\n    }\n  }, {\n    key: \"_deleteChildrens\",\n    value: function _deleteChildrens() {\n      var _this = this;\n\n      var deletePromises = [];\n      return new Promise(function (resolve) {\n        if (_this.childrens) {\n          DataObject_log.log('[DataObject.deleteChildrens]', _this.childrens);\n          var child;\n\n          for (child in _this.childrens) {\n            //          let child;\n\n            /*          if (children === 'resources') {\r\n                        for (child in _this.childrens[children]) {\r\n                          let childObj = _this.childrens[children][child];\r\n                          log.log('[DataObject._deleteChildrens] child',childObj);\r\n                          if (childObj.metadata.hasOwnProperty('resourceType'))\r\n                            deletePromises.push(_this.childrens[children][child].delete());\r\n                        }\r\n                       } else {*/\n            var childObj = _this.childrens[child];\n            DataObject_log.log('[DataObject._deleteChildrens] child', childObj);\n            if (childObj.metadata.hasOwnProperty('resourceType')) deletePromises.push(_this.childrens[child].delete());\n          } //        }\n\n\n          DataObject_log.log('[DataObject._deleteChildrens] promises ', deletePromises);\n\n          if (deletePromises.length > 0) {\n            Promise.all(deletePromises).then(function () {\n              resolve('[DataObject._deleteChildrens] done');\n            });\n          } else resolve('[DataObject._deleteChildrens] nothing to delete');\n        }\n      });\n    }\n  }, {\n    key: \"_getChildInput\",\n    value: function _getChildInput(input) {\n      var _this = this;\n\n      var childInput = Object.assign({}, input);\n      _this._childId++; //removing domain from childId to avoid backup issues with '.'\n\n      childInput.url = _this._owner.split('/')[3] + '#' + _this._childId;\n      childInput.parentObject = _this;\n      childInput.reporter = _this._owner;\n      childInput.created = new Date().toISOString();\n      childInput.runtime = _this._syncher._runtimeUrl;\n      childInput.p2pHandler = _this._syncher._p2pHandler;\n      childInput.p2pRequester = _this._syncher._p2pRequester;\n      childInput.schema = _this._schema;\n      childInput.parent = _this.url;\n      childInput.mutual = _this.metadata.mutual; //    console.log('[DataObject._getChildInput] mutual ', childInput.mutual);\n\n      return childInput;\n    }\n  }, {\n    key: \"addHypertyResource\",\n    value: function addHypertyResource(type, resource, identity, input) {\n      var _this = this; //returns promise, in the future, the API may change to asynchronous call\n\n\n      return new Promise(function (resolve) {\n        var hypertyResource;\n        var msgChildPath = _this._url + '/children/';\n\n        var childInput = _this._getChildInput(input); //      childInput.children = children;\n\n\n        _this._hypertyResourceFactory.createHypertyResourceWithContent(true, type, resource, childInput).then(function (resource) {\n          hypertyResource = resource;\n          if (identity) hypertyResource.identity = identity;\n          hypertyResource.share();\n          DataObject_log.log('[DataObject.addHypertyResource] added ', hypertyResource);\n          hypertyResource.onChange(function (event) {\n            _this._onChange(event, {\n              path: msgChildPath,\n              childId: hypertyResource.childId\n            });\n          }); //        if (!_this._childrenObjects.hasOwnProperty(children)) _this._childrenObjects[children] = {};\n\n          _this._childrenObjects[hypertyResource.childId] = hypertyResource;\n          resolve(hypertyResource);\n        });\n      });\n    }\n    /**\r\n     * Setup the callback to process create and delete of childrens.\r\n     * @param {function(event: MsgEvent)} callback\r\n     * TODO: add childrenId to support different handlers per children\r\n     */\n\n  }, {\n    key: \"onAddChild\",\n    value: function onAddChild(callback) {\n      this._onAddChildrenHandler = callback;\n    } //FLOW-IN: message received from a remote DataObject -> addChild\n\n  }, {\n    key: \"_onChildCreate\",\n    value: function _onChildCreate(msg) {\n      var _this = this; //    console.log('[DataObject._onChildCreate] receivedBy ' + _this._owner + ' : ', msg);\n      // if this is an heartbeat msg foward it to heatbeat handler\n\n\n      if (msg.body.resource === 'heartbeat') {\n        console.log('[DataObject._onChildCreate] new heartbeat received ' + msg.body.value);\n\n        this._heartBeat.onNewHeartbeat(msg.body.value);\n      } else {\n        console.log('[DataObject._onChildCreate] new child receivedBy ' + _this._owner + ' : ', msg);\n        var response = {\n          from: msg.to,\n          to: msg.from,\n          type: 'response',\n          id: msg.id,\n          body: {\n            code: 100\n          }\n        };\n\n        _this._bus.postMessage(response);\n\n        if (msg.body.value.resourceType) {\n          _this._onHypertyResourceAdded(msg);\n        } else _this._onChildAdded(msg);\n      }\n    }\n  }, {\n    key: \"_onChildAdded\",\n    value: function _onChildAdded(msg) {\n      var _this = this;\n\n      var childInput = deepClone(msg.body.value);\n      childInput.parentObject = _this; //    let children = childInput.children;\n\n      var newChild = new syncher_DataObjectChild(childInput);\n      newChild.identity = msg.body.identity; //    if (!_this._childrenObjects.hasOwnProperty(children)) _this._childrenObjects[children] = {};\n\n      _this._childrenObjects[childInput.url] = newChild;\n      if (msg.to === _this.metadata.url) newChild.store();\n\n      _this._hypertyEvt(msg, newChild);\n    }\n  }, {\n    key: \"_onHypertyResourceAdded\",\n    value: function _onHypertyResourceAdded(msg) {\n      var _this = this;\n\n      var input = msg.body.value;\n      var hypertyResource; //    let children = input.children;\n\n      input.parentObject = _this;\n      hypertyResource = _this._hypertyResourceFactory.createHypertyResource(false, input.resourceType, input);\n      hypertyResource.identity = msg.body.identity; //    if (!_this._childrenObjects.hasOwnProperty(children)) _this._childrenObjects[children] = {};\n\n      _this._childrenObjects[hypertyResource.childId] = hypertyResource;\n\n      _this._hypertyEvt(msg, hypertyResource); // locally store messages that are directly sent to the hyperty\n      // ie to sync with messages sent when offline\n\n\n      if (msg.to === _this.metadata.url) hypertyResource.store();\n    }\n  }, {\n    key: \"_hypertyEvt\",\n    value: function _hypertyEvt(msg, child) {\n      var _this = this;\n\n      var event = {\n        type: msg.type,\n        from: msg.from,\n        url: msg.to,\n        value: child.data,\n        childId: child.url,\n        identity: msg.body.identity,\n        child: child\n      };\n\n      if (child.resourceType) {\n        event.resource = child;\n      }\n\n      if (_this._onAddChildrenHandler) _this._onAddChildrenHandler(event);\n    } //send delta messages to subscriptions\n\n  }, {\n    key: \"_onChange\",\n    value: function _onChange(event, childInfo) {\n      var _this = this;\n\n      _this._metadata.lastModified = new Date().toISOString();\n      _this._version++;\n\n      if (_this._status === 'live') {\n        //FLOW-OUT: this message will be sent directly to a resource changes address: MessageBus\n        var changeMsg = {\n          type: 'update',\n          from: _this._url,\n          to: _this._url + '/changes',\n          body: {\n            version: _this._version,\n            source: _this._owner,\n            attribute: event.field,\n            lastModified: _this._metadata.lastModified\n          }\n        };\n        DataObject_log.log('[DataObject - _onChange] - ', event, childInfo, changeMsg);\n\n        if (event.oType === ObjectType.OBJECT) {\n          if (event.cType !== ChangeType.REMOVE) {\n            changeMsg.body.value = deepClone(event.data);\n          }\n        } else {\n          changeMsg.body.attributeType = event.oType;\n          changeMsg.body.value = event.data;\n\n          if (event.cType !== ChangeType.UPDATE) {\n            changeMsg.body.operation = event.cType;\n          }\n        } //childInfo must have (path, childId)\n\n\n        if (childInfo) {\n          changeMsg.to = childInfo.path;\n          changeMsg.body.resource = childInfo.childId;\n        } //TODO: For Further Study\n\n\n        if (!_this.data._mutual) changeMsg.body.mutual = _this._mutual;\n\n        _this._bus.postMessage(changeMsg);\n      }\n    } //FLOW-IN: delta message received from a remote DataObjectReporter or DataObjectChild when changing data\n\n  }, {\n    key: \"_changeObject\",\n    value: function _changeObject(syncObj, msg) {\n      var _this = this; //TODO: update version ?\n      //how to handle an incorrect version ? Example: receive a version 3 when the observer is in version 1, where is the version 2 ?\n      //will we need to confirm the reception ?\n\n\n      if (_this._version + 1 <= msg.body.version) {\n        _this._version = msg.body.version;\n        var path = msg.body.attribute;\n        var value;\n        if (DataObject_typeof(msg.body.value) === 'object') value = deepClone(msg.body.value);else value = msg.body.value;\n        var findResult = syncObj.findBefore(path);\n\n        if (msg.body.lastModified) {\n          _this._metadata.lastModified = msg.body.lastModified;\n        } else {\n          _this._metadata.lastModified = new Date().toISOString();\n        }\n\n        if (msg.body.attributeType === ObjectType.ARRAY) {\n          if (msg.body.operation === ChangeType.ADD) {\n            var arr = findResult.obj;\n            var index = findResult.last;\n            Array.prototype.splice.apply(arr, [index, 0].concat(value));\n          } else if (msg.body.operation === ChangeType.REMOVE) {\n            var _arr = findResult.obj;\n            var _index = findResult.last;\n\n            _arr.splice(_index, value);\n          } else {\n            findResult.obj[findResult.last] = value; // UPDATE\n          }\n        } else {\n          if (msg.body.hasOwnProperty('value')) {\n            findResult.obj[findResult.last] = value; // UPDATE or ADD\n          } else {\n            delete findResult.obj[findResult.last]; // REMOVE\n          }\n        }\n      } else {\n        //TODO: how to handle unsynchronized versions?\n        DataObject_log.log('UNSYNCHRONIZED VERSION: (data => ' + _this._version + ', msg => ' + msg.body.version + ')');\n      }\n    } //FLOW-IN: message received from a remote DataObjectChild when changing data\n\n  }, {\n    key: \"_changeChildren\",\n    value: function _changeChildren(msg) {\n      var _this = this;\n\n      var dividedURL = divideURL(msg.to);\n      var identity = dividedURL.identity; //    const resource = identity ? identity.substring(identity.lastIndexOf('/') + 1) : undefined;\n\n      var childId = msg.body.resource;\n      var children = _this._childrenObjects[childId];\n      DataObject_log.log('Change children: ', _this._owner, msg, resource);\n\n      if (children) {\n        _this._changeObject(children._syncObj, msg);\n      } else {\n        DataObject_log.warn('No children found for: ', childId);\n      }\n    }\n  }, {\n    key: \"metadata\",\n    get: function get() {\n      return this._metadata;\n    }\n    /**\r\n     * Object URL of reporter or observer\r\n     * @type {ObjectURL}\r\n     */\n\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this._url;\n    }\n    /**\r\n     * Object schema URL (this field is not yet stable, and is subsject to change)\r\n     * @type {SchemaURL}\r\n     */\n\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this._schema;\n    }\n    /**\r\n     * Status of the reporter or observer connection (this field is not yet stable, and is subsject to change)\r\n     * @type {Status} - Enum of: on | paused\r\n     */\n\n  }, {\n    key: \"status\",\n    get: function get() {\n      return this._status;\n    }\n    /**\r\n     * Data structure to be synchronized.\r\n     * @type {JSON} - JSON structure that should follow the defined schema, if any.\r\n     */\n\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._syncObj.data;\n    }\n    /**\r\n     * All created children's since the subscription, doesn't contain all children's since reporter creation.\r\n     * @type {Object<ChildId, DataObjectChild>}\r\n     */\n\n  }, {\n    key: \"childrens\",\n    get: function get() {\n      return this._childrenObjects;\n    }\n  }]);\n\n  return DataObject;\n}();\n\n/* harmony default export */ var syncher_DataObject = (DataObject_DataObject);\n// CONCATENATED MODULE: ./src/syncher/DataObjectReporter.js\nfunction DataObjectReporter_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { DataObjectReporter_typeof = function _typeof(obj) { return typeof obj; }; } else { DataObjectReporter_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return DataObjectReporter_typeof(obj); }\n\nfunction DataObjectReporter_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DataObjectReporter_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction DataObjectReporter_createClass(Constructor, protoProps, staticProps) { if (protoProps) DataObjectReporter_defineProperties(Constructor.prototype, protoProps); if (staticProps) DataObjectReporter_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction DataObjectReporter_possibleConstructorReturn(self, call) { if (call && (DataObjectReporter_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return DataObjectReporter_assertThisInitialized(self); }\n\nfunction DataObjectReporter_get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { DataObjectReporter_get = Reflect.get; } else { DataObjectReporter_get = function _get(target, property, receiver) { var base = DataObjectReporter_superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return DataObjectReporter_get(target, property, receiver || target); }\n\nfunction DataObjectReporter_superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = DataObjectReporter_getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction DataObjectReporter_getPrototypeOf(o) { DataObjectReporter_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return DataObjectReporter_getPrototypeOf(o); }\n\nfunction DataObjectReporter_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) DataObjectReporter_setPrototypeOf(subClass, superClass); }\n\nfunction DataObjectReporter_setPrototypeOf(o, p) { DataObjectReporter_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return DataObjectReporter_setPrototypeOf(o, p); }\n\nfunction DataObjectReporter_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar DataObjectReporter_log = loglevel[\"getLogger\"]('DataObjectReporter');\n\n\n/**\r\n * The class returned from the Syncher create call.\r\n * To be used as a reporter point, changes will be submited to DataObjectObserver instances.\r\n */\n\nvar DataObjectReporter_DataObjectReporter =\n/*#__PURE__*/\nfunction (_DataObject) {\n  DataObjectReporter_inherits(DataObjectReporter, _DataObject);\n\n  /* private\r\n  _subscriptions: <hypertyUrl: { status: string } }>\r\n    ----event handlers----\r\n  _onSubscriptionHandler: (event) => void\r\n  _onResponseHandler: (event) => void\r\n  _onReadHandler: (event) => void\r\n  */\n\n  /**\r\n   * @ignore\r\n   * Should not be used directly by Hyperties. It's called by the Syncher.create method\r\n   */\n  //constructor(syncher, url, created, reporter, runtime, schema, name, initialStatus, initialData, childrens, mutual = true, resumed = false, description, tags, resources, observerStorage, publicObservation) {\n  function DataObjectReporter(input) {\n    var _this2;\n\n    DataObjectReporter_classCallCheck(this, DataObjectReporter);\n\n    _this2 = DataObjectReporter_possibleConstructorReturn(this, DataObjectReporter_getPrototypeOf(DataObjectReporter).call(this, input));\n\n    var _this = DataObjectReporter_assertThisInitialized(DataObjectReporter_assertThisInitialized(_this2));\n\n    _this._subscriptions = {};\n\n    _this._syncObj.observe(function (event) {\n      DataObjectReporter_log.log('[Syncher.DataObjectReporter] ' + _this.url + ' publish change: ', event);\n\n      _this._onChange(event);\n    });\n\n    _this._allocateListeners();\n\n    _this.invitations = []; // array of promises with pending invitations\n\n    _this._childrenSizeThreshold = 50000; // to be used when replying to sync requests to ensure each response msg is not too large\n\n    return _this2;\n  }\n\n  DataObjectReporter_createClass(DataObjectReporter, [{\n    key: \"_allocateListeners\",\n    value: function _allocateListeners() {\n      DataObjectReporter_get(DataObjectReporter_getPrototypeOf(DataObjectReporter.prototype), \"_allocateListeners\", this).call(this);\n\n      var _this = this;\n\n      _this._objectListener = _this._bus.addListener(_this._url, function (msg) {\n        DataObjectReporter_log.log('[Syncher.DataObjectReporter] listener ' + _this._url + ' Received: ', msg);\n\n        switch (msg.type) {\n          case 'response':\n            _this._onResponse(msg);\n\n            break;\n\n          case 'read':\n            _this._onRead(msg);\n\n            break;\n\n          case 'execute':\n            _this._onExecute(msg);\n\n            break;\n\n          case 'create':\n            _this._onChildCreate(msg);\n\n            break;\n          // to create child objects that were sent whenn offline\n        }\n      });\n      _this._runtimeStatusListener = _this._bus.addListener(_this._syncher._runtimeUrl + '/status', function (evt) {\n        console.log('[Syncher.DataObjectReporter] runtime status event received ' + evt);\n\n        if (evt.body && evt.body.resource && evt.body.resource === _this._url && evt.body.value && evt.body.value.backupRevision) {\n          // broadcast backupRevision update\n          _this.data.backupRevision = evt.body.value.backupRevision;\n          console.log('[Syncher.DataObjectReporter] DO updated with backup revision ' + _this.data.backupRevision);\n        }\n      });\n    }\n  }, {\n    key: \"_releaseListeners\",\n    value: function _releaseListeners() {\n      DataObjectReporter_get(DataObjectReporter_getPrototypeOf(DataObjectReporter.prototype), \"_releaseListeners\", this).call(this);\n\n      var _this = this;\n\n      _this._objectListener.remove();\n    }\n    /**\r\n     * Send invitations (create messages) to hyperties, observers list.\r\n     * @param  {HypertyURL[]} observers List of Hyperty URL's\r\n     */\n\n  }, {\n    key: \"inviteObservers\",\n    value: function inviteObservers(observers, p2p) {\n      var _this = this; //FLOW-OUT: this message will be sent to the runtime instance of SyncherManager -> _onCreate\n      // TODO: remove value and add resources? should similar to 1st create\n\n\n      var toInvite = observers; // let invitePromises = [];\n\n      /*  observers.forEach((observer)=> {\r\n        if (!_this.invitations[observer]) {\r\n          toInvite.push(observer);\r\n          _this.invitations[observer] = observer;\r\n        }\r\n      });*/\n\n      if (toInvite.length > 0) {\n        DataObjectReporter_log.log('[Syncher.DataObjectReporter] InviteObservers ', toInvite, _this._metadata);\n        toInvite.forEach(function (observer) {\n          var invitation = new Promise(function (resolve, reject) {\n            var inviteMsg = {\n              type: 'create',\n              from: _this._syncher._owner,\n              to: _this._syncher._subURL,\n              body: {\n                resume: false,\n                resource: _this._url,\n                schema: _this._schema,\n                value: _this._metadata,\n                authorise: [observer]\n              }\n            };\n            if (p2p) inviteMsg.body.p2p = p2p;\n            if (!_this.data.mutual) inviteMsg.body.mutual = _this.data.mutual;\n\n            _this._bus.postMessage(inviteMsg, function (reply) {\n              DataObjectReporter_log.log('[Syncher.DataObjectReporter] Invitation reply ', reply);\n              var result = {\n                invited: observer,\n                code: reply.body && reply.body.code ? reply.body.code : 500,\n                desc: reply.body && reply.body.desc ? reply.body.desc : 'Unknown'\n              };\n              if (result.code < 300) resolve(result);\n              /*            else if (result.code >= 300) {\r\n                            if (_this.metadata.offline) {\r\n                              resolve(_this._processOfflineInvitation(inviteMsg));\r\n                            }*/\n              else reject(result); //            } \n            });\n          });\n\n          _this.invitations.push(invitation);\n        }); //      return(invitePromises);\n      }\n    }\n    /**\r\n     * Release and delete object data\r\n     */\n\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      var _this = this;\n\n      if (_this._heartBeat) _this._heartBeat.stop();\n\n      _this._deleteChildrens().then(function (result) {\n        DataObjectReporter_log.log(result); //FLOW-OUT: this message will be sent to the runtime instance of SyncherManager -> _onDelete\n\n        var deleteMsg = {\n          type: 'delete',\n          from: _this._owner,\n          to: _this._syncher._subURL,\n          body: {\n            resource: _this._url\n          }\n        };\n\n        _this._bus.postMessage(deleteMsg, function (reply) {\n          DataObjectReporter_log.log('DataObjectReporter-DELETE: ', reply);\n\n          if (reply.body.code === 200) {\n            _this._releaseListeners();\n\n            delete _this._syncher._reporters[_this._url]; //_this._syncObj.unobserve();\n\n            _this._syncObj = {};\n          }\n        });\n      });\n    }\n    /**\r\n     * Subscriptions requested and accepted to this reporter\r\n     * @type {Object<HypertyURL, SyncSubscription>}\r\n     */\n\n  }, {\n    key: \"onSubscription\",\n\n    /**\r\n     * Setup the callback to process subscribe and unsubscribe notifications\r\n     * @param {function(event: MsgEvent)} callback function to receive events\r\n     */\n    value: function onSubscription(callback) {\n      this._onSubscriptionHandler = callback;\n    }\n    /**\r\n     * Setup the callback to process response notifications of the create's\r\n     * @param {function(event: MsgEvent)} callback function to receive events\r\n     */\n\n  }, {\n    key: \"onResponse\",\n    value: function onResponse(callback) {\n      this._onResponseHandler = callback;\n    }\n    /**\r\n     * Setup the callback to process read notifications\r\n     * @param {function(event: MsgEvent)} callback\r\n     */\n\n  }, {\n    key: \"onRead\",\n    value: function onRead(callback) {\n      this._onReadHandler = callback;\n    }\n    /**\r\n     * Setup the callback to process execute notifications\r\n     * @param {function(event: MsgEvent)} callback\r\n     */\n\n  }, {\n    key: \"onExecute\",\n    value: function onExecute(callback) {\n      this._onExecuteHandler = callback;\n    } //FLOW-IN: message received from parent Syncher -> _onForward\n\n  }, {\n    key: \"_onForward\",\n    value: function _onForward(msg) {\n      var _this = this;\n\n      DataObjectReporter_log.log('DataObjectReporter-RCV: ', msg);\n\n      switch (msg.body.type) {\n        case 'subscribe':\n          _this._onSubscribe(msg);\n\n          break;\n\n        case 'unsubscribe':\n          _this._onUnSubscribe(msg);\n\n          break;\n      }\n    } //FLOW-IN: message received from this -> _onForward: emitted by a remote Syncher -> subscribe\n\n  }, {\n    key: \"_onSubscribe\",\n    value: function _onSubscribe(msg) {\n      var _this = this;\n\n      var hypertyUrl = msg.body.from;\n      var dividedURL = divideURL(hypertyUrl);\n      var domain = dividedURL.domain;\n      var mutual = true;\n      if (msg.body.hasOwnProperty('mutual') && !msg.body.mutual) mutual = false;\n      console.log('[DataObjectReporter._onSubscribe]', msg, domain, dividedURL);\n      var event = {\n        type: msg.body.type,\n        url: hypertyUrl,\n        domain: domain,\n        identity: msg.body.identity,\n        nutual: mutual,\n        accept: function accept() {\n          //create new subscription\n          var sub = {\n            url: hypertyUrl,\n            status: 'live'\n          };\n          _this._subscriptions[hypertyUrl] = sub;\n\n          if (_this.metadata.subscriptions) {\n            _this.metadata.subscriptions.push(sub.url);\n          }\n\n          var msgValue = deepClone(_this._metadata);\n          msgValue.data = deepClone(_this.data);\n          msgValue.version = _this._version; //process and send childrens data\n          // let childrenValues = {};\n          //\n          // if (_this._childrenObjects) {\n          //   Object.keys(_this._childrenObjects).forEach((childrenId) => {\n          //     let childrenData = _this._childrenObjects[childrenId];\n          //     childrenValues[childrenId] = deepClone(childrenData);\n          //   });\n          //   msgValue.childrenObjects = childrenValues;\n          // }\n\n          var sendMsg = {\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: 200,\n              schema: _this._schema,\n              value: msgValue\n            }\n          }; //TODO: For Further Study\n\n          if (msg.body.hasOwnProperty('mutual') && !msg.body.mutual) {\n            sendMsg.body.mutual = msg.body.mutual; // TODO: remove?\n\n            _this.data.mutual = false;\n          }\n\n          if (_this._heartBeat) {\n            sendMsg.body.value.childrenObjects = {};\n            sendMsg.body.value.childrenObjects.heartbeat = _this._heartBeat.heartbeat;\n          }\n\n          console.log('[DataObjectReporter._onSubscribe.accept] sending response: ', sendMsg); //send ok response message\n\n          _this._bus.postMessage(sendMsg);\n\n          return sub;\n        },\n        reject: function reject(reason) {\n          //send reject response message\n          _this._bus.postMessage({\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: 403,\n              desc: reason\n            }\n          });\n        }\n      };\n\n      if (_this._onSubscriptionHandler) {\n        DataObjectReporter_log.log('SUBSCRIPTION-EVENT: ', event);\n\n        _this._onSubscriptionHandler(event);\n      }\n    } //FLOW-IN: message received from this -> _onForward: emitted by a remote DataObjectObserver -> unsubscribe\n\n  }, {\n    key: \"_onUnSubscribe\",\n    value: function _onUnSubscribe(msg) {\n      var _this = this;\n\n      var hypertyUrl = msg.body.from;\n      var dividedURL = divideURL(hypertyUrl);\n      var domain = dividedURL.domain;\n      DataObjectReporter_log.log('[DataObjectReporter._onUnSubscribe]', msg, domain, dividedURL); //let sub = _this._subscriptions[hypertyUrl];\n\n      delete _this._subscriptions[hypertyUrl];\n      delete _this.invitations[hypertyUrl];\n      var event = {\n        type: msg.body.type,\n        url: hypertyUrl,\n        domain: domain,\n        identity: msg.body.identity\n      }; // TODO: check if the _onSubscriptionHandler it is the same of the subscriptions???\n\n      if (_this._onSubscriptionHandler) {\n        DataObjectReporter_log.log('UN-SUBSCRIPTION-EVENT: ', event);\n\n        _this._onSubscriptionHandler(event);\n      }\n    } //FLOW-IN: message received from ReporterURL address: emited by a remote Syncher -> _onRemoteCreate -> event.ack\n\n  }, {\n    key: \"_onResponse\",\n    value: function _onResponse(msg) {\n      var _this = this;\n\n      var event = {\n        type: msg.type,\n        url: msg.from,\n        code: msg.body.code\n      };\n\n      if (_this._onResponseHandler) {\n        DataObjectReporter_log.log('RESPONSE-EVENT: ', event);\n\n        _this._onResponseHandler(event);\n      }\n    } //FLOW-IN: message received from ReporterURL address: emited by a remote Syncher -> read\n\n  }, {\n    key: \"_onRead\",\n    value: function _onRead(msg) {\n      var _this = this;\n\n      var childrensSize = JSON.stringify(_this.childrensJSON).length;\n      var largeObject = childrensSize > _this._childrenSizeThreshold ? true : false;\n      var event = {\n        type: msg.type,\n        url: msg.from,\n        accept: function accept() {\n          if (largeObject) _this._syncReplyForLargeData(msg);else _this._syncReply(msg);\n        },\n        reject: function reject(reason) {\n          _this._bus.postMessage({\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: 401,\n              desc: reason\n            }\n          });\n        }\n      }; // if the requester is an authorised observer, the data object is responded otherwise an event is triggered\n\n      var subscriptions = [];\n\n      if (_this.metadata.subscriptions) {\n        subscriptions = _this.metadata.subscriptions;\n      } else if (_this._subscriptions) {\n        subscriptions = Object.keys(_this._subscriptions).map(function (key) {\n          return _this._subscriptions[key].url;\n        });\n      }\n\n      if (subscriptions.indexOf(msg.from) != -1) {\n        if (largeObject) _this._syncReplyForLargeData(msg);else _this._syncReply(msg);\n      } else if (_this._onReadHandler) {\n        DataObjectReporter_log.log('READ-EVENT: ', event);\n\n        _this._onReadHandler(event);\n      }\n    }\n  }, {\n    key: \"_syncReply\",\n    value: function _syncReply(msg) {\n      var _this = this;\n\n      var objectValue = deepClone(_this.metadata);\n      objectValue.data = deepClone(_this.data);\n      objectValue.childrenObjects = deepClone(_this.childrensJSON);\n      objectValue.version = _this._version;\n      var response = {\n        id: msg.id,\n        type: 'response',\n        from: msg.to,\n        to: msg.from,\n        body: {\n          code: 200,\n          value: objectValue\n        }\n      };\n\n      _this._bus.postMessage(response);\n    } // This function is only used if the data object to be synched has childrenOjects too large\n\n  }, {\n    key: \"_syncReplyForLargeData\",\n    value: function _syncReplyForLargeData(msg) {\n      //set attribute with number of spllited messages\n      var _this = this; // lets set the initial message with no childObjects\n\n\n      var objectValue = deepClone(_this.metadata);\n      objectValue.data = deepClone(_this.data);\n      objectValue.version = _this._version;\n      delete objectValue.childrenObjects;\n      var children;\n      var values = []; // array of values to be sent in separated responses\n\n      var childrenValue = {}; // value to be used in each response\n\n      for (child in _this._childrenObjects) {\n        //      let child;\n        childrenValue[child] = {}; //      for (child in _this._childrenObjects[children]) {\n\n        if (JSON.stringify(childrenValue).length > _this._childrenSizeThreshold) {\n          //childrenValue big enough to be sent in a response message\n          values.push(childrenValue); //          childrenValue = {};\n          //          childrenValue[child] = {};\n        }\n\n        childrenValue[child] = {};\n        childrenValue[child].value = _this._childrenObjects[child].metadata;\n        childrenValue[child].identity = _this._childrenObjects[child].identity; //      }\n      }\n\n      values.push(childrenValue);\n      objectValue.responses = values.length + 1; //number of responses to be sent\n\n      var initialResponse = {\n        id: msg.id,\n        type: 'response',\n        from: msg.to,\n        to: msg.from,\n        body: {\n          code: 100,\n          value: objectValue\n        }\n      };\n\n      _this._bus.postMessage(initialResponse);\n\n      values.forEach(function (value) {\n        var response = deepClone(initialResponse);\n        response.body.value = value;\n        response.body.value.responses = objectValue.responses;\n        setTimeout(function () {\n          _this._bus.postMessage(response);\n        }, 50); // should put a timeout?\n      });\n    } // Execute request received\n\n  }, {\n    key: \"_onExecute\",\n    value: function _onExecute(msg) {\n      var _this = this;\n\n      if (!msg.body.method) throw '[DataObjectReporter._onExecute] method missing ', msg;\n      var response = {\n        id: msg.id,\n        type: 'response',\n        from: msg.to,\n        to: msg.from,\n        body: {\n          code: 200\n        }\n      };\n      var event = {\n        type: msg.type,\n        url: msg.from,\n        method: msg.body.method,\n        params: msg.body.params,\n        accept: function accept() {\n          _this._bus.postMessage(response);\n        },\n        reject: function reject(reason) {\n          _this._bus.postMessage({\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: 401,\n              desc: reason\n            }\n          });\n        }\n      };\n\n      if (_this._onExecuteHandler) {\n        DataObjectReporter_log.log('[DataObjectReporter] EXECUTE-EVENT: ', event);\n\n        _this._onExecuteHandler(event);\n      }\n    }\n  }, {\n    key: \"subscriptions\",\n    get: function get() {\n      return this._subscriptions;\n    }\n  }, {\n    key: \"childrensJSON\",\n    get: function get() {\n      var _this = this;\n\n      var childrens = {}; //    let children;\n      //    for (children in _this._childrenObjects) {\n\n      var child; //      childrens[children] = {};\n\n      for (child in _this._childrenObjects) {\n        childrens[child] = {};\n        childrens[child].value = _this._childrenObjects[child].metadata;\n        childrens[child].identity = _this._childrenObjects[child].identity;\n      } //    }\n\n\n      return childrens;\n    }\n  }]);\n\n  return DataObjectReporter;\n}(syncher_DataObject\n/* implements SyncStatus */\n);\n\n/* harmony default export */ var syncher_DataObjectReporter = (DataObjectReporter_DataObjectReporter);\n// CONCATENATED MODULE: ./src/syncher/DataObjectObserver.js\nfunction DataObjectObserver_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { DataObjectObserver_typeof = function _typeof(obj) { return typeof obj; }; } else { DataObjectObserver_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return DataObjectObserver_typeof(obj); }\n\nfunction DataObjectObserver_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DataObjectObserver_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction DataObjectObserver_createClass(Constructor, protoProps, staticProps) { if (protoProps) DataObjectObserver_defineProperties(Constructor.prototype, protoProps); if (staticProps) DataObjectObserver_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction DataObjectObserver_possibleConstructorReturn(self, call) { if (call && (DataObjectObserver_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return DataObjectObserver_assertThisInitialized(self); }\n\nfunction DataObjectObserver_get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { DataObjectObserver_get = Reflect.get; } else { DataObjectObserver_get = function _get(target, property, receiver) { var base = DataObjectObserver_superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return DataObjectObserver_get(target, property, receiver || target); }\n\nfunction DataObjectObserver_superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = DataObjectObserver_getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction DataObjectObserver_getPrototypeOf(o) { DataObjectObserver_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return DataObjectObserver_getPrototypeOf(o); }\n\nfunction DataObjectObserver_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) DataObjectObserver_setPrototypeOf(subClass, superClass); }\n\nfunction DataObjectObserver_setPrototypeOf(o, p) { DataObjectObserver_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return DataObjectObserver_setPrototypeOf(o, p); }\n\nfunction DataObjectObserver_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar DataObjectObserver_log = loglevel[\"getLogger\"]('DataObjectObserver');\n\n\nvar FilterType = {\n  ANY: 'any',\n  START: 'start',\n  EXACT: 'exact'\n};\n/**\r\n * The class returned from the Syncher subscribe call.\r\n * To be used as an observation point from a DataObjectReporter change.\r\n */\n\nvar DataObjectObserver_DataObjectObserver =\n/*#__PURE__*/\nfunction (_DataObject) {\n  DataObjectObserver_inherits(DataObjectObserver, _DataObject);\n\n  /* private\r\n  _changeListener: MsgListener\r\n    ----event handlers----\r\n  _filters: {<filter>: {type: <start, exact>, callback: <function>} }\r\n  */\n\n  /**\r\n   * @ignore\r\n   * Should not be used directly by Hyperties. It's called by the Syncher.subscribe method\r\n   */\n  //TODO: For Further Study\n  function DataObjectObserver(input) {\n    var _this2;\n\n    DataObjectObserver_classCallCheck(this, DataObjectObserver);\n\n    //todo: check why\n    //input.initialData = input.initialData.data;\n    _this2 = DataObjectObserver_possibleConstructorReturn(this, DataObjectObserver_getPrototypeOf(DataObjectObserver).call(this, input));\n\n    var _this = DataObjectObserver_assertThisInitialized(DataObjectObserver_assertThisInitialized(_this2));\n\n    _this._version = input.version;\n    _this._filters = {};\n\n    _this._syncObj.observe(function (event) {\n      _this._onFilter(event);\n    });\n\n    _this._allocateListeners();\n\n    return _this2;\n  }\n  /**\r\n   * Sync Data Object Observer with last version of Data Object Reporter. Useful for Resumes\r\n   */\n\n\n  DataObjectObserver_createClass(DataObjectObserver, [{\n    key: \"sync\",\n    value: function sync() {\n      var _this = this;\n\n      DataObjectObserver_log.info('[DataObjectObserver_sync] synchronising ');\n      return new Promise(function (resolve, reject) {\n        var criteria = {}; //      if (this.metadata.backupRevision) criteria.backupRevision = this.metadata.backupRevision;\n\n        _this._syncher.read(_this._metadata.url, criteria).then(function (value) {\n          DataObjectObserver_log.info('[DataObjectObserver_sync] value to sync: ', value);\n          Object.assign(_this.data, deepClone(value.data));\n          _this._version = value.version;\n          _this._metadata.lastModified = value.lastModified; //TODO: check first if there are new childrenObjects to avoid overhead\n\n          if (value.childrenObjects) {\n            _this.resumeChildrens(value.childrenObjects);\n\n            _this._storeChildrens();\n\n            resolve(true);\n          } else resolve(true);\n          /*if (value.version != _this._version) {\r\n            log.info('[DataObjectObserver_sync] updating existing data: ', _this.data);\r\n              Object.assign(_this.data || {}, deepClone(value.data));\r\n              _this._metadata = deepClone(value);\r\n              delete _this._metadata.data;\r\n              _this._version = value.version;\r\n            } else {\r\n            log.info('[DataObjectObserver_sync] existing data is updated: ', value);\r\n          }*/\n\n        }).catch(function (reason) {\n          DataObjectObserver_log.info('[DataObjectObserver_sync] sync failed: ', reason);\n          resolve(false);\n        });\n      });\n    }\n  }, {\n    key: \"_storeChildrens\",\n    value: function _storeChildrens() {\n      var _this = this;\n\n      var childrens = {}; //TODO: to be sent to HypertyResourceStorage when ready to handle Chat Messages\n\n      Object.keys(_this._childrenObjects).forEach(function (childId) {\n        var children = _this._childrenObjects; //      childrens[childrenResource] = {};\n        //      Object.keys(children).forEach((childId) => {\n\n        childrens[childId] = {};\n        childrens[childId].value = children[childId].metadata;\n        childrens[childId].identity = children[childId].identity; //      });\n      });\n      var msg = {\n        from: _this._owner,\n        to: _this._syncher._subURL,\n        type: 'create',\n        body: {\n          resource: _this._url,\n          attribute: 'childrenObjects',\n          value: childrens\n        }\n      };\n\n      _this._bus.postMessage(msg);\n    }\n  }, {\n    key: \"_allocateListeners\",\n    value: function _allocateListeners() {\n      DataObjectObserver_get(DataObjectObserver_getPrototypeOf(DataObjectObserver.prototype), \"_allocateListeners\", this).call(this);\n\n      var _this = this;\n\n      _this._changeListener = _this._bus.addListener(_this._url + '/changes', function (msg) {\n        if (msg.type === 'update') {\n          DataObjectObserver_log.log('DataObjectObserver-' + _this._url + '-RCV: ', msg);\n\n          _this._changeObject(_this._syncObj, msg);\n        }\n      });\n    }\n  }, {\n    key: \"_releaseListeners\",\n    value: function _releaseListeners() {\n      DataObjectObserver_get(DataObjectObserver_getPrototypeOf(DataObjectObserver.prototype), \"_releaseListeners\", this).call(this);\n\n      var _this = this;\n\n      _this._changeListener.remove();\n    }\n    /**\r\n     * Release and delete object data\r\n     */\n\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      var _this = this;\n\n      if (_this._heartBeat) _this._heartBeat.stop();\n\n      _this._deleteChildrens().then(function () {\n        _this.unsubscribe();\n\n        _this._releaseListeners();\n\n        delete _this._syncher._observers[_this._url];\n      });\n    }\n    /**\r\n     * Release and delete object data\r\n     */\n\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      var _this = this; //FLOW-OUT: this message will be sent to the runtime instance of SyncherManager -> _onLocalUnSubscribe\n\n\n      var unSubscribeMsg = {\n        type: 'unsubscribe',\n        from: _this._owner,\n        to: _this._syncher._subURL,\n        body: {\n          resource: _this._url\n        }\n      };\n\n      _this._bus.postMessage(unSubscribeMsg, function (reply) {\n        DataObjectObserver_log.log('DataObjectObserver-UNSUBSCRIBE: ', reply);\n\n        if (reply.body.code === 200) {\n          _this._releaseListeners();\n\n          delete _this._syncher._observers[_this._url];\n        }\n      });\n    }\n    /**\r\n     * Register the change listeners sent by the reporter\r\n     * @param {string} filter - Filter that identifies the field (separated dot path). Accepts * at the end for a more unrestricted filtering.\r\n     * @param {function(event: MsgEvent)} callback\r\n     */\n\n  }, {\n    key: \"onChange\",\n    value: function onChange(filter, callback) {\n      var key = filter;\n      var filterObj = {\n        type: FilterType.EXACT,\n        callback: callback\n      };\n      var idx = filter.indexOf('*');\n\n      if (idx === filter.length - 1) {\n        if (idx === 0) {\n          filterObj.type = FilterType.ANY;\n        } else {\n          filterObj.type = FilterType.START;\n          key = filter.substr(0, filter.length - 1);\n        }\n      }\n\n      this._filters[key] = filterObj;\n    }\n  }, {\n    key: \"_onFilter\",\n    value: function _onFilter(event) {\n      var _this = this;\n\n      Object.keys(_this._filters).forEach(function (key) {\n        var filter = _this._filters[key];\n\n        if (filter.type === FilterType.ANY) {\n          //match anything\n          filter.callback(event);\n        } else if (filter.type === FilterType.START) {\n          //if starts with filter...\n          if (event.field.indexOf(key) === 0) {\n            filter.callback(event);\n          }\n        } else if (filter.type === FilterType.EXACT) {\n          //exact match\n          if (event.field === key) {\n            filter.callback(event);\n          }\n        }\n      });\n    }\n  }, {\n    key: \"onDisconnected\",\n    value: function onDisconnected(callback) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this3._subscribeRegistration().then(function () {\n          _this3._onDisconnected = callback;\n          resolve();\n        }).catch(function (err) {\n          return reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"_subscribeRegistration\",\n    value: function _subscribeRegistration() {\n      var _this4 = this;\n\n      var msg = {\n        type: 'subscribe',\n        from: this._owner,\n        to: this._syncher._runtimeUrl + '/subscriptions',\n        body: {\n          resources: [this._url + '/registration']\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this4._bus.postMessage(msg, function (reply) {\n          DataObjectObserver_log.log(\"[DataObjectObserver._subscribeRegistration] \".concat(_this4._url, \" rcved reply \"), reply);\n\n          if (reply.body.code === 200) {\n            _this4._generateListener(_this4._url + '/registration');\n\n            resolve();\n          } else {\n            DataObjectObserver_log.error('Error subscribing registration status for ', _this4._url);\n            reject('Error subscribing registration status for ' + _this4._url);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_generateListener\",\n    value: function _generateListener(notificationURL) {\n      var _this = this;\n\n      _this._bus.addListener(notificationURL, function (msg) {\n        DataObjectObserver_log.log(\"[DataObjectObserver.registrationNotification] \".concat(_this._url, \": \"), msg);\n\n        if (msg.body.value && msg.body.value === 'disconnected' && _this._onDisconnected) {\n          DataObjectObserver_log.log(\"[DataObjectObserver] \".concat(_this._url, \": was disconnected \"), msg);\n\n          _this._onDisconnected();\n        }\n      });\n    }\n    /**\r\n     * Requests the reporter to execute a method on the data object\r\n     * @param {string} method - Name of the function to be executed.\r\n     * @param {array} params - array of parameters for the requested function\r\n     * @return {promise}\r\n     */\n\n  }, {\n    key: \"execute\",\n    value: function execute(method, params) {\n      var _this5 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var msg = {\n          type: 'execute',\n          from: _this5._owner,\n          to: _this._url,\n          body: {\n            method: method,\n            params: params\n          }\n        };\n\n        _this._bus.postMessage(msg, function (reply) {\n          DataObjectObserver_log.log(\"[DataObjectObserver.execute] \".concat(_this._url, \" rcved reply \"), reply);\n\n          if (reply.body.code === 200) {\n            resolve();\n          } else {\n            DataObjectObserver_log.warn(\"[DataObjectObserver.execute] execution of method \".concat(method, \" was reject by reporter\"));\n            reject(\"[DataObjectObserver.execute] execution of method \".concat(method, \" was reject by reporter\"));\n          }\n        });\n      });\n    }\n  }]);\n\n  return DataObjectObserver;\n}(syncher_DataObject\n/* implements SyncStatus */\n);\n\n/* harmony default export */ var syncher_DataObjectObserver = (DataObjectObserver_DataObjectObserver);\n// CONCATENATED MODULE: ./src/syncher/DataProvisional.js\nfunction DataProvisional_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DataProvisional_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction DataProvisional_createClass(Constructor, protoProps, staticProps) { if (protoProps) DataProvisional_defineProperties(Constructor.prototype, protoProps); if (staticProps) DataProvisional_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n * @access private\r\n * This class is responsible for collecting delta changes in remote objects, before the response of subscription reach the observer.\r\n * It's used in Syncher -> subscribe. The flow is defined as:\r\n * 1. (observer) --subscribe--\x3e (reporter)\r\n * 2. (observer) <--delta updates-- (reporter)\r\n * 3. (observer) <--subscribe response-- (reporter)\r\n * This means that there could be delta updates transferred before the subscription confirmation.\r\n * Since there is no DataObjectObserver before the ubscription confirmation, there should be some other object collecting the updates.\r\n * Provisional data is applied to the DataObjectObserver after confirmation. Or discarded if there is no confirmation.\r\n */\n// Log System\n\nvar DataProvisional_log = loglevel[\"getLogger\"]('DataProvisional');\n\nvar DataProvisional =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _childrenListeners: [MsgListener]\r\n  _listener: MsgListener\r\n    _changes: []\r\n  */\n  function DataProvisional(owner, url, bus, children) {\n    DataProvisional_classCallCheck(this, DataProvisional);\n\n    var _this = this;\n\n    _this._owner = owner;\n    _this._url = url;\n    _this._bus = bus;\n    _this._children = children;\n    _this._changes = [];\n\n    _this._allocateListeners();\n  }\n\n  DataProvisional_createClass(DataProvisional, [{\n    key: \"_allocateListeners\",\n    value: function _allocateListeners() {\n      var _this = this;\n\n      _this._listener = _this._bus.addListener(_this._url, function (msg) {\n        DataProvisional_log.log('DataProvisional-' + _this._url + '-RCV: ', msg);\n\n        _this._changes.push(msg);\n      });\n      /*\r\n      _this._childrenListeners = [];\r\n      if (_this._children) {\r\n        let childBaseURL = url + '/children/';\r\n        _this._children.forEach((child) => {\r\n          let childURL = childBaseURL + child;\r\n          let listener = _this._bus.addListener(childURL, (msg) => {\r\n            //ignore msg sent by himself\r\n            if (msg.from !== owner) {\r\n              log.log(msg);\r\n            }\r\n          });\r\n            _this._childrenListeners.push(listener);\r\n        });\r\n      }*/\n    }\n  }, {\n    key: \"_releaseListeners\",\n    value: function _releaseListeners() {\n      var _this = this;\n\n      _this._listener.remove();\n      /*_this._childrenListeners.forEach((listener) => {\r\n        listener.remove();\r\n      });*/\n\n    }\n  }, {\n    key: \"apply\",\n    value: function apply(observer) {\n      var _this = this;\n\n      _this._changes.forEach(function (change) {\n        observer._changeObject(observer._syncObj, change);\n      });\n    }\n  }, {\n    key: \"children\",\n    get: function get() {\n      return this._children;\n    }\n  }]);\n\n  return DataProvisional;\n}();\n\n/* harmony default export */ var syncher_DataProvisional = (DataProvisional);\n// CONCATENATED MODULE: ./src/syncher/Syncher.js\nfunction Syncher_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Syncher_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Syncher_createClass(Constructor, protoProps, staticProps) { if (protoProps) Syncher_defineProperties(Constructor.prototype, protoProps); if (staticProps) Syncher_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar Syncher_log = loglevel[\"getLogger\"]('Syncher');\n\n\n\n\n/**\r\n* The main class for the syncher package.\r\n* The Syncher is a singleton class per Hyperty/URL and it is the owner of all created Data Sync Objects according to the Reporter - Observer pattern.\r\n* Main functionality is to create reporters and to subscribe to existing ones.\r\n*/\n\nvar Syncher_Syncher =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _owner: URL\r\n  _bus: MiniBus\r\n    _subURL: URL\r\n    _reporters: <url: DataObjectReporter>\r\n  _observers: <url: DataObjectObserver>\r\n  _provisionals: <url: DataProvisional>\r\n    ----event handlers----\r\n  _onNotificationHandler: (event) => void\r\n  _onResume: (event) => void\r\n  */\n\n  /**\r\n  * Constructor that should be used by the Hyperty owner\r\n  * @param {HypertyURL} owner - Hyperty URL owner. An URL allocated by the runtime that uniquely identifies the Hyperty.\r\n  * @param {MiniBus} bus - An instance of the MiniBus provided in the sandbox. When an object (Reporter or Observed) is created, the SyncherManager will add a listener in the MiniBus to receive/send Messages of that object.\r\n  * @param {JSON} config - Configuration data. The only required field for now is the runtimeURL.\r\n  */\n  function Syncher(owner, bus, config) {\n    Syncher_classCallCheck(this, Syncher);\n\n    var _this = this;\n\n    _this._owner = owner;\n    _this._bus = bus;\n    _this._subURL = config.runtimeURL + '/sm';\n    _this._runtimeUrl = config.runtimeURL;\n    _this._p2pHandler = config.p2pHandler;\n    _this._p2pRequester = config.p2pRequester;\n    _this._reporters = {};\n    _this._observers = {};\n    _this._provisionals = {};\n    bus.addListener(owner, function (msg) {\n      //ignore msg sent by himself\n      if (msg.from !== owner) {\n        Syncher_log.info('[Syncher] Syncher-RCV: ', msg, _this);\n\n        switch (msg.type) {\n          case 'forward':\n            _this._onForward(msg);\n\n            break;\n\n          case 'create':\n            _this._onRemoteCreate(msg);\n\n            break;\n\n          case 'delete':\n            _this._onRemoteDelete(msg);\n\n            break;\n\n          case 'execute':\n            _this._onExecute(msg);\n\n            break;\n        }\n      }\n    });\n  }\n  /**\r\n  * The owner of the Syncher and all created reporters.\r\n  * @type {HypertyURL}\r\n  */\n\n\n  Syncher_createClass(Syncher, [{\n    key: \"create\",\n\n    /**\r\n    * Request a DataObjectReporter creation. The URL will be be requested by the allocation mechanism.\r\n    * @param  {SchemaURL} schema - Hyperty Catalogue URL address that can be used to retrieve the JSON-Schema describing the Data Object schema\r\n    * @param  {HypertyURL[]} observers - List of hyperties that are pre-authorized for subscription\r\n    * @param  {JSON} initialData - Initial data of the reporter\r\n    * @param  {boolean} store - (Optional) if true, object will be stored by the runtime\r\n    * @param  {boolean} p2p - (Optional) if true, data synchronisation stream will use p2p connection as much as possible\r\n    * @param  {string} name - (Optional) the name of the dataobject\r\n    * @param  {MessageBodyIdentity} identity - (optional) identity data to be added to identity the user reporter. To be used for legacy identities.\r\n    * @param  {SyncMetadata} input - (optional) all metadata required to sunc the Data Object.\r\n    * @return {Promise<DataObjectReporter>} Return Promise to a new Reporter. The reporter can be accepted or rejected by the PEP\r\n    */\n    value: function create(schema, observers, initialData) {\n      var store = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var p2p = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var name = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 'no name';\n      var identity = arguments.length > 6 ? arguments[6] : undefined;\n      var input = arguments.length > 7 ? arguments[7] : undefined;\n      if (!schema) throw Error('[Syncher - Create] - You need specify the data object schema');\n      if (!observers) throw Error('[Syncher - Create] -The observers should be defined');\n\n      var _this = this;\n\n      input = input || {};\n      var createInput = Object.assign({}, input);\n      createInput.p2p = p2p;\n      createInput.store = store;\n      createInput.schema = schema;\n      createInput.authorise = observers;\n      createInput.p2pHandler = _this._p2pHandler;\n      createInput.p2pRequester = _this._p2pRequester;\n      initialData ? createInput.data = deepClone(initialData) : createInput.data = {};\n      createInput.name = name.length === 0 ? 'no name' : name;\n      createInput.reporter = input.hasOwnProperty('reporter') && typeof input.reporter !== 'boolean' ? input.reporter : _this._owner;\n      createInput.resume = false;\n\n      if (input) {\n        createInput.mutual = input.hasOwnProperty('mutual') ? input.mutual : false;\n        createInput.name = input.hasOwnProperty('name') ? input.name : createInput.name;\n      } else {\n        createInput.mutual = false;\n      }\n\n      if (input.hasOwnProperty('reuseURL')) {\n        createInput.resource = input.reuseURL;\n      }\n\n      if (identity) {\n        createInput.identity = identity;\n      } //Object.assign(createInput, {resume: false});\n      //debugger;\n      //    console.log('[syncher - create] - create Reporter - createInput: ', createInput);\n\n\n      return _this._create(createInput);\n    }\n    /**\r\n    * Request a DataObjectReporter creation. The URL will be be requested by the allocation mechanism.\r\n    * @param  {Object} criteria - (optional) identity data to be added to identity the user reporter. To be used for legacy identities.\r\n    * @return {Promise<DataObjectReporter>[]} Return a promise with a list of DataObjectReporter to be resumed;\r\n    */\n\n  }, {\n    key: \"resumeReporters\",\n    value: function resumeReporters(criteria) {\n      var _this = this;\n\n      Syncher_log.log('[syncher - create] - resume Reporter - criteria: ', criteria);\n      Object.assign(criteria, {\n        resume: true\n      });\n      return _this._resumeCreate(criteria);\n    }\n    /**\r\n    * Request a subscription to an existent reporter object.\r\n    * @param {SchemaURL} schema - Hyperty Catalogue URL address that can be used to retrieve the JSON-Schema describing the Data Object schema\r\n    * @param {ObjectURL} objURL - Address of the existent reporter object to be observed\r\n    * @param {Boolean} [store=false] - Save the subscription on the Syncher Manager for further resume (Default is false)\r\n    * @param {Boolean} [p2p=false] - Info about if should use p2p connection (Default is false)\r\n    * @param {Boolean} [mutual=true] - Info about if messages of this object should be encrypted (Default is true)\r\n    * @param  {MessageBodyIdentity} identity - (optional) identity data to be added to identity the user reporter. To be used for legacy identities.\r\n    * @return {Promise<DataObjectObserver>} Return Promise to a new observer. It's associated with the reporter.\r\n    */\n\n  }, {\n    key: \"subscribe\",\n    value: function subscribe(input) {\n      /*  let _this = this;\r\n        let criteria = {};\r\n          criteria.p2p = p2p;\r\n        criteria.store = store;\r\n        criteria.schema = schema;\r\n        criteria.domain_subscription = domain_subscription;\r\n          criteria.resource = objURL;\r\n        if (identity)      { criteria.identity = identity; }\r\n          //TODO: For Further Study\r\n        criteria.mutual = mutual;\r\n          log.log('[syncher - subscribe] - subscribe criteria: ', criteria);\r\n          Object.assign(criteria, {resume: false});*/\n      return this._subscribe(input);\n    }\n    /**\r\n    * Request a subscription to an existent reporter object.\r\n    * @param {criteria} criteria - Information to discovery the observer object\r\n    * @return {Promise<DataObjectObserver>} Return Promise to a new observer. It's associated with the reporter.\r\n    */\n\n  }, {\n    key: \"resumeObservers\",\n    value: function resumeObservers(criteria) {\n      var _this = this;\n\n      var _criteria = criteria || {};\n\n      Object.assign(_criteria, {\n        resume: true\n      });\n      return _this._resumeSubscribe(_criteria);\n    }\n    /**\r\n    * Request a read action on the reporter object\r\n    * @param {ObjectURL} objURL - URL of the reporter object to be read\r\n    * @return {Promise<Object>} Return Promise to last available data of the reporter\r\n    */\n\n  }, {\n    key: \"read\",\n    value: function read(objURL, criteria) {\n      var _this = this;\n\n      console.log('[Syncher.read] ', objURL);\n      return new Promise(function (resolve, reject) {\n        // in case the object is synched in a remote storage, lets sync with it\n\n        /*      if (_this._observers[objURL] && _this._observers[objURL].metadata.hasOwnProperty('backup') && _this._observers[objURL].metadata.backup) {\r\n        \r\n                let readMsg = {\r\n                  type: 'read', from: _this._owner, to: _this._subURL, \r\n                  body: { resource: objURL}\r\n                };\r\n        \r\n                if (criteria) readMsg.body.criteria = criteria;\r\n        \r\n                  let callback = (reply) => {\r\n                    return _this._readCallBack(reply, resolve, reject);\r\n                  };\r\n            \r\n                  _this._bus.postMessage(readMsg, callback, false);\r\n            \r\n              } else {*/\n        _this._readReporter(objURL).then(function (result) {\n          resolve(result);\n        }); //    }\n\n      });\n    }\n  }, {\n    key: \"_readCallBack\",\n    value: function _readCallBack(reply, resolve, reject) {\n      var _this = this;\n\n      console.log('[Syncher.read] reply: ', reply);\n      var childrens = {};\n      var value = {};\n      var n = 0;\n\n      if (reply.body.code < 300) {\n        if (!reply.body.value.hasOwnProperty('responses')) {\n          _this._bus.removeResponseListener(reply.from, reply.id);\n\n          resolve(reply.body.value);\n        } else {\n          //data object is sent in separated messages\n          if (n === 0) {\n            //initial response without childrens\n            value = reply.body.value;\n            ++n;\n          } else {\n            // received response contains childrens\n            delete reply.body.value.responses;\n            var children;\n\n            for (children in reply.body.value) {\n              if (!childrens.hasOwnProperty(children)) childrens[children] = {};\n              Object.assign(childrens[children], reply.body.value[children]);\n            }\n\n            ++n;\n\n            if (n === value.responses) {\n              value.childrenObjects = childrens;\n              delete value.responses;\n\n              _this._bus.removeResponseListener(reply.from, reply.id);\n\n              resolve(value);\n            }\n          }\n        }\n      } else {\n        reject(reply.body.desc);\n      }\n    }\n  }, {\n    key: \"_readReporter\",\n    value: function _readReporter(objURL) {\n      var _this = this; //FLOW-OUT: this message will be sent directly to reporter object (maybe there is no listener available, so it will be resolved with MessageBus -> resolve)\n      //will reach the remote object in DataObjectReporter -> _onRead\n\n\n      var readMsg = {\n        type: 'read',\n        from: _this._owner,\n        to: objURL\n      };\n      return new Promise(function (resolve, reject) {\n        _this._bus.postMessage(readMsg, function (reply) {\n          return _this._readCallBack(reply, resolve, reject);\n        }, false);\n      });\n    }\n    /**\r\n    * Setup the callback to process create and delete events of remove Reporter objects.\r\n    * This is releated to the messagens sent by create to the observers Hyperty array.\r\n    * @param {function(event: MsgEvent)} callback\r\n    */\n\n  }, {\n    key: \"onNotification\",\n    value: function onNotification(callback) {\n      this._onNotificationHandler = callback;\n    }\n    /**\r\n    * Setup the callback to process close events from the runtime.\r\n    * @param {function(event: MsgEvent)} callback\r\n    */\n\n  }, {\n    key: \"onClose\",\n    value: function onClose(callback) {\n      this._onClose = callback;\n    }\n  }, {\n    key: \"_create\",\n    value: function _create(input) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var reporterInput = Object.assign({}, input);\n        var resume = input.resume;\n        reporterInput.created = new Date().toISOString();\n        reporterInput.runtime = _this._runtimeUrl;\n        var requestValue = deepClone(reporterInput);\n        delete requestValue.p2p;\n        delete requestValue.store;\n        delete requestValue.observers;\n        delete requestValue.identity; //FLOW-OUT: this message will be sent to the runtime instance of SyncherManager -> _onCreate\n        //debugger;\n\n        var requestMsg = {\n          type: 'create',\n          from: _this._owner,\n          to: _this._subURL,\n          body: {\n            resume: resume,\n            value: requestValue\n          }\n        };\n        requestMsg.body.schema = reporterInput.schema;\n        if (reporterInput.p2p) requestMsg.body.p2p = reporterInput.p2p;\n        if (reporterInput.store) requestMsg.body.store = reporterInput.store;\n        if (reporterInput.identity) requestMsg.body.identity = reporterInput.identity;\n        console.log('[syncher._create]: ', reporterInput, requestMsg); //request create to the allocation system. Can be rejected by the PolicyEngine.\n\n        _this._bus.postMessage(requestMsg, function (reply) {\n          Syncher_log.log('[syncher - create] - create-response: ', reply);\n\n          if (reply.body.code === 200) {\n            //reporter creation accepted\n            reporterInput.url = reply.body.resource;\n            /*          if (reply.body.p2pHandler) reporterInput.p2pHandler = reply.body.p2pHandler;\r\n                      if (reply.body.p2pRequester) reporterInput.p2pRequester = reply.body.p2pRequester;*/\n\n            reporterInput.status = 'live'; // pch: do we ned this?\n\n            reporterInput.syncher = _this;\n            reporterInput.childrens = reply.body.childrenResources;\n            var newObj = _this._reporters[reporterInput.url];\n\n            if (!newObj) {\n              newObj = new syncher_DataObjectReporter(reporterInput);\n              _this._reporters[reporterInput.url] = newObj;\n            }\n\n            newObj.inviteObservers(input.authorise, input.p2p);\n            resolve(newObj);\n          } else {\n            //reporter creation rejected\n            reject(reply.body.desc);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_resumeCreate\",\n    value: function _resumeCreate(criteria) {\n      var _this2 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var resume = criteria.resume; //FLOW-OUT: this message will be sent to the runtime instance of SyncherManager -> _onCreate\n\n        var requestMsg = {\n          type: 'create',\n          from: _this._owner,\n          to: _this._subURL,\n          body: {\n            resume: resume\n          }\n        };\n        Syncher_log.log('[syncher - create]: ', criteria, requestMsg);\n\n        if (criteria) {\n          requestMsg.body.value = criteria;\n\n          if (criteria.hasOwnProperty('reporter')) {\n            requestMsg.body.value.reporter = criteria.reporter;\n          } else {\n            requestMsg.body.value.reporter = _this._owner;\n          }\n        }\n\n        if (criteria.p2p) requestMsg.body.p2p = criteria.p2p;\n        if (criteria.store) requestMsg.body.store = criteria.store;\n        if (criteria.observers) requestMsg.body.authorise = criteria.observers;\n        if (criteria.identity) requestMsg.body.identity = criteria.identity;\n        Syncher_log.log('[syncher._resumeCreate] - resume message: ', requestMsg); //debugger;\n        //request create to the allocation system. Can be rejected by the PolicyEngine.\n\n        _this._bus.postMessage(requestMsg, function (reply) {\n          Syncher_log.log('[syncher._resumeCreate] - create-resumed-response: ', reply);\n\n          if (reply.body.code === 200) {\n            //debugger;\n            var listOfReporters = reply.body.value;\n\n            for (var index in listOfReporters) {\n              var dataObject = listOfReporters[index]; //reporter creation accepted\n\n              dataObject.data = deepClone(dataObject.data) || {};\n\n              if (dataObject.childrenObjects) {\n                dataObject.childrenObjects = deepClone(dataObject.childrenObjects);\n              }\n\n              dataObject.mutual = false;\n              dataObject.resume = true;\n              dataObject.status = 'live'; // pch: do we ned this?\n\n              dataObject.syncher = _this;\n              Syncher_log.log('[syncher._resumeCreate] - create-resumed-dataObjectReporter', dataObject);\n              var newObj = new syncher_DataObjectReporter(dataObject);\n\n              if (dataObject.childrenObjects) {\n                newObj.resumeChildrens(dataObject.childrenObjects);\n              }\n\n              _this._reporters[dataObject.url] = newObj;\n            }\n\n            resolve(_this._reporters);\n            if (_this2._onReportersResume) _this2._onReportersResume(_this2._reporters);\n          } else if (reply.body.code === 404) {\n            resolve({});\n          } else {\n            //reporter creation rejected\n            reject(reply.body.desc);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_subscribe\",\n    value: function _subscribe(input) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //FLOW-OUT: this message will be sent to the runtime instance of SyncherManager -> _onLocalSubscribe\n        var subscribeMsg = {\n          type: 'subscribe',\n          from: _this._owner,\n          to: _this._subURL,\n          body: input\n        }; // Hyperty request to be an Observer\n        // https://github.com/reTHINK-project/specs/blob/master/messages/data-sync-messages.md#hyperty-request-to-be-an-observer\n        // Resume Subscriptions for the same Hyperty URL\n        // https://github.com/reTHINK-project/specs/blob/master/messages/data-sync-messages.md#resume-subscriptions-for-the-same-hyperty-url\n        // Resume Subscriptions for a certain user and data schema independently of the Hyperty URL.\n        // https://github.com/reTHINK-project/specs/blob/master/messages/data-sync-messages.md#resume-subscriptions-for-a-certain-user-and-data-schema-independently-of-the-hyperty-url\n\n        /*      if (input) {\r\n                if (input.hasOwnProperty('p2p')) subscribeMsg.body.p2p = input.p2p;\r\n                if (input.hasOwnProperty('store')) subscribeMsg.body.store = input.store;\r\n                if (input.hasOwnProperty('schema')) subscribeMsg.body.schema = input.schema;\r\n                if (input.hasOwnProperty('identity')) subscribeMsg.body.identity = input.identity;\r\n                if (input.hasOwnProperty('resource')) subscribeMsg.body.resource = input.resource;\r\n                if (input.hasOwnProperty('domain_subscription')) subscribeMsg.body.domain_subscription = input.domain_subscription;\r\n              }\r\n              \r\n        \r\n              subscribeMsg.body.resume = input.resume;\r\n        \r\n              //TODO: For Further Study\r\n              if (input.hasOwnProperty('mutual')) subscribeMsg.body.mutual = input.mutual;*/\n\n        Syncher_log.log('[syncher_subscribe] - subscribe message: ', input, subscribeMsg); //request subscription\n        //Provisional data is applied to the DataObjectObserver after confirmation. Or discarded if there is no confirmation.\n        //for more info see the DataProvisional class documentation.\n\n        _this._bus.postMessage(subscribeMsg, function (reply) {\n          Syncher_log.log('[syncher] - subscribe-response: ', reply);\n          var objURL = reply.body.resource;\n          var newProvisional = _this._provisionals[objURL];\n          delete _this._provisionals[objURL];\n          if (newProvisional) newProvisional._releaseListeners();\n\n          if (reply.body.code < 200) {\n            Syncher_log.log('[syncher] - new DataProvisional: ', reply.body.childrenResources, objURL);\n            newProvisional = new syncher_DataProvisional(_this._owner, objURL, _this._bus, reply.body.childrenResources);\n            _this._provisionals[objURL] = newProvisional;\n          } else if (reply.body.code === 200) {\n            Syncher_log.log('[syncher] - new Data Object Observer: ', reply, _this._provisionals);\n            var observerInput = reply.body.value;\n            observerInput.syncher = _this;\n            observerInput.p2p = input.p2p;\n            observerInput.store = input.store;\n            observerInput.identity = input.identity;\n            observerInput.resume = false; // todo: For Further Study\n\n            observerInput.mutual = input.mutual; //observerInput.children = newProvisional.children;\n            //TODO: mutual For Further Study\n\n            var newObj = _this._observers[objURL];\n\n            if (!newObj) {\n              newObj = new syncher_DataObjectObserver(observerInput);\n              _this._observers[objURL] = newObj;\n            } else {\n              newObj.sync();\n            }\n\n            Syncher_log.log('[syncher] - new Data Object Observer already exist: ', newObj);\n            resolve(newObj);\n\n            if (newProvisional) {\n              newProvisional.apply(newObj);\n            }\n          } else {\n            reject(reply.body.desc);\n          }\n        });\n      });\n    }\n    /*\r\n      _processOfflineSubscription(subscription, redirectTo) {\r\n        let _this = this;\r\n    \r\n        let forward = {\r\n          from: subscription.from,\r\n          type: 'forward',\r\n          to: redirectTo,\r\n          body: subscription\r\n        };\r\n    \r\n        console.log('[Syncher._processOfflineSubscription] forwading ', forward);\r\n    \r\n        _this._bus.postMessage(forward);\r\n    \r\n        let result = {\r\n          code: 302,\r\n          desc: \"Found \" + redirectTo\r\n        };\r\n    \r\n        return(result);\r\n    \r\n      }*/\n\n  }, {\n    key: \"_resumeSubscribe\",\n    value: function _resumeSubscribe(criteria) {\n      var _this3 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //FLOW-OUT: this message will be sent to the runtime instance of SyncherManager -> _onLocalSubscribe\n        var subscribeMsg = {\n          type: 'subscribe',\n          from: _this._owner,\n          to: _this._subURL,\n          body: {}\n        }; // Hyperty request to be an Observer\n        // https://github.com/reTHINK-project/specs/blob/master/messages/data-sync-messages.md#hyperty-request-to-be-an-observer\n        // Resume Subscriptions for the same Hyperty URL\n        // https://github.com/reTHINK-project/specs/blob/master/messages/data-sync-messages.md#resume-subscriptions-for-the-same-hyperty-url\n        // Resume Subscriptions for a certain user and data schema independently of the Hyperty URL.\n        // https://github.com/reTHINK-project/specs/blob/master/messages/data-sync-messages.md#resume-subscriptions-for-a-certain-user-and-data-schema-independently-of-the-hyperty-url\n\n        if (criteria) {\n          if (criteria.hasOwnProperty('p2p')) subscribeMsg.body.p2p = criteria.p2p;\n          if (criteria.hasOwnProperty('store')) subscribeMsg.body.store = criteria.store;\n          if (criteria.hasOwnProperty('schema')) subscribeMsg.body.schema = criteria.schema;\n          if (criteria.hasOwnProperty('identity')) subscribeMsg.body.identity = criteria.identity;\n          if (criteria.hasOwnProperty('resource')) subscribeMsg.body.resource = criteria.resource;\n        }\n\n        subscribeMsg.body.resume = criteria.resume; //TODO: For Further Study\n\n        var mutual = criteria.mutual;\n        if (criteria.hasOwnProperty('mutual')) subscribeMsg.body.mutual = mutual;\n        console.log('[syncher] - subscribe message: ', criteria, subscribeMsg); //request subscription\n        //Provisional data is applied to the DataObjectObserver after confirmation. Or discarded if there is no confirmation.\n        //for more info see the DataProvisional class documentation.\n\n        _this._bus.postMessage(subscribeMsg, function (reply) {\n          console.log('[syncher] - subscribe-resumed-response: ', reply);\n          var objURL = reply.body.resource;\n          var newProvisional = _this._provisionals[objURL];\n          delete _this._provisionals[objURL];\n          if (newProvisional) newProvisional._releaseListeners();\n\n          if (reply.body.code < 200) {\n            // todo: check if this is needed for the resume\n            Syncher_log.log('[syncher] - resume new DataProvisional: ', reply, objURL);\n            newProvisional = new syncher_DataProvisional(_this._owner, objURL, _this._bus, reply.body.childrenResources);\n            _this._provisionals[objURL] = newProvisional;\n          } else if (reply.body.code === 200) {\n            var listOfObservers = reply.body.value;\n\n            for (var index in listOfObservers) {\n              var dataObject = listOfObservers[index];\n              console.log('[syncher] - Resume Object Observer: ', reply, dataObject, _this._provisionals);\n\n              if (dataObject.childrenObjects) {\n                dataObject.childrenObjects = deepClone(dataObject.childrenObjects);\n              }\n\n              dataObject.data = deepClone(dataObject.data) || {};\n              dataObject.resume = true;\n              dataObject.syncher = _this; //TODO: mutual For Further Study\n\n              console.log('[syncher._resumeSubscribe] - create new dataObject: ', dataObject);\n              var newObj = new syncher_DataObjectObserver(dataObject);\n\n              if (dataObject.childrenObjects) {\n                newObj.resumeChildrens(dataObject.childrenObjects);\n              }\n\n              Syncher_log.log('[syncher._resumeSubscribe] - new dataObject', newObj);\n              _this._observers[newObj.url] = newObj;\n\n              if (_this._provisionals[newObj.url]) {\n                _this._provisionals[newObj.url].apply(newObj);\n              } //lets sync with Reporter\n              // it was commented to let hyperties decide when to sync\n              //newObj.sync();\n\n            }\n\n            resolve(_this._observers);\n            if (_this3._onObserversResume) _this3._onObserversResume(_this._observers);\n          } else if (reply.body.code === 404) {\n            resolve({});\n          } else {\n            reject(reply.body.desc);\n          }\n        });\n      });\n    } //FLOW-IN: message received from a local runtime ReporterObject -> _onRemoteSubscribe\n\n  }, {\n    key: \"_onForward\",\n    value: function _onForward(msg) {\n      var _this = this;\n\n      var reporter = _this._reporters[msg.body.to];\n\n      reporter._onForward(msg);\n    } //FLOW-IN: message received from a remote Syncher -> create (this is actually an invitation to subscribe)\n\n  }, {\n    key: \"_onRemoteCreate\",\n    value: function _onRemoteCreate(msg) {\n      var _this = this;\n\n      var resource = msg.from.slice(0, -13); //remove \"/subscription\" from the URL\n\n      var dividedURL = divideURL(resource);\n      var domain = dividedURL.domain;\n      var event = {\n        type: msg.type,\n        from: msg.body.source,\n        url: resource,\n        domain: domain,\n        schema: msg.body.schema,\n        value: msg.body.value,\n        identity: msg.body.identity,\n        ack: function ack(type) {\n          var lType = 200;\n\n          if (type) {\n            lType = type;\n          } //send ack response message\n\n\n          _this._bus.postMessage({\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: lType\n            }\n          });\n        }\n      };\n\n      if (_this._onNotificationHandler) {\n        Syncher_log.info('[Syncher] NOTIFICATION-EVENT: ', event);\n\n        _this._onNotificationHandler(event);\n      }\n    } //FLOW-IN: message received from a remote DataObjectReporter -> delete\n\n  }, {\n    key: \"_onRemoteDelete\",\n    value: function _onRemoteDelete(msg) {\n      var _this = this; //remove \"/subscription\" from the URL\n\n\n      var resource = msg.body.resource;\n      var object = _this._observers[resource];\n      var unsubscribe = {\n        from: _this.owner,\n        to: _this._subURL,\n        id: msg.id,\n        type: 'unsubscribe',\n        body: {\n          resource: msg.body.resource\n        }\n      };\n\n      _this._bus.postMessage(unsubscribe);\n\n      delete _this._observers[resource];\n\n      if (object) {\n        var event = {\n          type: msg.type,\n          url: resource,\n          identity: msg.body.identity,\n          ack: function ack(type) {\n            var lType = 200;\n\n            if (type) {\n              lType = type;\n            } //TODO: any other different options for the release process, like accept but nor release local?\n\n\n            if (lType === 200) {\n              object.delete();\n            } //send ack response message\n\n\n            _this._bus.postMessage({\n              id: msg.id,\n              type: 'response',\n              from: msg.to,\n              to: msg.from,\n              body: {\n                code: lType,\n                source: _this._owner\n              }\n            });\n          }\n        };\n\n        if (_this._onNotificationHandler) {\n          Syncher_log.log('NOTIFICATION-EVENT: ', event);\n\n          _this._onNotificationHandler(event);\n        }\n      } else {\n        _this._bus.postMessage({\n          id: msg.id,\n          type: 'response',\n          from: msg.to,\n          to: msg.from,\n          body: {\n            code: 404,\n            source: _this._owner\n          }\n        });\n      }\n    } // close event received from runtime registry\n\n  }, {\n    key: \"_onExecute\",\n    value: function _onExecute(msg) {\n      var _this = this;\n\n      var reply = {\n        id: msg.id,\n        type: 'response',\n        from: msg.to,\n        to: msg.from,\n        body: {\n          code: 200\n        }\n      };\n\n      if ((msg.from === _this._runtimeUrl + '/registry/' || msg.from === _this._runtimeUrl + '/registry') && msg.body && msg.body.method && msg.body.method === 'close' && _this._onClose) {\n        var event = {\n          type: 'close',\n          ack: function ack(type) {\n            if (type) {\n              reply.body.code = type;\n            } //send ack response message\n\n\n            _this._bus.postMessage(reply);\n          }\n        };\n        Syncher_log.info('[Syncher] Close-EVENT: ', event);\n\n        _this._onClose(event);\n      } else {\n        _this._bus.postMessage(reply);\n      }\n    }\n    /**\r\n    * Callback system to trigger the resumed reporters\r\n    * @param  {Function} callback - function callback which will be invoked\r\n    * @return {Object<URL, DataObjectReporter>} Return one object with all resumed reporters;\r\n    */\n\n  }, {\n    key: \"onReportersResume\",\n    value: function onReportersResume(callback) {\n      this._onReportersResume = callback;\n    }\n    /**\r\n    * Callback system to trigger the resumed observers\r\n    * @param  {Function} callback - function callback which will be invoked\r\n    * @return {Object<URL, DataObjectObserver>} Return one object with all resumed observers;\r\n    */\n\n  }, {\n    key: \"onObserversResume\",\n    value: function onObserversResume(callback) {\n      this._onObserversResume = callback;\n    }\n  }, {\n    key: \"owner\",\n    get: function get() {\n      return this._owner;\n    }\n    /**\r\n    * All owned reporters, the ones that were created by a create\r\n    * @type {Object<URL, DataObjectReporter>}\r\n    */\n\n  }, {\n    key: \"reporters\",\n    get: function get() {\n      return this._reporters;\n    }\n    /**\r\n    * All owned observers, the ones that were created by a local subscription\r\n    * @type {Object<URL, DataObjectObserver>}\r\n    */\n\n  }, {\n    key: \"observers\",\n    get: function get() {\n      return this._observers;\n    }\n  }]);\n\n  return Syncher;\n}();\n\n/* harmony default export */ var syncher_Syncher = (Syncher_Syncher);\n// CONCATENATED MODULE: ./src/syncher/NotificationHandler.js\nfunction NotificationHandler_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction NotificationHandler_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction NotificationHandler_createClass(Constructor, protoProps, staticProps) { if (protoProps) NotificationHandler_defineProperties(Constructor.prototype, protoProps); if (staticProps) NotificationHandler_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* The Notitification Handler is used to handle notifications not processed by the syncher when running in a sandbox.\r\n*/\n\n\nvar NotificationHandler_NotificationHandler =\n/*#__PURE__*/\nfunction () {\n  function NotificationHandler(bus) {\n    NotificationHandler_classCallCheck(this, NotificationHandler);\n\n    if (!bus) throw Error('[NotificationHandler Constructor] bus input is mandatory');\n    this._bus = bus;\n    this._onNotificationHandler = {};\n  }\n\n  NotificationHandler_createClass(NotificationHandler, [{\n    key: \"onNotification\",\n    value: function onNotification(scheme, callback) {\n      this._onNotificationHandler[scheme] = callback;\n    }\n  }, {\n    key: \"onCreate\",\n    value: function onCreate(msg) {\n      var _this = this; //  let resource = msg.from.slice(0, -13); //remove \"/subscription\" from the URL\n\n\n      var resource = msg.body.hasOwnProperty('resource') ? msg.body.resource : msg.from.slice(0, -13);\n      var dividedURL = divideURL(resource);\n      var domain = dividedURL.domain;\n      var scheme = resource.split('://')[0];\n\n      var _error = function error(reason) {\n        _this._bus.postMessage({\n          id: msg.id,\n          type: 'response',\n          from: msg.to,\n          to: msg.from,\n          body: {\n            code: 400,\n            desc: 'Bad Request: ' + reason\n          }\n        });\n      };\n\n      if (!msg.body.hasOwnProperty('source')) {\n        _error('Missing source');\n      }\n\n      if (!msg.body.hasOwnProperty('schema')) {\n        _error('Missing schema');\n      }\n\n      if (!msg.body.hasOwnProperty('value')) {\n        _error('Missing value');\n      }\n\n      if (!msg.body.hasOwnProperty('identity')) {\n        _error('Missing identity');\n      }\n\n      var event = {\n        type: msg.type,\n        from: msg.body.source,\n        url: resource,\n        domain: domain,\n        schema: msg.body.schema,\n        value: msg.body.value,\n        identity: msg.body.identity,\n        to: msg.to,\n        via: msg.body.via,\n        ack: function ack(type) {\n          var lType = 200;\n\n          if (type) {\n            lType = type;\n          } //send ack response message\n\n\n          _this._bus.postMessage({\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: lType\n            }\n          });\n        },\n        error: function error(reason) {\n          _error(reason);\n        }\n      };\n\n      if (_this._onNotificationHandler[scheme]) {\n        console.info('[NotificationHandler] NOTIFICATION-EVENT: ', event);\n\n        _this._onNotificationHandler[scheme](event);\n      }\n    }\n  }, {\n    key: \"onDelete\",\n    value: function onDelete(msg) {\n      var _this = this; //remove \"/subscription\" from the URL\n\n\n      var resource = msg.body.resource;\n      var object = _this._observers[resource];\n      var unsubscribe = {\n        from: _this.owner,\n        to: _this._subURL,\n        id: msg.id,\n        type: 'unsubscribe',\n        body: {\n          resource: msg.body.resource\n        }\n      };\n\n      _this._bus.postMessage(unsubscribe);\n\n      delete _this._observers[resource];\n\n      if (object) {\n        var event = {\n          type: msg.type,\n          url: resource,\n          identity: msg.body.identity,\n          ack: function ack(type) {\n            var lType = 200;\n\n            if (type) {\n              lType = type;\n            } //TODO: any other different options for the release process, like accept but nor release local?\n\n\n            if (lType === 200) {\n              object.delete();\n            } //send ack response message\n\n\n            _this._bus.postMessage({\n              id: msg.id,\n              type: 'response',\n              from: msg.to,\n              to: msg.from,\n              body: {\n                code: lType,\n                source: _this._owner\n              }\n            });\n          }\n        };\n\n        if (_this._onNotificationHandler) {\n          log.log('NOTIFICATION-EVENT: ', event);\n\n          _this._onNotificationHandler(event);\n        }\n      } else {\n        _this._bus.postMessage({\n          id: msg.id,\n          type: 'response',\n          from: msg.to,\n          to: msg.from,\n          body: {\n            code: 404,\n            source: _this._owner\n          }\n        });\n      }\n    }\n  }]);\n\n  return NotificationHandler;\n}();\n\n/* harmony default export */ var syncher_NotificationHandler = (NotificationHandler_NotificationHandler);\n// CONCATENATED MODULE: ./src/identity/IdentityManager.js\nfunction IdentityManager_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction IdentityManager_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction IdentityManager_createClass(Constructor, protoProps, staticProps) { if (protoProps) IdentityManager_defineProperties(Constructor.prototype, protoProps); if (staticProps) IdentityManager_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* Core IdentityManager interface\r\n* Class to allow applications to search for Identities registered in runtime-core\r\n*/\n\nvar IdentityManager_IdentityManager =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * To initialise the IdentityManager, which will provide the support for hyperties to\r\n  * query about identities registered\r\n  * @param  {String}          owner            owner\r\n  * @param  {String}          runtimeURL            runtimeURL\r\n  * @param  {MessageBus}          msgbus                msgbus\r\n  */\n  function IdentityManager(owner, runtimeURL, msgBus) {\n    IdentityManager_classCallCheck(this, IdentityManager);\n\n    var _this = this;\n\n    _this.messageBus = msgBus;\n    _this.domain = divideURL(owner).domain;\n    _this.owner = owner;\n    _this.runtimeURL = runtimeURL;\n  }\n  /**\r\n  * Function to query the runtime registry about the identity to which the hyperty was associated\r\n  * @param {String}       type (Optional)         type of user info required\r\n  * @param {String}       owner (Optional)   owner to search for\r\n  * @return {Promise}     userURL       userURL associated to the hyperty\r\n  */\n\n\n  IdentityManager_createClass(IdentityManager, [{\n    key: \"discoverUserRegistered\",\n    value: function discoverUserRegistered(type, hyperty) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var activeHypertyURL; // if any type of search is selected query for that type, otherwise query for default user info\n\n        var searchType = type ? type : '.';\n\n        if (!hyperty) {\n          activeHypertyURL = _this.owner;\n        } else {\n          activeHypertyURL = hyperty;\n        }\n\n        var msg = {\n          type: 'read',\n          from: activeHypertyURL,\n          to: _this.runtimeURL + '/registry/',\n          body: {\n            resource: searchType,\n            criteria: activeHypertyURL\n          }\n        };\n\n        _this.messageBus.postMessage(msg, function (reply) {\n          var userURL = reply.body.resource;\n\n          if (userURL && reply.body.code === 200) {\n            resolve(userURL);\n          } else {\n            reject('code: ' + reply.body.code + ' No user was found');\n          }\n        });\n      });\n    }\n    /**\r\n    * Function to query the Identity Module about authenticated identities from a certain domain\r\n    * @param {String}       idp idp domain of the identity to be discovered\r\n    * @return {Promise}     identity\r\n    */\n\n  }, {\n    key: \"discoverIdentityPerIdP\",\n    value: function discoverIdentityPerIdP(idp) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var msg = {\n          type: 'read',\n          from: this.owner,\n          to: _this.runtimeURL + '/idm',\n          body: {\n            resource: idp,\n            criteria: 'idp'\n          }\n        };\n\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code === 200) {\n            resolve(reply.body.value);\n          } else {\n            reject(reply.body.code + ' ' + reply.body.desc);\n          }\n        });\n      });\n    }\n  }]);\n\n  return IdentityManager;\n}();\n\n/* harmony default export */ var identity_IdentityManager = (IdentityManager_IdentityManager);\n// CONCATENATED MODULE: ./src/discovery/RegistrationStatus.js\nfunction RegistrationStatus_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction RegistrationStatus_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction RegistrationStatus_createClass(Constructor, protoProps, staticProps) { if (protoProps) RegistrationStatus_defineProperties(Constructor.prototype, protoProps); if (staticProps) RegistrationStatus_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar RegistrationStatus_log = loglevel[\"getLogger\"]('RegistrationStatus');\n\n/**\r\n* The RegistrationStatus lib allows to monitor registration status of an Hyperty or Data Object\r\n*\r\n*/\n\nvar RegistrationStatus_RegistrationStatus =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * @param {URL} url URL address of the entity to be monitored\r\n  * @param {URL} runtimeURL the current URL of the Runtime Instance used\r\n  * @param {HypertyURL} owner the URL of the Hyperty instance that is using this lib\r\n  * @param {MiniBus} owner the URL of the Hyperty instance that is using this lib\r\n  *\r\n  */\n  function RegistrationStatus(url, runtimeURL, owner, msgBus) {\n    RegistrationStatus_classCallCheck(this, RegistrationStatus);\n\n    this._registryObjectURL = url;\n    this._runtimeURL = runtimeURL;\n    this._domain = divideURL(runtimeURL).domain;\n    this._discoveredObjectURL = owner;\n    this._messageBus = msgBus;\n    this._subscriptionSet = false;\n    this._subscribers = {\n      live: {},\n      disconnected: {}\n    };\n  }\n\n  RegistrationStatus_createClass(RegistrationStatus, [{\n    key: \"onLive\",\n    value: function onLive(subscriber, callback) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (!_this._subscriptionSet) {\n          _this._subscribe().then(function () {\n            _this._subscribers.live[subscriber] = callback;\n            resolve();\n          }).catch(function (err) {\n            return reject(err);\n          });\n        } else {\n          _this._subscribers.live[subscriber] = callback;\n          resolve();\n        }\n      });\n    }\n  }, {\n    key: \"onDisconnected\",\n    value: function onDisconnected(subscriber, callback) {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (!_this2._subscriptionSet) {\n          _this2._subscribe().then(function () {\n            _this2._subscribers.disconnected[subscriber] = callback;\n            resolve();\n          }).catch(function (err) {\n            return reject(err);\n          });\n        } else {\n          _this2._subscribers.disconnected[subscriber] = callback;\n          resolve();\n        }\n      });\n    }\n  }, {\n    key: \"_subscribe\",\n    value: function _subscribe() {\n      var _this3 = this;\n\n      var msg = {\n        type: 'subscribe',\n        from: this._discoveredObjectURL,\n        to: this._runtimeURL + '/subscriptions',\n        body: {\n          resources: [this._registryObjectURL + '/registration']\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this3._messageBus.postMessage(msg, function (reply) {\n          RegistrationStatus_log.log(\"[DiscoveredObject.subscribe] \".concat(_this3._registryObjectURL, \" rcved reply \"), reply);\n\n          if (reply.body.code === 200) {\n            _this3._generateListener(_this3._registryObjectURL + '/registration');\n\n            _this3._subscriptionSet = true;\n            resolve();\n          } else {\n            RegistrationStatus_log.error('Error subscribing ', _this3._registryObjectURL);\n            reject('Error subscribing ' + _this3._registryObjectURL);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_generateListener\",\n    value: function _generateListener(notificationURL) {\n      var _this4 = this;\n\n      this._messageBus.addListener(notificationURL, function (msg) {\n        RegistrationStatus_log.log(\"[DiscoveredObject.notification] \".concat(_this4._registryObjectURL, \": \"), msg);\n\n        _this4._processNotification(msg);\n      });\n    }\n  }, {\n    key: \"_processNotification\",\n    value: function _processNotification(msg) {\n      var _this5 = this;\n\n      var status = msg.body.value;\n      setTimeout(function () {\n        // Hack to give time for onLive Hyperties to get ready. To be removed when Hyperty State machaine is implemented\n        Object.keys(_this5._subscribers[status]).forEach(function (subscriber) {\n          return _this5._subscribers[status][subscriber]();\n        });\n      }, 5000);\n    }\n  }, {\n    key: \"_unsubscribe\",\n    value: function _unsubscribe() {\n      var _this6 = this;\n\n      var msg = {\n        type: 'unsubscribe',\n        from: this._discoveredObjectURL,\n        to: this._runtimeURL + '/subscriptions',\n        body: {\n          resource: this._registryObjectURL + '/registration'\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this6._messageBus.postMessage(msg, function (reply) {\n          RegistrationStatus_log.log(\"[DiscoveredObject.unsubscribe] \".concat(_this6._registryObjectURL, \" rcved reply \"), reply);\n\n          if (reply.body.code === 200) {\n            resolve();\n          } else {\n            RegistrationStatus_log.error('Error unsubscribing ', _this6._registryObjectURL);\n            reject('Error unsubscribing ' + _this6._registryObjectURL);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"unsubscribeLive\",\n    value: function unsubscribeLive(subscriber) {\n      var _this7 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (subscriber in _this7._subscribers.live) {\n          //TODO: unsubscribe outside this condition\n          delete _this7._subscribers.live[subscriber];\n        }\n\n        if (_this7._areSubscriptionsEmpty()) {\n          _this7._unsubscribe().then(function () {\n            return resolve();\n          }).catch(function (err) {\n            return reject(err);\n          });\n        } else {\n          resolve();\n        }\n        /*  } else {\r\n            reject(`${subscriber} doesn't subscribe onLive for ${this._registryObjectURL}`);\r\n          }*/\n\n      });\n    }\n  }, {\n    key: \"unsubscribeDisconnected\",\n    value: function unsubscribeDisconnected(subscriber) {\n      var _this8 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (subscriber in _this8._subscribers.disconnected) {\n          delete _this8._subscribers.disconnected[subscriber];\n\n          if (_this8._areSubscriptionsEmpty()) {\n            _this8._unsubscribe().then(function () {\n              return resolve();\n            }).catch(function (err) {\n              return reject(err);\n            });\n          } else {\n            resolve();\n          }\n        } else {\n          reject(\"\".concat(subscriber, \" doesn't subscribe onDisconnected for \").concat(_this8._registryObjectURL));\n        }\n      });\n    }\n  }, {\n    key: \"_areSubscriptionsEmpty\",\n    value: function _areSubscriptionsEmpty() {\n      return Object.keys(this._subscribers.live).length === 0 && Object.keys(this._subscribers.disconnected).length === 0;\n    }\n  }]);\n\n  return RegistrationStatus;\n}();\n\n/* harmony default export */ var discovery_RegistrationStatus = (RegistrationStatus_RegistrationStatus);\n// CONCATENATED MODULE: ./src/discovery/DiscoveredObject.js\nfunction DiscoveredObject_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { DiscoveredObject_typeof = function _typeof(obj) { return typeof obj; }; } else { DiscoveredObject_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return DiscoveredObject_typeof(obj); }\n\nfunction DiscoveredObject_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DiscoveredObject_possibleConstructorReturn(self, call) { if (call && (DiscoveredObject_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return DiscoveredObject_assertThisInitialized(self); }\n\nfunction DiscoveredObject_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction DiscoveredObject_getPrototypeOf(o) { DiscoveredObject_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return DiscoveredObject_getPrototypeOf(o); }\n\nfunction DiscoveredObject_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction DiscoveredObject_createClass(Constructor, protoProps, staticProps) { if (protoProps) DiscoveredObject_defineProperties(Constructor.prototype, protoProps); if (staticProps) DiscoveredObject_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction DiscoveredObject_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) DiscoveredObject_setPrototypeOf(subClass, superClass); }\n\nfunction DiscoveredObject_setPrototypeOf(o, p) { DiscoveredObject_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return DiscoveredObject_setPrototypeOf(o, p); }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n//import {divideURL, convertToUserURL} from '../utils/utils';\n\n/**\r\n* Discovered Object interface\r\n*/\n\nvar DiscoveredObject =\n/*#__PURE__*/\nfunction (_RegistrationStatus) {\n  DiscoveredObject_inherits(DiscoveredObject, _RegistrationStatus);\n\n  DiscoveredObject_createClass(DiscoveredObject, [{\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    }\n  }]);\n\n  function DiscoveredObject(data, runtimeURL, discoveryURL, msgBus, discovery) {\n    var _this2;\n\n    DiscoveredObject_classCallCheck(this, DiscoveredObject);\n\n    _this2 = DiscoveredObject_possibleConstructorReturn(this, DiscoveredObject_getPrototypeOf(DiscoveredObject).call(this, data.hypertyID || data.url, runtimeURL, discoveryURL, msgBus));\n    _this2._data = data;\n    _this2._discovery = discovery;\n    return _this2;\n  }\n  /**\r\n  * function to check the status of the DiscoveredObject.\r\n  * Depending on existing subscribers it may trigger onLive or onDisconnected events.\r\n  *\r\n  */\n\n\n  DiscoveredObject_createClass(DiscoveredObject, [{\n    key: \"check\",\n    value: function check() {\n      // query DR for the status and call processNotification with msg received\n      var _this = this;\n\n      var message = {\n        body: {}\n      };\n\n      if (_this._discoveredObjectURL.startsWith('hyperty://')) {\n        _this._discovery.discoverHypertyPerURL(_this._discoveredObjectURL).then(function (registration) {\n          message.body.status = registration.status;\n\n          _this._processNotification(message);\n        });\n      } else {\n        _this._discovery.discoverDataObjectsPerURL(_this._discoveredObjectURL).then(function (registration) {\n          message.body.status = registration.status;\n\n          _this._processNotification(message);\n        });\n      }\n    }\n  }]);\n\n  return DiscoveredObject;\n}(discovery_RegistrationStatus);\n\n/* harmony default export */ var discovery_DiscoveredObject = (DiscoveredObject);\n// CONCATENATED MODULE: ./src/discovery/Discovery.js\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction Discovery_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Discovery_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Discovery_createClass(Constructor, protoProps, staticProps) { if (protoProps) Discovery_defineProperties(Constructor.prototype, protoProps); if (staticProps) Discovery_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar Discovery_log = loglevel[\"getLogger\"]('Discovery');\n\n\n/**\r\n* Core Discovery interface\r\n* Class to allow applications to search for hyperties and DataObjects using the message bus\r\n*/\n\nvar Discovery_Discovery =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * To initialise the HypertyDiscover, which will provide the support for hyperties to\r\n  * query users registered in outside the internal core.\r\n  * @param  {MessageBus}          msgbus                msgbus\r\n  * @param  {RuntimeURL}          runtimeURL            runtimeURL\r\n  */\n  function Discovery(hypertyURL, runtimeURL, msgBus) {\n    Discovery_classCallCheck(this, Discovery);\n\n    var _this = this;\n\n    _this.messageBus = msgBus;\n    _this.runtimeURL = runtimeURL;\n    _this.domain = divideURL(hypertyURL).domain;\n    _this.discoveryURL = hypertyURL;\n  }\n  /**\r\n  * Advanced Search for Hyperties registered in domain registry associated with some user identifier (eg email, name ...)\r\n  * @param  {String}           userIdentifier\r\n  * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n  * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n  */\n\n\n  Discovery_createClass(Discovery, [{\n    key: \"_isLegacyUser\",\n    value: function _isLegacyUser(userIdentifier) {\n      if (userIdentifier.includes(':') && !userIdentifier.includes('user://')) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n    /**\r\n    * Advanced Search for Hyperties registered in domain registry associated with some user identifier (eg email, name ...)\r\n    * @param  {String}           userIdentifier\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverHypertiesPerUserProfileData\",\n    value: function discoverHypertiesPerUserProfileData(userIdentifier, schema, resources) {\n      var _this = this;\n\n      var filteredHyperties = [];\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/hyperty/userprofile/' + userIdentifier\n        }\n      };\n\n      if (schema || resources) {\n        msg.body['criteria'] = {\n          resources: resources,\n          dataSchemes: schema\n        };\n      }\n\n      return new Promise(function (resolve, reject) {\n        if (!_this._isLegacyUser(userIdentifier)) {\n          // todo: to reomve when discovery of legcay users are supported\n          _this.messageBus.postMessage(msg, function (reply) {\n            if (reply.body.code === 200) {\n              reply.body.value.map(function (hyperty) {\n                if (hyperty.hypertyID != _this.discoveryURL) filteredHyperties.push(hyperty);\n              });\n              if (filteredHyperties.length === 0) resolve([]);else {\n                Discovery_log.log(\"[Discovery.discoverHypertiesPerUserProfileData] Reply log: \", filteredHyperties);\n                resolve(filteredHyperties);\n              }\n            } else {\n              Discovery_log.warn(\"[Discovery.discoverHypertiesPerUserProfileData] Error Reply for \" + userIdentifier + \" Reason: \", reply.body.description);\n              resolve([]);\n            }\n          });\n        } else {\n          resolve([{\n            hypertyID: userIdentifier,\n            status: 'live'\n          }]);\n        }\n      });\n    }\n    /**\r\n    * Advanced Search for Hyperties registered in domain registry associated with some user identifier (eg email, name ...)\r\n    * returns DiscoveredObject\r\n    * @param  {String}           userIdentifier\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverHypertiesPerUserProfileDataDO\",\n    value: function discoverHypertiesPerUserProfileDataDO(userIdentifier, schema, resources) {\n      var _this2 = this,\n          _arguments = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this2.discoverHypertiesPerUserProfileData.apply(_this2, _toConsumableArray(_arguments)).then(function (hyperties) {\n          resolve(_this2._convertToDiscoveredObject(hyperties));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /**\r\n    * Advanced Search for DataObjects registered in domain registry associated with some user identifier (eg email, name ...)\r\n    * @param  {String}           userIdentifier\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerUserProfileData\",\n    value: function discoverDataObjectsPerUserProfileData(userIdentifier, schema, resources) {\n      var _this = this;\n\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/dataObject/userprofile/' + userIdentifier\n        }\n      };\n\n      if (schema || resources) {\n        msg.body['criteria'] = {\n          resources: resources,\n          dataSchemes: schema\n        };\n      }\n\n      return new Promise(function (resolve, reject) {\n        if (!_this._isLegacyUser(userIdentifier)) {\n          // todo: to reomve when discovery of legcay users are supported\n          _this.messageBus.postMessage(msg, function (reply) {\n            if (reply.body.code === 200) {\n              Discovery_log.log(\"Reply log: \", reply.body.value);\n              resolve(reply.body.value);\n            } else {\n              Discovery_log.warn(\"[Discovery.discoverDataObjectsPerUserProfileData] Error Reply for \" + userIdentifier + \" Reason: \", reply.body.description);\n              resolve([]);\n            }\n          });\n        } else {\n          resolve([{\n            hypertyID: userIdentifier,\n            status: 'live'\n          }]);\n        }\n      });\n    }\n    /**\r\n    * function to request about dataObject registered in domain registry, and\r\n    * returns discoveredObject.\r\n    * @param  {String}           guidURL                guid URL e.g user-guid://<unique-user-identifier>\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerUserProfileDataDO\",\n    value: function discoverDataObjectsPerUserProfileDataDO(guidURL, schema, resources) {\n      var _this3 = this,\n          _arguments2 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this3.discoverDataObjectsPerUserProfileData.apply(_this3, _toConsumableArray(_arguments2)).then(function (registryObjects) {\n          return resolve(_this3._convertToDiscoveredObject(registryObjects));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /**\r\n    * Advanced Search for Hyperties registered in domain registry associated with some GUID\r\n    * @param  {String}           guidURL                guid URL e.g user-guid://<unique-user-identifier>\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverHypertiesPerGUID\",\n    value: function discoverHypertiesPerGUID(guidURL, schema, resources) {\n      var _this = this;\n\n      var filteredHyperties = [];\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/hyperty/guid/' + guidURL\n        }\n      };\n\n      if (schema || resources) {\n        msg.body['criteria'] = {\n          resources: resources,\n          dataSchemes: schema\n        };\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code === 200) {\n            reply.body.value.map(function (hyperty) {\n              if (hyperty.hypertyID != _this.discoveryURL) filteredHyperties.push(hyperty);\n            });\n            if (filteredHyperties.length === 0) reject('No Hyperty was found');else {\n              Discovery_log.log(\"Reply log: \", filteredHyperties);\n              resolve(filteredHyperties);\n            }\n          } else {\n            Discovery_log.warn(\"[Discovery.discoverHypertiesPerGUID] Error Reply for \" + guidURL + \" Reason: \", reply.body.description);\n            resolve([]);\n          }\n        });\n      });\n    }\n    /**\r\n    * Advanced Search for Hyperties registered in domain registry associated with some GUID\r\n    * returns DiscoveredObject\r\n    * @param  {String}           guidURL                guid URL e.g user-guid://<unique-user-identifier>\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverHypertiesPerGUIDDO\",\n    value: function discoverHypertiesPerGUIDDO(guidURL, schema, resources) {\n      var _this4 = this,\n          _arguments3 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this4.discoverHypertiesPerGUID.apply(_this4, _toConsumableArray(_arguments3)).then(function (hyperties) {\n          resolve(_this4._convertToDiscoveredObject(hyperties));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /**\r\n    * Advanced Search for DataObjects registered in domain registry associated with some GUID\r\n    * @param  {String}           guidURL                guid URL e.g user-guid://<unique-user-identifier>\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerGUID\",\n    value: function discoverDataObjectsPerGUID(guidURL, schema, resources) {\n      var _this = this;\n\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/dataObject/guid/' + guidURL\n        }\n      };\n\n      if (schema || resources) {\n        msg.body['criteria'] = {\n          resources: resources,\n          dataSchemes: schema\n        };\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code === 200) {\n            Discovery_log.log(\"Reply log: \", reply.body.value);\n            resolve(reply.body.value);\n          } else {\n            Discovery_log.warn(\"[Discovery.discoverDataObjectsPerGUID] Error Reply for \" + guidURL + \" Reason: \", reply.body.description);\n            resolve([]);\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about dataObject registered in domain registry, and\r\n    * returns discoveredObject.\r\n    * @param  {String}           guidURL                guid URL e.g user-guid://<unique-user-identifier>\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerGUIDDO\",\n    value: function discoverDataObjectsPerGUIDDO(guidURL, schema, resources) {\n      var _this5 = this,\n          _arguments4 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this5.discoverDataObjectsPerGUID.apply(_this5, _toConsumableArray(_arguments4)).then(function (registryObjects) {\n          return resolve(_this5._convertToDiscoveredObject(registryObjects));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /** Advanced Search for Hyperties registered in domain registry\r\n    * @param  {String}           user                  user identifier, either in url or email format\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverHyperties\",\n    value: function discoverHyperties(user, schema, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      var filteredHyperties = [];\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/hyperty/user/' + user\n        }\n      };\n\n      if (schema || resources) {\n        msg.body['criteria'] = {\n          resources: resources,\n          dataSchemes: schema,\n          domain: activeDomain\n        };\n      } else {\n        msg.body['criteria'] = {\n          domain: activeDomain\n        };\n      }\n\n      return new Promise(function (resolve, reject) {\n        if (!_this._isLegacyUser(user)) {\n          // todo: to reomve when discovery of legcay users are supported\n          _this.messageBus.postMessage(msg, function (reply) {\n            if (reply.body.code === 200 || reply.body.code === 500) {\n              reply.body.value.map(function (hyperty) {\n                if (hyperty.hypertyID != _this.discoveryURL) filteredHyperties.push(hyperty);\n              });\n              /*            if(filteredHyperties.length === 0)\r\n                            reject('No Hyperty was found');\r\n                          else {*/\n\n              Discovery_log.log(\"[Discovery.discoverHyperties] Reply : \", filteredHyperties);\n              resolve(filteredHyperties); //            }\n            } else {\n              Discovery_log.warn(\"[Discovery.discoverHyperties] Error Reply for \" + user + \" Reason: \", reply.body.description);\n              resolve(filteredHyperties);\n            }\n          });\n        } else {\n          resolve([{\n            hypertyID: user,\n            status: 'live'\n          }]);\n        }\n      });\n    }\n    /** Advanced Search for Hyperties registered in domain registry,\r\n    *returns DiscoveredObject\r\n    * @param  {String}           user                  user identifier, either in url or email format\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverHypertiesDO\",\n    value: function discoverHypertiesDO(user, schema, resources, domain) {\n      var _this6 = this,\n          _arguments5 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this6.discoverHyperties.apply(_this6, _toConsumableArray(_arguments5)).then(function (hyperties) {\n          resolve(_this6._convertToDiscoveredObject(hyperties));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /** Advanced Search for DataObjects registered in domain registry\r\n    * @param  {String}           user                  user identifier, either in url or email format\r\n    * @param  {Array<string>}    schema (Optional)     types of dataObjects schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObjects resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverDataObjects\",\n    value: function discoverDataObjects(user, schema, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/dataObject/user/' + user\n        }\n      };\n\n      if (schema || resources) {\n        msg.body['criteria'] = {\n          resources: resources,\n          dataSchemes: schema,\n          domain: activeDomain\n        };\n      } else {\n        msg.body['criteria'] = {\n          domain: activeDomain\n        };\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code === 200) {\n            Discovery_log.log(\"Reply Value Log: \", reply.body.value);\n            resolve(reply.body.value);\n          } else {\n            Discovery_log.warn(\"[Discovery.discoverDataObjects] Error Reply for \" + user + \" Reason: \", reply.body.description);\n            resolve([]);\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about dataObject registered in domain registry, and\r\n    * returns discoveredObject.\r\n    * @param  {String}           user                  user identifier, either in url or email format\r\n    * @param  {Array<string>}    schema (Optional)     types of dataObjects schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObjects resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsDO\",\n    value: function discoverDataObjectsDO(user, schema, resources, domain) {\n      var _this7 = this,\n          _arguments6 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this7.discoverDataObjects.apply(_this7, _toConsumableArray(_arguments6)).then(function (registryObjects) {\n          return resolve(_this7._convertToDiscoveredObject(registryObjects));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /**\r\n    * function to request about hyperties registered in domain registry, and\r\n    * return the hyperty information, if found.\r\n    * @param  {String}              url  hyperty URL\r\n    * @param  {String}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverHypertyPerURL\",\n    value: function discoverHypertyPerURL(url, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/hyperty/url/' + url,\n          criteria: {\n            domain: activeDomain\n          }\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code === 200) {\n            Discovery_log.log(\"Reply Value Log: \", reply.body.value);\n            resolve(reply.body.value);\n          } else {\n            Discovery_log.warn(\"[Discovery.discoverHypertyPerURL] Error Reply for \" + url + \" Reason: \", reply.body.description);\n            resolve([]);\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about hyperties registered in domain registry, and\r\n    * returns discoveredObject.\r\n    * @param  {String}              url  hyperty URL\r\n    * @param  {String}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverHypertyPerURLDO\",\n    value: function discoverHypertyPerURLDO(url, domain) {\n      var _this8 = this,\n          _arguments7 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this8.discoverHypertyPerURL.apply(_this8, _toConsumableArray(_arguments7)).then(function (hyperty) {\n          return resolve(new discovery_DiscoveredObject(hyperty, _this8.runtimeURL, _this8.discoveryURL, _this8.messageBus, _this8));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /**\r\n    * function to request about dataObject registered in domain registry, and\r\n    * return the dataObject information, if found.\r\n    * @param  {String}              url  dataObject URL\r\n    * @param  {String}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverDataObjectPerURL\",\n    value: function discoverDataObjectPerURL(url, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/dataObject/url/' + url,\n          criteria: {\n            domain: activeDomain\n          }\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code === 200) {\n            Discovery_log.log(\"Reply Value Log: \", reply.body.value);\n            resolve(reply.body.value);\n          } else {\n            Discovery_log.warn(\"[Discovery.discoverDataObjectPerURL] Error Reply for \" + url + \" Reason: \", reply.body.description);\n            resolve([]);\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about dataObject registered in domain registry, and\r\n    * returns discoveredObject.\r\n    * @param  {String}              url  dataObject URL\r\n    * @param  {String}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverDataObjectPerURLDO\",\n    value: function discoverDataObjectPerURLDO(url, domain) {\n      var _this9 = this,\n          _arguments8 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this9.discoverDataObjectPerURL.apply(_this9, _toConsumableArray(_arguments8)).then(function (registryObject) {\n          return resolve(new discovery_DiscoveredObject(registryObject, _this9.runtimeURL, _this9.discoveryURL, _this9.messageBus, _this9));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /**\r\n    * function to request about an dataObjects registered in domain registry with a given name, and\r\n    * return the dataObjects information, if found.\r\n    * @param  {String}              name  dataObject URL\r\n    * @param  {Array<string>}    schema (Optional)     types of dataObjects schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObjects resources\r\n    * @param  {String}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerName\",\n    value: function discoverDataObjectsPerName(name, schema, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/dataObject/name/' + name\n        }\n      };\n\n      if (schema || resources) {\n        msg.body['criteria'] = {\n          resources: resources,\n          dataSchemes: schema,\n          domain: activeDomain\n        };\n      } else {\n        msg.body['criteria'] = {\n          domain: activeDomain\n        };\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code === 200) {\n            Discovery_log.log(\"Reply Value Log: \", reply.body.value);\n            resolve(reply.body.value);\n          } else {\n            Discovery_log.warn(\"[Discovery.discoverDataObjectsPerName] Error Reply for \" + name + \" Reason: \", reply.body.description);\n            resolve([]);\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about dataObject registered in domain registry, and\r\n    * returns discoveredObject.\r\n    * @param  {String}              name  dataObject URL\r\n    * @param  {Array<string>}    schema (Optional)     types of dataObjects schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObjects resources\r\n    * @param  {String}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerNameDO\",\n    value: function discoverDataObjectsPerNameDO(name, schema, resources, domain) {\n      var _this10 = this,\n          _arguments9 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this10.discoverDataObjectsPerName.apply(_this10, _toConsumableArray(_arguments9)).then(function (registryObjects) {\n          return resolve(_this10._convertToDiscoveredObject(registryObjects));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n    /**\r\n    * function to request about specific reporter dataObject registered in domain registry, and\r\n    * return the dataObjects from that reporter.\r\n    * @param  {String}           reporter     dataObject reporter\r\n    * @param  {Array<string>}    schema (Optional)     types of dataObjects schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObjects resources\r\n    * @param  {String}           domain       (Optional)\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerReporter\",\n    value: function discoverDataObjectsPerReporter(reporter, schema, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: _this.runtimeURL + '/discovery/',\n        body: {\n          resource: '/dataObject/reporter/' + reporter\n        }\n      };\n\n      if (schema || resources) {\n        msg.body['criteria'] = {\n          resources: resources,\n          dataSchemes: schema,\n          domain: activeDomain\n        };\n      } else {\n        msg.body['criteria'] = {\n          domain: activeDomain\n        };\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code === 200) {\n            Discovery_log.log(\"Reply Value Log: \", reply.body.value);\n            resolve(reply.body.value);\n          } else {\n            Discovery_log.warn(\"[Discovery.discoverDataObjectsPerName] Error Reply for \" + reporter + \" Reason: \", reply.body.description);\n            resolve([]);\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about dataObject registered in domain registry, and\r\n    * returns discoveredObject.\r\n    * @param  {String}              name  dataObject URL\r\n    * @param  {Array<string>}    schema (Optional)     types of dataObjects schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObjects resources\r\n    * @param  {String}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerReporterDO\",\n    value: function discoverDataObjectsPerReporterDO(reporter, schema, resources, domain) {\n      var _this11 = this,\n          _arguments10 = arguments;\n\n      return new Promise(function (resolve, reject) {\n        _this11.discoverDataObjectsPerReporter.apply(_this11, _toConsumableArray(_arguments10)).then(function (registryObjects) {\n          return resolve(_this11._convertToDiscoveredObject(registryObjects));\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n  }, {\n    key: \"_convertToDiscoveredObject\",\n    value: function _convertToDiscoveredObject(registryObjects) {\n      var _this12 = this;\n\n      return registryObjects.map(function (registryObject) {\n        return new discovery_DiscoveredObject(registryObject, _this12.runtimeURL, _this12.discoveryURL, _this12.messageBus, _this12);\n      });\n    }\n    /** Advanced Search for dataObjects registered in domain registry\r\n    * @deprecated Deprecated. Use discoverDataObjectsPerName instead\r\n    * @param  {String}           name                  name of the dataObject\r\n    * @param  {Array<string>}    schema (Optional)     types of dataObject schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObject resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverDataObject\",\n    value: function discoverDataObject(name, schema, resources, domain) {\n      var _this = this;\n\n      var activeDomain; //let userIdentifier = convertToUserURL(user);\n\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: 'domain://registry.' + activeDomain,\n        body: {\n          resource: name,\n          criteria: {\n            resources: resources,\n            dataSchemes: schema\n          }\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          Discovery_log.log('[Discovery]', reply);\n\n          if (reply.body.code > 299) {\n            Discovery_log.warn(\"[Discovery.discoverDataObject] Error Reply for \" + name + \" Reason: \", reply.body.description);\n            return resolve([]);\n          }\n\n          var hyperties = reply.body.value;\n\n          if (hyperties) {\n            resolve(hyperties);\n          } else {\n            resolve([]);\n          }\n        });\n      });\n    }\n    /** Advanced Search for Hyperties registered in domain registry\r\n    * @deprecated Deprecated. Use discoverHyperties instead\r\n    * @param  {String}           user                  user identifier, either in url or email format\r\n    * @param  {Array<string>}    schema (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverHyperty\",\n    value: function discoverHyperty(user, schema, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      var userIdentifier = convertToUserURL(user);\n\n      if (!domain) {\n        activeDomain = _this.domain;\n      } else {\n        activeDomain = domain;\n      }\n\n      return new Promise(function (resolve, reject) {\n        Discovery_log.log('[Discovery.discoverHyperty] ACTIVE DOMAIN -> ', activeDomain, 'user->', user, 'schema->', schema, 'resources->', resources, 'domain->', domain);\n\n        if (user.includes(':') && !user.includes('user://')) {\n          Discovery_log.log('[Discovery.discoverHyperty] ' + user + ' is legacy domain');\n          var legacyUser = {\n            userID: user,\n            hypertyID: user,\n            schema: schema,\n            resources: resources\n          };\n          return resolve(legacyUser);\n        }\n\n        var msg = {\n          type: 'read',\n          from: _this.discoveryURL,\n          to: 'domain://registry.' + activeDomain,\n          body: {\n            resource: userIdentifier,\n            criteria: {\n              resources: resources,\n              dataSchemes: schema\n            }\n          }\n        };\n        Discovery_log.info('[Discovery] msg to send->', msg);\n\n        _this.messageBus.postMessage(msg, function (reply) {\n          Discovery_log.info('[Discovery] ON discoverHyperty->', reply);\n          var hyperties = reply.body.value;\n\n          if (hyperties) {\n            resolve(hyperties);\n          } else {\n            reject('No Hyperty was found');\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about users registered in domain registry, and\r\n    * return the last hyperty instance registered by the user.\r\n    * @deprecated Deprecated. Use discoverHyperty instead\r\n    * @param  {email}              email\r\n    * @param  {domain}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverHypertyPerUser\",\n    value: function discoverHypertyPerUser(email, domain) {\n      var _this = this;\n\n      var activeDomain;\n      return new Promise(function (resolve, reject) {\n        // Hack for legacy users\n        if (email.includes(':') && !email.includes('user://')) {\n          Discovery_log.log('[Discovery.discoverHyperty] ' + email + 'is legacy domain');\n          var legacyUser = {\n            id: email,\n            hypertyURL: email,\n            descriptor: 'unknown'\n          };\n          return resolve(legacyUser);\n        }\n\n        if (!domain) {\n          activeDomain = _this.domain;\n        } else {\n          activeDomain = domain;\n        }\n\n        var identityURL = 'user://' + email.substring(email.indexOf('@') + 1, email.length) + '/' + email.substring(0, email.indexOf('@')); // message to query domain registry, asking for a user hyperty.\n\n        var message = {\n          type: 'read',\n          from: _this.discoveryURL,\n          to: 'domain://registry.' + activeDomain,\n          body: {\n            resource: identityURL\n          }\n        };\n        Discovery_log.info('[Discovery] Message: ', message, activeDomain, identityURL); //log.info('[Discovery] message READ', message);\n\n        _this.messageBus.postMessage(message, function (reply) {\n          Discovery_log.info('[Discovery] message reply', reply);\n          var hyperty;\n          var mostRecent;\n          var lastHyperty;\n          var value = reply.body.value;\n\n          for (hyperty in value) {\n            if (value[hyperty].lastModified !== undefined) {\n              if (mostRecent === undefined) {\n                mostRecent = new Date(value[hyperty].lastModified);\n                lastHyperty = hyperty;\n              } else {\n                var hypertyDate = new Date(value[hyperty].lastModified);\n\n                if (mostRecent.getTime() < hypertyDate.getTime()) {\n                  mostRecent = hypertyDate;\n                  lastHyperty = hyperty;\n                }\n              }\n            }\n          }\n\n          Discovery_log.info('[Discovery] Last Hyperty: ', lastHyperty, mostRecent);\n          var hypertyURL = lastHyperty;\n\n          if (hypertyURL === undefined) {\n            return reject('User Hyperty not found');\n          }\n\n          var idPackage = {\n            id: email,\n            descriptor: value[hypertyURL].descriptor,\n            hypertyURL: hypertyURL\n          };\n          Discovery_log.info('[Discovery] ===> hypertyDiscovery messageBundle: ', idPackage);\n          resolve(idPackage);\n        });\n      });\n    }\n    /**\r\n    * function to request about users registered in domain registry, and\r\n    * return the all the hyperties registered by the user\r\n    * @deprecated Deprecated. Use discoverHyperty instead\r\n    * @param  {email}              email\r\n    * @param  {domain}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"discoverHypertiesPerUser\",\n    value: function discoverHypertiesPerUser(email, domain) {\n      var _this = this;\n\n      var activeDomain;\n      Discovery_log.log('on Function->', email);\n      return new Promise(function (resolve, reject) {\n        if (email.includes(':') && !email.includes('user://')) {\n          Discovery_log.log('[Discovery.discoverHyperty] is legacy domain');\n          var legacyUser = {\n            userID: email,\n            hypertyID: email,\n            schema: schema,\n            resources: resources\n          };\n          return resolve(legacyUser);\n        }\n\n        if (!domain) {\n          activeDomain = _this.domain;\n        } else {\n          activeDomain = domain;\n        }\n\n        var identityURL = 'user://' + email.substring(email.indexOf('@') + 1, email.length) + '/' + email.substring(0, email.indexOf('@')); // message to query domain registry, asking for a user hyperty.\n\n        var message = {\n          type: 'read',\n          from: _this.discoveryURL,\n          to: 'domain://registry.' + activeDomain,\n          body: {\n            resource: identityURL\n          }\n        };\n        Discovery_log.log('[Discovery] Message discoverHypertiesPerUser: ', message, activeDomain, identityURL); //log.info('[Discovery] message READ', message);\n\n        _this.messageBus.postMessage(message, function (reply) {\n          Discovery_log.info('[Discovery] discoverHypertiesPerUser reply', reply);\n          var value = reply.body.value;\n\n          if (!value) {\n            return reject('User Hyperty not found');\n          }\n\n          resolve(value);\n        });\n      });\n    }\n    /**\r\n    * function to request about users registered in domain registry, and\r\n    * return the all the hyperties registered by the user\r\n    * @deprecated Deprecated. Use discoverHyperty instead\r\n    * @param  {email}              email\r\n    * @param  {domain}            domain (Optional)\r\n    */\n\n  }, {\n    key: \"resumeDiscoveries\",\n    value: function resumeDiscoveries() {\n      var _this = this;\n\n      Discovery_log.log('[Discovery] resumeDiscoveries');\n      return new Promise(function (resolve, reject) {\n        var msg = {\n          type: 'read',\n          from: _this.discoveryURL,\n          to: _this.runtimeURL + '/subscriptions',\n          body: {\n            resource: _this.discoveryURL\n          }\n        };\n\n        _this.messageBus.postMessage(msg, function (reply) {\n          Discovery_log.log('[Discovery.resumeDiscoveries] reply: ', reply);\n          var notifications = [];\n\n          if (reply.body.code === 200) {\n            var urls = reply.body.value; // URLs to add listeners to\n            //lets create one DiscoveryObject per notification\n\n            urls.forEach(function (url) {\n              var objectUrl = url.split('/registration')[0];\n              var data = {};\n              data.url = objectUrl;\n              Discovery_log.log('[Discovery.resumeDiscoveries] adding listener to: ', objectUrl);\n\n              if (objectUrl.includes('hyperty://')) {\n                notifications.push(_this.discoverHypertyPerURLDO(objectUrl));\n              } else {\n                notifications.push(_this.discoverDataObjectPerURLDO(objectUrl));\n              }\n            });\n            Promise.all(notifications).then(function (values) {\n              resolve(values);\n            });\n          } else {\n            resolve([]);\n          }\n        });\n      });\n    }\n  }]);\n\n  return Discovery;\n}();\n\n/* harmony default export */ var discovery_Discovery = (Discovery_Discovery);\n// CONCATENATED MODULE: ./src/utils/Search.js\nfunction Search_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Search_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Search_createClass(Constructor, protoProps, staticProps) { if (protoProps) Search_defineProperties(Constructor.prototype, protoProps); if (staticProps) Search_defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Search =\n/*#__PURE__*/\nfunction () {\n  function Search(discovery, identityManager) {\n    Search_classCallCheck(this, Search);\n\n    if (!discovery) throw new Error('The discovery component is a needed parameter');\n    if (!identityManager) throw new Error('The identityManager component is a needed parameter');\n\n    var _this = this;\n\n    _this.discovery = discovery;\n    _this.identityManager = identityManager;\n  }\n\n  Search_createClass(Search, [{\n    key: \"myIdentity\",\n    value: function myIdentity() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.identityManager.discoverUserRegistered().then(function (result) {\n          resolve(result);\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n  }, {\n    key: \"hyperties\",\n    value: function hyperties(users, schemes, resources) {\n      var globalFlag = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    } //TODO: reuse users or the other way around\n\n    /**\r\n     * List of usersURL to search\r\n     * @param  {array<URL.userURL>}  users List of UserUR, like this format user://<ipddomain>/<user-identifier>\r\n     * @return {Promise}\r\n     */\n\n  }, {\n    key: \"users\",\n    value: function users(usersURLs, providedDomains, schemes, resources) {\n      var globalFlag = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      if (!usersURLs) throw new Error('You need to provide a list of users');\n      if (!providedDomains) throw new Error('You need to provide a list of domains');\n      if (!resources) throw new Error('You need to provide a list of resources');\n      if (!schemes) throw new Error('You need to provide a list of schemes');\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        console.info('[Search] Users: ', usersURLs, usersURLs.length);\n        console.info('[Search] Domains: ', providedDomains, providedDomains.length);\n\n        if (usersURLs.length === 0) {\n          console.info('Don\\'t have users to discovery');\n          resolve(usersURLs);\n        } else {\n          var getUsers = [];\n          usersURLs.forEach(function (userURL, index) {\n            var currentDomain = providedDomains[index];\n            console.info('[Search] Search user ' + userURL + ' for provided domain:', currentDomain);\n\n            if (!globalFlag) {\n              getUsers.push(_this.discovery.discoverHyperties(userURL, schemes, resources, currentDomain));\n            } else {\n              getUsers.push(_this.discovery.discoverHypertiesPerUserProfileData(userURL, schemes, resources));\n            }\n          });\n          console.info('Requests promises: ', getUsers);\n          Promise.all(getUsers.map(function (promise) {\n            return promise.then(function (hyperty) {\n              return hyperty;\n            }, function (error) {\n              return error;\n            });\n          })).then(function (hyperties) {\n            console.info('[Search] Hyperties from new Discovery', hyperties);\n            var result = hyperties.map(function (hyperty) {\n              if (hyperty.hasOwnProperty('hypertyID')) return hyperty;\n              var recent = Object.keys(hyperty).reduceRight(function (a, b) {\n                var hypertyDate = new Date(hyperty[b].lastModified);\n                var hypertyDateP = new Date(hyperty[a].lastModified);\n\n                if (hypertyDateP.getTime() < hypertyDate.getTime()) {\n                  return b;\n                }\n\n                return a;\n              });\n              return hyperty[recent];\n            });\n            var clean = result.filter(function (hyperty) {\n              return hyperty.hasOwnProperty('hypertyID');\n            });\n            console.log('Requests result: ', clean);\n            hyperties.forEach(function (entry) {\n              if (entry !== 'No Hyperty was found') {\n                return resolve(clean);\n              }\n            });\n            reject('No Hyperty was found');\n          }).catch(function (reason) {\n            console.error(reason);\n            resolve(usersURLs);\n          });\n        }\n      });\n    }\n  }]);\n\n  return Search;\n}();\n\n/* harmony default export */ var utils_Search = (Search);\n// CONCATENATED MODULE: ./src/utils/EventEmitter.js\nfunction EventEmitter_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction EventEmitter_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction EventEmitter_createClass(Constructor, protoProps, staticProps) { if (protoProps) EventEmitter_defineProperties(Constructor.prototype, protoProps); if (staticProps) EventEmitter_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n * EventEmitter\r\n * All classes which extends this, can have addEventListener and trigger events;\r\n */\nvar EventEmitter =\n/*#__PURE__*/\nfunction () {\n  function EventEmitter() {\n    EventEmitter_classCallCheck(this, EventEmitter);\n  }\n\n  EventEmitter_createClass(EventEmitter, [{\n    key: \"addEventListener\",\n\n    /**\r\n     * addEventListener listen for an eventType\r\n     * @param  {string}         eventType - listening for this type of event\r\n     * @param  {Function}       cb        - callback function will be executed when the event it is invoked\r\n     */\n    value: function addEventListener(eventType, cb) {\n      var _this = this;\n\n      _this[eventType] = cb;\n    }\n    /**\r\n     * Invoke the eventType\r\n     * @param  {string} eventType - event will be invoked\r\n     * @param  {object} params - parameters will be passed to the addEventListener\r\n     */\n\n  }, {\n    key: \"trigger\",\n    value: function trigger(eventType, params) {\n      var _this = this;\n\n      if (_this[eventType]) {\n        _this[eventType](params);\n      }\n    }\n  }]);\n\n  return EventEmitter;\n}();\n\n/* harmony default export */ var utils_EventEmitter = (EventEmitter);\n// CONCATENATED MODULE: ./src/contextManager/ContextObserver.js\nfunction ContextObserver_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { ContextObserver_typeof = function _typeof(obj) { return typeof obj; }; } else { ContextObserver_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return ContextObserver_typeof(obj); }\n\nfunction ContextObserver_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ContextObserver_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ContextObserver_createClass(Constructor, protoProps, staticProps) { if (protoProps) ContextObserver_defineProperties(Constructor.prototype, protoProps); if (staticProps) ContextObserver_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction ContextObserver_possibleConstructorReturn(self, call) { if (call && (ContextObserver_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return ContextObserver_assertThisInitialized(self); }\n\nfunction ContextObserver_getPrototypeOf(o) { ContextObserver_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return ContextObserver_getPrototypeOf(o); }\n\nfunction ContextObserver_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) ContextObserver_setPrototypeOf(subClass, superClass); }\n\nfunction ContextObserver_setPrototypeOf(o, p) { ContextObserver_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return ContextObserver_setPrototypeOf(o, p); }\n\nfunction ContextObserver_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n//import IdentityManager from '../identityManager/IdentityManager';\n//import Syncher from '../syncher/Syncher.js';\n//import Discovery from '../discovery/Discovery.js';\n//import {divideURL} from '../utils/utils';\n//import Search from '../utils/Search';\n\n/**\r\n* Context Observer;\r\n* @author Paulo Chainho [paulo-g-chainho@alticelabs.com]\r\n*/\n\nvar ContextObserver =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  ContextObserver_inherits(ContextObserver, _EventEmitter);\n\n  function ContextObserver(hypertyURL, bus, configuration, contextResourceTypes, factory, syncher) {\n    var _this2;\n\n    ContextObserver_classCallCheck(this, ContextObserver);\n\n    if (!hypertyURL) throw new Error('The hypertyURL is a needed parameter');\n    if (!bus) throw new Error('The MiniBus is a needed parameter');\n    if (!configuration) throw new Error('The configuration is a needed parameter ');\n    if (!factory) throw new Error('The factory is a needed parameter ');\n    _this2 = ContextObserver_possibleConstructorReturn(this, ContextObserver_getPrototypeOf(ContextObserver).call(this));\n\n    var _this = ContextObserver_assertThisInitialized(ContextObserver_assertThisInitialized(_this2));\n\n    _this._contextResourceTypes = contextResourceTypes;\n    _this._url = hypertyURL;\n    _this._discoverUsersPromises = {}; // object with promises executed at discoverUsers function\n\n    _this._observePromises = {}; // object with promises executed at observe function\n    //let identityManager = new IdentityManager(hypertyURL, configuration.runtimeURL, bus);\n\n    console.log('[ContextObserver] started with hypertyURL->', hypertyURL);\n    _this._domain = factory.divideURL(configuration.runtimeURL).domain;\n    _this._objectDescURL = 'hyperty-catalogue://catalogue.' + _this._domain + '/.well-known/dataschema/Context';\n    _this._users2observe = [];\n    _this._observers = {};\n    _this2._syncher = syncher ? syncher : factory.createSyncher(hypertyURL, bus, configuration);\n    var discovery = factory.createDiscovery(hypertyURL, configuration.runtimeURL, bus);\n    _this._discovery = discovery;\n    _this._discoveries = {}; //list of discovered objects\n    //_this.identityManager = identityManager;\n    //_this.search = new Search(discovery, identityManager);\n\n    window.discovery = _this._discovery;\n    return _this2;\n  }\n\n  ContextObserver_createClass(ContextObserver, [{\n    key: \"start\",\n    value: function start(resumedContext, disconnectedCallBack) {\n      var _this = this;\n\n      console.log('[ContextObserver.start] ');\n      return new Promise(function (resolve, reject) {\n        _this._syncher.resumeObservers({\n          store: true\n        }).then(function (observers) {\n          var observersList = Object.keys(observers);\n\n          if (observersList.length > 0) {\n            console.log('[ContextObserver.start] resuming: ', observers);\n            /*observersList.forEach((i)=>{\r\n            _this._users2observe.push(new UserAvailabilityController(observers[i]));\r\n            });*/\n\n            _this._observers = observers;\n            resolve(observers);\n            observersList.forEach(function (observer) {\n              var Context = observers[observer]; // By default resumed context is set with resumedContext.\n\n              if (resumedContext) context.data.values = resumedContext; // Context will will be updated with value synchronized with reporter if connected\n\n              Context.sync(); //Add listener to be notified when reporter is abruptly disconnected\n\n              if (disconnectedCallBack) Context.onDisconnected(disconnectedCallBack);\n            });\n          } else {\n            resolve(false);\n          }\n        }).catch(function (reason) {\n          console.info('[ContextObserver] Resume Observer failed | ', reason);\n          resolve(false);\n        });\n      }).catch(function (reason) {\n        reject('[ContextObserver] Start failed | ', reason);\n      });\n    }\n  }, {\n    key: \"resumeDiscoveries\",\n    value: function resumeDiscoveries() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._discovery.resumeDiscoveries().then(function (discoveries) {\n          console.log('[ContextObserver._resumeDiscoveries] found: ', discoveries);\n          discoveries.forEach(function (discovery) {\n            if (discovery.data.resources && discovery.data.resources[0] === _this._contextResourceTypes[0]) {\n              console.log('[ContextObserver._resumeDiscoveries] resuming: ', discovery);\n\n              if (discovery.data.status === 'live') {\n                // previously discovered object is now live\n                resolve([discovery.data]);\n                discovery.unsubscribeLive(_this._url);\n              } else {\n                // previously discovered object is still disconnected\n                discovery.onLive(_this._url, function () {\n                  console.log('[ContextObserver._resumeDiscoveries] disconnected Hyperty is back to live', discovery);\n                  resolve([discovery.data]);\n                  discovery.unsubscribeLive(_this._url);\n                });\n              }\n            }\n          });\n        });\n      }).catch(function (reason) {\n        reject('[ContextObserver] resumeDiscoveries failed | ', reason);\n      });\n    }\n  }, {\n    key: \"onResumeObserver\",\n    value: function onResumeObserver(callback) {\n      var _this = this;\n\n      _this._onResumeObserver = callback;\n    }\n  }, {\n    key: \"discoverUsers\",\n    value: function discoverUsers(email, domain) {\n      var _this = this;\n\n      var user = email + '@' + domain;\n\n      if (!_this._discoverUsersPromises[user]) {\n        _this._discoverUsersPromises[user] = new Promise(function (resolve, reject) {\n          _this._discovery.discoverHypertiesDO(email, ['context'], _this._contextResourceTypes, domain).then(function (hyperties) {\n            //_this.search.users([email], [domain], ['context'], ['Context_context']).then(function(a) {\n            console.log('[ContextObserver.discoverUsers] discovery result->', hyperties);\n            var discovered = [];\n            var disconnected = [];\n            hyperties.forEach(function (hyperty) {\n              _this._discoveries[hyperty.data.hypertyID] = hyperty;\n\n              if (hyperty.data.status === 'live') {\n                discovered.push(hyperty.data);\n              } else {\n                disconnected.push(hyperty);\n              }\n            });\n\n            if (discovered.length > 0) {\n              console.log('[ContextObserver.discoverUsers] returning discovered hyperties data->', discovered);\n              resolve(discovered);\n            } else if (disconnected.length > 0) {\n              console.log('[ContextObserver.discoverUsers] disconnected Hyperties ', disconnected); //resolve([]);\n\n              disconnected[0].onLive(_this._url, function () {\n                console.log('[ContextObserver.discoverUsers] disconnected Hyperty is back to live', disconnected[0]);\n                discovered.push(disconnected[0].data);\n                resolve(discovered);\n                disconnected[0].unsubscribeLive(_this._url);\n              });\n            }\n          });\n        });\n      }\n\n      return _this._discoverUsersPromises[user];\n    }\n    /**\r\n     * This function is used to start the user Context observation for a certain user Context reporter\r\n     * @param  {DiscoveredObject} hyperty       Hyperty to be observed.\r\n     * @return {<Promise> DataObjectObserver}      It returns as a Promise the UserAvailability Data Object Observer.\r\n     */\n\n  }, {\n    key: \"observe\",\n    value: function observe(hyperty) {\n      var domainSubscription = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n      var _this = this;\n\n      if (!_this._observePromises[hyperty.hypertyID]) {\n        _this._observePromises[hyperty.hypertyID] = new Promise(function (resolve, reject) {\n          //check if we are already observing it\n          _this._users2observe.forEach(function (Context) {\n            if (Context._reporter === hyperty.hypertyID) return resolve(Context);\n          });\n\n          _this._discovery.discoverDataObjectsPerReporter(hyperty.hypertyID, ['context'], _this._contextResourceTypes, _this._domain).then(function (dataObjects) {\n            console.log('[ContextObserver.discoverAvailability] discovered context objects ', dataObjects);\n            var last = 0;\n            var url;\n            dataObjects.forEach(function (dataObject) {\n              if (dataObject.hasOwnProperty('lastModified') && dataObject.hasOwnProperty('url') && Date.parse(dataObject.lastModified) > last) {\n                last = dataObject.lastModified;\n                url = dataObject.url; //console.log('URL DATA Object', url);\n              }\n            });\n\n            if (last != 0 && url) {\n              resolve(_this._subscribeContext(hyperty, url, domainSubscription));\n            } else {\n              reject('[ContextObserver.observe] discovered DataObjecs are invalid', dataObjects);\n            }\n          });\n        });\n      }\n\n      return _this._observePromises[hyperty.hypertyID];\n    }\n  }, {\n    key: \"_subscribeContext\",\n    value: function _subscribeContext(hyperty, url) {\n      var domainSubscription = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n      var _this = this; // avoid duplicated subscriptions\n\n\n      return new Promise(function (resolve, reject) {\n        _this._users2observe.forEach(function (Context) {\n          if (Context.url === url) return resolve(Context);\n        });\n\n        var input = {\n          schema: _this._objectDescURL,\n          resource: url,\n          store: null,\n          p2p: null,\n          mutual: null,\n          domain_subscription: domainSubscription\n        };\n\n        _this._syncher.subscribe(input).then(function (Context) {\n          console.log('[ContextObserver._subscribeContext] observer object', Context); //let newUserAvailability = new UserAvailabilityController(Context, userID);\n\n          _this._users2observe.push(Context); // When Object is disconnected set user Context status as unavailable\n\n\n          Context.onDisconnected(function () {\n            console.log('[ContextObserver.onDisconnected]: ', Context);\n            Context.data.values[0].value = 'unavailable';\n            Context.sync();\n          });\n          resolve(Context);\n        });\n      });\n    }\n  }, {\n    key: \"_discoverAndSubscribeLegacyUsers\",\n    value: function _discoverAndSubscribeLegacyUsers(name) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._discovery.discoverDataObjectsPerName(name).then(function (result) {\n          console.log('[ContextObserver._discoverAndSubscribeLegacyUsers] All DataObjects Result', result);\n          result.forEach(function (obj) {\n            if (obj.status === 'live') {\n              console.log('Live obj', obj);\n\n              if (!obj.hypertyID) {\n                obj.hypertyID = obj.reporter;\n              }\n\n              _this._subscribeContext(obj.schema, obj.url).then(function (resultSubscribe) {\n                console.log('[ContextObserver._discoverAndSubscribeLegacyUsers] _subscribeContext', resultSubscribe);\n                return resolve(resultSubscribe);\n              });\n            }\n          });\n        }).catch(function (err) {\n          console.log('error ', err);\n        });\n      });\n    }\n    /**\r\n    * This function is used to stop the user Context observation for a certain user\r\n    * @param  {string} Context       the UserAvailability Data Object Observer URL to be unobserved.\r\n    */\n\n  }, {\n    key: \"unobserve\",\n    value: function unobserve(Context) {\n      var _this = this;\n\n      _this._users2observe.forEach(function (user, index) {\n        if (user.url === Context) {\n          user.unsubscribe();\n\n          _this._users2observe.splice(index, 1);\n        }\n      });\n    }\n  }]);\n\n  return ContextObserver;\n}(utils_EventEmitter);\n\n/* harmony default export */ var contextManager_ContextObserver = (ContextObserver);\n// CONCATENATED MODULE: ./src/contextManager/ContextReporter.js\nfunction ContextReporter_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { ContextReporter_typeof = function _typeof(obj) { return typeof obj; }; } else { ContextReporter_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return ContextReporter_typeof(obj); }\n\nfunction ContextReporter_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ContextReporter_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ContextReporter_createClass(Constructor, protoProps, staticProps) { if (protoProps) ContextReporter_defineProperties(Constructor.prototype, protoProps); if (staticProps) ContextReporter_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction ContextReporter_possibleConstructorReturn(self, call) { if (call && (ContextReporter_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return ContextReporter_assertThisInitialized(self); }\n\nfunction ContextReporter_getPrototypeOf(o) { ContextReporter_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return ContextReporter_getPrototypeOf(o); }\n\nfunction ContextReporter_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) ContextReporter_setPrototypeOf(subClass, superClass); }\n\nfunction ContextReporter_setPrototypeOf(o, p) { ContextReporter_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return ContextReporter_setPrototypeOf(o, p); }\n\nfunction ContextReporter_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Service Framework\n//import Syncher from '../syncher/Syncher';\n// Utils\n //import {divideURL} from '../utils/utils.js';\n// import availability from './availability.js';\n\n/**\r\n* Context Reporter;\r\n* @author Paulo Chainho [paulo-g-chainho@alticelabs.com]\r\n*/\n\nvar ContextReporter =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  ContextReporter_inherits(ContextReporter, _EventEmitter);\n\n  function ContextReporter(hypertyURL, bus, configuration, factory, syncher) {\n    var _this2;\n\n    ContextReporter_classCallCheck(this, ContextReporter);\n\n    if (!hypertyURL) throw new Error('The hypertyURL is a needed parameter');\n    if (!bus) throw new Error('The MiniBus is a needed parameter');\n    if (!configuration) throw new Error('The configuration is a needed parameter');\n    _this2 = ContextReporter_possibleConstructorReturn(this, ContextReporter_getPrototypeOf(ContextReporter).call(this, hypertyURL, bus, configuration));\n\n    var _this = ContextReporter_assertThisInitialized(ContextReporter_assertThisInitialized(_this2));\n\n    console.info('[ContextReporter] started with url: ', hypertyURL);\n    _this2.syncher = syncher ? syncher : factory.createSyncher(hypertyURL, bus, configuration); //    this.discovery = new Discovery(hypertyURL, bus);\n\n    _this2.domain = factory.divideURL(configuration.runtimeURL).domain;\n    _this2.contexts = {};\n    _this2.contextDescURL = 'hyperty-catalogue://catalogue.' + _this2.domain + '/.well-known/dataschema/Context'; //    this.heartbeat = [];\n\n    _this2.syncher.onNotification(function (event) {\n      var _this = ContextReporter_assertThisInitialized(ContextReporter_assertThisInitialized(_this2));\n\n      _this.onNotification(event);\n    }); //TODO: uncomment when used with service framework develop branch\n\n\n    _this2.syncher.onClose(function (event) {\n      console.log('[ContextReporter.onClose]');\n\n      var _this = ContextReporter_assertThisInitialized(ContextReporter_assertThisInitialized(_this2));\n\n      _this.setStatus(event.id, 'unavailable');\n\n      event.ack();\n    });\n\n    return _this2;\n  } //TODO: move to User availability Reporter or to abstract HypertyContextReporter\n\n\n  ContextReporter_createClass(ContextReporter, [{\n    key: \"start\",\n    value: function start() {\n      var _this3 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this3.syncher.resumeReporters({\n          store: true\n        }).then(function (reporters) {\n          var reportersList = Object.keys(reporters);\n\n          if (reportersList.length > 0) {\n            console.log('[ContextReporter.start] resuming ', reporters[reportersList[0]]); // set availability to available\n\n            _this.contexts = reporters; //TODO:\n\n            reportersList.forEach(function (context) {\n              _this._onSubscription(_this.contexts[context]);\n            });\n            resolve(_this.contexts);\n          } else {\n            console.log('[ContextReporter.start] nothing to resume ', reporters);\n            resolve(false);\n          }\n        }).catch(function (reason) {\n          console.error('[ContextReporter] Resume failed | ', reason);\n        });\n      }).catch(function (reason) {\n        reject('[ContextReporter] Start failed | ', reason);\n      });\n    }\n  }, {\n    key: \"processNotification\",\n    value: function processNotification(event) {\n      var _this = this;\n\n      console.log('[ContextReporter.processNotification: ', event);\n      event.ack();\n    }\n    /**\r\n     * This function is used to create a new status object syncher\r\n     * @param  {URL.UserURL} contacts List of Users\r\n     * @return {Promise}\r\n     */\n\n  }, {\n    key: \"create\",\n    value: function create(id, init, resources) {\n      var name = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'myContext';\n      var reporter = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n      var reuseURL = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n\n      //debugger;\n      var _this = this;\n\n      var input;\n      return new Promise(function (resolve, reject) {\n        if (!reporter && !reuseURL) {\n          input = {\n            resources: resources,\n            expires: 30\n          };\n        } else if (reporter && !reuseURL) {\n          input = {\n            resources: resources,\n            expires: 30,\n            reporter: reporter\n          };\n        } else if (!reporter && reuseURL) {\n          input = {\n            resources: resources,\n            expires: 30,\n            reuseURL: reuseURL\n          };\n        } else {\n          input = {\n            resources: resources,\n            expires: 30,\n            reuseURL: reuseURL,\n            reporter: reporter\n          };\n        }\n\n        console.info('[ContextReporter.create] lets create a new User availability Context Object ', input);\n\n        _this.syncher.create(_this.contextDescURL, [], init, true, false, name, null, input).then(function (context) {\n          _this.contexts[id] = context;\n\n          _this._onSubscription(context);\n\n          resolve(context);\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n  }, {\n    key: \"_onSubscription\",\n    value: function _onSubscription(context) {\n      context.onSubscription(function (event) {\n        console.info('[ContextReporter._onSubscription] accepting: ', event);\n        event.accept();\n      });\n    }\n  }, {\n    key: \"setContext\",\n    value: function setContext(id, newContext) {\n      var _this = this;\n\n      console.log('THIS [ContextReporter.setContext] before change :', _this.contexts[id]);\n      console.log('[ContextReporter.setContext] before change :', _this.contexts[id].data); //    _this.contexts[id].data.values[0].value = newContext;\n\n      _this.contexts[id].data.values = newContext;\n      console.debug('[ContextReporter.setContext] after change :', _this.contexts[id].data);\n\n      _this.trigger(id + '-context-update', newContext);\n    }\n  }]);\n\n  return ContextReporter;\n}(utils_EventEmitter);\n\n/* harmony default export */ var contextManager_ContextReporter = (ContextReporter);\n// CONCATENATED MODULE: ./src/identity/UserProfile.js\nfunction UserProfile_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n* The UserProfile according to User Identity Data Model\r\n*/\nvar UserProfile = function UserProfile(username, userURL, picture, name, locale, profile) {\n  UserProfile_classCallCheck(this, UserProfile);\n\n  if (username) {\n    this.preferred_username = username;\n  }\n\n  if (picture) {\n    this.picture = picture;\n  }\n\n  if (name) {\n    this.name = name;\n  }\n\n  if (locale) {\n    this.locale = locale;\n  }\n\n  if (userURL) {\n    this.userURL = userURL;\n  }\n\n  if (profile) Object.assign(this, profile);\n};\n\n/* harmony default export */ var identity_UserProfile = (UserProfile);\n// CONCATENATED MODULE: ./src/identity/MessageBodyIdentity.js\nfunction MessageBodyIdentity_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n* The Identity info to be added to Message.Body.Identity\r\n*/\n\n\nvar MessageBodyIdentity_MessageBodyIdentity = function MessageBodyIdentity(username, userURL, picture, name, locale, idp, assertion, profile) {\n  MessageBodyIdentity_classCallCheck(this, MessageBodyIdentity);\n\n  if (!idp) throw new Error('IDP should be a parameter');\n  if (!username) throw new Error('username should be a parameter');\n  this.idp = idp;\n\n  if (assertion) {\n    this.assertion = assertion;\n  }\n\n  this.userProfile = new identity_UserProfile(username, userURL, picture, name, locale, profile);\n};\n\n/* harmony default export */ var identity_MessageBodyIdentity = (MessageBodyIdentity_MessageBodyIdentity);\n// CONCATENATED MODULE: ./src/chatManager/communication.js\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\nvar CommunicationStatus = {\n  OPEN: 'open',\n  PENDING: 'pending',\n  CLOSED: 'closed',\n  PAUSED: 'paused',\n  FAILED: 'failed'\n};\nvar communicationObject = {\n  startingTime: '',\n  status: '',\n  participants: {}\n};\nvar communicationChildren = {\n  \"parent\": \"communication\",\n  \"listener\": \"resources\",\n  \"type\": \"HypertyResource\"\n};\n/*\r\nexport let communicationObject = {\r\n  id: '',\r\n  name: '',\r\n  owner: '',\r\n  scheme: 'comm',\r\n  startingTime: '',\r\n  lastModified: '',\r\n  duration: '',\r\n  status: '',\r\n  participants: []\r\n};\r\n*/\n// CONCATENATED MODULE: ./src/chatManager/InvitationsHandler.js\nfunction InvitationsHandler_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction InvitationsHandler_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction InvitationsHandler_createClass(Constructor, protoProps, staticProps) { if (protoProps) InvitationsHandler_defineProperties(Constructor.prototype, protoProps); if (staticProps) InvitationsHandler_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* To manage Group Chat Invitations\r\n* @author Paulo Chainho [paulo-g-chainho@alticelabs.com]\r\n* @version 0.1.0\r\n*/\n// TODO: have an instance per ChatController\nvar InvitationsHandler =\n/*#__PURE__*/\nfunction () {\n  function InvitationsHandler(hypertyURL) {\n    InvitationsHandler_classCallCheck(this, InvitationsHandler);\n\n    if (!hypertyURL) throw Error('hypertyURL is a necessary dependecy');\n\n    var _this = this;\n\n    _this._hypertyURL = hypertyURL;\n    _this._pending = {}; // All pending invitations\n  }\n\n  InvitationsHandler_createClass(InvitationsHandler, [{\n    key: \"inviteDisconnectedHyperties\",\n\n    /**\r\n     * This function is used to handle notifications for disconnected Hy+erties.\r\n     * @param  {DiscoveredObject[]}    disconnected  array of discovered hyperties that are disconnected\r\n     * @param  {DataObjectReporter}    DataObjectReporter   Data Object Reporter addressed by invitations\r\n     */\n    value: function inviteDisconnectedHyperties(disconnected, dataObjectReporter) {\n      var _this = this;\n\n      console.log('[GroupChatManager.InvitationsHandler.inviteDisconnectedHyperties] lets invite ', disconnected);\n      disconnected.forEach(function (disconnectedHyperty) {\n        if (!_this._pending[dataObjectReporter]) {\n          _this._pending[dataObjectReporter] = {};\n        }\n\n        _this._pending[dataObjectReporter][disconnectedHyperty.data.hypertyID] = disconnectedHyperty;\n        disconnectedHyperty.onLive(_this._hypertyURL, function () {\n          console.log('[GroupChatManager.create] disconnected Hyperty is back to live', disconnectedHyperty);\n          dataObjectReporter.inviteObservers([disconnectedHyperty.data.hypertyID]);\n          disconnectedHyperty.unsubscribeLive(_this._hypertyURL);\n          delete _this._pending[dataObjectReporter][disconnectedHyperty.data.hypertyID];\n        });\n      });\n    }\n    /**\r\n     * This function is used to process sent invitations. In case invitations are not acknowledge by recipient it will be handled as a disconnected hyperty\r\n     * @param  {DiscoveredObject[]}    live  array of discovered hyperties that are or were live\r\n     * @param  {DataObjectReporter}    DataObjectReporter   Data Object Reporter addressed by invitations\r\n     */\n\n  }, {\n    key: \"processInvitations\",\n    value: function processInvitations(live, dataObjectReporter) {\n      var _this2 = this;\n\n      var _this = this;\n\n      var invitations = dataObjectReporter.invitations || [];\n      console.log('[GroupChatManager.InvitationsHandler.processInvitations] waiting for replies ', invitations, this._invitationsResponse);\n      invitations.forEach(function (invitation) {\n        invitation.then(function (result) {\n          console.log('[GroupChatManager.InvitationsHandler.processInvitations] - OK: ', result, _this2._invitationsResponse);\n\n          if (_this2._invitationsResponse) {\n            _this2._invitationsResponse(result);\n          }\n        }).catch(function (result) {\n          console.log('[GroupChatManager.InvitationsHandler.processInvitations] - NOT OK: ', result, _this2._invitationsResponse);\n\n          if (_this2._invitationsResponse) {\n            _this2._invitationsResponse(result);\n          }\n\n          _this.inviteDisconnectedHyperties([live[result.invited]], dataObjectReporter);\n        });\n      });\n    }\n  }, {\n    key: \"resumeDiscoveries\",\n    value: function resumeDiscoveries(discoveryEngine, groupChat) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var live = {};\n        var liveHyperties = [];\n        var disconnected = [];\n        var unsubscriptonPromises = [];\n        discoveryEngine.resumeDiscoveries().then(function (discoveries) {\n          console.log('[GroupChatManager.InvitationsHandler.resumeDiscoveries] found: ', discoveries);\n          discoveries.forEach(function (discovery) {\n            if (discovery.data.resources && discovery.data.resources[0] === 'chat') {\n              console.log('[GroupChatManager.InvitationsHandler.resumeDiscoveries] resuming: ', discovery);\n\n              if (discovery.data.status === 'live') {\n                // previously discovered object is now live\n                live[discovery.data.hypertyID] = discovery;\n                liveHyperties.push(discovery.data.hypertyID);\n                unsubscriptonPromises.push(discovery.unsubscribeLive(_this._hypertyURL));\n              } else {\n                // previously discovered object is still disconnected\n                disconnected.push(discovery);\n              }\n            }\n          });\n          if (disconnected.length > 0) _this.inviteDisconnectedHyperties(disconnected, groupChat);\n\n          if (Object.keys(live).length > 0) {\n            groupChat.inviteObservers(liveHyperties);\n            if (groupChat.invitations.length > 0) _this.processInvitations(live, groupChat);\n            Promise.all(unsubscriptonPromises).then(function () {\n              resolve();\n            });\n          } else resolve();\n        });\n      }).catch(function (reason) {\n        reject('[GroupChatManager.InvitationsHandler.resumeDiscoveries] failed | ', reason);\n      });\n    }\n    /**\r\n     * This function is used to remove and clean all pending invitations.\r\n     * @param  {DataObjectReporter}    DataObjectReporter   Data Object Reporter addressed by invitations\r\n     * @return {Promise} return a promise when all unsubscriptons for pending invitations are finished\r\n     */\n\n  }, {\n    key: \"cleanInvitations\",\n    value: function cleanInvitations(dataObjectReporter) {\n      var _this = this;\n\n      var chatInvitations = _this._pending[dataObjectReporter];\n      console.log('[GroupChatManager.InvitationsHandler.cleanInvitations] ', chatInvitations);\n\n      if (chatInvitations) {\n        return new Promise(function (resolve, reject) {\n          var pendingInvitations = Object.keys(chatInvitations);\n          var unsubscriptonPromises = [];\n          pendingInvitations.forEach(function (invitation) {\n            unsubscriptonPromises.push(chatInvitations[invitation].unsubscribeLive(_this._hypertyURL));\n          });\n          Promise.all(pendingInvitations).then(function () {\n            resolve();\n          });\n        });\n      } else return Promise.resolve();\n    }\n  }, {\n    key: \"invitationResponse\",\n    set: function set(callback) {\n      this._invitationsResponse = callback;\n    }\n  }]);\n\n  return InvitationsHandler;\n}();\n\n/* harmony default export */ var chatManager_InvitationsHandler = (InvitationsHandler);\n// CONCATENATED MODULE: ./src/chatManager/ChatController.js\nfunction ChatController_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ChatController_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ChatController_createClass(Constructor, protoProps, staticProps) { if (protoProps) ChatController_defineProperties(Constructor.prototype, protoProps); if (staticProps) ChatController_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* The Group Chat API is used to control a Group Chat instance.\r\n* @author Vitor Silva [vitor-t-silva@telecom.pt]\r\n* @version 0.1.0\r\n*/\n//import { UserInfo } from './UserInfo';\n\n\n\nvar ChatController_ChatController =\n/*#__PURE__*/\nfunction () {\n  function ChatController(syncher, discovery, domain, search, identity, manager) {\n    ChatController_classCallCheck(this, ChatController);\n\n    if (!syncher) throw Error('Syncher is a necessary dependecy');\n    if (!discovery) throw Error('Discover is a necessary dependecy');\n    if (!domain) throw Error('Domain is a necessary dependecy');\n    if (!search) throw Error('Search is a necessary dependecy');\n\n    var _this = this;\n\n    _this._syncher = syncher;\n    _this.discovery = discovery;\n    _this.search = search;\n    _this.myIdentity = identity;\n    _this.controllerMode = 'reporter';\n    _this.child_cseq = 0;\n    _this.domain = domain;\n    _this._manager = manager;\n    var hypertyURL = syncher.owner;\n    _this._objectDescURL = 'hyperty-catalogue://catalogue.' + domain + '/.well-known/dataschema/Communication';\n    _this._invitationsHandler = new chatManager_InvitationsHandler(hypertyURL);\n  }\n\n  ChatController_createClass(ChatController, [{\n    key: \"_setOnAddChildListener\",\n    value: function _setOnAddChildListener(dataObject) {\n      var _this = this;\n\n      dataObject.onAddChild(function (child) {\n        _this.child_cseq += 1;\n        console.info('[ChatManager.ChatController._setOnAddChildListener] new Child received: ', child);\n        if (_this._onMessage) _this._onMessage(child);\n      });\n    }\n  }, {\n    key: \"_onSubscribe\",\n    value: function _onSubscribe(event) {\n      var dataObjectReporter = this._dataObjectReporter;\n      event.accept();\n      console.log('[ChatManager.ChatController.onSubscribe] event', event, dataObjectReporter.url);\n      console.log('[ChatManager.ChatController.onSubscribe] New user has subscribe this object: ', dataObjectReporter.data, event.identity);\n      var identity = JSON.parse(JSON.stringify(event.identity));\n\n      if (identity.hasOwnProperty('assertion')) {\n        delete identity.assertion;\n      }\n\n      var userInfo = {\n        hypertyURL: event.url,\n        domain: event.domain,\n        identity: identity\n      };\n      var userURL = event.identity.userProfile.guid;\n      console.log('[ChatManager.ChatController.onSubscribe]  new participant', userInfo);\n\n      if (event.identity.legacy) {\n        userInfo.legacy = event.identity.legacy;\n      }\n\n      dataObjectReporter.data.participants[userURL] = userInfo;\n      console.log('[ChatManager.ChatController.onSubscribe] communicationObject OBJ chatcontroller', dataObjectReporter.data.participants);\n      console.log('[ChatManager.ChatController.onSubscribe - onSubscription] ', userInfo); // console.log('[ChatManager.ChatController.onSubscribe - this._onUserAdded] ', this._onUserAdded);\n\n      if (this._onUserAdded) this._onUserAdded(userInfo);\n    }\n  }, {\n    key: \"_onUnsubscribe\",\n    value: function _onUnsubscribe(event) {\n      var dataObjectReporter = this._dataObjectReporter;\n      console.log('[ChatManager.ChatController.onUnsubscribe] event', event, dataObjectReporter.url);\n      var participant = event.identity.userProfile;\n      console.log('[ChatManager.ChatController.onUnsubscribe]  participant left', participant);\n\n      if (event.identity.legacy) {\n        participant.legacy = event.identity.legacy;\n      }\n\n      delete dataObjectReporter.data.participants[participant.userURL];\n      console.log('[ChatManager.ChatController.onUnsubscribe - this._onUserRemoved] ', this.onUserRemoved);\n      if (this._onUserRemoved) this._onUserRemoved(participant);\n    }\n    /**\r\n     * This function is used to send a file.\r\n     * @param  {string}     file                        Is the file to be sent.\r\n     * @return {Promise<Communication.ChatMessage>}        It returns the ChatMessage child object created by the Syncher as a Promise.\r\n     */\n\n  }, {\n    key: \"sendFile\",\n    value: function sendFile(file) {\n      var _this = this;\n\n      var mode = _this.controllerMode;\n      var dataObject = mode === 'reporter' ? _this.dataObjectReporter : _this.dataObjectObserver;\n      return new Promise(function (resolve, reject) {\n        var identity = {\n          userProfile: _this.myIdentity\n        };\n        dataObject.addHypertyResource('resources', 'file', file, identity).then(function (resourceFile) {\n          var identity = {\n            userProfile: _this.myIdentity\n          };\n          var fileSentEvt = {\n            value: resourceFile,\n            identity: identity,\n            resource: resourceFile\n          };\n          var reporterStatus = new discovery_RegistrationStatus(dataObject.url, _this._manager._runtimeURL, _this._manager._hypertyURL, _this._manager._bus); // recursive function to sync with chat reporter\n\n          var share2Reporter = function share2Reporter(file, subscriber, evt, status) {\n            var statusOfReporter = status;\n            file.sharingStatus.then(resolve(evt)).catch(function (result) {\n              console.log('[ChatManager.ChatController.sendFile] share failed: ', result);\n              statusOfReporter.onLive(subscriber, function () {\n                statusOfReporter.unsubscribeLive(subscriber);\n                file.share(true);\n                share2Reporter(file, subscriber, evt, statusOfReporter);\n              }); //TODO: subscribe to sync when reporter is live. New synched messages should trigger onMessage ie onChild\n            });\n          };\n\n          share2Reporter(resourceFile, _this._manager._hypertyURL, fileSentEvt, reporterStatus);\n        });\n      }).catch(function (reason) {\n        console.error('Reason:', reason);\n        reject(reason);\n      });\n    }\n    /**\r\n     * This function is used to send a chat message.\r\n     * @param  {string}     message                        Is the ChatMessage to be sent.\r\n     * @return {Promise<Communication.ChatMessage>}        It returns the ChatMessage child object created by the Syncher as a Promise.\r\n     */\n\n  }, {\n    key: \"send\",\n    value: function send(message, identity) {\n      var _this = this;\n\n      var mode = _this.controllerMode;\n      var dataObject = mode === 'reporter' ? _this.dataObjectReporter : _this.dataObjectObserver;\n      return new Promise(function (resolve, reject) {\n        //      let _dataObjectChild;\n        _this.child_cseq += 1;\n        var msg = {\n          /*        url: dataObject.data.url,\r\n                  cseq: _this.child_cseq,\r\n                  reporter: dataObject.data.reporter,\r\n                  schema: dataObject.data.schema,\r\n                  name: dataObject.data.name,\r\n                  created : new Date().toJSON(),*/\n          type: 'chat',\n          content: message\n        };\n        var sender = identity ? identity : {\n          userProfile: _this.myIdentity\n        }; // TODO: change chatmessages to resource - chat, file\n        // TODO: change message to hypertyResource - https://github.com/reTHINK-project/dev-service-framework/tree/develop/docs/datamodel/data-objects/hyperty-resource\n        // TODO: handle with multiple resources - if the \"message\" will be different for each type of resources\n\n        dataObject.addChild(msg, sender).then(function (dataObjectChild) {\n          console.log('[ChatManager.ChatController][addChild - Chat Message]: ', dataObjectChild); //resolve(dataObjectChild);\n          //TODO: move to separate function\n\n          var msg = {\n            childId: dataObjectChild._childId,\n            from: dataObjectChild._owner,\n            value: dataObjectChild.data,\n            type: 'create',\n            identity: sender\n          };\n          var reporterStatus = new discovery_RegistrationStatus(dataObject.url, _this._manager._runtimeURL, _this._manager._hypertyURL, _this._manager._bus); // recursive function to sync with chat reporter\n\n          var share2Reporter = function share2Reporter(child, subscriber, msg, status) {\n            var statusOfReporter = status;\n            child.sharingStatus.then(resolve(msg)).catch(function (result) {\n              statusOfReporter.onLive(subscriber, function () {\n                statusOfReporter.unsubscribeLive(subscriber);\n                child.share(true);\n                share2Reporter(child, subscriber, msg, statusOfReporter);\n              }); //TODO: subscribe to sync when reporter is live. New synched messages should trigger onMessage ie onChild\n            });\n          };\n\n          share2Reporter(dataObjectChild, _this._manager._hypertyURL, msg, reporterStatus);\n        }).catch(function (reason) {\n          console.error('Reason:', reason);\n          reject(reason);\n        });\n      });\n    }\n    /**\r\n     * [onChange description]\r\n     * @param  {Function} callback [description]\r\n     * @return {[type]}            [description]\r\n     */\n\n  }, {\n    key: \"onChange\",\n    value: function onChange(callback) {\n      var _this = this;\n\n      _this._onChange = callback;\n    }\n    /**\r\n     * This function is used to receive new messages.\r\n     * @param  {Function} callback Function to handle with new messages\r\n     * @return {Communication.ChatMessage} m\r\n     */\n\n  }, {\n    key: \"onMessage\",\n    value: function onMessage(callback) {\n      var _this = this;\n\n      _this._onMessage = callback;\n    }\n    /**\r\n     * [onUserAdded description]\r\n     * @param  {Function} callback [description]\r\n     * @return {[type]}            [description]\r\n     */\n\n  }, {\n    key: \"onUserAdded\",\n    value: function onUserAdded(callback) {\n      var _this = this;\n\n      _this._onUserAdded = callback;\n    }\n    /**\r\n     * When the an user was removed\r\n     * @param  {Function} callback Function handle with the removed user\r\n     * @return {[type]}            [description]\r\n     */\n\n  }, {\n    key: \"onUserRemoved\",\n    value: function onUserRemoved(callback) {\n      var _this = this;\n\n      _this._onUserRemoved = callback;\n    }\n    /**\r\n     * This function is used to receive requests to close the Group Chat instance.\r\n     * @return {DeleteEvent} The DeleteEvent fired by the Syncher when the Chat is closed.\r\n     */\n\n  }, {\n    key: \"onClose\",\n    value: function onClose(callback) {\n      var _this = this;\n\n      _this._onClose = callback;\n    }\n  }, {\n    key: \"onResponse\",\n    value: function onResponse(callback) {\n      var _this = this;\n\n      _this._onResponse = callback;\n    }\n    /**\r\n     * This function is used to add / invite new user on an existing Group Chat instance.\r\n     * Only the Reporter, i.e. the Hyperty that has created the Group Chat, is allowed to use this function.\r\n     * @param {URL.UserURL}  users  User to be invited to join the Group Chat that is identified with reTHINK User URL.\r\n     * @return {Promise<boolean>}   It returns as a Promise true if successfully invited or false otherwise.\r\n     */\n\n  }, {\n    key: \"addUser\",\n    value: function addUser(users) {\n      var _this = this;\n\n      var haveEmptyElements = function haveEmptyElements(element) {\n        console.log('Element:', element.length);\n        return element.length !== 0;\n      };\n\n      var notFoundElements = function notFoundElements(element) {\n        console.log('user not found: ', element);\n        return !(element instanceof String);\n      };\n\n      return new Promise(function (resolve, reject) {\n        if (users.filter(haveEmptyElements).length === 0) {\n          return reject('Don\\'t have users to invite');\n        }\n\n        console.info('[ChatManager.ChatController.addUsers ]: ', users);\n        /*_this.search.users(users, domains, ['comm'], ['chat'])\r\n        .then((hypertiesIDs) => {\r\n          if (hypertiesIDs.filter(notFoundElements).length === 0) {\r\n          throw 'User(s) not found';\r\n        }\r\n          let selectedHyperties = hypertiesIDs.map((hyperty) => {\r\n          return hyperty.hypertyID;\r\n        });*/\n\n        var usersDiscovery = [];\n        var disconnected = [];\n        var live = {};\n        users.forEach(function (user) {\n          var userDiscoveryPromise = _this.discovery.discoverHypertiesDO(user.user, ['comm'], ['chat'], user.domain);\n\n          usersDiscovery.push(userDiscoveryPromise);\n        });\n        Promise.all(usersDiscovery).then(function (userDiscoveryResults) {\n          console.log('[ChatManager.ChatController.addUsers] Users Discovery Results->', userDiscoveryResults);\n          var selectedHyperties = [];\n          userDiscoveryResults.forEach(function (userDiscoveryResult) {\n            userDiscoveryResult.forEach(function (discovered) {\n              if (discovered.data.status === 'live') {\n                selectedHyperties.push(discovered.data.hypertyID);\n                live[discovered.data.hypertyID] = discovered;\n              } else if (disconnected.length < 5) disconnected.push(discovered);\n            });\n          });\n          console.info('[ChatManager.ChatController]------------------------ Syncher Create ---------------------- \\n');\n          console.info('[ChatManager.ChatController]Selected Hyperties: !!! ', selectedHyperties);\n          console.info(\"Have \".concat(selectedHyperties.length, \" users;\")); //        console.info('[ChatManager] HypertiesIDs ', hypertiesIDs);\n\n          var dataObject = _this.controllerMode === 'reporter' ? _this.dataObjectReporter : _this.dataObjectObserver;\n          if (disconnected.length > 0) _this._invitationsHandler.inviteDisconnectedHyperties(disconnected, dataObject);\n          dataObject.inviteObservers(selectedHyperties);\n          if (dataObject.invitations.length > 0) _this._invitationsHandler.processInvitations(live, dataObject);\n          return;\n        }).then(function () {\n          console.info('[ChatManager.ChatController]Are invited with success ' + users.length + ' users;');\n          resolve(true);\n        }).catch(function (reason) {\n          console.error('An error occurred when trying to invite users;\\n', reason);\n          reject(reason);\n        });\n      });\n    }\n    /**\r\n     * This function is used to request the Reporter to add / invite new user on an existing Group Chat instance.\r\n     * Only Observers are allowed to use this function.\r\n     * @param {URL.UserURL}  users  User to be invited to join the Group Chat that is identified with reTHINK User URL.\r\n     * @return {Promise<boolean>}   It returns as a Promise true if successfully invited or false otherwise.\r\n     */\n\n  }, {\n    key: \"addUserReq\",\n    value: function addUserReq(users) {\n      var _this = this; //check is Observer and invoke observer.execute() with new promise\n\n\n      var haveEmptyElements = function haveEmptyElements(element) {\n        console.log('Element:', element.length);\n        return element.length !== 0;\n      };\n\n      return new Promise(function (resolve, reject) {\n        if (users.filter(haveEmptyElements).length === 0) {\n          return reject('[ChatManager.ChatController.addUserReq] Don\\'t have users to add');\n        }\n\n        if (!_this.controllerMode === 'observer') {\n          return reject('[ChatManager.ChatController.addUserReq] only allowed to Chat Observer');\n\n          var addUser = _this.addUser(users);\n\n          if (_this._dataObjectObserver) {\n            addUser = _this._dataObjectObserver.execute('addUser', users);\n          }\n\n          addUser.then(function () {\n            console.info('[ChatManager.ChatController.addUserReq] Request accepted by Reporter ');\n            resolve(true);\n          }).catch(function (reason) {\n            console.error('[ChatManager.ChatController.addUserReq] Request rejected by Reporter;\\n', reason);\n            reject(reason);\n          });\n        }\n      });\n    }\n  }, {\n    key: \"onInvitationResponse\",\n    value: function onInvitationResponse(callback) {\n      var _this = this;\n\n      _this._onInvitationResponse = callback;\n      _this._invitationsHandler.invitationResponse = callback;\n    }\n    /**\r\n     * This function is used to remove a user from an existing Group Chat instance.\r\n     * Only the Reporter, i.e. the Hyperty that has created the Group Chat, is allowed to use this function.\r\n     * @return {<Promise> boolean} Promise with the status\r\n     */\n\n    /**\r\n     * This function is used to remove a user from an existing Group Chat instance.\r\n     * Only the Reporter, i.e. the Hyperty that has created the Group Chat, is allowed to use this function.\r\n     * @param  {URL.UserURL} user       User to be removed from the Group Chat that is identified with reTHINK User URL.\r\n     * @return {<Promise> boolean}      It returns as a Promise true if successfully removed or false otherwise.\r\n     */\n\n  }, {\n    key: \"removeUser\",\n    value: function removeUser(user) {\n      // TODO: implement the removeUser;\n      console.log('[ChatManager.ChatController]Not yet implemented: ', user);\n    }\n    /**\r\n     * This function is used to close an existing Group Chat instance.\r\n     * Only available to Chat Group Reporters i.e. the Hyperty instance that created the Group Chat.\r\n     * @return {<Promise>Boolean} It returns as a Promise true if successfully closed or false otherwise.\r\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      var del = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n      // TODO: the dataObjectReporter.delete should be a Promise;\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this.controllerMode === 'reporter') {\n          // reporter\n          _this._invitationsHandler.cleanInvitations(_this.dataObjectReporter).then(function () {\n            if (!del) {\n              _this._manager.communicationObject.status = 'closed';\n              resolve(true);\n            } else {\n              try {\n                delete _this._manager._reportersControllers[_this.dataObjectReporter.url];\n\n                _this.dataObjectReporter.delete();\n\n                resolve(true);\n                if (_this._onClose) _this._onClose({\n                  code: 200,\n                  desc: 'deleted',\n                  url: _this.dataObjectReporter.url\n                });\n              } catch (e) {\n                console.error(e);\n                reject(false);\n              }\n            }\n          });\n        } else {\n          // observer\n          if (del) {\n            try {\n              delete _this._manager._observersControllers[_this.dataObjectObserver.url];\n\n              _this.dataObjectObserver.unsubscribe();\n\n              resolve(true);\n            } catch (e) {\n              console.error(e);\n              reject(false);\n            }\n          } else {\n            // TODO: send message \n            resolve(true);\n          }\n        }\n      });\n    }\n  }, {\n    key: \"invitationsHandler\",\n    get: function get() {\n      return this._invitationsHandler;\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this.controllerMode === 'reporter' ? this.dataObjectReporter.url : this.dataObjectObserver.url;\n    }\n  }, {\n    key: \"dataObjectReporter\",\n    set: function set(dataObjectReporter) {\n      if (!dataObjectReporter) throw new Error('[ChatController] The data object reporter is necessary parameter ');\n\n      var _this = this;\n\n      _this.controllerMode = 'reporter'; // Handler to process received files\n      // dataObjectReporter.onResponse(function(event) {\n      //   console.log('[DataObjectReporter - onResponse]', event);\n      //   if (_this._onInvitationResponse) {\n      //     _this._onInvitationResponse(event);\n      //   }\n      //\n      // });\n\n      dataObjectReporter.onSubscription(function (event) {\n        switch (event.type) {\n          case 'subscribe':\n            _this._onSubscribe(event);\n\n            break;\n\n          case 'unsubscribe':\n            _this._onUnsubscribe(event);\n\n            break;\n        }\n      });\n\n      _this._setOnAddChildListener(dataObjectReporter);\n\n      dataObjectReporter.onRead(function (event) {\n        event.accept();\n      });\n      dataObjectReporter.onExecute(function (event) {\n        switch (event.method) {\n          case 'addUser':\n            _this.addUser(event.params[0]).then(function () {\n              event.accept();\n            }).catch(function (reason) {\n              console.error('Reason:', reason);\n              event.reject(reason);\n            });\n\n            break;\n\n          case 'removeUser':\n            _this.removeUser(event.params).then(function () {\n              event.accept();\n            }).catch(function (reason) {\n              console.error('Reason:', reason);\n              event.reject(reason);\n            });\n\n            break;\n\n          default:\n            event.reject('[ChatController.onExecute] Chat method execution not accepted by Reporter');\n            break;\n        }\n      });\n      _this._dataObjectReporter = dataObjectReporter;\n    },\n    get: function get() {\n      var _this = this;\n\n      return _this._dataObjectReporter;\n    }\n  }, {\n    key: \"messages\",\n    get: function get() {\n      return this.controllerMode === 'reporter' ? this._dataObjectReporter._childrenObjects : this._dataObjectObserver._childrenObjects;\n    }\n  }, {\n    key: \"dataObjectObserver\",\n    set: function set(dataObjectObserver) {\n      var _this = this;\n\n      _this.controllerMode = 'observer';\n      _this._dataObjectObserver = dataObjectObserver;\n      dataObjectObserver.onChange('*', function (event) {\n        console.info('[ChatManager.ChatController]Observer - onChange', event);\n\n        if (event.field.includes('participants')) {\n          switch (event.cType) {\n            case 'add':\n              if (_this._onUserAdded) _this._onUserAdded(event);\n              break;\n\n            case 'remove':\n              if (_this._onUserRemoved) _this._onUserRemoved(event);\n              break;\n          }\n        }\n\n        if (_this._onChange) _this._onChange(event);\n      });\n\n      _this._setOnAddChildListener(dataObjectObserver); // let childrens = dataObjectObserver.childrens;\n      // Object.keys(childrens).forEach((child) => {\n      //   if (_this._onMessage) _this._onMessage({\n      //     childId: child,\n      //     identity: childrens[child].identity,\n      //     value: childrens[child].data\n      //   });\n      // })\n\n    },\n    get: function get() {\n      var _this = this;\n\n      return _this._dataObjectObserver;\n    }\n  }, {\n    key: \"dataObject\",\n    get: function get() {\n      return this.controllerMode === 'reporter' ? this.dataObjectReporter : this.dataObjectObserver;\n    }\n  }, {\n    key: \"closeEvent\",\n    set: function set(event) {\n      var _this = this;\n\n      _this._closeEvent = event;\n      if (_this._onClose) _this._onClose(event);\n    },\n    get: function get() {\n      var _this = this;\n\n      return _this._closeEvent;\n    }\n  }]);\n\n  return ChatController;\n}();\n\n/* harmony default export */ var chatManager_ChatController = (ChatController_ChatController);\n// CONCATENATED MODULE: ./src/chatManager/UserInfo.js\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction UserInfo_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\nvar UserInfo_UserInfo = function UserInfo(hypertyURL, domain, identity) {\n  var _ref;\n\n  UserInfo_classCallCheck(this, UserInfo);\n\n  var completeIdentity = deepClone(identity);\n\n  if (!identity.hasOwnProperty('userProfile')) {\n    completeIdentity['userProfile'] = identity;\n  }\n\n  return _ref = {\n    hypertyURL: hypertyURL,\n    domain: domain\n  }, _defineProperty(_ref, \"domain\", domain), _defineProperty(_ref, \"identity\", completeIdentity), _ref;\n};\n// CONCATENATED MODULE: ./src/chatManager/ChatManager.js\nfunction ChatManager_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ChatManager_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ChatManager_createClass(Constructor, protoProps, staticProps) { if (protoProps) ChatManager_defineProperties(Constructor.prototype, protoProps); if (staticProps) ChatManager_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Service Framework\n//import IdentityManager from '../identityManager/IdentityManager';\n//import RegistrationStatus from '../discovery/RegistrationStatus';\n//import Discovery from '../discovery/Discovery';\n//import Syncher from '../syncher/Syncher';\n// Utils\n//import {divideURL} from '../utils/utils';\n//import Search from '../utils/Search';\n// Internals\n\n\n\n/**\r\n* Hyperty Group Chat Manager API (HypertyChat)\r\n* @author Vitor Silva [vitor-t-silva@telecom.pt]\r\n* @version 0.1.0\r\n*/\n\nvar ChatManager_ChatManager =\n/*#__PURE__*/\nfunction () {\n  function ChatManager(myUrl, bus, configuration, syncher, factory) {\n    ChatManager_classCallCheck(this, ChatManager);\n\n    if (!myUrl) throw new Error('[ChatManager.constructor] The myUrl is a needed parameter');\n    if (!bus) throw new Error('[ChatManager.constructor] The MiniBus is a needed parameter');\n    if (!configuration) throw new Error('[ChatManager.constructor] The configuration is a needed parameter');\n\n    var _this = this;\n\n    if (!syncher) {\n      syncher = factory.createSyncher(myUrl, bus, configuration);\n    }\n\n    _this._runtimeURL = configuration.runtimeURL;\n    var domain = factory.divideURL(_this._runtimeURL).domain;\n    var discovery = factory.createDiscovery(myUrl, configuration.runtimeURL, bus);\n    var identityManager = factory.createIdentityManager(myUrl, configuration.runtimeURL, bus);\n    _this._objectDescURL = 'hyperty-catalogue://catalogue.' + domain + '/.well-known/dataschema/Communication';\n    _this._reportersControllers = {};\n    _this._observersControllers = {};\n    _this._myUrl = myUrl;\n    _this._bus = bus;\n    _this._syncher = syncher;\n    _this._domain = domain;\n    _this.discovery = discovery;\n    _this.identityManager = identityManager;\n    _this.currentIdentity;\n    _this.search = factory.createSearch(discovery, identityManager);\n    _this.communicationObject = communicationObject;\n    _this.communicationChildren = communicationChildren;\n    console.log('[ChatManager] Discover ', discovery);\n    console.log('[ChatManager] Identity Manager ', identityManager);\n  }\n\n  ChatManager_createClass(ChatManager, [{\n    key: \"processNotification\",\n    value: function processNotification(event) {\n      var _this = this;\n\n      console.log('[ChatManager.processNotification: ', event);\n\n      if (event.type === 'create') {\n        // TODO: replace the 100 for Message.Response\n        // event.ack(200);\n        if (_this._onInvitation) {\n          _this._onInvitation(event);\n        }\n      }\n\n      if (event.type === 'delete') {\n        // TODO: replace the 200 for Message.Response\n        event.ack(200);\n        _this._observersControllers[event.url].closeEvent = event;\n        delete _this._observersControllers[event.url];\n        _this._observersControllers.closeEvent = event;\n        _this.communicationObject = communicationObject;\n\n        for (var url in this._reportersControllers) {\n          this._reportersControllers[url].close(event);\n        }\n\n        for (var _url in this._observersControllers) {\n          this._observersControllers[_url].close(event);\n        }\n      }\n    }\n  }, {\n    key: \"myIdentity\",\n    value: function myIdentity(identity) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        console.info('[ChatManager.myIdentity]');\n        if (identity) return resolve(identity);\n\n        if (_this._myUrl.includes('hyperty://')) {\n          _this.identityManager.discoverUserRegistered().then(function (identity) {\n            resolve(identity);\n          }).catch(function (reason) {\n            reject(reason);\n          });\n        } else {\n          _this.identityManager.discoverIdentityPerIdP().then(function (identity) {\n            resolve(identity);\n          }).catch(function (reason) {\n            reject(reason);\n          });\n        }\n      });\n    }\n    /**\r\n     * This function is used to create a new Group Chat providing the name and the identifiers of users to be invited.\r\n     * @param  {string}                     name  Is a string to identify the Group Chat\r\n     * @param  {array<URL.userURL>}         users Array of users to be invited to join the Group Chat. Users are identified with reTHINK User URL, like this format user://<ipddomain>/<user-identifier>\r\n     * @return {<Promise>ChatController}    A ChatController object as a Promise.\r\n     */\n\n  }, {\n    key: \"create\",\n    value: function create(name, users) {\n      var extra = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      var _this = this;\n\n      var syncher = _this._syncher;\n      return new Promise(function (resolve, reject) {\n        _this.communicationObject = communicationObject;\n        _this.communicationObject.cseq = 1;\n        _this.communicationObject.startingTime = new Date().toJSON();\n        _this.communicationObject.status = CommunicationStatus.OPEN;\n        var myIdentity;\n\n        _this.myIdentity().then(function (identity) {\n          myIdentity = identity;\n          console.log('[ChatManager.create ] My Identity', identity); // let url = _this.communicationObject.reporter;\n\n          var userInfo = new UserInfo_UserInfo(_this._myUrl, _this._domain, identity); // Add my identity\n\n          _this.communicationObject.participants[identity.guid] = userInfo;\n          console.log('[ChatManager.create ] participants: ', _this.communicationObject.participants);\n          console.log('[ChatManager.create ] communicationObject', _this.communicationObject);\n          console.info('[ChatManager.create] searching ' + users); //let usersSearch = _this.search.users(users, domains, ['comm'], ['chat']);\n\n          var usersDiscovery = [];\n          var disconnected = [];\n          var live = {};\n          users.forEach(function (user) {\n            var userDiscoveryPromise = _this.discovery.discoverHypertiesDO(user.user, ['comm'], ['chat'], user.domain);\n\n            usersDiscovery.push(userDiscoveryPromise); //if (user.user.includes('://')) mutual = false;\n          });\n          Promise.all(usersDiscovery).then(function (userDiscoveryResults) {\n            console.log('[ChatManager.create] Users Discovery Results->', userDiscoveryResults);\n            var selectedHyperties = [];\n            userDiscoveryResults.forEach(function (userDiscoveryResult) {\n              userDiscoveryResult.forEach(function (discovered) {\n                if (discovered.data.status === 'live') {\n                  selectedHyperties.push(discovered.data.hypertyID);\n                  live[discovered.data.hypertyID] = discovered;\n                } else {\n                  // To control the number of subscriptions to disconnected devices\n                  if (disconnected.length < 5) {\n                    disconnected.push(discovered);\n                  }\n                }\n              });\n            });\n            /*        return usersSearch;\r\n            }).then((hypertiesIDs) => {\r\n            let selectedHyperties = hypertiesIDs.map((hyperty) => {\r\n            return hyperty.hypertyID;\r\n            }); */\n\n            console.info('[ChatManager] ---------------------- Syncher Create ---------------------- \\n');\n            console.info('[ChatManager] Selected Hyperties: !!! ', selectedHyperties);\n            console.info(\"Have \".concat(selectedHyperties.length, \" users;\"));\n            var mutual = extra.mutual ? extra.mutual : true;\n            var input = Object.assign({\n              resources: ['chat'],\n              mutual: mutual\n            }, extra);\n            delete input.name;\n            if (_this.offline) input.offline = _this.offline;\n            console.info('[ChatManager] input data:', input);\n            return syncher.create(_this._objectDescURL, selectedHyperties, _this.communicationObject, true, false, name, {}, input);\n          }).then(function (dataObjectReporter) {\n            console.info('[ChatManager] 3. Return Create Data Object Reporter', dataObjectReporter);\n            var chatController = new chatManager_ChatController(syncher, _this.discovery, _this._domain, _this.search, myIdentity, _this);\n            chatController.dataObjectReporter = dataObjectReporter;\n            _this._reportersControllers[dataObjectReporter.url] = chatController;\n            console.log('[ChatManager] chatController invitationsHandler: ', chatController.invitationsHandler); // process invitations to handle not received invitations\n\n            if (dataObjectReporter.invitations.length > 0) {\n              chatController.invitationsHandler.processInvitations(live, dataObjectReporter);\n            } // If any invited User is disconnected let's wait until it is connected again\n\n\n            if (disconnected.length > 0) chatController.invitationsHandler.inviteDisconnectedHyperties(disconnected, dataObjectReporter);\n            resolve(chatController);\n          }).catch(function (reason) {\n            reject(reason);\n          });\n        }).catch(function (reason) {\n          console.log('[ChatManager.create] MyIdentity Error:', reason);\n          return reject(reason);\n        });\n      });\n    }\n    /**\r\n     * This function is used to handle notifications about incoming invitations to join a Group Chat.\r\n     * @param  {Function} CreateEvent The CreateEvent fired by the Syncher when an invitaion is received\r\n     */\n\n  }, {\n    key: \"onInvitation\",\n    value: function onInvitation(callback) {\n      var _this = this;\n\n      _this._onInvitation = callback;\n    }\n    /**\r\n     * This function is used to join a Group Chat.\r\n     * @param  {URL.CommunicationURL} invitationURL  The Communication URL of the Group Chat to join that is provided in the invitation event\r\n     * @return {<Promise>ChatController}             It returns the ChatController object as a Promise\r\n     */\n\n  }, {\n    key: \"join\",\n    value: function join(invitationURL) {\n      var mutual = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var identity = arguments.length > 2 ? arguments[2] : undefined;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var syncher = _this._syncher;\n        var myIdentity;\n        console.info('[ChatManager] ------------------------ Syncher subscribe ---------------------- \\n');\n        console.info('invitationURL', invitationURL);\n\n        _this.myIdentity(identity).then(function (identity) {\n          myIdentity = identity;\n          var input = {\n            schema: _this._objectDescURL,\n            resource: invitationURL,\n            store: true,\n            p2p: false,\n            mutual: mutual,\n            domain_subscription: true,\n            identity: identity\n          };\n          if (_this.offline) input.offline = _this.offline;\n          return syncher.subscribe(input);\n        }).then(function (dataObjectObserver) {\n          console.info('Data Object Observer: ', dataObjectObserver);\n          var chatController = new chatManager_ChatController(syncher, _this.discovery, _this._domain, _this.search, myIdentity, _this);\n          resolve(chatController);\n          chatController.dataObjectObserver = dataObjectObserver;\n          _this._observersControllers[dataObjectObserver.url] = chatController;\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n  }, {\n    key: \"offline\",\n    set: function set(offline) {\n      this._offline = offline;\n    },\n    get: function get() {\n      return this._offline ? this._offline : false;\n    }\n  }]);\n\n  return ChatManager;\n}();\n\n/* harmony default export */ var chatManager_ChatManager = (ChatManager_ChatManager);\n// CONCATENATED MODULE: ./src/chatManager/Chat.js\nfunction Chat_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Chat_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Chat_createClass(Constructor, protoProps, staticProps) { if (protoProps) Chat_defineProperties(Constructor.prototype, protoProps); if (staticProps) Chat_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* The Group Chat API is used to control a Group Chat instance.\r\n* @author Vitor Silva [vitor-t-silva@telecom.pt]\r\n* @version 0.1.0\r\n*/\n//import { UserInfo } from './UserInfo';\n//import RegistrationStatus from '../discovery/RegistrationStatus';\n//import InvitationsHandler from './InvitationsHandler';\nvar Chat =\n/*#__PURE__*/\nfunction () {\n  function Chat(syncher, domain, identity, manager) {\n    Chat_classCallCheck(this, Chat);\n\n    if (!syncher) throw Error('Syncher is a necessary dependecy'); //    if (!discovery) throw Error('Discover is a necessary dependecy');\n\n    if (!domain) throw Error('Domain is a necessary dependecy'); //    if (!search) throw Error('Search is a necessary dependecy');\n\n    var _this = this;\n\n    _this._syncher = syncher; //    _this.discovery = discovery;\n    //    _this.search = search;\n\n    _this.myIdentity = identity;\n    _this.controllerMode = 'reporter';\n    _this.child_cseq = 0;\n    _this.domain = domain;\n    _this._manager = manager;\n    var hypertyURL = syncher.owner;\n    _this._objectDescURL = 'hyperty-catalogue://catalogue.' + domain + '/.well-known/dataschema/Communication'; //    _this._invitationsHandler = new InvitationsHandler(hypertyURL);\n  }\n  /*  get invitationsHandler() {\r\n      return this._invitationsHandler;\r\n    }*/\n\n\n  Chat_createClass(Chat, [{\n    key: \"_setOnAddChildListener\",\n    value: function _setOnAddChildListener(dataObject) {\n      var _this = this;\n\n      dataObject.onAddChild(function (child) {\n        _this.child_cseq += 1;\n        console.info('[ChatManager.ChatController._setOnAddChildListener] new Child received: ', child);\n        if (_this._onMessage) _this._onMessage(child);\n      });\n    }\n  }, {\n    key: \"_onSubscribe\",\n    value: function _onSubscribe(event) {\n      var dataObjectReporter = this._dataObjectReporter;\n      event.accept();\n      console.log('[ChatManager.ChatController.onSubscribe] event', event, dataObjectReporter.url);\n      console.log('[ChatManager.ChatController.onSubscribe] New user has subscribe this object: ', dataObjectReporter.data, event.identity);\n      var identity = JSON.parse(JSON.stringify(event.identity));\n\n      if (identity.hasOwnProperty('assertion')) {\n        delete identity.assertion;\n      }\n\n      var userInfo = {\n        hypertyURL: event.url,\n        domain: event.domain,\n        identity: identity\n      };\n      var userURL = event.identity.userProfile.guid;\n      console.log('[ChatManager.ChatController.onSubscribe]  new participant', userInfo);\n\n      if (event.identity.legacy) {\n        userInfo.legacy = event.identity.legacy;\n      }\n\n      dataObjectReporter.data.participants[userURL] = userInfo;\n      console.log('[ChatManager.ChatController.onSubscribe] communicationObject OBJ chatcontroller', dataObjectReporter.data.participants);\n      console.log('[ChatManager.ChatController.onSubscribe - onSubscription] ', userInfo); // console.log('[ChatManager.ChatController.onSubscribe - this._onUserAdded] ', this._onUserAdded);\n\n      if (this._onUserAdded) this._onUserAdded(userInfo);\n    }\n  }, {\n    key: \"_onUnsubscribe\",\n    value: function _onUnsubscribe(event) {\n      var dataObjectReporter = this._dataObjectReporter;\n      console.log('[ChatManager.ChatController.onUnsubscribe] event', event, dataObjectReporter.url);\n      var participant = event.identity.userProfile;\n      console.log('[ChatManager.ChatController.onUnsubscribe]  participant left', participant);\n\n      if (event.identity.legacy) {\n        participant.legacy = event.identity.legacy;\n      }\n\n      delete dataObjectReporter.data.participants[participant.userURL];\n      console.log('[ChatManager.ChatController.onUnsubscribe - this._onUserRemoved] ', this.onUserRemoved);\n      if (this._onUserRemoved) this._onUserRemoved(participant);\n    }\n    /**\r\n     * This function is used to send a file.\r\n     * @param  {string}     file                        Is the file to be sent.\r\n     * @return {Promise<Communication.ChatMessage>}        It returns the ChatMessage child object created by the Syncher as a Promise.\r\n     */\n\n  }, {\n    key: \"sendFile\",\n    value: function sendFile(file) {\n      var _this = this;\n\n      var mode = _this.controllerMode;\n      var dataObject = mode === 'reporter' ? _this.dataObjectReporter : _this.dataObjectObserver;\n      return new Promise(function (resolve, reject) {\n        var identity = {\n          userProfile: _this.myIdentity\n        };\n        dataObject.addHypertyResource('resources', 'file', file, identity).then(function (resourceFile) {\n          var identity = {\n            userProfile: _this.myIdentity\n          };\n          var fileSentEvt = {\n            value: resourceFile,\n            identity: identity,\n            resource: resourceFile\n          };\n          /*          let reporterStatus = new RegistrationStatus(dataObject.url, _this._manager._runtimeURL, _this._manager._hypertyURL, _this._manager._bus );\r\n          \r\n                    // recursive function to sync with chat reporter\r\n          \r\n                      let share2Reporter = function(file, subscriber, evt, status) {\r\n                        let statusOfReporter = status;\r\n                        file.sharingStatus.then(resolve(evt)).catch((result)=>{\r\n                          console.log('[ChatManager.ChatController.sendFile] share failed: ', result);\r\n          \r\n                          statusOfReporter.onLive( subscriber, () => {\r\n                          statusOfReporter.unsubscribeLive(subscriber);\r\n                          file.share(true);\r\n                          share2Reporter(file, subscriber, evt, statusOfReporter);\r\n                          });\r\n                            //TODO: subscribe to sync when reporter is live. New synched messages should trigger onMessage ie onChild\r\n                        });\r\n                      }*/\n          //            resourceFile.share(true).then(()=>{\n\n          resolve(fileSentEvt); //            });\n          //            share2Reporter(resourceFile, _this._manager._hypertyURL, fileSentEvt, reporterStatus);\n        });\n      }).catch(function (reason) {\n        console.error('Reason:', reason);\n        reject(reason);\n      });\n    }\n    /**\r\n     * This function is used to send a chat message.\r\n     * @param  {string}     message                        Is the ChatMessage to be sent.\r\n     * @return {Promise<Communication.ChatMessage>}        It returns the ChatMessage child object created by the Syncher as a Promise.\r\n     */\n\n  }, {\n    key: \"send\",\n    value: function send(message, identity) {\n      var _this = this;\n\n      var mode = _this.controllerMode;\n      var dataObject = mode === 'reporter' ? _this.dataObjectReporter : _this.dataObjectObserver;\n      return new Promise(function (resolve, reject) {\n        //      let _dataObjectChild;\n        _this.child_cseq += 1;\n        var msg = {\n          /*        url: dataObject.data.url,\r\n                  cseq: _this.child_cseq,\r\n                  reporter: dataObject.data.reporter,\r\n                  schema: dataObject.data.schema,\r\n                  name: dataObject.data.name,\r\n                  created : new Date().toJSON(),*/\n          type: 'chat',\n          content: message\n        };\n        var sender = identity ? identity : {\n          userProfile: _this.myIdentity\n        }; // TODO: change chatmessages to resource - chat, file\n        // TODO: change message to hypertyResource - https://github.com/reTHINK-project/dev-service-framework/tree/develop/docs/datamodel/data-objects/hyperty-resource\n        // TODO: handle with multiple resources - if the \"message\" will be different for each type of resources\n\n        dataObject.addChild(msg, sender).then(function (dataObjectChild) {\n          console.log('[ChatManager.ChatController][addChild - Chat Message]: ', dataObjectChild); //resolve(dataObjectChild);\n          //TODO: move to separate function\n\n          var msg = {\n            childId: dataObjectChild._childId,\n            from: dataObjectChild._owner,\n            value: dataObjectChild.data,\n            type: 'create',\n            identity: sender\n          };\n          /*        let reporterStatus = new RegistrationStatus(dataObject.url, _this._manager._runtimeURL, _this._manager._hypertyURL, _this._manager._bus );\r\n          \r\n                  // recursive function to sync with chat reporter\r\n          \r\n                    let share2Reporter = function(child, subscriber, msg, status) {\r\n                      let statusOfReporter = status;\r\n                      child.sharingStatus.then(resolve(msg)).catch((result)=>{\r\n          \r\n                          statusOfReporter.onLive( subscriber, () => {\r\n                            statusOfReporter.unsubscribeLive(subscriber);\r\n                            child.share(true);\r\n                            share2Reporter(child, subscriber, msg, statusOfReporter);\r\n                          });\r\n                          //TODO: subscribe to sync when reporter is live. New synched messages should trigger onMessage ie onChild\r\n                      });\r\n                    }*/\n          //          share2Reporter(dataObjectChild, _this._manager._hypertyURL, msg, reporterStatus);\n          //        dataObjectChild.share(true);\n\n          resolve(msg);\n        }).catch(function (reason) {\n          console.error('Reason:', reason);\n          reject(reason);\n        });\n      });\n    }\n    /**\r\n     * [onChange description]\r\n     * @param  {Function} callback [description]\r\n     * @return {[type]}            [description]\r\n     */\n\n  }, {\n    key: \"onChange\",\n    value: function onChange(callback) {\n      var _this = this;\n\n      _this._onChange = callback;\n    }\n    /**\r\n     * This function is used to receive new messages.\r\n     * @param  {Function} callback Function to handle with new messages\r\n     * @return {Communication.ChatMessage} m\r\n     */\n\n  }, {\n    key: \"onMessage\",\n    value: function onMessage(callback) {\n      var _this = this;\n\n      _this._onMessage = callback;\n    }\n    /**\r\n     * [onUserAdded description]\r\n     * @param  {Function} callback [description]\r\n     * @return {[type]}            [description]\r\n     */\n\n  }, {\n    key: \"onUserAdded\",\n    value: function onUserAdded(callback) {\n      var _this = this;\n\n      _this._onUserAdded = callback;\n    }\n    /**\r\n     * When the an user was removed\r\n     * @param  {Function} callback Function handle with the removed user\r\n     * @return {[type]}            [description]\r\n     */\n\n  }, {\n    key: \"onUserRemoved\",\n    value: function onUserRemoved(callback) {\n      var _this = this;\n\n      _this._onUserRemoved = callback;\n    }\n    /**\r\n     * This function is used to receive requests to close the Group Chat instance.\r\n     * @return {DeleteEvent} The DeleteEvent fired by the Syncher when the Chat is closed.\r\n     */\n\n  }, {\n    key: \"onClose\",\n    value: function onClose(callback) {\n      var _this = this;\n\n      _this._onClose = callback;\n    }\n  }, {\n    key: \"onResponse\",\n    value: function onResponse(callback) {\n      var _this = this;\n\n      _this._onResponse = callback;\n    }\n    /**\r\n     * This function is used to add / invite new user on an existing Group Chat instance.\r\n     * Only the Reporter, i.e. the Hyperty that has created the Group Chat, is allowed to use this function.\r\n     * @param {URL.UserURL}  users  User to be invited to join the Group Chat that is identified with reTHINK User URL.\r\n     * @return {Promise<boolean>}   It returns as a Promise true if successfully invited or false otherwise.\r\n     */\n\n    /*  addUser(users) {\r\n    \r\n        let _this = this;\r\n    \r\n        let haveEmptyElements = (element) => {\r\n          console.log('Element:', element.length);\r\n          return element.length !== 0;\r\n        };\r\n    \r\n        let notFoundElements = (element) => {\r\n          console.log('user not found: ', element);\r\n          return !(element instanceof String);\r\n        };\r\n    \r\n        return new Promise(function(resolve, reject) {\r\n    \r\n          if (users.filter(haveEmptyElements).length === 0) {\r\n            return reject('Don\\'t have users to invite');\r\n          }\r\n    \r\n          console.info('[ChatManager.ChatController.addUsers ]: ', users);\r\n    \r\n          /*_this.search.users(users, domains, ['comm'], ['chat'])\r\n    \r\n        .then((hypertiesIDs) => {\r\n    \r\n          if (hypertiesIDs.filter(notFoundElements).length === 0) {\r\n            throw 'User(s) not found';\r\n          }\r\n    \r\n          let selectedHyperties = hypertiesIDs.map((hyperty) => {\r\n            return hyperty.hypertyID;\r\n          });*/\n\n    /*      let usersDiscovery = [];\r\n          let disconnected = [];\r\n          let live = {};\r\n    \r\n          users.forEach((user) => {\r\n            let userDiscoveryPromise = _this.discovery.discoverHypertiesDO(user.user, ['comm'], ['chat'], user.domain);\r\n              usersDiscovery.push(userDiscoveryPromise);\r\n            });\r\n    \r\n          Promise.all(usersDiscovery).then((userDiscoveryResults) => {\r\n            console.log('[ChatManager.ChatController.addUsers] Users Discovery Results->', userDiscoveryResults);\r\n    \r\n            let selectedHyperties = [];\r\n    \r\n             userDiscoveryResults.forEach((userDiscoveryResult) => {\r\n    \r\n               userDiscoveryResult.forEach((discovered)=>{\r\n                 if (discovered.data.status === 'live'){\r\n                   selectedHyperties.push(discovered.data.hypertyID);\r\n                   live[discovered.data.hypertyID] = discovered;\r\n                 }\r\n                 else if (disconnected.length < 5) disconnected.push(discovered);\r\n               });\r\n    \r\n            });\r\n    \r\n            console.info('[ChatManager.ChatController]------------------------ Syncher Create ---------------------- \\n');\r\n            console.info('[ChatManager.ChatController]Selected Hyperties: !!! ', selectedHyperties);\r\n            console.info(`Have ${selectedHyperties.length} users;`);\r\n    //        console.info('[ChatManager] HypertiesIDs ', hypertiesIDs);\r\n    \r\n            let dataObject = _this.controllerMode === 'reporter' ? _this.dataObjectReporter : _this.dataObjectObserver;\r\n    \r\n            if (disconnected.length > 0) _this._invitationsHandler.inviteDisconnectedHyperties(disconnected, dataObject);\r\n    \r\n            dataObject.inviteObservers(selectedHyperties);\r\n    \r\n            if (dataObject.invitations.length > 0) _this._invitationsHandler.processInvitations(live, dataObject);\r\n    \r\n            return;\r\n    \r\n            })\r\n            .then(() => {\r\n              console.info('[ChatManager.ChatController]Are invited with success ' + users.length + ' users;');\r\n              resolve(true);\r\n    \r\n    \r\n    \r\n            }).catch((reason) => {\r\n              console.error('An error occurred when trying to invite users;\\n', reason);\r\n              reject(reason);\r\n            });\r\n    \r\n        });\r\n    \r\n      }*/\n\n    /**\r\n     * This function is used to request the Reporter to add / invite new user on an existing Group Chat instance.\r\n     * Only Observers are allowed to use this function.\r\n     * @param {URL.UserURL}  users  User to be invited to join the Group Chat that is identified with reTHINK User URL.\r\n     * @return {Promise<boolean>}   It returns as a Promise true if successfully invited or false otherwise.\r\n     */\n\n    /*  addUserReq(users) {\r\n    \r\n        let _this = this;\r\n    \r\n        //check is Observer and invoke observer.execute() with new promise\r\n        let haveEmptyElements = (element) => {\r\n          console.log('Element:', element.length);\r\n          return element.length !== 0;\r\n        };\r\n    \r\n        return new Promise(function(resolve, reject) {\r\n    \r\n          if (users.filter(haveEmptyElements).length === 0) {\r\n            return reject('[ChatManager.ChatController.addUserReq] Don\\'t have users to add');\r\n          }\r\n          if (!_this.controllerMode === 'observer') {\r\n            return reject('[ChatManager.ChatController.addUserReq] only allowed to Chat Observer');\r\n    \r\n          let addUser = _this.addUser(users);\r\n    \r\n          if (_this._dataObjectObserver) {\r\n            addUser = _this._dataObjectObserver.execute('addUser', users);\r\n          }\r\n    \r\n          addUser.then(() => {\r\n            console.info('[ChatManager.ChatController.addUserReq] Request accepted by Reporter ');\r\n            resolve(true);\r\n          }).catch((reason) => {\r\n            console.error('[ChatManager.ChatController.addUserReq] Request rejected by Reporter;\\n', reason);\r\n            reject(reason);\r\n          });\r\n        }\r\n    \r\n      });\r\n    \r\n    }*/\n\n  }, {\n    key: \"onInvitationResponse\",\n    value: function onInvitationResponse(callback) {\n      var _this = this;\n\n      _this._onInvitationResponse = callback; //    _this._invitationsHandler.invitationResponse = callback;\n    }\n    /**\r\n     * This function is used to remove a user from an existing Group Chat instance.\r\n     * Only the Reporter, i.e. the Hyperty that has created the Group Chat, is allowed to use this function.\r\n     * @return {<Promise> boolean} Promise with the status\r\n     */\n\n    /**\r\n     * This function is used to remove a user from an existing Group Chat instance.\r\n     * Only the Reporter, i.e. the Hyperty that has created the Group Chat, is allowed to use this function.\r\n     * @param  {URL.UserURL} user       User to be removed from the Group Chat that is identified with reTHINK User URL.\r\n     * @return {<Promise> boolean}      It returns as a Promise true if successfully removed or false otherwise.\r\n     */\n\n  }, {\n    key: \"removeUser\",\n    value: function removeUser(user) {\n      // TODO: implement the removeUser;\n      console.log('[ChatManager.ChatController]Not yet implemented: ', user);\n    }\n    /**\r\n     * This function is used to close an existing Group Chat instance.\r\n     * Only available to Chat Group Reporters i.e. the Hyperty instance that created the Group Chat.\r\n     * @return {<Promise>Boolean} It returns as a Promise true if successfully closed or false otherwise.\r\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      var del = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n      // TODO: the dataObjectReporter.delete should be a Promise;\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this.controllerMode === 'reporter') {\n          // reporter\n          //        _this._invitationsHandler.cleanInvitations(_this.dataObjectReporter).then(() => {\n          if (!del) {\n            _this._manager.communicationObject.status = 'closed';\n            resolve(true);\n          } else {\n            try {\n              delete _this._manager._reportersControllers[_this.dataObjectReporter.url];\n\n              _this.dataObjectReporter.delete();\n\n              resolve(true);\n              if (_this._onClose) _this._onClose({\n                code: 200,\n                desc: 'deleted',\n                url: _this.dataObjectReporter.url\n              });\n            } catch (e) {\n              console.error(e);\n              reject(false);\n            }\n          } //          });\n\n        } else {\n          // observer\n          if (del) {\n            try {\n              delete _this._manager._observersControllers[_this.dataObjectObserver.url];\n\n              _this.dataObjectObserver.unsubscribe();\n\n              resolve(true);\n            } catch (e) {\n              console.error(e);\n              reject(false);\n            }\n          } else {\n            // TODO: send message \n            resolve(true);\n          }\n        }\n      });\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this.controllerMode === 'reporter' ? this.dataObjectReporter.url : this.dataObjectObserver.url;\n    }\n  }, {\n    key: \"dataObjectReporter\",\n    set: function set(dataObjectReporter) {\n      if (!dataObjectReporter) throw new Error('[ChatController] The data object reporter is necessary parameter ');\n\n      var _this = this;\n\n      _this.controllerMode = 'reporter'; // Handler to process received files\n      // dataObjectReporter.onResponse(function(event) {\n      //   console.log('[DataObjectReporter - onResponse]', event);\n      //   if (_this._onInvitationResponse) {\n      //     _this._onInvitationResponse(event);\n      //   }\n      //\n      // });\n\n      dataObjectReporter.onSubscription(function (event) {\n        switch (event.type) {\n          case 'subscribe':\n            _this._onSubscribe(event);\n\n            break;\n\n          case 'unsubscribe':\n            _this._onUnsubscribe(event);\n\n            break;\n        }\n      });\n\n      _this._setOnAddChildListener(dataObjectReporter);\n\n      dataObjectReporter.onRead(function (event) {\n        event.accept();\n      });\n      dataObjectReporter.onExecute(function (event) {\n        switch (event.method) {\n          case 'addUser':\n            _this.addUser(event.params[0]).then(function () {\n              event.accept();\n            }).catch(function (reason) {\n              console.error('Reason:', reason);\n              event.reject(reason);\n            });\n\n            break;\n\n          case 'removeUser':\n            _this.removeUser(event.params).then(function () {\n              event.accept();\n            }).catch(function (reason) {\n              console.error('Reason:', reason);\n              event.reject(reason);\n            });\n\n            break;\n\n          default:\n            event.reject('[ChatController.onExecute] Chat method execution not accepted by Reporter');\n            break;\n        }\n      });\n      _this._dataObjectReporter = dataObjectReporter;\n    },\n    get: function get() {\n      var _this = this;\n\n      return _this._dataObjectReporter;\n    }\n  }, {\n    key: \"messages\",\n    get: function get() {\n      return this.controllerMode === 'reporter' ? this._dataObjectReporter._childrenObjects : this._dataObjectObserver._childrenObjects;\n    }\n  }, {\n    key: \"dataObjectObserver\",\n    set: function set(dataObjectObserver) {\n      var _this = this;\n\n      _this.controllerMode = 'observer';\n      _this._dataObjectObserver = dataObjectObserver;\n      dataObjectObserver.onChange('*', function (event) {\n        console.info('[ChatManager.ChatController]Observer - onChange', event);\n\n        if (event.field.includes('participants')) {\n          switch (event.cType) {\n            case 'add':\n              if (_this._onUserAdded) _this._onUserAdded(event);\n              break;\n\n            case 'remove':\n              if (_this._onUserRemoved) _this._onUserRemoved(event);\n              break;\n          }\n        }\n\n        if (_this._onChange) _this._onChange(event);\n      });\n\n      _this._setOnAddChildListener(dataObjectObserver); // let childrens = dataObjectObserver.childrens;\n      // Object.keys(childrens).forEach((child) => {\n      //   if (_this._onMessage) _this._onMessage({\n      //     childId: child,\n      //     identity: childrens[child].identity,\n      //     value: childrens[child].data\n      //   });\n      // })\n\n    },\n    get: function get() {\n      var _this = this;\n\n      return _this._dataObjectObserver;\n    }\n  }, {\n    key: \"dataObject\",\n    get: function get() {\n      return this.controllerMode === 'reporter' ? this.dataObjectReporter : this.dataObjectObserver;\n    }\n  }, {\n    key: \"closeEvent\",\n    set: function set(event) {\n      var _this = this;\n\n      _this._closeEvent = event;\n      if (_this._onClose) _this._onClose(event);\n    },\n    get: function get() {\n      var _this = this;\n\n      return _this._closeEvent;\n    }\n  }]);\n\n  return Chat;\n}();\n\n/* harmony default export */ var chatManager_Chat = (Chat);\n// CONCATENATED MODULE: ./src/chatManager/SimpleChatManager.js\nfunction SimpleChatManager_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction SimpleChatManager_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction SimpleChatManager_createClass(Constructor, protoProps, staticProps) { if (protoProps) SimpleChatManager_defineProperties(Constructor.prototype, protoProps); if (staticProps) SimpleChatManager_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Service Framework\n//import IdentityManager from '../identityManager/IdentityManager';\n//import RegistrationStatus from '../discovery/RegistrationStatus';\n//import Discovery from '../discovery/Discovery';\n//import Syncher from '../syncher/Syncher';\n// Utils\n//import {divideURL} from '../utils/utils';\n//import Search from '../utils/Search';\n// Internals\n\n\n\n/**\r\n* Hyperty Simple Group Chat Manager API \r\n* @author Vitor Silva [vitor-t-silva@telecom.pt]\r\n* @version 0.1.0\r\n*/\n\nvar SimpleChatManager_SimpleSimpleChatManager =\n/*#__PURE__*/\nfunction () {\n  function SimpleSimpleChatManager(myUrl, bus, configuration, syncher, factory) {\n    SimpleChatManager_classCallCheck(this, SimpleSimpleChatManager);\n\n    if (!myUrl) throw new Error('[SimpleChatManager.constructor] The myUrl is a needed parameter');\n    if (!bus) throw new Error('[SimpleChatManager.constructor] The MiniBus is a needed parameter');\n    if (!configuration) throw new Error('[SimpleChatManager.constructor] The configuration is a needed parameter');\n\n    var _this = this;\n\n    if (!syncher) {\n      syncher = factory.createSyncher(myUrl, bus, configuration);\n    }\n\n    _this._runtimeURL = configuration.runtimeURL;\n    var domain = factory.divideURL(_this._runtimeURL).domain; //    let discovery = factory.createDiscovery(myUrl, configuration.runtimeURL, bus);\n\n    var identityManager = factory.createIdentityManager(myUrl, configuration.runtimeURL, bus);\n    _this._objectDescURL = 'hyperty-catalogue://catalogue.' + domain + '/.well-known/dataschema/Communication';\n    _this._reportersControllers = {};\n    _this._observersControllers = {};\n    _this._myUrl = myUrl;\n    _this._bus = bus;\n    _this._syncher = syncher;\n    _this._domain = domain; //    _this.discovery = discovery;\n\n    _this.identityManager = identityManager;\n    _this.currentIdentity; //    _this.search = factory.createSearch(discovery, identityManager);\n\n    _this.communicationObject = communicationObject;\n    _this.communicationChildren = communicationChildren; //    console.log('[SimpleChatManager] Discover ', discovery);\n\n    console.log('[SimpleChatManager] Identity Manager ', identityManager);\n  }\n\n  SimpleChatManager_createClass(SimpleSimpleChatManager, [{\n    key: \"processNotification\",\n    value: function processNotification(event) {\n      var _this = this;\n\n      console.log('[SimpleChatManager.processNotification: ', event);\n\n      if (event.type === 'create') {\n        // TODO: replace the 100 for Message.Response\n        // event.ack(200);\n        if (_this._onInvitation) {\n          _this._onInvitation(event);\n        }\n      }\n\n      if (event.type === 'delete') {\n        // TODO: replace the 200 for Message.Response\n        event.ack(200);\n        _this._observersControllers[event.url].closeEvent = event;\n        delete _this._observersControllers[event.url];\n        _this._observersControllers.closeEvent = event;\n        _this.communicationObject = communicationObject;\n\n        for (var url in this._reportersControllers) {\n          this._reportersControllers[url].close(event);\n        }\n\n        for (var _url in this._observersControllers) {\n          this._observersControllers[_url].close(event);\n        }\n      }\n    }\n  }, {\n    key: \"myIdentity\",\n    value: function myIdentity(identity) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        console.info('[SimpleChatManager.myIdentity]');\n        if (identity) return resolve(identity);\n\n        if (_this._myUrl.includes('hyperty://')) {\n          _this.identityManager.discoverUserRegistered().then(function (identity) {\n            _this.currentIdentity = identity;\n            resolve(identity);\n          }).catch(function (reason) {\n            reject(reason);\n          });\n        } else {\n          _this.identityManager.discoverIdentityPerIdP().then(function (identity) {\n            _this.currentIdentity = identity;\n            resolve(identity);\n          }).catch(function (reason) {\n            reject(reason);\n          });\n        }\n      });\n    }\n    /**\r\n     * This function is used to create a new Group Chat providing the name and the identifiers of users to be invited.\r\n     * @param  {string}                     name  Is a string to identify the Group Chat\r\n     * @param  {array<URL.HypertyURL>}         hyperties Array of hyperties to be invited to join the Group Chat. Users are identified with reTHINK User URL, like this format user://<ipddomain>/<user-identifier>\r\n     * @return {<Promise>ChatController}    A ChatController object as a Promise.\r\n     */\n\n  }, {\n    key: \"create\",\n    value: function create(name, hyperties) {\n      var extra = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      var _this = this;\n\n      var syncher = _this._syncher;\n      return new Promise(function (resolve, reject) {\n        _this.communicationObject = communicationObject;\n        _this.communicationObject.cseq = 1;\n        _this.communicationObject.startingTime = new Date().toJSON();\n        _this.communicationObject.status = CommunicationStatus.OPEN;\n        var myIdentity;\n\n        _this.myIdentity().then(function (identity) {\n          myIdentity = identity;\n          console.log('[SimpleChatManager.create ] My Identity', identity); // let url = _this.communicationObject.reporter;\n\n          var userInfo = new UserInfo_UserInfo(_this._myUrl, _this._domain, identity); // Add my identity\n\n          _this.communicationObject.participants[identity.guid] = userInfo;\n          console.log('[SimpleChatManager.create ] participants: ', _this.communicationObject.participants);\n          console.log('[SimpleChatManager.create ] communicationObject', _this.communicationObject);\n          console.info('[SimpleChatManager] ---------------------- Syncher Create ---------------------- \\n');\n          console.info('[SimpleChatManager] Selected Hyperties: !!! ', hyperties); //          console.info(`Have ${hyperties.length} users;`);\n\n          var mutual = extra.mutual ? extra.mutual : true;\n          var input = Object.assign({\n            resources: ['chat'],\n            mutual: mutual\n          }, extra);\n          delete input.name;\n          if (_this.offline) input.offline = _this.offline;\n          if (_this.backup) input.backup = _this.backup;\n          console.log('[SimpleChatManager] input data:', input);\n          return syncher.create(_this._objectDescURL, hyperties, _this.communicationObject, true, false, name, {}, input);\n        }).then(function (dataObjectReporter) {\n          console.info('[SimpleChatManager] 3. Return Create Data Object Reporter', dataObjectReporter);\n          var chat = new chatManager_Chat(syncher, _this._domain, myIdentity, _this);\n          chat.dataObjectReporter = dataObjectReporter;\n          _this._reportersControllers[dataObjectReporter.url] = chat; //          console.log('[SimpleChatManager] chat invitationsHandler: ',   chat.invitationsHandler);\n          // process invitations to handle not received invitations\n\n          /*          if (dataObjectReporter.invitations.length > 0) {\r\n                      chat.invitationsHandler.processInvitations(live, dataObjectReporter);\r\n                    }\r\n          \r\n                    // If any invited User is disconnected let's wait until it is connected again\r\n                    if (disconnected.length > 0) chat.invitationsHandler.inviteDisconnectedHyperties(disconnected, dataObjectReporter);\r\n          */\n\n          resolve(chat);\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      }).catch(function (reason) {\n        console.log('[SimpleChatManager.create] MyIdentity Error:', reason);\n        return reject(reason);\n      }); //    });\n    }\n    /**\r\n     * This function is used to handle notifications about incoming invitations to join a Group Chat.\r\n     * @param  {Function} CreateEvent The CreateEvent fired by the Syncher when an invitaion is received\r\n     */\n\n  }, {\n    key: \"onInvitation\",\n    value: function onInvitation(callback) {\n      var _this = this;\n\n      _this._onInvitation = callback;\n    }\n    /**\r\n     * This function is used to join a Group Chat.\r\n     * @param  {URL.CommunicationURL} invitationURL  The Communication URL of the Group Chat to join that is provided in the invitation event\r\n     * @return {<Promise>ChatController}             It returns the ChatController object as a Promise\r\n     */\n\n  }, {\n    key: \"join\",\n    value: function join(invitationURL) {\n      var mutual = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var identity = arguments.length > 2 ? arguments[2] : undefined;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var syncher = _this._syncher;\n        var myIdentity;\n        console.info('[SimpleChatManager] ------------------------ Syncher subscribe ---------------------- \\n');\n        console.info('invitationURL', invitationURL);\n\n        _this.myIdentity(identity).then(function (identity) {\n          myIdentity = identity;\n          var input = {\n            schema: _this._objectDescURL,\n            resource: invitationURL,\n            store: true,\n            p2p: false,\n            mutual: mutual,\n            domain_subscription: true,\n            identity: identity\n          };\n          if (_this.offline) input.offline = _this.offline;\n          return syncher.subscribe(input);\n        }).then(function (dataObjectObserver) {\n          console.info('Data Object Observer: ', dataObjectObserver);\n          var chat = new chatManager_Chat(syncher, _this._domain, myIdentity, _this);\n          resolve(chat);\n          chat.dataObjectObserver = dataObjectObserver;\n          _this._observersControllers[dataObjectObserver.url] = chat;\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n  }, {\n    key: \"offline\",\n    set: function set(offline) {\n      this._offline = offline;\n    },\n    get: function get() {\n      return this._offline ? this._offline : false;\n    }\n  }, {\n    key: \"backup\",\n    set: function set(backup) {\n      this._backup = backup;\n    },\n    get: function get() {\n      return this._backup ? this._backup : false;\n    }\n  }]);\n\n  return SimpleSimpleChatManager;\n}();\n\n/* harmony default export */ var SimpleChatManager = (SimpleChatManager_SimpleSimpleChatManager);\n// CONCATENATED MODULE: ./src/sandbox/SandboxFactory.js\nfunction SandboxFactory_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction SandboxFactory_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction SandboxFactory_createClass(Constructor, protoProps, staticProps) { if (protoProps) SandboxFactory_defineProperties(Constructor.prototype, protoProps); if (staticProps) SandboxFactory_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\r\n * Internal component to instantiate framework functionalities.\r\n */\n\nvar SandboxFactory_SandboxFactory =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _components: <url: instance>\r\n  */\n  function SandboxFactory(bus) {\n    SandboxFactory_classCallCheck(this, SandboxFactory);\n\n    var _this = this;\n\n    _this._bus = bus;\n    _this._divideURL = divideURL;\n  }\n\n  SandboxFactory_createClass(SandboxFactory, [{\n    key: \"createSyncher\",\n    value: function createSyncher(owner, bus, config) {\n      return new syncher_Syncher(owner, bus, config);\n    }\n  }, {\n    key: \"createIdentityManager\",\n    value: function createIdentityManager(hypertyURL, runtimeURL, bus) {\n      var _this = this;\n\n      return new identity_IdentityManager(hypertyURL, runtimeURL, bus);\n    }\n  }, {\n    key: \"createDiscovery\",\n    value: function createDiscovery(hypertyURL, runtimeURL, bus) {\n      var _this = this;\n\n      return new discovery_Discovery(hypertyURL, runtimeURL, bus);\n    }\n  }, {\n    key: \"createSearch\",\n    value: function createSearch(discovery, identityManager) {\n      var _this = this;\n\n      return new utils_Search(discovery, identityManager);\n    }\n  }, {\n    key: \"createContextObserver\",\n    value: function createContextObserver(hypertyURL, bus, config, schemes) {\n      return new contextManager_ContextObserver(hypertyURL, bus, config, schemes, this);\n    }\n  }, {\n    key: \"createContextReporter\",\n    value: function createContextReporter(hypertyURL, bus, config) {\n      var _this = this;\n\n      return new contextManager_ContextReporter(hypertyURL, bus, config, this);\n    }\n  }, {\n    key: \"createNotificationHandler\",\n    value: function createNotificationHandler(bus) {\n      var _this = this;\n\n      return new syncher_NotificationHandler(bus);\n    }\n  }, {\n    key: \"createMessageBodyIdentity\",\n    value: function createMessageBodyIdentity(username, userURL, picture, name, locale, idp, assertion, profile) {\n      return new identity_MessageBodyIdentity(username, userURL, picture, name, locale, idp, assertion, profile);\n    }\n  }, {\n    key: \"createChatManager\",\n    value: function createChatManager(hypertyURL, bus, configuration, syncher) {\n      return new chatManager_ChatManager(hypertyURL, bus, configuration, syncher, this);\n    }\n  }, {\n    key: \"createChatController\",\n    value: function createChatController(syncher, discovery, domain, search, identity, manager) {\n      return new chatManager_ChatController(syncher, discovery, domain, search, identity, manager);\n    }\n  }, {\n    key: \"createSimpleChatManager\",\n    value: function createSimpleChatManager(hypertyURL, bus, configuration, syncher) {\n      return new SimpleChatManager(hypertyURL, bus, configuration, syncher, this);\n    }\n  }, {\n    key: \"createChat\",\n    value: function createChat(syncher, domain, identity, manager) {\n      return new chatManager_Chat(syncher, domain, identity, manager);\n    }\n  }, {\n    key: \"createRegistrationStatus\",\n    value: function createRegistrationStatus(observer, runtimeURL, chatUrl, bus) {\n      return new discovery_RegistrationStatus(observer, runtimeURL, chatUrl, bus);\n    }\n  }, {\n    key: \"divideURL\",\n    get: function get() {\n      return this._divideURL;\n    }\n  }]);\n\n  return SandboxFactory;\n}();\n\n/* harmony default export */ var sandbox_SandboxFactory = (SandboxFactory_SandboxFactory);\n// CONCATENATED MODULE: ./src/sandbox/SandboxRegistry.js\nfunction SandboxRegistry_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction SandboxRegistry_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction SandboxRegistry_createClass(Constructor, protoProps, staticProps) { if (protoProps) SandboxRegistry_defineProperties(Constructor.prototype, protoProps); if (staticProps) SandboxRegistry_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n * @author micaelpedrosa@gmail.com\r\n * Base class to implement internal deploy manager of components.\r\n */\n\n/**\r\n * @author micaelpedrosa@gmail.com\r\n * Internal component registry of all sandboxes.\r\n * Process internal request's for component deploy.\r\n */\n\nvar SandboxRegistry_SandboxRegistry =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _components: <url: instance>\r\n  */\n  function SandboxRegistry(bus) {\n    SandboxRegistry_classCallCheck(this, SandboxRegistry);\n\n    var _this = this;\n\n    _this._bus = bus;\n    _this._factory = new sandbox_SandboxFactory(bus);\n    _this._components = {};\n    bus.addListener(SandboxRegistry.InternalDeployAddress, function (msg) {\n      console.log('SandboxRegistry-RCV: ', msg); // let responseMsg = {\n      //   id: msg.id, type: 'response', from: SandboxRegistry.InternalDeployAddress, to: SandboxRegistry.ExternalDeployAddress\n      // };\n\n      switch (msg.type) {\n        case 'create':\n          _this._onDeploy(msg);\n\n          break;\n\n        case 'delete':\n          _this._onRemove(msg);\n\n          break;\n      }\n    });\n  }\n\n  SandboxRegistry_createClass(SandboxRegistry, [{\n    key: \"_responseMsg\",\n    value: function _responseMsg(msg, code, value) {\n      var _this = this; // let messageFactory = _this.messageFactory;\n      //FLOW-OUT: generic response message to external Sandbox (deploy and un-deploy responses)\n\n\n      var responseMsg = {\n        id: msg.id,\n        type: 'response',\n        from: SandboxRegistry.InternalDeployAddress,\n        to: SandboxRegistry.ExternalDeployAddress\n      }; // Chanege the origin message, because the response;\n      // msg.from = SandboxRegistry.InternalDeployAddress;\n      // msg.to = SandboxRegistry.ExternalDeployAddress;\n\n      var body = {};\n      if (code) body.code = code;\n      if (value) body.desc = value;\n      responseMsg.body = body; // return messageFactory.createResponse(msg, code, value);\n\n      return responseMsg;\n    } //FLOW-IN: message from the runtime core Sandbox -> deployComponent\n\n  }, {\n    key: \"_onDeploy\",\n    value: function _onDeploy(msg) {\n      var _this = this;\n\n      var config = msg.body.config;\n      var componentURL = msg.body.url;\n      var sourceCode = msg.body.sourceCode;\n      var responseCode;\n      var responseDesc;\n\n      if (!_this._components.hasOwnProperty(componentURL)) {\n        try {\n          console.log('SandboxRegistry-onDeploy: ', msg);\n          _this._components[componentURL] = _this._create(componentURL, sourceCode, config, _this._factory);\n          responseCode = 200;\n        } catch (error) {\n          responseCode = 500;\n          responseDesc = error;\n        }\n      } else {\n        responseCode = 500;\n        responseDesc = 'Instance ' + componentURL + ' already exist!';\n      }\n\n      var responseMsg = _this._responseMsg(msg, responseCode, responseDesc);\n\n      _this._bus.postMessage(responseMsg);\n    } //FLOW-IN: message from the runtime core Sandbox -> removeComponent\n\n  }, {\n    key: \"_onRemove\",\n    value: function _onRemove(msg) {\n      var _this = this;\n\n      var componentURL = msg.body.url;\n      var responseCode;\n      var responseDesc;\n\n      if (_this._components.hasOwnProperty(componentURL)) {\n        //remove component from the pool and all listeners\n        delete _this._components[componentURL];\n\n        _this._bus.removeAllListenersOf(componentURL);\n\n        responseCode = 200;\n      } else {\n        responseCode = 500;\n        responseDesc = 'Instance ' + componentURL + ' doesn\\'t exist!';\n      }\n\n      var responseMsg = _this._responseMsg(msg, responseCode, responseDesc);\n\n      _this._bus.postMessage(responseMsg);\n    }\n    /**\r\n     * This method should be implemented by the internal sandbox code.\r\n     * @param  {ComponentURL} url URL used for the instance\r\n     * @param  {string} sourceCode Code of the component\r\n     * @param  {Config} config Configuration parameters\r\n     * @return {Object} Returns instance of the component or throw an error \"throw 'error message'\"\r\n     */\n\n  }, {\n    key: \"_create\",\n    value: function _create(url, sourceCode, config, factory) {//implementation specific\n\n      /* example code:\r\n        eval(sourceCode);\r\n        return activate(url, _this._bus, config);\r\n      */\n    }\n  }, {\n    key: \"components\",\n    get: function get() {\n      return this._components;\n    }\n  }]);\n\n  return SandboxRegistry;\n}();\n\nSandboxRegistry_SandboxRegistry.ExternalDeployAddress = 'hyperty-runtime://sandbox/external';\nSandboxRegistry_SandboxRegistry.InternalDeployAddress = 'hyperty-runtime://sandbox/internal';\n/* harmony default export */ var sandbox_SandboxRegistry = (SandboxRegistry_SandboxRegistry);\n// CONCATENATED MODULE: ./src/bus/Bus.js\nfunction Bus_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Bus_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Bus_createClass(Constructor, protoProps, staticProps) { if (protoProps) Bus_defineProperties(Constructor.prototype, protoProps); if (staticProps) Bus_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log system\n\nvar Bus_log = loglevel[\"getLogger\"]('Bus');\n/**\r\n* @author micaelpedrosa@gmail.com\r\n* Minimal interface and implementation to send and receive messages. It can be reused in many type of components.\r\n* Components that need a message system should receive this class as a dependency or extend it.\r\n* Extensions should implement the following private methods: _onPostMessage and _registerExternalListener\r\n*/\n\nvar Bus =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _msgId: number;\r\n  _subscriptions: <url: MsgListener[]>\r\n    _responseTimeOut: number\r\n  _responseCallbacks: <url+id: (msg) => void>\r\n    */\n  function Bus() {\n    Bus_classCallCheck(this, Bus);\n\n    var _this = this;\n\n    _this._msgId = 0;\n    _this._subscriptions = {};\n    _this._responseTimeOut = 15000; //default to 3s\n\n    _this._responseCallbacks = {};\n\n    _this._registerExternalListener();\n  }\n  /**\r\n  * Register listener to receive message when \"msg.to === url\".\r\n  * Special url \"*\" for default listener is accepted to intercept all messages.\r\n  * @param {URL} url Address to intercept, tha is in the message \"to\"\r\n  * @param {Listener} listener listener\r\n  * @return {MsgListener} instance of MsgListener\r\n  */\n\n\n  Bus_createClass(Bus, [{\n    key: \"addListener\",\n    value: function addListener(url, listener) {\n      var _this = this;\n\n      var item = new MsgListener(_this._subscriptions, url, listener);\n      var itemList = _this._subscriptions[url];\n\n      if (!itemList) {\n        itemList = [];\n        _this._subscriptions[url] = itemList;\n      }\n\n      itemList.push(item);\n      return item;\n    }\n    /**\r\n     * Manually add a response listener. Only one listener per message ID should exist.\r\n     * ATENTION, there is no timeout for this listener.\r\n     * The listener should be removed with a removeResponseListener, failing to do this will result in a unreleased memory problem.\r\n     * @param {URL} url Origin address of the message sent, \"msg.from\".\r\n     * @param {number} msgId Message ID that is returned from the postMessage.\r\n     * @param {Function} responseListener Callback function for the response\r\n     */\n\n  }, {\n    key: \"addResponseListener\",\n    value: function addResponseListener(url, msgId, responseListener) {\n      this._responseCallbacks[url + msgId] = responseListener;\n    }\n    /**\r\n     * Remove the response listener.\r\n     * @param {URL} url Origin address of the message sent, \"msg.from\".\r\n     * @param {number} msgId  Message ID that is returned from the postMessage\r\n     */\n\n  }, {\n    key: \"removeResponseListener\",\n    value: function removeResponseListener(url, msgId) {\n      delete this._responseCallbacks[url + msgId];\n    }\n    /**\r\n     * Remove all existent listeners for the URL\r\n     * @param  {URL} url Address registered\r\n     */\n\n  }, {\n    key: \"removeAllListenersOf\",\n    value: function removeAllListenersOf(url) {\n      delete this._subscriptions[url];\n    }\n    /**\r\n     * Helper method to bind listeners (in both directions) into other MiniBus target.\r\n     * @param  {URL} outUrl Outbound URL, register listener for url in direction \"this -> target\"\r\n     * @param  {URL} inUrl Inbound URL, register listener for url in direction \"target -> this\"\r\n     * @param  {MiniBus} target The other target MiniBus\r\n     * @return {Bound} an object that contains the properties [thisListener, targetListener] and the unbind method.\r\n     */\n\n  }, {\n    key: \"bind\",\n    value: function bind(outUrl, inUrl, target) {\n      var _this2 = this;\n\n      var _this = this;\n\n      var thisListn = _this.addListener(outUrl, function (msg) {\n        target.postMessage(msg);\n      });\n\n      var targetListn = target.addListener(inUrl, function (msg) {\n        _this.postMessage(msg);\n      });\n      return {\n        thisListener: thisListn,\n        targetListener: targetListn,\n        unbind: function unbind() {\n          _this2.thisListener.remove();\n\n          _this2.targetListener.remove();\n        }\n      };\n    } //publish on default listeners\n\n  }, {\n    key: \"_publishOnDefault\",\n    value: function _publishOnDefault(msg) {\n      //is there any \"*\" (default) listeners?\n      var itemList = this._subscriptions['*'];\n\n      if (itemList) {\n        this._publishOn(itemList, msg);\n      }\n    } //publish on a subscription list.\n\n  }, {\n    key: \"_publishOn\",\n    value: function _publishOn(itemList, msg) {\n      itemList.forEach(function (sub) {\n        sub._callback(msg);\n      });\n    }\n  }, {\n    key: \"_responseCallback\",\n    value: function _responseCallback(inMsg, responseCallback) {\n      var timeout = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n      var _this = this; //automatic management of response handlers\n\n\n      if (responseCallback) {\n        var responseId = inMsg.from + inMsg.id;\n        _this._responseCallbacks[responseId] = responseCallback;\n\n        if (timeout) {\n          setTimeout(function () {\n            var responseFun = _this._responseCallbacks[responseId];\n            delete _this._responseCallbacks[responseId];\n\n            if (responseFun) {\n              var errorMsg = {\n                id: inMsg.id,\n                type: 'response',\n                body: {\n                  code: 408,\n                  desc: 'Response timeout!',\n                  value: inMsg\n                }\n              };\n              responseFun(errorMsg);\n            }\n          }, _this._responseTimeOut);\n        }\n      }\n    } //TODO: provisional responses should reset timeout\n\n  }, {\n    key: \"_onResponse\",\n    value: function _onResponse(msg) {\n      var _this = this;\n\n      if (msg.type === 'response') {\n        var responseId = msg.to + msg.id;\n        var responseFun = _this._responseCallbacks[responseId];\n\n        if (msg.body.code >= 200) {\n          //if it's a provisional response, don't delete response listener\n          delete _this._responseCallbacks[responseId];\n        }\n\n        if (responseFun) {\n          responseFun(msg);\n          return true;\n        }\n      }\n\n      return false;\n    } //receive messages from external interface\n\n  }, {\n    key: \"_onMessage\",\n    value: function _onMessage(msg) {\n      var _this = this;\n\n      if (!_this._onResponse(msg)) {\n        var itemList = _this._subscriptions[msg.to];\n\n        if (itemList) {\n          _this._publishOn(itemList, msg);\n        } else {\n          _this._publishOnDefault(msg);\n        }\n      }\n    }\n  }, {\n    key: \"_genId\",\n    value: function _genId(inMsg) {\n      //TODO: how do we manage message ID's? Should it be a global runtime counter, or per URL address?\n      //Global counter will not work, because there will be multiple MiniBus instances!\n      //Per URL, can be a lot of data to maintain!\n      //Maybe a counter per MiniBus instance. This is the assumed solution for now.\n      if (!inMsg.id || inMsg.id === 0) {\n        this._msgId++;\n        inMsg.id = this._msgId;\n      }\n    }\n    /**\r\n    * Send messages to local listeners, or if not exists to external listeners.\r\n    * It's has an optional mechanism for automatic management of response handlers.\r\n    * The response handler will be unregistered after receiving the response, or after response timeout (default to 3s).\r\n    * @param  {Message} msg Message to send. Message ID is automatically added to the message.\r\n    * @param  {Function} responseCallback Optional parameter, if the developer what's automatic response management.\r\n    * @return {number} Returns the message ID, in case it should be needed for manual management of the response handler.\r\n    */\n\n  }, {\n    key: \"postMessage\",\n    value: function postMessage(inMsg, responseCallback) {}\n    /**\r\n     * Function to post messages with a number of retries in case timeouts occur.\r\n     * @param  {Message} msg Message to send. Message ID is automatically added to the message.\r\n     * @param  {Function} responseCallback Optional parameter, if the developer what's automatic response management.\r\n     * @param  {integer} retries number of retries when timeouts occur\r\n     * @return {boolean} message delivery result;\r\n     */\n\n  }, {\n    key: \"postMessageWithRetries\",\n    value: function postMessageWithRetries(msg, retries, callback) {\n      var _this = this;\n\n      var retry = 0; //let timeout = true;\n\n      var sendMsg = function sendMsg() {\n        return new Promise(function (resolve, reject) {\n          _this.postMessage(msg, function (reply) {\n            if (reply.body.code === 408 || reply.body.code === 500) reject();else {\n              Bus_log.info('[Bus.postMessageWithRetries] msg delivered: ', msg);\n              callback(reply);\n              resolve();\n            }\n          });\n        });\n      };\n\n      var tryAgain = function tryAgain() {\n        sendMsg().then(function () {\n          //timeout = false;\n          return;\n        }, function () {\n          Bus_log.warn(\"[Bus.postMessageWithRetries] Message Bounced (retry \".concat(retry, \"): '\"), msg);\n\n          if (retry++ < retries) {\n            tryAgain(); // setTimeout(() => { tryAgain(); }, 1000);\n          } else {\n            var error = \"[Error] Message Bounced (delivery attempts \".concat(retries, \"): '\");\n            throw new Error(error + msg);\n          }\n        });\n      };\n\n      tryAgain();\n    }\n    /**\r\n     * Not public available, used by the class extension implementation, to process messages from the public \"postMessage\" without a registered listener.\r\n     * Used to send the message to an external interface, like a WebWorker, IFrame, etc.\r\n     * @param  {Message.Message} msg Message\r\n     */\n\n  }, {\n    key: \"_onPostMessage\",\n    value: function _onPostMessage(msg) {}\n    /*implementation will send message to external system*/\n\n    /**\r\n     * Not public available, used by the class extension implementation, to process all messages that enter the MiniBus from an external interface, like a WebWorker, IFrame, etc.\r\n     * This method is called one time in the constructor to register external listeners.\r\n     * The implementation will probably call the \"_onMessage\" method to publish in the local listeners.\r\n     * DO NOT call \"postMessage\", there is a danger that the message enters in a cycle!\r\n     */\n\n  }, {\n    key: \"_registerExternalListener\",\n    value: function _registerExternalListener() {\n      /*implementation will register external listener and call \"this._onMessage(msg)\" */\n    }\n  }]);\n\n  return Bus;\n}();\n\nvar MsgListener =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _subscriptions: <string: MsgListener[]>;\r\n  _url: string;\r\n  _callback: (msg) => void;\r\n  */\n  function MsgListener(subscriptions, url, callback) {\n    Bus_classCallCheck(this, MsgListener);\n\n    var _this = this;\n\n    _this._subscriptions = subscriptions;\n    _this._url = url;\n    _this._callback = callback;\n  }\n\n  Bus_createClass(MsgListener, [{\n    key: \"remove\",\n\n    /**\r\n     * Remove this listener from the Bus\r\n     */\n    value: function remove() {\n      var _this = this;\n\n      var subs = _this._subscriptions[_this._url];\n\n      if (subs) {\n        var index = subs.indexOf(_this);\n        subs.splice(index, 1); //if there are no listeners, remove the subscription entirely.\n\n        if (subs.length === 0) {\n          delete _this._subscriptions[_this._url];\n        }\n      }\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this._url;\n    }\n  }]);\n\n  return MsgListener;\n}();\n\n/* harmony default export */ var bus_Bus = (Bus);\n// CONCATENATED MODULE: ./src/bus/MiniBus.js\nfunction MiniBus_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { MiniBus_typeof = function _typeof(obj) { return typeof obj; }; } else { MiniBus_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return MiniBus_typeof(obj); }\n\nfunction MiniBus_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction MiniBus_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction MiniBus_createClass(Constructor, protoProps, staticProps) { if (protoProps) MiniBus_defineProperties(Constructor.prototype, protoProps); if (staticProps) MiniBus_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction MiniBus_possibleConstructorReturn(self, call) { if (call && (MiniBus_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return MiniBus_assertThisInitialized(self); }\n\nfunction MiniBus_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction MiniBus_getPrototypeOf(o) { MiniBus_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return MiniBus_getPrototypeOf(o); }\n\nfunction MiniBus_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) MiniBus_setPrototypeOf(subClass, superClass); }\n\nfunction MiniBus_setPrototypeOf(o, p) { MiniBus_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return MiniBus_setPrototypeOf(o, p); }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* @author micaelpedrosa@gmail.com\r\n* Message BUS Interface is an extension of the Bus\r\n* It is used mainly in the internal sandbox routing.\r\n*/\n\nvar MiniBus =\n/*#__PURE__*/\nfunction (_Bus) {\n  MiniBus_inherits(MiniBus, _Bus);\n\n  function MiniBus() {\n    MiniBus_classCallCheck(this, MiniBus);\n\n    return MiniBus_possibleConstructorReturn(this, MiniBus_getPrototypeOf(MiniBus).call(this));\n  }\n  /**\r\n   * Post a message for routing. Message is routed directly to the external routing _onPostMessage.\r\n   * @param  {Message} inMsg            JSON with mandatory Message structure {id, type, from, to}\r\n   * @param  {Callback} responseCallback Optional callback if a response is expected from the request. A response will be always sent, even if it is a \"Timeout\".\r\n   * @return {number}                  the Message id\r\n   */\n\n\n  MiniBus_createClass(MiniBus, [{\n    key: \"postMessage\",\n    value: function postMessage(inMsg, responseCallback, timeout) {\n      var _this = this;\n\n      _this._genId(inMsg);\n\n      _this._responseCallback(inMsg, responseCallback, timeout); //always send to external (to core MessageBus)\n\n\n      _this._onPostMessage(inMsg);\n\n      return inMsg.id;\n    } //internal method used when a message is received by an external routing system\n\n  }, {\n    key: \"_onMessage\",\n    value: function _onMessage(msg) {\n      var _this = this;\n\n      if (!_this._onResponse(msg)) {\n        var itemList = _this._subscriptions[msg.to];\n\n        if (itemList) {\n          _this._publishOn(itemList, msg);\n\n          if (!msg.to.startsWith('hyperty')) {\n            _this._publishOnDefault(msg);\n          }\n        } else {\n          _this._publishOnDefault(msg);\n        }\n      }\n    }\n  }]);\n\n  return MiniBus;\n}(bus_Bus);\n\n/* harmony default export */ var bus_MiniBus = (MiniBus);\n// CONCATENATED MODULE: ./src/sandbox/Sandbox.js\nfunction Sandbox_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { Sandbox_typeof = function _typeof(obj) { return typeof obj; }; } else { Sandbox_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return Sandbox_typeof(obj); }\n\nfunction Sandbox_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Sandbox_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Sandbox_createClass(Constructor, protoProps, staticProps) { if (protoProps) Sandbox_defineProperties(Constructor.prototype, protoProps); if (staticProps) Sandbox_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction Sandbox_possibleConstructorReturn(self, call) { if (call && (Sandbox_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return Sandbox_assertThisInitialized(self); }\n\nfunction Sandbox_getPrototypeOf(o) { Sandbox_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return Sandbox_getPrototypeOf(o); }\n\nfunction Sandbox_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) Sandbox_setPrototypeOf(subClass, superClass); }\n\nfunction Sandbox_setPrototypeOf(o, p) { Sandbox_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return Sandbox_setPrototypeOf(o, p); }\n\nfunction Sandbox_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n\nvar SandboxType = {\n  APP: 'app',\n  NORMAL: 'normal',\n  WINDOW: 'window'\n};\n/**\r\n * @author micaelpedrosa@gmail.com\r\n * Base class to implement external sandbox component\r\n */\n\nvar Sandbox_Sandbox =\n/*#__PURE__*/\nfunction (_MiniBus) {\n  Sandbox_inherits(Sandbox, _MiniBus);\n\n  function Sandbox(capabilities) {\n    var _this2;\n\n    Sandbox_classCallCheck(this, Sandbox);\n\n    _this2 = Sandbox_possibleConstructorReturn(this, Sandbox_getPrototypeOf(Sandbox).call(this));\n\n    var _this = Sandbox_assertThisInitialized(Sandbox_assertThisInitialized(_this2));\n\n    if (capabilities) {\n      _this.capabilities = capabilities;\n    }\n\n    return _this2;\n  }\n  /**\r\n   * Deploy an instance of the component into the sandbox.\r\n   * @param  {string} componentSourceCode Component source code (Hyperty, ProtoStub, etc)\r\n   * @param  {URL} componentURL Hyperty, ProtoStub, or any other component address.\r\n   * @param  {Config} configuration Config parameters of the component\r\n   * @return {Promise<string>} return deployed if successful, or any other string with an error\r\n   */\n\n\n  Sandbox_createClass(Sandbox, [{\n    key: \"deployComponent\",\n    value: function deployComponent(componentSourceCode, componentURL, configuration) {\n      var _this = this; // let messageFactory = _this.messageFactory;\n\n\n      return new Promise(function (resolve, reject) {\n        //FLOW-OUT: deploy message for the internal SandboxRegistry -> _onDeploy\n        var deployMessage = {\n          type: 'create',\n          from: sandbox_SandboxRegistry.ExternalDeployAddress,\n          to: sandbox_SandboxRegistry.InternalDeployAddress,\n          body: {\n            url: componentURL,\n            sourceCode: componentSourceCode,\n            config: configuration\n          }\n        }; //send message into the sandbox internals and wait for reply\n\n        _this.postMessage(deployMessage, function (reply) {\n          if (reply.body.code === 200) {\n            //is this response complaint with the spec?\n            resolve('deployed');\n          } else {\n            reject(reply.body.desc);\n          }\n        });\n      });\n    }\n    /**\r\n     * Remove the instance of a previously deployed component.\r\n     * @param  {URL} componentURL Hyperty, ProtoStub, or any other component address.\r\n     * @return {Promise<string>} return undeployed if successful, or any other string with an error\r\n     */\n\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(componentURL) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //FLOW-OUT: un-deploy message for the internal SandboxRegistry -> _onRemove\n        var removeMessage = {\n          type: 'delete',\n          from: sandbox_SandboxRegistry.ExternalDeployAddress,\n          to: sandbox_SandboxRegistry.InternalDeployAddress,\n          body: {\n            url: componentURL\n          }\n        }; //send message into the sandbox internals and wait for reply\n\n        _this.postMessage(removeMessage, function (reply) {\n          if (reply.body.code === 200) {\n            //is this response complaint with the spec?\n            resolve('undeployed');\n          } else {\n            reject(reply.body.desc);\n          }\n        });\n      });\n    }\n    /**\r\n    * Matches Sandbox capabilities against provided capabilities. Used to check if sandbox provides all required capabilities\r\n    * @param  {RuntimeCapabilities} constraints set of RuntimeCapabilities to match with.\r\n    * @return {boolean} return true if constraints are matched false otherwise\r\n     */\n\n  }, {\n    key: \"matches\",\n    value: function matches(constraints) {\n      var _this = this;\n\n      var filtered = Object.keys(constraints).filter(function (key) {\n        return !(_this.capabilities[key] && _this.capabilities[key] === constraints[key]);\n      });\n\n      if (filtered.length === 0) {\n        return true;\n      } else {\n        return !constraints[filtered];\n      }\n    }\n  }]);\n\n  return Sandbox;\n}(bus_MiniBus);\n\n/* harmony default export */ var sandbox_Sandbox = (Sandbox_Sandbox);\n// CONCATENATED MODULE: ./src/allocation/AddressAllocation.js\nfunction AddressAllocation_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction AddressAllocation_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction AddressAllocation_createClass(Constructor, protoProps, staticProps) { if (protoProps) AddressAllocation_defineProperties(Constructor.prototype, protoProps); if (staticProps) AddressAllocation_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log system\n\nvar AddressAllocation_log = loglevel[\"getLogger\"]('address-allocation');\n // TODO: this could not be the best way to do a Singleton but at this moment it works;\n\nvar AddressAllocation_instance;\n/**\r\n * Class will ask to the message node for addresses\r\n */\n\nvar AddressAllocation_AddressAllocation =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _url: URL\r\n  _bus: MiniBus\r\n  */\n\n  /**\r\n   * Create an Address Allocation\r\n   * @param  {URL.URL}      url - url from who is sending the message\r\n   * @param  {MiniBus}      bus - MiniBus used for address allocation\r\n   */\n  function AddressAllocation(url, bus, registry, subscriptionManager) {\n    AddressAllocation_classCallCheck(this, AddressAllocation);\n\n    if (!AddressAllocation_instance) {\n      this._url = url + '/address-allocation';\n      this._bus = bus;\n      this._registry = registry;\n      this._subscriptionManager = subscriptionManager;\n      AddressAllocation_instance = this;\n    } else {\n      return AddressAllocation_instance;\n    }\n  }\n\n  AddressAllocation_createClass(AddressAllocation, [{\n    key: \"create\",\n\n    /**\r\n     *\r\n     * Ask for creation of a number of Hyperty addresses, to the domain message node.\r\n     *\r\n     * @param {Domain} domain - domain of the message node\r\n     * @param {Number} number - number of address to be allocated\r\n     * @param {Descriptor} info - descriptor to search for the hyperty (TODO:// this should be confirmed)\r\n     * @see https://github.com/reTHINK-project/specs/blob/master/datamodel/core/hyperty-catalogue/readme.md#catalogue-data-model\r\n     * @param {scheme} scheme - scheme of address to be created or reused, like: hyperty, comm, context, etc;\r\n     * @param {boolean|URL.HypertyURL} reuseURL - reuseURL is used to reuse the hypertyURL previously registred;\r\n     * @returns {Promise<Object, Error>} this is Promise and returns an object with the address information\r\n     *\r\n     * @memberOf AddressAllocation\r\n     */\n    value: function create(domain, number, info, scheme, reuseURL) {\n      AddressAllocation_log.log('[AddressAllocation.create] info ', info); //debugger;\n\n      if (reuseURL) {\n        if (typeof reuseURL === 'boolean') {\n          if (reuseURL) {\n            return this._reuseAllocatedAddress(domain, number, info, scheme, reuseURL);\n          } else {\n            return this._allocateNewAddress(domain, scheme, number, info);\n          }\n        }\n\n        if (typeof reuseURL === 'string' && isURL(reuseURL)) {\n          //return this._reuseAllocatedAddress(domain, number, info, scheme, reuseURL);\n          return new Promise(function (resolve, reject) {\n            var value = {\n              newAddress: false,\n              address: [reuseURL]\n            };\n            return resolve(value);\n          });\n        }\n      } else {\n        AddressAllocation_log.log('[AddressAllocation] - new address will be allocated'); // if there is no URL saved request a new URL\n\n        return this._allocateNewAddress(domain, scheme, number, info);\n      }\n    }\n  }, {\n    key: \"_reuseAllocatedAddress\",\n    value: function _reuseAllocatedAddress(domain, number, info, scheme, reuseURL) {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        console.log('REUSETEST -  _reuseAllocatedAddress', domain, number, info, scheme, reuseURL);\n\n        _this2._registry.checkRegisteredURLs(info, reuseURL).then(function (urls) {\n          console.log('REUSETEST -  registeredurls', urls);\n\n          if (urls) {\n            AddressAllocation_log.info('[AddressAllocation - ' + scheme + '] - Reuse URL');\n            var value = {\n              newAddress: false,\n              address: urls\n            };\n            resolve(value);\n          } else {\n            if (typeof reuseURL === 'string') {\n              AddressAllocation_log.info('[AddressAllocation - reuseURL] - Object ' + reuseURL + ' not found');\n              reject('URL Not Found');\n            } else if (typeof reuseURL === 'boolean') {\n              _this2._allocateNewAddress(domain, scheme, number, info).then(resolve).catch(reject);\n            } else {\n              reject('URL Not Found');\n            }\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_allocateNewAddress\",\n    value: function _allocateNewAddress(domain, scheme, number, info) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var addresses = [];\n        var i;\n\n        for (i = 0; i < number; i++) {\n          addresses.push(scheme + '://' + domain + '/' + generateGUID());\n        }\n\n        var result = {\n          newAddress: true,\n          address: addresses\n        };\n\n        if (scheme === 'hyperty') {\n          if (info.hasOwnProperty('configuration') && info.configuration.hasOwnProperty('domain_routing') && !info.configuration.domain_routing) resolve(result);else {\n            _this._subscriptionManager.createSubscription(domain, addresses, _this._url).then(function () {\n              resolve(result);\n            });\n          }\n        } else resolve(result);\n        /*      let msg = {\r\n                type: 'create', from: this._url, to: 'domain://msg-node.' + domain + '/address-allocation',\r\n                body: {value: { number: number } }\r\n              };\r\n        \r\n              if (scheme !== 'hyperty') msg.body.scheme = scheme;\r\n        \r\n              log.info('[AddressAllocation - ' + scheme + '] - Request new URL');\r\n        \r\n              this._bus.postMessage(msg, (reply) => {\r\n                if (reply.body.code === 200) {\r\n                  let result = {newAddress: true, address: reply.body.value.allocated};\r\n                  resolve(result);\r\n                } else {\r\n                  reject(reply.body.desc);\r\n                }\r\n              });*/\n\n      });\n    }\n    /**\r\n    * Send a request to the domain message node, to deallocate one or more addresses\r\n    * @param  {Domain} domain - Domain of the message node.\r\n    * @param  {addresses} addresses to request the deallocation\r\n    * @returns {Promise}  the response by the message node\r\n    */\n\n  }, {\n    key: \"delete\",\n    value: function _delete(domain, addresses) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        resolve(200);\n        /*      let message = {\r\n                type: 'delete', from: _this._url, to: 'domain://msg-node.' + domain + '/address-allocation',\r\n                body: {childrenResources: addresses}\r\n              };\r\n        \r\n              _this._bus.postMessage(message, (reply) => {\r\n                if (reply.body.code === 200) {\r\n                  resolve(reply.body.code);\r\n                } else {\r\n                  reject(reply.body.desc);\r\n                }\r\n              });*/\n      });\n    }\n  }, {\n    key: \"url\",\n\n    /**\r\n     * get the URL value\r\n     * @return {string} The url value;\r\n     */\n    get: function get() {\n      return this._url;\n    }\n  }], [{\n    key: \"instance\",\n    get: function get() {\n      if (!AddressAllocation_instance) {\n        throw new Error('The address allocation was not instantiated');\n      }\n\n      return AddressAllocation_instance;\n    }\n  }]);\n\n  return AddressAllocation;\n}();\n\n/* harmony default export */ var allocation_AddressAllocation = (AddressAllocation_AddressAllocation);\n// CONCATENATED MODULE: ./src/registry/RegistryDataModel.js\nfunction RegistryDataModel_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction RegistryDataModel_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction RegistryDataModel_createClass(Constructor, protoProps, staticProps) { if (protoProps) RegistryDataModel_defineProperties(Constructor.prototype, protoProps); if (staticProps) RegistryDataModel_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n*   @author: Gil Dias (gil.dias@tecnico.ulisboa.pt)\r\n*   Registry Data Model includes all Objects to be handled by the Registry functionality including\r\n*/\nvar RegistryDataModel =\n/*#__PURE__*/\nfunction () {\n  function RegistryDataModel(id, url, descriptorURL, p2pRequester, startingTime, lastModified, status, stubs, stubsConfiguration) {\n    RegistryDataModel_classCallCheck(this, RegistryDataModel);\n\n    var _this = this;\n\n    _this._id = id;\n    _this._url = url;\n    _this._descriptorURL = descriptorURL;\n    _this._startingTime = startingTime;\n    _this._lastModified = lastModified;\n    _this._status = status;\n    _this._stubs = stubs;\n    _this._stubsConfiguration = stubsConfiguration;\n    _this._p2pRequester = p2pRequester;\n  }\n\n  RegistryDataModel_createClass(RegistryDataModel, [{\n    key: \"id\",\n    get: function get() {\n      var _this = this;\n\n      return _this._id;\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      var _this = this;\n\n      return _this._url;\n    }\n  }, {\n    key: \"descriptorURL\",\n    get: function get() {\n      var _this = this;\n\n      return _this._descriptorURL;\n    }\n  }, {\n    key: \"p2pRequester\",\n    get: function get() {\n      var _this = this;\n\n      return _this._p2pRequester;\n    }\n  }, {\n    key: \"lastModified\",\n    get: function get() {\n      var _this = this;\n\n      return _this._lastModified;\n    }\n  }]);\n\n  return RegistryDataModel;\n}();\n\n/* harmony default export */ var registry_RegistryDataModel = (RegistryDataModel);\n// CONCATENATED MODULE: ./src/registry/HypertyInstance.js\nfunction HypertyInstance_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { HypertyInstance_typeof = function _typeof(obj) { return typeof obj; }; } else { HypertyInstance_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return HypertyInstance_typeof(obj); }\n\nfunction HypertyInstance_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction HypertyInstance_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction HypertyInstance_createClass(Constructor, protoProps, staticProps) { if (protoProps) HypertyInstance_defineProperties(Constructor.prototype, protoProps); if (staticProps) HypertyInstance_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction HypertyInstance_possibleConstructorReturn(self, call) { if (call && (HypertyInstance_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return HypertyInstance_assertThisInitialized(self); }\n\nfunction HypertyInstance_getPrototypeOf(o) { HypertyInstance_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return HypertyInstance_getPrototypeOf(o); }\n\nfunction HypertyInstance_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) HypertyInstance_setPrototypeOf(subClass, superClass); }\n\nfunction HypertyInstance_setPrototypeOf(o, p) { HypertyInstance_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return HypertyInstance_setPrototypeOf(o, p); }\n\nfunction HypertyInstance_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n*   @author: Gil Dias (gil.dias@tecnico.ulisboa.pt)\r\n*   HypertyInstance Data Model used to model instances of Hyperties running in devices and servers.\r\n*/\n\nvar HypertyInstance =\n/*#__PURE__*/\nfunction (_RegistryDataModel) {\n  HypertyInstance_inherits(HypertyInstance, _RegistryDataModel);\n\n  function HypertyInstance(id, url, descriptorURL, descriptor, hypertyURL, user, guid, runtime, context, p2pHandler, p2pRequester, dataSchemes, resources, startingTime, lastModified) {\n    var _this2;\n\n    HypertyInstance_classCallCheck(this, HypertyInstance);\n\n    _this2 = HypertyInstance_possibleConstructorReturn(this, HypertyInstance_getPrototypeOf(HypertyInstance).call(this, id, url, descriptorURL, p2pRequester, startingTime, lastModified));\n\n    var _this = HypertyInstance_assertThisInitialized(HypertyInstance_assertThisInitialized(_this2));\n\n    _this._descriptor = descriptor;\n    _this._hypertyURL = hypertyURL;\n    _this._user = user;\n    _this._guid = guid;\n    _this._runtime = runtime;\n    _this._context = context;\n    _this._p2pHandler = p2pHandler;\n    _this._dataSchemes = dataSchemes;\n    _this._resources = resources;\n    return _this2;\n  }\n\n  HypertyInstance_createClass(HypertyInstance, [{\n    key: \"user\",\n    set: function set(identity) {\n      var _this = this;\n\n      _this.user = identity;\n    },\n    get: function get() {\n      var _this = this;\n\n      return _this._user;\n    }\n  }, {\n    key: \"hypertyURL\",\n    get: function get() {\n      var _this = this;\n\n      return _this._hypertyURL;\n    }\n  }, {\n    key: \"descriptor\",\n    get: function get() {\n      var _this = this;\n\n      return _this._descriptor;\n    }\n  }, {\n    key: \"objectName\",\n    get: function get() {\n      var _this = this;\n\n      return _this._descriptor._objectName;\n    }\n  }, {\n    key: \"p2pHandler\",\n    get: function get() {\n      var _this = this;\n\n      return _this._p2pHandler;\n    }\n  }, {\n    key: \"dataSchemes\",\n    get: function get() {\n      var _this = this;\n\n      return _this._dataSchemes;\n    }\n  }, {\n    key: \"resources\",\n    get: function get() {\n      var _this = this;\n\n      return _this._resources;\n    }\n  }, {\n    key: \"runtimeURL\",\n    get: function get() {\n      var _this = this;\n\n      return _this._runtime;\n    }\n  }]);\n\n  return HypertyInstance;\n}(registry_RegistryDataModel);\n\n/* harmony default export */ var registry_HypertyInstance = (HypertyInstance);\n// CONCATENATED MODULE: ./src/registry/DomainRegistration.js\nfunction DomainRegistration_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DomainRegistration_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction DomainRegistration_createClass(Constructor, protoProps, staticProps) { if (protoProps) DomainRegistration_defineProperties(Constructor.prototype, protoProps); if (staticProps) DomainRegistration_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar DomainRegistration_log = loglevel[\"getLogger\"]('Registry');\n\n\n/**\r\n* Runtime DomainRegistration Interface\r\n*/\n\nvar DomainRegistration_DomainRegistration =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * To initialise the Runtime Registry with the RuntimeURL that will be the basis to derive the internal runtime addresses when allocating addresses to internal runtime component. In addition, the Registry domain back-end to be used to remotely register Runtime components, is also passed as input parameter.\r\n  * @param  {MessageBus}          messageBus                msgbus\r\n  * @param  {HypertyRuntimeURL}   runtimeURL            runtimeURL\r\n  * @param  {DomainURL}           domain        remoteRegistry\r\n  */\n  function DomainRegistration(runtimeURL, registryURL, domain, messageBus) {\n    DomainRegistration_classCallCheck(this, DomainRegistration);\n\n    if (!runtimeURL) throw new Error('runtimeURL is missing.');\n    if (!registryURL) throw new Error('registryURL is missing.');\n    if (!domain) throw new Error('domain is missing.');\n    if (!messageBus) throw new Error('messageBus is missing.');\n\n    var _this = this;\n\n    _this.registryURL = registryURL;\n    _this.runtimeURL = runtimeURL;\n    _this._registrationRetries = 5; // number of attempts to register Hyperties and DataObjects when errors occurs\n    // the expires in 3600, represents 1 hour\n    //the expires is in seconds, unit of measure received by the domain registry\n\n    _this.expiresTime = 3600;\n    _this._domain = domain;\n    _this._messageBus = messageBus;\n  }\n  /**\r\n  *  function to unregister an hypertyInstance in the Domain Registry\r\n  *  @param   {String}      hypertyInstance   HypertyInsntance url\r\n  *\r\n  */\n\n\n  DomainRegistration_createClass(DomainRegistration, [{\n    key: \"unregisterHyperty\",\n    value: function unregisterHyperty(hypertyInstance) {\n      var _this = this;\n\n      var message = {\n        type: 'update',\n        from: _this.registryURL,\n        to: 'domain://registry.' + _this._domain,\n        body: {\n          resource: '/hyperty/' + hypertyInstance,\n          value: 'disconnected',\n          attribute: 'status'\n        }\n      };\n\n      _this._messageBus.postMessage(message, function (reply) {\n        DomainRegistration_log.log('[DomainRegistration] unregister hyperty Reply', reply);\n      });\n    }\n    /**\r\n    *  function to unregister a Data Object in the Domain Registry\r\n    *  @param   {String}      hypertyInstance   HypertyInsntance url\r\n    *\r\n    */\n\n  }, {\n    key: \"unregisterDataObject\",\n    value: function unregisterDataObject(url) {\n      var _this = this;\n\n      var message = {\n        type: 'update',\n        from: _this.registryURL,\n        to: 'domain://registry.' + _this._domain,\n        body: {\n          resource: url,\n          value: {\n            status: 'disconnected'\n          }\n        }\n      };\n\n      _this._messageBus.postMessage(message, function (reply) {\n        DomainRegistration_log.log('[DomainRegistration] unregister dataObject Reply', reply);\n      });\n    }\n    /**\r\n    *  function to delete an dataObjectInstance in the Domain Registry\r\n    *  @param   {String}    name      DataObjectName\r\n    */\n\n  }, {\n    key: \"deleteDataObjectInstance\",\n    value: function deleteDataObjectInstance(name) {\n      var _this = this;\n\n      var message = {\n        type: 'delete',\n        from: _this.registryURL,\n        to: 'domain://registry.' + _this._domain,\n        body: {\n          value: {\n            name: name\n          }\n        }\n      };\n\n      _this._messageBus.postMessage(message, function (reply) {\n        DomainRegistration_log.log('[DomainRegistration] unregister dataObject Reply', reply);\n      });\n    }\n    /**\r\n    * Function to update an Hyperty\r\n    */\n\n  }, {\n    key: \"updateHypertyInstance\",\n    value: function updateHypertyInstance(resource, value) {\n      var _this = this;\n\n      var message = {\n        type: 'UPDATE',\n        from: _this.registryURL,\n        to: 'domain://registry.' + _this._domain,\n        body: {\n          resource: resource,\n          value: value\n        }\n      };\n\n      _this._messageBus.post.postMessage(message, function (reply) {// log.log('[Registry] Updated hyperty reply', reply);\n      });\n    }\n    /**\r\n    * To register a new Data Object in the Domain Registry.\r\n    * @param  {JSON}     registration                   registration data to be used\r\n    * @param  {boolean}     resume                     if this is just to update the registration with the resume of a data object\r\n    */\n\n  }, {\n    key: \"registerDataObject\",\n    value: function registerDataObject(registration, resume, p2pHandlerStub) {\n      var _this = this;\n\n      var p2pHandler;\n      var p2pRequester;\n      return new Promise(function (resolve, reject) {\n        var dataScheme = [];\n        var filteredDataScheme = registration.url.split(':');\n        dataScheme.push(filteredDataScheme[0]);\n\n        if (Object.keys(p2pHandlerStub).length !== 0) {\n          p2pHandler = p2pHandlerStub[_this.runtimeURL].url;\n          p2pRequester = runtimeUtils.runtimeDescriptor.p2pRequesterStub;\n        }\n\n        registration.startingTime = registration.created;\n        delete registration.authorise;\n        delete registration.created;\n        delete registration.mutual;\n        delete registration.resume;\n        if (!registration.expires) registration.expires = _this.expiresTime;\n        registration.dataSchemes = dataScheme;\n\n        if (p2pHandler) {\n          registration.p2pHandler = p2pHandler;\n          registration.p2pRequester = p2pRequester;\n        }\n\n        registration.status = 'live';\n        var message;\n\n        if (!resume) {\n          DomainRegistration_log.log('[Registry.registerDataObject] registering new data object URL', registration);\n          message = {\n            type: 'create',\n            from: _this.registryURL,\n            to: 'domain://registry.' + _this._domain,\n            body: {\n              value: registration,\n              policy: 'policy'\n            }\n          };\n        } else {\n          DomainRegistration_log.log('[Registry.registerDataObject] registering previously registered data object URL', registration);\n          message = {\n            type: 'update',\n            to: 'domain://registry.' + _this._domain,\n            from: _this.registryURL,\n            body: {\n              resource: registration.url,\n              value: {\n                status: 'live'\n              }\n            }\n          };\n        }\n\n        try {\n          _this._messageBus.postMessageWithRetries(message, _this._registrationRetries, function (reply) {\n            // log.log('[Registry.registerDataObject] ===> registerDataObject Reply: ', reply);\n            if (reply.body.code === 200) {\n              resolve(registration);\n            } else {\n              reject('error on register DataObject');\n            }\n          });\n        } catch (e) {\n          DomainRegistration_log.error(e);\n          reject(e);\n        } //timer to keep the registration alive\n        // the time is defined by a little less than half of the expires time defined\n\n\n        var keepAliveTimer = setInterval(function () {\n          var message = {\n            type: 'update',\n            from: _this.registryURL,\n            to: 'domain://registry.' + _this._domain,\n            body: {\n              resource: registration.url,\n              value: {\n                status: 'live'\n              },\n              method: 'refresh'\n            }\n          };\n\n          _this._messageBus.postMessage(message, function (reply) {// log.log('[Registry.registerDataObject] KeepAlive Reply: ', reply);\n          });\n        }, registration.expires / 1.1 / 2 * 1000);\n      });\n    }\n    /**\r\n    * To register a new Hyperty in the Domain Registry.\r\n    * @param  {HypertyInstance}     hyperty            Hyperty to be registered\r\n    * @param  {boolean}     resume                     if this is just to update the registration with the resume of a data object\r\n    */\n\n  }, {\n    key: \"registerHyperty\",\n    value: function registerHyperty(hyperty, resume) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var runtime = _this.runtimeURL;\n        var status = 'live'; //message to register the new hyperty, within the domain registry\n\n        var message;\n        var registrationExpires = _this.expiresTime;\n        var messageValue = {\n          user: hyperty.user.email,\n          descriptor: hyperty.descriptorURL,\n          url: hyperty.hypertyURL,\n          expires: registrationExpires,\n          resources: hyperty.resources,\n          dataSchemes: hyperty.dataSchemes,\n          runtime: runtime,\n          status: status\n        }; // set a different expires if defined in the hyperty configuration\n\n        if (hyperty.p2pHandler) {\n          messageValue.p2pHandler = hyperty.p2pHandler;\n          messageValue.p2pRequester = hyperty.p2pRequester;\n        } // set a different expires value if configured in the Hyperty descriptor\n\n\n        if (hyperty.descriptor.configuration && hyperty.descriptor.configuration.expires) registrationExpires = hyperty.descriptor.configuration.expires;\n\n        if (!resume) {\n          // log.log('[Registry registerHyperty] registering new Hyperty URL', addressURL.address[0]);\n          // set a different expires if defined in the hyperty configuration\n          // log.log('[Registry registerHyperty] registering new Hyperty at domain registry ', messageValue);\n          message = {\n            type: 'create',\n            from: _this.registryURL,\n            to: 'domain://registry.' + _this._domain,\n            body: {\n              value: messageValue,\n              policy: 'policy'\n            }\n          };\n        } else {\n          // log.log('[Registry registerHyperty] registering previously registered Hyperty URL', addressURL.address[0]);\n          message = {\n            type: 'update',\n            to: 'domain://registry.' + _this._domain,\n            from: _this.registryURL,\n            body: {\n              resource: hyperty.hypertyURL,\n              value: {\n                status: 'live',\n                user: hyperty.user.email\n              }\n            }\n          };\n\n          if (hyperty.p2pHandler) {\n            message.body.value.p2pHandler = hyperty.p2pHandler;\n            message.body.value.p2pRequester = hyperty.p2pRequester;\n          }\n        } // log.log('[Registry registerHyperty] Hyperty registration at domain registry  - ', message);\n\n\n        try {\n          _this._messageBus.postMessageWithRetries(message, _this._registrationRetries, function (reply) {\n            // log.log('[Registry registerHyperty] Hyperty registration response: ', reply);\n            if (reply.body.code === 200) {\n              var result = {\n                url: hyperty.hypertyURL\n              };\n\n              if (hyperty.p2pHandler) {\n                result.p2pHandler = hyperty.p2pHandler;\n                result.p2pRequester = hyperty.p2pRequester;\n              }\n\n              resolve(result);\n            } else if (reply.body.code === 404) {\n              // log.log('[Registry registerHyperty] The update was not possible. Registering new Hyperty at domain registry');\n              message = {\n                type: 'create',\n                from: _this.registryURL,\n                to: 'domain://registry.' + _this._domain,\n                body: {\n                  value: messageValue,\n                  policy: 'policy'\n                }\n              };\n\n              try {\n                _this._messageBus.postMessageWithRetries(message, _this._registrationRetries, function (reply) {\n                  // log.log('[Registry registerHyperty] Hyperty registration update response: ', reply);\n                  if (reply.body.code === 200) {\n                    var _result = {\n                      url: hyperty.hypertyURL\n                    };\n\n                    if (hyperty.p2pHandler) {\n                      _result.p2pHandler = hyperty.p2pHandler;\n                      _result.p2pRequester = hyperty.p2pRequester;\n                    }\n\n                    resolve(_result);\n                  } else {\n                    throw new Error('Failed to register an Hyperty: ' + reply);\n                  }\n                });\n              } catch (e) {\n                DomainRegistration_log.error(e);\n                reject(e);\n              }\n            } else {\n              throw new Error('Failed to register an Hyperty to domain: ', reply);\n            }\n          });\n        } catch (e) {\n          DomainRegistration_log.error(e);\n          reject(e);\n        } //timer to keep the registration alive\n        // the time is defined by a little less than half of the expires time defined\n\n\n        var keepAliveTimer = setInterval(function () {\n          var message = {\n            type: 'update',\n            from: _this.registryURL,\n            to: 'domain://registry.' + _this._domain,\n            body: {\n              resource: hyperty.hypertyURL,\n              value: {\n                status: 'live'\n              },\n              method: 'refresh'\n            }\n          };\n\n          _this._messageBus.postMessage(message, function (reply) {// log.log('[Registry registerHyperty] KeepAlive Reply: ', reply);\n          });\n        }, registrationExpires / 1.1 / 2 * 1000);\n      });\n    }\n  }]);\n\n  return DomainRegistration;\n}();\n\n/* harmony default export */ var registry_DomainRegistration = (DomainRegistration_DomainRegistration);\n// CONCATENATED MODULE: ./src/registry/P2PConnectionResolve.js\nfunction P2PConnectionResolve_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction P2PConnectionResolve_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction P2PConnectionResolve_createClass(Constructor, protoProps, staticProps) { if (protoProps) P2PConnectionResolve_defineProperties(Constructor.prototype, protoProps); if (staticProps) P2PConnectionResolve_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar P2PConnectionResolve_log = loglevel[\"getLogger\"]('P2PConnectionResolve');\n/**\r\n*   To process address resolution for p2p connections\r\n*/\n\nvar P2PConnectionResolve =\n/*#__PURE__*/\nfunction () {\n  function P2PConnectionResolve(registry) {\n    P2PConnectionResolve_classCallCheck(this, P2PConnectionResolve);\n\n    var _this = this;\n\n    _this._registry = registry;\n    _this._remoteP2PEntities = {}; // All remote entities and associated runtime url that are reachable with existing p2p connections\n  }\n  /**\r\n  * Verifies if remote Entity can be reached with a P2P Connection.\r\n  * @param  {URL.URL}        info           object URL\r\n  * @return {HypertyDataObjectInstance}  addressURL     return the Data Object instance registered URL, return undefined otherwise\r\n  */\n\n\n  P2PConnectionResolve_createClass(P2PConnectionResolve, [{\n    key: \"checkP2P\",\n    value: function checkP2P(msg) {\n      if (!msg.hasOwnProperty('to')) {\n        // throw Error('The p2p verification was failed');\n        return Promise.reject('The p2p verification was failed');\n      }\n\n      var scheme = msg.to.split('://')[0];\n      var comp = msg.to.split('://')[1].split('/')[2];\n      var url;\n      if (comp) url = msg.to.substring(0, msg.to.indexOf('/' + comp));else url = msg.to;\n      var p2p = {};\n      if (msg.body && msg.body.p2p) p2p.p2p = msg.body.p2p;\n\n      if (msg.body && msg.body.p2pHandler && msg.body.p2pRequester) {\n        p2p.p2pHandler = msg.body.p2pHandler;\n        p2p.p2pRequester = msg.body.p2pRequester;\n        p2p.runtime = msg.body.p2pHandler.split('/p2phandler/')[0];\n      }\n\n      switch (scheme) {\n        case 'runtime':\n          return this.checkP2PRuntime(url, p2p);\n          break;\n\n        default:\n          return this.checkP2PEntity(url, p2p);\n          break;\n      }\n    }\n    /**\r\n    * Verifies if remote Entity (Hyperty or Data Object) can be reached with a P2P Connection.\r\n    * @param  {string}        url           Remote Entity URL to be checked\r\n    * @param  {object}        p2p           p2p information to be used including ´runtime´ with remote Runtime URL, 'p2pHandler' remote P2P Handler Stub URL and p2pRequester with Catalogue URL of P2P Requester to be used\r\n    * @return {promise} registeredEntity     if p2p connection is possible it returns p2p information to be used in the connection, otherwise the promise is rejected\r\n    */\n\n  }, {\n    key: \"checkP2PEntity\",\n    value: function checkP2PEntity(url, p2p) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var remoteEntity = _this._remoteP2PEntities[url];\n        if (remoteEntity) resolve(remoteEntity);else if (p2p.runtime) resolve(p2p); // use provided p2p if available in the message body\n        else if (p2p.p2p) {\n            // otherwise look on Domain Registry\n            P2PConnectionResolve_log.log('[Registry - checkP2PEntity] - search in Domain Registry: ', url);\n            var message = {\n              type: 'read',\n              from: _this._registry.registryURL,\n              to: 'domain://registry.' + _this._registry._domain,\n              body: {\n                resource: url\n              }\n            };\n\n            _this._registry._messageBus.postMessage(message, function (reply) {\n              P2PConnectionResolve_log.log('[Registry - checkP2PEntity] Domain Registry reply', reply);\n\n              if ('value' in reply.body) {\n                //todo: store retrieved entity\n                var resolvedEntity = reply.body.value;\n\n                if (resolvedEntity.hasOwnProperty('p2pHandler')) {\n                  resolve(resolvedEntity);\n                } else {\n                  reject('[Registry checkP2PEntity] Hyperty found does not support P2P', reply.body.value);\n                }\n              } else {\n                reject('[Registry checkP2PEntity] Hyperty with P2PHandler not found', reply.body.code);\n              }\n            });\n          } else reject('[Registry checkP2PEntity] No P2P Connection available for ', url);\n      });\n    }\n    /**\r\n    * Verifies if remote Runtime can be reached with a P2P Connection.\r\n    * @param  {URL.URL}        runtimeURL           Runtime URL\r\n    * @return {Object}  p2pConnection    return the P2PConnection instance registered URL, return undefined otherwise\r\n    */\n\n  }, {\n    key: \"checkP2PRuntime\",\n    value: function checkP2PRuntime(runtimeURL, p2p) {\n      var _this = this;\n\n      var registeredRuntime = {}; // look on locally stored p2p connections\n\n      return new Promise(function (resolve, reject) {\n        if (_this._registry.p2pConnectionList[runtimeURL]) {\n          resolve({\n            runtime: runtimeURL\n          });\n        } else if (p2p.runtime) {\n          registeredRuntime = p2p;\n          resolve(registeredRuntime);\n        } else reject('[Registry.P2PConnectionResolve.checkP2PRuntime] No P2P Connection found to ', runtimeURL);\n      });\n    }\n    /**\r\n    * Verifies if remote Hyperty can be reached with a P2P Connection.\r\n    * @param  {JSON}        info           object or entity charateristics info\r\n    * @return {addressURL}  addressURL     return the URL if there is any previousy registered URL, return undefined otherwise\r\n    */\n\n  }, {\n    key: \"checkP2PHyperty\",\n    value: function checkP2PHyperty(hypertyURL, p2p) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var hyperty; // look on locally stored hyperties\n\n        for (var i in _this._registry.remoteHypertyList) {\n          hyperty = _this._registry.remoteHypertyList[i];\n          P2PConnectionResolve_log.log('[Registry - checkP2PHyperty] - for each Hyperty: ', hyperty); // todo: change to \"hyperty.url\" to be aligned with hyperty instance data model spec\n\n          if (hyperty.hypertyID === hypertyURL) {\n            if (hyperty.hasOwnProperty('p2pHandler')) {\n              resolve(hyperty);\n            } else {\n              reject('[Registry checkP2PHyperty] Hyperty found does not support P2P', hyperty);\n            }\n\n            return;\n          }\n        }\n\n        if (!hyperty && p2p.runtime) resolve(p2p); // use provided p2p if available in the message body\n        else if (!hyperty && p2p.p2p) {\n            // otherwise look on Domain Registry\n            P2PConnectionResolve_log.log('[Registry - checkP2PHyperty] - search in Domain Registry: ', hyperty);\n            var message = {\n              type: 'read',\n              from: _this._registry.registryURL,\n              to: 'domain://registry.' + _this._registry._domain,\n              body: {\n                resource: hypertyURL\n              }\n            };\n\n            _this._registry._messageBus.postMessage(message, function (reply) {\n              P2PConnectionResolve_log.log('[Registry - checkP2PHyperty] Domain Registry reply', reply);\n\n              if ('value' in reply.body) {\n                //todo: store retrieved hyperty\n                var resolvedHyperty = reply.body.value;\n\n                _this._registry.remoteHypertyList.push(resolvedHyperty);\n\n                if (resolvedHyperty.hasOwnProperty('p2pHandler')) {\n                  resolve(resolvedHyperty);\n                } else {\n                  reject('[Registry checkP2PHyperty] Hyperty found does not support P2P', reply.body.value);\n                }\n              } else {\n                reject('[Registry checkP2PHyperty] Hyperty with P2PHandler not found', reply.body.code);\n              }\n            });\n          } else reject('[Registry checkP2PHyperty] No P2P Connection available for ', hypertyURL);\n      });\n    }\n    /**\r\n    * Verifies if remote Data Object can be reached with a P2P Connection.\r\n    * @param  {URL.URL}        DataObjectURL           object URL\r\n    * @return {HypertyDataObjectInstance}  addressURL     return the Data Object instance registered URL, return undefined otherwise\r\n    */\n\n  }, {\n    key: \"checkP2PDataObject\",\n    value: function checkP2PDataObject(url, p2p) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        // look on locally stored Remote Data Objects\n        var dataobject = _this._registry.remoteDataObjectList.filter(function (i) {\n          return _this._registry.remoteDataObjectList[i].url === url;\n        });\n\n        if (dataobject.length !== 0 && dataobject[0].p2pRequester) {\n          resolve(dataobject[0]);\n        } else if (dataobject.length !== 0) {\n          reject('[Registry checkP2PDataObject] Data Object found does not support P2P', dataobject[0]);\n        } else if (dataobject.length === 0 && p2p.runtime) resolve(p2p); // use provided p2p info if available in the message body\n        else if (dataobject.length && p2p.p2p) {\n            // otherwise look on Domain Registry\n            // look on Domain Registry\n            var message = {\n              type: 'read',\n              from: _this._registry.registryURL,\n              to: 'domain://registry.' + _this._registry._domain,\n              body: {\n                resource: url\n              }\n            };\n\n            _this._registry._messageBus.postMessage(message, function (reply) {\n              P2PConnectionResolve_log.log('discover data object per url reply', reply);\n\n              if ('value' in reply.body) {\n                //todo: store retrieved hyperty\n                var resolvedDataObject = reply.body.value;\n\n                _this._registry.remoteDataObjectList.push(resolvedDataObject);\n\n                if (resolvedDataObject.p2pRequester) {\n                  resolve(resolvedDataObject);\n                } else {\n                  reject('[Registry checkP2PDataObject] Data Object found does not support P2P', reply.body.value);\n                }\n              } else {\n                reject('[Registry checkP2PDataObject] not found', reply.body.code);\n              }\n            });\n          } else reject('[Registry checkP2PDataObject] no P2P Connection found');\n      });\n    }\n  }, {\n    key: \"addRemoteP2PEntity\",\n    value: function addRemoteP2PEntity(url, runtime) {\n      this._remoteP2PEntities[url] = runtime;\n    }\n  }, {\n    key: \"removeRemoteP2PEntity\",\n    value: function removeRemoteP2PEntity(url) {\n      delete this._remoteP2PEntities[url];\n    }\n  }, {\n    key: \"reconnectP2PRequester\",\n    value: function reconnectP2PRequester(p2pRequester) {\n      var _this = this;\n\n      P2PConnectionResolve_log.log('[P2PConenctionResolve.reconnectP2PRequester] lets try to reconnect P2P Requester Stub: ', p2pRequester);\n      return new Promise(function (resolve, reject) {\n        var remoteRuntime = p2pRequester.runtime;\n        var message = {\n          type: 'execute',\n          from: _this._registry.registryURL,\n          to: p2pRequester.url,\n          body: {\n            method: 'connect',\n            params: [p2pRequester.p2pHandler]\n          }\n        }; // lets prepare the p2pRequesterSTub reconnect by setting an observer to its status changes\n\n        _this._registry.watchingYou.observe('p2pRequesterStub', function (change) {\n          P2PConnectionResolve_log.log('[P2PConenctionResolve.reconnectP2PRequester] p2pRequesterStubs changed ' + _this._registry.p2pRequesterStub);\n\n          if (change.keypath.split('.')[0] === remoteRuntime && change.name === 'status') {\n            switch (change.newValue) {\n              case 'live':\n                P2PConnectionResolve_log.log('[P2PConenctionResolve.reconnectP2PRequester] p2pRequester is live ' + _this._registry.p2pRequesterStub[remoteRuntime]);\n                resolve(_this._registry.p2pRequesterStub[remoteRuntime].url);\n                break;\n\n              case 'failed':\n                P2PConnectionResolve_log.log('[P2PConenctionResolve.reconnectP2PRequester] p2pRequester reconnect failed ' + _this._registry.p2pRequesterStub[remoteRuntime]);\n                reject('P2P Requester reconnect failed');\n                break;\n\n              default:\n            }\n          }\n        }); //  stub load\n\n\n        _this._registry._messageBus.postMessage(message, function (reply) {\n          P2PConnectionResolve_log.log('[P2PConenctionResolve.reconnectP2PRequester] reconnect request reply', reply);\n        });\n      });\n    }\n  }]);\n\n  return P2PConnectionResolve;\n}();\n\n/* harmony default export */ var registry_P2PConnectionResolve = (P2PConnectionResolve);\n// CONCATENATED MODULE: ./src/utils/WatchingYou.js\nfunction WatchingYou_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction WatchingYou_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction WatchingYou_createClass(Constructor, protoProps, staticProps) { if (protoProps) WatchingYou_defineProperties(Constructor.prototype, protoProps); if (staticProps) WatchingYou_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\nvar WatchingYou =\n/*#__PURE__*/\nfunction () {\n  function WatchingYou() {\n    WatchingYou_classCallCheck(this, WatchingYou);\n\n    this._watching = {};\n    this._observers = [];\n  }\n\n  WatchingYou_createClass(WatchingYou, [{\n    key: \"watch\",\n    value: function watch(key, object) {\n      var _this = this;\n\n      var deep = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      if (deep) {\n        this._watching[key] = Object.deepObserve(object, function (changes) {\n          changes.every(function (change) {\n            _this._fireEvent(key, change);\n          });\n        });\n      } else {\n        this._watching[key] = Object.observe(object, function (changes) {\n          changes.every(function (change) {\n            _this._fireEvent(key, change);\n          });\n        });\n      }\n\n      return this._watching[key];\n    }\n  }, {\n    key: \"observe\",\n    value: function observe(key, callback) {\n      this._observers.push({\n        key: key,\n        callback: callback\n      });\n    }\n  }, {\n    key: \"_fireEvent\",\n    value: function _fireEvent(key, change) {\n      this._observers.filter(function (observe) {\n        return observe.key === key;\n      }).forEach(function (observe) {\n        observe.callback(change);\n      });\n    }\n  }]);\n\n  return WatchingYou;\n}();\n\n/* harmony default export */ var utils_WatchingYou = (WatchingYou);\n/*let watchChanges = new WatchChanges();\r\nlet p2pRequesterStub = watchChanges.watch('p2p', {}, true);\r\nlet stub = watchChanges.watch('stub', {});\r\n\r\nwatchChanges.observe('p2p', (change) => {\r\n  console.log('p2pRequesterStub: ' + change.name + ' - ' + JSON.stringify(change.newValue));\r\n});\r\n\r\nwatchChanges.observe('p2p', (change) => {\r\n  console.log('p2pRequesterStub: ' + change.name + ' - ' + JSON.stringify(change.newValue));\r\n});\r\n\r\nwatchChanges.observe('stub', (change) => {\r\n  console.log('stub ' + change.name);\r\n});\r\n\r\np2pRequesterStub.a = {};\r\nstub.b = {name: 'vitor'};\r\np2pRequesterStub.a.name = 'Hello';\r\nstub.b = {name: 'vitor'};\r\np2pRequesterStub.a.age = '32';\r\np2pRequesterStub.a.name = 'World';*/\n// CONCATENATED MODULE: ./src/Utils.js\n\n\n// CONCATENATED MODULE: ./src/registry/Registry.js\nfunction Registry_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { Registry_typeof = function _typeof(obj) { return typeof obj; }; } else { Registry_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return Registry_typeof(obj); }\n\nfunction Registry_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Registry_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Registry_createClass(Constructor, protoProps, staticProps) { if (protoProps) Registry_defineProperties(Constructor.prototype, protoProps); if (staticProps) Registry_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar Registry_log = loglevel[\"getLogger\"]('Registry');\n\n\n\n\n\n\n\n\n // import DiscoveryServiceFramework from './DiscoveryServiceFramework';\n\nvar STATUS = {\n  CREATED: 'created',\n  LIVE: 'live',\n  DEPLOYING: 'deploying',\n  DEPLOYED: 'deployed',\n  PROGRESS: 'in-progress',\n  DISCONNECTED: 'disconnected',\n  FAILED: 'deployment-failed',\n  DEAD: 'dead'\n};\n/*import IdentityManager from './IdentityManager';\r\nimport Discovery from './Discovery';*/\n\n/**\r\n* Runtime Registry Interface\r\n*/\n\nvar Registry_Registry =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * To initialise the Runtime Registry with the RuntimeURL that will be the basis to derive the internal runtime addresses when allocating addresses to internal runtime component. In addition, the Registry domain back-end to be used to remotely register Runtime components, is also passed as input parameter.\r\n  * @param  {MessageBus}          msgbus                msgbus\r\n  * @param  {HypertyRuntimeURL}   runtimeURL            runtimeURL\r\n  * @param  {AppSandbox}          appSandbox            appSandbox\r\n  * @param  {runtimeCatalogue}    runtimeCatalogue      runtimeCatalogue\r\n  * @param  {DomainURL}           remoteRegistry        remoteRegistry\r\n  * @param  {storageManager}      storageManager\r\n  */\n  function Registry(runtimeURL, appSandbox, identityModule, runtimeCatalogue, runtimeCapabilities, storageManager, p2pHandlerURL, remoteRegistry) {\n    Registry_classCallCheck(this, Registry);\n\n    // how some functions receive the parameters for example:\n    // new Registry('hyperty-runtime://sp1/123', appSandbox, idModule, remoteRegistry);\n    // registry.registerStub(sandbox, 'sp1');\n    // registry.registerHyperty(sandBox, 'hyperty-runtime://sp1/123');\n    // registry.resolve('hyperty-runtime://sp1/123');\n    if (!runtimeURL) throw new Error('runtimeURL is missing.');\n    if (!storageManager) throw new Error('storageManager is missing.');\n    /*if (!remoteRegistry) throw new Error('remoteRegistry is missing');*/\n\n    var _this = this;\n\n    _this.registryURL = runtimeURL + '/registry/';\n    _this.appSandbox = appSandbox;\n    _this.runtimeURL = runtimeURL;\n    _this.p2pHandlerURL = p2pHandlerURL;\n    _this.runtimeCatalogue = runtimeCatalogue;\n    _this.remoteRegistry = remoteRegistry;\n    _this.idModule = identityModule;\n    _this.storageManager = storageManager;\n    _this.runtimeCapabilities = runtimeCapabilities;\n    _this.identifier = generateGUID();\n    _this.hypertiesListToRemove = {};\n    _this.hypertiesList = [];\n    _this.remoteHypertyList = [];\n    _this.remoteDataObjectList = [];\n    _this.idpLegacyProxyList = {};\n    _this.watchingYou = new utils_WatchingYou();\n    _this.p2pHandlerStub = {};\n    _this.p2pRequesterStub = _this.watchingYou.watch('p2pRequesterStub', {}, true);\n    _this.p2pConnectionList = _this.watchingYou.watch('p2pConnectionList', {}, true);\n    _this.p2pHandlerAssociation = {};\n    _this.protostubsList = _this.watchingYou.watch('protostubsList', {}, true);\n    _this.idpProxyList = _this.watchingYou.watch('idpProxyList', {}, true);\n    _this.dataObjectList = {};\n    _this.subscribedDataObjectList = {};\n    _this.sandboxesList = {\n      sandbox: {},\n      appSandbox: {}\n    };\n    _this.pepList = {};\n    _this.registries = {};\n    _this._domain = divideURL(_this.registryURL).domain;\n    _this.sandboxesList.appSandbox[runtimeURL] = appSandbox;\n    var p2pConnectionResolve = new registry_P2PConnectionResolve(_this);\n    _this._p2pConnectionResolve = p2pConnectionResolve;\n    _this._hypertyUrls = {};\n    _this._dataObjectUrls = {};\n  }\n\n  Registry_createClass(Registry, [{\n    key: \"loadRegistry\",\n    value: function loadRegistry() {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        _this.storageManager.get('registry:HypertyURLs').then(function (urlsList) {\n          if (urlsList) _this._hypertyUrls = urlsList;\n\n          _this.storageManager.get('registry:DataObjectURLs').then(function (urlsList) {\n            if (urlsList) _this._dataObjectUrls = urlsList;\n            resolve();\n          });\n        });\n      });\n    }\n  }, {\n    key: \"_getIdentityAssociated\",\n    value: function _getIdentityAssociated(type, hypertyURL) {\n      var _this = this;\n\n      for (var hyperty in _this.hypertiesList) {\n        var value = _this.hypertiesList[hyperty];\n\n        if (value._hypertyURL === hypertyURL) {\n          switch (type) {\n            case 'username':\n              return value._user.username;\n\n            case 'cn':\n              return value._user.cn;\n\n            case 'locale':\n              return value._user.locale;\n\n            case 'avatar':\n              return value._user.avatar;\n\n            case 'userURL':\n              return value._user.userURL;\n\n            case '.':\n              return value._user;\n\n            default:\n              return '';\n          }\n        }\n      }\n\n      return '';\n    }\n    /**\r\n    * This function is used to return the sandbox instance where the Application is executing. It is assumed there is just one App per Runtime instance.\r\n    */\n\n  }, {\n    key: \"getAppSandbox\",\n    value: function getAppSandbox() {\n      var _this = this;\n\n      return _this.appSandbox;\n    }\n    /**\r\n    * This function returns the user associated to the hyperty URL\r\n    * @param    {String}    hypertyURL      hyperty URL\r\n    * @return   {String}    userURL         user URL\r\n    */\n\n  }, {\n    key: \"getHypertyOwner\",\n    value: function getHypertyOwner(hypertyURL) {\n      var _this = this;\n\n      var userURL;\n\n      for (var index in _this.hypertiesList) {\n        var hyperty = _this.hypertiesList[index];\n\n        if (hyperty.hypertyURL === hypertyURL) {\n          return hyperty.user.userURL;\n        }\n      }\n\n      return userURL;\n    }\n    /**\r\n    * This function returns the user associated to the hyperty URL\r\n    * @param    {String}    dataObjectURL      dataObjectURL URL\r\n    * @return   {String}    userURL         user URL\r\n    */\n\n  }, {\n    key: \"getDataObjectReporter\",\n    value: function getDataObjectReporter(dataObjectURL) {\n      var _this = this;\n\n      var DOurl = removePathFromURL(dataObjectURL);\n\n      for (var index in _this.dataObjectList) {\n        var dataObject = _this.dataObjectList[index];\n\n        if (dataObject.url === DOurl) {\n          return dataObject.reporter;\n        }\n      }\n\n      return null;\n    }\n    /**\r\n    * returns the hyperty Name from a given url. This url could be from a dataObject or hyperty\r\n    * @param    {String}    url      hyperty or dataObject URL\r\n    * @return   {String}    hypertyName     hyperty Name\r\n    */\n\n  }, {\n    key: \"getHypertyName\",\n    value: function getHypertyName(url) {\n      var _this = this;\n\n      var isHypertyURL = divideURL(url).type === 'hyperty'; //value to be returned in the end\n\n      var hypertyName; //if is not an hyperty, check if is a dataObject and obtain his reporter\n\n      var hypertyURL = isHypertyURL ? url : _this.getReporterURLSynchonous(url);\n\n      for (var index in _this.hypertiesList) {\n        var hyperty = _this.hypertiesList[index];\n\n        if (hyperty.hypertyURL === hypertyURL) {\n          hypertyName = hyperty.objectName;\n          break;\n        }\n      }\n\n      return hypertyName;\n    }\n    /**\r\n    * function to return the reporterURL associated with the dataobject URL\r\n    * @param    {String}     dataObjectURL    dataObjectURL\r\n    * @return   {String}     reporterURL      reporterURL\r\n    */\n\n  }, {\n    key: \"getReporterURL\",\n    value: function getReporterURL(dataObjectURL) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var dataObject = _this.dataObjectList[dataObjectURL];\n\n        if (dataObject) {\n          resolve(dataObject.reporter);\n        } else {\n          reject('No reporter was found');\n        }\n      });\n    }\n    /**\r\n    * function to return the reporterURL associated with the dataobject URL. no promise returned\r\n    * @param    {String}     dataObjectURL    dataObjectURL\r\n    * @return   {String}     reporterURL      reporterURL\r\n    */\n\n  }, {\n    key: \"getReporterURLSynchonous\",\n    value: function getReporterURLSynchonous(dataObjectURL) {\n      var _this = this;\n\n      var dataObject = _this.dataObjectList[dataObjectURL];\n      return dataObject ? dataObject.reporter : undefined;\n    }\n    /**\r\n    * returns the hyperty URL that subscribed the dataObject\r\n    * @param    {String}     url            url format\r\n    * @return   {String}    Hyperty URL subscribed to the URL\r\n    */\n\n  }, {\n    key: \"getDataObjectSubscriberHyperty\",\n    value: function getDataObjectSubscriberHyperty(url) {\n      var _this = this;\n\n      return _this.subscribedDataObjectList[url];\n    }\n    /**\r\n    * register a desired dataObject to subscribe\r\n    * @param    {String}    dataObjectURL      dataObject URL\r\n    */\n\n  }, {\n    key: \"registerSubscribedDataObject\",\n    value: function registerSubscribedDataObject(dataObjectURL, hypertyURL) {\n      var _this = this;\n\n      if (_this.subscribedDataObjectList[dataObjectURL] === undefined) {\n        _this.subscribedDataObjectList[dataObjectURL] = hypertyURL;\n      }\n    }\n    /**\r\n    * Function to return the list of pre authorised users received in the creation of a data object\r\n    * @param    {String}            dataObjectURL    dataObjectURL\r\n    * @return   {Array<String>}     preAuth         List of pre authorised users\r\n    */\n\n  }, {\n    key: \"getPreAuthSubscribers\",\n    value: function getPreAuthSubscribers(dataObjectURL) {\n      var _this = this;\n\n      var dataObject = _this.dataObjectList[dataObjectURL];\n      var preAuth = [];\n\n      if (dataObject) {\n        preAuth = dataObject.authorise;\n      }\n\n      return preAuth;\n    }\n    /**\r\n    * send requests to unregister all hyperties registered in domain registry\r\n    * @return   {Promise}     return a promise if the result of unregistration all hyperties\r\n    */\n\n  }, {\n    key: \"unregisterAllHyperties\",\n    value: function unregisterAllHyperties() {\n      var _this = this;\n\n      var unregisterResults = [];\n      return new Promise(function (resolve, reject) {\n        for (var index in _this.hypertiesList) {\n          var hyperty = _this.hypertiesList[index];\n\n          var result = _this.unregisterHypertyInstance(hyperty.hypertyURL);\n\n          unregisterResults.push(result);\n        }\n\n        Promise.all(unregisterResults).then(function () {\n          resolve('successfully unregistered all hyperties');\n        }, function (error) {\n          reject(error);\n        });\n      });\n    }\n    /**\r\n    *  function to unregister an hypertyInstance in the Domain Registry\r\n    *  @param   {String}      hypertyInstance   HypertyInsntance url\r\n    *\r\n    */\n\n  }, {\n    key: \"unregisterHypertyInstance\",\n    value: function unregisterHypertyInstance(hypertyInstance) {\n      //TODO working but the user\n      var _this = this;\n\n      var closeMsg = {\n        type: 'execute',\n        from: _this.registryURL,\n        to: hypertyInstance,\n        body: {\n          method: 'close'\n        }\n      }; // Send message to hyperty to close\n\n      _this._messageBus.postMessage(closeMsg, function (reply) {\n        Registry_log.log('[Registry.unregisterHypertyInstance] Close Reply', reply);\n\n        _this._domainRegistration.unregisterHyperty(hypertyInstance);\n      });\n    }\n    /**\r\n    *  function to unregister a Data Object in the Domain Registry\r\n    *  @param   {String}      hypertyInstance   HypertyInsntance url\r\n    *\r\n    */\n\n  }, {\n    key: \"unregisterDataObject\",\n    value: function unregisterDataObject(url) {\n      this._domainRegistration.unregisterDataObject(url);\n    }\n    /**\r\n    * register a new subscriber in the dataObject registered\r\n    * @param  {String}   dataObjectURL    dataObject URL\r\n    * @param  {String}   subscriberURL    subscriber URL\r\n    */\n\n  }, {\n    key: \"registerSubscriber\",\n    value: function registerSubscriber(dataObjectURL, subscriberURL) {\n      var _this = this;\n\n      var dataObject = _this.dataObjectList[dataObjectURL];\n\n      if (dataObject) {\n        if (!dataObject.subscribers) dataObject.subscribers = [];\n        dataObject.subscribers.push(subscriberURL);\n        _this.dataObjectList[dataObjectURL] = dataObject;\n      }\n    }\n    /**\r\n    * get the subscribers registered within a dataObject\r\n    * @param  {String}          dataObjectURL    dataObject URL\r\n    * @param  {Array<String>}   Substribers List\r\n    */\n\n  }, {\n    key: \"getDataObjectSubscribers\",\n    value: function getDataObjectSubscribers(dataObjectURL) {\n      var _this = this;\n\n      var dataObject = _this.dataObjectList[dataObjectURL];\n\n      if (dataObject) {\n        return dataObject.subscribers;\n      } else {\n        throw 'No dataObject was found';\n      }\n    }\n    /**\r\n    * To register a new Data Object in the runtime which returns the dataObjectURL allocated to the new Data Object.\r\n    * @param  {String}      identifier                  identifier\r\n    * @param  {String}      dataObjectschema            dataObjectschema\r\n    * @param  {String}      dataObjectUrl               dataObjectUrl\r\n    * @param {String}      dataObjectReporter           dataObjectReporter\r\n    * @param  {Array}     resources                     dataObject resources\r\n    * @param  {Array}     authorise                     list of pre authorised authorised IDs\r\n    */\n    //registerDataObject(identifier, dataObjectschema, dataObjectUrl, dataObjectReporter, resources, addressURL, authorise) {\n\n  }, {\n    key: \"registerDataObject\",\n    value: function registerDataObject(objectRegistration) {\n      var _this = this;\n\n      var registration = deepClone(objectRegistration);\n      return new Promise(function (resolve, reject) {\n        _this.dataObjectList[objectRegistration.url] = objectRegistration; //      _this.storageManager.get('registry:DataObjectURLs').then((urlsList) => {\n\n        /*        if (!urlsList) {\r\n                  urlsList = {};\r\n                }*/\n        //update the list with the new elements\n\n        _this._dataObjectUrls[objectRegistration.name + objectRegistration.schema + objectRegistration.resources + objectRegistration.reporter] = objectRegistration.url; // step to obtain the list of all URL registered to updated with the new one.\n\n        _this.storageManager.set('registry:DataObjectURLs', 0, _this._dataObjectUrls).then(function () {\n          if (_this.isInterworkingProtoStub(registration.reporter)) {\n            registration.interworking = true;\n          }\n\n          var domainRegistration = true;\n          if (registration.hasOwnProperty(\"domain_registration\")) domainRegistration = registration.domain_registration;\n          if (domainRegistration) _this._domainRegistration.registerDataObject(registration, objectRegistration.resume, _this.p2pHandlerStub).then(function (registered) {\n            resolve(registered);\n          });else resolve(registration);\n        }).catch(function (reason) {\n          Registry_log.error('[Registry registerDataObject] Error: ', reason);\n          reject(reason);\n        });\n      }); //    });\n    }\n  }, {\n    key: \"_getResourcesAndSchemes\",\n    value: function _getResourcesAndSchemes(descriptor) {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        var resources; // check if the hyperty resources is a vector or a string\n        // TODO delete later when catalogue is fixed\n\n        if (typeof descriptor.hypertyType === 'string') {\n          resources = [];\n          resources.push(descriptor.hypertyType);\n        } else {\n          resources = descriptor.hypertyType;\n        }\n\n        var objName = descriptor.objectName;\n        var descriptorDataSchema = descriptor.dataObjects;\n        var dataSchemasArray = []; //this will create a array with a Promise in each position\n\n        for (var index in descriptorDataSchema) {\n          dataSchemasArray.push(_this.runtimeCatalogue.getDataSchemaDescriptor(descriptorDataSchema[index]));\n        } // as soon as the previous array is completed, this will wait for the resolve of all promises in the array\n\n\n        Promise.all(dataSchemasArray).then(function (dataSchemas) {\n          var filteredDataSchemas = [];\n\n          for (var _index in dataSchemas) {\n            var dataSchema = dataSchemas[_index];\n            filteredDataSchemas.push(dataSchema.sourcePackage.sourceCode.properties.scheme);\n          } // log.log('[Registry] Hyperty Schemas', filteredDataSchemas);\n          // log.log('[Registry] Hyperty resources', resources);\n\n\n          resolve({\n            resources: resources,\n            dataSchema: filteredDataSchemas,\n            name: objName\n          });\n        });\n      });\n    }\n    /**\r\n    * method that returns previously registered Hyperty or DataObjects URLS, for given characteristics\r\n    * @param  {JSON}        info           object or hyperty charateristics info\r\n    * @return {addressURL}  addressURL     return the URL if there is any previousy registered URL, return undefined otherwise\r\n    */\n\n  }, {\n    key: \"checkRegisteredURLs\",\n    value: function checkRegisteredURLs(info, reuseURL) {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        var objectType = info.reporter ? 'registry:DataObjectURLs' : 'registry:HypertyURLs';\n\n        if (typeof reuseURL === 'string') {\n          objectType = reuseURL && divideURL(reuseURL).type !== 'hyperty' ? 'registry:DataObjectURLs' : 'registry:HypertyURLs';\n        } //debugger;\n\n\n        _this.storageManager.get(objectType).then(function (urlsList) {\n          if (!urlsList) {\n            urlsList = {};\n          }\n\n          if (typeof reuseURL === 'string') {\n            Registry_log.info('[Registry - checkRegisteredURLs] - look for ' + reuseURL + ' on ', urlsList);\n            var searchResult = Object.keys(urlsList).map(function (key) {\n              var indexOf = urlsList[key].indexOf(reuseURL);\n              return urlsList[key][indexOf];\n            });\n            Registry_log.info('[Registry - checkRegisteredURLs] - found ' + searchResult.length + ' results on ', searchResult);\n\n            if (searchResult.length === 1) {\n              return resolve(searchResult);\n            } else {\n              return resolve(undefined);\n            }\n          }\n\n          if (objectType === 'registry:HypertyURLs') {\n            _this._getResourcesAndSchemes(info).then(function (value) {\n              if (urlsList[value.resources + value.dataSchema + value.name]) {\n                // log.log('[Registry] reusage of hyperty URL');\n                return resolve(urlsList[value.resources + value.dataSchema + value.name]);\n              } else {\n                // log.log('[Registry] no hyperty URL was previously registered ');\n                return resolve(undefined);\n              }\n            });\n          } else {\n            var characteristics = info.name + info.schema + info.resources + info.reporter;\n\n            if (urlsList[characteristics]) {\n              // log.log('[Registry] reusage of dataObject URL');\n              if (typeof urlsList[characteristics] === 'string') {\n                var arrayToResolve = [];\n                arrayToResolve.push(urlsList[characteristics]);\n                return resolve(arrayToResolve);\n              } else {\n                return resolve(urlsList[characteristics]);\n              }\n            } else {\n              // log.log('[Registry] no dataObject URL was previously registered');\n              return resolve(undefined);\n            }\n          }\n        });\n      });\n    }\n    /**\r\n    * To register a new Hyperty in the runtime which returns the HypertyURL allocated to the new Hyperty.\r\n    * @param  {Sandbox}             sandbox               sandbox\r\n    * @param  {HypertyCatalogueURL} HypertyCatalogueURL   descriptor\r\n    * @param {object} IdpConstraint - constraints to be used when selecting the identity to be associated with the Hyperty including origin, idp, and idHint.\r\n    * @return {HypertyURL}          HypertyURL\r\n    */\n\n  }, {\n    key: \"registerHyperty\",\n    value: function registerHyperty(sandbox, importPath, descriptor, addressURL, IdpConstraint) {\n      var _this = this;\n\n      var hypertyCapabilities;\n      return new Promise(function (resolve, reject) {\n        _this.idModule.getIdentityAssertion(IdpConstraint).then(function (result) {\n          var userProfile = result.userProfile; // log.log('[Registry registerHyperty] userProfile', userProfile);\n\n          if (_this._messageBus === undefined) {\n            reject('[Registry registerHyperty] MessageBus is undefined');\n          } else {\n            //call check if the protostub exist: to be removed\n\n            /*  _this.resolve(domainUrl).then(function(a) {\r\n              // log.log('[Registry registerHyperty] stub to domain registry- ', a);*/\n            //          _this.storageManager.get('registry:HypertyURLs').then((urlsList) => {\n            // log.log('[Registry registerHyperty] storageManager] - ', urlsList);\n            _this._getResourcesAndSchemes(descriptor).then(function (value) {\n              hypertyCapabilities = value;\n              /*              if (!urlsList) {\r\n                              urlsList = {};\r\n                            }*/\n\n              _this._hypertyUrls[hypertyCapabilities.resources + hypertyCapabilities.dataSchema + hypertyCapabilities.name] = addressURL.address;\n\n              _this.storageManager.set('registry:HypertyURLs', 0, _this._hypertyUrls).then(function () {\n                //check whether the received sanbox e ApplicationSandbox or a normal sandbox\n                if (sandbox.type === 'app') {\n                  _this.sandboxesList.appSandbox[addressURL.address[0]] = sandbox;\n                } else if (sandbox.type === 'normal') {\n                  _this.sandboxesList.sandbox[addressURL.address[0]] = sandbox;\n                } else {\n                  reject('Wrong SandboxType');\n                }\n\n                var p2pHandler;\n                var p2pRequester;\n\n                if (Object.keys(_this.p2pHandlerStub).length !== 0) {\n                  p2pHandler = _this.p2pHandlerStub[_this.runtimeURL].url;\n                  p2pRequester = runtimeUtils.runtimeDescriptor.p2pRequesterStub;\n                }\n\n                var hyperty = new registry_HypertyInstance(_this.identifier, _this.registryURL, importPath, descriptor, addressURL.address[0], userProfile, 'guid', _this.runtimeURL, 'ctx', p2pHandler, p2pRequester, hypertyCapabilities.dataSchema, hypertyCapabilities.resources);\n\n                _this.hypertiesList.push(hyperty);\n                /*--- start here move p2p and domain registry related features to a separated function.-------..*/\n\n\n                var registrationAtdomain = true;\n\n                if (descriptor.hasOwnProperty(\"_configuration\") && descriptor.configuration.hasOwnProperty(\"domain_registration\")) {\n                  registrationAtdomain = descriptor.configuration.domain_registration;\n                }\n\n                if (registrationAtdomain) _this._domainRegistration.registerHyperty(hyperty, addressURL.newAddress).then(function (registered) {\n                  resolve(registered);\n                });else resolve({\n                  url: hyperty.hypertyURL\n                });\n                /*------------------- END HERE MOVE DOMAIN REGISTRY ------------------*/\n              }).catch(function (reason) {\n                // log.log('[Registry registerHyperty] Error: ', reason);\n                reject(reason);\n              });\n            }); //          });\n\n          }\n        }, function (err) {\n          reject('[Registry registerHyperty] ', err);\n        });\n      });\n    }\n    /**\r\n    * To unregister a previously registered Hyperty\r\n    * @param  {HypertyURL}          HypertyURL url        url\r\n    */\n\n  }, {\n    key: \"unregisterHyperty\",\n    value: function unregisterHyperty(url) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var found = false;\n        var index = 0;\n\n        for (index = 0; index < _this.hypertiesList.length; index++) {\n          var hyperty = _this.hypertiesList[index];\n\n          if (hyperty !== undefined) {\n            if (hyperty.hypertyURL === url) {\n              found = true;\n              break;\n            }\n          }\n        }\n\n        if (found === false) {\n          reject('Hyperty not found');\n        } else {\n          delete _this.hypertiesList[index];\n          resolve('Hyperty successfully deleted');\n        }\n      });\n    }\n    /**\r\n    * To discover protocol stubs available in the runtime for a certain domain. If available, it returns the runtime url for the protocol stub that connects to the requested domain. Required by the runtime BUS to route messages to remote servers or peers (do we need something similar for Hyperties?).\r\n    * @param  {DomainURL}           DomainURL            url\r\n    * @return {RuntimeURL}           RuntimeURL\r\n    */\n\n  }, {\n    key: \"discoverProtostub\",\n    value: function discoverProtostub(url) {\n      if (!url) throw new Error('Parameter url needed');\n\n      var _this = this;\n\n      var dividedURL = divideURL(url);\n      var domainURL = dividedURL.domain;\n\n      if (_this.protostubsList.hasOwnProperty(domainURL) && _this.protostubsList[domainURL].status === STATUS.LIVE) {\n        return _this.protostubsList[domainURL];\n      } else {\n        _this.protostubsList[domainURL] = {\n          status: STATUS.DEPLOYING\n        };\n        throw new Error('[Registry - discoverProtoStub ] Message Node Protostub Not Found. Creating one');\n      }\n    }\n    /**\r\n    * To discover protocol stubs available in the runtime for a certain remote runtime URL. If available, it returns the runtime url for the protocol stub that connects to the requested domain.\r\n    * Required by the runtime BUS to route messages to remote servers or peers (do we need something similar for Hyperties?).\r\n    * @param  {RuntimeURL}           RuntimeURL            url\r\n    * @return {p2pRequester}           RuntimeURL\r\n    */\n\n  }, {\n    key: \"discoverP2PStub\",\n    value: function discoverP2PStub(runtimeURL) {\n      var _this = this;\n\n      if (runtimeURL) {\n        if (_this.p2pRequesterStub.hasOwnProperty(runtimeURL) && _this.p2pRequesterStub[runtimeURL].status === STATUS.LIVE) {\n          return _this.p2pRequesterStub[runtimeURL];\n        } else {\n          _this.p2pRequesterStub[runtimeURL] = {\n            status: STATUS.CREATED\n          };\n          throw new Error('[Registry - discoverP2PStub ] P2P Requester Stub Not Found. Creating one');\n        }\n      } else {\n        if (_this.p2pHandlerStub.hasOwnProperty(_this.runtimeURL)) {\n          return _this.p2pHandlerStub[_this.runtimeURL];\n        } else {\n          _this.p2pHandlerStub[_this.runtimeURL] = {\n            status: STATUS.CREATED\n          };\n          throw new Error('[Registry - discoverP2PStub ] P2P Handler Stub Not Found.');\n        }\n      }\n    }\n    /**\r\n     * To register a new Protocol Stub in the runtime including as input parameters the function to postMessage, the DomainURL that is connected with the stub, which returns the RuntimeURL allocated to the new ProtocolStub.\r\n     * @param  {Sandbox}       Sandbox\r\n     * @param  {stubID}        Domain or hyperty runtime to register the stub\r\n     * @param  {descriptorURL}     Catalogue URL of the Protostub descriptor\r\n     * @param  {descriptor}     Protostub descriptor\r\n     * @return {RuntimeProtoStubURL}\r\n     */\n\n  }, {\n    key: \"registerStub\",\n    value: function registerStub(sandbox, stubID, p2pConfig, descriptorURL, descriptor) {\n      var _this = this;\n\n      var _stubDescriptor = descriptor;\n      return new Promise(function (resolve, reject) {\n        var runtimeProtoStubURL; //check if messageBus is registered in registry or not\n\n        if (_this._messageBus === undefined) {\n          reject('MessageBus not found on registerStub');\n        }\n\n        Registry_log.info('[Registry - registerStub] - stubID ', stubID);\n        /* if (!stubID.indexOf('msg-node.')) {\r\n          stubID = stubID.substring(stubID.indexOf('.') + 1);\r\n        }*/\n\n        var P2PRequesterStub;\n\n        if (p2pConfig) {\n          if (p2pConfig.hasOwnProperty('isHandlerStub') && p2pConfig.isHandlerStub) {\n            runtimeProtoStubURL = _this.p2pHandlerURL;\n            _this.p2pHandlerStub[stubID] = {\n              url: runtimeProtoStubURL,\n              status: STATUS.CREATED\n            };\n            _this.p2pHandlerAssociation[_this.runtimeURL] = [];\n            _this.sandboxesList.sandbox[runtimeProtoStubURL] = sandbox;\n            Registry_log.info('[Registry - registerStub - P2PHandlerStub] - ', stubID, ' - ', runtimeProtoStubURL);\n            resolve(_this.p2pHandlerStub[stubID]);\n          } else {\n            P2PRequesterStub = p2pConfig.p2pRequesterStub;\n            runtimeProtoStubURL = 'runtime://' + divideURL(p2pConfig.remoteRuntimeURL).domain + '/p2prequester/' + generateGUID();\n            Registry_log.info('[Registry - registerStub - P2PRequesterStub] - ', P2PRequesterStub, ' - ', runtimeProtoStubURL); // to be clarified what is this p2pHandlerAssociation\n\n            _this.p2pHandlerAssociation[_this.runtimeURL].push(runtimeProtoStubURL);\n\n            _this.p2pRequesterStub[stubID] = {\n              url: runtimeProtoStubURL,\n              status: STATUS.CREATED\n            };\n            _this.sandboxesList.sandbox[runtimeProtoStubURL] = sandbox; //Setup P2P Requester path into MN\n\n            var msg = {\n              type: 'subscribe',\n              from: _this.registryURL,\n              to: 'domain://msg-node.' + _this._domain + '/sm',\n              body: {\n                subscribe: [runtimeProtoStubURL],\n                source: _this.registryURL\n              }\n            };\n\n            _this._messageBus.postMessage(msg, function (reply) {// log.log('[Registry - register Stub] p2pRequester path setup: ', reply);\n            });\n\n            resolve(_this.p2pRequesterStub[stubID]);\n          }\n        } else {\n          console.log('[Registry - registerStub - Normal Stub] descriptor', descriptor);\n\n          if (!Registry_typeof(descriptor) === 'string' && descriptor.hasOwnProperty('_interworking') && descriptor._interworking) {\n            runtimeProtoStubURL = 'runtime://' + stubID + '/protostub/' + 'scheme1';\n          } else {\n            runtimeProtoStubURL = 'runtime://' + stubID + '/protostub/' + generateGUID();\n          }\n\n          Registry_log.info('[Registry - registerStub - Normal Stub] - ', stubID); // TODO: Optimize this\n\n          _this.protostubsList[stubID] = {\n            url: runtimeProtoStubURL,\n            status: STATUS.DEPLOYING\n          };\n\n          if (descriptorURL) {\n            _this.protostubsList[stubID].descriptorURL = descriptorURL;\n          }\n\n          if (_stubDescriptor && _stubDescriptor.interworking) {\n            _this.protostubsList[stubID].interworking = _stubDescriptor.interworking;\n          }\n\n          _this.sandboxesList.sandbox[runtimeProtoStubURL] = sandbox;\n          resolve(_this.protostubsList[stubID]);\n        } // resolve(runtimeProtoStubURL);\n\n\n        _this._messageBus.addListener(runtimeProtoStubURL + '/status', function (msg) {\n          _this._onProtostubStatusEvent(msg);\n        });\n      });\n    }\n    /**\r\n    * To Process status events fired by protostubs\r\n    * @param  {Message}   message     Event Message\r\n    */\n\n  }, {\n    key: \"_onProtostubStatusEvent\",\n    value: function _onProtostubStatusEvent(msg) {\n      var _this = this; // log.log('[Registry onProtostubStatusEvent]: ', msg);\n\n\n      var runtimeProtoStubURL = msg.from;\n\n      if (!msg.to.includes('/status')) {\n        Registry_log.error('[Registry onProtostubStatusEvent] Not Status Event: ', msg);\n        return;\n      } else {\n        // broadcast Protostub status event to all Hyperties\n        var from = msg.from;\n        msg.from = _this.runtimeURL;\n        msg.to = _this.runtimeURL + '/status';\n        msg.body.resource = from;\n\n        _this._messageBus.postMessage(msg);\n      } // process status events from message node protostubs\n\n\n      if (runtimeProtoStubURL.includes('/protostub/')) {\n        // TODO: uncomment below when protostubs are updated with new status value \"live\"\n        Object.keys(_this.protostubsList).filter(function (key) {\n          return _this.protostubsList[key].url === runtimeProtoStubURL;\n        }).map(function (key) {\n          _this.protostubsList[key].status = msg.body.value; // log.log('[Registry - onProtostubStatusEvent] - Protostub status: ', _this.protostubsList[key]);\n        });\n      } else {\n        // process status events from p2p connections\n        if (msg.body.resource) {\n          var remoteRuntimeURL = msg.body.resource;\n\n          if (_this.p2pConnectionList[remoteRuntimeURL]) {\n            _this.p2pConnectionList[remoteRuntimeURL].status = msg.body.value;\n            _this.p2pConnectionList[remoteRuntimeURL].url = runtimeProtoStubURL;\n          } else {\n            var p2pConnection = {\n              status: msg.body.value,\n              url: runtimeProtoStubURL\n            };\n            _this.p2pConnectionList[remoteRuntimeURL] = p2pConnection;\n          } // log.log('[Registry - onProtostubStatusEvent] - P2PConnection status: ', _this.p2pConnectionList[remoteRuntimeURL]);\n          // Update P2P Requester protostub if it is coming from there\n\n\n          if (runtimeProtoStubURL.includes('/p2prequester/')) {\n            _this.p2pRequesterStub[remoteRuntimeURL].status = msg.body.value; // log.log('[Registry - onProtostubStatusEvent] - P2P Requester status: ', _this.p2pRequesterStub[remoteRuntimeURL]);\n          } else {\n            // if from P2PHandler with status disconencted, lets remove from p2pConnectionList\n            if (msg.body.value === 'disconnected') delete _this.p2pConnectionList[remoteRuntimeURL];\n          }\n        } else {\n          if (runtimeProtoStubURL.includes('/p2prequester/')) {\n            // It is an event from P2P Requester without mandatory \"resource\" field\n            Registry_log.error('[Registry onProtostubStatusEvent] resource missing: ', msg);\n            return;\n          } else {\n            // It is an event from P2P Handler\n            _this.p2pHandlerStub[_this.runtimeURL].status = msg.body.value; // log.log('[Registry - onProtostubStatusEvent] - P2PHandler Stub status: ', _this.p2pHandlerStub[_this.runtimeURL]);\n          }\n        }\n      }\n    }\n    /**\r\n    * To unregister a previously registered protocol stub\r\n    * @param  {HypertyRuntimeURL}   HypertyRuntimeURL     hypertyRuntimeURL\r\n    */\n\n  }, {\n    key: \"unregisterStub\",\n    value: function unregisterStub(hypertyRuntimeURL) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this.protostubsList.hasOwnProperty(hypertyRuntimeURL)) {\n          delete _this.protostubsList[hypertyRuntimeURL];\n          resolve('ProtostubURL removed');\n        } else {\n          reject('Error on unregisterStub: Hyperty not found');\n        }\n      });\n    }\n    /**\r\n     * To register a new Identity Provider proxy in the runtime including as input parameters the function to postMessage, the DomainURL that is connected with the stub, which returns the RuntimeURL allocated to the new ProtocolStub.\r\n     * @param {Sandbox}        Sandbox\r\n     * @param  {DomainURL}     DomainURL service provider domain\r\n     * @return {RuntimeIdpProxyURL}\r\n     */\n\n  }, {\n    key: \"registerIdpProxy\",\n    value: function registerIdpProxy(sandbox, domainURL) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var idpProxyStubURL; //check if messageBus is registered in registry or not\n\n        if (_this._messageBus === undefined) {\n          reject('MessageBus not found on registerStub');\n        }\n\n        idpProxyStubURL = 'domain-idp://' + domainURL + '/stub/' + generateGUID(); // TODO: Optimize this\n\n        _this.idpProxyList[domainURL] = {\n          url: idpProxyStubURL,\n          status: STATUS.DEPLOYING\n        };\n        _this.sandboxesList.sandbox[idpProxyStubURL] = sandbox; // sandbox.addListener('*', function(msg) {\n        //   _this._messageBus.postMessage(msg);\n        // });\n\n        resolve(idpProxyStubURL);\n\n        _this._messageBus.addListener(idpProxyStubURL + '/status', function (msg) {\n          _this._onIdpProxyStatusEvent(msg);\n        });\n      });\n    }\n    /**\r\n    * To Process status events fired by Idp Proxies\r\n    * @param  {Message}   message     Event Message\r\n    */\n\n  }, {\n    key: \"_onIdpProxyStatusEvent\",\n    value: function _onIdpProxyStatusEvent(msg) {\n      var _this = this; // log.log('[Registry onIdpProxyStatusEvent]: ', msg);\n\n\n      var idpProxyURL = msg.from;\n\n      if (!msg.to.includes('/status')) {\n        Registry_log.error('[Registry onIdpProxyStatusEvent] Not Status Event: ', msg);\n        return;\n      }\n\n      Object.keys(_this.idpProxyList).filter(function (key) {\n        return _this.idpProxyList[key].url === idpProxyURL;\n      }).map(function (key) {\n        _this.idpProxyList[key].status = msg.body.value; // log.log('[Registry - onIdpProxyStatusEvent] - Idp Proxy status: ', _this.idpProxyList[key]);\n      });\n    }\n    /**\r\n    * To discover idpProxy stubs available in the runtime for a certain domain. If available, it returns the runtime url for the idpProxy stub that connects to the requested domain. Required by the runtime BUS to route messages to remote servers or peers\r\n    * @param  {DomainURL}           DomainURL            url\r\n    * @return {RuntimeURL}           RuntimeURL         idpProxyUrl\r\n    */\n\n  }, {\n    key: \"discoverIdpProxy\",\n    value: function discoverIdpProxy(url) {\n      if (!url) throw new Error('Parameter url needed');\n\n      var _this = this;\n\n      var dividedURL = divideURL(url);\n      var domainURL = dividedURL.domain;\n\n      if (_this.idpProxyList.hasOwnProperty(domainURL) && _this.idpProxyList[domainURL].status === STATUS.LIVE) {\n        return _this.idpProxyList[domainURL];\n      } else {\n        _this.idpProxyList[domainURL] = {\n          status: STATUS.PROGRESS\n        };\n        throw new Error('[Registry - discoverIdpProxy ] Idp Proxy Not Found. Creating one');\n      }\n    }\n    /**\r\n    * To register a new Policy Enforcer in the runtime including as input parameters the function to postMessage, the HypertyURL associated with the PEP, which returns the RuntimeURL allocated to the new Policy Enforcer component.\r\n    * @param  {Message.Message} postMessage postMessage\r\n    * @param  {HypertyURL}          HypertyURL            hyperty\r\n    * @return {HypertyRuntimeURL}   HypertyRuntimeURL\r\n    */\n\n  }, {\n    key: \"registerPEP\",\n    value: function registerPEP(postMessage, hyperty) {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        //TODO check what parameter in the postMessage the pep is.\n        _this.pepList[hyperty] = postMessage;\n        resolve('PEP registered with success');\n      });\n    }\n    /**\r\n    * To unregister a previously registered protocol stub\r\n    * @param  {HypertyRuntimeURL}   HypertyRuntimeURL     HypertyRuntimeURL\r\n    */\n\n  }, {\n    key: \"unregisterPEP\",\n    value: function unregisterPEP(HypertyRuntimeURL) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var result = _this.pepList[HypertyRuntimeURL];\n\n        if (result === undefined) {\n          reject('Pep Not found.');\n        } else {\n          resolve('PEP successfully removed.');\n        }\n      });\n    }\n    /**\r\n    * To discover sandboxes available in the runtime for a certain domain and a certain set of capabilities. Required by the runtime UA to avoid more than one sandbox for the same domain.\r\n    * @param  {DomainURL} DomainURL url\r\n    * @return {RuntimeSandbox}           RuntimeSandbox\r\n    */\n\n  }, {\n    key: \"getSandbox\",\n    value: function getSandbox(url, constraints) {\n      if (!url) throw new Error('Parameter url needed'); // log.log('[Registry getSandbox] getSandbox for: ', url, ' and capabilities: ', constraints);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var request; //first try to find the url in the appSandbox list\n\n        request = _this.sandboxesList.appSandbox[url]; //if no appSandbox was found, try to search in the normal sandboxes list\n\n        if (!request) {\n          request = _this.sandboxesList.sandbox[url];\n\n          if (!request) {\n            var domain;\n\n            if (url.includes('://')) {\n              domain = divideURL(url).domain;\n            } else {\n              domain = url;\n            } // search in the sandboxes list for a entry containing the domain given\n\n\n            for (var sandbox in _this.sandboxesList.sandbox) {\n              //todo: uncomment sandbox constraints match condition with runtime sharing\n              if (sandbox.includes(domain) && _this.sandboxesList.sandbox[sandbox].matches(constraints)) {\n                var _ret = function () {\n                  var current = _this.sandboxesList.sandbox[sandbox];\n                  var match = Object.keys(constraints).filter(function (constraint) {\n                    return constraint === 'browser' && current.type === SandboxType.NORMAL || constraint === 'windowSanbox' && current.type === SandboxType.WINDOW;\n                  }).length > 0 ? true : false;\n\n                  if (match) {\n                    request = current;\n                  }\n\n                  return \"break\";\n                }();\n\n                if (_ret === \"break\") break;\n              }\n            }\n          }\n        }\n\n        if (!request) {\n          reject('no sandbox found for: ' + url);\n        } else {\n          resolve(request);\n        }\n      });\n    }\n  }, {\n    key: \"resolveNormalStub\",\n    value: function resolveNormalStub(url) {\n      // log.log('resolveNormalStub ' + url);\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //split the url to find the domainURL. deals with the url for example as:\n        //\"hyperty-runtime://sp1/protostub/123\",\n        var dividedURL = divideURL(url);\n        var domainUrl = dividedURL.domain;\n        var type = dividedURL.type;\n\n        if (url.includes(_this.runtimeURL) || url.includes('://sandbox/')) {\n          Registry_log.error('[Registry - resolve] URL to be resolved should have listeners ', url);\n          reject('[Registry - resolve] URL to be resolved should have listeners ', url);\n        } // resolve the domain protostub in case of a message to global registry\n\n\n        if (url.includes('global://registry')) {\n          domainUrl = _this._domain;\n        } else {\n          if (!domainUrl.indexOf('msg-node.') || !domainUrl.indexOf('registry.')) {\n            domainUrl = domainUrl.substring(domainUrl.indexOf('.') + 1);\n          }\n        }\n\n        _this.isLegacy(url).then(function (isLegacy) {\n          // if legacy it should resolve for <protocol>.<domain>\n          if (isLegacy && type !== 'domain-idp') {\n            domainUrl = type + '.' + getUserIdentityDomain(url);\n          }\n\n          Registry_log.info('[Registry.resolve] domainUrl:', domainUrl);\n          var registredComponent;\n\n          if (type === 'domain-idp') {\n            registredComponent = _this.idpProxyList.hasOwnProperty(domainUrl) ? _this.idpProxyList[domainUrl] : false;\n          } else {\n            registredComponent = _this.protostubsList.hasOwnProperty(domainUrl) ? _this.protostubsList[domainUrl] : false;\n          }\n\n          Registry_log.info('[Registry.resolve] registred:', registredComponent); // TODO since the protostubs have other states this should be revised, because the status could change from DEPLOYED to LIVE\n          // TODO and this validation will trigger a new load of IDPProxy or Protostub;\n\n          if (registredComponent && registredComponent.hasOwnProperty('status') && (registredComponent.status === STATUS.DEPLOYED || registredComponent.status === STATUS.CREATED || registredComponent.status === STATUS.LIVE || registredComponent.status === STATUS.DISCONNECTED)) {\n            Registry_log.info('[Registry.resolve] Resolved: ', registredComponent.url, registredComponent.status);\n            resolve(registredComponent.url);\n          } else {\n            //todo: use switch-case to support other types of stubs\n            if (type === 'domain-idp') {\n              // The IdP Proxy does not exist, let's prepare its deployment by watching its status\n              _this.watchingYou.observe('idpProxyList', function (change) {\n                // log.log('[Registry - resolveNormalStub] idpProxyList changed ' + _this.idpProxyList);\n                var keypath = change.keypath;\n                if (keypath.includes('status')) keypath = keypath.replace('.status', '');\n\n                if (keypath === domainUrl && change.name === 'status' && change.newValue === STATUS.CREATED) {\n                  // log.log('[Registry - resolveNormalStub] idpProxyList is live ' + _this.idpProxyList[domainUrl]);\n                  resolve(_this.idpProxyList[domainUrl].url);\n                }\n              });\n\n              if (!registredComponent || registredComponent.status === STATUS.FAILED) {\n                // this process will load the idp proxy, because is not yet registered;\n                Registry_log.info('[Registry.resolveNormalStub] deploy new IDPProxy: ', domainUrl);\n\n                _this.loader.loadIdpProxy(domainUrl).then(function () {\n                  Registry_log.info('[Registry.resolveNormalStub] IdP Proxy deployed: ', _this.idpProxyList[domainUrl]);\n                }).catch(function (reason) {\n                  Registry_log.error('[Registry.resolve] Error resolving Load IDPProxy: ', reason);\n                  _this.idpProxyList[domainUrl].status = 'deployment-failed';\n                  reject(reason);\n                });\n              }\n            } else {\n              // The protoStub does not exist, let's prepare its deployment by watching its status\n              _this.watchingYou.observe('protostubsList', function (change) {\n                // log.log('[Registry - resolveNormalStub] protostubsList changed ' + _this.protostubsList);\n                var keypath = change.keypath;\n                if (keypath.includes('status')) keypath = keypath.replace('.status', '');\n\n                if (keypath === domainUrl && change.name === 'status' && change.newValue === STATUS.CREATED) {\n                  // log.log('[Registry - resolve] protostub is live ' + _this.protostubsList[domainUrl]);\n                  resolve(_this.protostubsList[domainUrl].url);\n                }\n              });\n\n              if (!registredComponent || registredComponent.status === STATUS.FAILED) {\n                // lets deploy the protostub\n                Registry_log.info('[Registry.resolve] trigger new ProtocolStub: ', domainUrl);\n\n                _this.loader.loadStub(domainUrl).then(function () {// log.log('[Registry - resolveNormalStub] Stub deployed: ', _this.protostubsList[domainUrl]);\n                }).catch(function (reason) {\n                  Registry_log.error('[Registry.resolveNormalStub] Error resolving Load ProtocolStub: ', reason);\n                  reject(reason);\n                });\n              }\n            }\n          }\n        }).catch(function (reason) {\n          Registry_log.error('[Registry.resolve] Error resolving islegacy: ', reason);\n          reject(reason);\n        });\n      });\n    }\n    /**\r\n    * To verify if source is valid and to resolve target runtime url address if needed (eg protostub runtime url in case the message is to be dispatched to a remote endpoint).\r\n    * @param  {URL.URL}  url       url\r\n    * @return {Promise<URL.URL>}                 Promise <URL.URL>\r\n    */\n\n  }, {\n    key: \"resolve\",\n    value: function resolve(msg) {\n      Registry_log.info('[Registry - Resolve] -  ', msg);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var url = msg.to ? msg.to : msg;\n        var p2p = msg.body && msg.body.p2p ? msg.body.p2p : false; // log.log('P2P: ', p2p, url);\n        // log.log('P2P - p2pHandlerStub: ', !_this.p2pHandlerStub[_this.runtimeURL], _this.p2pHandlerStub, _this.runtimeURL);\n        // log.log('P2P - isBackendServiceURL: ', isBackendServiceURL(url), isBackendServiceURL, url);\n        // log.log('P2P - includes runtimeURL: ', url.includes(_this.runtimeURL));\n        // log.log('P2P - includes p2phandler: ', url.includes('/p2phandler/'));\n        // log.log('P2P - includes p2prequester: ', url.includes('/p2prequester/'));\n        // Skip p2p procedure when not supported by the Runtime or for backend services\n\n        if (!_this.p2pHandlerStub[_this.runtimeURL] || isBackendServiceURL(url) || url.includes(_this.runtimeURL) || url.includes('/p2phandler/') || url.includes('/p2prequester/')) {\n          Registry_log.info('[Registry - resolve] - Resolve normal stub: ', _this.p2pHandlerStub, _this.runtimeURL, isBackendServiceURL(url), p2p, url);\n\n          _this.resolveNormalStub(url).then(function (returnURL) {\n            resolve(returnURL);\n          });\n        } else {\n          Registry_log.info('[Registry - resolve] - checkP2P: ', p2p, url, _this._p2pConnectionResolve);\n\n          _this._p2pConnectionResolve.checkP2P(msg).then(function (registeredP2P) {\n            // log.log('[Registry - resolve] found registered P2P: ', registeredP2P);\n            var p2pConnection = _this.p2pConnectionList[registeredP2P.runtime];\n\n            if (!p2pConnection) {\n              p2pConnection = registeredP2P;\n              _this.p2pConnectionList[registeredP2P.runtime] = p2pConnection;\n            }\n\n            switch (p2pConnection.status) {\n              case STATUS.LIVE:\n                msg.body.peer = registeredP2P.runtime;\n                resolve(p2pConnection.url, msg);\n                break;\n\n              case STATUS.CREATED: // p2p connection setup is ongoing, use MN Stub\n\n              case STATUS.PROGRESS:\n                _this.resolveNormalStub(url).then(function (returnURL) {\n                  resolve(returnURL);\n                });\n\n                break;\n\n              case STATUS.DISCONNECTED:\n                // p2p connection stub was disconnected, let's ask to connect again\n                Registry_log.info('[Registry - Resolve] - p2pConnection is disconnected lets try to reconnect');\n\n                _this._p2pConnectionResolve.reconnectP2PRequester(p2pConnection).then(function (returnURL) {\n                  // log.log('[Registry - Resolve] - was reconnected with p2pRequesterStubt: ', returnURL);\n                  resolve(returnURL);\n                }, function (reason) {\n                  Registry_log.info('[Registry - Resolve] - Reason: ', reason);\n\n                  _this.resolveNormalStub(url).then(function (returnURL) {\n                    resolve(returnURL);\n                  });\n                });\n\n                break;\n\n              default:\n                Registry_log.info('[Registry - resolve] - P2P: ', p2p);\n\n                if (!p2p) {\n                  // no p2p connection exists and the message sender does not ask one. Lets use the MN Stub\n                  _this.resolveNormalStub(url).then(function (returnURL) {\n                    resolve(returnURL);\n                  });\n                } else {\n                  _this._setupP2PRequester(registeredP2P).then(function (returnURL) {\n                    // no p2p connection exists but the message sender is asking one. Lets try to setup one\n                    resolve(returnURL);\n                  }, function (reason) {\n                    Registry_log.info('[Registry - Resolve] - Reason: ', reason);\n\n                    _this.resolveNormalStub(url).then(function (returnURL) {\n                      resolve(returnURL);\n                    });\n                  });\n                }\n\n                break;\n            }\n          }, function (reason) {\n            Registry_log.info('[Registry - Resolve] - Reason: ', reason);\n\n            _this.resolveNormalStub(url).then(function (returnURL) {\n              resolve(returnURL);\n            });\n          });\n        }\n      });\n    }\n  }, {\n    key: \"_setupP2PRequester\",\n    value: function _setupP2PRequester(input) {\n      var _this = this;\n\n      Registry_log.log('[Registry._setupP2PConnection] loadStub with p2pRequester: ', input);\n      return new Promise(function (resolve, reject) {\n        var remoteRuntime = input.runtime;\n        var p2pConfig = {\n          remoteRuntimeURL: remoteRuntime,\n          p2pHandler: input.p2pHandler,\n          p2pRequesterStub: true\n        }; // lets prepare the p2pRequesterSTub deployment by setting an observer to its status changes\n\n        _this.watchingYou.observe('p2pRequesterStub', function (change) {\n          Registry_log.log('[Registry._setupP2PConnection] p2pRequesterStubs changed ' + _this.p2pRequesterStub);\n\n          if (change.keypath.split('.')[0] === remoteRuntime && change.name === 'status' && change.newValue === STATUS.LIVE) {\n            Registry_log.log('[Registry._setupP2PConnection] p2pRequester is live ' + _this.p2pRequesterStub[remoteRuntime]);\n            resolve(_this.p2pRequesterStub[remoteRuntime].url);\n          }\n        }); //  stub load\n\n\n        _this.loader.loadStub(input.p2pRequester, p2pConfig).then(function () {\n          Registry_log.log('[Registry._setupP2PConnection] p2pRequester deployed: ', _this.p2pRequesterStub[remoteRuntime]);\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    }\n    /**\r\n    * To verify if url is for a legacy service.\r\n    * @param  {URL.URL}  url      url\r\n    * @return {boolean}\r\n    */\n\n  }, {\n    key: \"isLegacy\",\n    value: function isLegacy(url) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (url === _this._domain) {\n          return resolve(false);\n        }\n\n        Registry_log.log('[Registry] [Registry.Registry.isLegacy] ', url); // TODO: to be defined in the runtime configuration\n\n        var nonLegacy = ['hyperty-runtime', 'domain', 'global', 'hyperty'];\n        var urlDivided = divideURL(url);\n\n        if (nonLegacy.indexOf(urlDivided.type) !== -1 || urlDivided.domain === _this._domain) {\n          return resolve(false);\n        } // process User URLs\n\n\n        if (url.split('@').length > 1) {\n          var domain = urlDivided.domain; // log.log('[Registry] [Registry.Registry.isLegacy] domain: ', domain);\n\n          if (_this.idpLegacyProxyList.hasOwnProperty(domain)) {\n            var result = _this.idpLegacyProxyList[domain];\n\n            if (result.interworking) {\n              return resolve(result.interworking);\n            } else {\n              return resolve(false);\n            }\n          }\n\n          _this._loader.descriptors.getIdpProxyDescriptor(domain).then(function (result) {\n            // log.log('[Registry] [Registry.Registry.isLegacy] Legacy stub descriptor: ', result);\n            if (result.interworking) {\n              _this.idpLegacyProxyList[domain] = result;\n              resolve(result.interworking);\n            } else {\n              resolve(false);\n            }\n          }).catch(function (reason) {\n            Registry_log.warn('problem loading idp proxy descriptor for domain:', domain, ' because ', reason);\n            reject(reason);\n          });\n        } else {\n          // process protostub URLs\n          resolve(_this.isInterworkingProtoStub(url));\n        }\n      });\n    }\n    /**\r\n    * To verify if URL is locally registered or not.\r\n    * @param  {URL.URL}  url      url\r\n    * @return {boolean}\r\n    */\n\n  }, {\n    key: \"isLocal\",\n    value: function isLocal(url) {\n      var runtimeScheme = ['hyperty-runtime', 'runtime'];\n      var hypertyScheme = ['hyperty'];\n      var urlScheme = url.split('://')[0]; // Process Runtime Core URLs.\n      // Messages originated from protostubs should also not include the runtimeURL in its URL.\n\n      if (runtimeScheme.indexOf(urlScheme) !== -1) {\n        return url.includes(this.runtimeURL);\n      } // Process Hyperty URLs\n      // Todo: hypertiesList should be an object not an array\n\n\n      if (hypertyScheme.indexOf(urlScheme) !== -1) {\n        for (var index in this.hypertiesList) {\n          var hyperty = this.hypertiesList[index];\n\n          if (hyperty.hypertyURL === url) {\n            return true;\n          }\n        }\n\n        return false;\n      } // Process Data Object URLs\n\n\n      if (url.includes('/subscription')) {\n        url = url.substring(0, url.indexOf('/subscription'));\n      }\n\n      var dataObject = this.dataObjectList[url];\n\n      if (dataObject) {\n        if (dataObject.interworking) {\n          return !dataObject.interworking;\n        }\n\n        return true;\n      }\n\n      return false;\n    }\n    /**\r\n    * To verify if protostub is to interwork with a legacy domain.\r\n    * @param  {URL.URL}  runtimeProtostubURL      The runtime URL of the Protostub\r\n    * @return {boolean}\r\n    */\n\n  }, {\n    key: \"isInterworkingProtoStub\",\n    value: function isInterworkingProtoStub(runtimeProtostubURL) {\n      var _this = this;\n\n      if (typeof runtimeProtostubURL === 'boolean') {\n        return false;\n      }\n\n      if (!runtimeProtostubURL.includes('/protostub/')) {\n        return false;\n      }\n\n      var filtered = Object.keys(_this.protostubsList).filter(function (key) {\n        return _this.protostubsList[key].url === runtimeProtostubURL;\n      }).map(function (key) {\n        if (_this.protostubsList[key].hasOwnProperty('interworking')) {\n          return _this.protostubsList[key].interworking;\n        } else {\n          return false;\n        }\n      })[0];\n      return filtered;\n    }\n  }, {\n    key: \"loader\",\n    set: function set(loader) {\n      var _this = this;\n\n      _this._loader = loader;\n    },\n    get: function get() {\n      var _this = this;\n\n      return _this._loader;\n    }\n    /**\r\n    * return the messageBus in this Registry\r\n    * @param {MessageBus}           messageBus\r\n    */\n\n  }, {\n    key: \"messageBus\",\n    get: function get() {\n      var _this = this;\n\n      return _this._messageBus;\n    }\n    /**\r\n    * Set the messageBus in this Registry\r\n    * @param {MessageBus}           messageBus\r\n    */\n    ,\n    set: function set(messageBus) {\n      var _this = this;\n\n      _this._messageBus = messageBus;\n\n      _this._messageBus.addListener(_this.registryURL, function (msg) {\n        // log.log('[Registry listener] ', msg);\n        var isHyperty = utils_isHypertyURL(msg.from);\n        var hasCriteria = msg.body.hasOwnProperty('criteria');\n        var isURLResource;\n        var isUserResource;\n        var isHypertyResource;\n\n        if (msg.body.hasOwnProperty('resource') && msg.body.resource !== '.') {\n          isURLResource = isURL(msg.body.resource);\n          isUserResource = isUserURL(msg.body.resource);\n          isHypertyResource = utils_isHypertyURL(msg.body.resource);\n        }\n\n        var isDelete = msg.type === 'delete';\n        var hasName;\n        var hasUser;\n\n        if (msg.body.hasOwnProperty('value')) {\n          hasName = msg.body.value.hasOwnProperty('name');\n          hasUser = msg.body.value.hasOwnProperty('user');\n        }\n\n        if (msg.type === 'response') {\n          Registry_log.error('[Register listener] skipping ', msg);\n          return;\n        } // msg sent by identity manager library\n\n\n        var userUrl = _this._getIdentityAssociated(msg.body.resource, msg.body.criteria);\n\n        var reply = {\n          id: msg.id,\n          type: 'response',\n          to: msg.from,\n          from: msg.to,\n          body: {\n            resource: userUrl\n          }\n        };\n        reply.body.code = userUrl ? 200 : 404;\n\n        _this._messageBus.postMessage(reply);\n      }); // Install AddressAllocation\n\n\n      var addressAllocation = allocation_AddressAllocation.instance;\n      _this.addressAllocation = addressAllocation;\n      _this._domainRegistration = new registry_DomainRegistration(_this.runtimeURL, _this.registryURL, _this._domain, messageBus); // log.log('[Registry - AddressAllocation] - ', addressAllocation);\n    }\n  }]);\n\n  return Registry;\n}();\n\n/* harmony default export */ var registry_Registry = (Registry_Registry);\n// CONCATENATED MODULE: ./src/runtime/runtimeConfiguration.js\nvar runtimeConfiguration_runtimeConfiguration = {\n  // TODO this should be changed with the definition used for indexeddb\n  // look at: https://developer.mozilla.org/en-US/docs/Web/API/IDBObjectStore\n  // Now we are using the definition for Dexie; (http://dexie.org/docs/Version/Version.stores())\n  storageSchemas: {\n    capabilities: {\n      capabilities: 'key,version,value'\n    },\n    subscriptions: {\n      subscriptions: 'key,version,value'\n    },\n    runtime: {\n      'runtime:URL': 'key,version,value',\n      'p2pHandler:URL': 'key,version,value'\n    },\n    registry: {\n      'registry:DataObjectURLs': 'key,version,value',\n      'registry:HypertyURLs': 'key,version,value'\n    },\n    cryptoManager: {\n      userAsymmetricKey: 'key,version,value',\n      dataObjectSessionKeys: 'key,version,value'\n    },\n    identity: {\n      accessTokens: 'key,version,value',\n      identities: 'userURL, userProfile.email, userProfile.userURL, userProfile.name'\n    },\n    runtimeCatalogue: {\n      runtimeCatalogue: '&cguid, accessControlPolicy, constraints, dataObjects, hypertyType, objectName, sourcePackage, version'\n    },\n    policy: {\n      'rethink:activePolicy': 'key,version,value',\n      'rethink:groups': 'key,version,value',\n      'rethink:userPolicies': 'key,version,value',\n      'rethink:spPolicies': 'key,version,value'\n    },\n    syncherManager: {\n      'syncherManager:ObjectURLs': 'key,version,value',\n      'remotes': 'key,version,value'\n    },\n    hypertyResources: {\n      hypertyResources: '&resourceURL, name, contentUrl, content, created, reporter, resourceType'\n    }\n  },\n  runtimeURLS: {\n    registry: {\n      prefix: 'hyperty-runtime://',\n      suffix: 'registry'\n    },\n    identityModule: {\n      prefix: 'hyperty-runtime://',\n      suffix: '/idm'\n    },\n    runtimeUA: {\n      prefix: 'hyperty-runtime://',\n      suffix: '/ua'\n    },\n    catalogue: {\n      prefix: 'hyperty-runtime://',\n      suffix: '/catalogue'\n    },\n    graphConnector: {\n      prefix: 'hyperty-runtime://',\n      suffix: '/graph'\n    },\n    syncManager: {\n      prefix: 'hyperty-runtime://',\n      suffix: '/sm'\n    }\n  },\n  catalogueURLs: {\n    protocolstub: {\n      prefix: 'hyperty-catalogue://catalogue.',\n      suffix: '/.well-known/protocolstub/',\n      fallback: 'hyperty-catalogue://catalogue.%domain%/.well-known/protocolstub/'\n    },\n    idpProxy: {\n      prefix: 'hyperty-catalogue://catalogue.',\n      suffix: '/.well-known/idp-proxy/',\n      fallback: 'hyperty-catalogue://catalogue.%domain%/.well-known/idp-proxy/'\n    }\n  },\n  msgNodeURL: {\n    prefix: 'domain://msg-node.',\n    suffix: '',\n    hypertyAddressAllocation: '/hyperty-address-allocation',\n    objectAddressAllocation: '/object-address-allocation',\n    subscriptionManagement: '/sm'\n  },\n  domainRegistryURL: {\n    prefix: 'domain://registry.',\n    suffix: ''\n  },\n  globalRegistryURL: 'global://registry.',\n  remoteStorage: 'https://hysmart.rethink.ptinovacao.pt/backup/'\n};\n// CONCATENATED MODULE: ./src/identity/Identities.js\nfunction Identities_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Identities_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Identities_createClass(Constructor, protoProps, staticProps) { if (protoProps) Identities_defineProperties(Constructor.prototype, protoProps); if (staticProps) Identities_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar Identities_log = loglevel[\"getLogger\"]('IdentityModule');\n\n\n/**\r\n* The Identity Data Model is used to model the reTHINK User entity. The Identity data model is handled by Identity Management functionality.\r\n*\r\n*/\n\nvar Identities_Identities =\n/*#__PURE__*/\nfunction () {\n  function Identities(type, storageManager) {\n    Identities_classCallCheck(this, Identities);\n\n    var _this = this;\n\n    _this._watchingYou = new utils_WatchingYou();\n    _this._storageManager = storageManager;\n    _this._guid;\n    _this._type = type;\n    _this._identities = {};\n    _this._accessTokens = _this.watchingYou.watch('accessTokens', {}, true);\n  }\n\n  Identities_createClass(Identities, [{\n    key: \"reset\",\n    value: function reset() {\n      this._identities = {};\n      console.log(this);\n      this.currentIdentity = undefined;\n      this.defaultIdentity = undefined;\n    }\n  }, {\n    key: \"getIdentity\",\n    value: function getIdentity(identifier) {\n      return Object.assign({}, this._identities[identifier]);\n    }\n  }, {\n    key: \"loadIdentities\",\n    value: function loadIdentities() {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        _this._storageManager.get(null, null, 'identities').then(function (identities) {\n          Identities_log.info('[Identities.Load Identities] identities: ', identities);\n\n          if (identities) {\n            _this._identities = identities; // let's set as default identity the one that expires later\n\n            _this.identifiers.forEach(function (id) {\n              var timeNow = secondsSinceEpoch();\n              var identity = _this._identities[id];\n              var expires = identity.expires; //            if (!identity.hasOwnProperty('interworking')\n              //            || !identity.interworking) {\n\n              _this.defaultIdentity = id;\n\n              if (parseInt(expires) > timeNow) {\n                _this.defaultIdentity.expires = parseInt(expires);\n                _this.currentIdentity = id;\n              }\n            });\n          }\n\n          resolve();\n        });\n      });\n    }\n  }, {\n    key: \"loadAccessTokens\",\n    value: function loadAccessTokens() {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        _this._storageManager.get('accessTokens').then(function (accessTokens) {\n          if (accessTokens) _this._accessTokens = accessTokens;\n          resolve();\n        });\n      });\n    } // to confirm if this function is required when the App constraints the identity selection\n\n  }, {\n    key: \"addIdentity\",\n    value: function addIdentity(identity) {\n      var _this2 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this._isValid(identity)) {\n          var id = identity.identifiers[0];\n          Object.assign(_this2._identities[id], identity);\n\n          _this2._storeIdentity(identity).then(function () {\n            _this2._identities[id].status = 'created';\n            resolve();\n          });\n        } else {\n          reject('[Identities.addIdentity] invalid IdAssertion');\n        }\n      });\n    }\n  }, {\n    key: \"addAssertion\",\n    value: function addAssertion(assertion) {\n      var _this3 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this._isValid(assertion)) {\n          assertion.userProfile.guid = _this._guid;\n          var userUrl = assertion.userProfile.userURL;\n          if (!_this.identities[userUrl]) _this._identities[userUrl] = assertion;else _this.identities[userUrl] = assertion;\n\n          _this._store().then(function () {\n            _this3._identities[userUrl].status = 'created';\n\n            if (_this.defaultIdentity == false) {\n              _this.defaultIdentity = userUrl;\n            }\n\n            resolve(assertion);\n          });\n        } else {\n          reject('[Identities.addAssertion] invalid IdAssertion: ', assertion);\n        }\n      });\n    }\n  }, {\n    key: \"removeIdentity\",\n    value: function removeIdentity(userUrl) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        delete _this.identities[userUrl];\n\n        _this._store().then(function () {\n          resolve();\n        });\n      });\n    }\n  }, {\n    key: \"addAccessToken\",\n    value: function addAccessToken(accessToken) {\n      var _this = this;\n\n      Identities_log.info('[Identities.addAccessToken] ', accessToken);\n      return new Promise(function (resolve, reject) {\n        if (_this._isValidAccessToken(accessToken)) {\n          //        let newAccessToken = deepClone(accessToken);\n          _this._accessTokens[accessToken.domain] = accessToken;\n\n          _this._storeAccessTokens().then(function () {\n            _this._accessTokens[accessToken.domain].status = 'created';\n            resolve(accessToken);\n          });\n        } else {\n          reject('[Identities.addIdentity] invalid AccessToken: ', accessToken);\n        }\n      });\n    }\n  }, {\n    key: \"setAccessTokenInProgress\",\n    value: function setAccessTokenInProgress(domain) {\n      if (this._accessTokens[domain]) this._accessTokens[domain].status = 'in-progress';else this._accessTokens[domain] = {\n        status: 'in-progress'\n      };\n    }\n  }, {\n    key: \"getAccessToken\",\n    value: function getAccessToken(domain, resources) {\n      var accessToken = this._accessTokens[domain];\n\n      if (!accessToken) {\n        return undefined;\n      } else if (resources.every(function (i) {\n        return accessToken.resources.indexOf(i) != -1;\n      })) {\n        return this._accessTokens[domain];\n      } else {\n        return new Error('[Identities.getAccessToken] Not found for ', domain);\n      }\n    }\n  }, {\n    key: \"updateAssertion\",\n    value: function updateAssertion(assertion) {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        var userUrl = assertion.userProfile.userURL;\n\n        if (!_this.identities[userUrl]) {\n          return reject('[Identities.updateAssertion] Identity not found for ', userUrl);\n        } else {\n          _this.identities[userUrl] = assertion;\n\n          _this._store().then(function () {\n            resolve();\n          });\n        }\n      });\n    }\n  }, {\n    key: \"updateAccessToken\",\n    value: function updateAccessToken(accessToken) {\n      var _this = this;\n\n      Identities_log.info('[Identities.updateAccessToken] ', accessToken);\n      return new Promise(function (resolve, reject) {\n        if (_this._isValidAccessToken(accessToken)) {\n          _this._accessTokens[accessToken.domain].expires = accessToken.expires;\n          _this._accessTokens[accessToken.domain].accessToken = accessToken.accessToken;\n\n          _this._storeAccessTokens().then(function () {\n            _this._accessTokens[accessToken.domain].status = 'created';\n            resolve(accessToken);\n          });\n        } else {\n          reject('[Identities.updateAccessToken] invalid AccessToken: ', accessToken);\n        }\n      });\n    }\n  }, {\n    key: \"addIdAssertion\",\n    value: function addIdAssertion(identifier, assertion, idp, scope) {\n      var _this = this;\n\n      var newIdAssertion = new IdAssertion(assertion, idp, scope);\n\n      _this.idAssertionList.push(newIdAssertion);\n    } //TODO: complete with more verifications. To be moved to Identity?\n\n  }, {\n    key: \"_isValid\",\n    value: function _isValid(identity) {\n      if (!identity.hasOwnProperty('assertion')) {\n        return false;\n      }\n\n      var splitedAssertion = identity.assertion.split('.');\n      var assertionParsed; //verify if the token contains the 3 components, or just the assertion\n\n      try {\n        if (splitedAssertion[1]) {\n          assertionParsed = decode(splitedAssertion[1]);\n        } else {\n          assertionParsed = decode(identity.assertion);\n        }\n      } catch (err) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"_isValidAccessToken\",\n    value: function _isValidAccessToken(accessToken) {\n      if (!accessToken.hasOwnProperty('accessToken')) {\n        return false;\n      }\n\n      if (!accessToken.hasOwnProperty('domain')) {\n        return false;\n      }\n\n      if (!(accessToken.hasOwnProperty('resources') && Array.isArray(accessToken.resources))) {\n        return false;\n      }\n\n      if (!(accessToken.hasOwnProperty('expires') && Number.isInteger(accessToken.expires))) {\n        return false;\n      }\n\n      if (!accessToken.hasOwnProperty('input')) {\n        return false;\n      }\n\n      return true;\n    } //TODO: add function to only set one new identity using the new indexed storage manager\n\n  }, {\n    key: \"_store\",\n    value: function _store() {\n      var _this4 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var store = Object.keys(_this4._identities).map(function (userURL) {\n          return _this._storageManager.set(userURL, 0, _this4._identities[userURL], 'identities');\n        });\n        Promise.all(store).then(function () {\n          resolve();\n        }).catch(function (err) {\n          reject('On _sendReporterSessionKey from method storeIdentity error: ' + err);\n        });\n      });\n    }\n  }, {\n    key: \"_storeAccessTokens\",\n    value: function _storeAccessTokens() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var accessTokens = deepClone(_this._accessTokens);\n\n        _this._storageManager.set('accessTokens', 0, accessTokens).then(function () {\n          resolve();\n        }).catch(function (err) {\n          reject('On _sendReporterSessionKey from method storeIdentity error: ' + err);\n        });\n      });\n    }\n  }, {\n    key: \"identities\",\n    get: function get() {\n      return this._identities;\n    }\n  }, {\n    key: \"accessTokens\",\n    get: function get() {\n      return this._accessTokens;\n    }\n  }, {\n    key: \"watchingYou\",\n    get: function get() {\n      return this._watchingYou;\n    }\n  }, {\n    key: \"guid\",\n    set: function set(guid) {\n      this._guid = guid;\n    },\n    get: function get() {\n      return this._guid;\n    }\n  }, {\n    key: \"defaultIdentity\",\n    set: function set(identifier) {\n      if (this.identities[identifier]) this._defaultIdentity = identifier;else throw new Error('[Identities.set defaultIdentity ] Error: identity does not exist here: ', identifier);\n    },\n    get: function get() {\n      if (this._defaultIdentity) return Object.assign({}, this.identities[this._defaultIdentity]);else return false;\n    }\n  }, {\n    key: \"currentIdentity\",\n    set: function set(identifier) {\n      if (this.identities[identifier]) this._currentIdentity = identifier;else throw '[Identities.set currentIdentity ] Error: identity does not exist here: ', identifier;\n    },\n    get: function get() {\n      return Object.assign({}, this.identities[this._currentIdentity]);\n    }\n  }, {\n    key: \"identifiers\",\n    get: function get() {\n      return Object.keys(this._identities);\n    }\n  }]);\n\n  return Identities;\n}(); // move to Identity service framework?\n\n\nvar IdAssertion =\n/*#__PURE__*/\nfunction () {\n  function IdAssertion(assertion, idp, userProfile) {\n    Identities_classCallCheck(this, IdAssertion);\n\n    var _this = this;\n\n    _this._assertion = assertion;\n    _this._idp = idp;\n    _this._userProfile = userProfile;\n  }\n\n  Identities_createClass(IdAssertion, [{\n    key: \"assertion\",\n    get: function get() {\n      return this._assertion;\n    }\n  }, {\n    key: \"idp\",\n    get: function get() {\n      return this._idp;\n    }\n  }, {\n    key: \"userProfile\",\n    get: function get() {\n      return this._userProfile;\n    }\n  }]);\n\n  return IdAssertion;\n}();\n\nvar IdValidation =\n/*#__PURE__*/\nfunction () {\n  function IdValidation(identity, contents) {\n    Identities_classCallCheck(this, IdValidation);\n\n    var _this = this;\n\n    _this.identity = identity;\n    _this.contents = contents;\n  }\n\n  Identities_createClass(IdValidation, [{\n    key: \"validates\",\n    value: function validates(identity, contents) {//TODO implement the logic\n    }\n  }]);\n\n  return IdValidation;\n}();\n\n/* harmony default export */ var identity_Identities = (Identities_Identities);\n// CONCATENATED MODULE: ./src/identity/GuiFake.js\nfunction GuiFake_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Log System\n\nvar GuiFake_log = loglevel[\"getLogger\"]('IdentityModule');\n/**\r\n* fake class for the gui to select the identity,\r\n* TODO replace with the proper identity GUI\r\n*\r\n*/\n\nvar GuiFake = function GuiFake(url, messageBus) {\n  GuiFake_classCallCheck(this, GuiFake);\n\n  GuiFake_log.log('FakeGUI_deployed');\n\n  var _this = this;\n\n  _this._url = url;\n  _this._waitTime = 10000;\n  _this._messageBus = messageBus;\n\n  _this._messageBus.addListener(_this._url, function (msg) {\n    if (msg.hasOwnProperty('type') && msg.type === 'create' && msg.body.hasOwnProperty('value') && msg.body.value.hasOwnProperty('identities') && msg.body.value.hasOwnProperty('idps')) {\n      var identities = msg.body.value.identities;\n      var idps = msg.body.value.idps;\n      var value;\n\n      if (identities[0] !== undefined) {\n        value = {\n          type: 'identity',\n          value: identities[0],\n          code: 200\n        };\n      } else {\n        value = {\n          type: 'idp',\n          value: idps[2].domain,\n          code: 200\n        };\n      }\n\n      var replyMsg = {\n        id: msg.id,\n        type: 'response',\n        to: msg.from,\n        from: msg.to,\n        body: value\n      }; // to test on the identity side the listener without the timeout\n      // can represent the time the user takes to choose and identity\n\n      if (msg.body.value === 'wait') {\n        setTimeout(function () {\n          _this._messageBus.postMessage(replyMsg);\n        }, _this._waitTime);\n      } else {\n        _this._messageBus.postMessage(replyMsg);\n      }\n    } else {\n      GuiFake_log.log('Ignoring messages not intended to FakeGUI.', msg);\n    }\n  });\n};\n\n/* harmony default export */ var identity_GuiFake = (GuiFake);\n// CONCATENATED MODULE: ./src/identity/IdentityModule.js\nfunction IdentityModule_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction IdentityModule_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction IdentityModule_createClass(Constructor, protoProps, staticProps) { if (protoProps) IdentityModule_defineProperties(Constructor.prototype, protoProps); if (staticProps) IdentityModule_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar IdentityModule_log = loglevel[\"getLogger\"]('IdentityModule');\n\n\n\n\n/**\r\n*\r\n* The Identity Module (Id Module) is the component responsible for handling the\r\n* user identity and the association of this identity with the Hyperty instances,\r\n* in order to make Hyperty instances identifiable. The identity in the reTHINK project\r\n* is not fixed to a unique Identity Service Provider, but obtained through several\r\n* different Identity sources. With this approach, the Id Module provides to the user the\r\n* option to choose the preferred method for authentication.\r\n* This module will thus able to support multiple Identity acquisition methods,\r\n* such as OpenID connect 1.0, Kerberos System, or authentication through smart cards.\r\n* For example, a user with a Google account can use the Google as an Identity Provider to provide Identity Tokens,\r\n*  which can be used by the Identity Module to associate it with a Hyperty instance.\r\n*\r\n* The Identity Module uses a node package, the HelloJS, which is a client-side JavaScript API for authentication\r\n* that facilitates the requests for the OpenID connect protocol. This method allows for some abstraction\r\n* when making requests for different Identity Providers, such as OpenID connect used by Google, Facebook, Microsoft, for example.\r\n*\r\n* When a request for a user identity is made using the method loginWithRP(identifier, scope),\r\n* this method will analyse the Identity Provider chosen to obtain an identity and will use the HelloJS node package\r\n* with the selected Identity Provider and identity scope. After the HelloJS request for an Access Token\r\n* to the Identity Providers, the user will be prompted to authenticate towards the Identity Provider.\r\n* Upon receiving the Access Token, this token is validated with a RESTful web service request to an endpoint\r\n* on the Identity Provider Authorization Server, and after the validation is done,\r\n* an ID token is obtained with the information according to the scope required.\r\n* This ID token is then preserved in this module that can obtained through the getIdentities()\r\n* and is passed as return value of the loginWithRP function. The methods generateAssertion and validateAssertion have not yet been developed.\r\n*\r\n*/\n\nvar IdentityModule_IdentityModule =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * This is the constructor to initialise the Identity Module it does not require any input.\r\n  */\n  function IdentityModule(runtimeURL, runtimeCapabilities, storageManager, dataObjectsStorage, cryptoManager, runtimeCatalogue) {\n    IdentityModule_classCallCheck(this, IdentityModule);\n\n    var _this = this;\n\n    if (!runtimeURL) throw new Error('runtimeURL is missing.');\n    if (!storageManager) throw new Error('storageManager is missing');\n    if (!cryptoManager) throw new Error('cryptoManager is missing');\n    if (!runtimeCatalogue) throw new Error('runtimeCatalogue is missing');\n    _this._runtimeURL = runtimeURL;\n    _this._runtimeCatalogue = runtimeCatalogue;\n    _this.dataObjectsStorage = dataObjectsStorage;\n    _this._idmURL = _this._runtimeURL + '/idm';\n    _this._guiURL = _this._runtimeURL + '/identity-gui';\n    _this.runtimeCapabilities = runtimeCapabilities;\n    _this._domain = divideURL(_this._runtimeURL).domain; //to store items with this format: {identity: identityURL, token: tokenID}\n\n    _this._identities = new identity_Identities('human', storageManager); // to be reviewed: watchingYou identitiesList or identities?\n    //    _this.identitiesList = _this.watchingYou.watch('identitiesList', {}, true);\n\n    _this._crypto = cryptoManager;\n    /*    _this.emailsList = [];\r\n    let newIdentity = new Identity('guid', 'HUMAN');\r\n    _this.identity = newIdentity;\r\n    _this.currentIdentity;\r\n    _this.identities.defaultIdentity;*/\n    //stores the association of the dataObject and the Hyperty registered within\n\n    _this.dataObjectsIdentity = {}; // is this needed?\n\n    _this._listOfIdps = []; // variable to know if the GUI is deployed to choose the identity. if the real GUI is not deployed, a fake gui is deployed instead.\n\n    _this.guiDeployed = false;\n  } //******************* GET AND SET METHODS *******************\n\n  /**\r\n  * return the messageBus in this Registry\r\n  * @param {MessageBus}           messageBus\r\n  */\n\n\n  IdentityModule_createClass(IdentityModule, [{\n    key: \"getIdentity\",\n    //******************* IDENTITY RELEATED METHODS *******************\n\n    /**\r\n    * gets all the information from a given userURL\r\n    * @param  {String}  userURL     user url\r\n    * @return {JSON}    identity    identity bundle from the userURL\r\n    */\n    value: function getIdentity(userURL) {\n      return this.identities.getIdentity(userURL);\n    }\n    /**\r\n    * Function to set the current Identity with a given Identity\r\n    * @param {Identity}        identity         identity\r\n    */\n\n    /*  setCurrentIdentity(identity) {\r\n      let _this = this;\r\n      _this.currentIdentity = identity;\r\n    }*/\n\n    /**\r\n    * Function to return all the identities registered within a session by a user.\r\n    * These identities are returned in an array containing a JSON package for each user identity.\r\n    * @return {Array<Identities>}         Identities\r\n    */\n\n  }, {\n    key: \"getIdentitiesToChoose\",\n    value: function getIdentitiesToChoose() {\n      var _this2 = this;\n\n      //    let identities = _this.identities.identifiers;\n      // let idps = [\n      //   { domain: 'google.com', type: 'idToken'},\n      //   { domain: 'microsoft.com', type: 'idToken'},\n      //   { domain: 'orange.fr', type: 'idToken'},\n      //   { domain: 'slack.com', type: 'Legacy'}\n      // ];\n      // todo: retrieve available idps from runtime catalogue\n      // todo: enable oauth idps\n      // let idps = [\n      //   { domain: 'google.com', type: 'idToken' },\n      //   { domain: 'microsoft.com', type: 'idToken' },\n      //   { domain: 'facebook.com', type: 'idToken' },\n      //   { domain: 'slack.com', type: 'idToken' }\n      // ];\n      return new Promise(function (resolve) {\n        var url = runtimeConfiguration_runtimeConfiguration.catalogueURLs.idpProxy.prefix + _this2._domain + runtimeConfiguration_runtimeConfiguration.catalogueURLs.idpProxy.suffix;\n        Promise.all([_this2.runtimeCapabilities.isAvailable('browser'), _this2.runtimeCapabilities.isAvailable('node')]).then(function (result) {\n          var isBrowser = result[0];\n          var isNode = result[1];\n          var constraints = {\n            constraints: {}\n          };\n          constraints.constraints.node = isNode;\n          constraints.constraints.browser = isBrowser;\n\n          _this2._runtimeCatalogue.getTypeList(url, constraints).then(function (idps) {\n            var listOfIdps = idps.map(function (key) {\n              return {\n                domain: key,\n                type: 'idToken'\n              };\n            });\n            IdentityModule_log.info('[IdentityModule.getIdentityAssertion:getIdentitiesToChoose]', idps, listOfIdps);\n            _this2._listOfIdps = listOfIdps;\n            return resolve({\n              defaultIdentity: _this2.identities.defaultIdentity,\n              identities: _this2.identities.identities,\n              idps: listOfIdps\n            });\n          });\n        });\n      });\n    }\n    /**\r\n    * Function to return the selected Identity within a session\r\n    * @return {Identity}        identity         identity\r\n    */\n\n    /*  getCurrentIdentity() {\r\n      let _this = this;\r\n      return _this.currentIdentity;\r\n    }*/\n\n  }, {\n    key: \"init\",\n    value: function init(guid) {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        _this._identities.loadIdentities().then(function () {\n          if (!guid) {\n            _this._crypto.getMyPublicKey().then(function (key) {\n              var hash = _this._crypto.crypto._sha256(stringify(key)).then(function (hash) {\n                guid = 'user-guid://' + hash;\n                _this.identities.guid = guid;\n\n                _this._identities.loadAccessTokens().then(function () {\n                  resolve();\n                });\n              }).catch(function (error) {\n                console.log('[IdentityModule] error', error);\n              });\n            });\n          } else {\n            _this.identities.guid = guid;\n\n            _this._identities.loadAccessTokens().then(function () {\n              resolve();\n            });\n          }\n        });\n      });\n    }\n    /**\r\n    * Function that fetch an identityAssertion from a user.\r\n    *\r\n    * @return {IdAssertion}              IdAssertion\r\n    */\n\n  }, {\n    key: \"getIdentityAssertion\",\n    value: function getIdentityAssertion(identityBundle) {\n      IdentityModule_log.log('[IdentityModule.getIdentityAssertion:identityBundle]', identityBundle);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //CHECK whether is browser environment or nodejs\n        //if it is browser, then create a fake identity\n        _this.runtimeCapabilities.isAvailable('browser').then(function (result) {\n          IdentityModule_log.log('runtime browser identity acquisition', result);\n          if (!result) return; //todo: only idp should be mandatory when identityBundle exists\n\n          if (identityBundle && identityBundle.hasOwnProperty('idp')) {\n            var idp = identityBundle.idp;\n            var origin = identityBundle.hasOwnProperty('origin') ? identityBundle.origin : 'origin';\n            var idHint = identityBundle.hasOwnProperty('idHint') ? identityBundle.idHint : '';\n\n            if (_this.identities.defaultIdentity) {\n              var assertion = _this.identities.defaultIdentity;\n\n              if (assertion.expires > secondsSinceEpoch()) {\n                return resolve(assertion);\n              } else if (assertion.hasOwnProperty('refresh')) {\n                IdentityModule_log.log('[Identity.IdentityModule.getIdentityAssertion] refreshing assertion: ', assertion);\n\n                _this._refreshIdAssertion().then(function (newAssertion) {\n                  IdentityModule_log.log('[IdentityModule.getIdentityAssertion] refreshed assertion.', newAssertion);\n                  return resolve(newAssertion);\n                }, function (error) {\n                  IdentityModule_log.error('[IdentityModule.getIdentityAssertion] error on refresIdAssertion: ', error, ' Asking for a new IdAssertion.');\n\n                  _this._getIdAssertionForDomain(origin, idp, idHint).then(function (assertion) {\n                    resolve(assertion);\n                  }, function (error) {\n                    reject(error);\n                  });\n                });\n              } else {\n                _this._getIdAssertionForDomain(origin, idp, idHint).then(function (assertion) {\n                  resolve(assertion);\n                }, function (error) {\n                  reject(error);\n                });\n              }\n            } else {\n              _this._getIdAssertionForDomain(origin, idp, idHint).then(function (assertion) {\n                resolve(assertion);\n              }, function (error) {\n                reject(error);\n              });\n            }\n          } else if (_this.identities.defaultIdentity) {\n            var _assertion = _this.identities.defaultIdentity;\n\n            if (_assertion.expires > secondsSinceEpoch()) {\n              return resolve(_assertion);\n            } else if (_assertion.hasOwnProperty('refresh')) {\n              IdentityModule_log.log('[Identity.IdentityModule.getValidToken] refreshing assertion: ', _assertion);\n\n              _this._refreshIdAssertion(_assertion).then(function (newAssertion) {\n                IdentityModule_log.log('[IdentityModule.getIdentityAssertion] refreshed assertion.', newAssertion);\n                return resolve(newAssertion);\n              }, function (error) {\n                IdentityModule_log.error('[IdentityModule.getIdentityAssertion] error on refresIdAssertion: ', error, ' Asking for a new IdAssertion.');\n\n                _this.selectIdentityFromGUI().then(function (assertion) {\n                  IdentityModule_log.log('[IdentityModule] Identity selected from GUI.');\n                  _this.identities.defaultIdentity = assertion.userProfile.userURL;\n                  return resolve(assertion);\n                }, function (err) {\n                  return reject(err);\n                });\n              });\n            } else {\n              _this.selectIdentityFromGUI().then(function (assertion) {\n                IdentityModule_log.log('[IdentityModule] Identity selected from GUI.');\n                _this.identities.defaultIdentity = assertion.userProfile.userURL;\n                return resolve(assertion);\n              }, function (err) {\n                return reject(err);\n              });\n            }\n          } else {\n            _this.selectIdentityFromGUI().then(function (assertion) {\n              IdentityModule_log.log('[IdentityModule] Identity selected from GUI.');\n              _this.identities.defaultIdentity = assertion.userProfile.userURL;\n              return resolve(assertion);\n            }, function (err) {\n              return reject(err);\n            });\n          }\n        }).catch(function (error) {\n          IdentityModule_log.error('Error on identity acquisition ', error);\n          return reject(error);\n        });\n\n        _this.runtimeCapabilities.isAvailable('node').then(function (result) {\n          IdentityModule_log.log('node identity acquisition', result);\n          if (!result) return;\n\n          if (_this.identities.currentIdentity) {\n            //TODO verify whether the token is still valid or not.\n            // should be needed to make further requests, to obtain a valid token\n            return resolve(_this.identities.currentIdentity);\n          } else {\n            IdentityModule_log.log('getIdentityAssertion for nodejs');\n            var idp = {\n              type: 'idp',\n              value: 'nodejs-idp',\n              code: 200,\n              auth: false\n            };\n\n            _this.callNodeJsGenerateMethods(idp.value, 'origin').then(function (value) {\n              resolve(value);\n            }, function (err) {\n              reject(err);\n            });\n          }\n        }).catch(function (error) {\n          IdentityModule_log.error('Error on identity acquisition ', error);\n          reject(error);\n        });\n      });\n    }\n  }, {\n    key: \"_getIdAssertionForDomain\",\n    value: function _getIdAssertionForDomain(origin, idp, idHint) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.selectIdentityForHyperty(origin, idp, idHint).then(function (assertion) {\n          IdentityModule_log.log('[IdentityModule._getIdAssertionForDomain] Identity selected by hyperty.');\n          return resolve(assertion);\n        }, function (err) {\n          // if it got an error then just select identity from GUI\n          // log.error('[IdentityModule] Could not select identity from hyperty.');\n          _this.selectIdentityFromGUI().then(function (newAssertion) {\n            IdentityModule_log.log('[IdentityModule._getIdAssertionForDomain] Identity selected by hyperty.');\n            return resolve(newAssertion);\n          }, function (err) {\n            return reject(err);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"_refreshIdAssertion\",\n    value: function _refreshIdAssertion(assertion) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.sendRefreshMessage(assertion).then(function (newAssertion) {\n          IdentityModule_log.log('[Identity.IdentityModule.getValidToken] refreshed assertion: ', newAssertion);\n\n          _this.identities.updateAssertion(newAssertion).then(function () {\n            resolve(newAssertion);\n          }, function (err) {\n            IdentityModule_log.error('[IdentityModule.getValidToken] error updating the assertion ', err);\n            reject(err);\n          });\n        }, function (err) {\n          IdentityModule_log.error('[IdentityModule.getValidToken] error refreshing the assertion ', err);\n          reject(err);\n        });\n      });\n    }\n    /**\r\n    * Function to return all the users URLs registered within a session\r\n    * These users URLs are returned in an array of strings.\r\n    * @return {Array<String>}         users\r\n    */\n\n  }, {\n    key: \"getUsersIDs\",\n    value: function getUsersIDs() {\n      /*  log.log('[getUsersIDs:emailFormat]', emailFormat);\r\n        log.log('getUsersIDs:emailFormat', emailFormat);\r\n        let _this = this;\r\n        let users = [];*/\n      //if request comes with the emailFormat option, then convert url to email format\n\n      /*    let converter = (emailFormat) ? getUserEmailFromURL : (value) => { return value; };\r\n        for (let index in _this.identities) {\r\n        let identity = _this.identities[index];\r\n        users.push(converter(identity.identity));\r\n      }*/\n      return this.identities.identifiers;\n    }\n    /**\r\n    * Function to remove an identity\r\n    * @param {String}    userURL      userURL\r\n    * @return {Promise}\r\n    */\n\n  }, {\n    key: \"deleteIdentity\",\n    value: function deleteIdentity(userURL) {\n      return this.identities.removeIdentity(userURL);\n    }\n    /**\r\n    * Function to unregister an identity from the emailsList array and not show in to the GUI\r\n    * @param {String}    email      email\r\n    */\n\n    /*  unregisterIdentity(email) {\r\n      let _this = this;\r\n        for (let e in _this.emailsList) {\r\n        if (_this.emailsList[e] === email) {\r\n          _this.emailsList.splice(e, 1);\r\n        }\r\n      }\r\n    }*/\n    // to be used when runtime is not executed in a sandbox\n\n  }, {\n    key: \"listenShowAdmin\",\n    value: function listenShowAdmin(callback) {\n      this._showAdmin = callback;\n    }\n    /**\r\n    * Function that sends a request to the GUI using messages. Sends all identities registered and\r\n    * the Idps supported, and return the identity/idp received by the GUI\r\n    * @param {Array<identity>}  identities      list of identitiies\r\n    * @param {Array<String>}    idps            list of idps to authenticate\r\n    * @return {Promise}         returns a chosen identity or idp\r\n    */\n\n  }, {\n    key: \"requestIdentityToGUI\",\n    value: function requestIdentityToGUI(identities, idps) {\n      IdentityModule_log.log('[IdentityModule.requestIdentityToGUI:identities]', identities);\n      IdentityModule_log.log('[IdentityModule.requestIdentityToGUI:idps]', idps);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //condition to check if the real GUI is deployed. If not, deploys a fake gui\n        if (_this.guiDeployed === false) {\n          var guiFakeURL = _this._guiURL;\n          var guiFake = new identity_GuiFake(guiFakeURL, _this._messageBus);\n          _this.guiFake = guiFake;\n          _this.guiDeployed = true;\n        }\n\n        var message = {\n          type: 'create',\n          to: _this._guiURL,\n          from: _this._idmURL,\n          body: {\n            value: {\n              identities: identities,\n              idps: idps\n            }\n          }\n        };\n\n        var callback = function callback(msg) {\n          _this._messageBus.removeResponseListener(_this._idmURL, msg.id); // todo: to return the user URL and not the email or identifier\n\n\n          if (msg.body.code === 200) {\n            var selectedIdentity = msg.body;\n            IdentityModule_log.log('selectedIdentity: ', selectedIdentity.value);\n            resolve(selectedIdentity);\n          } else {\n            reject('error on requesting an identity to the GUI');\n          }\n        }; //postMessage with callback but without timeout\n\n\n        try {\n          _this._messageBus.postMessage(message, callback, false);\n        } catch (err) {\n          reject('In method callIdentityModuleFunc error: ' + err);\n        }\n      });\n    }\n  }, {\n    key: \"callNodeJsGenerateMethods\",\n    value: function callNodeJsGenerateMethods(idp, origin) {\n      IdentityModule_log.log('[callNodeJsGenerateMethods:idp]', idp);\n      IdentityModule_log.log('[callNodeJsGenerateMethods:origin]', origin);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //debugger;\n        var publicKey; //let keyPair = nodeJSKeyPairPopulate;\n        //generates the RSA key pair\n\n        _this._crypto.getMyPublicKey().then(function (key) {\n          IdentityModule_log.log('[callNodeJsGenerateMethods:key]', key);\n          publicKey = stringify(key);\n          IdentityModule_log.log('[callNodeJsGenerateMethods] NO_URL');\n          return _this.generateAssertion(publicKey, origin, 'url', idp);\n        }).then(function (value) {\n          if (value) {\n            resolve(value);\n          } else {\n            reject('Error on obtaining Identity');\n          }\n        }).catch(function (err) {\n          IdentityModule_log.log(err);\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"callGenerateMethods\",\n    value: function callGenerateMethods(idp, origin) {\n      IdentityModule_log.log('[callGenerateMethods:idp]', idp);\n      IdentityModule_log.log('[callGenerateMethods:origin]', origin);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var publicKey; //generates the RSA key pair\n\n        _this._crypto.getMyPublicKey().then(function (key) {\n          IdentityModule_log.log('[callGenerateMethods:key]', key);\n          publicKey = stringify(key); //        userkeyPair = keyPair;\n\n          IdentityModule_log.log('generateAssertion:no_hint');\n          return _this.generateAssertion(publicKey, origin, '', idp);\n        }).then(function (url) {\n          _this.myHint = url;\n          IdentityModule_log.log('generateAssertion:hint');\n          return _this.generateAssertion(publicKey, origin, url, idp);\n        }).then(function (value) {\n          if (value) {\n            resolve(value);\n          } else {\n            reject('Error on obtaining Identity');\n          }\n        }).catch(function (err) {\n          IdentityModule_log.error(err);\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"loginSelectedIdentity\",\n    value: function loginSelectedIdentity(publicKey, origin, idp, loginUrl) {\n      IdentityModule_log.log('[loginSelectedIdentity:publicKey]', publicKey);\n      IdentityModule_log.log('[loginSelectedIdentity:origin]', origin);\n      IdentityModule_log.log('[loginSelectedIdentity:idp]', idp); //    log.log('[loginSelectedIdentity:keyPair]', keyPair);\n\n      IdentityModule_log.log('[loginSelectedIdentity:loginUrl]', loginUrl);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        IdentityModule_log.log('[IdentityModule] openPopup');\n\n        _this.callIdentityModuleFunc('openPopup', {\n          urlreceived: loginUrl\n        }).then(function (idCode) {\n          return idCode;\n        }, function (err) {\n          IdentityModule_log.error('Error while logging in for the selected identity.');\n          return reject(err);\n        }).then(function (idCode) {\n          _this.sendGenerateMessage(publicKey, origin, idCode, idp).then(function (newResponse) {\n            if (newResponse.hasOwnProperty('assertion')) {\n              _this.identities.addAssertion(newResponse).then(function (result) {\n                resolve('Login was successfull');\n              }).catch(function (err) {\n                reject('Login has failed:' + err);\n              });\n            } else {\n              IdentityModule_log.error('Error while logging in for the selected identity.');\n              return reject('Could not generate a valid assertion for selected identity.');\n            }\n          }).catch(function (err) {\n            reject('On loginSelectedIdentity from method sendGenerateMessage error:  ' + err);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"selectIdentityForHyperty\",\n    value: function selectIdentityForHyperty(origin, idp, idHint) {\n      IdentityModule_log.log('[selectIdentityForHyperty:origin]', origin);\n      IdentityModule_log.log('[selectIdentityForHyperty:idp]', idp);\n      IdentityModule_log.log('[selectIdentityForHyperty:idHint]', idHint);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //generates the RSA key pair\n        _this._crypto.getMyPublicKey().then(function (key) {\n          var publicKey = stringify(key);\n\n          _this.sendGenerateMessage(publicKey, origin, idHint, idp).then(function (response) {\n            if (response.hasOwnProperty('assertion')) {\n              // identity was logged in, just save it\n              _this.identities.addAssertion(response).then(function (value) {\n                return resolve(response);\n              }, function (err) {\n                return reject(err);\n              });\n            } else if (response.hasOwnProperty('loginUrl')) {\n              // identity was not logged in\n              _this.loginSelectedIdentity(publicKey, origin, idp, response.loginUrl).then(function (value) {\n                return resolve(value);\n              }, function (err) {\n                return reject(err);\n              });\n            } else {\n              // you should never get here, if you do then the IdP Proxy is not well implemented\n              // log.error('GenerateAssertion returned invalid response.');\n              IdentityModule_log.log('Proceeding by logging in.');\n\n              _this.callGenerateMethods(idp, origin).then(function (value) {\n                return resolve(value);\n              }, function (err) {\n                return reject(err);\n              });\n            }\n          }).catch(function (err) {\n            reject('On selectIdentityForHyperty from method sendGenerateMessage error:  ' + err);\n          });\n        }).catch(function (err) {\n          reject('On selectIdentityForHyperty from method generateRSAKeyPair error:  ' + err);\n        });\n      });\n    }\n  }, {\n    key: \"selectIdentityFromGUI\",\n    value: function selectIdentityFromGUI(origin) {\n      var _this3 = this;\n\n      IdentityModule_log.log('[IdentityModule.selectIdentityFromGUI:origin]', origin);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this3.getIdentitiesToChoose().then(function (identitiesInfo) {\n          return _this.requestIdentityToGUI(identitiesInfo.identities, identitiesInfo.idps);\n        }).then(function (value) {\n          if (value.type === 'identity') {\n            //  let chosenID = getUserURLFromEmail(value.value);\n            // hack while the user url is not returned from requestIdentityToGUI;\n\n            /*          let chosenID = 'user://' + _this.identities.currentIdentity.idp.domain + '/' + value.value;\r\n              _this.identities.defaultIdentity = _this.identities.currentIdentity;*/\n            // returns the identity info from the chosen id\n            //          if (_this.identities.currentIdentity) resolve(_this.identities.currentIdentity.assertion);\n            if (_this.identities.identities[value.value]) resolve(_this.identities.identities[value.value]);else reject('[IdentityModule.selectIdentityFromGUI] identity not found: ', value.value);\n          } else if (value.type === 'idp') {\n            _this.callGenerateMethods(value.value, origin).then(function (value) {\n              return resolve(value);\n            }, function (err) {\n              return reject(err);\n            });\n          } else {\n            return reject('error on GUI received message.');\n          }\n        }).catch(function (err) {\n          reject('On selectIdentityFromGUI from method requestIdentityToGUI error:  ' + err);\n        });\n      });\n    }\n  }, {\n    key: \"callIdentityModuleFunc\",\n    value: function callIdentityModuleFunc(methodName, parameters) {\n      IdentityModule_log.log('[callIdentityModuleFunc:methodName]', methodName);\n      IdentityModule_log.log('[callIdentityModuleFunc:parameters]', parameters);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this._showAdmin && methodName === 'getAccessToken') {\n          _this._showAdmin(methodName, parameters);\n\n          resolve(true);\n        } else {\n          var message = {\n            type: 'execute',\n            to: _this._guiURL,\n            from: _this._idmURL,\n            body: {\n              resource: 'identity',\n              method: methodName,\n              params: parameters\n            }\n          }; //post msg with callback but without timout\n\n          var callback = function callback(msg) {\n            _this._messageBus.removeResponseListener(_this._idmURL, msg.id);\n\n            var result = msg.body.value;\n            resolve(result);\n          };\n\n          try {\n            _this._messageBus.postMessage(message, callback, false);\n          } catch (err) {\n            reject('In method callIdentityModuleFunc error: ' + err);\n          }\n        }\n      });\n    } //******************* TOKEN METHODS *******************\n\n    /**\r\n    * get a Token to be added to a message\r\n    * @param  {String}  fromURL     origin of the message\r\n    * @param  {String}  toURL     target of the messageok\r\n    * @return {JSON}    token    token to be added to the message\r\n    */\n\n  }, {\n    key: \"getToken\",\n    value: function getToken(msg) {\n      var _this = this;\n\n      var fromURL = msg.from;\n      var toUrl = msg.to;\n\n      if (msg.hasOwnProperty('body') && msg.body.hasOwnProperty('source')) {\n        fromURL = msg.body.source;\n      }\n\n      if (msg.type === 'forward') {\n        fromURL = msg.body.from;\n      }\n\n      if (msg.hasOwnProperty('body') && msg.body.hasOwnProperty('subscriber')) {\n        fromURL = msg.body.subscriber;\n      }\n\n      return new Promise(function (resolve, reject) {\n        IdentityModule_log.log('[IdentityModule.getToken] for msg ', msg); //log.log('toUrl', toUrl);\n\n        _this.registry.isLegacy(toUrl).then(function (result) {\n          // log.log('[Identity.IdentityModule.getToken] isLEGACY: ', result);\n          if (result) {\n            _this._getAccessToken(msg).then(function (token) {\n              IdentityModule_log.log('[IdentityModule.getToken] access token ', token);\n              resolve(deepClone(token));\n            }).catch(function (err) {\n              reject('[IdentityModule.getToken] Access Token error ' + err);\n            });\n          } else {\n            _this._getValidToken(fromURL).then(function (token) {\n              resolve(token);\n            }).catch(function (err) {\n              reject('On getToken from method _getValidToken error: ' + err);\n            });\n          }\n        }).catch(function (err) {\n          reject('On getToken from method isLegacy error: ' + err);\n        });\n      });\n    }\n    /**\r\n    * get an Id Token for a HypertyURL\r\n    * @param  {String}  hypertyURL     the Hyperty address\r\n    * @return {JSON}    token    Id token to be added to the message\r\n    */\n\n  }, {\n    key: \"getIdToken\",\n    value: function getIdToken(hypertyURL) {\n      IdentityModule_log.info('getIdToken:hypertyURL ', hypertyURL);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var splitURL = hypertyURL.split('://');\n        var userURL;\n\n        if (splitURL[0] !== 'hyperty') {\n          // it is a Data Object URL\n          _this._getHypertyFromDataObject(hypertyURL).then(function (returnedHypertyURL) {\n            userURL = _this.registry.getHypertyOwner(returnedHypertyURL);\n\n            if (userURL) {\n              var _identity = _this.identities.getIdentity(userURL);\n\n              if (_identity) return resolve(_identity);else return reject('[IdentityModule.getIdToken] Identity not found for: ', userURL);\n            } else {\n              return reject('[IdentityModule.getIdToken] User not found for hyperty: ', returnedHypertyURL);\n            }\n          }).catch(function (reason) {\n            IdentityModule_log.error('[IdentityModule.getIdToken] Error: ', reason);\n            reject(reason);\n          });\n        } else {\n          userURL = _this.registry.getHypertyOwner(hypertyURL);\n\n          if (userURL) {\n            var _identity2 = _this.identities.getIdentity(userURL);\n\n            if (_identity2) return resolve(_identity2);else return reject('[IdentityModule.getIdToken] Identity not found for: ', userURL);\n          } else {\n            return reject('[IdentityModule.getIdToken] User not found for hyperty: ', userURL);\n          }\n        }\n      });\n    }\n    /**\r\n    * get an Access Token for an external API\r\n    * @param  {String}  url     the external url\r\n    * @return {JSON}    token    Access token to be added to the message\r\n    */\n\n  }, {\n    key: \"_getAccessToken\",\n    value: function _getAccessToken(msg) {\n      var url = msg.to;\n\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        if (!msg.hasOwnProperty('body')) {\n          return reject('[IdentityModule._getAccessToken] missing mandatory msg body: ', msg);\n        }\n\n        if (!msg.body.hasOwnProperty('value')) {\n          return reject('[IdentityModule._getAccessToken] missing mandatory msg body value: ', msg);\n        }\n\n        if (!msg.body.value.hasOwnProperty('resources')) {\n          return reject('[IdentityModule._getAccessToken] missing mandatory msg body value resources: ', msg);\n        }\n\n        var domainToCheck = divideURL(url).domain;\n\n        if (url.includes('protostub')) {\n          domainToCheck = domainToCheck.replace(domainToCheck.split('.')[0] + '.', '');\n        }\n\n        var resources = msg.body.value.resources;\n\n        _this._getAccessTokenForDomain(domainToCheck, resources).then(function (token) {\n          resolve(token);\n        });\n      });\n    }\n  }, {\n    key: \"_getAccessTokenForDomain\",\n    value: function _getAccessTokenForDomain(domainToCheck, resources) {\n      var _this = this;\n\n      var token;\n      return new Promise(function (resolve, reject) {\n        try {\n          token = _this.identities.getAccessToken(domainToCheck, resources);\n        } catch (e) {\n          return reject('[IdentityModule._getAccessTokenForDomain] Access Token error ' + err);\n        }\n\n        if (!token) {\n          _this._getNewAccessToken(domainToCheck, resources).then(function (token) {\n            IdentityModule_log.log('[Identity.IdentityModule._getAccessTokenForDomain] new Access Token ', token);\n            return resolve(token);\n          }).catch(function (err) {\n            reject('[IdentityModule._getAccessTokenForDomain] on getNewAccessToken ' + err);\n          });\n        } else if (token.status === 'in-progress') {\n          return resolve(_this._inProgressAccessToken(domainToCheck, resources));\n        } else {\n          var timeNow = secondsSinceEpoch();\n          IdentityModule_log.log('[Identity.IdentityModule._getAccessTokenForDomain] found  Access Token ', token);\n\n          if (timeNow >= token.expires) {\n            //        if (true) {\n            if (token.hasOwnProperty(\"refresh\")) {\n              _this._refreshAccessToken(deepClone(token)).then(function (newToken) {\n                return resolve(_this.identities.updateAccessToken(newToken));\n              });\n            } else return resolve(_this._getNewAccessToken(domainToCheck, resources));\n          } else return resolve(deepClone(token));\n        }\n      });\n    }\n  }, {\n    key: \"_inProgressAccessToken\",\n    value: function _inProgressAccessToken(domain, resources) {\n      var _this4 = this;\n\n      this.identities.watchingYou.observe('accessTokens', function (change) {\n        IdentityModule_log.log('[IdentityModule._inProgressAccessToken] accessTokens changed ' + _this4.identities.accessTokens);\n        var keypath = change.keypath;\n\n        if (keypath.includes('status')) {\n          keypath = keypath.replace('.status', '');\n        }\n\n        if (keypath === domain && change.name === 'status' && change.newValue === 'created') {\n          // log.log('[Identity.IdentityModule.getToken] token is created ' + _this.identitiesList[domain]);\n          return _this4.identities.getAccessToken(domain, resources);\n        }\n      });\n    }\n  }, {\n    key: \"_getNewAccessToken\",\n    value: function _getNewAccessToken(domain, resources) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.identities.setAccessTokenInProgress(domain);\n\n        var message = {\n          type: 'execute',\n          to: _this._resolveDomain(domain),\n          from: _this._idmURL,\n          body: {\n            method: 'getAccessTokenAuthorisationEndpoint',\n            params: resources\n          }\n        }; //let's first get the authorisation URL from the Idp Proxy\n\n        _this._messageBus.postMessage(message, function (res) {\n          if (res.body.code > 299) {\n            return reject('[IdentityModule._getNewAccessToken] Error on getAccessTokenAuthorisationEndpoint from IdP Proxy: ', res.body.desc);\n          } // let's ask the user for authorisation\n\n\n          _this.callIdentityModuleFunc('openPopup', {\n            urlreceived: res.body.value\n          }).then(function (authorisation) {\n            IdentityModule_log.log('[IdentityModule:callIdentityModuleFunc:openPopup] auhtorisation result: ', authorisation);\n            message.body.method = 'getAccessToken';\n            message.body.params = {\n              resources: resources,\n              login: authorisation\n            }; //wihtout callback to avoid timeout errors?\n            // let's ask Access Token from the Idp Proxy\n\n            _this._messageBus.postMessage(message, function (res) {\n              if (res.body.code > 299) return reject('[IdentityModule._getNewAccessToken] Error on getAccessToken from IdP Proxy: ', res.body.desc);\n\n              _this.identities.addAccessToken(res.body.value).then(function (token) {\n                IdentityModule_log.info('[IdentityModule._getNewAccessToken] resolving token: ', token);\n                return resolve(res.body.value);\n              }, function (err) {\n                reject(err);\n              });\n            });\n          }, function (err) {\n            reject(err);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"_refreshAccessToken\",\n    value: function _refreshAccessToken(outdatedToken) {\n      var _this = this; //    let domain = _this._resolveDomain(oldIdentity.idp);\n      //    let message;\n      //    let assertion = _this.getIdentity(oldIdentity.userProfile.userURL);\n\n\n      IdentityModule_log.log('IdentityModule._refreshAccessToken:outdatedToken', outdatedToken);\n      return new Promise(function (resolve, reject) {\n        var domain = _this._resolveDomain(outdatedToken.domain);\n\n        var message;\n        message = {\n          type: 'execute',\n          to: domain,\n          from: _this._idmURL,\n          body: {\n            method: 'refreshAccessToken',\n            params: {\n              token: outdatedToken\n            }\n          }\n        };\n\n        try {\n          _this._messageBus.postMessage(message, function (res) {\n            var result = res.body.value;\n            resolve(result);\n          });\n        } catch (err) {\n          reject('In IdentityModule._refreshAccessToken on postMessage error: ' + err);\n        }\n      });\n    }\n  }, {\n    key: \"sendRefreshMessage\",\n    value: function sendRefreshMessage(oldIdentity) {\n      var _this = this; //    let domain = _this._resolveDomain(oldIdentity.idp);\n      //    let message;\n      //    let assertion = _this.getIdentity(oldIdentity.userProfile.userURL);\n\n\n      IdentityModule_log.log('sendRefreshMessage:oldIdentity', oldIdentity);\n      return new Promise(function (resolve, reject) {\n        var domain = _this._resolveDomain(oldIdentity.idp.domain);\n\n        var message;\n\n        var assertion = _this.getIdentity(oldIdentity.userProfile.userURL);\n\n        IdentityModule_log.info('sendRefreshMessage:oldIdentity', oldIdentity);\n        message = {\n          type: 'execute',\n          to: domain,\n          from: _this._idmURL,\n          body: {\n            resource: 'identity',\n            method: 'refreshAssertion',\n            params: {\n              identity: assertion\n            }\n          }\n        };\n\n        try {\n          _this._messageBus.postMessage(message, function (res) {\n            if (res.body.code < 300) {\n              var result = res.body.value;\n              resolve(result);\n            } else resolve(res.body.value.body.params, identity);\n          });\n        } catch (err) {\n          reject('In sendRefreshMessage on postMessage error: ' + err);\n        }\n      });\n    }\n  }, {\n    key: \"getAccessToken\",\n    value: function getAccessToken(idpDomain, resources, login) {\n      IdentityModule_log.log('[getAccessToken:idpDomain]', idpDomain);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var domain = _this._resolveDomain(idpDomain);\n\n        var message;\n        message = {\n          type: 'execute',\n          to: domain,\n          from: _this._idmURL,\n          body: {\n            resource: 'identity',\n            method: 'getAccessToken',\n            params: {\n              resources: resources,\n              login: login\n            }\n          }\n        };\n\n        try {\n          _this._messageBus.postMessage(message, function (res) {\n            if (res.body.code < 299) {\n              var result = res.body.value;\n              resolve(result);\n            } else resolve(res.body);\n          });\n        } catch (err) {\n          reject('IdentityModule.In getAccessToken: ' + err);\n        }\n      });\n    }\n  }, {\n    key: \"getAccessTokenAuthorisationEndpoint\",\n    value: function getAccessTokenAuthorisationEndpoint(scope, idpDomain) {\n      IdentityModule_log.log('[getAccessTokenAuthorisationEndpoint:idpDomain]', idpDomain);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var domain = _this._resolveDomain(idpDomain);\n\n        var message;\n        message = {\n          type: 'execute',\n          to: domain,\n          from: _this._idmURL,\n          body: {\n            resource: 'identity',\n            method: 'getAccessTokenAuthorisationEndpoint',\n            params: {\n              resources: scope\n            }\n          }\n        };\n\n        try {\n          _this._messageBus.postMessage(message, function (res) {\n            var result = res.body.value;\n            resolve(result);\n          });\n        } catch (err) {\n          reject('In getAccessTokenAuthorisationEndpoint: ' + err);\n        }\n      });\n    }\n  }, {\n    key: \"sendGenerateMessage\",\n    value: function sendGenerateMessage(contents, origin, usernameHint, idpDomain) {\n      IdentityModule_log.log('[sendGenerateMessage:contents]', contents);\n      IdentityModule_log.log('[sendGenerateMessage:origin]', origin);\n      IdentityModule_log.log('[sendGenerateMessage:usernameHint]', usernameHint);\n      IdentityModule_log.log('[sendGenerateMessage:idpDomain]', idpDomain);\n      IdentityModule_log.log('sendGenerateMessage_hint');\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var domain = _this._resolveDomain(idpDomain);\n\n        var message;\n        message = {\n          type: 'execute',\n          to: domain,\n          from: _this._idmURL,\n          body: {\n            resource: 'identity',\n            method: 'generateAssertion',\n            params: {\n              contents: contents,\n              origin: origin,\n              usernameHint: usernameHint\n            }\n          }\n        };\n\n        try {\n          _this._messageBus.postMessage(message, function (res) {\n            if (res.body.code < 300) resolve(res.body.value);else reject(res.body);\n          });\n        } catch (err) {\n          reject('In sendGenerateMessage: ' + err);\n        }\n      });\n    }\n    /**\r\n    * Requests the IdpProxy from a given Domain for an identityAssertion\r\n    *\r\n    * @param  {DOMString} contents     contents\r\n    * @param  {DOMString} origin       origin\r\n    * @param  {DOMString} usernameHint usernameHint\r\n    * @param  {JSON}      keyPair       user keyPair\r\n    * @return {IdAssertion}              IdAssertion\r\n    */\n\n  }, {\n    key: \"generateAssertion\",\n    value: function generateAssertion(contents, origin, usernameHint, idpDomain) {\n      IdentityModule_log.log('[generateAssertion:contents]', contents);\n      IdentityModule_log.log('[generateAssertion:origin]', origin);\n      IdentityModule_log.log('[generateAssertion:usernameHint]', usernameHint); //    log.log('[generateAssertion:keyPair]', keyPair);\n\n      IdentityModule_log.log('[generateAssertion:idpDomain]', idpDomain);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        IdentityModule_log.log('[IdentityModule:sendGenerateMessage:sendGenerateMessage]', usernameHint);\n\n        _this.sendGenerateMessage(contents, origin, usernameHint, idpDomain).then(function (result) {\n          if (result) {\n            _this.identities.addAssertion(result).then(function (value) {\n              resolve(result);\n            }, function (err) {\n              reject(err);\n            });\n          } else {\n            reject('error on obtaining identity information');\n          }\n        }, function (error) {\n          if (error.hasOwnProperty('description') && error.description.hasOwnProperty('loginUrl')) {\n            _this.callIdentityModuleFunc('openPopup', {\n              urlreceived: error.description.loginUrl\n            }).then(function (value) {\n              IdentityModule_log.log('[IdentityModule:callIdentityModuleFunc:openPopup]', usernameHint);\n              resolve(value);\n            }, function (err) {\n              reject(err);\n            });\n          } else {\n            IdentityModule_log.error('[IdentityModule:sendGenerateMessage] generate assertion with hint error ', error);\n            reject(error);\n          }\n        }).catch(function (err) {\n          reject('On generateAssertion from method sendGenerateMessage error: ' + err);\n        });\n      });\n    }\n    /**\r\n    * Requests the IdpProxy from a given Domain to validate an IdentityAssertion\r\n    * Returns a promise with the result from the validation.\r\n    * @param  {DOMString} assertion\r\n    * @param  {DOMString} origin       origin\r\n    * @return {Promise}         Promise         promise with the result from the validation\r\n    */\n\n  }, {\n    key: \"validateAssertion\",\n    value: function validateAssertion(assertion, origin, idpDomain) {\n      IdentityModule_log.log('[validateAssertion:assertion]', assertion);\n      IdentityModule_log.log('[validateAssertion:origin]', origin);\n      IdentityModule_log.log('[validateAssertion:idpDomain]', idpDomain);\n\n      var _this = this;\n\n      var domain = _this._resolveDomain(idpDomain);\n\n      var message = {\n        type: 'execute',\n        to: domain,\n        from: _this._idmURL,\n        body: {\n          resource: 'identity',\n          method: 'validateAssertion',\n          params: {\n            assertion: assertion,\n            origin: origin\n          }\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        try {\n          _this._messageBus.postMessage(message, function (result) {\n            if (result.body.code === 200) {\n              resolve(result.body.value);\n            } else {\n              reject('error', result.body.code);\n            }\n          });\n        } catch (err) {\n          reject('On validateAssertion from method postMessage error: ' + err);\n        }\n      });\n    }\n  }, {\n    key: \"addGUIListeners\",\n    value: function addGUIListeners() {\n      var _this = this;\n\n      _this._messageBus.addListener(_this._idmURL, function (msg) {\n        var funcName = msg.body.method;\n        IdentityModule_log.log('[IdentityModule:addGUIListeners]', msg, msg.body, funcName);\n        var returnedValue;\n\n        if (funcName === 'deployGUI') {\n          returnedValue = _this.deployGUI();\n        } else if (funcName === 'getIdentitiesToChoose') {\n          _this.getIdentitiesToChoose().then(function (result) {\n            // if the function requested is not a promise\n            var value = {\n              type: 'execute',\n              value: result,\n              code: 200\n            };\n            var replyMsg = {\n              id: msg.id,\n              type: 'response',\n              to: msg.from,\n              from: msg.to,\n              body: value\n            };\n\n            try {\n              _this._messageBus.postMessage(replyMsg);\n            } catch (err) {\n              IdentityModule_log.error('On addGUIListeners from if storeIdentity method postMessage error: ' + err);\n            }\n          });\n\n          return;\n        } else if (funcName === 'unregisterIdentity') {\n          var email = msg.body.params.email;\n          returnedValue = _this.unregisterIdentity(email);\n        } else if (funcName === 'getMyPublicKey') {\n          // because generateRSAKeyPair is a promise\n          // we have to send the message only after getting the key pair\n          _this._crypto.getMyPublicKey().then(function (pubKey) {\n            pubKey = stringify(pubKey);\n            var value = {\n              type: 'execute',\n              value: pubKey,\n              code: 200\n            };\n            var replyMsg = {\n              id: msg.id,\n              type: 'response',\n              to: msg.from,\n              from: msg.to,\n              body: value\n            };\n\n            try {\n              _this._messageBus.postMessage(replyMsg);\n            } catch (err) {\n              IdentityModule_log.error('On addGUIListeners from if generateRSAKeyPair method postMessage error: ' + err);\n            }\n          });\n\n          return;\n        } else if (funcName === 'sendGenerateMessage') {\n          var contents = msg.body.params.contents;\n          var origin = msg.body.params.origin;\n          var usernameHint = msg.body.params.usernameHint;\n          var idpDomain = msg.body.params.idpDomain;\n          var _replyMsg = {\n            id: msg.id,\n            type: 'response',\n            to: msg.from,\n            from: msg.to\n          };\n\n          _this.sendGenerateMessage(contents, origin, usernameHint, idpDomain).then(function (returnedValue) {\n            var value = {\n              type: 'execute',\n              value: returnedValue,\n              code: 200\n            };\n            _replyMsg.body = value;\n\n            try {\n              _this._messageBus.postMessage(_replyMsg);\n            } catch (err) {\n              IdentityModule_log.error('IdentityModule.addGUIListeners sendGenerateMessage error: ' + err);\n            }\n          }, function (err) {\n            IdentityModule_log.info('IDPProxy generateAssertion reply error ' + err);\n            _replyMsg.body = err;\n\n            _this._messageBus.postMessage(_replyMsg);\n          });\n\n          return;\n        } else if (funcName === 'getAccessTokenAuthorisationEndpoint') {\n          var scope = msg.body.params.scope;\n          var _idpDomain = msg.body.params.idpDomain;\n\n          _this.getAccessTokenAuthorisationEndpoint(scope, _idpDomain).then(function (returnedValue) {\n            var value = {\n              type: 'execute',\n              value: returnedValue,\n              code: 200\n            };\n            var replyMsg = {\n              id: msg.id,\n              type: 'response',\n              to: msg.from,\n              from: msg.to,\n              body: value\n            };\n\n            try {\n              _this._messageBus.postMessage(replyMsg);\n            } catch (err) {\n              IdentityModule_log.error('On addGUIListeners from if sendGenerateMessage method postMessage error: ' + err);\n            }\n          });\n\n          return;\n        } else if (funcName === 'addAccessToken') {\n          var accessToken = msg.body.params;\n\n          _this.identities.addAccessToken(accessToken).then(function (returnedValue) {\n            var value = {\n              type: 'execute',\n              value: returnedValue,\n              code: 200\n            };\n            var replyMsg = {\n              id: msg.id,\n              type: 'response',\n              to: msg.from,\n              from: msg.to,\n              body: value\n            };\n\n            try {\n              _this._messageBus.postMessage(replyMsg);\n            } catch (err) {\n              IdentityModule_log.error('On addGUIListeners from if storeIdentity method postMessage error: ' + err);\n            }\n          });\n\n          return;\n        } else if (funcName === 'getAccessToken') {\n          var domain = msg.body.params.idpDomain;\n          var resources = msg.body.params.resources;\n          var login = msg.body.params.login;\n          var _replyMsg2 = {\n            id: msg.id,\n            type: 'response',\n            to: msg.from,\n            from: msg.to\n          };\n\n          _this.getAccessToken(domain, resources, login).then(function (returnedValue) {\n            var value = {\n              type: 'execute',\n              value: returnedValue,\n              code: 200\n            };\n            _replyMsg2.body = value;\n\n            try {\n              _this._messageBus.postMessage(_replyMsg2);\n            } catch (err) {\n              IdentityModule_log.error('On addGUIListeners from if sendGenerateMessage method postMessage error: ' + err);\n            }\n          }, function (error) {\n            try {\n              _replyMsg2.body = error;\n\n              _this._messageBus.postMessage(_replyMsg2);\n            } catch (err) {\n              IdentityModule_log.error('On addGUIListeners from if sendGenerateMessage method postMessage error: ' + err);\n            }\n          });\n\n          return;\n        } else if (funcName === 'addAssertion') {\n          var result = msg.body.params; //        let keyPair = msg.body.params.keyPair;\n\n          _this.identities.addAssertion(result).then(function (returnedValue) {\n            var value = {\n              type: 'execute',\n              value: returnedValue,\n              code: 200\n            };\n            var replyMsg = {\n              id: msg.id,\n              type: 'response',\n              to: msg.from,\n              from: msg.to,\n              body: value\n            };\n\n            try {\n              _this._messageBus.postMessage(replyMsg);\n            } catch (err) {\n              IdentityModule_log.error('On addGUIListeners from if storeIdentity method postMessage error: ' + err);\n            }\n          });\n\n          return;\n        } else if (funcName === 'refreshAccessToken') {\n          var _domain = msg.body.params.domain;\n          var _resources = msg.body.params.resources;\n\n          _this._getAccessTokenForDomain(_domain, _resources).then(function (token) {\n            var replyMsg = {\n              id: msg.id,\n              type: 'response',\n              to: msg.from,\n              from: msg.to,\n              body: {\n                value: token.accessToken,\n                code: 200\n              }\n            };\n\n            try {\n              _this._messageBus.postMessage(replyMsg);\n            } catch (err) {\n              IdentityModule_log.error('On addGUIListeners for refreshAccessToken request: ' + err);\n            }\n          });\n\n          return;\n        }\n        /*else if (funcName === 'selectIdentityForHyperty') {\r\n         let origin = msg.body.params.origin;\r\n         let idp = msg.body.params.idp;\r\n         let idHint = msg.body.params.idHint;\r\n         _this.selectIdentityForHyperty(origin, idp, idHint);\r\n         return;\r\n        }*/\n        // if the function requested is not a promise\n\n\n        var value = {\n          type: 'execute',\n          value: returnedValue,\n          code: 200\n        };\n        var replyMsg = {\n          id: msg.id,\n          type: 'response',\n          to: msg.from,\n          from: msg.to,\n          body: value\n        };\n\n        try {\n          _this._messageBus.postMessage(replyMsg);\n        } catch (err) {\n          IdentityModule_log.error('On addGUIListeners from if storeIdentity method postMessage error: ' + err);\n        }\n      });\n    }\n  }, {\n    key: \"deployGUI\",\n    value: function deployGUI() {\n      var _this = this;\n\n      _this.guiDeployed = true;\n    } //******************* PRIVATE METHODS *******************\n\n    /**\r\n     * GetValidToken is for non legacy hyperties and verifies if the Token is still valid\r\n     * if the token is invalid it requests a new token\r\n     * @param  {String} hypertyURL hypertyURL\r\n     * @return {Promise}\r\n     */\n\n  }, {\n    key: \"_getValidToken\",\n    value: function _getValidToken(hypertyURL) {\n      IdentityModule_log.log('[IdentityModule._getValidToken]:hypertyURL', hypertyURL);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.getIdToken(hypertyURL).then(function (assertion) {\n          IdentityModule_log.log('[IdentityModule._getValidToken] retrieved IdAssertion', assertion);\n          var timeNow = secondsSinceEpoch();\n          if (!assertion.hasOwnProperty('expires')) return resolve(assertion);\n          var expirationDate = assertion.expires;\n          /* if (completeId.hasOwnProperty('info')) {\r\n            if (completeId.info.hasOwnProperty('expires')) {\r\n              expirationDate = completeId.info.expires;\r\n            } else if (completeId.info.hasOwnProperty('tokenIDJSON')) {\r\n              expirationDate = completeId.info.tokenIDJSON.exp;\r\n            } else {\r\n              // throw 'The ID Token does not have an expiration time';\r\n              log.info('The ID Token does not have an expiration time');\r\n              resolve(assertion);\r\n            }\r\n          } else if (completeId.hasOwnProperty('infoToken') && completeId.infoToken.hasOwnProperty('exp')) {\r\n            expirationDate = completeId.infoToken.exp;\r\n          } else {\r\n            // throw 'The ID Token does not have an expiration time';\r\n            log.info('The ID Token does not have an expiration time');\r\n            resolve(assertion);\r\n          }*/\n\n          IdentityModule_log.log('[Identity.IdentityModule.getValidToken] Token expires in', expirationDate);\n          IdentityModule_log.log('[Identity.IdentityModule.getValidToken] time now:', timeNow);\n\n          if (timeNow >= expirationDate) {\n            //        if (timeNow >= 0) {\n            if (assertion.hasOwnProperty('refresh')) {\n              IdentityModule_log.log('[Identity.IdentityModule.getValidToken] refreshing assertion: ', assertion);\n\n              _this.sendRefreshMessage(assertion).then(function (newAssertion) {\n                IdentityModule_log.log('[Identity.IdentityModule.getValidToken] refreshed assertion: ', newAssertion);\n\n                _this.identities.updateAssertion(newAssertion).then(function () {\n                  resolve(newAssertion);\n                }, function (err) {\n                  IdentityModule_log.error('[IdentityModule.getValidToken] error updating the assertion ', err);\n                  reject(err);\n                });\n              }, function (err) {\n                IdentityModule_log.error('[IdentityModule.getValidToken] error refreshing the assertion ', err);\n                reject(err);\n              });\n            } else {\n              // no refresh token available, user has to authenticate again to get a new assertion\n              // generate new idToken\n              _this.callGenerateMethods(assertion.idp.domain).then(function (value) {\n                resolve(value);\n              }).catch(function (err) {\n                reject('[IdentityModule.getValidToken] error when generating a new assertion ' + err);\n              });\n            }\n          } else {\n            resolve(assertion);\n          }\n        }).catch(function (error) {\n          IdentityModule_log.error('[IdentityModule.getValidToken] error on getIdToken', error);\n          reject(error);\n        });\n      });\n    }\n    /**\r\n    * returns the reporter associated to the dataObject URL\r\n    * @param   {String}   dataObjectURL         dataObject url\r\n    * @return   {String}  reporter              dataObject url reporter\r\n    */\n\n  }, {\n    key: \"_getHypertyFromDataObject\",\n    value: function _getHypertyFromDataObject(dataObjectURL) {\n      IdentityModule_log.info('_getHypertyFromDataObject:dataObjectURL', dataObjectURL);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var splitedURL = divideURL(dataObjectURL);\n        var domain = splitedURL.domain;\n        var finalURL = parseMessageURL(dataObjectURL); // check if is the creator of the hyperty\n\n        var reporterURL = _this.registry.getReporterURLSynchonous(finalURL);\n\n        IdentityModule_log.info('_getHypertyFromDataObject:reporterURL', reporterURL);\n\n        if (reporterURL) {\n          resolve(reporterURL);\n        } else {\n          // check if there is already an association from an hypertyURL to the dataObject\n          var storedReporterURL = _this.dataObjectsIdentity[finalURL];\n          IdentityModule_log.info('_getHypertyFromDataObject:storedReporterURL', storedReporterURL);\n\n          if (storedReporterURL) {\n            resolve(storedReporterURL);\n          } else {\n            // check if there is any hyperty that subscribed the dataObjectURL\n            var subscriberHyperty = _this.registry.getDataObjectSubscriberHyperty(dataObjectURL);\n\n            IdentityModule_log.info('_getHypertyFromDataObject:subscriberHyperty', subscriberHyperty);\n\n            if (subscriberHyperty) {\n              resolve(subscriberHyperty);\n            } else {\n              // search in domain registry for the hyperty associated to the dataObject\n              // search in case is a subscriber who wants to know the reporter\n              // To be reviewed in order to avoid the discovery transaction\n              _this._coreDiscovery.discoverDataObjectPerURL(finalURL, domain).then(function (dataObject) {\n                IdentityModule_log.info('_getHypertyFromDataObject:dataObject', dataObject);\n                _this.dataObjectsIdentity[finalURL] = dataObject.reporter;\n                IdentityModule_log.info('_getHypertyFromDataObject:dataObject.reporter', dataObject.reporter);\n                resolve(dataObject.reporter);\n              }, function (err) {\n                reject(err);\n              });\n            }\n          }\n        }\n      });\n    }\n    /**\r\n    * Function that resolve and create the domainURL in case it is provided one. If not, resolve the default domainURL\r\n    * @param {String}     idpDomain     idpDomain (Optional)\r\n    */\n\n  }, {\n    key: \"_resolveDomain\",\n    value: function _resolveDomain(idpDomain) {\n      if (!idpDomain) {\n        return 'domain-idp://google.com';\n      } else {\n        return 'domain-idp://' + idpDomain;\n      }\n    }\n    /*\r\n      _secondsSinceEpoch() {\r\n        return Math.floor(Date.now() / 1000);\r\n      }*/\n\n  }, {\n    key: \"messageBus\",\n    get: function get() {\n      var _this = this;\n\n      return _this._messageBus;\n    }\n    /**\r\n    * Set the messageBus in this Registry\r\n    * @param {MessageBus}           messageBus\r\n    */\n    ,\n    set: function set(messageBus) {\n      var _this = this;\n\n      _this._messageBus = messageBus;\n\n      _this.addGUIListeners();\n    }\n    /**\r\n    * return the coreDiscovery component\r\n    * do we need this??\r\n    */\n\n  }, {\n    key: \"coreDiscovery\",\n    get: function get() {\n      var _this = this;\n\n      return _this._coreDiscovery;\n    }\n    /**\r\n    * Set the coreDiscovery component\r\n    * @param {coreDiscovery} coreDiscovery\r\n    */\n    ,\n    set: function set(coreDiscovery) {\n      var _this = this;\n\n      _this._coreDiscovery = coreDiscovery;\n    }\n    /**\r\n    * return the registry in this idModule\r\n    * @param {registry}           registry\r\n    */\n\n  }, {\n    key: \"registry\",\n    get: function get() {\n      var _this = this;\n\n      return _this._registry;\n    }\n    /**\r\n    * Set the registry in this idModule\r\n    * @param {registry}     reg\r\n    */\n    ,\n    set: function set(registry) {\n      var _this = this;\n\n      _this._registry = registry;\n    }\n  }, {\n    key: \"identities\",\n    get: function get() {\n      var _this = this;\n\n      return _this._identities;\n    },\n    set: function set(identities) {\n      var _this = this;\n\n      _this._identities = identities;\n    }\n  }, {\n    key: \"idps\",\n    get: function get() {\n      return this._listOfIdps;\n    }\n  }]);\n\n  return IdentityModule;\n}();\n\n/* harmony default export */ var identity_IdentityModule = (IdentityModule_IdentityModule);\n// CONCATENATED MODULE: ./src/identity/IdentityHandler.js\nfunction IdentityHandler_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction IdentityHandler_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction IdentityHandler_createClass(Constructor, protoProps, staticProps) { if (protoProps) IdentityHandler_defineProperties(Constructor.prototype, protoProps); if (staticProps) IdentityHandler_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Provides an API to manage identities from msg bus pipeline\r\n* TODO: rename to something like IdentityPipelineHandler in order not to conflict with framework related IdentityHandler\r\n*/\n\n\nvar IdentityHandler_log = loglevel[\"getLogger\"]('IdentityHandler');\n\nvar IdentityHandler_IdentityHandler =\n/*#__PURE__*/\nfunction () {\n  function IdentityHandler(idm) {\n    IdentityHandler_classCallCheck(this, IdentityHandler);\n\n    var _this = this;\n\n    _this._idm = idm;\n  }\n\n  IdentityHandler_createClass(IdentityHandler, [{\n    key: \"reset\",\n    value: function reset() {\n      console.log('IM reset'); // this._idm.identities.reset();\n\n      this._idm.identities = new identity_Identities(this._idm.identities._type, this._idm.identities._storageManager);\n      console.log(this._idm.identities);\n    }\n  }, {\n    key: \"_isToSetID\",\n    value: function _isToSetID(message) {\n      var schemasToIgnore = ['domain-idp', 'runtime', 'domain'];\n      var _from = message.from;\n\n      if (message.body && message.body.hasOwnProperty('source')) {\n        _from = message.body.source;\n      }\n\n      if (message.body && message.body.hasOwnProperty('subscriber')) {\n        _from = message.body.subscriber;\n      }\n\n      if (message.type === 'forward') {\n        return false;\n      } // Signalling Messages between P2P Stubs don't have Identities. FFS\n\n\n      if (_from.includes('/p2prequester/') || _from.includes('/p2phandler/')) {\n        return false;\n      }\n\n      var splitFrom = _from.split('://');\n\n      var fromSchema = splitFrom[0];\n      var isToIgnore = schemasToIgnore.indexOf(fromSchema) === -1;\n      return isToIgnore;\n    }\n  }, {\n    key: \"processMessage\",\n    value: function processMessage(message) {\n      var _this2 = this;\n\n      IdentityHandler_log.log('[IdentityHandler.processMessage] ', message);\n      return new Promise(function (resolve, reject) {\n        // skip messages that don't need identity tokens in the body\n        if (!_this2._isToSetID(message)) return resolve(message);\n        /*      let from = message.from;\r\n        let sourceURL = undefined;\r\n        if ( message.hasOwnProperty('body') && message.body.hasOwnProperty('source')) {\r\n          from = message.body.source;\r\n        }\r\n          if (message.type === 'forward') {\r\n          from = message.body.from;\r\n        }\r\n          if (message.hasOwnProperty('body') && message.body.hasOwnProperty('subscriber')) {\r\n          from = message.body.subscriber;\r\n        }*/\n\n        _this2._idm.getToken(message).then(function (identity) {\n          if (!message.hasOwnProperty('body')) message.body = {};\n          message.body.identity = identity;\n          resolve(message);\n        }).catch(function (reason) {\n          IdentityHandler_log.error(reason);\n          reject(reason);\n        });\n      });\n    }\n  }]);\n\n  return IdentityHandler;\n}();\n\n/* harmony default export */ var identity_IdentityHandler = (IdentityHandler_IdentityHandler);\n// CONCATENATED MODULE: ./src/policy/ActionsService.js\nfunction ActionsService_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ActionsService_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ActionsService_createClass(Constructor, protoProps, staticProps) { if (protoProps) ActionsService_defineProperties(Constructor.prototype, protoProps); if (staticProps) ActionsService_defineProperties(Constructor, staticProps); return Constructor; }\n\nvar ActionsService =\n/*#__PURE__*/\nfunction () {\n  function ActionsService(context) {\n    ActionsService_classCallCheck(this, ActionsService);\n\n    this.context = context;\n  }\n\n  ActionsService_createClass(ActionsService, [{\n    key: \"enforcePolicies\",\n    value: function enforcePolicies(message, isIncomingMessage) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var policies = _this.context.getPolicies(message, isIncomingMessage);\n\n        if (policies !== undefined) {\n          if (policies.serviceProviderPolicy !== undefined) {\n            policies.serviceProviderPolicy.enforceActions(_this.context, message).then(function (messages) {\n              resolve(messages);\n            }, function (error) {\n              reject(error);\n            });\n          } else {\n            if (policies.userPolicy !== undefined) {\n              policies.userPolicy.enforceActions(_this.context, message).then(function (messages) {\n                resolve(messages);\n              }, function (error) {\n                reject(error);\n              });\n            } else {\n              resolve([message]);\n            }\n          }\n        } else {\n          resolve([message]);\n        }\n      });\n    }\n  }, {\n    key: \"forwardToID\",\n    value: function forwardToID(message, email) {\n      var _this = this;\n\n      if (!_this.context.runtimeRegistry) throw new Error('forward message to given ID is unsupported in this environment');\n      return new Promise(function (resolve, reject) {\n        if (_this.context.runtimeRegistry.hypertiesList[0].hypertyURL === message.to) {\n          var splitTo = message.to.split('://');\n\n          if (splitTo[0] !== 'runtime') {\n            _this.context.runtimeRegistry.discoverHypertyPerUser(email).then(function (result) {\n              message.to = result.hypertyURL;\n              message.body.via = undefined;\n              resolve(message);\n\n              _this.context.runtimeRegistry._messageBus.postMessage(message);\n            }, function (error) {\n              reject(error);\n            });\n          } else {\n            resolve(message);\n          }\n        } else {\n          resolve(message);\n        }\n      });\n    }\n  }, {\n    key: \"forwardToHyperty\",\n    value: function forwardToHyperty(message, hypertyURL) {\n      var _this = this;\n\n      if (!_this.context.runtimeRegistry) throw new Error('forward message to given ID is unsupported in this environment');\n      return new Promise(function (resolve) {\n        if (_this.context.runtimeRegistry.hypertiesList[0].hypertyURL === message.to) {\n          var splitTo = message.to.split('://');\n\n          if (splitTo[0] !== 'runtime') {\n            message.to = hypertyURL;\n            message.body.via = undefined;\n            resolve(message);\n\n            _this.context.runtimeRegistry._messageBus.postMessage(message);\n          } else {\n            resolve(message);\n          }\n        } else {\n          resolve(message);\n        }\n      });\n    }\n  }, {\n    key: \"sendAutomaticMessage\",\n    value: function sendAutomaticMessage(message, text) {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        var automaticMessage = {\n          from: message.to,\n          to: message.from,\n          body: {\n            value: text\n          },\n          type: message.type\n        };\n        resolve(message);\n\n        _this.context.runtimeRegistry._messageBus.postMessage(automaticMessage);\n      });\n    }\n  }]);\n\n  return ActionsService;\n}();\n\n/* harmony default export */ var policy_ActionsService = (ActionsService);\n// CONCATENATED MODULE: ./src/policy/Operators.js\nfunction Operators_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Operators_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Operators_createClass(Constructor, protoProps, staticProps) { if (protoProps) Operators_defineProperties(Constructor.prototype, protoProps); if (staticProps) Operators_defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Operators =\n/*#__PURE__*/\nfunction () {\n  function Operators() {\n    Operators_classCallCheck(this, Operators);\n  }\n\n  Operators_createClass(Operators, [{\n    key: \"and\",\n    value: function and(params) {\n      return params[0] && params[1];\n    }\n  }, {\n    key: \"between\",\n    value: function between(params) {\n      var start = parseInt(params[0][0]);\n      var end = parseInt(params[0][1]);\n      var now = params[1];\n\n      if (end < start) {\n        now = now < start ? now += 2400 : now;\n        end += 2400;\n      }\n\n      return now > start && now < end;\n    }\n  }, {\n    key: \"equals\",\n    value: function equals(params) {\n      return String(params[0]) === '*' || String(params[0]) === String(params[1]);\n    }\n  }, {\n    key: \"greaterThan\",\n    value: function greaterThan(params) {\n      return params[1] > params[0];\n    }\n  }, {\n    key: \"in\",\n    value: function _in(params) {\n      return params[0].indexOf(params[1]) > -1;\n    }\n  }, {\n    key: \"lessThan\",\n    value: function lessThan(params) {\n      return params[1] < params[0];\n    }\n  }, {\n    key: \"not\",\n    value: function not(params) {\n      return !params[0];\n    }\n  }, {\n    key: \"or\",\n    value: function or(params) {\n      return params[0] || params[1];\n    }\n  }]);\n\n  return Operators;\n}();\n\n/* harmony default export */ var policy_Operators = (Operators);\n// CONCATENATED MODULE: ./src/policy/PDP.js\nfunction PDP_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction PDP_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction PDP_createClass(Constructor, protoProps, staticProps) { if (protoProps) PDP_defineProperties(Constructor.prototype, protoProps); if (staticProps) PDP_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n/**\r\n* The Policy Decision Point (PDP) decides if a message is to be authorised by checking a set of\r\n* policies. The resource to be verified is specified in the first word of the 'condition' field of\r\n* a Policy object. The implementation that verifies if the message is compliant with a policy is\r\n* specified in a hashtable to allow dynamic definition of the implementation, providing\r\n* extensibility to the Policy Engine functionalities.\r\n*/\n\nvar PDP_PDP =\n/*#__PURE__*/\nfunction () {\n  function PDP(context) {\n    PDP_classCallCheck(this, PDP);\n\n    this.context = context;\n    this.operators = new policy_Operators();\n  }\n\n  PDP_createClass(PDP, [{\n    key: \"evaluatePolicies\",\n    value: function evaluatePolicies(message, isIncomingMessage) {\n      var policies = this.context.getPolicies(message, isIncomingMessage);\n      var result = 'Not Applicable';\n\n      if (policies !== undefined) {\n        result = this.evaluatePolicy(message, policies.serviceProviderPolicy, isIncomingMessage);\n\n        if (result || result === 'Not Applicable') {\n          var userResult = this.evaluatePolicy(message, policies.userPolicy, isIncomingMessage);\n\n          if (userResult !== 'Not Applicable') {\n            result = userResult;\n          }\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"evaluatePolicy\",\n    value: function evaluatePolicy(message, policy, isIncoming) {\n      var result = 'Not Applicable';\n\n      if (policy) {\n        result = policy.evaluateRules(this.context, message, isIncoming);\n      }\n\n      return result;\n    }\n  }]);\n\n  return PDP;\n}();\n\n/* harmony default export */ var policy_PDP = (PDP_PDP);\n// CONCATENATED MODULE: ./src/policy/combiningAlgorithms/AllowOverrides.js\nfunction AllowOverrides_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction AllowOverrides_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction AllowOverrides_createClass(Constructor, protoProps, staticProps) { if (protoProps) AllowOverrides_defineProperties(Constructor.prototype, protoProps); if (staticProps) AllowOverrides_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* @author Ana Caldeira <ana.caldeira@tecnico.ulisboa.pt>\r\n* @classdesc Class to combine the authorization decisions that result from rules evaluation.\r\n*/\nvar AllowOverrides =\n/*#__PURE__*/\nfunction () {\n  function AllowOverrides() {\n    AllowOverrides_classCallCheck(this, AllowOverrides);\n  }\n\n  AllowOverrides_createClass(AllowOverrides, [{\n    key: \"combine\",\n\n    /**\r\n    * Given an array of individual authorization decisions, prioritizes a positive one.\r\n    * @param    {boolean[]}   decisions\r\n    * @returns  {boolean}\r\n    */\n    value: function combine(decisions) {\n      if (decisions.indexOf(true) !== -1) {\n        return true;\n      } else {\n        if (decisions.indexOf(false) !== -1) {\n          return false;\n        } else {\n          return 'Not Applicable';\n        }\n      }\n    }\n  }]);\n\n  return AllowOverrides;\n}();\n\n/* harmony default export */ var combiningAlgorithms_AllowOverrides = (AllowOverrides);\n// CONCATENATED MODULE: ./src/policy/combiningAlgorithms/BlockOverrides.js\nfunction BlockOverrides_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction BlockOverrides_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction BlockOverrides_createClass(Constructor, protoProps, staticProps) { if (protoProps) BlockOverrides_defineProperties(Constructor.prototype, protoProps); if (staticProps) BlockOverrides_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* @author Ana Caldeira <ana.caldeira@tecnico.ulisboa.pt>\r\n* @classdesc Class to combine the authorization decisions that result from rules evaluation.\r\n*/\nvar BlockOverrides =\n/*#__PURE__*/\nfunction () {\n  function BlockOverrides() {\n    BlockOverrides_classCallCheck(this, BlockOverrides);\n  }\n\n  BlockOverrides_createClass(BlockOverrides, [{\n    key: \"combine\",\n\n    /**\r\n    * Given an array of individual authorisation decisions, prioritises a negative one.\r\n    * @param    {boolean[]}   decisions\r\n    * @returns  {boolean}\r\n    */\n    value: function combine(decisions) {\n      if (decisions.indexOf(false) !== -1) {\n        return false;\n      } else {\n        if (decisions.indexOf(true) !== -1) {\n          return true;\n        } else {\n          return 'Not Applicable';\n        }\n      }\n    }\n  }]);\n\n  return BlockOverrides;\n}();\n\n/* harmony default export */ var combiningAlgorithms_BlockOverrides = (BlockOverrides);\n// CONCATENATED MODULE: ./src/policy/combiningAlgorithms/FirstApplicable.js\nfunction FirstApplicable_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction FirstApplicable_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction FirstApplicable_createClass(Constructor, protoProps, staticProps) { if (protoProps) FirstApplicable_defineProperties(Constructor.prototype, protoProps); if (staticProps) FirstApplicable_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* @author Ana Caldeira <ana.caldeira@tecnico.ulisboa.pt>\r\n* @classdesc Class to combine the authorization decisions that result from rules evaluation.\r\n*/\nvar FirstApplicable =\n/*#__PURE__*/\nfunction () {\n  function FirstApplicable() {\n    FirstApplicable_classCallCheck(this, FirstApplicable);\n  }\n\n  FirstApplicable_createClass(FirstApplicable, [{\n    key: \"combine\",\n\n    /**\r\n    * Given an array of individual authorisation decisions, returns the first one different from 'Not Applicable', either positive or negative.\r\n    * @param    {boolean[]}     decisions\r\n    * @returns  {boolean}\r\n    */\n    value: function combine(decisions) {\n      for (var i in decisions) {\n        if (decisions[i] !== 'Not Applicable') {\n          return decisions[i];\n        }\n      }\n\n      return 'Not Applicable';\n    }\n  }]);\n\n  return FirstApplicable;\n}();\n\n/* harmony default export */ var combiningAlgorithms_FirstApplicable = (FirstApplicable);\n// CONCATENATED MODULE: ./src/policy/conditions/Condition.js\nfunction Condition_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Condition_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Condition_createClass(Constructor, protoProps, staticProps) { if (protoProps) Condition_defineProperties(Constructor.prototype, protoProps); if (staticProps) Condition_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* @author Ana Caldeira <ana.caldeira@tecnico.ulisboa.pt>\r\n* @classdesc Class to represent a condition and evaluate its applicability.\r\n*/\n\nvar Condition_Condition =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * Creates a new Condition.\r\n  * @class\r\n  * @param  {string}  attribute\r\n  * @param  {string}  operator\r\n  * @param  {*}       params\r\n  */\n  function Condition(attribute, operator, params) {\n    Condition_classCallCheck(this, Condition);\n\n    this.attribute = attribute;\n    this.operator = operator;\n    this.params = params;\n    this.operators = new policy_Operators();\n  }\n  /**\r\n  * Verifies if the condition is applicable to the message. First, the system value that corresponds to the attribute is retrieved; then, that value is compared with the parameter specified in the condition by executing the operator implementation. If the operator is 'in' and the name of a group is given, then the array holding the members of the group is retrieved before the comparison.\r\n  * @param  {Object}    context   environment where the Policy Engine is being used\r\n  * @param  {Object}    message\r\n  */\n\n\n  Condition_createClass(Condition, [{\n    key: \"isApplicable\",\n    value: function isApplicable(context, message) {\n      context[this.attribute] = {\n        message: message\n      };\n      var value = context[this.attribute];\n      var tempParam;\n\n      if (this.operator === 'in') {\n        if (!Array.isArray(this.params)) {\n          tempParam = context.getGroup(this.params, message.to);\n          return this.operators[this.operator]([tempParam, value]);\n        }\n      }\n\n      return this.operators[this.operator]([this.params, value]);\n    }\n  }]);\n\n  return Condition;\n}();\n\n/* harmony default export */ var conditions_Condition = (Condition_Condition);\n// CONCATENATED MODULE: ./src/policy/conditions/SubscriptionCondition.js\nfunction SubscriptionCondition_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { SubscriptionCondition_typeof = function _typeof(obj) { return typeof obj; }; } else { SubscriptionCondition_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return SubscriptionCondition_typeof(obj); }\n\nfunction SubscriptionCondition_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction SubscriptionCondition_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction SubscriptionCondition_createClass(Constructor, protoProps, staticProps) { if (protoProps) SubscriptionCondition_defineProperties(Constructor.prototype, protoProps); if (staticProps) SubscriptionCondition_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction SubscriptionCondition_possibleConstructorReturn(self, call) { if (call && (SubscriptionCondition_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return SubscriptionCondition_assertThisInitialized(self); }\n\nfunction SubscriptionCondition_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction SubscriptionCondition_get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { SubscriptionCondition_get = Reflect.get; } else { SubscriptionCondition_get = function _get(target, property, receiver) { var base = SubscriptionCondition_superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return SubscriptionCondition_get(target, property, receiver || target); }\n\nfunction SubscriptionCondition_superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = SubscriptionCondition_getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction SubscriptionCondition_getPrototypeOf(o) { SubscriptionCondition_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return SubscriptionCondition_getPrototypeOf(o); }\n\nfunction SubscriptionCondition_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) SubscriptionCondition_setPrototypeOf(subClass, superClass); }\n\nfunction SubscriptionCondition_setPrototypeOf(o, p) { SubscriptionCondition_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return SubscriptionCondition_setPrototypeOf(o, p); }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n* @author Ana Caldeira <ana.caldeira@tecnico.ulisboa.pt>\r\n* @classdesc Class to represent a subscription condition and evaluate its applicability.\r\n*/\n\nvar SubscriptionCondition =\n/*#__PURE__*/\nfunction (_Condition) {\n  SubscriptionCondition_inherits(SubscriptionCondition, _Condition);\n\n  /**\r\n  * Creates a new SubscriptionCondition.\r\n  * @class\r\n  * @param  {string}  attribute\r\n  * @param  {string}  operator\r\n  * @param  {*}       params\r\n  */\n  function SubscriptionCondition(attribute, operator, params) {\n    SubscriptionCondition_classCallCheck(this, SubscriptionCondition);\n\n    return SubscriptionCondition_possibleConstructorReturn(this, SubscriptionCondition_getPrototypeOf(SubscriptionCondition).call(this, attribute, operator, params));\n  }\n  /**\r\n  * Verifies if the subscription condition is applicable to the message. First, verifies if the message is of the subscription type; second, verifies if the message is from a remote runtime to guarantee that the subscription is being validated in the destination runtime; third, verifies if the subscription preference is met.\r\n  * @param  {Object}    context   environment where the Policy Engine is being used\r\n  * @param  {Object}    message\r\n  */\n\n\n  SubscriptionCondition_createClass(SubscriptionCondition, [{\n    key: \"isApplicable\",\n    value: function isApplicable(context, message) {\n      var isSubscription = message.type === 'subscribe';\n      var isFromRemoteSM = context.isFromRemoteSM(message.from);\n\n      if (isSubscription & isFromRemoteSM) {\n        return SubscriptionCondition_get(SubscriptionCondition_getPrototypeOf(SubscriptionCondition.prototype), \"isApplicable\", this).call(this, context, message);\n      } else {\n        return false;\n      }\n    }\n  }]);\n\n  return SubscriptionCondition;\n}(conditions_Condition);\n\n/* harmony default export */ var conditions_SubscriptionCondition = (SubscriptionCondition);\n// CONCATENATED MODULE: ./src/policy/conditions/AdvancedCondition.js\nfunction AdvancedCondition_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction AdvancedCondition_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction AdvancedCondition_createClass(Constructor, protoProps, staticProps) { if (protoProps) AdvancedCondition_defineProperties(Constructor.prototype, protoProps); if (staticProps) AdvancedCondition_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\n\n\nvar AdvancedCondition_AdvancedCondition =\n/*#__PURE__*/\nfunction () {\n  function AdvancedCondition(condition) {\n    AdvancedCondition_classCallCheck(this, AdvancedCondition);\n\n    this.operators = new policy_Operators();\n\n    if (condition.operators !== undefined) {\n      condition = condition.condition;\n    }\n\n    condition = this.buildCondition(condition);\n    this.condition = condition;\n  }\n\n  AdvancedCondition_createClass(AdvancedCondition, [{\n    key: \"buildCondition\",\n    value: function buildCondition(condition) {\n      if (Array.isArray(condition[1])) {\n        condition[1] = this.buildCondition(condition[1]);\n      } else {\n        if (condition[1].attribute === 'subscription') {\n          condition[1] = new conditions_SubscriptionCondition(condition[1].attribute, condition[1].operator, condition[1].params);\n        } else {\n          condition[1] = new conditions_Condition(condition[1].attribute, condition[1].operator, condition[1].params);\n        }\n      }\n\n      if (condition[2] !== undefined) {\n        if (Array.isArray(condition[2])) {\n          condition[2] = this.buildCondition(condition[2]);\n        } else {\n          if (condition[2].attribute === 'subscription') {\n            condition[2] = new conditions_SubscriptionCondition(condition[2].attribute, condition[2].operator, condition[2].params);\n          } else {\n            condition[2] = new conditions_Condition(condition[2].attribute, condition[2].operator, condition[2].params);\n          }\n        }\n      }\n\n      return condition;\n    }\n  }, {\n    key: \"isApplicable\",\n    value: function isApplicable(context, message, scope, target, operator, left, right) {\n      if (!operator) {\n        operator = this.condition[0];\n        left = this.condition[1];\n        right = this.condition[2];\n      }\n\n      while (!(left instanceof conditions_Condition) & !(left instanceof conditions_SubscriptionCondition) & typeof left !== 'boolean') {\n        left = this.isApplicable(context, message, scope, target, left[0], left[1], left[2]);\n      }\n\n      if (right !== undefined) {\n        while (!(right instanceof conditions_Condition) & !(right instanceof conditions_SubscriptionCondition) & typeof right !== 'boolean') {\n          right = this.isApplicable(context, message, scope, target, right[0], right[1], right[2]);\n        }\n      }\n\n      var resultLeft = typeof left === 'boolean' ? left : left.isApplicable(context, message, scope, target);\n      var resultRight;\n\n      if (right !== undefined) {\n        resultRight = typeof right === 'boolean' ? right : right.isApplicable(context, message, scope, target);\n      }\n\n      return this.operators[operator]([resultLeft, resultRight]);\n    }\n  }]);\n\n  return AdvancedCondition;\n}();\n\n/* harmony default export */ var conditions_AdvancedCondition = (AdvancedCondition_AdvancedCondition);\n// CONCATENATED MODULE: ./src/policy/Rule.js\nfunction Rule_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Rule_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Rule_createClass(Constructor, protoProps, staticProps) { if (protoProps) Rule_defineProperties(Constructor.prototype, protoProps); if (staticProps) Rule_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\n\n\n\nvar Rule_Rule =\n/*#__PURE__*/\nfunction () {\n  function Rule(decision, condition, scope, target, priority) {\n    Rule_classCallCheck(this, Rule);\n\n    this.decision = decision;\n    this.setCondition(condition);\n    this.priority = priority;\n    this.scope = scope;\n    this.target = target;\n  }\n\n  Rule_createClass(Rule, [{\n    key: \"setCondition\",\n    value: function setCondition(condition) {\n      if (!(condition instanceof conditions_Condition || condition instanceof conditions_AdvancedCondition || condition instanceof conditions_AdvancedCondition)) {\n        var attribute = condition.attribute;\n\n        switch (attribute) {\n          case 'subscription':\n            this.condition = new conditions_AdvancedCondition(condition.attribute, condition.operator, condition.params);\n            break;\n\n          case undefined:\n            this.condition = new conditions_AdvancedCondition(condition);\n            break;\n\n          default:\n            this.condition = new conditions_Condition(condition.attribute, condition.operator, condition.params);\n        }\n      } else {\n        this.condition = condition;\n      }\n    }\n  }, {\n    key: \"evaluate\",\n    value: function evaluate(context, message, isIncoming) {\n      var field = isIncoming ? message.to : message.from;\n      var hypertyName;\n\n      switch (this.scope) {\n        case 'global':\n          break;\n\n        case 'hyperty':\n          if (isDataObjectURL(field)) {\n            var reporter = context.runtimeRegistry.getReporterURLSynchonous(removePathFromURL(field));\n\n            if (reporter !== undefined) {\n              hypertyName = context.runtimeRegistry.getHypertyName(reporter);\n            }\n          } else {\n            if (field.split('://')[0] === 'hyperty') {\n              hypertyName = context.runtimeRegistry.getHypertyName(removePathFromURL(field));\n            }\n          }\n\n          if (hypertyName === this.target) {\n            break;\n          }\n\n          return 'Not Applicable';\n\n        case 'identity':\n          var owner;\n\n          if (isDataObjectURL(field)) {\n            var _reporter = context.runtimeRegistry.getReporterURLSynchonous(removePathFromURL(field));\n\n            owner = context.runtimeRegistry.getHypertyOwner(_reporter);\n          } else {\n            if (field.split('://')[0] === 'hyperty') {\n              owner = context.runtimeRegistry.getHypertyOwner(removePathFromURL(field));\n            }\n          }\n\n          if (owner !== undefined) {\n            owner = getUserEmailFromURL(owner);\n          }\n\n          if (owner === this.target) {\n            break;\n          }\n\n          return 'Not Applicable';\n      }\n\n      if (this.condition.isApplicable(context, message, this.scope, this.target)) {\n        return this.decision;\n      } else {\n        return 'Not Applicable';\n      }\n    }\n  }]);\n\n  return Rule;\n}();\n\n/* harmony default export */ var policy_Rule = (Rule_Rule);\n// CONCATENATED MODULE: ./src/policy/Policy.js\nfunction Policy_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Policy_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Policy_createClass(Constructor, protoProps, staticProps) { if (protoProps) Policy_defineProperties(Constructor.prototype, protoProps); if (staticProps) Policy_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\n\n\n\nvar Policy_Policy =\n/*#__PURE__*/\nfunction () {\n  function Policy(key, rules, actions, combiningAlgorithm) {\n    Policy_classCallCheck(this, Policy);\n\n    if (!key) throw new Error('key is not defined');\n    if (!actions) throw new Error('actions are not defined');\n    this.actions = actions;\n    this.key = key;\n\n    this._setRules(rules);\n\n    this._setCombiningAlgorithm(combiningAlgorithm);\n  }\n\n  Policy_createClass(Policy, [{\n    key: \"addAction\",\n    value: function addAction(method, param) {\n      this.actions.push({\n        method: method,\n        param: param\n      });\n    }\n  }, {\n    key: \"createRule\",\n    value: function createRule(decision, condition, scope, target, priority) {\n      if (priority === undefined) {\n        priority = this.getLastPriority() + 1;\n      }\n\n      var rule = new policy_Rule(decision, condition, scope, target, priority);\n      this.rules.push(rule);\n    }\n  }, {\n    key: \"deleteRule\",\n    value: function deleteRule(rule) {\n      var indexToRemove = this.rules.indexOf(rule);\n      this.rules.splice(indexToRemove, 1);\n    }\n  }, {\n    key: \"enforceActions\",\n    value: function enforceActions(context, message) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var results = [];\n\n        if (_this.actions.length !== 0) {\n          for (var i in _this.actions) {\n            var result = context.pep.actionsService[_this.actions[i].method](message, _this.actions[i].param);\n\n            results.push(result);\n          }\n\n          Promise.all(results).then(function (messages) {\n            resolve(messages);\n          }, function (error) {\n            reject(error);\n          });\n        } else {\n          resolve([message]);\n        }\n      });\n    }\n  }, {\n    key: \"evaluateRules\",\n    value: function evaluateRules(context, message, isIncoming) {\n      var results = [];\n\n      for (var i in this.rules) {\n        results.push(this.rules[i].evaluate(context, message, isIncoming));\n      }\n\n      return this.combiningAlgorithm.combine(results);\n    }\n  }, {\n    key: \"getLastPriority\",\n    value: function getLastPriority() {\n      var priorities = [];\n\n      if (this.rules.length !== 0) {\n        for (var i in this.rules) {\n          priorities.push(this.rules[i].priority);\n        }\n\n        return Math.max.apply(Math, priorities);\n      } else {\n        return -1;\n      }\n    }\n  }, {\n    key: \"getRuleByPriority\",\n    value: function getRuleByPriority(priority) {\n      for (var i in this.rules) {\n        if (String(this.rules[i].priority) === String(priority)) {\n          return this.rules[i];\n        }\n      }\n\n      throw Error('Rule with priority ' + priority + ' does not exist!');\n    }\n  }, {\n    key: \"_setCombiningAlgorithm\",\n    value: function _setCombiningAlgorithm(combiningAlgorithm) {\n      if (!combiningAlgorithm) {\n        combiningAlgorithm = 'blockOverrides';\n      }\n\n      switch (combiningAlgorithm) {\n        case 'blockOverrides':\n          this.combiningAlgorithm = new combiningAlgorithms_BlockOverrides();\n          break;\n\n        case 'allowOverrides':\n          this.combiningAlgorithm = new combiningAlgorithms_AllowOverrides();\n          break;\n\n        case 'firstApplicable':\n          this.combiningAlgorithm = new combiningAlgorithms_FirstApplicable();\n          break;\n\n        default:\n          throw Error('Unknown algorithm: ' + combiningAlgorithm);\n      }\n    }\n  }, {\n    key: \"_setRules\",\n    value: function _setRules(rules) {\n      this.rules = [];\n\n      for (var i in rules) {\n        var rule = rules[i];\n\n        if (rule.priority === undefined) {\n          rule.priority = this.getLastPriority() + 1;\n        }\n\n        if (!(rule instanceof policy_Rule)) {\n          rule = new policy_Rule(rule.decision, rule.condition, rule.scope, rule.target, rule.priority);\n        }\n\n        this.rules.push(rule);\n      }\n    }\n  }, {\n    key: \"sortRules\",\n    value: function sortRules() {\n      return this.rules.sort(function (a, b) {\n        var x = a.priority;\n        var y = b.priority;\n        return x < y ? -1 : x > y ? 1 : 0;\n      });\n    }\n  }]);\n\n  return Policy;\n}();\n\n/* harmony default export */ var policy_Policy = (Policy_Policy);\n// CONCATENATED MODULE: ./src/policy/PEP.js\nfunction PEP_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction PEP_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction PEP_createClass(Constructor, protoProps, staticProps) { if (protoProps) PEP_defineProperties(Constructor.prototype, protoProps); if (staticProps) PEP_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar PEP_log = loglevel[\"getLogger\"]('PEP');\n\n\n\n\n\nvar PEP_PEP =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * Creates a Policy Enforcement Point (PEP) instance\r\n  * @param    {Object}    context\r\n  */\n  function PEP(context) {\n    PEP_classCallCheck(this, PEP);\n\n    var _this = this;\n\n    _this.pdp = new policy_PDP(context);\n    _this.actionsService = new policy_ActionsService(context);\n    _this.context = context;\n    context.pep = _this; //TODO should be added a trigger to verify when the loadConfigurations is successfully completed\n\n    context.loadConfigurations();\n  }\n  /**\r\n  * return the messageBus in this Registry\r\n  * @param {MessageBus}           messageBus\r\n  */\n\n\n  PEP_createClass(PEP, [{\n    key: \"addGUIListeners\",\n    value: function addGUIListeners() {\n      var _this = this;\n\n      _this.context.messageBus.addListener(_this.context.pepURL, function (msg) {\n        var funcName = msg.body.method;\n        var returnedValue;\n\n        if (funcName === 'addToGroup') {\n          var groupName = msg.body.params.groupName;\n          var userEmail = msg.body.params.userEmail;\n          returnedValue = _this.context.addToGroup(groupName, userEmail);\n        } else if (funcName === 'createGroup') {\n          var _groupName = msg.body.params.groupName;\n          returnedValue = _this.context.createGroup(_groupName);\n        } else if (funcName === 'addPolicy') {\n          var source = msg.body.params.source;\n          var key = msg.body.params.key;\n          var policy = msg.body.params.policy;\n          var combiningAlgorithm = msg.body.params.combiningAlgorithm;\n          returnedValue = _this.addPolicy(source, key, policy, combiningAlgorithm);\n        } else if (funcName === 'deleteGroup') {\n          var _groupName2 = msg.body.params.groupName;\n          returnedValue = _this.context.deleteGroup(_groupName2);\n        } else if (funcName === 'removePolicy') {\n          var _source = msg.body.params.source;\n          var _key = msg.body.params.key;\n          returnedValue = _this.removePolicy(_source, _key);\n        } else if (funcName === 'savePolicies') {\n          var _source2 = msg.body.params.source;\n          returnedValue = _this.context.savePolicies(_source2);\n        } else if (funcName === 'userPolicies') {\n          returnedValue = _this.context.userPolicies;\n        } else if (funcName === 'activeUserPolicy') {\n          var userPolicy = msg.body.params.userPolicy;\n\n          if (userPolicy) {\n            _this.context.activeUserPolicy = userPolicy;\n          }\n\n          returnedValue = _this.context.activeUserPolicy;\n        } else if (funcName === 'userPolicy') {\n          var _key2 = msg.body.params.key;\n          returnedValue = _this.context.userPolicies[_key2];\n        } else if (funcName === 'saveActivePolicy') {\n          returnedValue = _this.context.saveActivePolicy();\n        } else if (funcName === 'getMyEmails') {\n          returnedValue = _this.context.getMyEmails();\n        } else if (funcName === 'getMyHyperties') {\n          returnedValue = _this.context.getMyHyperties();\n        } else if (funcName === 'groups') {\n          returnedValue = _this.context.groups;\n        } else if (funcName === 'getGroupsNames') {\n          returnedValue = _this.context.getGroupsNames();\n        }\n\n        if (funcName === 'removeFromGroup') {\n          var _groupName3 = msg.body.params.groupName;\n          var _userEmail = msg.body.params.userEmail;\n          returnedValue = _this.context.removeFromGroup(_groupName3, _userEmail);\n        }\n\n        var value = {\n          type: 'execute',\n          value: returnedValue,\n          code: 200\n        };\n        var replyMsg = {\n          id: msg.id,\n          type: 'response',\n          to: msg.from,\n          from: msg.to,\n          body: value\n        };\n\n        _this.context.messageBus.postMessage(replyMsg);\n      });\n    }\n    /**\r\n    * Adds a policy to the Policy Enforcement Point (PEP). The policy can be created by the service\r\n    * provider or by the user.\r\n    * @param    {String}    source\r\n    * @param    {String}    key\r\n    * @param    {Object}    policy\r\n    */\n\n  }, {\n    key: \"addPolicy\",\n    value: function addPolicy(source, key, policy, combiningAlgorithm) {\n      if (!source) throw new Error('source is not defined');\n      if (!key) throw new Error('key is not defined');\n\n      if (policy === undefined) {\n        policy = new policy_Policy(key, [], [], combiningAlgorithm);\n      } else {\n        if (!(policy instanceof policy_Policy)) {\n          policy = new policy_Policy(policy.key, policy.rules, policy.actions, policy.combiningAlgorithm);\n        }\n      }\n\n      switch (source) {\n        case 'SERVICE_PROVIDER':\n          this.context.savePolicies(source, policy, key);\n          break;\n\n        case 'USER':\n          this.context.userPolicies[key] = policy;\n          this.context.savePolicies(source);\n          break;\n\n        default:\n          throw Error('Unknown policy source: ' + source);\n      }\n    }\n  }, {\n    key: \"authorise\",\n    value: function authorise(message, isIncoming) {\n      var _this2 = this;\n\n      // log.log('[Policy.PEP Authorise] ', message);\n      // log.log(message);\n      if (!message) throw new Error('message is not defined');\n      if (!message.from) throw new Error('message.from is not defined');\n      if (!message.to) throw new Error('message.to is not defined');\n      if (!message.type) throw new Error('message.type is not defined');\n      message.body = message.body || {};\n      return new Promise(function (resolve, reject) {\n        message.body = message.body || {};\n        var _this = _this2;\n\n        var result = _this.pdp.evaluatePolicies(message, isIncoming);\n\n        if (result === 'Not Applicable') {\n          result = _this.context.defaultBehaviour;\n          message.body.auth = false;\n        }\n\n        _this.actionsService.enforcePolicies(message, isIncoming).then(function (messages) {\n          for (var i in messages) {\n            message = messages[i];\n\n            if (result) {\n              message.body.auth = message.body.auth === undefined ? true : message.body.auth;\n              resolve(message);\n            } else {\n              var errorMessage = {\n                body: {\n                  code: 403,\n                  description: 'Blocked by policy'\n                },\n                from: message.to,\n                to: message.from,\n                type: 'response'\n              };\n              reject(errorMessage);\n            }\n          }\n        }, function (error) {\n          reject(error);\n        });\n      });\n    }\n  }, {\n    key: \"authoriseSync\",\n    value: function authoriseSync(message) {\n      var result;\n      message.body = message.body || {};\n      result = this.pdp.evaluatePolicies(message, true);\n\n      if (result === 'Not Applicable') {\n        result = this.context.defaultBehaviour;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"removePolicy\",\n    value: function removePolicy(source, key) {\n      if (!source) throw new Error('source is not defined');\n      if (source !== '*' && !key) throw new Error('key is not defined');\n\n      switch (source) {\n        case '*':\n          this.context.serviceProviderPolicy = {};\n          this.context.userPolicies = {};\n          this.context.activeUserPolicy = undefined;\n          this.context.savePolicies('USER');\n          this.context.savePolicies('SERVICE_PROVIDER');\n          this.context.saveActivePolicy();\n          break;\n\n        case 'SERVICE_PROVIDER':\n          delete this.context.serviceProviderPolicy[key];\n          this.context.savePolicies();\n          break;\n\n        case 'USER':\n          delete this.context.userPolicies[key];\n\n          if (key === this.context.activeUserPolicy) {\n            this.context.activeUserPolicy = undefined;\n            this.context.saveActivePolicy();\n          }\n\n          this.context.savePolicies('USER');\n          break;\n\n        default:\n          throw Error('Unknown policy source: ' + source);\n      }\n    }\n  }, {\n    key: \"messageBus\",\n    get: function get() {\n      var _this = this;\n\n      return _this.context.messageBus;\n    }\n    /**\r\n    * Set the messageBus in this Registry\r\n    * @param {MessageBus}           messageBus\r\n    */\n    ,\n    set: function set(messageBus) {\n      var _this = this;\n\n      _this.context.messageBus = messageBus;\n\n      _this.addGUIListeners();\n    }\n  }]);\n\n  return PEP;\n}();\n\n/* harmony default export */ var policy_PEP = (PEP_PEP);\n// CONCATENATED MODULE: ./src/bus/Pipeline.js\nfunction Pipeline_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Pipeline_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Pipeline_createClass(Constructor, protoProps, staticProps) { if (protoProps) Pipeline_defineProperties(Constructor.prototype, protoProps); if (staticProps) Pipeline_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\nvar Pipeline_log = loglevel[\"getLogger\"]('Pipeline');\n/**\r\n* @author micaelpedrosa@gmail.com\r\n* Sequencial processor of methods. Similar to how Sequential Promise's work, but better fit for message processing.\r\n* Normal use for this, is to intercept all messages with configured handlers, and act accordingly.\r\n*/\n\n\n\nvar Pipeline =\n/*#__PURE__*/\nfunction () {\n  /* public\r\n    handlers: ((PipeContext) => void)[]\r\n    onFail: (error) => void\r\n  */\n  function Pipeline(_onFail) {\n    Pipeline_classCallCheck(this, Pipeline);\n\n    var _this = this;\n\n    _this.handlers = [];\n    _this.onFail = _onFail;\n  }\n  /**\r\n   * Insert a message in the pipeline queue. All messages are wrapped with a PipeContext.\r\n   * @param  {Message} msg       Message for the queue\r\n   * @param  {Callback} onDeliver When message is finished processing from all handlers, it will be delivered in this callback.\r\n   */\n\n\n  Pipeline_createClass(Pipeline, [{\n    key: \"process\",\n    value: function process(msg, onDeliver) {\n      var _this = this;\n\n      if (_this.handlers.length > 0) {\n        var iter = new Iterator(_this.handlers);\n        iter.next(new PipeContext(_this, iter, msg, onDeliver));\n      } else {\n        onDeliver(msg);\n      }\n    }\n  }]);\n\n  return Pipeline;\n}();\n/**\r\n* @author micaelpedrosa@gmail.com\r\n* Wrapper around a message that adds actions that can be fired by any interceptor handler.\r\n* The Pipeline is asynchronous, so an handler should always call an action, the default one is \"next()\"\r\n*/\n\n\nvar PipeContext =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n    _inStop: boolean\r\n      _pipeline: Pipeline\r\n    _iter: Iterator\r\n    _msg: Message\r\n  */\n  function PipeContext(pipeline, iter, msg, onDeliver) {\n    Pipeline_classCallCheck(this, PipeContext);\n\n    var _this = this;\n\n    _this._inStop = false;\n    _this._pipeline = pipeline;\n    _this._iter = iter;\n    _this._msg = msg;\n    _this._onDeliver = onDeliver;\n  }\n\n  Pipeline_createClass(PipeContext, [{\n    key: \"next\",\n\n    /**\r\n     * Proceed to the next interceptor handler, unless there was an error. If it's the last one, proceed to onDeliver handler.\r\n     */\n    value: function next() {\n      var _this = this;\n\n      if (!_this._inStop) {\n        if (_this._iter.hasNext) {\n          _this._iter.next(_this);\n        } else {\n          _this._onDeliver(_this._msg);\n        }\n      }\n    }\n    /**\r\n     * Proceed directly to the onDeliver handler, unless there was an error.\r\n     */\n\n  }, {\n    key: \"deliver\",\n    value: function deliver() {\n      var _this = this;\n\n      if (!_this._inStop) {\n        _this._inStop = true;\n\n        _this._onDeliver(_this._msg);\n      }\n    }\n    /**\r\n     * Mark the context with an error and proceed to the onFail handler.\r\n     * @param  {[type]} error [description]\r\n     */\n\n  }, {\n    key: \"fail\",\n    value: function fail(error) {\n      var _this = this;\n\n      if (!_this._inStop) {\n        _this._inStop = true;\n\n        if (_this._pipeline.onFail) {\n          _this._pipeline.onFail(error);\n        }\n      }\n    }\n  }, {\n    key: \"pipeline\",\n    get: function get() {\n      return this._pipeline;\n    }\n  }, {\n    key: \"msg\",\n    get: function get() {\n      return this._msg;\n    },\n    set: function set(inMsg) {\n      this._msg = inMsg;\n    }\n  }]);\n\n  return PipeContext;\n}();\n\nvar Iterator =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n    _index: number\r\n    _array: []\r\n  */\n  function Iterator(array) {\n    Pipeline_classCallCheck(this, Iterator);\n\n    this._index = -1;\n    this._array = array;\n  }\n\n  Pipeline_createClass(Iterator, [{\n    key: \"hasNext\",\n    get: function get() {\n      return this._index < this._array.length - 1;\n    }\n  }, {\n    key: \"next\",\n    get: function get() {\n      this._index++;\n      return this._array[this._index];\n    }\n  }]);\n\n  return Iterator;\n}();\n\n/* harmony default export */ var bus_Pipeline = (Pipeline);\n// CONCATENATED MODULE: ./src/bus/MessageBus.js\nfunction MessageBus_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { MessageBus_typeof = function _typeof(obj) { return typeof obj; }; } else { MessageBus_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return MessageBus_typeof(obj); }\n\nfunction MessageBus_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction MessageBus_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction MessageBus_createClass(Constructor, protoProps, staticProps) { if (protoProps) MessageBus_defineProperties(Constructor.prototype, protoProps); if (staticProps) MessageBus_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction MessageBus_possibleConstructorReturn(self, call) { if (call && (MessageBus_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return MessageBus_assertThisInitialized(self); }\n\nfunction MessageBus_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction MessageBus_getPrototypeOf(o) { MessageBus_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return MessageBus_getPrototypeOf(o); }\n\nfunction MessageBus_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) MessageBus_setPrototypeOf(subClass, superClass); }\n\nfunction MessageBus_setPrototypeOf(o, p) { MessageBus_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return MessageBus_setPrototypeOf(o, p); }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log system\n\nvar MessageBus_log = loglevel[\"getLogger\"]('MessageBus');\n\n\n/**\r\n* @author micaelpedrosa@gmail.com\r\n* Message BUS Interface is an extension of the Bus\r\n* It doesn't support the default '*' listener, instead it uses the registry.resolve(..)\r\n*/\n\nvar MessageBus_MessageBus =\n/*#__PURE__*/\nfunction (_Bus) {\n  MessageBus_inherits(MessageBus, _Bus);\n\n  /* private\r\n  _registry: Registry\r\n  _forwards: { <from-url>: { fl: MsgListener, sandboxToUrls: Map(Sandbox, [to-url]), urlToSandbox: { to-url: Sandbox } } }\r\n    _pipeline: Pipeline\r\n  */\n  //TODO: future optimization\n  //1. message batch processing with setInterval\n  //2. resolve default gateway/protostub with register.resolve\n  function MessageBus(registry) {\n    var _this2;\n\n    MessageBus_classCallCheck(this, MessageBus);\n\n    _this2 = MessageBus_possibleConstructorReturn(this, MessageBus_getPrototypeOf(MessageBus).call(this));\n    _this2._registry = registry;\n    _this2._forwards = {};\n    _this2._pipelineIn = new bus_Pipeline(function (error) {\n      MessageBus_log.error('PIPELINE-ERROR: ', JSON.stringify(error));\n    });\n    _this2._pipelineOut = new bus_Pipeline(function (error) {\n      MessageBus_log.error('PIPELINE-ERROR: ', JSON.stringify(error));\n    });\n    return _this2;\n  }\n\n  MessageBus_createClass(MessageBus, [{\n    key: \"postMessage\",\n\n    /**\r\n     * Post a message for routing. It will first search for a listener, if there is no one, it sends to a external routing using the _onPostMessage.\r\n     * External routing use the registry.resolve(..) method to decide the destination sandbox.\r\n     * @param  {Message} inMsg            JSON with mandatory Message structure {id, type, from, to}\r\n     * @param  {Callback} responseCallback Optional callback if a response is expected from the request. A response will be always sent, even if it is a \"Timeout\".\r\n     * @return {number}                  the Message id\r\n     */\n    value: function postMessage(inMsg, responseCallback, timeout) {\n      MessageBus_log.info('onPOSTMessage: ', inMsg);\n\n      var _this = this;\n\n      var deliver = function deliver(msg) {\n        _this._responseCallback(inMsg, responseCallback, timeout);\n\n        if (!_this._onResponse(msg)) {\n          var itemList = _this._subscriptions[msg.to];\n\n          if (itemList) {\n            //do not publish on default address, because of loopback cycle\n            _this._publishOn(itemList, msg);\n          } else {\n            //if there is no listener, send to external interface\n            _this._onPostMessage(msg);\n          }\n        }\n      };\n\n      _this._genId(inMsg);\n\n      if (_this._isToProcess(inMsg)) {\n        var isIncoming = _this._isIncomingMessage(inMsg);\n\n        if (isIncoming) _this._pipelineIn.process(inMsg, deliver);else _this._pipelineOut.process(inMsg, deliver);\n      } else deliver(inMsg);\n\n      return inMsg.id;\n    }\n  }, {\n    key: \"_isToProcess\",\n    value: function _isToProcess(message) {\n      var schemasToIgnore = ['domain', 'domain-idp', 'global', 'hyperty-runtime', 'runtime'];\n      var splitFrom = message.from.split('://');\n      var fromSchema = splitFrom[0];\n      var splitTo = message.to.split('://');\n      var toSchema = splitTo[0];\n      var from = message.from;\n      var to = message.to; // Signalling messages between P2P Stubs don't have to be verified. FFS\n\n      if (message.body && message.body.source) {\n        from = message.body.source;\n      }\n\n      if (message.body && message.body.subscriber) {\n        from = message.body.subscriber;\n      }\n\n      if (from.indexOf('/p2phandler/') !== -1 || from.indexOf('/p2prequester/') !== -1 || to.indexOf('/p2phandler/') !== -1 || to.indexOf('/p2prequester/') !== -1) {\n        return false;\n      }\n\n      if (this._registry.isLocal(from) && this._registry.isLocal(message.to)) return false;\n\n      if (message.from === fromSchema || message.to === toSchema || message.type === 'read' || message.type === 'response' || message.from.includes('hyperty://') && message.type === 'delete') {\n        return false;\n      } else {\n        return schemasToIgnore.indexOf(fromSchema) === -1 || schemasToIgnore.indexOf(toSchema) === -1;\n      }\n    }\n  }, {\n    key: \"_isIncomingMessage\",\n    value: function _isIncomingMessage(message) {\n      var from;\n\n      if (message.type === 'forward') {\n        MessageBus_log.info('[MessageBus - isIncomingMessage] - message.type: ', message.type);\n        from = message.body.from;\n      } else if (message.hasOwnProperty('body') && message.body.hasOwnProperty('source') && message.body.source) {\n        MessageBus_log.info('[MessageBus - isIncomingMessage] - message.body.source: ', message.body.source);\n        from = message.body.source;\n      } else if (message.hasOwnProperty('body') && message.body.hasOwnProperty('subscriber') && message.body.subscriber) {\n        //TODO: this subscriber validation should not exist, because is outdated\n        //TODO: the syncher and syncher manager not following the correct spec;\n        MessageBus_log.info('[MessageBus - isIncomingMessage] - message.body.subscriber: ', message.body.subscriber);\n        from = message.body.subscriber;\n      } else if (message.hasOwnProperty('body') && message.body.hasOwnProperty('reporter') && message.body.reporter) {\n        //TODO: this subscriber validation should not exist, because is outdated\n        //TODO: the syncher and syncher manager not following the correct spec;\n        MessageBus_log.info('[MessageBus - isIncomingMessage] - message.body.reporter: ', message.body.reporter);\n        from = message.body.reporter;\n      } else {\n        MessageBus_log.info('[MessageBus - isIncomingMessage] - message.from ', message.from);\n        from = message.from;\n      }\n\n      MessageBus_log.info('[MessageBus - isIncomingMessage] - check if isLocal: ', from);\n      return !this._registry.isLocal(from);\n    }\n    /**\r\n     * Adds an external publish address listener. Every message for the address will be forwarded to the external routing by _onPostMessage.\r\n     * This means, even if there is a listener for the address, it will also send the message to the external routing.\r\n     * @param {URL} from Publish address.\r\n     */\n\n  }, {\n    key: \"addPublish\",\n    value: function addPublish(from) {\n      var _this3 = this;\n\n      var _this = this; //verify if forward exist\n\n\n      var refCount = _this._forwards[from];\n\n      if (!refCount) {\n        var forwardListener = _this.addListener(from, function (msg) {\n          MessageBus_log.info('MB-PUBLISH: ( ' + from + ' )');\n\n          _this._onPostMessage(msg);\n        });\n\n        refCount = {\n          counter: 0,\n          fl: forwardListener,\n          remove: function remove() {\n            _this3.counter--;\n\n            if (_this3.counter === 0) {\n              _this3.fl.remove();\n\n              delete _this._forwards[from];\n            }\n          }\n        };\n        _this._forwards[from] = refCount;\n      }\n\n      refCount.counter++;\n      return refCount;\n    }\n    /**\r\n     * Adds a forward listener for a message destination. Every message reaching an address will be also sent to the forward address.\r\n     * @param {URL} from Message destination, it's actually the field \"to\" of the message.\r\n     * @param {URL} to   Forward address.\r\n     */\n\n  }, {\n    key: \"addForward\",\n    value: function addForward(from, to) {\n      var _this = this;\n\n      return _this.addListener(from, function (msg) {\n        MessageBus_log.info('MB-FORWARD: ( ' + from + ' to ' + to + ' )');\n\n        _this.forward(to, msg);\n      });\n    }\n    /**\r\n     * Just forward's a message to the forward address. Listeners should be available for the forward address.\r\n     * @param  {URL} url Forward address.\r\n     * @param  {Message} msg Message to forward\r\n     */\n\n  }, {\n    key: \"forward\",\n    value: function forward(url, msg) {\n      var _this = this;\n\n      var itemList = _this._subscriptions[url];\n\n      if (itemList) {\n        _this._publishOn(itemList, msg);\n      }\n    } //default route, if there are no listeners available for a message destination.\n\n  }, {\n    key: \"_onPostMessage\",\n    value: function _onPostMessage(msg) {\n      var _this = this; //resolve external protostub...\n\n\n      _this._registry.resolve(msg).then(function (route, msg2route) {\n        if (msg2route) _this.forward(route, msg2route);else _this.forward(route, msg);\n      }).catch(function (e) {\n        MessageBus_log.error('RESOLVE-ERROR: ', e);\n      });\n    }\n  }, {\n    key: \"pipelineIn\",\n    get: function get() {\n      return this._pipelineIn;\n    }\n  }, {\n    key: \"pipelineOut\",\n    get: function get() {\n      return this._pipelineOut;\n    }\n  }]);\n\n  return MessageBus;\n}(bus_Bus);\n\n/* harmony default export */ var bus_MessageBus = (MessageBus_MessageBus);\n// CONCATENATED MODULE: ./src/cryptoManager/utf8.js\n// Marshals a string to Uint8Array.\nfunction encodeUTF8(s) {\n  var i = 0;\n  var bytes = new Uint8Array(s.length * 4);\n\n  for (var ci = 0; ci != s.length; ci++) {\n    try {\n      var xxx = s.charCodeAt(ci);\n    } catch (err) {\n      console.log(err.message);\n      return;\n    }\n\n    var c = s.charCodeAt(ci);\n\n    if (c < 128) {\n      bytes[i++] = c;\n      continue;\n    }\n\n    if (c < 2048) {\n      bytes[i++] = c >> 6 | 192;\n    } else {\n      if (c > 0xd7ff && c < 0xdc00) {\n        if (++ci == s.length) throw 'UTF-8 encode: incomplete surrogate pair';\n        var c2 = s.charCodeAt(ci);\n        if (c2 < 0xdc00 || c2 > 0xdfff) throw 'UTF-8 encode: second char code 0x' + c2.toString(16) + ' at index ' + ci + ' in surrogate pair out of range';\n        c = 0x10000 + ((c & 0x03ff) << 10) + (c2 & 0x03ff);\n        bytes[i++] = c >> 18 | 240;\n        bytes[i++] = c >> 12 & 63 | 128;\n      } else {\n        // c <= 0xffff\n        bytes[i++] = c >> 12 | 224;\n      }\n\n      bytes[i++] = c >> 6 & 63 | 128;\n    }\n\n    bytes[i++] = c & 63 | 128;\n  }\n\n  return bytes.subarray(0, i);\n} // Unmarshals an Uint8Array to string.\n\nfunction decodeUTF8(bytes) {\n  var s = '';\n  var i = 0;\n\n  while (i < bytes.length) {\n    var c = bytes[i++];\n\n    if (c > 127) {\n      if (c > 191 && c < 224) {\n        if (i >= bytes.length) throw 'UTF-8 decode: incomplete 2-byte sequence';\n        c = (c & 31) << 6 | bytes[i] & 63;\n      } else if (c > 223 && c < 240) {\n        if (i + 1 >= bytes.length) throw 'UTF-8 decode: incomplete 3-byte sequence';\n        c = (c & 15) << 12 | (bytes[i] & 63) << 6 | bytes[++i] & 63;\n      } else if (c > 239 && c < 248) {\n        if (i + 2 >= bytes.length) throw 'UTF-8 decode: incomplete 4-byte sequence';\n        c = (c & 7) << 18 | (bytes[i] & 63) << 12 | (bytes[++i] & 63) << 6 | bytes[++i] & 63;\n      } else throw 'UTF-8 decode: unknown multibyte start 0x' + c.toString(16) + ' at index ' + (i - 1);\n\n      ++i;\n    }\n\n    if (c <= 0xffff) s += String.fromCharCode(c);else if (c <= 0x10ffff) {\n      c -= 0x10000;\n      s += String.fromCharCode(c >> 10 | 0xd800);\n      s += String.fromCharCode(c & 0x3FF | 0xdc00);\n    } else throw 'UTF-8 decode: code point 0x' + c.toString(16) + ' exceeds UTF-16 reach';\n  }\n\n  return s;\n}\n// CONCATENATED MODULE: ./src/cryptoManager/Crypto.js\nfunction Crypto_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Crypto_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Crypto_createClass(Constructor, protoProps, staticProps) { if (protoProps) Crypto_defineProperties(Constructor.prototype, protoProps); if (staticProps) Crypto_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\nvar Crypto_log = loglevel[\"getLogger\"]('CryptoManager');\n/**\r\n* Class with the cryptographic functions for the authentication protocol\r\n*\r\n*/\n\nvar Crypto_Crypto =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * Runtimefactory is passed in the costructor, because the nodeJS has a different crypto module\r\n  * from the browser. RuntimeFactory provides a wrapper for the fuctions of nodeJS, so they can be\r\n  * invoked browser like.\r\n  */\n  function Crypto(runtimeFactory) {\n    Crypto_classCallCheck(this, Crypto);\n\n    var _this = this;\n\n    typeof runtimeFactory.createWebcrypto === 'function' ? _this._crypto = runtimeFactory.createWebcrypto() : _this._crypto = crypto;\n  }\n  /**\r\n  * Performs a RSA encryption\r\n  * @param   {ArrayBuffer}    value    the public key\r\n  * @param   {BufferSource}    value    data to be encryped\r\n  * @return  {Uint8Array}   encrypted data\r\n  */\n\n\n  Crypto_createClass(Crypto, [{\n    key: \"encryptRSA\",\n    value: function encryptRSA(pubKey, data) {\n      Crypto_log.log('encryptRSA:pubKey', pubKey);\n      Crypto_log.log('encryptRSA:data', data);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._importRSAencryptKey(new Uint8Array(pubKey)).then(function (publicKey) {\n          _this._crypto.subtle.encrypt({\n            name: 'RSA-OAEP'\n          }, publicKey, //from generateKey or importKey above\n          data //ArrayBuffer of data you want to encrypt\n          ).then(function (encrypted) {\n            //returns an ArrayBuffer containing the encrypted data\n            // log.log('crypto-encryptRSA', new Uint8Array(encrypted));\n            resolve(new Uint8Array(encrypted));\n          }).catch(function (err) {\n            // log.log('crypto-encryptRSA', err);\n            reject(err);\n          });\n        });\n      });\n    }\n    /**\r\n    * Performs a RSA decryption\r\n    * @param   {ArrayBuffer}    value    the private key\r\n    * @param   {BufferSource}    value    data to be decrypted\r\n    * @return  {Uint8Array}   decrypted data\r\n    */\n\n  }, {\n    key: \"decryptRSA\",\n    value: function decryptRSA(privKey, data) {\n      Crypto_log.log('decryptRSA:privKey', privKey);\n      Crypto_log.log('decryptRSA:data', data);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._importRSAdecryptKey(privKey).then(function (privateKey) {\n          _this._crypto.subtle.decrypt({\n            name: 'RSA-OAEP'\n          }, privateKey, //from generateKey or importKey above\n          data //ArrayBuffer of the data\n          ).then(function (decrypted) {\n            var decryptedData = new Uint8Array(decrypted); // log.log('crypto-decryptRSA', decryptedData);\n\n            resolve(decryptedData);\n          }).catch(function (err) {\n            // log.log('crypto-decryptRSA', err);\n            reject(err);\n          });\n        });\n      });\n    }\n    /**\r\n    * Performs a RSA sign\r\n    * @param   {ArrayBuffer}    value    the private key\r\n    * @param   {BufferSource}    value    data to be signed\r\n    * @return  {Uint8Array}   data signature\r\n    */\n\n  }, {\n    key: \"signRSA\",\n    value: function signRSA(privKey, data) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._importRSAsignKey(privKey).then(function (privateKey) {\n          _this._crypto.subtle.sign({\n            name: 'RSASSA-PKCS1-v1_5'\n          }, privateKey, //from generateKey or importKey above\n          encodeUTF8(data) //ArrayBuffer of data you want to sign\n          ).then(function (signature) {\n            //returns an ArrayBuffer containing the signature\n            // log.log('crypto-signRSA', new Uint8Array(signature));\n            resolve(new Uint8Array(signature));\n          }).catch(function (err) {\n            // log.log('crypto-signRSA', err);\n            reject(err);\n          });\n        });\n      });\n    }\n    /**\r\n    * Performs a RSA signature verification\r\n    * @param   {ArrayBuffer}    value    the public key\r\n    * @param   {BufferSource}    value    data to be verified\r\n    * @return  {Boolean}   result of the signature verification\r\n    */\n\n  }, {\n    key: \"verifyRSA\",\n    value: function verifyRSA(pubKey, data, signature) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._importRSAverifyKey(pubKey).then(function (publicKey) {\n          _this._crypto.subtle.verify({\n            name: 'RSASSA-PKCS1-v1_5'\n          }, publicKey, //from generateKey or importKey above\n          signature, //ArrayBuffer of the signature\n          encodeUTF8(data) //ArrayBuffer of the data\n          ).then(function (isvalid) {\n            //returns a boolean on whether the signature is true or not\n            // log.log('crypto-verifyRSA', isvalid);\n            resolve(isvalid);\n          }).catch(function (err) {\n            // log.log('crypto-verifyRSA', err);\n            reject(err);\n          });\n        });\n      });\n    }\n    /**\r\n    * Performs a RSA signature verification\r\n    * @param   {ArrayBuffer}    value    the public key\r\n    * @param   {BufferSource}    value    data to be verified\r\n    * @return  {Boolean}   result of the signature verification\r\n    */\n\n  }, {\n    key: \"encryptAES\",\n    value: function encryptAES(key, data, iv) {\n      Crypto_log.log('encryptAES:key', key);\n      Crypto_log.log('encryptAES:data', data);\n      Crypto_log.log('encryptAES:iv', iv);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._importAESkey(key).then(function (aesKey) {\n          _this._crypto.subtle.encrypt({\n            name: 'AES-CBC',\n            //Don't re-use initialization vectors!\n            //Always generate a new iv every time your encrypt!\n            iv: iv\n          }, aesKey, //from generateKey or importKey above\n          encodeUTF8(data) //ArrayBuffer of data you want to encrypt\n          ).then(function (encrypted) {\n            //returns an ArrayBuffer containing the encrypted data\n            // log.log('crypto-encryptAES', new Uint8Array(encrypted));\n            resolve(new Uint8Array(encrypted));\n          }).catch(function (err) {\n            // log.log('crypto-encryptAES', err);\n            reject(err);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"decryptAES\",\n    value: function decryptAES(key, data, iv) {\n      Crypto_log.log('decryptAES:key', key);\n      Crypto_log.log('decryptAES:data', data);\n      Crypto_log.log('decryptAES:iv', iv);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._importAESkey(key).then(function (aesKey) {\n          _this._crypto.subtle.decrypt({\n            name: 'AES-CBC',\n            iv: iv\n          }, aesKey, //from generateKey or importKey above\n          data //ArrayBuffer of the data\n          ).then(function (decrypted) {\n            var decodedData = decodeUTF8(new Uint8Array(decrypted));\n            Crypto_log.log('crypto-decryptAES', decodedData);\n            resolve(decodedData);\n          }).catch(function (err) {\n            // log.log('crypto-decryptAES', err);\n            reject(err);\n          });\n        });\n      });\n    }\n    /**\r\n    * creates a hash using the HMAC algorithm\r\n    * @param  {byteArray}    key       key to be used in the hmac\r\n    * @param  {string}      data       information to be hashed\r\n    * @return  {byteArray}   signature  resulting hash\r\n    */\n\n  }, {\n    key: \"hashHMAC\",\n    value: function hashHMAC(key, data) {\n      Crypto_log.log('hashHMAC:key', key);\n      Crypto_log.log('hashHMAC:data', data);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (typeof data != 'string') {\n          data = JSON.stringify(data);\n          Crypto_log.log('Converting hashHMAC inpured DATA');\n          Crypto_log.log('HHashHMAC:', data);\n        }\n\n        _this._importHMACkey(key).then(function (hmacKey) {\n          _this._crypto.subtle.sign({\n            name: 'HMAC'\n          }, hmacKey, //from generateKey or importKey above\n          encodeUTF8(data) //ArrayBuffer of data you want to sign\n          ).then(function (signature) {\n            Crypto_log.log('HashHMAC signature:', new Uint8Array(signature)); // log.log('crypto-hashHMAC', signature);\n            //returns an ArrayBuffer containing the signature\n\n            resolve(new Uint8Array(signature));\n          }).catch(function (err) {\n            // log.log('crypto-hashHMAC', err);\n            reject(err);\n          });\n        });\n      });\n    }\n    /**\r\n    * verifies an hash using the HMAC algorithm\r\n    * @param  {byteArray}    key       key to be used in the hmac\r\n    * @param  {string}      data       information to be hashed to compare\r\n    * @param  {byteArray}  signature   hash to compare with the received data\r\n    * @return  {boolean}   isvalid     boolean saying if the data corresponds to the hash received\r\n    */\n\n  }, {\n    key: \"verifyHMAC\",\n    value: function verifyHMAC(key, data, signature) {\n      Crypto_log.log('verifyHMAC:key', key);\n      Crypto_log.log('verifyHMAC:data', data);\n      Crypto_log.log('verifyHMAC:signature', signature);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._importHMACkey(key).then(function (hmacKey) {\n          if (typeof data != 'string') {\n            data = JSON.stringify(data);\n            Crypto_log.log('Converting verifyHMAC inputed DATA:', data);\n          }\n\n          _this._crypto.subtle.verify({\n            name: 'HMAC'\n          }, hmacKey, //from generateKey or importKey above\n          signature, //ArrayBuffer of the signature\n          encodeUTF8(data) //ArrayBuffer of the data\n          ).then(function (isvalid) {\n            //returns a boolean on whether the signature is true or not\n            // log.log('crypto-verifyHMAC', isvalid);\n            Crypto_log.log('verifyHMAC result', isvalid);\n            isvalid ? resolve(isvalid) : reject(isvalid);\n          }).catch(function (err) {\n            Crypto_log.error('crypto-verifyHMAC', err);\n            reject(err);\n          });\n        });\n      });\n    }\n    /**\r\n    * generates a RSA public/private key pair with a modulus length of 2048 bits\r\n    * @return  {JSON}   keyPair    json containing the public and private keys\r\n    */\n\n  }, {\n    key: \"generateRSAKeyPair\",\n    value: function generateRSAKeyPair() {\n      var _this = this;\n\n      var keyPair = {};\n      return new Promise(function (resolve, reject) {\n        _this._crypto.subtle.generateKey({\n          name: 'RSA-PSS',\n          modulusLength: 2048,\n          //can be 1024, 2048, or 4096\n          publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n          hash: {\n            name: 'SHA-256' //can be 'SHA-1', 'SHA-256', 'SHA-384', or 'SHA-512'\n\n          }\n        }, true, //whether the key is extractable (i.e. can be used in exportKey)\n        ['sign', 'verify'] //can be any combination of 'sign' and 'verify'\n        ).then(function (key) {\n          //returns a keypair object\n          // log.log(key);\n          _this._crypto.subtle.exportKey('spki', //can be 'jwk' (public or private), 'spki' (public only), or 'pkcs8' (private only)\n          key.publicKey //can be a publicKey or privateKey, as long as extractable was true\n          ).then(function (publicKey) {\n            //returns the exported key data\n            keyPair.public = new Uint8Array(publicKey);\n            return _this._crypto.subtle.exportKey('pkcs8', //can be 'jwk' (public or private), 'spki' (public only), or 'pkcs8' (private only)\n            key.privateKey //can be a publicKey or privateKey, as long as extractable was true\n            );\n          }).then(function (privateKey) {\n            keyPair.private = new Uint8Array(privateKey); // log.log('crypto-generateRSAKeyPair', keyPair);\n\n            resolve(keyPair);\n          }).catch(function (err) {\n            Crypto_log.error(err);\n            reject(err);\n          });\n        }).catch(function (err) {\n          Crypto_log.error(err);\n          reject(err);\n        });\n      });\n    }\n    /**\r\n    * Generates a 128 bit random value.\r\n    * @return {byteArray}  array    random value\r\n    */\n\n  }, {\n    key: \"generateIV\",\n    value: function generateIV() {\n      var _this = this;\n\n      var array = new Uint8Array(16);\n\n      _this._crypto.getRandomValues(array);\n\n      return array;\n    }\n    /**\r\n    * Generates a 256 bit random value. 32 bits are extrated from the machine time,\r\n    * the remaining are generated randomly\r\n    * @return {byteArray}  array    random value\r\n    */\n\n  }, {\n    key: \"generateRandom\",\n    value: function generateRandom() {\n      var _this = this;\n\n      var array = new Uint8Array(32);\n\n      _this._crypto.getRandomValues(array);\n\n      var date = Date.now();\n      var dateEncoded = encodeUTF8(date.toString()); //extract the least significant 4 bytes in the date\n\n      var finalDate = dateEncoded.slice(dateEncoded.length - 4, dateEncoded.length); // add in the first 4 bytes of the array the bytes extracted previously;\n\n      for (var i = 0; i < 4; i++) {\n        array[i] = finalDate[i];\n      }\n\n      return array;\n    }\n    /**\r\n    * generates a premaster secret (PMS) of 48 bytes (384 bits) randomly\r\n    * @return {byteArray}  array    premaster secret key\r\n    */\n\n  }, {\n    key: \"generatePMS\",\n    value: function generatePMS() {\n      var _this = this;\n\n      var array = new Uint8Array(48);\n\n      _this._crypto.getRandomValues(array);\n\n      return array;\n    }\n    /**\r\n    * generates a masterKey secret (PMS) of 48 bytes (384 bits) using the premaster secret and\r\n    * two randoms\r\n    * @return {byteArray}  array    master secret key with 48 bytes\r\n    */\n\n  }, {\n    key: \"generateMasterSecret\",\n    value: function generateMasterSecret(hmacKey, data) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var key = new Uint8Array(48);\n        var seed = data;\n\n        _this._digest(hmacKey).then(function (digestedKey) {\n          _this.hashHMAC(digestedKey, seed).then(function (keypart0) {\n            //copy the first 32 bytes into the key\n            for (var i = 0; i < 32; i++) {\n              key[i] = keypart0[i];\n            }\n\n            return _this.hashHMAC(digestedKey, seed + keypart0);\n          }).then(function (keypart1) {\n            //copy the first 16 bytes to the key remaining 16 bytes\n            for (var i = 0; i < 16; i++) {\n              key[i + 32] = keypart1[i];\n            } // log.log('crypto-generateMasterSecret', key);\n\n\n            resolve(key);\n          }).catch(function (err) {\n            // log.log('crypto-generateMasterSecret', err);\n            reject(err);\n          });\n        });\n      });\n    }\n    /**\r\n    * generates both users MAC and encryption keys. generate as output an array\r\n    * with 4 byteArray each with 32 bytes\r\n    * @param  {byteArray}        secret       secret to be used in the HMAC function\r\n    * @param  {String}           data         information to be used as seed\r\n    * @return {Array<byteArray>} key          array with the information to generate keys\r\n    */\n\n  }, {\n    key: \"generateKeys\",\n    value: function generateKeys(hmacKey, data) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var key = [];\n        var seed = data; // iterate 4 times to obtain a 1024 key size\n\n        _this.hashHMAC(hmacKey, seed).then(function (keypart0) {\n          key.push(keypart0);\n          return _this.hashHMAC(hmacKey, seed + keypart0);\n        }).then(function (keypart1) {\n          key.push(keypart1);\n          return _this.hashHMAC(hmacKey, seed + keypart1);\n        }).then(function (keypart2) {\n          key.push(keypart2);\n          return _this.hashHMAC(hmacKey, seed + keypart2);\n        }).then(function (keypart3) {\n          key.push(keypart3); // log.log('crypto-generateKeys', key);\n\n          resolve(key);\n        }).catch(function (err) {\n          // log.log('crypto-generateKeys', err);\n          reject(err);\n        }); // log.log(hmacKey, data);\n\n      });\n    }\n  }, {\n    key: \"_importRSAsignKey\",\n    value: function _importRSAsignKey(privKey) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._crypto.subtle.importKey('pkcs8', //can be 'jwk' (public or private), 'spki' (public only), or 'pkcs8' (private only)\n        privKey, {\n          //these are the algorithm options\n          name: 'RSASSA-PKCS1-v1_5',\n          hash: {\n            name: 'SHA-256' //can be 'SHA-1', 'SHA-256', 'SHA-384', or 'SHA-512'\n\n          }\n        }, true, //whether the key is extractable (i.e. can be used in exportKey)\n        ['sign'] //'verify' for public key import, 'sign' for private key imports\n        ).then(function (privateKey) {\n          //returns a publicKey (or privateKey if you are importing a private key)\n          // log.log('crypto-_importRSAsignKey', privateKey);\n          resolve(privateKey);\n        }).catch(function (err) {\n          Crypto_log.error('crypto-_importRSAsignKey', err);\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"_importRSAverifyKey\",\n    value: function _importRSAverifyKey(pubKey) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._crypto.subtle.importKey('spki', //can be 'jwk' (public or private), 'spki' (public only), or 'pkcs8' (private only)\n        pubKey, {\n          //these are the algorithm options\n          name: 'RSASSA-PKCS1-v1_5',\n          hash: {\n            name: 'SHA-256' //can be 'SHA-1', 'SHA-256', 'SHA-384', or 'SHA-512'\n\n          }\n        }, true, //whether the key is extractable (i.e. can be used in exportKey)\n        ['verify'] //'verify' for public key import, 'sign' for private key imports\n        ).then(function (publicKey) {\n          //returns a publicKey (or privateKey if you are importing a private key)\n          // log.log('crypto-_importRSAverifyKey', publicKey);\n          resolve(publicKey);\n        }).catch(function (err) {\n          Crypto_log.error('crypto-_importRSAverifyKey', err);\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"_importRSAencryptKey\",\n    value: function _importRSAencryptKey(pubKey) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._crypto.subtle.importKey('spki', //can be 'jwk' (public or private), 'spki' (public only), or 'pkcs8' (private only)\n        pubKey, {\n          //these are the algorithm options\n          name: 'RSA-OAEP',\n          hash: {\n            name: 'SHA-256' //can be 'SHA-1', 'SHA-256', 'SHA-384', or 'SHA-512'\n\n          }\n        }, true, //whether the key is extractable (i.e. can be used in exportKey)\n        ['encrypt'] //'encrypt' or 'wrapKey' for public key import or\n        //'decrypt' or 'unwrapKey' for private key imports\n        ).then(function (publicKey) {\n          //returns a publicKey (or privateKey if you are importing a private key)\n          // log.log('crypto-_importRSAencryptKey', publicKey);\n          resolve(publicKey);\n        }).catch(function (err) {\n          Crypto_log.error('crypto-_importRSAencryptKey', err.name);\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"_importRSAdecryptKey\",\n    value: function _importRSAdecryptKey(privKey) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._crypto.subtle.importKey('pkcs8', //can be 'jwk' (public or private), 'spki' (public only), or 'pkcs8' (private only)\n        privKey, {\n          //these are the algorithm options\n          name: 'RSA-OAEP',\n          hash: {\n            name: 'SHA-256' //can be 'SHA-1', 'SHA-256', 'SHA-384', or 'SHA-512'\n\n          }\n        }, true, //whether the key is extractable (i.e. can be used in exportKey)\n        ['decrypt'] //'encrypt' or 'wrapKey' for public key import or\n        //'decrypt' or 'unwrapKey' for private key imports\n        ).then(function (privateKey) {\n          //returns a publicKey (or privateKey if you are importing a private key)\n          // log.log('crypto-_importRSAdecryptKey', privateKey);\n          resolve(privateKey);\n        }).catch(function (err) {\n          Crypto_log.error('crypto-_importRSAdecryptKey', err);\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"concatPMSwithRandoms\",\n    value: function concatPMSwithRandoms(pms, toRandom, fromRandom) {\n      var finalKey = new Uint8Array(pms.length + toRandom.length + fromRandom.length); // add PremasterKey\n\n      for (var i = 0; i < pms.length; i++) {\n        finalKey[i] = pms[i];\n      } //add to random\n\n\n      for (var _i = 0; _i < toRandom.length; _i++) {\n        finalKey[_i + pms.length] = pms[_i];\n      } //add from random\n\n\n      for (var _i2 = 0; _i2 < fromRandom.length; _i2++) {\n        finalKey[_i2 + pms.length + toRandom.length] = pms[_i2];\n      }\n\n      return finalKey;\n    }\n  }, {\n    key: \"_generate256bitKey\",\n    value: function _generate256bitKey() {\n      var _this = this;\n\n      var array = new Uint8Array(32);\n\n      _this._crypto.getRandomValues(array);\n\n      return array;\n    }\n    /**\r\n    * imports the secret to the HMAC function\r\n    * @param  {byteArray}   arrayBuffer     bytes to import as key\r\n    * @return {JSON}       key              key ready to be used in the HMAC cryptographic function\r\n    */\n\n  }, {\n    key: \"_importHMACkey\",\n    value: function _importHMACkey(arrayBuffer) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._digest(arrayBuffer).then(function (key) {\n          _this._crypto.subtle.importKey('raw', //can be 'jwk' or 'raw'\n          key, {\n            //this is the algorithm options\n            name: 'HMAC',\n            hash: {\n              name: 'SHA-256'\n            },\n            //can be 'SHA-1', 'SHA-256', 'SHA-384', or 'SHA-512'\n            length: 256 //optional, if you want your key length to differ from the hash function's block length\n\n          }, true, //whether the key is extractable (i.e. can be used in exportKey)\n          ['sign', 'verify'] //can be any combination of 'sign' and 'verify'\n          ).then(function (key) {\n            //returns the symmetric key\n            // log.log('crypto-_importHMACkey', key);\n            resolve(key);\n          }).catch(function (err) {\n            reject(err);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"_digest\",\n    value: function _digest(value) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._crypto.subtle.digest({\n          name: 'SHA-256'\n        }, value //The data you want to hash as an ArrayBuffer\n        ).then(function (hash) {\n          //returns the hash as an ArrayBuffer\n          // log.log('crypto-digest', new Uint8Array(hash));\n          resolve(new Uint8Array(hash));\n        }).catch(function (err) {\n          Crypto_log.error(err);\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"_importAESkey\",\n    value: function _importAESkey(arrayBuffer) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._crypto.subtle.importKey('raw', //can be 'jwk' or 'raw'\n        arrayBuffer, {\n          //this is the algorithm options\n          name: 'AES-CBC'\n        }, true, //whether the key is extractable (i.e. can be used in exportKey)\n        ['encrypt', 'decrypt'] //can be 'encrypt', 'decrypt', 'wrapKey', or 'unwrapKey'\n        ).then(function (key) {\n          //returns the symmetric key\n          // log.log('crypto-importAESkey', key);\n          resolve(key);\n        }).catch(function (err) {\n          Crypto_log.error('crypto-importAESkey', err);\n          reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"_sha256\",\n    value: function _sha256(str) {\n      var _this = this;\n\n      var buffer = new TextEncoder('utf-8').encode(str);\n      return _this._crypto.subtle.digest('SHA-256', buffer).then(function (hash) {\n        return _this._hex(hash);\n      });\n    }\n  }, {\n    key: \"_hex\",\n    value: function _hex(buffer) {\n      var hexCodes = [];\n      var view = new DataView(buffer);\n\n      for (var i = 0; i < view.byteLength; i += 4) {\n        // Using getUint32 reduces the number of iterations needed (we process 4 bytes each time)\n        var value = view.getUint32(i);\n        var stringValue = value.toString(16);\n        var padding = '00000000';\n        var paddedValue = (padding + stringValue).slice(-padding.length);\n        hexCodes.push(paddedValue);\n      } // Join all the hex strings into one\n\n\n      return hexCodes.join('');\n    }\n  }]);\n\n  return Crypto;\n}();\n\n/* harmony default export */ var cryptoManager_Crypto = (Crypto_Crypto);\n// CONCATENATED MODULE: ./src/cryptoManager/CryptoManager.js\nfunction CryptoManager_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction CryptoManager_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction CryptoManager_createClass(Constructor, protoProps, staticProps) { if (protoProps) CryptoManager_defineProperties(Constructor.prototype, protoProps); if (staticProps) CryptoManager_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar CryptoManager_log = loglevel[\"getLogger\"]('CryptoManager');\n\n\n/**\r\n*  The Crypto Manager provides manages cryptographic features for the runtime including:\r\n*  - Mutual Authentication between peers\r\n*  - Crypto Keys\r\n*  - e2e encryption and decription of communication between Hyperties and dta objects\r\n*\r\n*/\n\nvar CryptoManager_CryptoManager =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * This is the constructor to initialise the CryptoManager, it does not require any input.\r\n  * The init() must called in order to set mandatories attributes\r\n  */\n  function CryptoManager(storageManager) {\n    CryptoManager_classCallCheck(this, CryptoManager);\n\n    this.storageManager = storageManager;\n    this.userDefaultKeyRef = 'userAsymmetricKey';\n  }\n\n  CryptoManager_createClass(CryptoManager, [{\n    key: \"init\",\n    value: function init(runtimeURL, runtimeCapabilities, storageManager, dataObjectsStorage, registry, coreDiscovery, idm, runtimeFactory) {\n      var _this = this;\n\n      if (!runtimeURL) throw new Error('[] runtimeURL is missing.');\n      if (!storageManager) throw new Error('storageManager is missing');\n      if (!runtimeFactory) throw new Error('runtimeFactory is missing');\n      _this._runtimeURL = runtimeURL;\n      _this._cryptoManagerURL = _this._runtimeURL + '/cryptoManager'; //_this._myURL = _this._runtimeURL + '/crypto';\n\n      _this.storageManager = storageManager;\n      _this.dataObjectsStorage = dataObjectsStorage;\n      _this.runtimeCapabilities = runtimeCapabilities;\n      _this._runtimeFactory = runtimeFactory;\n      _this._domain = divideURL(_this._runtimeURL).domain;\n      _this.crypto = new cryptoManager_Crypto(_this._runtimeFactory); // hashTable to store all the crypto information between two hyperties\n\n      _this.chatKeys = {}; // hashTable to store the symmetric keys to be used in the chat group\n\n      _this.dataObjectSessionKeys = {}; //failsafe to enable/disable all the criptographic functions\n\n      _this.isToUseEncryption = true;\n      _this._registry = registry;\n      _this._coreDiscovery = coreDiscovery;\n      _this._idm = idm;\n    } //******************* GET AND SET METHODS *******************\n\n    /**\r\n    * return the messageBus in this Registry\r\n    * @param {MessageBus}           messageBus\r\n    */\n\n  }, {\n    key: \"loadSessionKeys\",\n    // to be used to initialise IDM with SessionKeys used in previous session\n    value: function loadSessionKeys() {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        _this.storageManager.get('dataObjectSessionKeys').then(function (sessionKeys) {\n          if (sessionKeys) _this.dataObjectSessionKeys = sessionKeys;else _this.dataObjectSessionKeys = {};\n          resolve();\n        });\n      });\n    }\n  }, {\n    key: \"_isFromRemoteSM\",\n    value: function _isFromRemoteSM(from) {\n      var splitFrom = from.split('://');\n      return splitFrom[0] === 'runtime' && from !== this._runtimeURL + '/sm';\n    }\n  }, {\n    key: \"addCryptoGUIListeners\",\n    value: function addCryptoGUIListeners() {\n      //TODO: Change the GUI invocation of this method\n      var _this = this;\n\n      _this._messageBus.addListener(_this._cryptoManagerURL, function (msg) {\n        var funcName = msg.body.method; //let returnedValue;\n\n        if (funcName === 'generateRSAKeyPair') {\n          _this._crypto.getMyPublicKey().then(function (key) {\n            var value = {\n              type: 'execute',\n              value: key,\n              code: 200\n            };\n            var replyMsg = {\n              id: msg.id,\n              type: 'response',\n              to: msg.from,\n              from: msg.to,\n              body: value\n            };\n\n            try {\n              _this._messageBus.postMessage(replyMsg);\n            } catch (err) {\n              CryptoManager_log.error('On addGUIListeners from if generateRSAKeyPair method postMessage error: ' + err);\n            }\n          });\n\n          return;\n        }\n      });\n    } //******************* ENCRYPTION METHODS *******************\n\n    /**\r\n    * Identifies the messages to be encrypted\r\n    * @param {Message}    message\r\n    * @returns {boolean}  returns true if the message requires encryption\r\n    */\n\n  }, {\n    key: \"_isToEncrypt\",\n    value: function _isToEncrypt(message) {\n      var _this = this;\n\n      CryptoManager_log.log('[CryptoManager._isToEncrypt]', message);\n      var isCreate = message.type === 'create';\n      var isFromHyperty = message.from.includes('hyperty://');\n      var isToHyperty = message.to.includes('hyperty://');\n      var isToDataObject = isDataObjectURL(message.to);\n\n      var reporter = _this.registry.getDataObjectReporter(message.to);\n\n      var doMutualAuthentication = message.hasOwnProperty('body') && message.body.hasOwnProperty('mutual') ? message.body.mutual : message.hasOwnProperty('body') && message.body.hasOwnProperty('value') && message.body.value.hasOwnProperty('mutual') ? message.body.value.mutual : true;\n      if (!doMutualAuthentication) return false;\n\n      if (reporter !== null && utils_isLegacy(reporter)) {\n        return false;\n      } //if is not to apply encryption, then returns resolve\n\n\n      if (!this.isToUseEncryption && !(message.type === 'handshake')) {\n        CryptoManager_log.info('not handshake: encryption disabled');\n        return false;\n      }\n\n      if (message.type === 'update') {\n        CryptoManager_log.info('update:encryption disabled');\n        return false;\n      }\n\n      if (message.type === 'forward') {\n        CryptoManager_log.info('forward:encryption disabled');\n        return false;\n      }\n\n      if (utils_isLegacy(message.to)) return false;\n      return isCreate && isFromHyperty && isToHyperty || isCreate && isFromHyperty && isToDataObject && doMutualAuthentication || message.type === 'handshake' || message.type === 'update' && doMutualAuthentication;\n    }\n  }, {\n    key: \"_isToDecrypt\",\n    value: function _isToDecrypt(message) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        // For sybscribe message let's start the mutualAuthentication\n        var isSubscription = message.type === 'subscribe';\n\n        var isFromRemoteSM = _this._isFromRemoteSM(message.from);\n\n        var mutual = message.body.hasOwnProperty('value') && message.body.value.hasOwnProperty('mutual') ? message.body.value.mutual : message.body.hasOwnProperty('mutual') ? message.body.mutual : true; //      let mutual = message.body.hasOwnProperty('mutual') ? message.body.mutual : false;\n\n        if (isSubscription && isFromRemoteSM && mutual) {\n          //  if (isSubscription && isFromRemoteSM ) {\n          CryptoManager_log.log('[CryptoManager._isToDecrypt] _doMutualAuthenticationPhase1');\n          console.log('[CryptoManager._isToDecrypt] ', message);\n\n          var reporter = _this.registry.getDataObjectReporter(message.to);\n\n          if (reporter !== null && utils_isLegacy(reporter)) {\n            return resolve(false);\n          }\n\n          _this._doMutualAuthenticationPhase1(message).then(function () {\n            resolve(false);\n          }, function (error) {\n            reject(error);\n          }); //      } else if (message.hasOwnProperty('body') && message.body.hasOwnProperty('value') && typeof message.body.value === 'string') {\n\n        } else if (message.hasOwnProperty('body') && message.body.hasOwnProperty('value') && typeof message.body.value === 'string' && mutual) {\n          CryptoManager_log.log('[CryptoManager._isToDecrypt] true');\n          resolve(true);\n        } else {\n          CryptoManager_log.log('[CryptoManager._isToDecrypt] false');\n          resolve(false);\n        }\n      }).catch(function (error) {\n        CryptoManager_log.error('[CryptoManager._isToDecrypt]', error);\n      });\n    }\n  }, {\n    key: \"encryptMessage\",\n    value: function encryptMessage(message) {\n      //log.info('encryptMessage:message', message);\n      var _this = this;\n\n      CryptoManager_log.log('encrypt message ');\n      return new Promise(function (resolve, reject) {\n        var isHandShakeType = message.type === 'handshake'; //if is not to apply encryption, then returns resolve\n\n        if (!_this._isToEncrypt(message)) {\n          // log.log('decryption disabled');\n          return resolve(message);\n        }\n\n        var dataObjectURL = parseMessageURL(message.to);\n        var isToDataObject = isDataObjectURL(dataObjectURL);\n        var isToLegacyIdentity = utils_isLegacy(message.to);\n        var isFromHyperty = divideURL(message.from).type === 'hyperty';\n        var isToHyperty = divideURL(message.to).type === 'hyperty';\n\n        if (message.type === 'update') {\n          CryptoManager_log.log('encrypt message: message type update');\n          return resolve(message);\n        }\n\n        if (isToLegacyIdentity) {\n          resolve(message);\n        } else if (isFromHyperty && isToHyperty) {\n          var userURL = _this._registry.getHypertyOwner(message.from);\n\n          if (userURL) {\n            // check if exists any keys between two users\n            var chatKeys = _this.chatKeys[message.from + '<->' + message.to];\n\n            if (!chatKeys) {\n              chatKeys = _this._newChatCrypto(message, userURL); //log.log('createChatKey encrypt', message.from + message.to);\n\n              _this.chatKeys[message.from + '<->' + message.to] = chatKeys;\n              message.body.handshakePhase = 'startHandShake';\n            }\n\n            if (chatKeys.authenticated && !isHandShakeType) {\n              var iv = _this.crypto.generateIV();\n\n              _this.crypto.encryptAES(chatKeys.keys.hypertyFromSessionKey, stringify(message.body.value), iv).then(function (encryptedValue) {\n                var filteredMessage = _this._filterMessageToHash(message, stringify(message.body.value) + stringify(iv), chatKeys.hypertyFrom.messageInfo);\n\n                _this.crypto.hashHMAC(chatKeys.keys.hypertyFromHashKey, filteredMessage).then(function (hash) {\n                  //log.log('result of hash ', hash);\n                  var value = {\n                    iv: encode(iv),\n                    value: encode(encryptedValue),\n                    hash: encode(hash)\n                  };\n                  message.body.value = encode(value);\n                  resolve(message);\n                });\n              }); // if is a handshake message, just resolve it\n\n            } else if (isHandShakeType) {\n              resolve(message); // else, starts a new handshake protocol\n            } else {\n              _this._doHandShakePhase(message, chatKeys).then(function (value) {\n                _this.chatKeys[message.from + '<->' + message.to] = value.chatKeys;\n\n                _this._messageBus.postMessage(value.message);\n\n                reject('encrypt handshake protocol phase ');\n              });\n            }\n          } else {\n            reject('In encryptMessage: Hyperty owner URL was not found');\n          } //if from hyperty to a dataObjectURL\n\n        } else if (isFromHyperty && isToDataObject) {\n          //log.log('dataObject value to encrypt: ', message.body.value);\n          //log.log('IdentityModule - encrypt from hyperty to dataobject ', message);\n          _this.storageManager.get('dataObjectSessionKeys').then(function (sessionKeys) {\n            sessionKeys = chatkeysToArrayCloner(sessionKeys || {});\n            var dataObjectKey = sessionKeys ? sessionKeys[dataObjectURL] : null;\n\n            _this.dataObjectsStorage.getDataObject(dataObjectURL).then(function (isHypertyReporter) {\n              //if no key exists, create a new one if is the reporter of dataObject\n              if (!dataObjectKey) {\n                // if the hyperty is the reporter of the dataObject then generates a session key\n                if (isHypertyReporter.reporter && isHypertyReporter.reporter === message.from) {\n                  var sessionKey = _this.crypto.generateRandom();\n\n                  _this.dataObjectSessionKeys[dataObjectURL] = {\n                    sessionKey: sessionKey,\n                    isToEncrypt: true\n                  };\n                  var dataObjectSessionKeysClone = chatkeysToStringCloner(_this.dataObjectSessionKeys); //TODO: check if this does not need to be stored\n\n                  _this.storageManager.set('dataObjectSessionKeys', 0, dataObjectSessionKeysClone).catch(function (err) {\n                    reject('On encryptMessage from method storageManager.set error: ' + err);\n                  });\n\n                  dataObjectKey = _this.dataObjectSessionKeys[dataObjectURL];\n                }\n              } //check if there is already a session key for the chat room\n\n\n              if (dataObjectKey) {\n                // and if is to apply encryption, encrypt the messages\n                if (dataObjectKey.isToEncrypt) {\n                  var _iv = _this.crypto.generateIV();\n\n                  var stringifiedIV = stringify(_iv);\n                  var stringifiedMessageBody = stringify(message.body.value);\n\n                  _this.crypto.encryptAES(dataObjectKey.sessionKey, stringifiedMessageBody, _iv).then(function (encryptedValue) {\n                    delete message.body.identity.assertion; //TODO: Check why assertion is comming on the message!\n\n                    delete message.body.identity.expires; //TODO: Check why expires is comming on the message!\n\n                    var filteredMessage = _this._filterMessageToHash(message, stringifiedMessageBody + stringifiedIV);\n\n                    _this.crypto.hashHMAC(dataObjectKey.sessionKey, filteredMessage).then(function (hash) {\n                      // log.log('hash ', hash);\n                      var newValue = {\n                        value: encode(encryptedValue),\n                        iv: encode(_iv),\n                        hash: encode(hash)\n                      };\n                      message.body.value = stringify(newValue);\n                      resolve(message);\n                    });\n                  }); // if not, just send the message\n\n                } else {\n                  resolve(message);\n                } // start the generation of a new session Key\n\n              } else {\n                reject('Data object key could not be defined: Failed to decrypt message ');\n              }\n            }).catch(function (err) {\n              reject('On encryptMessage from method dataObjectsStorage.getDataObject error: ' + err);\n            });\n          }).catch(function (err) {\n            reject('On encryptMessage from method storageManager.get error: ' + err);\n          });\n        }\n      });\n    }\n  }, {\n    key: \"encryptDataObject\",\n    value: function encryptDataObject(dataObject, sender) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        CryptoManager_log.info('dataObject value to encrypt: ', dataObject);\n        var dataObjectURL = parseMessageURL(sender);\n\n        _this.storageManager.get('dataObjectSessionKeys').then(function (sessionKeys) {\n          sessionKeys = chatkeysToArrayCloner(sessionKeys || {});\n          var dataObjectKey = sessionKeys ? sessionKeys[dataObjectURL] : null; //check if there is already a session key for the chat room\n\n          if (dataObjectKey) {\n            // and if is to apply encryption, encrypt the messages\n            if (dataObjectKey.isToEncrypt) {\n              var iv = _this.crypto.generateIV();\n\n              _this.crypto.encryptAES(dataObjectKey.sessionKey, stringify(dataObject), iv).then(function (encryptedValue) {\n                var newValue = {\n                  value: encode(encryptedValue),\n                  iv: encode(iv)\n                }; //log.log('encrypted dataObject', newValue);\n\n                return resolve(newValue);\n              }).catch(function (err) {\n                reject('On encryptDataObject from method encryptAES error: ' + err);\n              }); // if not, just send the message\n\n            } else {\n              CryptoManager_log.info('The dataObject is not encrypted');\n              return resolve(dataObject);\n            } // start the generation of a new session Key\n\n          } else {\n            return reject('No dataObjectKey for this dataObjectURL:', dataObjectURL);\n          }\n        }).catch(function (err) {\n          reject('On encryptDataObject from method storageManager.get error: ' + err);\n        });\n      });\n    }\n  }, {\n    key: \"decryptMessage\",\n    value: function decryptMessage(message) {\n      var _this = this; //  log.log('decryptMessage:message', message);\n\n\n      return new Promise(function (resolve, reject) {\n        var isHandShakeType = message.type === 'handshake';\n\n        _this._isToDecrypt(message).then(function (isToDecrypt) {\n          //if is not to apply encryption, then returns resolve\n          if (!isToDecrypt) return resolve(message);\n          var dataObjectURL = parseMessageURL(message.to);\n          var isToDataObject = isDataObjectURL(dataObjectURL);\n          var isFromHyperty = divideURL(message.from).type === 'hyperty';\n          var isToHyperty = divideURL(message.to).type === 'hyperty';\n\n          if (message.type === 'update') {\n            return resolve(message);\n          } //is is hyperty to hyperty communication\n\n\n          if (isFromHyperty && isToHyperty) {\n            // log.log('decrypt hyperty to hyperty');\n            var userURL = _this._registry.getHypertyOwner(message.to);\n\n            if (userURL) {\n              var chatKeys = _this.chatKeys[message.to + '<->' + message.from];\n\n              if (!chatKeys) {\n                chatKeys = _this._newChatCrypto(message, userURL, 'decrypt');\n                _this.chatKeys[message.to + '<->' + message.from] = chatKeys;\n              }\n\n              if (chatKeys.authenticated && !isHandShakeType) {\n                var value = decode(message.body.value);\n                var iv = decodeToUint8Array(value.iv);\n                var data = decodeToUint8Array(value.value);\n                var hash = decodeToUint8Array(value.hash);\n\n                _this.crypto.decryptAES(chatKeys.keys.hypertyToSessionKey, data, iv).then(function (decryptedData) {\n                  // log.log('decrypted value ', decryptedData);\n                  message.body.value = decryptedData;\n\n                  var filteredMessage = _this._filterMessageToHash(message, decryptedData + iv);\n\n                  _this.crypto.verifyHMAC(chatKeys.keys.hypertyToHashKey, filteredMessage, hash).then(function (result) {\n                    //log.log('result of hash verification! ', result);\n                    message.body.assertedIdentity = true;\n                    resolve(message);\n                  });\n                });\n              } else if (isHandShakeType) {\n                _this._doHandShakePhase(message, chatKeys).then(function (value) {\n                  //if it was started by doMutualAuthentication then ends the protocol\n                  if (value === 'handShakeEnd') {//reject('decrypt handshake protocol phase');\n                    // if was started by a message, then resend that message\n                  } else {\n                    _this.chatKeys[message.to + '<->' + message.from] = value.chatKeys;\n\n                    _this._messageBus.postMessage(value.message); //reject('decrypt handshake protocol phase ');\n\n                  }\n                });\n              } else {\n                reject('wrong message do decrypt');\n              }\n            } else {\n              reject('error on decrypt message');\n            } //if from hyperty to a dataObjectURL\n\n          } else if (isFromHyperty && isToDataObject) {\n            // log.log('dataObject value to decrypt: ', message.body);\n            _this.storageManager.get('dataObjectSessionKeys').then(function (sessionKeys) {\n              sessionKeys = chatkeysToArrayCloner(sessionKeys || {});\n              var dataObjectKey = sessionKeys ? sessionKeys[dataObjectURL] : null;\n\n              if (dataObjectKey) {\n                //check if is to apply encryption\n                if (dataObjectKey.isToEncrypt) {\n                  var parsedValue = parse(message.body.value);\n\n                  var _iv2 = decodeToUint8Array(parsedValue.iv);\n\n                  var encryptedValue = decodeToUint8Array(parsedValue.value);\n\n                  var _hash = decodeToUint8Array(parsedValue.hash);\n\n                  _this.crypto.decryptAES(dataObjectKey.sessionKey, encryptedValue, _iv2).then(function (decryptedValue) {\n                    var parsedValue = parse(decryptedValue); // log.log('decrypted Value,', parsedValue);\n\n                    message.body.value = parsedValue;\n\n                    var filteredMessage = _this._filterMessageToHash(message, stringify(parsedValue) + stringify(_iv2));\n\n                    _this.crypto.verifyHMAC(dataObjectKey.sessionKey, filteredMessage, _hash).then(function (result) {\n                      CryptoManager_log.log('Received message HMAC result', result);\n                      message.body.assertedIdentity = true;\n                      resolve(message);\n                    }).catch(function (err) {\n                      reject('Message HMAC is invalid: ' + err);\n                    });\n                  }); //if not, just return the message\n\n                } else {\n                  message.body.assertedIdentity = true;\n                  resolve(message);\n                }\n              } else {\n                message.body.assertedIdentity = true;\n                resolve(message); //reject('no sessionKey for chat room found');\n              }\n            });\n          } else {\n            reject('wrong message to decrypt');\n          }\n        });\n      });\n    }\n  }, {\n    key: \"decryptDataObject\",\n    value: function decryptDataObject(dataObject, sender) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //if is not to apply encryption, then returns resolve\n        if (!_this.isToUseEncryption) {\n          // log.log('decryption disabled');\n          return resolve(dataObject);\n        }\n\n        var dataObjectURL = parseMessageURL(sender); // log.log('dataObject value to decrypt: ', dataObject);\n\n        _this.storageManager.get('dataObjectSessionKeys').then(function (sessionKeys) {\n          sessionKeys = chatkeysToArrayCloner(sessionKeys);\n          var dataObjectKey = sessionKeys ? sessionKeys[dataObjectURL] : null;\n\n          if (dataObjectKey) {\n            //check if is to apply encryption\n            if (dataObjectKey.isToEncrypt) {\n              var iv = decodeToUint8Array(dataObject.iv);\n              var encryptedValue = decodeToUint8Array(dataObject.value);\n\n              _this.crypto.decryptAES(dataObjectKey.sessionKey, encryptedValue, iv).then(function (decryptedValue) {\n                var parsedValue = parse(decryptedValue);\n                var newValue = {\n                  value: parsedValue,\n                  iv: encode(iv)\n                }; // log.log('decrypted dataObject,', newValue);\n\n                return resolve(newValue);\n              }).catch(function (err) {\n                reject('On decryptDataObject from method encryptAES error: ' + err);\n              }); //if not, just return the dataObject\n\n            } else {\n              // log.log('The dataObject is not encrypted');\n              return resolve(dataObject);\n            }\n          } else {\n            return reject('No dataObjectKey for this dataObjectURL:', dataObjectURL);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_doMutualAuthenticationPhase1\",\n    value: function _doMutualAuthenticationPhase1(message) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var to = message.to.split('/'); //let subsIndex = to.indexOf('subscription');\n        //let isDataObjectSubscription = subsIndex !== -1;\n\n        to.pop();\n        var dataObjectURL = to[0] + '//' + to[2] + '/' + to[3];\n\n        _this._doMutualAuthenticationPhase2(dataObjectURL, message.body.subscriber).then(function () {\n          _this._registry.registerSubscriber(dataObjectURL, message.body.subscriber);\n\n          resolve();\n        }, function (error) {\n          reject(error);\n        });\n      });\n    }\n  }, {\n    key: \"_doMutualAuthenticationPhase2\",\n    value: function _doMutualAuthenticationPhase2(sender, receiver) {\n      CryptoManager_log.info('doMutualAuthentication:sender ', sender);\n      CryptoManager_log.info('doMutualAuthentication:receiver ', receiver);\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var dataObjectURL; // check if the sender is a dataObject and if so stores that value\n\n        var reporterURL = _this._registry.getReporterURLSynchonous(sender);\n\n        if (reporterURL) {\n          dataObjectURL = sender;\n          sender = reporterURL;\n        }\n\n        var msg = {\n          to: receiver,\n          from: sender,\n          callback: undefined,\n          body: {\n            handshakePhase: 'startHandShake',\n            ignore: 'ignoreMessage'\n          }\n        };\n\n        if (!sender || !receiver) {\n          return reject('sender or receiver missing on doMutualAuthentication');\n        }\n\n        var chatKeys = _this.chatKeys[sender + '<->' + receiver];\n\n        var userURL = _this._registry.getHypertyOwner(sender);\n\n        if (userURL) {\n          if (!chatKeys) {\n            // callback to resolve when finish the mutual authentication\n            var resolved = function resolved(value) {\n              // log.log('callback value:', value);\n              resolve(value);\n            };\n\n            msg.callback = resolved;\n            msg.dataObjectURL = dataObjectURL;\n            chatKeys = _this._newChatCrypto(msg, userURL);\n            _this.chatKeys[sender + '<->' + receiver] = chatKeys;\n          }\n\n          if (chatKeys.authenticated) {\n            var startSessionKeyExchange = {\n              to: sender,\n              from: receiver\n            };\n            chatKeys.dataObjectURL = dataObjectURL;\n\n            _this._sendReporterSessionKey(startSessionKeyExchange, chatKeys).then(function (value) {\n              _this._messageBus.postMessage(value.message);\n\n              resolve('exchange of chat sessionKey initiated');\n            }).catch(function (err) {\n              reject('On doMutualAuthentication from method _sendReporterSessionKey error: ' + err);\n            });\n          } else {\n            _this._doHandShakePhase(msg, chatKeys);\n          }\n        } else {\n          reject('Mutual authentication error: Hyperty owner could not be resolved');\n        }\n      });\n    }\n    /**\r\n    * returns the reporter associated to the dataObject URL\r\n    * @param   {String}   dataObjectURL         dataObject url\r\n    * @return   {String}  reporter              dataObject url reporter\r\n    */\n\n    /*  _getHypertyFromDataObject(dataObjectURL) {\r\n      log.info('_getHypertyFromDataObject:dataObjectURL', dataObjectURL);\r\n      let _this = this;\r\n        return new Promise(function(resolve, reject) {\r\n          let splitedURL = divideURL(dataObjectURL);\r\n        let domain = splitedURL.domain;\r\n        let finalURL = _this._parseMessageURL(dataObjectURL);\r\n          // check if is the creator of the hyperty\r\n        let reporterURL = _this.registry.getReporterURLSynchonous(finalURL);\r\n        log.info('_getHypertyFromDataObject:reporterURL', reporterURL);\r\n          if (reporterURL) {\r\n          resolve(reporterURL);\r\n        } else {\r\n          // check if there is already an association from an hypertyURL to the dataObject\r\n          let storedReporterURL = _this.dataObjectsIdentity[finalURL];\r\n          log.info('_getHypertyFromDataObject:storedReporterURL', storedReporterURL);\r\n            if (storedReporterURL) {\r\n            resolve(storedReporterURL);\r\n          } else {\r\n            // check if there is any hyperty that subscribed the dataObjectURL\r\n            let subscriberHyperty = _this.registry.getDataObjectSubscriberHyperty(dataObjectURL);\r\n            log.info('_getHypertyFromDataObject:subscriberHyperty', subscriberHyperty);\r\n              if (subscriberHyperty) {\r\n              resolve(subscriberHyperty);\r\n            } else {\r\n              // search in domain registry for the hyperty associated to the dataObject\r\n              // search in case is a subscriber who wants to know the reporter\r\n              _this._coreDiscovery.discoverDataObjectPerURL(finalURL, domain).then(dataObject => {\r\n                log.info('_getHypertyFromDataObject:dataObject', dataObject);\r\n                _this.dataObjectsIdentity[finalURL] = dataObject.reporter;\r\n                log.info('_getHypertyFromDataObject:dataObject.reporter', dataObject.reporter);\r\n                resolve(dataObject.reporter);\r\n              }, err => {\r\n                reject(err);\r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }*/\n\n  }, {\n    key: \"_sendReporterSessionKey\",\n    value: function _sendReporterSessionKey(message, chatKeys) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var sessionKeyBundle = _this.dataObjectSessionKeys[chatKeys.dataObjectURL];\n        var reporterSessionKeyMsg;\n        var valueToEncrypt;\n        var sessionKey;\n        var iv;\n        var value = {}; //if there is not yet a session Key, generates a new one\n\n        if (!sessionKeyBundle) {\n          sessionKey = _this.crypto.generateRandom();\n          _this.dataObjectSessionKeys[chatKeys.dataObjectURL] = {\n            sessionKey: sessionKey,\n            isToEncrypt: true\n          };\n          var dataObjectSessionKeysClone = chatkeysToStringCloner(_this.dataObjectSessionKeys);\n\n          _this.storageManager.set('dataObjectSessionKeys', 0, dataObjectSessionKeysClone).catch(function (err) {\n            reject('On _sendReporterSessionKey from method storageManager.set(dataObjectSessionKeys...) error: ' + err);\n          });\n        } else {\n          sessionKey = sessionKeyBundle.sessionKey;\n        }\n\n        try {\n          valueToEncrypt = encode({\n            value: encode(sessionKey),\n            dataObjectURL: chatKeys.dataObjectURL\n          });\n        } catch (err) {\n          return reject('On _sendReporterSessionKey from method storageManager.set error valueToEncrypt: ' + err);\n        }\n\n        iv = _this.crypto.generateIV();\n        value.iv = encode(iv);\n\n        _this.crypto.encryptAES(chatKeys.keys.hypertyFromSessionKey, valueToEncrypt, iv).then(function (encryptedValue) {\n          reporterSessionKeyMsg = {\n            type: 'handshake',\n            to: message.from,\n            from: message.to,\n            body: {\n              handshakePhase: 'reporterSessionKey',\n              value: encode(encryptedValue)\n            }\n          };\n\n          var filteredMessage = _this._filterMessageToHash(reporterSessionKeyMsg, valueToEncrypt + iv, chatKeys.hypertyFrom.messageInfo);\n\n          return _this.crypto.hashHMAC(chatKeys.keys.hypertyFromHashKey, filteredMessage);\n        }).then(function (hashedMessage) {\n          var valueWithHash = encode({\n            value: reporterSessionKeyMsg.body.value,\n            hash: encode(hashedMessage),\n            iv: value.iv\n          });\n          reporterSessionKeyMsg.body.value = valueWithHash;\n          resolve({\n            message: reporterSessionKeyMsg,\n            chatKeys: chatKeys\n          });\n        }).catch(function (err) {\n          reject('On _sendReporterSessionKey from chained promises encryptAES error: ' + err);\n        });\n      });\n    }\n    /**\r\n    * Function that resolve and create the domainURL in case it is provided one. If not, resolve the default domainURL\r\n    * @param {String}     idpDomain     idpDomain (Optional)\r\n    */\n\n  }, {\n    key: \"_resolveDomain\",\n    value: function _resolveDomain(idpDomain) {\n      if (!idpDomain) {\n        return 'domain-idp://google.com';\n      } else {\n        return 'domain-idp://' + idpDomain;\n      }\n    }\n  }, {\n    key: \"_doHandShakePhase\",\n    value: function _doHandShakePhase(message, chatKeys) {\n      // log('_doHandShakePhase:dataObject', message);\n      //\tlog('_doHandShakePhase:chatKeys', chatKeys);\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var handshakeType = message.body.handshakePhase;\n        var iv;\n        var hash;\n        var value = {};\n        var filteredMessage;\n        var privateKeyHolder;\n        CryptoManager_log.info('handshake phase: ', handshakeType);\n\n        switch (handshakeType) {\n          case 'startHandShake':\n            {\n              chatKeys.keys.fromRandom = _this.crypto.generateRandom();\n              var startHandShakeMsg = {\n                type: 'handshake',\n                to: message.to,\n                from: message.from,\n                body: {\n                  handshakePhase: 'senderHello',\n                  value: encode(chatKeys.keys.fromRandom)\n                }\n              };\n              chatKeys.handshakeHistory.senderHello = _this._filterMessageToHash(startHandShakeMsg, undefined, chatKeys.hypertyFrom.messageInfo); // check if was the encrypt function or the mutual authentication that request the\n              // start of the handShakePhase.\n\n              if (chatKeys.initialMessage) {\n                resolve({\n                  message: startHandShakeMsg,\n                  chatKeys: chatKeys\n                });\n              } else {\n                _this.chatKeys[message.from + '<->' + message.to] = chatKeys;\n\n                _this._messageBus.postMessage(startHandShakeMsg);\n              }\n\n              break;\n            }\n\n          case 'senderHello':\n            {\n              CryptoManager_log.log('senderHello');\n              chatKeys.handshakeHistory.senderHello = _this._filterMessageToHash(message);\n              chatKeys.keys.fromRandom = decodeToUint8Array(message.body.value);\n              chatKeys.keys.toRandom = _this.crypto.generateRandom();\n              var senderHelloMsg = {\n                type: 'handshake',\n                to: message.from,\n                from: message.to,\n                body: {\n                  handshakePhase: 'receiverHello',\n                  value: encode(chatKeys.keys.toRandom)\n                }\n              };\n              chatKeys.handshakeHistory.receiverHello = _this._filterMessageToHash(senderHelloMsg, undefined, chatKeys.hypertyFrom.messageInfo);\n              resolve({\n                message: senderHelloMsg,\n                chatKeys: chatKeys\n              });\n              break;\n            }\n\n          case 'receiverHello':\n            {\n              CryptoManager_log.log('receiverHello');\n\n              _this.getMyPrivateKey().then(function (privateKey) {\n                privateKeyHolder = privateKey;\n                chatKeys.handshakeHistory.receiverHello = _this._filterMessageToHash(message);\n                return _this._idm.validateAssertion(message.body.identity.assertion, undefined, message.body.identity.idp.domain);\n              }).then(function (value) {\n                //TODO remove later this verification as soon as all the IdP proxy are updated in the example\n                var encodedpublicKey = typeof value.contents === 'string' ? value.contents : value.contents.nonce;\n                var receiverPublicKey = parseToUint8Array(encodedpublicKey);\n\n                var premasterSecret = _this.crypto.generatePMS();\n\n                var toRandom = message.body.value;\n                chatKeys.hypertyTo.assertion = message.body.identity.assertion;\n                chatKeys.hypertyTo.publicKey = receiverPublicKey;\n                chatKeys.hypertyTo.userID = message.body.identity.userProfile.userURL;\n                chatKeys.keys.toRandom = decodeToUint8Array(toRandom);\n                chatKeys.keys.premasterKey = premasterSecret;\n\n                var concatKey = _this.crypto.concatPMSwithRandoms(premasterSecret, chatKeys.keys.toRandom, chatKeys.keys.fromRandom);\n\n                return _this.crypto.generateMasterSecret(concatKey, 'messageHistoric' + chatKeys.keys.toRandom + chatKeys.keys.fromRandom); //generate the master key\n              }).then(function (masterKey) {\n                chatKeys.keys.masterKey = masterKey;\n                return _this.crypto.generateKeys(masterKey, 'key expansion' + chatKeys.keys.toRandom + chatKeys.keys.fromRandom); //generate the symmetric and hash keys\n              }).then(function (keys) {\n                chatKeys.keys.hypertyToSessionKey = new Uint8Array(keys[0]);\n                chatKeys.keys.hypertyFromSessionKey = new Uint8Array(keys[1]);\n                chatKeys.keys.hypertyToHashKey = new Uint8Array(keys[2]);\n                chatKeys.keys.hypertyFromHashKey = new Uint8Array(keys[3]);\n                iv = _this.crypto.generateIV();\n                value.iv = encode(iv);\n                var messageStructure = {\n                  type: 'handshake',\n                  to: message.from,\n                  from: message.to,\n                  body: {\n                    handshakePhase: 'senderCertificate'\n                  }\n                }; // hash the value and the iv\n\n                filteredMessage = _this._filterMessageToHash(messageStructure, 'ok' + iv, chatKeys.hypertyFrom.messageInfo);\n                return _this.crypto.hashHMAC(chatKeys.keys.hypertyFromHashKey, filteredMessage);\n              }).then(function (hash) {\n                value.hash = encode(hash); //encrypt the data\n\n                return _this.crypto.encryptAES(chatKeys.keys.hypertyFromSessionKey, 'ok', iv);\n              }).then(function (encryptedData) {\n                value.symetricEncryption = encode(encryptedData);\n                return _this.crypto.encryptRSA(chatKeys.hypertyTo.publicKey, chatKeys.keys.premasterKey);\n              }).then(function (encryptedValue) {\n                value.assymetricEncryption = encode(encryptedValue);\n                var messageStructure = {\n                  type: 'handshake',\n                  to: message.from,\n                  from: message.to,\n                  body: {\n                    handshakePhase: 'senderCertificate'\n                  }\n                };\n\n                var messageToHash = _this._filterMessageToHash(messageStructure, chatKeys.keys.premasterKey, chatKeys.hypertyFrom.messageInfo);\n\n                return _this.crypto.signRSA(privateKeyHolder, encode(chatKeys.handshakeHistory) + encode(messageToHash));\n              }).then(function (signature) {\n                value.signature = encode(signature);\n                var receiverHelloMsg = {\n                  type: 'handshake',\n                  to: message.from,\n                  from: message.to,\n                  body: {\n                    handshakePhase: 'senderCertificate',\n                    value: encode(value)\n                  }\n                };\n                chatKeys.handshakeHistory.senderCertificate = _this._filterMessageToHash(receiverHelloMsg, 'ok' + iv, chatKeys.hypertyFrom.messageInfo);\n                resolve({\n                  message: receiverHelloMsg,\n                  chatKeys: chatKeys\n                });\n              }, function (error) {\n                return reject(error);\n              });\n\n              break;\n            }\n\n          case 'senderCertificate':\n            {\n              CryptoManager_log.log('senderCertificate');\n              var receivedValue = decode(message.body.value);\n\n              _this.getMyPrivateKey().then(function (privateKey) {\n                privateKeyHolder = privateKey;\n                return _this._idm.validateAssertion(message.body.identity.assertion, undefined, message.body.identity.idp.domain);\n              }).then(function (value) {\n                var encryptedPMS = decodeToUint8Array(receivedValue.assymetricEncryption); //TODO remove later this verification as soon as all the IdP proxy are updated in the example\n\n                var encodedpublicKey = typeof value.contents === 'string' ? value.contents : value.contents.nonce;\n                var senderPublicKey = parseToUint8Array(encodedpublicKey);\n                chatKeys.hypertyTo.assertion = message.body.identity.assertion;\n                chatKeys.hypertyTo.publicKey = senderPublicKey;\n                chatKeys.hypertyTo.userID = message.body.identity.userProfile.userURL;\n                return _this.crypto.decryptRSA(privateKeyHolder, encryptedPMS);\n              }, function (error) {\n                // log.log(error);\n                reject('Error during authentication of identity: ', error.message); //obtain the PremasterKey using the private key\n              }).then(function (pms) {\n                chatKeys.keys.premasterKey = new Uint8Array(pms);\n                var signature = decodeToUint8Array(receivedValue.signature);\n\n                var receivedmsgToHash = _this._filterMessageToHash(message, chatKeys.keys.premasterKey);\n\n                return _this.crypto.verifyRSA(chatKeys.hypertyTo.publicKey, encode(chatKeys.handshakeHistory) + encode(receivedmsgToHash), signature); // validates the signature received\n              }).then(function (signValidationResult) {\n                //log.log('SenderCertificate - signature validation result ', signValidationResult);\n                var concatKey = _this.crypto.concatPMSwithRandoms(chatKeys.keys.premasterKey, chatKeys.keys.toRandom, chatKeys.keys.fromRandom);\n\n                return _this.crypto.generateMasterSecret(concatKey, 'messageHistoric' + chatKeys.keys.toRandom + chatKeys.keys.fromRandom); // generates the master keys from the Premaster key and the randoms\n              }).then(function (masterKey) {\n                chatKeys.keys.masterKey = masterKey;\n                return _this.crypto.generateKeys(masterKey, 'key expansion' + chatKeys.keys.toRandom + chatKeys.keys.fromRandom); // generates the symmetric keys to be used in the symmetric encryption\n              }).then(function (keys) {\n                chatKeys.keys.hypertyFromSessionKey = new Uint8Array(keys[0]);\n                chatKeys.keys.hypertyToSessionKey = new Uint8Array(keys[1]);\n                chatKeys.keys.hypertyFromHashKey = new Uint8Array(keys[2]);\n                chatKeys.keys.hypertyToHashKey = new Uint8Array(keys[3]);\n                iv = decodeToUint8Array(receivedValue.iv);\n                var data = decodeToUint8Array(receivedValue.symetricEncryption);\n                return _this.crypto.decryptAES(chatKeys.keys.hypertyToSessionKey, data, iv);\n              }).then(function (decryptedData) {\n                // log.log('decryptedData', decryptedData);\n                chatKeys.handshakeHistory.senderCertificate = _this._filterMessageToHash(message, decryptedData + iv);\n                var hashReceived = decodeToUint8Array(receivedValue.hash);\n                filteredMessage = _this._filterMessageToHash(message, decryptedData + iv);\n                return _this.crypto.verifyHMAC(chatKeys.keys.hypertyToHashKey, filteredMessage, hashReceived);\n              }).then(function (verifiedHash) {\n                // log.log('result of hash verification ', verifiedHash);\n                var receiverFinishedMessage = {\n                  type: 'handshake',\n                  to: message.from,\n                  from: message.to,\n                  body: {\n                    handshakePhase: 'receiverFinishedMessage'\n                  }\n                };\n                iv = _this.crypto.generateIV();\n                value.iv = encode(iv);\n                filteredMessage = _this._filterMessageToHash(receiverFinishedMessage, 'ok!' + iv, chatKeys.hypertyFrom.messageInfo); //log.log('TIAGO: doHandShakePhase verifiedHash');\n\n                return _this.crypto.hashHMAC(chatKeys.keys.hypertyFromHashKey, filteredMessage);\n              }).then(function (hash) {\n                value.hash = encode(hash);\n                return _this.crypto.encryptAES(chatKeys.keys.hypertyFromSessionKey, 'ok!', iv);\n              }).then(function (encryptedValue) {\n                value.value = encode(encryptedValue);\n                var receiverFinishedMessage = {\n                  type: 'handshake',\n                  to: message.from,\n                  from: message.to,\n                  body: {\n                    handshakePhase: 'receiverFinishedMessage',\n                    value: encode(value)\n                  }\n                };\n                chatKeys.handshakeHistory.receiverFinishedMessage = _this._filterMessageToHash(receiverFinishedMessage, 'ok!' + iv, chatKeys.hypertyFrom.messageInfo);\n                chatKeys.authenticated = true;\n                resolve({\n                  message: receiverFinishedMessage,\n                  chatKeys: chatKeys\n                });\n              }).catch(function (err) {\n                reject('On _doHandShakePhase from senderCertificate error: ' + err);\n              });\n\n              break;\n            }\n\n          case 'receiverFinishedMessage':\n            {\n              chatKeys.authenticated = true;\n              value = decode(message.body.value);\n              iv = decodeToUint8Array(value.iv);\n              var data = decodeToUint8Array(value.value);\n              hash = decodeToUint8Array(value.hash);\n\n              _this.crypto.decryptAES(chatKeys.keys.hypertyToSessionKey, data, iv).then(function (decryptedData) {\n                // log.log('decryptedData', decryptedData);\n                chatKeys.handshakeHistory.receiverFinishedMessage = _this._filterMessageToHash(message, decryptedData + iv);\n\n                var filteredMessage = _this._filterMessageToHash(message, decryptedData + iv);\n\n                _this.crypto.verifyHMAC(chatKeys.keys.hypertyToHashKey, filteredMessage, hash).then(function (result) {\n                  // check if there was an initial message that was blocked and send it\n                  if (chatKeys.initialMessage) {\n                    var initialMessage = {\n                      type: 'create',\n                      to: message.from,\n                      from: message.to,\n                      body: {\n                        value: chatKeys.initialMessage.body.value\n                      }\n                    };\n                    resolve({\n                      message: initialMessage,\n                      chatKeys: chatKeys\n                    }); //sends the sessionKey to the subscriber hyperty\n                  } else {\n                    _this._sendReporterSessionKey(message, chatKeys).then(function (value) {\n                      resolve(value);\n                    }).catch(function (err) {\n                      reject('On _doHandShakePhase from receiverFinishedMessage error: ' + err);\n                    });\n                  }\n                });\n              });\n\n              break;\n            }\n\n          case 'reporterSessionKey':\n            {\n              CryptoManager_log.log('reporterSessionKey');\n              var valueIVandHash = decode(message.body.value);\n              hash = decodeToUint8Array(valueIVandHash.hash);\n              iv = decodeToUint8Array(valueIVandHash.iv);\n              var encryptedValue = decodeToUint8Array(valueIVandHash.value);\n              var parsedValue;\n              var sessionKey;\n              var dataObjectURL;\n              var receiverAcknowledgeMsg; //log.log('[IdentityModule reporterSessionKey] - decryptAES: ', chatKeys.keys.hypertyToSessionKey, encryptedValue, iv);\n\n              _this.crypto.decryptAES(chatKeys.keys.hypertyToSessionKey, encryptedValue, iv).then(function (decryptedValue) {\n                parsedValue = decode(decryptedValue);\n                sessionKey = decodeToUint8Array(parsedValue.value);\n                dataObjectURL = parsedValue.dataObjectURL;\n\n                var messageToHash = _this._filterMessageToHash(message, decryptedValue + iv);\n\n                return _this.crypto.verifyHMAC(chatKeys.keys.hypertyToHashKey, messageToHash, hash);\n              }).then(function (hashResult) {\n                // log.log('hash successfully validated ', hashResult);\n                _this.dataObjectSessionKeys[dataObjectURL] = {\n                  sessionKey: sessionKey,\n                  isToEncrypt: true\n                };\n                var dataObjectSessionKeysClone = chatkeysToStringCloner(_this.dataObjectSessionKeys);\n\n                _this.storageManager.set('dataObjectSessionKeys', 0, dataObjectSessionKeysClone).catch(function (err) {\n                  reject('On _sendReporterSessionKey from method reporterSessionKey error: ' + err);\n                });\n\n                iv = _this.crypto.generateIV();\n                value.iv = encode(iv);\n                return _this.crypto.encryptAES(chatKeys.keys.hypertyFromSessionKey, 'ok!!', iv);\n              }).then(function (encryptedValue) {\n                receiverAcknowledgeMsg = {\n                  type: 'handshake',\n                  to: message.from,\n                  from: message.to,\n                  body: {\n                    handshakePhase: 'receiverAcknowledge'\n                  }\n                };\n                value.value = encode(encryptedValue);\n\n                var messageToHash = _this._filterMessageToHash(receiverAcknowledgeMsg, 'ok!!' + iv, chatKeys.hypertyFrom.messageInfo);\n\n                return _this.crypto.hashHMAC(chatKeys.keys.hypertyFromHashKey, messageToHash);\n              }).then(function (hashedMessage) {\n                var finalValue = encode({\n                  value: value.value,\n                  hash: encode(hashedMessage),\n                  iv: value.iv\n                });\n                receiverAcknowledgeMsg.body.value = finalValue;\n                resolve({\n                  message: receiverAcknowledgeMsg,\n                  chatKeys: chatKeys\n                });\n              }).catch(function (err) {\n                reject('On _doHandShakePhase from reporterSessionKey error: ' + err);\n              });\n\n              break;\n            }\n\n          case 'receiverAcknowledge':\n            {\n              CryptoManager_log.log('receiverAcknowledge');\n              var receivedvalueIVandHash = decode(message.body.value);\n              var receivedHash = decodeToUint8Array(receivedvalueIVandHash.hash);\n              iv = decodeToUint8Array(receivedvalueIVandHash.iv);\n              var receivedEncryptedValue = decodeToUint8Array(receivedvalueIVandHash.value);\n\n              _this.crypto.decryptAES(chatKeys.keys.hypertyToSessionKey, receivedEncryptedValue, iv).then(function (decryptedValue) {\n                var filteredMessage = _this._filterMessageToHash(message, decryptedValue + iv);\n\n                return _this.crypto.verifyHMAC(chatKeys.keys.hypertyToHashKey, filteredMessage, receivedHash);\n              }).then(function (hashResult) {\n                // log.log('hashResult ', hashResult);\n                var callback = chatKeys.callback;\n\n                if (callback) {\n                  callback('handShakeEnd');\n                }\n\n                resolve('handShakeEnd');\n              }).catch(function (err) {\n                reject('On _doHandShakePhase from receiverAcknowledge error: ' + err);\n              });\n\n              break;\n            }\n\n          default:\n            reject(message);\n        }\n      });\n    }\n    /**\r\n    * filter the messages to hash, by removing some fields not generated by the runtime core\r\n    * @param {Message}  message                     message\r\n    * @param {String}  decryptedValue (Optional)    value from body.value in case it originally comes encrypted\r\n    * @param {JSON}  identity(Optional)    add the hyperty identity associated in case is not added to the initial message\r\n    * @return {Message}  new message filtered\r\n    */\n\n  }, {\n    key: \"_filterMessageToHash\",\n    value: function _filterMessageToHash(message, decryptedValue, identity) {\n      return {\n        type: message.type,\n        from: message.from,\n        to: message.to,\n        body: {\n          identity: identity || message.body.identity,\n          value: decryptedValue || message.body.value,\n          handshakePhase: message.body.handshakePhase\n        }\n      };\n    }\n    /**\r\n    * generates the initial structure for the keys between two users\r\n    * @param {JSON}    message              initial message that triggers the mutual authentication\r\n    * @param {String}  userURL              userURL\r\n    * @param {boolean} receiver(Optional)  indicates if is the sender or the receiver that creates a new chat crypto\r\n    * @return {JSON} newChatCrypto  new JSON structure for the chat crypto\r\n    */\n\n  }, {\n    key: \"_newChatCrypto\",\n    value: function _newChatCrypto(message, userURL, receiver) {\n      var _this = this; //check whether is the sender or the receiver to create a new chatCrypto\n      //to mantain consistency on the keys if the receiver create a new chatCrypto,\n      //then invert the fields\n\n\n      var from = receiver ? message.to : message.from;\n      var to = receiver ? message.from : message.to;\n\n      var userInfo = _this._idm.getIdentity(userURL);\n\n      var newChatCrypto = {\n        hypertyFrom: {\n          hyperty: from,\n          userID: userInfo.userProfile.userURL,\n          //privateKey: \"getMyPublicKey\",\n          //publicKey: \"getMyPrivateKey\",\n          assertion: userInfo.assertion,\n          messageInfo: userInfo\n        },\n        hypertyTo: {\n          hyperty: to,\n          userID: undefined,\n          publicKey: undefined,\n          assertion: undefined\n        },\n        keys: {\n          hypertyToSessionKey: undefined,\n          hypertyFromSessionKey: undefined,\n          hypertyToHashKey: undefined,\n          hypertyFromHashKey: undefined,\n          toRandom: undefined,\n          fromRandom: undefined,\n          premasterKey: undefined,\n          masterKey: undefined\n        },\n        handshakeHistory: {\n          senderHello: undefined,\n          receiverHello: undefined,\n          senderCertificate: undefined,\n          receiverFinishedMessage: undefined\n        },\n        initialMessage: message.body.ignore ? undefined : message,\n        callback: message.callback,\n        authenticated: false,\n        dataObjectURL: message.dataObjectURL\n      };\n      return newChatCrypto;\n    }\n    /**\r\n    * Retrieves a public keys given a user refrence. If no key is found,\r\n    generates a new key asymmetric key and retrieves the public keys.\r\n    * @param   {userRef}    String    user reference for the key pair\r\n    * @return  {Array}   public key\r\n    */\n\n  }, {\n    key: \"getMyPublicKey\",\n    value: function getMyPublicKey() {\n      var userRef = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.userDefaultKeyRef;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.storageManager.get(userRef).then(function (storedKeyPair) {\n          if (storedKeyPair) {\n            return resolve(storedKeyPair.public);\n          }\n\n          _this._generateAndStoreNewAsymetricKey(userRef).then(function (generatedKeyPair) {\n            resolve(generatedKeyPair.public);\n          }).catch(function (err) {\n            CryptoManager_log.error('[getMyPublicKey:_generateAndStoreNewAsymetricKey:err]: ' + err.message);\n            reject(err);\n          });\n        }).catch(function (err) {\n          CryptoManager_log.error('[getMyPublicKey:storageManager:err]: ' + err.message);\n          reject(err);\n        });\n      });\n    }\n    /**\r\n    * Retrieves a private keys given a user refrence. If no key is found,\r\n    generates a new key asymmetric key and retrieves the private key.\r\n    * @param   {userRef}    String    user reference for the key pair\r\n    * @return  {Array}   private key\r\n    **/\n\n  }, {\n    key: \"getMyPrivateKey\",\n    value: function getMyPrivateKey() {\n      var userRef = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.userDefaultKeyRef;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.storageManager.get(userRef).then(function (storedKeyPair) {\n          if (storedKeyPair) {\n            return resolve(storedKeyPair.private);\n          }\n\n          _this._generateAndStoreNewAsymetricKey(userRef).then(function (generatedKeyPair) {\n            resolve(generatedKeyPair.private);\n          }).catch(function (err) {\n            CryptoManager_log.error('[getMyPrivateKey:_generateAndStoreNewAsymetricKey:err]: ' + err.message);\n            reject(err);\n          });\n        }).catch(function (err) {\n          CryptoManager_log.error('[getMyPrivateKey:storageManager:err]: ' + err.message);\n          reject(err);\n        });\n      });\n    }\n    /**\r\n    * Generates a new key pair, stores and retrives the key pair.\r\n    * @param   {userRef}    String    user reference for the key pair\r\n    * @return  {Array}   private key\r\n    **/\n\n  }, {\n    key: \"_generateAndStoreNewAsymetricKey\",\n    value: function _generateAndStoreNewAsymetricKey(userRef) {\n      var _this = this;\n\n      var keyPair = undefined;\n      return new Promise(function (resolve, reject) {\n        //      _this.crypto.generateRSAKeyPair().then(generatedKeyPair => {\n        var generatedKeyPair = {};\n        generatedKeyPair.private = generateGUID();\n        generatedKeyPair.public = generateGUID();\n        CryptoManager_log.log('_generateAndStoreNewAsymetricKey:userAsymmetricKeyGenerated', generatedKeyPair);\n        keyPair = generatedKeyPair;\n\n        _this.storageManager.set(userRef, 0, generatedKeyPair); //      }).then(storedReference => {\n        //        log.log('_generateAndStoreNewAsymetricKey:userAsymmetricKeySuccess', storedReference);\n\n\n        resolve(keyPair);\n      }).catch(function (err) {\n        CryptoManager_log.error('[_generateAndStoreNewAsymetricKey:err]: ' + err.message);\n        reject(err);\n      }); //    });\n    }\n  }, {\n    key: \"messageBus\",\n    get: function get() {\n      var _this = this;\n\n      return _this._messageBus;\n    }\n    /**\r\n    * Set the messageBus in this Registry\r\n    * @param {MessageBus}           messageBus\r\n    */\n    ,\n    set: function set(messageBus) {\n      var _this = this;\n\n      _this._messageBus = messageBus;\n\n      _this.addCryptoGUIListeners();\n    }\n    /**\r\n    * return the coreDiscovery component\r\n    */\n\n  }, {\n    key: \"coreDiscovery\",\n    get: function get() {\n      var _this = this;\n\n      return _this._coreDiscovery;\n    }\n    /**\r\n    * return user's public key\r\n    */\n\n    /*  getMyPublicKey() {\r\n      // to be implemented\r\n        return new Promise((resolve)=> {\r\n        resolve('mypublickey');\r\n        });\r\n    }\r\n    */\n\n    /**\r\n    * Set the coreDiscovery component\r\n    * @param {coreDiscovery} coreDiscovery\r\n    */\n    ,\n    set: function set(coreDiscovery) {\n      var _this = this;\n\n      _this._coreDiscovery = coreDiscovery;\n    }\n    /**\r\n    * return the registry in this idModule\r\n    * @param {registry}           registry\r\n    */\n\n  }, {\n    key: \"registry\",\n    get: function get() {\n      var _this = this;\n\n      return _this._registry;\n    }\n    /**\r\n    * Set the registry in this idModule\r\n    * @param {registry}     reg\r\n    */\n    ,\n    set: function set(registry) {\n      var _this = this;\n\n      _this._registry = registry;\n    }\n  }]);\n\n  return CryptoManager;\n}();\n/*\r\nconst nodeJSKeyPairPopulate = { public: [48, 130, 1, 34, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 1, 5, 0, 3, 130, 1, 15, 0, 48, 130, 1, 10, 2, 130, 1, 1, 0, 228, 43, 101, 12, 121, 7, 157, 71, 81, 58, 219, 32, 10, 108, 193, 179, 212, 116, 255, 59, 217, 32, 161, 201, 53, 171, 226, 199, 137, 202, 171, 60, 82, 53, 125, 62, 177, 126, 165, 24, 141, 30, 15, 226, 59, 107, 34, 7, 13, 149, 112, 125, 10, 230, 191, 156, 164, 177, 10, 185, 13, 66, 3, 217, 166, 244, 90, 119, 111, 27, 145, 104, 71, 189, 166, 226, 255, 133, 83, 151, 231, 101, 151, 89, 22, 19, 65, 154, 10, 53, 208, 218, 252, 219, 37, 50, 212, 86, 145, 107, 132, 90, 233, 202, 227, 108, 114, 141, 29, 73, 187, 31, 13, 234, 0, 232, 24, 191, 35, 149, 179, 138, 214, 159, 245, 162, 148, 221, 118, 17, 105, 89, 151, 146, 209, 55, 236, 61, 143, 233, 228, 10, 115, 8, 81, 197, 45, 123, 187, 223, 176, 254, 165, 69, 143, 29, 100, 114, 17, 130, 226, 223, 33, 11, 240, 81, 61, 172, 191, 157, 246, 202, 87, 131, 221, 88, 48, 127, 159, 119, 160, 152, 117, 61, 253, 174, 65, 214, 203, 218, 63, 50, 78, 160, 181, 221, 211, 128, 70, 178, 191, 170, 0, 13, 122, 173, 12, 203, 252, 4, 184, 225, 252, 7, 62, 96, 116, 15, 216, 158, 55, 85, 48, 16, 9, 206, 119, 74, 112, 243, 136, 84, 184, 223, 254, 101, 91, 61, 10, 91, 85, 192, 147, 144, 57, 29, 66, 238, 199, 244, 193, 194, 150, 232, 200, 107, 2, 3, 1, 0, 1],\r\n  private: [48, 130, 4, 191, 2, 1, 0, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 1, 5, 0, 4, 130, 4, 169, 48, 130, 4, 165, 2, 1, 0, 2, 130, 1, 1, 0, 228, 43, 101, 12, 121, 7, 157, 71, 81, 58, 219, 32, 10, 108, 193, 179, 212, 116, 255, 59, 217, 32, 161, 201, 53, 171, 226, 199, 137, 202, 171, 60, 82, 53, 125, 62, 177, 126, 165, 24, 141, 30, 15, 226, 59, 107, 34, 7, 13, 149, 112, 125, 10, 230, 191, 156, 164, 177, 10, 185, 13, 66, 3, 217, 166, 244, 90, 119, 111, 27, 145, 104, 71, 189, 166, 226, 255, 133, 83, 151, 231, 101, 151, 89, 22, 19, 65, 154, 10, 53, 208, 218, 252, 219, 37, 50, 212, 86, 145, 107, 132, 90, 233, 202, 227, 108, 114, 141, 29, 73, 187, 31, 13, 234, 0, 232, 24, 191, 35, 149, 179, 138, 214, 159, 245, 162, 148, 221, 118, 17, 105, 89, 151, 146, 209, 55, 236, 61, 143, 233, 228, 10, 115, 8, 81, 197, 45, 123, 187, 223, 176, 254, 165, 69, 143, 29, 100, 114, 17, 130, 226, 223, 33, 11, 240, 81, 61, 172, 191, 157, 246, 202, 87, 131, 221, 88, 48, 127, 159, 119, 160, 152, 117, 61, 253, 174, 65, 214, 203, 218, 63, 50, 78, 160, 181, 221, 211, 128, 70, 178, 191, 170, 0, 13, 122, 173, 12, 203, 252, 4, 184, 225, 252, 7, 62, 96, 116, 15, 216, 158, 55, 85, 48, 16, 9, 206, 119, 74, 112, 243, 136, 84, 184, 223, 254, 101, 91, 61, 10, 91, 85, 192, 147, 144, 57, 29, 66, 238, 199, 244, 193, 194, 150, 232, 200, 107, 2, 3, 1, 0, 1, 2, 130, 1, 0, 103, 244, 137, 118, 116, 82, 14, 203, 102, 107, 253, 88, 12, 199, 222, 60, 243, 136, 86, 157, 74, 224, 190, 53, 113, 57, 157, 250, 49, 130, 96, 31, 252, 136, 152, 70, 143, 17, 215, 96, 103, 51, 18, 35, 141, 212, 210, 205, 9, 216, 83, 70, 245, 71, 138, 119, 112, 229, 164, 176, 9, 37, 81, 161, 193, 154, 68, 249, 115, 106, 201, 6, 12, 225, 144, 126, 141, 210, 141, 242, 128, 159, 221, 163, 222, 21, 233, 230, 167, 206, 59, 24, 250, 233, 81, 122, 102, 26, 6, 233, 72, 133, 47, 77, 155, 238, 86, 6, 139, 24, 131, 163, 179, 112, 48, 247, 142, 6, 207, 204, 173, 223, 140, 199, 150, 95, 123, 152, 202, 155, 131, 238, 62, 96, 133, 4, 217, 51, 121, 30, 38, 178, 189, 216, 44, 35, 241, 93, 7, 62, 90, 111, 216, 66, 209, 243, 128, 234, 141, 84, 135, 181, 13, 38, 220, 114, 245, 240, 178, 95, 220, 206, 11, 186, 234, 213, 66, 121, 83, 68, 89, 75, 46, 183, 145, 183, 147, 160, 215, 118, 198, 125, 181, 146, 30, 251, 58, 87, 47, 209, 237, 97, 24, 47, 179, 6, 110, 242, 99, 150, 226, 148, 198, 174, 146, 101, 213, 87, 178, 10, 223, 105, 18, 56, 53, 22, 212, 158, 170, 176, 51, 86, 145, 125, 124, 44, 9, 85, 19, 144, 246, 170, 78, 124, 30, 32, 12, 166, 174, 139, 77, 63, 173, 82, 10, 153, 2, 129, 129, 0, 248, 18, 143, 246, 137, 136, 145, 219, 178, 39, 27, 94, 64, 90, 47, 163, 114, 60, 63, 187, 131, 143, 244, 16, 42, 128, 231, 117, 92, 98, 219, 155, 62, 107, 252, 17, 245, 45, 160, 225, 103, 142, 72, 36, 193, 150, 235, 214, 175, 62, 212, 56, 45, 9, 0, 60, 114, 107, 134, 228, 204, 131, 131, 214, 94, 201, 148, 159, 99, 139, 181, 13, 119, 38, 30, 107, 166, 165, 203, 43, 34, 20, 207, 171, 32, 58, 167, 62, 196, 153, 103, 204, 213, 247, 48, 111, 227, 59, 95, 97, 194, 187, 53, 10, 247, 108, 58, 86, 28, 29, 113, 8, 110, 171, 220, 245, 11, 82, 233, 223, 91, 68, 166, 117, 174, 187, 62, 77, 2, 129, 129, 0, 235, 118, 2, 105, 239, 212, 30, 104, 157, 41, 109, 11, 248, 152, 22, 236, 97, 40, 153, 131, 228, 5, 86, 187, 113, 126, 144, 76, 141, 79, 110, 250, 146, 152, 49, 58, 156, 201, 176, 92, 189, 209, 30, 112, 108, 175, 204, 204, 247, 164, 46, 129, 239, 98, 127, 49, 145, 218, 63, 193, 124, 174, 18, 98, 201, 99, 154, 162, 138, 78, 159, 253, 3, 248, 3, 209, 36, 239, 193, 155, 193, 5, 19, 236, 37, 78, 118, 135, 250, 199, 7, 141, 248, 120, 36, 136, 93, 98, 174, 60, 18, 215, 93, 174, 107, 141, 116, 145, 167, 221, 210, 169, 247, 67, 254, 222, 161, 134, 63, 221, 90, 87, 42, 99, 227, 81, 173, 151, 2, 129, 129, 0, 133, 23, 168, 103, 83, 232, 146, 160, 181, 23, 40, 38, 204, 13, 214, 203, 49, 41, 195, 227, 189, 181, 8, 243, 119, 106, 75, 67, 250, 250, 10, 234, 98, 118, 26, 250, 35, 121, 132, 124, 10, 76, 26, 198, 165, 154, 108, 19, 117, 88, 23, 17, 192, 143, 184, 177, 181, 141, 157, 4, 185, 248, 193, 77, 204, 243, 7, 170, 240, 4, 111, 113, 183, 0, 27, 136, 20, 19, 149, 74, 33, 241, 218, 108, 236, 80, 171, 148, 16, 116, 97, 109, 83, 74, 88, 145, 94, 239, 102, 192, 19, 114, 207, 5, 128, 51, 111, 164, 237, 86, 154, 99, 52, 197, 62, 57, 182, 6, 152, 245, 61, 137, 58, 105, 159, 2, 84, 109, 2, 129, 129, 0, 226, 67, 111, 132, 95, 91, 101, 177, 63, 189, 44, 53, 193, 184, 92, 230, 223, 98, 133, 74, 209, 86, 52, 7, 65, 195, 206, 100, 81, 178, 144, 65, 167, 151, 42, 79, 89, 149, 18, 173, 188, 21, 244, 251, 49, 230, 41, 150, 153, 46, 35, 38, 231, 99, 174, 56, 115, 32, 215, 253, 85, 147, 108, 197, 147, 34, 236, 216, 222, 177, 57, 90, 136, 114, 207, 48, 46, 31, 90, 220, 18, 58, 143, 239, 111, 214, 27, 95, 6, 36, 53, 229, 62, 108, 45, 39, 1, 30, 47, 178, 56, 164, 206, 56, 42, 208, 46, 193, 61, 31, 147, 45, 147, 23, 187, 22, 50, 255, 111, 229, 132, 199, 152, 75, 142, 136, 209, 151, 2, 129, 129, 0, 165, 56, 232, 76, 55, 57, 240, 159, 92, 207, 220, 143, 130, 30, 57, 234, 251, 172, 171, 180, 54, 159, 229, 96, 246, 73, 112, 146, 75, 157, 242, 201, 161, 218, 37, 176, 35, 170, 50, 90, 148, 102, 191, 199, 239, 174, 78, 72, 67, 85, 199, 45, 149, 145, 132, 161, 212, 33, 157, 75, 216, 79, 39, 233, 18, 210, 255, 26, 72, 229, 239, 44, 12, 147, 158, 176, 192, 95, 126, 32, 175, 23, 226, 131, 139, 197, 175, 193, 62, 8, 151, 252, 68, 154, 94, 89, 189, 125, 90, 30, 36, 175, 73, 230, 194, 13, 233, 247, 123, 60, 241, 47, 171, 51, 189, 112, 111, 213, 141, 89, 70, 249, 236, 63, 236, 110, 115, 208]};\r\n*/\n\n\n/* harmony default export */ var cryptoManager_CryptoManager = (new CryptoManager_CryptoManager());\n// EXTERNAL MODULE: ./node_modules/path-browserify/index.js\nvar path_browserify = __webpack_require__(281);\n\n// CONCATENATED MODULE: ./src/runtime/Loader.js\nfunction Loader_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Loader_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Loader_createClass(Constructor, protoProps, staticProps) { if (protoProps) Loader_defineProperties(Constructor.prototype, protoProps); if (staticProps) Loader_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar Loader_log = loglevel[\"getLogger\"]('Loader');\n\n\n\n\nvar Loader_Loader =\n/*#__PURE__*/\nfunction () {\n  function Loader(runtimeURL, runtimeConfiguration, runtimeDescriptorsInstance) {\n    Loader_classCallCheck(this, Loader);\n\n    if (!runtimeConfiguration) throw Error('[Runtime.Loader] The descriptor need to know the runtime configuration');\n    if (!runtimeDescriptorsInstance) throw Error('[Runtime.Loader] The descriptor need to know the runtime Descriptor instance');\n    this.log = Loader_log;\n    this.runtimeConfiguration = runtimeConfiguration;\n    this.descriptors = runtimeDescriptorsInstance;\n  }\n  /**\r\n   * Set runtime url\r\n   * @param  {string} value runtimeURL\r\n   */\n\n\n  Loader_createClass(Loader, [{\n    key: \"loadHyperty\",\n\n    /**\r\n     * Deploy Hyperty from Catalogue URL\r\n     *\r\n     * @see https://github.com/reTHINK-project/specs/tree/master/datamodel/core/address\r\n     *\r\n     * @param {URL.HypertyCatalogueURL} hypertyCatalogueURL - The Catalogue URL used to identify descriptors in the Catalogue.\r\n     * @param {boolean|URL.HypertyURL} [reuseURL=false] reuseURL - reuseURL is used to reuse the hypertyURL previously registred, by default the reuse is disabled;\r\n     * @param {URL} appURL - the app url origin address;\r\n     * @param {object} IdpConstraint - constraints to be used when selecting the identity to be associated with the Hyperty including origin, idp, and idHint.\r\n     * @returns {Promise<Boolean, Error>} this is Promise and returns true if all components are loaded with success or an error if someone fails.\r\n     *\r\n     * @memberOf Loader\r\n     */\n    value: function loadHyperty(hypertyClass) {\n      var _this = this;\n\n      var reuseURL = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var IdpConstraint = arguments.length > 2 ? arguments[2] : undefined;\n      var appURL = arguments.length > 3 ? arguments[3] : undefined;\n      if (!this._readyToUse()) return false;\n      if (!hypertyClass) throw new Error('[Runtime.Loader] hypertyClass parameter is needed');\n\n      var _hypertyURL;\n\n      var _hypertySandbox;\n\n      var _hypertySourcePackage;\n\n      var haveError = false;\n      var instance = new hypertyClass();\n      var hyperty = instance.name;\n      return new Promise(function (resolve, reject) {\n        var errorReason = function errorReason(reason) {\n          Loader_log.info('[Runtime.Loader] Something failed on the deploy hyperty: ', reason);\n          reject(reason);\n        };\n\n        var handleError = function handleError(reason) {\n          haveError = true;\n          reject(reason);\n        };\n\n        Loader_log.info('[Runtime.Loader.loadHyperty] ', hyperty);\n        var _hypertyDescriptor = instance.descriptor;\n        _hypertyDescriptor.dataObjects[0] = _hypertyDescriptor.dataObjects[0].replace('%domain%', _this._registry._domain); // at this point, we have completed \"step 2 and 3\" as shown in https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-hyperty.md\n\n        Loader_log.info('[Runtime.Loader] 1: return hyperty descriptor: ', _hypertyDescriptor);\n        _hypertySandbox = _this.registry.getAppSandbox();\n        var numberOfAddresses = 1; //debugger;\n\n        _this._addressAllocation.create(_this._registry._domain, numberOfAddresses, _hypertyDescriptor, 'hyperty', reuseURL).then(function (addresses) {\n          if (haveError) return false;\n          Loader_log.info('[Runtime.Loader] 6: return the addresses for the hyperty', addresses); // Register hyperty\n\n          return _this.registry.registerHyperty(_hypertySandbox, hyperty, _hypertyDescriptor, addresses, IdpConstraint);\n        }, handleError).then(function (registrationResult) {\n          if (haveError) return false;\n          Loader_log.info('[Runtime.Loader] 7: registration result', registrationResult); // we have completed step 16 of https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-hyperty.md right now.\n\n          _hypertyURL = registrationResult.url; // Extend original hyperty configuration;\n\n          var configuration = {};\n\n          if (!emptyObject(_hypertyDescriptor.configuration)) {\n            try {\n              configuration = Object.assign({}, JSON.parse(_hypertyDescriptor.configuration));\n            } catch (e) {\n              configuration = _hypertyDescriptor.configuration;\n            }\n          }\n\n          configuration.runtimeURL = _this._runtimeURL;\n\n          if (registrationResult.p2pHandler) {\n            configuration.p2pHandler = registrationResult.p2pHandler;\n            configuration.p2pRequester = registrationResult.p2pRequester;\n          } // We will deploy the component - step 17 of https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-hyperty.md right now.\n\n\n          try {\n            //            return _hypertySandbox.deployComponent(_hypertySourcePackage.sourceCode, _hypertyURL, configuration);\n            return _hypertySandbox.deployComponent(instance, _hypertyURL, configuration);\n          } catch (e) {\n            Loader_log.info('[Runtime.Loader] Error on deploy component:', e);\n            reject(e);\n          }\n        }, handleError).then(function (deployComponentStatus) {\n          if (haveError) return false;\n          Loader_log.info('[Runtime.Loader] 8: Deploy component status for hyperty: ', deployComponentStatus); // we have completed step 19 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-hyperty.md right now.\n          // Add the message bus listener to the appSandbox or hypertSandbox;\n\n          _this.messageBus.addListener(_hypertyURL, function (msg) {\n            _hypertySandbox.postMessage(msg);\n          }); // Add the message bus listener to the appSandbox or hypertSandbox;\n\n\n          _this.messageBus.addListener(_this.runtimeURL + '/status', function (msg) {\n            _hypertySandbox.postMessage(msg);\n          }); // we have completed step 20 of https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-hyperty.md right now.\n\n\n          var deployed = {\n            runtimeHypertyURL: _hypertyURL,\n            status: deployComponentStatus,\n            name: hyperty,\n            instance: instance\n          };\n          Loader_log.info('[Runtime.Loader] Hyperty deployed: ', deployed);\n          resolve(instance); // we have completed step 21 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-hyperty.md right now.\n\n          Loader_log.info('[Runtime.Loader] ------------------ END ------------------------');\n        }, handleError).catch(errorReason);\n      });\n    }\n    /**\r\n    * Deploy Stub from Catalogue URL or domain url\r\n    * @param  {URL.URL}     protostubURL    Catalogue URL for the ProtoStub to be loaded or the domain to be target by the protostub\r\n    * @param  {Object}      p2pConfig       configuration of p2p\r\n    */\n\n  }, {\n    key: \"loadStub\",\n    value: function loadStub(protostubURL, p2pConfig) {\n      var _this2 = this;\n\n      if (!this._readyToUse()) return false;\n      if (!protostubURL) throw new Error('[Runtime.Loader.loadStub]ProtoStub descriptor url parameter is needed');\n      return new Promise(function (resolve, reject) {\n        // to analyse if domain for p2pHandlers should be something else and not the default domain itself\n        var domain = divideURL(protostubURL).domain;\n\n        if (!domain) {\n          domain = protostubURL;\n        }\n\n        var _stubSandbox;\n\n        var _stubDescriptor;\n\n        var _runtimeProtoStubURL;\n\n        var _stubSourcePackage;\n\n        var haveError = false;\n        var stubId;\n\n        var errorReason = function errorReason(reason) {\n          Loader_log.info('[Runtime.Loader.loadStub]Something failed on the deploy of protocolstub: ', reason);\n          reject(reason);\n        };\n\n        var handleError = function handleError(reason) {\n          haveError = true;\n          reject(reason);\n        }; // Discover Protocol Stub\n\n\n        var discoverStub;\n        var isP2PHandler = false;\n        var isP2PRequester = false;\n        var stubCapabilities = {};\n        Loader_log.info('[Runtime.Loader.loadStub] starting loading for ', protostubURL, ' with p2pconfig ', p2pConfig);\n        Loader_log.info('[Runtime.Loader.loadStub]Discover or Create a new ProtoStub for domain: ', domain); // step 2 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n        try {\n          if (p2pConfig) {\n            if (p2pConfig.hasOwnProperty('isHandlerStub') && p2pConfig.isHandlerStub) {\n              // step 6 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n              isP2PHandler = true;\n              stubId = _this2.runtimeURL;\n              discoverStub = _this2.registry.discoverP2PStub();\n            } else {\n              isP2PRequester = true;\n              var p2pHandlerRuntimeURL = p2pConfig.remoteRuntimeURL;\n              stubId = p2pHandlerRuntimeURL; // step 4 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n              // step 5 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n              discoverStub = _this2.registry.discoverP2PStub(p2pHandlerRuntimeURL);\n            }\n          } else {\n            // step 3 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n            stubId = domain;\n            discoverStub = _this2.registry.discoverProtostub(domain);\n          } // Is registed?\n\n\n          Loader_log.info('[Runtime.Loader.loadStub]1. Proto Stub Discovered for ', protostubURL, ': ', discoverStub); // step 23 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n          resolve(discoverStub);\n          Loader_log.info(' [Runtime.Loader]------------------- END ---------------------------\\n');\n        } catch (reason) {\n          // is not registed?\n          Loader_log.info('[Runtime.Loader.loadStub]1. Proto Stub not found ' + reason); // step 8 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n          _this2.descriptors.getStubDescriptor(protostubURL).then(function (stubDescriptor) {\n            if (haveError) return false;\n            Loader_log.info('[Runtime.Loader.loadStub]2. return the ProtoStub descriptor'); // step 9 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            _stubDescriptor = stubDescriptor;\n            var sourcePackageURL = stubDescriptor.sourcePackageURL;\n\n            if (sourcePackageURL === '/sourcePackage') {\n              return stubDescriptor.sourcePackage;\n            } // step 10 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n\n            return _this2.runtimeCatalogue.getSourcePackageFromURL(sourcePackageURL);\n          }, handleError).catch(errorReason).then(function (stubSourcePackage) {\n            if (haveError) return false; // According to debug, it seems RuntimeCatalogue does not support yet constraints. It appears empty!!!!\n\n            if (_stubDescriptor && _stubDescriptor.constraints) {\n              stubCapabilities = _stubDescriptor.constraints;\n            } // step 11 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n\n            Loader_log.info('[Runtime.Loader.loadStub]3. return the ProtoStub Source Code');\n            _stubSourcePackage = stubSourcePackage; // this will return the sandbox or one promise to getSandbox;\n            // step 12 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            return _this2.registry.getSandbox(domain, stubCapabilities);\n          }).then(function (stubSandbox) {\n            if (haveError) return false; // step 15 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            Loader_log.info('[Runtime.Loader.loadStub]4. if the sandbox is registered then return the sandbox ', stubSandbox);\n            _stubSandbox = stubSandbox;\n            return stubSandbox;\n          }).catch(function (reason) {\n            if (haveError) return false; // step 13 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            Loader_log.info('[Runtime.Loader.loadStub]5. Sandbox was not found, creating a new one ', reason); // check if the sandbox is registed for this stub descriptor url;\n            // step 14 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            return _this2._runtimeFactory.createSandbox(stubCapabilities).then(function (sandbox) {\n              sandbox.addListener('*', function (msg) {\n                _this2.messageBus.postMessage(msg);\n              });\n              return sandbox;\n            });\n          }).then(function (sandbox) {\n            if (haveError) return false; // step 16 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            Loader_log.info('[Runtime.Loader.loadStub]6. return the sandbox instance and register', sandbox, 'to domain ', domain);\n            _stubSandbox = sandbox; // we need register stub on registry - step xxx https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            return _this2.registry.registerStub(_stubSandbox, stubId, p2pConfig, protostubURL, _stubDescriptor);\n          }, handleError).then(function (runtimeProtoStub) {\n            if (haveError) return false; // step 23 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            Loader_log.info('[Runtime.Loader.loadStub] 7. return the runtime protostub url: ', runtimeProtoStub);\n            _runtimeProtoStubURL = runtimeProtoStub.url; // Extend original hyperty configuration;\n\n            var configuration = {};\n\n            if (!emptyObject(_stubDescriptor.configuration)) {\n              try {\n                configuration = Object.assign({}, JSON.parse(_stubDescriptor.configuration));\n              } catch (e) {\n                configuration = _stubDescriptor.configuration;\n              }\n            }\n\n            if (p2pConfig) {\n              try {\n                configuration = Object.assign(configuration, JSON.parse(p2pConfig));\n              } catch (e) {\n                configuration = Object.assign(configuration, p2pConfig);\n              }\n            } // required for protostub session\n\n\n            configuration.runtimeURL = _this2._runtimeURL; // step 24 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            try {\n              // step 26 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n              Loader_log.info('[Runtime.Loader.loadStub] 8: adding sandbox listener to protostubURL : ', _runtimeProtoStubURL); // step 27 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n              // Add the message bus listener\n\n              _this2.messageBus.addListener(_runtimeProtoStubURL, function (msg) {\n                _stubSandbox.postMessage(msg);\n              });\n\n              return _stubSandbox.deployComponent(_stubSourcePackage.sourceCode, _runtimeProtoStubURL, configuration);\n            } catch (e) {\n              Loader_log.error('[Runtime.Loader.loadStub] Error on deploy component:', e);\n              reject(e);\n            }\n          }, handleError).then(function () {\n            if (haveError) return false; // step 28 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            var stub;\n\n            if (p2pConfig) {\n              Loader_log.log('[Runtime.Loader.loadStub] p2pConfig: ', p2pConfig);\n              if (p2pConfig.hasOwnProperty('isHandlerStub')) stub = _this2.registry.p2pHandlerStub[_this2._runtimeURL];\n              if (p2pConfig.hasOwnProperty('p2pRequesterStub')) stub = _this2.registry.p2pRequesterStub[p2pConfig.remoteRuntimeURL];\n            } else {\n              stub = _this2.registry.protostubsList[domain];\n            }\n\n            Loader_log.log('[Runtime.Loader.loadStub] Stub: ', stub);\n            resolve(stub);\n            Loader_log.info('[Runtime.Loader.loadStub]------------------- END ---------------------------\\n');\n          }, handleError).catch(errorReason);\n        }\n      });\n    }\n    /**\r\n    * Deploy idpProxy from Catalogue URL or domain url\r\n    * @param  {URL.URL}     domain          domain\r\n    */\n\n  }, {\n    key: \"loadIdpProxy\",\n    value: function loadIdpProxy(idpProxyURL) {\n      var _this3 = this;\n\n      if (!this._readyToUse()) return false;\n      if (!idpProxyURL) throw new Error('[Runtime.Loader] IdpProxy descriptor url parameter is needed');\n      return new Promise(function (resolve, reject) {\n        var domain = divideURL(idpProxyURL).domain;\n\n        if (!domain) {\n          domain = idpProxyURL;\n        }\n\n        var _proxySandbox;\n\n        var _proxyDescriptor;\n\n        var _runtimeIdpProxyURL;\n\n        var _proxySourcePackage;\n\n        var haveError = false;\n\n        var errorReason = function errorReason(reason) {\n          Loader_log.info('[Runtime.Loader] Something failed on the deploy of IdpProxy: ', reason);\n          reject(reason);\n        };\n\n        var handleError = function handleError(reason) {\n          haveError = true;\n          reject(reason);\n        }; // Discover IDPProxy\n\n\n        Loader_log.info('[Runtime.Loader] ------------------- IDP Proxy Deploy ---------------------------\\n');\n        Loader_log.info('[Runtime.Loader] Discover or Create a new IdpProxy for domain/URL: ', domain);\n\n        try {\n          var runtimeIdpProxyURL = _this3.registry.discoverIdpProxy(domain); // Is registed?\n\n\n          Loader_log.info('[Runtime.Loader] 1. IDPProxy Discovered: ', runtimeIdpProxyURL); // we have completed step 2 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n          var idpProxy = _this3.registry.idpProxyList[domain];\n          Loader_log.log('Deployed: ', idpProxy);\n          resolve(idpProxy);\n          Loader_log.info('[Runtime.Loader] ------------------- END ---------------------------\\n');\n        } catch (reason) {\n          // is not registed?\n          Loader_log.info('[Runtime.Loader] 1. IdpProxy not found:', reason); // we have completed step 3 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n          // we need to get ProtoStub descriptor step 4 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n          _this3.descriptors.getIdpProxyDescriptor(idpProxyURL).then(function (proxyDescriptor) {\n            Loader_log.info('[Runtime.Loader] 2. Return the IDPProxy descriptor'); // we have completed step 5 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            _proxyDescriptor = proxyDescriptor;\n            var sourcePackageURL = proxyDescriptor.sourcePackageURL;\n\n            if (sourcePackageURL === '/sourcePackage') {\n              return proxyDescriptor.sourcePackage;\n            } // we need to get ProtoStub Source code from descriptor - step 6 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n\n            return _this3.runtimeCatalogue.getSourcePackageFromURL(sourcePackageURL);\n          }, handleError).then(function (sourcePackage) {\n            if (haveError) return false;\n            Loader_log.info('[Runtime.Loader] 3. return the IDPProxy source package'); // we have completed step 7 https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            _proxySourcePackage = sourcePackage; // TODO: Check on PEP (policy Engine) if we need the sandbox and check if the Sandbox Factory have the context sandbox;\n\n            var policy = true;\n            return policy;\n          }, handleError).then(function (policy) {\n            if (haveError) return false; // this will return the sandbox or one promise to getSandbox;\n\n            return _this3.registry.getSandbox(domain);\n          }).then(function (proxySandbox) {\n            if (haveError) return false;\n            Loader_log.info('[Runtime.Loader] 4. if the sandbox is registered then return the sandbox', proxySandbox);\n            _proxySandbox = proxySandbox;\n            return proxySandbox;\n          }).catch(function (reason) {\n            if (haveError) return false;\n            Loader_log.info('[Runtime.Loader] 5. Sandbox was not found, creating a new one', reason);\n            var proxyCapabilities = {};\n\n            if (_proxyDescriptor && _proxyDescriptor.hasOwnProperty('capabilities')) {\n              _proxyDescriptor = _proxyDescriptor.stubCapabilities;\n            }\n\n            return _this3._runtimeFactory.createSandbox(proxyCapabilities).then(function (sandbox) {\n              sandbox.addListener('*', function (msg) {\n                _this3.messageBus.postMessage(msg);\n              });\n              return sandbox;\n            });\n          }).then(function (sandbox) {\n            if (haveError) return false;\n            Loader_log.info('[Runtime.Loader] 6. return the sandbox instance and register', sandbox, 'to domain ', domain);\n            _proxySandbox = sandbox; // we need register stub on registry - step xxx https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            return _this3.registry.registerIdpProxy(sandbox, domain);\n          }, handleError).then(function (runtimeIdpProxyURL) {\n            if (haveError) return false;\n            Loader_log.info('[Runtime.Loader] 7. Return the runtime Idp Proxy URL: ', runtimeIdpProxyURL); // we have completed step xxx https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n\n            _runtimeIdpProxyURL = runtimeIdpProxyURL; // Extend original hyperty configuration;\n\n            var configuration = {};\n\n            if (!emptyObject(_proxyDescriptor.configuration)) {\n              try {\n                configuration = Object.assign({}, JSON.parse(_proxyDescriptor.configuration));\n              } catch (e) {\n                configuration = _proxyDescriptor.configuration;\n              }\n            }\n\n            configuration.runtimeURL = _this3._runtimeURL; // Deploy Component step xxx\n\n            try {\n              // we have completed step xxx https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n              // Add the message bus listener\n              _this3.messageBus.addListener(_runtimeIdpProxyURL, function (msg) {\n                _proxySandbox.postMessage(msg);\n              });\n\n              return _proxySandbox.deployComponent(_proxySourcePackage.sourceCode, runtimeIdpProxyURL, configuration);\n            } catch (e) {\n              Loader_log.info('[Runtime.Loader] Error on deploy component:', e);\n              reject(e);\n            }\n          }, handleError).then(function () {\n            if (haveError) return false; // we have completed step xxx https://github.com/reTHINK-project/core-framework/blob/master/docs/specs/runtime/dynamic-view/basics/deploy-protostub.md\n            // Load Stub function resolved with success;\n            // let idpProxy = {\n            //   runtimeIdpProxyURL: _runtimeIdpProxyURL,\n            //   status: deployComponentStatus\n            // };\n            //this.registry.idpProxyList[domain].status = 'deployed';\n\n            var idpProxy = _this3.registry.idpProxyList[domain];\n            Loader_log.log('[Runtime.Loader.loadIdpProxy] 8: loaded: ', idpProxy);\n            resolve(idpProxy);\n            Loader_log.info('[Runtime.Loader.loadIdpProxy] ------------------- END ---------------------------\\n');\n          }, handleError).catch(errorReason);\n        }\n      });\n    } // Check if the loader is ready to load all components\n\n  }, {\n    key: \"_readyToUse\",\n    value: function _readyToUse() {\n      var status = false;\n      if (!this._runtimeURL) throw new Error('[Runtime.Loader] The loader need the runtime url address');\n      if (!this._messagesBus) throw new Error('[Runtime.Loader] The loader need the messageBus component');\n      if (!this._registry) throw new Error('[Runtime.Loader] The loader need the registry component');\n      if (!this._runtimeFactory) throw new Error('[Runtime.Loader] The loader need the runtime factory component');\n      status = true;\n      return status;\n    }\n  }, {\n    key: \"runtimeURL\",\n    set: function set(value) {\n      this._runtimeURL = value;\n    }\n    /**\r\n     * Get runtime url\r\n     * @return {string} value runtimeURL\r\n     */\n    ,\n    get: function get() {\n      return this._runtimeURL;\n    }\n    /**\r\n     * Set Registry component\r\n     * @param  {Registry} value Registry Component\r\n     */\n\n  }, {\n    key: \"registry\",\n    set: function set(value) {\n      this._registry = value; // Install AddressAllocation\n\n      var addressAllocation = allocation_AddressAllocation.instance;\n      this._addressAllocation = addressAllocation;\n      Loader_log.log('[Loader - AddressAllocation] - ', addressAllocation);\n    }\n    /**\r\n     * Get Registry component\r\n     * @return {Registry} Registry component\r\n     */\n    ,\n    get: function get() {\n      return this._registry;\n    }\n    /**\r\n     * Set Message Bus component\r\n     * @param  {MessageBus} value Message bus component\r\n     */\n\n  }, {\n    key: \"messageBus\",\n    set: function set(value) {\n      this._messagesBus = value;\n    }\n    /**\r\n     * Get Message Bus component\r\n     * @return {MessageBus} Message Bus component\r\n     */\n    ,\n    get: function get() {\n      return this._messagesBus;\n    }\n    /**\r\n     * Set Runtime Factory component\r\n     * @param  {runtimeFactory} value Factory includes the specific implementations for each environment\r\n     */\n\n  }, {\n    key: \"runtimeFactory\",\n    set: function set(value) {\n      this._runtimeFactory = value;\n    }\n    /**\r\n     * Get Runtime Factory component\r\n     * @return {runtimeFactory} Runtime Factory component\r\n     */\n    ,\n    get: function get() {\n      return this._runtimeFactory;\n    }\n  }]);\n\n  return Loader;\n}();\n\n/* harmony default export */ var runtime_Loader = (Loader_Loader);\n// CONCATENATED MODULE: ./src/runtime/Storage.js\n\nvar storages = {};\nfunction Storage_storage(runtimeFactory, runtimeStatusUpdate) {\n  if (!runtimeFactory) throw new Error('The runtime factory is a needed parameter');\n  Object.keys(runtimeConfiguration_runtimeConfiguration.storageSchemas).forEach(function (key) {\n    if (!storages.hasOwnProperty(key)) {\n      storages[key] = runtimeFactory.storageManager(key, runtimeConfiguration_runtimeConfiguration.storageSchemas[key], runtimeStatusUpdate);\n    }\n  });\n  return storages;\n}\nfunction createSyncDB(key, runtimeFactory, schema, runtimeStatusUpdate) {\n  var url = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n  if (!runtimeFactory) throw new Error('The runtime factory is a needed parameter');\n  var remote = url ? url : runtimeConfiguration_runtimeConfiguration.remoteStorage;\n  return runtimeFactory.storageManager(key, schema, runtimeStatusUpdate, remote);\n}\n// CONCATENATED MODULE: ./src/runtime/Descriptors.js\nfunction Descriptors_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Descriptors_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Descriptors_createClass(Constructor, protoProps, staticProps) { if (protoProps) Descriptors_defineProperties(Constructor.prototype, protoProps); if (staticProps) Descriptors_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\n\nvar Descriptors_log = loglevel[\"getLogger\"]('Descriptors');\n\nvar Descriptors_Descriptors =\n/*#__PURE__*/\nfunction () {\n  function Descriptors(runtimeURL, catalogue, runtimeConfiguration) {\n    Descriptors_classCallCheck(this, Descriptors);\n\n    if (!runtimeURL) throw Error('The descriptor need to know the runtime url to be used');\n    if (!catalogue) throw Error('The descriptor needs the catalogue instance');\n    if (!runtimeConfiguration) throw Error('The descriptor needs the runtime configuration');\n    this.log = Descriptors_log;\n    this.runtimeConfiguration = runtimeConfiguration;\n    this.runtimeURL = runtimeURL;\n    this.catalogue = catalogue;\n    this.constraints = runtimeUtils.runtimeCapabilities;\n  }\n\n  Descriptors_createClass(Descriptors, [{\n    key: \"getHypertyDescriptor\",\n    value: function getHypertyDescriptor(hypertyURL) {\n      return this.catalogue.getHypertyDescriptor(hypertyURL, true, this.constraints);\n    }\n  }, {\n    key: \"getStubDescriptor\",\n    value: function getStubDescriptor(stubURL) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var domain;\n        var protostub;\n        var protoStubURL;\n        var originDividedURL = divideURL(_this.runtimeURL);\n        var originDomain = originDividedURL.domain;\n\n        if (stubURL.includes('://')) {\n          var dividedURL = divideURL(stubURL);\n          domain = dividedURL.domain;\n          var path = dividedURL.identity;\n\n          if (path) {\n            protostub = path.substring(path.lastIndexOf('/') + 1);\n          } else {\n            protostub = 'default';\n          }\n        } else {\n          protostub = 'default';\n          domain = stubURL;\n        }\n\n        protoStubURL = buildURL(_this.runtimeConfiguration, 'catalogueURLs', 'protocolstub', protostub);\n\n        if (domain !== _this.runtimeConfiguration.domain) {\n          if (!stubURL.indexOf('https') || !stubURL.indexOf('hyperty-catalogue')) {\n            protoStubURL = stubURL;\n          } else {\n            // TODO: check how to load form different configuration domain\n            var resource = getConfigurationResources(_this.runtimeConfiguration, 'catalogueURLs', 'protocolstub');\n            protoStubURL = resource.prefix + domain + resource.suffix + protostub;\n          }\n        }\n\n        Descriptors_log.log('Load ProtocolStub for domain, ' + domain + ' : ', protoStubURL);\n        return _this.catalogue.getStubDescriptor(protoStubURL, true, _this.constraints).then(function (result) {\n          resolve(result);\n        }).catch(function (error) {\n          // log.log('Error: ', error);\n          protostub = domain;\n          domain = originDomain;\n          var resource = getConfigurationResources(_this.runtimeConfiguration, 'catalogueURLs', 'protocolstub');\n          protoStubURL = resource.prefix + domain + resource.suffix + protostub; // log.log('Fallback -> Load Protocolstub for domain, ' + domain + ' : ', protostub);\n\n          return _this.catalogue.getStubDescriptor(protoStubURL, true, _this.constraints);\n        }).then(function (result) {\n          resolve(result);\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n  }, {\n    key: \"getIdpProxyDescriptor\",\n    value: function getIdpProxyDescriptor(idpProxyURL) {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        var domain;\n        var idpproxy;\n        var originDividedURL = divideURL(_this2.runtimeURL);\n        var originDomain = originDividedURL.domain;\n        var constraints = _this2.constraints;\n        constraints.constraints.onlyAccessToken = true;\n        constraints.constraints.onlyIdAssertionValidation = true;\n        console.log('LOG HERE', constraints);\n\n        if (idpProxyURL.includes('://')) {\n          var dividedURL = divideURL(idpProxyURL);\n          domain = dividedURL.domain;\n          var path = dividedURL.identity;\n\n          if (path) {\n            idpproxy = path.substring(path.lastIndexOf('/') + 1);\n          } else {\n            idpproxy = 'default';\n          }\n        } else {\n          idpproxy = 'default';\n          domain = idpProxyURL;\n        }\n\n        var resource = getConfigurationResources(_this2.runtimeConfiguration, 'catalogueURLs', 'idpProxy');\n        idpProxyURL = resource.prefix + domain + resource.suffix + idpproxy; // log.log('Load Idp Proxy for domain, ' + domain + ' : ', idpProxyURL);\n\n        return _this2.catalogue.getIdpProxyDescriptor(idpProxyURL, true, constraints).then(function (result) {\n          resolve(result);\n        }).catch(function () {\n          idpproxy = domain;\n          domain = originDomain;\n          idpProxyURL = buildURL(_this2.runtimeConfiguration, 'catalogueURLs', 'idpProxy', idpproxy); // log.log('Load Idp Proxy for domain, ' + domain + ' : ', idpProxyURL);\n\n          return _this2.catalogue.getIdpProxyDescriptor(idpProxyURL, true, constraints);\n        }).then(function (result) {\n          resolve(result);\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n  }]);\n\n  return Descriptors;\n}();\n\n/* harmony default export */ var runtime_Descriptors = (Descriptors_Descriptors);\n// CONCATENATED MODULE: ./src/runtime/MsgBusHandlers.js\nfunction MsgBusHandlers_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction MsgBusHandlers_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction MsgBusHandlers_createClass(Constructor, protoProps, staticProps) { if (protoProps) MsgBusHandlers_defineProperties(Constructor.prototype, protoProps); if (staticProps) MsgBusHandlers_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n *  Class where message bus handlers are built. To be used by the RuntimeUA to initialise the runtime UA.\r\n */\n//import { log as logLevels } from '../logLevels';\n// Log System\n\nvar MsgBusHandlers_log = loglevel[\"getLogger\"]('RuntimeUA');\n\nvar MsgBusHandlers =\n/*#__PURE__*/\nfunction () {\n  function MsgBusHandlers(pep, idm, crypto) {\n    MsgBusHandlers_classCallCheck(this, MsgBusHandlers);\n\n    if (!pep) throw Error('[MsgBusHandlers] pep input paramenter is mandatory');\n    if (!idm) throw Error('[MsgBusHandlers] idm input paramente is mandatory');\n    if (!crypto) throw Error('[MsgBusHandlers] crypto input paramente is mandatory');\n    this.policyEngine = pep;\n    this.identityManager = idm;\n    this.cryptoManager = crypto;\n  } // Policy based access control for incoming messages\n\n\n  MsgBusHandlers_createClass(MsgBusHandlers, [{\n    key: \"pepInHandler\",\n    get: function get() {\n      var _this = this;\n\n      return function (ctx) {\n        _this.policyEngine.authorise(ctx.msg, true).then(function (changedMgs) {\n          ctx.msg = changedMgs;\n          ctx.next();\n        }).catch(function (reason) {\n          MsgBusHandlers_log.error(reason);\n          ctx.fail(reason);\n        });\n      };\n    } // Policy based access control for outgoing messages\n\n  }, {\n    key: \"pepOutHandler\",\n    get: function get() {\n      var _this = this;\n\n      return function (ctx) {\n        _this.policyEngine.authorise(ctx.msg, false).then(function (changedMgs) {\n          ctx.msg = changedMgs;\n          ctx.next();\n        }).catch(function (reason) {\n          MsgBusHandlers_log.error(reason);\n          ctx.fail(reason);\n        });\n      };\n    } // Add Identity info to messages\n\n  }, {\n    key: \"idmHandler\",\n    get: function get() {\n      var _this = this;\n\n      return function (ctx) {\n        _this.identityManager.processMessage(ctx.msg).then(function (changedMgs) {\n          ctx.msg = changedMgs;\n          ctx.next();\n        }).catch(function (reason) {\n          MsgBusHandlers_log.error(reason);\n          ctx.fail(reason);\n        });\n      };\n    } // encrypt messages\n\n  }, {\n    key: \"encryptHandler\",\n    get: function get() {\n      var _this = this;\n\n      return function (ctx) {\n        _this.cryptoManager.encryptMessage(ctx.msg).then(function (changedMgs) {\n          ctx.msg = changedMgs;\n          ctx.next();\n        }).catch(function (reason) {\n          MsgBusHandlers_log.error(reason);\n          ctx.fail(reason);\n        });\n      };\n    } // decrypt messages\n\n  }, {\n    key: \"decryptHandler\",\n    get: function get() {\n      var _this = this;\n\n      return function (ctx) {\n        _this.cryptoManager.decryptMessage(ctx.msg).then(function (changedMgs) {\n          ctx.msg = changedMgs;\n          ctx.next();\n        }).catch(function (reason) {\n          MsgBusHandlers_log.warn(reason);\n          ctx.fail(reason);\n        });\n      };\n    }\n  }]);\n\n  return MsgBusHandlers;\n}();\n\n/* harmony default export */ var runtime_MsgBusHandlers = (MsgBusHandlers);\n// CONCATENATED MODULE: ./src/discovery/CoreDiscovery.js\nfunction CoreDiscovery_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction CoreDiscovery_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction CoreDiscovery_createClass(Constructor, protoProps, staticProps) { if (protoProps) CoreDiscovery_defineProperties(Constructor.prototype, protoProps); if (staticProps) CoreDiscovery_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar CoreDiscovery_log = loglevel[\"getLogger\"]('CoreDiscovery');\n\n/**\r\n* Core Discovery interface\r\n* Class to allow applications to search for hyperties and DataObjects using the message bus\r\n*/\n\nvar CoreDiscovery_CoreDiscovery =\n/*#__PURE__*/\nfunction () {\n  /**\r\n  * To initialise the Discovery, which will provide the support for hyperties to\r\n  * query users registered in outside the internal core.\r\n  * @param  {MessageBus}          msgbus                msgbus\r\n  * @param  {RuntimeURL}          runtimeURL            runtimeURL\r\n  * @param  {graphConnector}    graphConnector\r\n  */\n  function CoreDiscovery(runtimeURL, msgBus, graphConnector, runtimeFactory, registry) {\n    CoreDiscovery_classCallCheck(this, CoreDiscovery);\n\n    if (!runtimeFactory) throw Error('The catalogue needs the runtimeFactory');\n\n    var _this = this;\n\n    this._messageBus = msgBus;\n    _this.graphConnector = graphConnector;\n    _this.httpRequest = runtimeFactory.createHttpRequest();\n    _this.domain = divideURL(runtimeURL).domain;\n    _this.discoveryURL = runtimeURL + '/discovery/';\n    _this.registry = registry;\n\n    _this.messageBus.addListener(_this.discoveryURL, function (msg) {\n      _this.discoveryManager(msg).then(function (result) {\n        //FLOW-OUT: message response\n        _this.messageBus.postMessage({\n          id: msg.id,\n          type: 'response',\n          from: msg.to,\n          to: msg.from,\n          body: {\n            code: 200,\n            value: result\n          }\n        });\n      }).catch(function (err) {\n        var description;\n        var code;\n\n        if (err === 'GraphConnector') {\n          description = 'This search is not available at the moment. Try later.';\n          code = 500;\n        } else {\n          description = 'Not Found';\n          code = 404;\n        } //FLOW-OUT: error message response\n\n\n        _this.messageBus.postMessage({\n          id: msg.id,\n          type: 'response',\n          from: msg.to,\n          to: msg.from,\n          body: {\n            code: code,\n            description: description\n          }\n        });\n      });\n    });\n  }\n  /**\r\n   * Returns the MessageBus.\r\n   */\n\n\n  CoreDiscovery_createClass(CoreDiscovery, [{\n    key: \"discoveryManager\",\n\n    /* function to decide what discovery method to call and later return the response msg  */\n    value: function discoveryManager(msg) {\n      var _this = this;\n\n      var domain = divideURL(msg.from).domain;\n      var atributes = msg.body.resource.split('/').filter(Boolean);\n      var resources = [];\n      var dataSchemes = [];\n      CoreDiscovery_log.log('[CoreDiscovery.discoveryManager] received: ', msg);\n\n      if (msg.body.criteria) {\n        if (msg.body.criteria.resources) {\n          resources = msg.body.criteria.resources;\n        }\n\n        if (msg.body.criteria.dataSchemes) {\n          dataSchemes = msg.body.criteria.dataSchemes;\n        }\n      }\n\n      switch (atributes[1]) {\n        case 'user':\n          if (atributes[0] == 'hyperty') {\n            return _this.discoverHyperties(msg.body.resource.split('user/')[1], dataSchemes, resources, msg.body.criteria.domain);\n          } else {\n            return _this.discoverDataObjects(msg.body.resource.split('user/')[1], dataSchemes, resources, msg.body.criteria.domain);\n          }\n\n          break;\n\n        case 'url':\n          if (atributes[0] == 'hyperty') {\n            return _this.discoverHypertyPerURL(msg.body.resource.split('url/')[1], msg.body.criteria.domain);\n          } else {\n            return _this.discoverDataObjectPerURL(msg.body.resource.split('url/')[1], msg.body.criteria.domain);\n          }\n\n          break;\n\n        case 'name':\n          return _this.discoverDataObjectsPerName(msg.body.resource.split('name/')[1], dataSchemes, resources, msg.body.criteria.domain);\n          break;\n\n        case 'reporter':\n          return _this.discoverDataObjectsPerReporter(msg.body.resource.split('reporter/')[1], dataSchemes, resources, msg.body.criteria.domain);\n          break;\n\n        case 'guid':\n          if (typeof _this.graphConnector !== 'undefined' && _this.graphConnector !== null) {\n            if (atributes[0] == 'hyperty') {\n              return _this.discoverHypertiesPerGUID(msg.body.resource.split('user-guid://')[1], dataSchemes, resources);\n            } else {\n              return _this.discoverDataObjectsPerGUID(msg.body.resource.split('user-guid://')[1], dataSchemes, resources);\n            }\n\n            break;\n          } else {\n            return Promise.reject('GraphConnector');\n            break;\n          }\n\n        case 'userprofile':\n          if (typeof _this.graphConnector !== 'undefined' && _this.graphConnector !== null) {\n            if (atributes[0] == 'hyperty') {\n              return _this.discoverHypertiesPerUserProfileData(msg.body.resource.split('userprofile/')[1], dataSchemes, resources);\n            } else {\n              return _this.discoverDataObjectsPerUserProfileData(msg.body.resource.split('userprofile/')[1], dataSchemes, resources);\n            }\n\n            break;\n          } else {\n            return Promise.reject('GraphConnector');\n            break;\n          }\n\n      }\n    }\n    /**\r\n    * Advanced Search for Hyperties registered in domain registry associated with some user identifier (eg email, name ...)\r\n    * @param  {String}           userIdentifier\r\n    * @param  {Array<string>}    dataSchemes (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverHypertiesPerUserProfileData\",\n    value: function discoverHypertiesPerUserProfileData(userIdentifier, dataSchemes, resources) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //translate user identifier (e.g. email, name...) into the associated GUIDs\n        _this.discoverGUIDPerUserIdentifier(userIdentifier).then(function (guids) {\n          var hypertiesPromises = guids.map(function (guid) {\n            return new Promise(function (resolve, reject) {\n              _this.discoverHypertiesPerGUID(guid, dataSchemes, resources).then(function (hyperties) {\n                resolve(hyperties);\n              }).catch(function (err) {\n                resolve([]);\n              });\n            });\n          });\n          Promise.all(hypertiesPromises).then(function (hypertiesResult) {\n            var hyperties = [].concat.apply([], hypertiesResult);\n\n            if (hyperties.length === 0) {\n              return reject('No hyperties were found');\n            }\n\n            resolve(hyperties);\n          });\n        }).catch(function (err) {\n          return reject(err);\n        });\n      });\n    }\n    /**\r\n    * Advanced Search for DataObjects registered in domain registry associated with some user identifier (eg email, name ...)\r\n    * @param  {String}           userIdentifier\r\n    * @param  {Array<string>}    dataSchemes (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerUserProfileData\",\n    value: function discoverDataObjectsPerUserProfileData(userIdentifier, dataSchemes, resources) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //translate user identifier (e.g. email, name...) into the associated GUIDs\n        _this.discoverGUIDPerUserIdentifier(userIdentifier).then(function (guids) {\n          var dataObjectsPromises = guids.map(function (guid) {\n            return new Promise(function (resolve, reject) {\n              _this.discoverDataObjectsPerGUID(guid, dataSchemes, resources).then(function (dataObjects) {\n                resolve(dataObjects);\n              }).catch(function (err) {\n                resolve([]);\n              });\n            });\n          });\n          Promise.all(dataObjectsPromises).then(function (dataObjectsResult) {\n            var dataObjects = [].concat.apply([], dataObjectsResult);\n\n            if (dataObjects.length === 0) {\n              return reject('No dataObjects were found');\n            }\n\n            resolve(dataObjects);\n          });\n        }).catch(function (err) {\n          return reject(err);\n        });\n      });\n    }\n    /**\r\n    * Advanced Search for Hyperties registered in domain registry associated with some GUID\r\n    * @param  {String}             guid\r\n    * @param  {Array<string>}    dataSchemes (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverHypertiesPerGUID\",\n    value: function discoverHypertiesPerGUID(guid, dataSchemes, resources) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //translate GUID into the user IDs to query the domain registry\n        _this.discoverUserIdsPerGUID(guid).then(function (uids) {\n          //translate user IDs into the associated hyperties registered in some domain\n          var hypertiesPromises = uids.map(function (uid) {\n            return new Promise(function (resolve, reject) {\n              _this.discoverHyperties(uid.uID, dataSchemes, resources, uid.domain).then(function (hyperties) {\n                resolve(hyperties);\n              }).catch(function (err) {\n                resolve([]);\n              });\n            });\n          });\n          Promise.all(hypertiesPromises).then(function (hypertiesResult) {\n            var hyperties = [].concat.apply([], hypertiesResult);\n\n            if (hyperties.length === 0) {\n              return reject('No hyperties were found');\n            } // log.log('Hyperties : ', hyperties);\n\n\n            resolve(hyperties);\n          });\n        }).catch(function (err) {\n          return reject(err);\n        });\n      });\n    }\n    /**\r\n    * Advanced Search for DataObjects registered in domain registry associated with some GUID\r\n    * @param  {String}             guid\r\n    * @param  {Array<string>}    dataSchemes (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerGUID\",\n    value: function discoverDataObjectsPerGUID(guid, dataSchemes, resources) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //translate GUID into the user IDs to query the domain registry\n        _this.discoverUserIdsPerGUID(guid).then(function (uids) {\n          //translate user IDs into the associated dataObjects registered in some domain\n          var dataObjectPromises = uids.map(function (uid) {\n            return new Promise(function (resolve, reject) {\n              _this.discoverDataObjects(uid.uID, dataSchemes, resources, uid.domain).then(function (dataObjects) {\n                resolve(dataObjects);\n              }).catch(function (err) {\n                resolve([]);\n              });\n            });\n          });\n          Promise.all(dataObjectPromises).then(function (dataObjectsResult) {\n            var dataObjects = [].concat.apply([], dataObjectsResult);\n\n            if (dataObjects.length === 0) {\n              return reject('No dataObjects were found');\n            } // log.log('DataObjects : ', dataObjects);\n\n\n            resolve(dataObjects);\n          });\n        }).catch(function (err) {\n          return reject(err);\n        });\n      });\n    }\n    /** Advanced Search for Hyperties registered in domain registry and associated with some user ID\r\n    * @param  {String}           user                  user identifier, either in url or email format\r\n    * @param  {Array<string>}    dataSchemes (Optional)     types of hyperties schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of hyperties resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverHyperties\",\n    value: function discoverHyperties(user, dataSchemes, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: 'domain://registry.' + activeDomain,\n        body: {}\n      };\n\n      if (user.indexOf('user://') > -1) {\n        msg.body.resource = user;\n      } else {\n        msg.body.resource = '/hyperty/idp-identifier/' + user;\n      }\n\n      if (dataSchemes.length > 0) {\n        if (!msg.body.criteria) {\n          msg.body.criteria = {};\n        }\n\n        msg.body.criteria.dataSchemes = dataSchemes;\n      }\n\n      if (resources.length > 0) {\n        if (!msg.body.criteria) {\n          msg.body.criteria = {};\n        }\n\n        msg.body.criteria.resources = resources;\n      }\n\n      return new Promise(function (resolve, reject) {\n        // log.log(\"[CoreDiscovery.discoverHyperties] sending msg \", msg);\n        _this.messageBus.postMessage(msg, function (reply) {\n          // log.log(\"[CoreDiscovery.discoverHyperties] rcved reply \", reply);\n          if (reply.body.code === 200 || reply.body.code === 500) {\n            var hyperties = reply.body.value;\n            var finalHyperties = [];\n\n            for (var key in hyperties) {\n              finalHyperties.push(hyperties[key]);\n            }\n\n            if (finalHyperties.length > 0) {\n              // log.log(\"[CoreDiscovery.discoverHyperties] Hyperties Found: \", finalHyperties);\n              resolve(finalHyperties);\n            } else {\n              return reject('No Hyperty was found');\n            }\n          } else {\n            return reject('No Hyperty was found');\n          }\n          /*_this.registry.isLegacy(user).then((legacy) => {\r\n                if (legacy) resolve([{hypertyID: user }])\r\n                else return reject('No Hyperty was found');\r\n            });*/\n\n        });\n      });\n    }\n    /** Advanced Search for DataObjects registered in domain registry and associated with some user ID\r\n    * @param  {String}           user                  user identifier, either in url or email format\r\n    * @param  {Array<string>}    dataSchemes (Optional)     types of dataObjects schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObjects resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverDataObjects\",\n    value: function discoverDataObjects(user, dataSchemes, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      var dataObjectsArray = [];\n      activeDomain = !domain ? _this.domain : domain;\n      return new Promise(function (resolve, reject) {\n        //translate user identifier (e.g. email, name...) into the associated hyperties\n        _this.discoverHyperties(user, [], [], activeDomain).then(function (hyperties) {\n          var finalHyperties = [];\n\n          for (var key in hyperties) {\n            finalHyperties.push(hyperties[key]);\n          } //translate hyperties URLs into the associated dataObjects registered in some domain\n\n\n          var dataObjectsPromises = finalHyperties.map(function (hyperty) {\n            return new Promise(function (resolve, reject) {\n              _this.discoverDataObjectsPerReporter(hyperty.hypertyID, dataSchemes, resources, activeDomain).then(function (dataObject) {\n                resolve(dataObject);\n              }).catch(function (err) {\n                resolve([]);\n              });\n            });\n          });\n          Promise.all(dataObjectsPromises).then(function (dataObjectsResult) {\n            var dataObjects = [].concat.apply([], dataObjectsResult);\n            dataObjects.forEach(function (dataObject) {\n              dataObjectsArray.push(dataObject);\n            });\n            var finalDataObjects = [];\n\n            for (var key in dataObjectsArray) {\n              finalDataObjects.push(dataObjectsArray[key]);\n            }\n\n            if (finalDataObjects.length === 0) {\n              return reject('No dataObjects were found');\n            } // log.log('DataObjects Found: ', finalDataObjects);\n\n\n            resolve(finalDataObjects);\n          });\n        }).catch(function (err) {\n          return reject(err);\n        });\n      });\n    }\n    /**\r\n    * function to request about hyperties registered in domain registry, and\r\n    * return the hyperty information, if found.\r\n    * @param  {String}              url  dataObject URL\r\n    * @param  {String}            domain (Optional)\r\n    * @return {Promise}          Promise\r\n    */\n\n  }, {\n    key: \"discoverHypertyPerURL\",\n    value: function discoverHypertyPerURL(url, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: 'domain://registry.' + activeDomain,\n        body: {\n          resource: url\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          if (reply.body.code !== 200 && reply.body.code !== 500) {\n            return reject('No Hyperty was found');\n          }\n\n          var hyperty = reply.body.value;\n\n          if (hyperty) {\n            // log.log('Hyperty found: ', hyperty);\n            resolve(hyperty);\n          } else {\n            return reject('No Hyperty was found');\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about dataObject registered in domain registry, and\r\n    * return the dataObject information, if found.\r\n    * @param  {String}              url  dataObject URL\r\n    * @param  {String}            domain (Optional)\r\n    * @return {Promise}          Promise\r\n    */\n\n  }, {\n    key: \"discoverDataObjectPerURL\",\n    value: function discoverDataObjectPerURL(url, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: 'domain://registry.' + activeDomain,\n        body: {\n          resource: url\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          var dataObject = reply.body.value;\n\n          if (dataObject) {\n            // log.log('DataObject found: ', dataObject);\n            resolve(dataObject);\n          } else {\n            return reject('DataObject not found');\n          }\n        });\n      });\n    }\n    /** Advanced Search for dataObjects registered in domain registry\r\n    * @param  {String}           name                  name of the dataObject\r\n    * @param  {Array<string>}    dataSchemes (Optional)     types of dataObject schemas\r\n    * @param  {Array<string>}    resources (Optional)  types of dataObject resources\r\n    * @param  {String}           domain (Optional)     domain of the registry to search\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerName\",\n    value: function discoverDataObjectsPerName(name, dataSchemes, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: 'domain://registry.' + activeDomain,\n        body: {\n          resource: name\n        }\n      };\n\n      if (dataSchemes.length > 0) {\n        if (!msg.body.criteria) {\n          msg.body.criteria = {};\n        }\n\n        msg.body.criteria.dataSchemes = dataSchemes;\n      }\n\n      if (resources.length > 0) {\n        if (!msg.body.criteria) {\n          msg.body.criteria = {};\n        }\n\n        msg.body.criteria.resources = resources;\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          var dataObjects = reply.body.value;\n          var finalDataObjects = [];\n\n          for (var key in dataObjects) {\n            finalDataObjects.push(dataObjects[key]);\n          }\n\n          if (finalDataObjects.length > 0) {\n            // log.log(\"DataObjects Found: \", finalDataObjects);\n            resolve(finalDataObjects);\n          } else {\n            return reject('No DataObject was found');\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request about specific reporter dataObject registered in domain registry, and\r\n    * return the dataObjects from that reporter.\r\n    * @param  {String}           reporter                         dataObject reporter\r\n    * @param  {Array<string>}    scdataSchemeshema                (Optional)     types of dataObjects schemas\r\n    * @param  {Array<string>}    resources                        (Optional)  types of dataObjects resources\r\n    * @param  {String}           domain                           (Optional)\r\n    */\n\n  }, {\n    key: \"discoverDataObjectsPerReporter\",\n    value: function discoverDataObjectsPerReporter(reporter, dataSchemes, resources, domain) {\n      var _this = this;\n\n      var activeDomain;\n      activeDomain = !domain ? _this.domain : domain;\n      var msg = {\n        type: 'read',\n        from: _this.discoveryURL,\n        to: 'domain://registry.' + activeDomain,\n        body: {\n          resource: '/comm',\n          criteria: {\n            reporter: reporter\n          }\n        }\n      };\n\n      if (dataSchemes.length > 0) {\n        msg.body.criteria.dataSchemes = dataSchemes;\n      }\n\n      if (resources.length > 0) {\n        msg.body.criteria.resources = resources;\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.messageBus.postMessage(msg, function (reply) {\n          var dataObjects = reply.body.value;\n          var finalDataObjects = [];\n\n          for (var key in dataObjects) {\n            finalDataObjects.push(dataObjects[key]);\n          }\n\n          if (finalDataObjects.length > 0) {\n            // log.log(\"DataObjects Found: \", finalDataObjects);\n            resolve(finalDataObjects);\n          } else {\n            return reject('No DataObject was found');\n          }\n        });\n      });\n    }\n    /**\r\n    * function to request global registry about the user IDs associated with some GUID\r\n    * @param  {String}              guid\r\n    * @return {Promise}          Promise\r\n    */\n\n  }, {\n    key: \"discoverUserIdsPerGUID\",\n    value: function discoverUserIdsPerGUID(guid) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        // log.log(\"GO graphConnector:\", guid);\n        _this.graphConnector.queryGlobalRegistry(guid).then(function (graphConnectorContactData) {\n          // log.log('Information returned from Global Registry: ', graphConnectorContactData);\n          if (typeof graphConnectorContactData === 'string' || !graphConnectorContactData) {\n            return reject('Unsuccessful discover userIDs by GUID');\n          } else {\n            var userids = graphConnectorContactData.userIDs;\n\n            if (userids.length === 0) {\n              return reject('UserIDs not available');\n            }\n\n            resolve(userids);\n          }\n        }).catch(function (err) {\n          return reject(err);\n        });\n      });\n    }\n    /**\r\n    * function to request discovery service about the GUID associated with some user identifier (eg email, name ...)\r\n    * @param  {String}            userIdentifier\r\n    * @return {Promise}           Promise\r\n    */\n\n  }, {\n    key: \"discoverGUIDPerUserIdentifier\",\n    value: function discoverGUIDPerUserIdentifier(userIdentifier) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var lookupURLDiscoveryService = 'https://rethink.tlabscloud.com/discovery/rest/discover/lookup?searchquery=';\n\n        _this.httpRequest.get(lookupURLDiscoveryService + userIdentifier).then(function (json) {\n          // log.log('discover GUID by user identifier', json);\n          var response = JSON.parse(json);\n          var filteredGuid = response.results.filter(function (x) {\n            return x.rethinkID != undefined;\n          });\n\n          if (filteredGuid.length === 0) {\n            return reject('Unsuccessful discover GUID by user identifier');\n          }\n\n          var guids = filteredGuid.map(function (x) {\n            return x.rethinkID;\n          });\n          return resolve(guids);\n        }).catch(function (err) {\n          // log.log(\"HTTP Request error: \", err);\n          return reject(err);\n        });\n      });\n    }\n  }, {\n    key: \"messageBus\",\n    get: function get() {\n      return this._messageBus;\n    }\n    /**\r\n     * Sets the MessageBus.\r\n     * @param {MessageBus}           messageBus    The Message Bus.\r\n     */\n    ,\n    set: function set(messageBus) {\n      this._messageBus = messageBus;\n    }\n  }]);\n\n  return CoreDiscovery;\n}();\n\n/* harmony default export */ var discovery_CoreDiscovery = (CoreDiscovery_CoreDiscovery);\n// CONCATENATED MODULE: ./src/store-objects/DataObjectsStorage.js\nfunction DataObjectsStorage_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { DataObjectsStorage_typeof = function _typeof(obj) { return typeof obj; }; } else { DataObjectsStorage_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return DataObjectsStorage_typeof(obj); }\n\nfunction DataObjectsStorage_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DataObjectsStorage_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction DataObjectsStorage_createClass(Constructor, protoProps, staticProps) { if (protoProps) DataObjectsStorage_defineProperties(Constructor.prototype, protoProps); if (staticProps) DataObjectsStorage_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar DataObjectsStorage_log = loglevel[\"getLogger\"]('DataObjectsStorage');\n\n\n\nvar DataObjectsStorage_DataObjectsStorage =\n/*#__PURE__*/\nfunction () {\n  function DataObjectsStorage(storageManager) {\n    var storedDataObjects = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var factory = arguments.length > 2 ? arguments[2] : undefined;\n    var runtimeStatusUpdate = arguments.length > 3 ? arguments[3] : undefined;\n\n    DataObjectsStorage_classCallCheck(this, DataObjectsStorage);\n\n    if (!storageManager) throw new Error('[Store Data Objects] - Needs the storageManager component');\n    this._storageManager = storageManager;\n    this._storeDataObject = storedDataObjects;\n    this._cache = {};\n    this._createSyncDB = createSyncDB; // to create Data Objects to be synched with remote storages\n\n    this._remotes = {}; // List of DO synched with remote storages\n\n    this._factory = factory;\n    this._table = 'syncherManager:ObjectURLs';\n    this._remoteStorageTable = 'dataObjectStorage';\n    this._remoteSchema = 'url';\n    this._runtimeStatusUpdate = runtimeStatusUpdate;\n  } // load Data Objects synched with remote Storages\n\n\n  DataObjectsStorage_createClass(DataObjectsStorage, [{\n    key: \"loadRemote\",\n    value: function loadRemote() {\n      var _this2 = this;\n\n      var resume = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var loading = [];\n        var loadingDBs = [];\n\n        _this._storageManager.get(null, null, 'remotes').then(function (remotes) {\n          // in case we don't have any remotes locally stored\n          DataObjectsStorage_log.info('[StoreDataObjects.loadRemote] remotes: ', remotes);\n          if (!remotes) resolve();\n          if (!resume) _this._remotes = remotes;\n          DataObjectsStorage_log.info('[StoreDataObjects.loadRemote] loading: ', _this._remotes);\n          var remoteObjects = Object.keys(remotes); // in case we don't have any remotes locally stored\n\n          if (remoteObjects.length === 0) resolve();\n          remoteObjects.forEach(function (db) {\n            var schema = {};\n            var table = db.split('/')[3];\n            schema[table] = _this2._remoteSchema;\n            _this._remotes[db] = createSyncDB(db, _this2._factory, schema, _this2._runtimeStatusUpdate); //            _this._remotes[remote] = createSyncDB(remote, _this._factory, 'remoteDataObjectStorage' );\n\n            loading.push(_this._remotes[db].get(null, null, table));\n          });\n          Promise.all(loading).then(function () {\n            DataObjectsStorage_log.log('[StoreDataObjects.loadRemote] loaded. Starting init'); //TODO: init this._storeDataObject with loaded data objects\n\n            Object.keys(_this._remotes).forEach(function (remote) {\n              var table = remote.split('/')[3];\n              loadingDBs.push(_this._remotes[remote].get(null, null, table));\n            });\n            Promise.all(loadingDBs).then(function (dataObjs) {\n              if (dataObjs.length === 0) resolve();\n              dataObjs.forEach(function (dO) {\n                Object.keys(dO).forEach(function (url) {\n                  DataObjectsStorage_log.log('[StoreDataObjects.loadRemote] loaded remote ', dO[url]); //              if (dO[remote].isReporter) {\n\n                  var type = _this2._getTypeOfObject(dO[url].isReporter);\n\n                  if (!_this._storeDataObject) _this._storeDataObject = {};\n                  if (!_this._storeDataObject.hasOwnProperty(type)) _this._storeDataObject[type] = {};\n                  _this._storeDataObject[type][url] = dO[url];\n                });\n              });\n              resolve(_this._storeDataObject);\n            }, function (error) {\n              reject(error);\n            });\n          });\n        }, function (error) {\n          reject(error);\n        });\n\n        resolve();\n      });\n    } // delete Data Objects synched with remote Storages\n\n  }, {\n    key: \"deleteRemotes\",\n    value: function deleteRemotes() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var deleting = [];\n        var disconnecting = [];\n\n        _this._storageManager.get(null, null, 'remotes').then(function (remotes) {\n          // in case we don't have any remotes locally stored\n          DataObjectsStorage_log.info('[StoreDataObjects.deleteRemotes] remotes: ', remotes);\n          if (!remotes) resolve();\n          var remoteObjects = Object.keys(_this._remotes); // in case we don't have any remotes locally stored\n\n          if (remoteObjects.length === 0) resolve();\n          remoteObjects.forEach(function (db) {\n            deleting.push(_this._remotes[db].disconnect());\n            deleting.push(_this._remotes[db].delete());\n          });\n          Promise.all(deleting).then(function () {\n            DataObjectsStorage_log.log('[StoreDataObjects.deleteRemotes] deleted.');\n            resolve();\n          }, function (error) {\n            resolve();\n          });\n        });\n\n        resolve();\n      });\n    }\n    /**\r\n     * @description should set the initial state of the dataObjectURL to be resumed if necessary;\r\n     *\r\n     * @param {DataObjectURL} url - dataObjectURL to be saved;\r\n     * @param {Boolean} isReporter - the object to be saved is a reporter\r\n     * @param {SchemaURL} schema - the schema url\r\n     * @param {String} status - the status of current dataObject\r\n     * @param {HypertyURL} reporter - the Reporter hypertyURL\r\n     * @param {Array<HypertyURL>} subscription - list of subscriptions\r\n     * @param {Array<DataObjectChild>} children - list of childs of dataObjectURL\r\n     * @param {Array<String>} childrens - list of childrens, like, 'chatmessage';\r\n     * @param {Array<UserURL} subscriberUser - list of subscribed users;\r\n     */\n\n  }, {\n    key: \"set\",\n    value: function set(metadata) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        var storeDataObject = _this3._storeDataObject ? _this3._storeDataObject : {};\n\n        var type = _this3._getTypeOfObject(metadata.isReporter);\n\n        if (!storeDataObject.hasOwnProperty(type)) storeDataObject[type] = {};\n\n        if (!storeDataObject[type].hasOwnProperty(metadata.url)) {\n          storeDataObject[type][metadata.url] = {};\n          storeDataObject[type][metadata.url].subscriptions = []; // TODO:do we need this?\n\n          storeDataObject[type][metadata.url].subscriberUsers = []; // TODO:do we need this?\n\n          storeDataObject[type][metadata.url].childrenObjects = {};\n          storeDataObject[type][metadata.url].data = {};\n        }\n\n        Object.assign(storeDataObject[type][metadata.url], metadata);\n        delete storeDataObject[type][metadata.url].subscriberUser;\n        delete storeDataObject[type][metadata.url].subscriberHyperty;\n        storeDataObject[type][metadata.url].backup = metadata.hasOwnProperty('backup') ? metadata.backup : false;\n        /*if (schema) storeDataObject[type][metadata.url].schema = schema;\r\n        if (status) storeDataObject[type][metadata.url].status = status;\r\n        if (childrenResources) storeDataObject[type][metadata.url].childrenResources = childrenResources;*/\n\n        if (metadata.subscriberHyperty && !metadata.isReporter) {\n          // TODO: do we need this?\n          _this3._updateToArray(storeDataObject[type], metadata.url, 'subscriptions', metadata.subscriberHyperty);\n        } //storeDataObject[type][metadata.url].owner = owner;\n\n\n        if (metadata.subscriberUser) {\n          // TODO: do we need this?\n          if (storeDataObject[type][metadata.url].subscriberUsers.indexOf(metadata.subscriberUser)) {\n            _this3._updateToArray(storeDataObject[type], metadata.url, 'subscriberUsers', metadata.subscriberUser);\n          }\n        }\n\n        _this3._storeDataObject = storeDataObject;\n        var backup = metadata.hasOwnProperty('backup') ? metadata.backup : false;\n        var db = backup ? metadata.url : _this3._table;\n        var table = backup ? db.split('/')[3] : _this3._table;\n\n        if (backup && !_this3._remotes[db]) {\n          var schema = {};\n          schema[table] = _this3._remoteSchema;\n          _this3._remotes[db] = createSyncDB(db, _this3._factory, schema, _this3._runtimeStatusUpdate);\n        } // Save Data Object URL at remotes table to support resumes\n\n\n        if (backup) _this3._storageManager.set(metadata.url, 0, metadata.url, 'remotes');\n        var storage = backup ? _this3._remotes[db] : _this3._storageManager;\n\n        if (metadata.isReporter && backup) {\n          // lets connect to remote storage to enable sync\n          var options = {\n            table: table\n          };\n          storage.connect(options).then(function () {\n            storage.set(db, 0, storeDataObject[type][metadata.url], table).then(function () {\n              resolve(storeDataObject[type][metadata.url]);\n            }, function (error) {\n              DataObjectsStorage_log.error('[DataObjectStorage.set] failed to save into remote storage: ', error);\n\n              _this3._connectToRemoteThread(storage, options, db, storeDataObject[type][metadata.url], table);\n\n              resolve(storeDataObject[type][metadata.url]);\n            });\n          }, function (error) {\n            DataObjectsStorage_log.error('[DataObjectStorage.set] failed to connect with remote storage: ', error, ' trying again...');\n\n            _this3._connectToRemoteThread(storage, options, db, storeDataObject[type][metadata.url], table);\n\n            resolve(storeDataObject[type][metadata.url]);\n          }); //          return storeDataObject[type][metadata.url];\n        } else {\n          storage.set(db, 1, _this3._filterRemotes(storeDataObject), table).then(function () {\n            resolve(storeDataObject[type][metadata.url]);\n          });\n        }\n      });\n    }\n  }, {\n    key: \"_connectToRemoteThread\",\n    value: function _connectToRemoteThread(storage, options, db, dataObject, table) {\n      var connected = false;\n      var id;\n\n      var connect = function connect(dO) {\n        DataObjectsStorage_log.error('[DataObjectStorage._connectToRemote] trying to connect to remote storage ... ');\n        storage.connect(options).then(function () {\n          storage.set(db, 0, dO, table).then(function () {\n            connected = true;\n            clearInterval(id);\n          }, function (error) {\n            DataObjectsStorage_log.error('[DataObjectStorage._connectToRemote] failed to save into remote storage: ', error);\n          });\n        }, function (error) {\n          DataObjectsStorage_log.error('[DataObjectStorage._connectToRemote] failed to connect to remote storage: ', error);\n        });\n      };\n\n      id = setInterval(function () {\n        if (!connected) connect(dataObject);\n      }, 5000);\n    } // to filter Data Objects that are stored outside the ObjectURLs table\n\n  }, {\n    key: \"_filterRemotes\",\n    value: function _filterRemotes(storeDataObject) {\n      var remotes = Object.keys(this._remotes);\n      var filtered = deepClone(storeDataObject);\n      remotes.forEach(function (remote) {\n        if (filtered['reporters'][remote]) delete filtered['reporters'][remote];else delete filtered['observers'][remote];\n      });\n      console.log('[DataObjectStorage._filterRemotes] ', filtered);\n      return filtered;\n    } // Initial Sync of Observer to avoid later mismatches with sync revisions\n    // OUtdated: not used anymore\n\n    /*\r\n      initialObserverSync(resource, backupRevision) {\r\n        // to be completed\r\n        let table = resource.split('/')[3];\r\n    \r\n        let _this = this;\r\n    \r\n        let options = {table: table, observer: true, baseRevision: backupRevision, syncedRevision: backupRevision};\r\n    \r\n        console.log('[DataObjectStorage.initialObserverSync] object: ', resource, ' revision ', backupRevision)\r\n    \r\n        _this._remotes[resource].connect(options).then(()=> {\r\n    \r\n          console.log('[DataObjectStorage.initialObserverSync] connected ');\r\n    \r\n                setTimeout(function() {\r\n                  _this._remotes[resource].disconnect().then(()=>{\r\n                    console.log('[DataObjectStorage.initialObserverSync] disconnected ');\r\n                },(error)=> {\r\n                  log.error('[DataObjectStorage.initialObserverSync] Error disconnecting with remote storage');\r\n                  reject(error);\r\n                });\r\n                }, 15000)\r\n    \r\n        }, (error) => {\r\n          log.error('[DataObjectStorage.initialObserverSync] Error connecting to remote storage');\r\n          reject(error)\r\n        });\r\n    \r\n      }*/\n\n    /**\r\n     * @description should save and update the current dataObject data information\r\n     *\r\n     * @param {Boolean} isReporter - the object to be saved is a reporter\r\n     * @param {DataObjectURL} resource - dataObjectURL to be saved or updated;\r\n     * @param {String} attribute - attribute inside the data which will be saved\r\n     * @param {any} data - value will be saved inside the attribute;\r\n     */\n\n  }, {\n    key: \"saveData\",\n    value: function saveData(isReporter, resource, attribute, value, updateRuntimeStatus) {\n      var storeDataObject = this._storeDataObject;\n\n      var type = this._getTypeOfObject(isReporter);\n\n      if (!storeDataObject || !storeDataObject[type] || !storeDataObject[type][resource]) {\n        DataObjectsStorage_log.log('[StoreDataObjects - save data] - not saved');\n        return;\n      }\n\n      DataObjectsStorage_log.log('[StoreDataObjects - saveData] - ', isReporter, type, resource, attribute, value);\n\n      if (!storeDataObject[type][resource].hasOwnProperty('data')) {\n        storeDataObject[type][resource].data = {};\n      }\n\n      if (attribute) {\n        var _data;\n\n        if (DataObjectsStorage_typeof(value) === 'object') _data = deepClone(value);else _data = value;\n        utils_assign(storeDataObject[type][resource].data, attribute, _data);\n      } else {\n        storeDataObject[type][resource].data = deepClone(value) || {};\n      }\n\n      this._storeDataObject = storeDataObject;\n      var db = storeDataObject[type][resource].backup ? storeDataObject[type][resource].url : 'syncherManager:ObjectURLs';\n      var storage = storeDataObject[type][resource].backup ? this._remotes[db] : this._storageManager;\n      var table = storeDataObject[type][resource].backup ? db.split('/')[3] : this._table;\n      var data = storeDataObject[type][resource].backup ? storeDataObject[type][resource] : this._filterRemotes(storeDataObject);\n      storage.set(db, 1, data, table, updateRuntimeStatus).then(function () {\n        return storeDataObject[type][resource];\n      }, function (error) {\n        console.error(error);\n        return storeDataObject[type][resource];\n      });\n    }\n  }, {\n    key: \"saveChildrens\",\n    value: function saveChildrens(isReporter, resource, attribute, value) {\n      var storeDataObject = this._storeDataObject;\n\n      var type = this._getTypeOfObject(isReporter);\n\n      if (!storeDataObject || !storeDataObject[type] || !storeDataObject[type][resource]) {\n        DataObjectsStorage_log.log('[StoreDataObjects - save childrens] - not saved');\n        return;\n      }\n\n      if (!storeDataObject[type][resource].hasOwnProperty('childrens')) {\n        storeDataObject[type][resource].childrenObjects = {};\n      }\n      /*    if (!storeDataObject[type][resource].childrenObjects.hasOwnProperty('resources')) {\r\n            storeDataObject[type][resource].childrenObjects.resources = {};\r\n          }*/\n\n\n      if (attribute) {\n        utils_assign(storeDataObject[type][resource].childrenObjects, attribute, deepClone(value));\n      } else {\n        storeDataObject[type][resource].childrenObjects = deepClone(value) || {};\n      }\n\n      this._storeDataObject = storeDataObject;\n      var db = storeDataObject[type][resource].backup ? storeDataObject[type][resource].url : 'syncherManager:ObjectURLs';\n      var storage = storeDataObject[type][resource].backup ? this._remotes[db] : this._storageManager;\n      var table = storeDataObject[type][resource].backup ? db.split('/')[3] : this._table;\n      var data = storeDataObject[type][resource].backup ? storeDataObject[type][resource] : this._filterRemotes(storeDataObject);\n      storage.set(db, 1, data, table).then(function () {\n        return storeDataObject[type][resource];\n      });\n    }\n    /**\r\n     * @description should save and update the current dataObject information\r\n     *\r\n     * @param {Boolean} isReporter - the object to be saved is a reporter\r\n     * @param {DataObjectURL} resource - dataObjectURL to be saved or updated;\r\n     * @param {String} attribute - attribute inside the data which will be saved\r\n     * @param {any} data - value will be saved inside the attribute;\r\n     */\n\n  }, {\n    key: \"update\",\n    value: function update(isReporter, resource, attribute, value, updateRuntimeStatus) {\n      var storeDataObject = this._storeDataObject;\n\n      var type = this._getTypeOfObject(isReporter);\n\n      if (!storeDataObject || !storeDataObject[type] || !storeDataObject[type][resource]) {\n        DataObjectsStorage_log.log('[StoreDataObjects - update] - not saved');\n        return;\n      }\n\n      DataObjectsStorage_log.log('[StoreDataObjects - update] - ', isReporter, type, resource, attribute, value);\n\n      if (storeDataObject[type] && storeDataObject[type][resource] && resource && attribute && value) {\n        if (attribute === 'subscriptions' || attribute === 'subscriberUsers') {\n          var update = true;\n\n          if (attribute === 'subscriptions') {\n            update = !this._isOwner(storeDataObject[type][resource], value);\n          }\n\n          if (update) this._updateToArray(storeDataObject[type], resource, attribute, value);\n        } else {\n          storeDataObject[type][resource][attribute] = value;\n        }\n\n        this._storeDataObject = storeDataObject;\n        var db = storeDataObject[type][resource].backup ? storeDataObject[type][resource].url : 'syncherManager:ObjectURLs';\n        var storage = storeDataObject[type][resource].backup ? this._remotes[db] : this._storageManager;\n        var table = storeDataObject[type][resource].backup ? db.split('/')[3] : this._table;\n        var data = storeDataObject[type][resource].backup ? storeDataObject[type][resource] : this._filterRemotes(storeDataObject);\n        storage.set(db, 1, data, table, updateRuntimeStatus).then(function () {\n          return storeDataObject[type][resource];\n        });\n      }\n    }\n    /**\r\n     * @description should delete stored information from the dataObject\r\n     *\r\n     * @param {Boolean} isReporter - the object to be saved is a reporter\r\n     * @param {DataObjectURL} resource - dataObjectURL to be saved or updated;\r\n     * @param {String} attribute - attribute inside the data which will be saved\r\n     * @param {any} data - value will be saved inside the attribute;\r\n     */\n\n  }, {\n    key: \"delete\",\n    value: function _delete(isReporter, resource, attribute, value) {\n      var storeDataObject = this._storeDataObject;\n\n      var type = this._getTypeOfObject(isReporter);\n\n      if (!storeDataObject || !storeDataObject[type] || !storeDataObject[type][resource]) {\n        DataObjectsStorage_log.log('[StoreDataObjects - delete] - not saved');\n        return;\n      }\n\n      if (storeDataObject[type] && storeDataObject[type][resource] && resource && attribute && value) {\n        if (attribute === 'subscriptions' || attribute === 'subscriberUsers') {\n          this._removeFromArray(storeDataObject[type], resource, attribute, value);\n        } else {\n          delete storeDataObject[type][resource][attribute];\n        }\n\n        this._storeDataObject = storeDataObject;\n        var db = storeDataObject[type][resource].backup ? storeDataObject[type][resource].url : 'syncherManager:ObjectURLs';\n        var storage = storeDataObject[type][resource].backup ? this._remotes[db] : this._storageManager;\n        var table = storeDataObject[type][resource].backup ? db.split('/')[3] : this._table;\n        var data = storeDataObject[type][resource].backup ? storeDataObject[type][resource] : this._filterRemotes(storeDataObject);\n        storage.set(db, 1, data, table);\n        return storeDataObject[type][resource];\n      }\n    }\n    /**\r\n     * Delete Data Object from the storage\r\n     */\n\n  }, {\n    key: \"deleteResource\",\n    value: function deleteResource(resource) {\n      var _this4 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (resource) {\n          //        return this.getAll().then((storedDataObjects) => {\n          DataObjectsStorage_log.info('[DataObjectStorage.deleteResource] deleting: ', resource); //          let this._storeDataObject = Object.assign(this._storeDataObject || {});\n\n          var backup;\n          var db;\n          var storage;\n\n          if (_this._storeDataObject.hasOwnProperty('observers') && _this._storeDataObject.observers.hasOwnProperty(resource)) {\n            backup = _this._storeDataObject.observers[resource].backup ? true : false;\n            db = backup ? _this._storeDataObject.observers[resource].url : 'syncherManager:ObjectURLs';\n            storage = backup ? _this._remotes[db] : _this._storageManager;\n            delete _this._storeDataObject.observers[resource];\n          }\n\n          if (_this._storeDataObject.hasOwnProperty('reporters') && _this._storeDataObject.reporters.hasOwnProperty(resource)) {\n            backup = _this._storeDataObject.reporters[resource].backup ? true : false;\n            db = backup ? _this._storeDataObject.reporters[resource].url : 'syncherManager:ObjectURLs';\n            storage = backup ? _this._remotes[db] : _this._storageManager;\n            delete _this._storeDataObject.reporters[resource];\n          } //          this._storeDataObject = this._storeDataObject;\n\n\n          if (backup && storage) {\n            storage.delete().then(function () {\n              delete _this._remotes[db];\n\n              _this._storageManager.delete(resource, null, 'remotes');\n            });\n          } else {\n            storage.set(db, 1, _this4._filterRemotes(_this._storeDataObject));\n          }\n\n          return resolve(); //        });\n        } else {\n          reject(new Error('[StoreDataObjects] - Can\\'t delete this ' + resource));\n        }\n      });\n    }\n  }, {\n    key: \"getAll\",\n    value: function getAll() {\n      var _this5 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this._storeDataObject = _this5._storageManager.get('syncherManager:ObjectURLs').then(function (objects) {\n          _this._storeDataObject = objects;\n\n          _this.loadRemote(true).then(function (storedObjects) {\n            resolve(_this._storeDataObject);\n          });\n        });\n      }); //    return this._storageManager.get('syncherManager:ObjectURLs');\n    } // To sync local storage with remote storage server\n\n  }, {\n    key: \"sync\",\n    value: function sync(resource, backupRevision) {\n      var once = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n      var _this = this;\n\n      if (_this._remotes[resource]) {\n        var table = resource.split('/')[3];\n        if (backupRevision) return _this._sync(resource, backupRevision, once, table);else _this._remotes[resource].getBackupRevision(resource).then(function (backupRevision) {\n          return _this._sync(resource, backupRevision, once, table);\n        });\n      } else {\n        var info = '[DataObjectStorage.sync] Info: ' + resource + ' is not synched with remote storage.';\n        DataObjectsStorage_log.info(info); //          reject(info);\n      }\n    }\n  }, {\n    key: \"_sync\",\n    value: function _sync(resource, backupRevision, once, table) {\n      var _this = this;\n\n      console.log('[DataObjectStorage._sync] backupRevision: ', backupRevision);\n      return new Promise(function (resolve, reject) {\n        var options = {\n          table: table,\n          observer: false,\n          syncedRevision: backupRevision + 3\n        };\n\n        _this._remotes[resource].connect(options).then(function () {\n          DataObjectsStorage_log.info('[DataObjectStorage.sync] connected with remote ');\n\n          _this._remotes[resource].get(null, null, table).then(function (dataObject) {\n            //          this._remotes[resource].get().then((dataObject)=>{\n            DataObjectsStorage_log.info('[DataObjectStorage.sync] returning synched DO: ', dataObject);\n\n            if (once) {\n              setTimeout(function () {\n                _this._remotes[resource].disconnect().then(function () {\n                  DataObjectsStorage_log.info('[DataObjectStorage.sync] disconnected '); //                      resolve(dataObject[resource]);\n                }, function (error) {\n                  DataObjectsStorage_log.error('[DataObjectStorage.sync] Error synching with remote storage');\n                  reject(error);\n                });\n              }, 2000);\n            }\n\n            resolve(dataObject[resource]);\n          }, function (error) {\n            DataObjectsStorage_log.error('[DataObjectStorage.sync] Error retrieving stored data object');\n            reject(error);\n          });\n        }, function (error) {\n          DataObjectsStorage_log.error('[DataObjectStorage.sync] Error connecting to remote storage ', error);\n\n          _this._remotes[resource].get(null, null, table).then(function (dataObject) {\n            DataObjectsStorage_log.info('[DataObjectStorage.sync] returning synched DO: ', dataObject);\n            resolve(dataObject[resource]);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"stopSync\",\n    value: function stopSync(resource) {\n      if (this._remotes[resource]) this._remotes[resource].disconnect();\n    }\n    /**\r\n    * @description should look for a specific dataObjectURL\r\n    *\r\n    * @param {DataObjectURL} resource - the dataObjectURL will be searched\r\n    *\r\n    * @returns Promise<Object> object with the dataObject information;\r\n    */\n\n  }, {\n    key: \"getDataObject\",\n    value: function getDataObject(resource) {\n      var _this6 = this;\n\n      return new Promise(function (resolve, reject) {\n        /*      this._remotes[resource].get().then((dataObject)=> {\r\n                return resolve(dataObject);\r\n              } , () => {\r\n                this._storageManager.get('syncherManager:ObjectURLs').then((storedDataObject) => {*/\n        var storedDataObject = _this6._storeDataObject;\n        var observers = storedDataObject.hasOwnProperty('observers') ? storedDataObject.observers : {};\n        var reporters = storedDataObject.hasOwnProperty('reporters') ? storedDataObject.reporters : {};\n        var currentReporter = Object.keys(reporters).find(function (value) {\n          return value === resource;\n        });\n        var currentObserver = Object.keys(observers).find(function (value) {\n          return value === resource;\n        });\n        var dataObject;\n\n        if (currentObserver) {\n          dataObject = storedDataObject.observers[currentObserver];\n        }\n\n        if (currentReporter) {\n          dataObject = storedDataObject.reporters[currentReporter];\n        }\n\n        DataObjectsStorage_log.info('[StoreDataObjects - getDataObject] - for observer: ', currentObserver);\n        DataObjectsStorage_log.info('[StoreDataObjects - getDataObject] - for reporters: ', currentReporter);\n        DataObjectsStorage_log.info('[StoreDataObjects - getDataObject] - resolve: ', dataObject);\n        return dataObject ? resolve(dataObject) : reject('No dataObject was found'); //        });\n        //      });\n      });\n    }\n    /**\r\n     * @description should get the dataObject information by the message\r\n     *\r\n     * @param {Object} msg - message would be analised to get the current dataObject information\r\n     * @param {Boolean} isReporter - the object to be saved is a reporter\r\n     *\r\n     * @returns Promise<object> should retun an object with the dataObject or null\r\n     */\n\n  }, {\n    key: \"getResourcesByCriteria\",\n    value: function getResourcesByCriteria(msg, isReporter) {\n      var _this7 = this;\n\n      return new Promise(function (resolve) {\n        var type = _this7._getTypeOfObject(isReporter); //      this.getAll(isReporter).then((storedDataObjects) => {\n\n\n        var storedDataObjects = _this7._storeDataObject;\n\n        if (!storedDataObjects) {\n          DataObjectsStorage_log.log('[DataObjectsStorage.getResourcesByCriteria] don\\'t have stored data objects');\n          return resolve(null);\n        }\n\n        if (msg.body && msg.body.hasOwnProperty('resume') && !msg.body.resume) {\n          return resolve(null);\n        } // check if the message have other criteria\n        // if not search for on the 'from' of the message.\n\n\n        var result = [];\n\n        var hasSubscription = _this7._hasSubscription(storedDataObjects[type], msg.from);\n\n        var isOwner = _this7._searchOwner(storedDataObjects[type], msg.from);\n\n        var isToProtoStubResume = _this7._checkProtostubResume(storedDataObjects, msg);\n\n        DataObjectsStorage_log.log('[StoredDataObjects - getResourcesByCriteria]:', storedDataObjects, msg, hasSubscription, isOwner);\n\n        if (msg.hasOwnProperty('from') && hasSubscription || isOwner || isToProtoStubResume) {\n          var resource;\n\n          if (isOwner) {\n            resource = _this7._getResourcesByOwner(storedDataObjects[type], msg.from);\n          } else {\n            resource = _this7._getResourcesBySubscription(storedDataObjects[type], msg.from);\n          }\n\n          var identityFoundData = [];\n          if (msg.body && msg.body.identity) identityFoundData = _this7._getResourcesByIdentity(storedDataObjects[type], msg.body.identity); //TODO: remove schema since metadata already includes the schema?\n\n          var schemaFoundData = [];\n          if (msg.body && msg.body.schema) schemaFoundData = _this7._getResourcesBySchema(storedDataObjects[type], msg.body.schema);\n          var metadataFound = [];\n\n          if (msg.body && msg.body.value) {\n            var metadata = msg.body.value;\n            delete metadata.data;\n            metadataFound = _this7._getResourcesByMetadata(storedDataObjects[type], metadata);\n          }\n\n          var dataFound = [];\n          if (msg.body && msg.body.value && msg.body.value.data) dataFound = _this7._getResourcesByData(storedDataObjects[type], msg.body.value.data); // you can pass as arrays as you want.. it will be merged in on place\n          // removed duplicates;\n\n          result = _this7._intersection(resource, identityFoundData, schemaFoundData, dataFound, metadataFound);\n\n          if (result.length == 0 && isToProtoStubResume && type == 'observers' && msg.from.split('protostub').length > 0) {\n            var storedObservers = storedDataObjects[type];\n            var fromDomain = divideURL(msg.from).domain;\n            Object.keys(storedObservers).filter(function (objectURL) {\n              var subscriptions = storedObservers[objectURL].subscriptions;\n              var hasSubscription = false;\n              subscriptions.forEach(function (subscription) {\n                var subscriptionDomain = divideURL(subscription).domain;\n\n                if (subscriptionDomain == fromDomain) {\n                  result.push(objectURL);\n                }\n              });\n            });\n          }\n        } else {\n          return resolve(null);\n        }\n\n        var init = {};\n        result.forEach(function (key) {\n          var currentIsReporter = storedDataObjects[type][key];\n          init[key] = currentIsReporter;\n          return init;\n        });\n        DataObjectsStorage_log.log('[Store Data Objects] - ', init);\n        resolve(init);\n      }); //    });\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_getResourcesByIdentity\",\n    value: function _getResourcesByIdentity(storedData, userURL) {\n      if (!storedData) return [];\n      return Object.keys(storedData).filter(function (objectURL) {\n        return storedData[objectURL].subscriberUsers.filter(function (current) {\n          return current === userURL;\n        }).length;\n      });\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_getResourcesByOwner\",\n    value: function _getResourcesByOwner(storedData, owner) {\n      if (!storedData) return [];\n      return Object.keys(storedData).filter(function (objectURL) {\n        return storedData[objectURL].reporter === owner;\n      });\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_getResourcesBySubscription\",\n    value: function _getResourcesBySubscription(storedData, subscription) {\n      if (!storedData) return [];\n      return Object.keys(storedData).filter(function (objectURL) {\n        return storedData[objectURL].subscriptions.filter(function (current) {\n          return current === subscription;\n        }).length;\n      });\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_getResourcesBySchema\",\n    value: function _getResourcesBySchema(storedData, schema) {\n      return Object.keys(storedData).filter(function (objectURL) {\n        var currentObject = storedData[objectURL];\n        return Object.keys(currentObject).filter(function (key) {\n          return key === 'schema' && currentObject[key] === schema;\n        }).length;\n      });\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_getResourcesByMetadata\",\n    value: function _getResourcesByMetadata(storedData, metadata) {\n      if (!metadata) return [];\n      return Object.keys(storedData).filter(function (objectURL) {\n        var currentObject = storedData[objectURL];\n        return Object.keys(currentObject).filter(function (key) {\n          // search on storeDataObjects for specific key provided from data;\n          return Object.keys(metadata).filter(function (searchFor) {\n            return key === searchFor && currentObject[key] === metadata[searchFor];\n          }).length;\n        }).length;\n      });\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_getResourcesByData\",\n    value: function _getResourcesByData(storedData, data) {\n      if (!data) return [];\n      return Object.keys(storedData).filter(function (objectURL) {\n        var currentObject = storedData[objectURL].hasOwnProperty('data') ? storedData[objectURL].data : {};\n        return Object.keys(currentObject).filter(function (key) {\n          // search on storeDataObjects for specific key provided from data;\n          return Object.keys(data).filter(function (searchFor) {\n            return key === searchFor && currentObject[key] === data[searchFor];\n          }).length;\n        }).length;\n      });\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_hasSubscription\",\n    value: function _hasSubscription(storedData, subscription) {\n      if (!storedData) return false;\n      return Object.keys(storedData).filter(function (objectURL) {\n        return storedData[objectURL].subscriptions.filter(function (current) {\n          return current === subscription;\n        }).length;\n      }).length > 0 ? true : false;\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_searchOwner\",\n    value: function _searchOwner(storedData, from) {\n      if (!storedData) return false;\n      return Object.keys(storedData).filter(function (objectURL) {\n        return storedData[objectURL].reporter === from;\n      }).length > 0 ? true : false;\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_checkProtostubResume\",\n    value: function _checkProtostubResume(storedDataObjects, msg) {\n      if (!storedDataObjects) return false;\n\n      if (msg.hasOwnProperty('body') && msg.body.hasOwnProperty('value') && msg.body.value.hasOwnProperty('reporter')) {\n        var reporter = msg.body.value.reporter;\n\n        if (storedDataObjects.hasOwnProperty('reporters')) {\n          var reportersStored = storedDataObjects.reporters;\n          return Object.keys(reportersStored).filter(function (objectURL) {\n            return reportersStored[objectURL].reporter === reporter;\n          }).length > 0 ? true : false;\n        } else {\n          return false;\n        }\n      } else if (storedDataObjects.hasOwnProperty('observers')) {\n        var storedObservers = storedDataObjects.observers;\n        var fromDomain = divideURL(msg.from).domain;\n        return Object.keys(storedObservers).filter(function (objectURL) {\n          var subscriptions = storedObservers[objectURL].subscriptions;\n          var hasSubscription = false;\n          subscriptions.forEach(function (subscription) {\n            var subscriptionDomain = divideURL(subscription).domain;\n\n            if (subscriptionDomain == fromDomain) {\n              hasSubscription = true;\n            }\n          });\n\n          if (hasSubscription) {\n            return true;\n          }\n        }).length > 0 ? true : false;\n      }\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_isOwner\",\n    value: function _isOwner(value, url) {\n      if (!value) return false;\n      return value.reporter === url ? true : false;\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_intersection\",\n    value: function _intersection() {\n      var args = Array.from(arguments);\n      var result = args.reduce(function (first, second) {\n        return first.concat(second);\n      }).filter(function (value, index, self) {\n        return self.indexOf(value) === index;\n      });\n      DataObjectsStorage_log.log('DataObjectsStorage._intersection] Result an unique array of strings: ', result);\n      return result;\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_updateToArray\",\n    value: function _updateToArray(storeDataObject, resource, key, value) {\n      DataObjectsStorage_log.log('[DataObjectsStorage] - _updateToArray: ', storeDataObject, resource, key, value);\n      if (storeDataObject[resource][key].indexOf(value) === -1) storeDataObject[resource][key].push(value);\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_removeFromArray\",\n    value: function _removeFromArray(storeDataObject, resource, key, value) {\n      var indexOfValue = storeDataObject[resource][key].indexOf(value);\n      if (indexOfValue === -1) storeDataObject[resource][key].splice(indexOfValue, 1);\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_hasValue\",\n    value: function _hasValue(obj, key, value) {\n      return obj.hasOwnProperty(key) && obj[key] === value;\n    }\n    /**\r\n     * @private\r\n     * @todo documentation\r\n     */\n\n  }, {\n    key: \"_getTypeOfObject\",\n    value: function _getTypeOfObject(isReporter) {\n      return isReporter ? 'reporters' : 'observers';\n    }\n  }]);\n\n  return DataObjectsStorage;\n}();\n\n/* harmony default export */ var store_objects_DataObjectsStorage = (DataObjectsStorage_DataObjectsStorage);\n// CONCATENATED MODULE: ./src/utils/PromiseQueue.js\nfunction PromiseQueue_toConsumableArray(arr) { return PromiseQueue_arrayWithoutHoles(arr) || PromiseQueue_iterableToArray(arr) || PromiseQueue_nonIterableSpread(); }\n\nfunction PromiseQueue_nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction PromiseQueue_iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction PromiseQueue_arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction PromiseQueue_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction PromiseQueue_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction PromiseQueue_createClass(Constructor, protoProps, staticProps) { if (protoProps) PromiseQueue_defineProperties(Constructor.prototype, protoProps); if (staticProps) PromiseQueue_defineProperties(Constructor, staticProps); return Constructor; }\n\nvar PromiseQueue =\n/*#__PURE__*/\nfunction () {\n  // TODO: Improve this Queuing\n  function PromiseQueue(concurrency) {\n    PromiseQueue_classCallCheck(this, PromiseQueue);\n\n    this.flushing = false;\n    this.Promise = Promise;\n    this.concurrency = typeof concurrency !== 'number' ? 1 : concurrency;\n    this.promises = [];\n    this.queue = [];\n    this.isProcessing = false;\n  }\n\n  PromiseQueue_createClass(PromiseQueue, [{\n    key: \"done\",\n    value: function done(cb) {\n      this.callback = cb;\n    }\n  }, {\n    key: \"add\",\n    value: function add(promise) {\n      var _this = this;\n\n      this.queue.push(promise);\n\n      if (!this.isProcessing) {\n        return this.queue.reduce(function (promiseChain, currentTask) {\n          return promiseChain.then(function (chainResults) {\n            return currentTask.then(function (currentResult) {\n              return PromiseQueue_toConsumableArray(chainResults).concat([currentResult]);\n            });\n          });\n        }, Promise.resolve([])).then(function (arrayOfResults) {\n          // Do something with all results\n          _this.isProcessing = false;\n        });\n      }\n    }\n  }]);\n\n  return PromiseQueue;\n}();\n\n/* harmony default export */ var utils_PromiseQueue = (PromiseQueue);\n// CONCATENATED MODULE: ./src/hyperty-resource/HypertyResourcesStorage.js\nfunction HypertyResourcesStorage_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction HypertyResourcesStorage_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction HypertyResourcesStorage_createClass(Constructor, protoProps, staticProps) { if (protoProps) HypertyResourcesStorage_defineProperties(Constructor.prototype, protoProps); if (staticProps) HypertyResourcesStorage_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar HypertyResourcesStorage_log = loglevel[\"getLogger\"]('HypertyResourcesStorage');\n\n\n\nvar HypertyResourcesStorage_HypertyResourcesStorage =\n/*#__PURE__*/\nfunction () {\n  function HypertyResourcesStorage(runtimeURL, bus, storageManager, hypertyResources) {\n    HypertyResourcesStorage_classCallCheck(this, HypertyResourcesStorage);\n\n    if (!storageManager) throw new Error('[HypertyResourcesStorage constructor] mandatory storageManager parameter missing');\n    if (!runtimeURL) throw new Error('[HypertyResourcesStorage constructor] mandatory runtimeURL parameter missing');\n    if (!bus) throw new Error('[HypertyResourcesStorage constructor] mandatory bus parameter missing');\n\n    var _this = this;\n\n    _this._bus = bus;\n    _this._storageLimit = 0.9; // the save storageLimit;\n\n    _this._url = runtimeURL + '/storage';\n    _this._storageManager = storageManager;\n    _this.promiseQueue = new utils_PromiseQueue();\n    _this._hypertyResources = hypertyResources;\n    bus.addListener(_this._url, function (msg) {\n      HypertyResourcesStorage_log.info('[HypertyResourcesStorage] Message RCV: ', msg);\n\n      switch (msg.type) {\n        case 'create':\n          _this._onCreate(msg);\n\n          break;\n\n        case 'read':\n          _this._onRead(msg);\n\n          break;\n\n        case 'delete':\n          _this._onDelete(msg);\n\n          break;\n      }\n    });\n  }\n  /**\r\n   * check the available storage quota\r\n   *\r\n   * @memberof HypertyResourcesStorage\r\n   */\n\n\n  HypertyResourcesStorage_createClass(HypertyResourcesStorage, [{\n    key: \"checkStorageQuota\",\n    value: function checkStorageQuota() {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this2._availableQuota && _this2._usage) {\n          return resolve(availableSpace(_this2._usage, _this2._availableQuota));\n        }\n\n        if (navigator) {\n          navigator.storage.estimate().then(function (estimate) {\n            _this2._availableQuota = estimate.quota;\n            _this2._usage = estimate.usage;\n            resolve(availableSpace(_this2._usage, _this2._availableQuota));\n          }).catch(function (reason) {\n            HypertyResourcesStorage_log.error('[HypertyResourcesStorage] CheckStorageQuota error: ', reason);\n            reject(reason);\n          });\n        }\n      });\n    }\n    /**\r\n     * @description should save an HypertyResource contained in the body of a create message request;\r\n     *\r\n     * @param {string} message - message containing the hyperty resource to be stored\r\n     */\n\n  }, {\n    key: \"_onCreate\",\n    value: function _onCreate(message) {\n      var _this = this;\n\n      if (!message.body || !message.body.value) throw new Error('[HypertyResourcesStorage._onCreate] mandatory message body value missing: ', message);\n      var content = message.body.value;\n      var contentURL = content.contentURL;\n      var resourceURL = '';\n\n      if (!contentURL) {\n        contentURL = [];\n        resourceURL = _this._url + '/' + generateGUID();\n      } else {\n        var currentURL = contentURL[0];\n        var resource = currentURL.substr(currentURL.lastIndexOf('/') + 1);\n        resourceURL = _this._url + '/' + resource;\n      }\n\n      if (!_this._hypertyResources.hasOwnProperty(resourceURL)) {\n        contentURL.push(resourceURL);\n        content.contentURL = contentURL;\n      }\n\n      this._hypertyResources[resourceURL] = content;\n      this.promiseQueue.add(this._toSave(resourceURL, message, content));\n    }\n  }, {\n    key: \"_toSave\",\n    value: function _toSave(resourceURL, message, content) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        var error = function error(reason) {\n          var response = {\n            from: message.to,\n            to: message.from,\n            id: message.id,\n            type: 'response',\n            body: {\n              value: resourceURL,\n              code: 500,\n              description: reason\n            }\n          };\n\n          _this3._bus.postMessage(response);\n\n          return reject(reason);\n        };\n\n        _this3.checkStorageQuota().then(function (result) {\n          if (content.size > result.quota) {\n            var msg = 'The storage do not have space to store that resource';\n            error(msg);\n            throw Error(msg);\n          }\n\n          var spaceAvailable = result.quota;\n          var allocated = result.usage + content.size;\n\n          if (result.percent >= _this3._storageLimit || allocated > spaceAvailable) {\n            return _this3._getOlderResources(content.size);\n          } else {\n            return true;\n          }\n        }).then(function () {\n          return _this3._storageManager.set(resourceURL, 1, content);\n        }).then(function () {\n          var response = {\n            from: message.to,\n            to: message.from,\n            id: message.id,\n            type: 'response',\n            body: {\n              value: resourceURL,\n              code: 200\n            }\n          };\n\n          _this3._bus.postMessage(response);\n\n          HypertyResourcesStorage_log.log('Success');\n          return resolve();\n        }).catch(error);\n      });\n    }\n  }, {\n    key: \"_getOlderResources\",\n    value: function _getOlderResources(size) {\n      var _this4 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this4._storageManager.get().then(function (result) {\n          var resources = Object.keys(result);\n          var total = 0;\n          var reduced = resources.sort(function (a, b) {\n            return result[a].created < result[b].created;\n          }).reduce(function (previousResource, currentResource) {\n            var current = _this4._hypertyResources[currentResource];\n            HypertyResourcesStorage_log.log('[HypertyResourcesStorage] _getOlderResources: ', total, size, currentResource, _this4._availableQuota);\n\n            if (total <= size) {\n              total += current.size;\n              previousResource.push(currentResource);\n            }\n\n            return previousResource;\n          }, []);\n          var deleting = reduced.map(function (key) {\n            return _this4._storageManager.delete(key);\n          });\n          Promise.all(deleting).then(function () {\n            resolve(true);\n          }).catch(function (reason) {\n            reject(reason);\n          });\n        });\n      });\n    }\n    /**\r\n     * @description should return an HypertyResource stored in the Storage Manager identified by the content url contained in the body of a read message request;\r\n     *\r\n     * @param {string} message - message containing the hyperty resource to be stored\r\n     */\n\n  }, {\n    key: \"_onRead\",\n    value: function _onRead(message) {\n      var _this = this;\n\n      if (!message.body || !message.body.resource) throw new Error('[HypertyResourcesStorage._onRead] mandatory message body resource missing: ', message);\n      var contentUrl = message.body.resource;\n      var response = {\n        from: message.to,\n        to: message.from,\n        id: message.id,\n        type: 'response',\n        body: {}\n      }; // let content = _this._hypertyResources[contentUrl];\n\n      HypertyResourcesStorage_log.info('[HypertyResourcesStorage._onRead] get resourceURL:', contentUrl);\n\n      this._storageManager.get('resourceURL', contentUrl).then(function (content) {\n        HypertyResourcesStorage_log.info('[HypertyResourcesStorage._onRead] found content:', content);\n\n        if (content) {\n          if (content.resourceType === 'file') {\n            _this._onReadFile(response, content);\n          } else {\n            response.body.code = 200;\n            response.body.p2p = true;\n            response.body.value = content;\n\n            _this._bus.postMessage(response);\n          }\n        } else {\n          response.body.code = 404;\n          response.body.desc = 'Content Not Found for ' + contentUrl;\n\n          _this._bus.postMessage(response);\n        }\n      }); //response.body.code = 404;\n      //_this._hypertyResources[contentUrl] = message.body.value;\n\n    }\n  }, {\n    key: \"_onReadFile\",\n    value: function _onReadFile(response, resource) {\n      var _this = this;\n\n      var reader = new FileReader();\n\n      reader.onload = function (theFile) {\n        HypertyResourcesStorage_log.info('[FileHypertyResource.init] file loaded ', theFile);\n        response.body.code = 200;\n        response.body.p2p = true;\n        response.body.value = deepClone(resource);\n        response.body.value.content = theFile.target.result;\n\n        _this._bus.postMessage(response);\n      };\n\n      if (resource.mimetype.includes('text/')) {\n        reader.readAsText(resource.content);\n      } else {\n        var current = resource.content;\n        var blob;\n\n        if (Array.isArray(current)) {\n          blob = new Blob(current, {\n            type: resource.mimetype\n          });\n        } else {\n          blob = new Blob([current], {\n            type: resource.mimetype\n          });\n        }\n\n        reader.readAsArrayBuffer(blob);\n      }\n    }\n    /**\r\n     * @description should delete an HypertyResource from the storage;\r\n     *\r\n     * @param {string} message - message containing the content URL of the hyperty resource to be deleted\r\n     */\n\n  }, {\n    key: \"_onDelete\",\n    value: function _onDelete(message) {\n      var _this = this;\n\n      if (!message.body) throw new Error('[HypertyResourcesStorage._onDelete] mandatory message body missing: ', message);\n\n      if (message.body.resource) {\n        delete _this._hypertyResources[message.body.resource];\n      } else if (message.body.resources) {\n        message.body.resources.forEach(function (resource) {\n          delete _this._hypertyResources[resource];\n        });\n      } else {\n        throw new Error('[HypertyResourcesStorage._onDelete] mandatory resource missing: ', message);\n      }\n\n      _this._storageManager.delete('resourceURL', message.body.resource).then(function () {\n        var response = {\n          from: message.to,\n          to: message.from,\n          id: message.id,\n          type: 'response',\n          body: {\n            code: 200\n          }\n        };\n\n        _this._bus.postMessage(response);\n      }).catch(function (reason) {\n        var response = {\n          from: message.to,\n          to: message.from,\n          id: message.id,\n          type: 'response',\n          body: {\n            code: 400,\n            description: reason\n          }\n        };\n\n        _this._bus.postMessage(response);\n      });\n    }\n  }]);\n\n  return HypertyResourcesStorage;\n}();\n\n/* harmony default export */ var hyperty_resource_HypertyResourcesStorage = (HypertyResourcesStorage_HypertyResourcesStorage);\n// CONCATENATED MODULE: ./src/syncher/Subscription.js\nfunction Subscription_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Subscription_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Subscription_createClass(Constructor, protoProps, staticProps) { if (protoProps) Subscription_defineProperties(Constructor.prototype, protoProps); if (staticProps) Subscription_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar Subscription_log = loglevel[\"getLogger\"]('SynSubscription');\n\nvar Subscription =\n/*#__PURE__*/\nfunction () {\n  function Subscription(bus, owner, url, isReporter) {\n    Subscription_classCallCheck(this, Subscription);\n\n    var _this = this;\n\n    var childBaseURL = url + '/children/';\n    var changeURL = url + '/changes'; //process delete message\n\n    _this._deleteListener = bus.addListener(changeURL, function (msg) {\n      if (msg.type === 'delete') {\n        Subscription_log.log('Subscription-DELETE: ', msg); //FLOW-OUT: message sent to all subscribers\n\n        var deleteMessageToHyperty = {\n          type: 'delete',\n          from: msg.from,\n          to: owner,\n          body: {\n            identity: msg.body.identity,\n            resource: url\n          }\n        }; //send delete to hyperty\n\n        bus.postMessage(deleteMessageToHyperty, function (reply) {\n          Subscription_log.log('Subscription-DELETE-REPLY: ', reply);\n\n          if (reply.body.code === 200) {\n            _this._releaseListeners();\n          }\n        });\n      }\n    }); //add change publish address or forward\n\n    if (isReporter) {\n      _this._changeListener = bus.addPublish(changeURL);\n    } else {\n      _this._changeListener = bus.addForward(changeURL, owner);\n    }\n\n    _this._childrenListeners = []; //    log.log('[Subscription] - childID', childrens);\n    //    childrens.forEach((child) => {\n    //    let childId = childBaseURL + child;\n    //      log.log('[Subscription] - childID', childBaseURL);\n    //add children publish address\n\n    var childrenForward = bus.addPublish(childBaseURL);\n\n    _this._childrenListeners.push(childrenForward); //add self forward if an observer\n\n\n    if (!isReporter) {\n      var selfForward = bus.addForward(childBaseURL, owner);\n\n      _this._childrenListeners.push(selfForward);\n    } //    });\n\n  }\n\n  Subscription_createClass(Subscription, [{\n    key: \"_releaseListeners\",\n    value: function _releaseListeners() {\n      var _this = this;\n\n      _this._deleteListener.remove();\n\n      _this._changeListener.remove();\n\n      _this._childrenListeners.forEach(function (forward) {\n        forward.remove();\n      });\n    }\n  }]);\n\n  return Subscription;\n}();\n\n/* harmony default export */ var syncher_Subscription = (Subscription);\n// CONCATENATED MODULE: ./src/syncher/ReporterObject.js\nfunction ReporterObject_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ReporterObject_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ReporterObject_createClass(Constructor, protoProps, staticProps) { if (protoProps) ReporterObject_defineProperties(Constructor.prototype, protoProps); if (staticProps) ReporterObject_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar ReporterObject_log = loglevel[\"getLogger\"]('ReporterObject');\n\n\n\n\nvar ReporterObject_ReporterObject =\n/*#__PURE__*/\nfunction () {\n  function ReporterObject(parent, owner, url, childrens, offline) {\n    ReporterObject_classCallCheck(this, ReporterObject);\n\n    var _this = this;\n\n    _this._parent = parent;\n    _this._owner = owner;\n    _this._url = url;\n    _this._bus = parent._bus;\n    _this._domain = divideURL(url).domain;\n    _this._objSubscriptorURL = _this._url + '/subscription';\n    _this._subscriptions = {};\n    _this._childrens = childrens;\n    _this._childrenListeners = [];\n    _this._forwards = {};\n    _this._isToSaveData = false;\n\n    _this._allocateListeners();\n\n    _this._offline = offline ? offline : false;\n  }\n\n  ReporterObject_createClass(ReporterObject, [{\n    key: \"_allocateListeners\",\n    value: function _allocateListeners() {\n      var _this2 = this;\n\n      var _this = this; //add subscription listener...\n\n\n      _this._subscriptionListener = _this._bus.addListener(_this._objSubscriptorURL, function (msg) {\n        ReporterObject_log.info('[SyncherManager.ReporterObject received ]', msg);\n\n        switch (msg.type) {\n          case 'subscribe':\n            _this._onRemoteSubscribe(msg);\n\n            break;\n\n          case 'unsubscribe':\n            _this._onRemoteUnSubscribe(msg);\n\n            break;\n\n          case 'response':\n            _this._onRemoteResponse(msg);\n\n            break;\n\n          case 'forward':\n            _this._onForwardedRemoteSubscribe(msg);\n\n            break;\n        }\n      });\n      var changeURL = _this._url + '/changes';\n      _this._changeListener = _this._bus.addListener(changeURL, function (msg) {\n        ReporterObject_log.info('[SyncherManager.ReporterObject ] SyncherManager-' + changeURL + '-RCV: ', msg); //do not save changes to backupRevision to avoid infinite loops\n\n        if (_this2._isToSaveData && msg.body.attribute) {\n          var updateRuntimeStatus = msg.body.attribute !== 'backupRevision' ? true : false;\n          ReporterObject_log.log('[SyncherManager.ReporterObject ] SyncherManager - save data: ', msg);\n\n          _this._parent._dataObjectsStorage.update(true, _this._url, 'version', msg.body.version, updateRuntimeStatus);\n\n          _this._parent._dataObjectsStorage.update(true, _this._url, 'lastModified', msg.body.lastModified, updateRuntimeStatus);\n\n          _this._parent._dataObjectsStorage.saveData(true, _this._url, msg.body.attribute, msg.body.value, updateRuntimeStatus);\n        }\n      });\n    }\n  }, {\n    key: \"_onForwardedRemoteSubscribe\",\n    // To handle subscriptions sent while the reporter was offline ie forwarded by a Offline Subscription Manager service\n    value: function _onForwardedRemoteSubscribe(msg) {\n      this._onRemoteSubscribe(msg.body);\n    }\n  }, {\n    key: \"_releaseListeners\",\n    value: function _releaseListeners() {\n      var _this = this;\n\n      _this._subscriptionListener.remove();\n\n      _this._changeListener.remove();\n\n      _this._childrenListeners.forEach(function (cl) {\n        cl.remove();\n      });\n\n      Object.keys(_this._forwards).forEach(function (key) {\n        _this.forwardUnSubscribe(key);\n      }); //remove all subscriptions\n\n      Object.keys(_this._subscriptions).forEach(function (key) {\n        _this._subscriptions[key]._releaseListeners();\n      });\n    }\n  }, {\n    key: \"resumeSubscriptions\",\n    value: function resumeSubscriptions(subscriptions) {\n      var _this = this;\n\n      if (!subscriptions) return;\n      Object.keys(subscriptions).forEach(function (key) {\n        var hypertyURL = subscriptions[key];\n        ReporterObject_log.log('[SyncherManager.ReporterObject] - resume subscriptions', _this, hypertyURL, _this._childrens);\n\n        if (!_this._subscriptions[hypertyURL]) {\n          _this._subscriptions[hypertyURL] = new syncher_Subscription(_this._bus, _this._owner, _this._url, true);\n        }\n      });\n    }\n    /**\r\n     * Register a listener in the msg-node and in the local MessageBus, so that messages on this address are forwarded to the reporter object\r\n     * @param  {string} address - URL to register the listeners\r\n     * @return {Promise} Return Promise OK or error\r\n     */\n\n  }, {\n    key: \"forwardSubscribe\",\n    value: function forwardSubscribe(addresses) {\n      var _this = this; //FLOW-OUT: message sent to the msg-node SubscriptionManager component\n\n\n      var nodeSubscribeMsg = {\n        type: 'subscribe',\n        from: _this._parent._url,\n        to: 'domain://msg-node.' + _this._domain + '/sm',\n        body: {\n          resources: addresses,\n          source: _this._owner\n        }\n      };\n      return new Promise(function (resolve, reject) {\n        _this._bus.postMessage(nodeSubscribeMsg, function (reply) {\n          ReporterObject_log.log('[SyncherManager.ReporterObject ]forward-subscribe-response(reporter): ', reply);\n\n          if (reply.body.code === 200) {\n            var newForward = _this._bus.addForward(_this._url, _this._owner);\n\n            _this._forwards[addresses[0]] = newForward;\n            resolve();\n          } else {\n            reject('Error on msg-node subscription: ' + reply.body.desc);\n          }\n        });\n      });\n    }\n    /**\r\n     * UnRegister a listener in the msg-node and in the local MessageBus, so that messages on this address are removed from forward\r\n     * @param  {string} address - URL to un-register the listeners\r\n     */\n\n  }, {\n    key: \"forwardUnSubscribe\",\n    value: function forwardUnSubscribe(address) {\n      var _this = this;\n\n      _this._forwards[address].remove();\n\n      delete _this._forwards[address]; //FLOW-OUT: message sent to the msg-node SubscriptionManager component\n\n      var nodeUnSubscribeMsg = {\n        type: 'unsubscribe',\n        from: _this._parent._url,\n        to: 'domain://msg-node.' + _this._domain + '/sm',\n        body: {\n          resources: [address],\n          source: _this._owner\n        }\n      };\n\n      _this._bus.postMessage(nodeUnSubscribeMsg);\n    }\n    /**\r\n     * Register listeners for a list of childrens. Public channels used to transmit messages.\r\n     * @param  {string[]} childrens - channels to register\r\n     * @return {Promise} Return Promise OK or error\r\n     */\n\n  }, {\n    key: \"addChildrens\",\n    value: function addChildrens() {\n      var _this3 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this._childrens.length === 0) {\n          resolve();\n          return;\n        }\n\n        var childBaseURL = _this._url + '/children/';\n        ReporterObject_log.log('[SyncherManager.ReporterObject - addChildrens] - childrens: ', childBaseURL);\n        /*    childrens.forEach((child) => {\r\n              _this._childrens.push(child);\r\n            });*/\n\n        /*\r\n        _this._childrens.forEach((child) => {\r\n          let childId = childBaseURL + child;\r\n            let selfForward = _this._bus.addForward(childId, owner);\r\n          _this._childrenListeners.push(selfForward);\r\n        });*/\n\n        var subscriptions = []; //      childrens.forEach((child) => subscriptions.push(childBaseURL + child));\n\n        subscriptions.push(childBaseURL); //_this._storageSubscriptions[_this._objSubscriptorURL] = {url: _this._url, owner: _this._owner, childrens: _this._childrens};\n        //FLOW-OUT: message sent to the msg-node SubscriptionManager component\n\n        var nodeSubscribeMsg = {\n          type: 'subscribe',\n          from: _this._parent._url,\n          to: 'domain://msg-node.' + _this._domain + '/sm',\n          body: {\n            resources: subscriptions,\n            source: _this._owner\n          }\n        };\n\n        _this._bus.postMessage(nodeSubscribeMsg, function (reply) {\n          ReporterObject_log.log('[SyncherManager.ReporterObject ]node-subscribe-response(reporter):', reply);\n\n          if (reply.body.code === 200) {\n            //add children listeners on local ...\n            subscriptions.forEach(function (childURL) {\n              var childListener = _this._bus.addListener(childURL, function (msg) {\n                //TODO: what todo here? Save childrens?\n                ReporterObject_log.log('[SyncherManager.ReporterObject received]', msg);\n\n                if (msg.type === 'create' && msg.to.includes('children') && _this3._isToSaveData) {\n                  // if the value is not encrypted lets encrypt it\n                  // todo: should be subject to some policy\n                  var splitedReporterURL = splitObjectURL(msg.to);\n                  var url = splitedReporterURL.url;\n                  if (!msg.body.hasOwnProperty('mutual')) msg.body.mutual = true; //remove false when mutualAuthentication is enabled\n\n                  if (!(typeof msg.body.value === 'string') && msg.body.mutual) {\n                    ReporterObject_log.log('[SyncherManager.ReporterObject] encrypting received data ', msg.body.value);\n                    cryptoManager_CryptoManager.encryptDataObject(msg.body.value, url).then(function (encryptedValue) {\n                      ReporterObject_log.log('[SyncherManager.ReporterObject] encrypted data ', encryptedValue);\n\n                      _this._storeChildObject(msg, JSON.stringify(encryptedValue));\n                    }).catch(function (reason) {\n                      ReporterObject_log.warn('[SyncherManager._decryptChildrens] failed : ', reason, ' Storing unencrypted');\n\n                      _this._storeChildObject(msg, msg.body.value);\n                    });\n                  } else {\n                    _this._storeChildObject(msg, msg.body.value);\n                  }\n                }\n              });\n\n              _this._childrenListeners.push(childListener);\n\n              var selfForward = _this._bus.addForward(childURL, _this._owner);\n\n              _this._childrenListeners.push(selfForward);\n            });\n            resolve();\n          } else {\n            reject('Error on msg-node subscription: ' + reply.body.desc);\n          }\n        });\n      });\n    } // store childObject\n\n  }, {\n    key: \"_storeChildObject\",\n    value: function _storeChildObject(msg, data) {\n      var _this = this;\n\n      var splitedReporterURL = splitObjectURL(msg.to);\n      var url = splitedReporterURL.url;\n      var resource = splitedReporterURL.resource;\n      var value;\n      /*    if (msg.body.identity) {\r\n            value.identity = msg.body.identity;\r\n            delete value.identity.assertion;\r\n            delete value.identity.expires;\r\n          }*/\n\n      var objectURLResource = msg.body.resource;\n      var attribute = resource;\n      if (objectURLResource === 'heartbeat') value = data;else value = {\n        identity: msg.body.identity,\n        value: data\n      }; //    if (objectURLResource) attribute += '.' + objectURLResource;\n\n      if (objectURLResource) attribute = objectURLResource; // this identity data is not needed to be stored\n\n      console.log('[SyncherManager.ReporterObject._storeChildObject] : ', url, attribute, value);\n\n      _this._parent._dataObjectsStorage.saveChildrens(true, url, attribute, value);\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      var _this = this;\n\n      var domain = divideURL(_this._owner).domain; //FLOW-OUT: message sent directly to all subscribers of the reporter\n\n      _this._bus.postMessage({\n        type: 'delete',\n        from: _this._objSubscriptorURL,\n        to: _this._url + '/changes'\n      }); //FLOW-OUT: message sent to the msg-node ObjectAllocationManager component\n\n\n      _this._bus.postMessage({\n        type: 'delete',\n        from: _this._parent._url,\n        to: 'domain://msg-node.' + domain + '/object-address-allocation',\n        body: {\n          resource: _this._url,\n          childrenResources: _this._childrens\n        }\n      });\n\n      _this._releaseListeners();\n\n      delete _this._parent._reporters[_this._url];\n    }\n  }, {\n    key: \"_onRemoteResponse\",\n    value: function _onRemoteResponse(msg) {\n      var _this = this;\n\n      _this._bus.postMessage({\n        id: msg.id,\n        type: 'response',\n        from: msg.to,\n        to: _this._url,\n        body: {\n          code: msg.body.code,\n          identity: msg.body.identity,\n          source: msg.from\n        }\n      });\n    } //FLOW-IN: message received from Syncher -> subscribe\n\n  }, {\n    key: \"_onRemoteSubscribe\",\n    value: function _onRemoteSubscribe(msg) {\n      var _this = this;\n\n      var hypertyURL = msg.body.subscriber; //validate if subscription already exists?\n\n      if (_this._subscriptions[hypertyURL]) {\n        // let errorMsg = {\n        //   id: msg.id, type: 'response', from: msg.to, to: hypertyURL,\n        //   body: { code: 500, desc: 'Subscription for (' + _this._url + ' : ' +  hypertyURL + ') already exists!' }\n        // };\n        //\n        // _this._bus.postMessage(errorMsg);\n        // return;\n        // new version because of reusage\n        _this._subscriptions[hypertyURL]._releaseListeners();\n      } //ask to subscribe to Syncher? (depends on the operation mode)\n      //TODO: get mode from object!\n\n\n      var mode = 'sub/pub';\n\n      if (mode === 'sub/pub') {\n        //FLOW-OUT: message sent to local hyperty address Syncher -> _onForward\n        var forwardMsg = {\n          type: 'forward',\n          from: _this._url,\n          to: _this._owner,\n          body: {\n            type: msg.type,\n            from: hypertyURL,\n            to: _this._url,\n            identity: msg.body.identity\n          }\n        }; //TODO: For Further Study\n\n        if (msg.body.hasOwnProperty('mutual')) forwardMsg.body.mutual = msg.body.mutual;\n\n        _this._bus.postMessage(forwardMsg, function (reply) {\n          ReporterObject_log.log('[SyncherManager.ReporterObject ]forward-reply: ', reply);\n\n          if (reply.body.code === 200) {\n            if (!_this._subscriptions[hypertyURL]) {\n              ReporterObject_log.log('[SyncherManager.ReporterObject] - _onRemoteSubscribe:', _this._childrens);\n              _this._subscriptions[hypertyURL] = new syncher_Subscription(_this._bus, _this._owner, _this._url, true);\n            }\n          } // Store for each reporter hyperty the dataObject\n\n\n          var userURL;\n\n          if (msg.body.identity && msg.body.identity.userProfile.userURL) {\n            userURL = msg.body.identity.userProfile.userURL;\n\n            _this._parent._dataObjectsStorage.update(true, _this._url, 'subscriberUsers', userURL);\n          } //TODO: mutual and sessionkeys updates were removed. FFS\n\n          /*        if (msg.body.hasOwnProperty('mutual')) {\r\n          //          _this._parent._identityModule.updateIsToEncryptForDataObjectSessionKey(_this._url, msg.body.mutual).then(()=>{\r\n              _this._parent._dataObjectsStorage.update(true, _this._url, 'mutual', msg.body.mutual);\r\n          //          });\r\n          }*/\n\n\n          _this._parent._dataObjectsStorage.update(true, _this._url, 'subscriptions', hypertyURL);\n\n          reply.body.owner = _this._owner; //FLOW-OUT: subscription response sent (forward from internal Hyperty)\n\n          _this._bus.postMessage({\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: reply.body\n          });\n        });\n      }\n    } //FLOW-IN: message received from remote ObserverObject -> removeSubscription\n\n  }, {\n    key: \"_onRemoteUnSubscribe\",\n    value: function _onRemoteUnSubscribe(msg) {\n      var _this = this;\n\n      var unsubscriber = msg.body.source;\n      var subscription = _this._subscriptions[unsubscriber];\n\n      if (subscription) {\n        subscription._releaseListeners();\n\n        delete _this._subscriptions[unsubscriber];\n        var forwardMsg = {\n          type: 'forward',\n          from: _this._url,\n          to: _this._owner,\n          body: {\n            type: msg.type,\n            from: unsubscriber,\n            to: _this._url,\n            identity: msg.body.identity\n          }\n        };\n\n        _this._bus.postMessage(forwardMsg);\n      }\n    }\n  }, {\n    key: \"offline\",\n    get: function get() {\n      return this._offline;\n    }\n  }, {\n    key: \"isToSaveData\",\n    set: function set(value) {\n      this._isToSaveData = value;\n    }\n  }]);\n\n  return ReporterObject;\n}();\n\n/* harmony default export */ var syncher_ReporterObject = (ReporterObject_ReporterObject);\n// CONCATENATED MODULE: ./src/syncher/ObserverObject.js\nfunction ObserverObject_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ObserverObject_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ObserverObject_createClass(Constructor, protoProps, staticProps) { if (protoProps) ObserverObject_defineProperties(Constructor.prototype, protoProps); if (staticProps) ObserverObject_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar ObserverObject_log = loglevel[\"getLogger\"]('ObserverObject');\n\n\n\n\nvar ObserverObject_ObserverObject =\n/*#__PURE__*/\nfunction () {\n  function ObserverObject(parent, url, childrens) {\n    var _this2 = this;\n\n    ObserverObject_classCallCheck(this, ObserverObject);\n\n    var _this = this;\n\n    _this._parent = parent;\n    _this._url = url;\n    _this._childrens = childrens;\n    _this._bus = parent._bus;\n    _this._subscriptions = {};\n    _this._storageSubscriptions = {};\n    _this._childrenListeners = [];\n    this._isToSaveData = false;\n    var changeURL = _this._url + '/changes';\n    _this._changeListener = _this._bus.addListener(changeURL, function (msg) {\n      ObserverObject_log.log('[SyncherManager.ObserverObject ] SyncherManager-' + changeURL + '-RCV: ', msg); //TODO: what todo here? Save changes?\n\n      if (_this2._isToSaveData && msg.body.attribute) {\n        ObserverObject_log.log('[SyncherManager.ObserverObject ] SyncherManager - save data: ', msg);\n\n        _this._parent._dataObjectsStorage.update(false, _this._url, 'version', msg.body.version);\n\n        _this._parent._dataObjectsStorage.update(false, _this._url, 'lastModified', msg.body.lastModified);\n\n        _this._parent._dataObjectsStorage.saveData(false, _this._url, msg.body.attribute, msg.body.value);\n      }\n    });\n  }\n\n  ObserverObject_createClass(ObserverObject, [{\n    key: \"_newSubscription\",\n    value: function _newSubscription(hyperty) {\n      var _this = this;\n\n      var subscription = _this._subscriptions[hyperty];\n      ObserverObject_log.log('[Observer Object - new subscription] - ', _this._subscriptions, hyperty, _this._subscriptions.hasOwnProperty(hyperty));\n\n      if (!subscription) {\n        _this._subscriptions[hyperty] = new syncher_Subscription(_this._bus, hyperty, _this._url, false);\n      }\n    }\n  }, {\n    key: \"addSubscription\",\n    value: function addSubscription(hyperty) {\n      var _this = this;\n\n      _this._newSubscription(hyperty);\n    }\n  }, {\n    key: \"addChildrens\",\n    value: function addChildrens() {\n      var _this3 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        if (_this._childrens.length === 0) {\n          resolve();\n          return;\n        }\n\n        var childBaseURL = _this._url + '/children/';\n        ObserverObject_log.log('[SyncherManager.ObserverObject - addChildrens] - childrens: ', childBaseURL); //      childrens.forEach((child) => {\n\n        var childListener = _this._bus.addListener(childBaseURL, function (msg) {\n          //TODO: what todo here? Save childrens?\n          ObserverObject_log.log('[SyncherManager.ObserverObject received]', msg);\n\n          if (msg.type === 'create' && msg.to.includes('children') && _this3._isToSaveData) {\n            var splitedReporterURL = splitObjectURL(msg.to);\n            var url = splitedReporterURL.url;\n            if (!msg.body.hasOwnProperty('mutual')) msg.body.mutual = true; //remove false when mutualAuthentication is enabled\n\n            if (!(typeof msg.body.value === 'string') && msg.body.mutual) {\n              ObserverObject_log.log('[SyncherManager.ObserverObject] encrypting received data ', msg.body.value);\n              cryptoManager_CryptoManager.encryptDataObject(msg.body.value, url).then(function (encryptedValue) {\n                ObserverObject_log.log('[SyncherManager.ObserverObject] encrypted data ', encryptedValue);\n\n                _this._storeChildObject(msg, JSON.stringify(encryptedValue));\n              }).catch(function (reason) {\n                ObserverObject_log.warn('[SyncherManager.ObserverObject._encryptChild] failed, storing unencrypted ', reason);\n\n                _this._storeChildObject(msg, msg.body.value);\n              });\n            } else {\n              _this._storeChildObject(msg, msg.body.value);\n            }\n          }\n\n          ObserverObject_log.log('[SyncherManager.ObserverObject children Listeners]', _this._childrenListeners, childListener);\n\n          if (_this._childrenListeners.indexOf(childListener) === -1) {\n            _this._childrenListeners.push(childListener);\n          }\n        });\n      }); //    });\n    } // store childObject\n\n  }, {\n    key: \"_storeChildObject\",\n    value: function _storeChildObject(msg, data) {\n      var _this = this;\n\n      var splitedReporterURL = splitObjectURL(msg.to);\n      var url = splitedReporterURL.url;\n      var resource = splitedReporterURL.resource;\n      var value = {};\n      /*    let value = {\r\n            identity: msg.body.identity,\r\n            value: data\r\n          };*/\n      // this identity data is not needed to be stored\n\n      /*    delete value.identity.assertion;\r\n          delete value.identity.expires;*/\n\n      var objectURLResource = msg.body.resource;\n      var attribute = resource;\n\n      if (objectURLResource === 'heartbeat') {\n        value = data;\n      } else {\n        value.identity = msg.body.identity;\n        value.value = data;\n      } //    if (objectURLResource) attribute += '.' + objectURLResource;\n\n\n      if (objectURLResource) attribute = objectURLResource;\n      ObserverObject_log.log('[SyncherManager.ObserverObject._storeChildObject] : ', url, attribute, value);\n\n      _this._parent._dataObjectsStorage.saveChildrens(false, url, attribute, value);\n    }\n  }, {\n    key: \"removeSubscription\",\n    value: function removeSubscription(msg) {\n      var _this = this;\n\n      var hyperty = msg.from;\n      var domain = divideURL(hyperty).domain;\n      var objURLSubscription = _this._url + '/subscription';\n      var subscription = _this._subscriptions[hyperty];\n\n      if (subscription) {\n        //FLOW-OUT: message sent to remote ReporterObject -> _onRemoteUnSubscribe\n        _this._bus.postMessage({\n          type: 'unsubscribe',\n          from: _this._parent._url,\n          to: objURLSubscription,\n          body: {\n            source: hyperty,\n            identity: msg.body.identity\n          }\n        }); //TODO: should I wait for response before unsubscribe on msg-node\n        //FLOW-OUT: message sent to msg-node SubscriptionManager component\n\n\n        _this._bus.postMessage({\n          type: 'unsubscribe',\n          from: _this._parent._url,\n          to: 'domain://msg-node.' + domain + '/sm',\n          body: {\n            resource: _this._url,\n            resources: [_this._url + '/children/']\n          }\n        });\n\n        subscription._releaseListeners();\n\n        delete _this._subscriptions[hyperty];\n      }\n    }\n  }, {\n    key: \"isToSaveData\",\n    set: function set(value) {\n      this._isToSaveData = value;\n    }\n  }]);\n\n  return ObserverObject;\n}();\n\n/* harmony default export */ var syncher_ObserverObject = (ObserverObject_ObserverObject);\n// CONCATENATED MODULE: ./src/syncher/SyncherManager.js\nfunction SyncherManager_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction SyncherManager_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction SyncherManager_createClass(Constructor, protoProps, staticProps) { if (protoProps) SyncherManager_defineProperties(Constructor.prototype, protoProps); if (staticProps) SyncherManager_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar SyncherManager_log = loglevel[\"getLogger\"]('SyncherManager');\n //import { schemaValidation } from '../utils/schemaValidation';\n\n\n\n\n\n/**\r\n * @author micaelpedrosa@gmail.com\r\n * Core Syncronization system.\r\n */\n\nvar SyncherManager_SyncherManager =\n/*#__PURE__*/\nfunction () {\n  /* private\r\n  _url: URL\r\n  _bus: MiniBus\r\n  _registry: Registry\r\n  _allocator: AddressAllocation\r\n    _reporters: { ObjectURL: ReporterObject }\r\n  _observers: { ObjectURL: ObserverObject }\r\n  */\n  function SyncherManager(runtimeURL, bus, registry, catalog, storageManager, allocator, storeDataObjects, identityModule) {\n    SyncherManager_classCallCheck(this, SyncherManager);\n\n    if (!runtimeURL) throw new Error('[Syncher Manager] - needs the runtimeURL parameter');\n    if (!bus) throw new Error('[Syncher Manager] - needs the MessageBus instance');\n    if (!registry) throw new Error('[Syncher Manager] - needs the Registry instance');\n    if (!catalog) throw new Error('[Syncher Manager] - needs the RuntimeCatalogue instance');\n    if (!storageManager) throw new Error('[Syncher Manager] - need the storageManager instance');\n\n    var _this = this;\n\n    _this._bus = bus;\n    _this._registry = registry;\n    _this._catalog = catalog;\n    _this._storageManager = storageManager;\n    _this._identityModule = identityModule; //TODO: these should be saved in persistence engine?\n\n    _this.runtimeURL = runtimeURL;\n    _this._url = runtimeURL + '/sm';\n    _this._objectURL = runtimeURL + '/object-allocation';\n    _this._reporters = {};\n    _this._observers = {};\n    _this._dataObjectsStorage = storeDataObjects;\n    console.log('[NOTSAVING] storeDataObjects', storeDataObjects); //TODO: this should not be hardcoded!\n\n    _this._domain = divideURL(runtimeURL).domain;\n\n    if (allocator) {\n      _this._allocator = allocator;\n    } else {\n      _this._allocator = allocation_AddressAllocation.instance;\n    }\n\n    SyncherManager_log.log('[SyncherManager - AddressAllocation] - ', _this._allocator);\n    bus.addListener(_this._url, function (msg) {\n      SyncherManager_log.info('[SyncherManager] RCV: ', msg);\n\n      switch (msg.type) {\n        case 'create':\n          _this._onCreate(msg);\n\n          break;\n\n        case 'delete':\n          _this._onDelete(msg);\n\n          break;\n\n        case 'subscribe':\n          _this._onLocalSubscribe(msg);\n\n          break;\n\n        case 'unsubscribe':\n          _this._onLocalUnSubscribe(msg);\n\n          break;\n\n        case 'read':\n          _this._onRead(msg);\n\n          break;\n\n        case 'execute':\n          _this._onExecute(msg);\n\n          break;\n      }\n    });\n  }\n\n  SyncherManager_createClass(SyncherManager, [{\n    key: \"_onExecute\",\n    //FLOW-IN: message received from Syncher -> read\n    value: function _onExecute(msg) {\n      var _this = this;\n\n      var reply = {\n        type: 'response',\n        from: msg.to,\n        to: msg.from,\n        id: msg.id\n      };\n      SyncherManager_log.info('[SyncherManager.onExecute] new message', msg);\n\n      if (msg.hasOwnProperty('body') && msg.body.hasOwnProperty('method') && msg.body.hasOwnProperty('params')) {\n        switch (msg.body.method) {\n          case 'sync':\n            _this._dataObjectsStorage.sync(msg.body.params[0], msg.body.params[1], false);\n\n            break;\n\n          case 'stopSync':\n            _this._dataObjectsStorage.stopSync(msg.body.params[0]);\n\n            break;\n        }\n\n        reply.body = {\n          code: 200\n        };\n\n        _this._bus.postMessage(reply);\n      } else {\n        reply.body = {\n          code: 400,\n          desc: 'missing body or body method / params mandatory fields'\n        };\n        SyncherManager_log.error('[SyncherManager.onExecute] error. Missing body or body method / params mandatory fields', msg);\n\n        _this._bus.postMessage(reply);\n      }\n    } //FLOW-IN: message received from Syncher -> read\n\n  }, {\n    key: \"_onRead\",\n    value: function _onRead(msg) {\n      var _this = this;\n\n      var reply = {\n        type: 'response',\n        from: msg.to,\n        to: msg.from,\n        id: msg.id\n      };\n      SyncherManager_log.info('[SyncherManager.onRead] new message', msg);\n\n      if (msg.hasOwnProperty('body') && msg.body.hasOwnProperty('resource')) {\n        _this._dataObjectsStorage.sync(msg.body.resource, criteria.backupRevision, true).then(function (dataObject) {\n          reply.body = {\n            code: 200,\n            value: dataObject\n          };\n          SyncherManager_log.info('[SyncherManager.onRead] found object: ', dataObject);\n\n          _this._bus.postMessage(reply);\n        }, function (error) {\n          reply.body = {\n            code: 400,\n            desc: error\n          };\n          SyncherManager_log.error('[SyncherManager.onRead] error: ', error);\n\n          _this._bus.postMessage(reply);\n        });\n      } else {\n        reply.body = {\n          code: 400,\n          desc: 'missing body or body resource mandatory fields'\n        };\n        SyncherManager_log.error('[SyncherManager.onRead] error. Missing body or body resource mandatory fields', msg);\n\n        _this._bus.postMessage(reply);\n      }\n    } //FLOW-IN: message received from Syncher -> create\n\n  }, {\n    key: \"_onCreate\",\n    value: function _onCreate(msg) {\n      var _this2 = this;\n\n      var from = msg.from;\n      var to = msg.to;\n\n      var _this = this; // check if message is to save new childrenObjects in the local storage\n      // TODO: check if message is to store new child in the local storage and call storeChild. How to distinguish from others?\n      //debugger;\n\n\n      if (msg.body.attribute) {\n        this._storeChildrens(msg);\n      } else {\n        if (!msg.body.hasOwnProperty('resume') || msg.body.hasOwnProperty('resume') && !msg.body.resume) {\n          // check if this is an invitation message\n          if (msg.body.authorise) {\n            this._authorise(msg);\n\n            SyncherManager_log.info('[SyncherManager.onCreate - invite observers]', msg);\n          } else {\n            // this is to create a new data object\n            SyncherManager_log.info('[SyncherManager.onCreate - Create New Object]', msg);\n\n            this._newCreate(msg);\n          }\n        } else {\n          // If from the hyperty side, call the resumeReporter we will have resume = true'\n          // so we will create an resumed object and will try to resume the object previously saved;\n          this._dataObjectsStorage.getResourcesByCriteria(msg, true).then(function (result) {\n            SyncherManager_log.info('[SyncherManager - Create Resumed] - ResourcesByCriteria | Message: ', msg, ' result: ', result);\n\n            if (result && Object.keys(result).length > 0) {\n              var listOfReporters = [];\n              Object.keys(result).forEach(function (objURL) {\n                listOfReporters.push(_this._resumeCreate(msg, result[objURL]));\n              });\n              Promise.all(listOfReporters).then(function (resumedReporters) {\n                SyncherManager_log.log('[SyncherManager - Create Resumed]', resumedReporters); // TODO: shoud send the information if some object was failing;\n\n                var successfullyResumed = Object.values(resumedReporters).filter(function (reporter) {\n                  return reporter !== false;\n                });\n                SyncherManager_log.info('[SyncherManager.onCreate] returning resumed objects : ', successfullyResumed); //FLOW-OUT: message response to Syncher -> create resume\n\n                _this2._bus.postMessage({\n                  id: msg.id,\n                  type: 'response',\n                  from: to,\n                  to: from,\n                  body: {\n                    code: 200,\n                    value: deepClone(successfullyResumed)\n                  }\n                });\n                /*successfullyResumed.forEach((reporter) => {\r\n                  if (reporter.backup) {\r\n                    this._dataObjectsStorage.sync(reporter.url);\r\n                  }\r\n                });*/\n\n              });\n            } else {\n              //forward to hyperty:\n              var reply = {};\n              reply.id = msg.id;\n              reply.from = msg.to;\n              reply.to = msg.from;\n              reply.type = 'response';\n              reply.body = {\n                code: 404,\n                desc: 'No data objects reporters to be resumed'\n              };\n\n              _this2._bus.postMessage(reply);\n            }\n          });\n        }\n      }\n    }\n  }, {\n    key: \"_storeChildrens\",\n    value: function _storeChildrens(msg) {\n      var _this = this;\n\n      var resource = msg.body.resource;\n      var attribute = msg.body.attribute;\n\n      if (attribute === 'childrenObjects') {\n        _this._dataObjectsStorage.saveChildrens(false, resource, undefined, msg.body.value);\n      } else {\n        _this._dataObjectsStorage.saveChildrens(true, resource, attribute, msg.body.value);\n      }\n    }\n  }, {\n    key: \"_newCreate\",\n    value: function _newCreate(msg) {\n      var _this3 = this;\n\n      var _this = this;\n\n      var owner = msg.from;\n      var domain = divideURL(msg.from).domain; // if reporter is in a Interworking Protostub the runtime domain backend services will be used\n\n      if (_this._registry.isInterworkingProtoStub(msg.from)) {\n        domain = divideURL(_this.runtimeURL).domain;\n      } //    let domainRegistration = msg.body.value.hasOwnProperty('domain_registration') ? msg.body.value.domain_registration : true;\n\n\n      var domainRouting = msg.body.value.hasOwnProperty('domain_routing') ? msg.body.value.domain_routing : true; // Process invitation message to observers\n\n      /*if (msg.body.authorise) {\r\n        _this._authorise(msg);\r\n        return;\r\n      }*/\n      //get schema from catalogue and parse -> (scheme, children)\n\n      _this._catalog.getDataSchemaDescriptor(msg.body.schema).then(function (descriptor) {\n        var properties = descriptor.sourcePackage.sourceCode.properties;\n        var scheme = properties.scheme ? properties.scheme : 'resource';\n        var childrens = properties.children ? properties.children : []; // Do schema validation\n        // TODO: check if is need to handle with the result of validation\n        //      schemaValidation(scheme, descriptor, msg.body.value);\n\n        var objectInfo = {\n          name: msg.body.value.name,\n          schema: msg.body.value.schema,\n          reporter: msg.body.value.reporter,\n          resources: msg.body.value.resources\n        }; // should resuse data object url if it passed\n\n        var reuseDataObject = msg.body.value.resource;\n        var numOfAddress = 1; //debugger;\n        //request address allocation of a new object from the msg-node\n        //_this._allocator.create(domain, numOfAddress, objectInfo, scheme, reuseDataObject).then((allocated) => {\n\n        _this._allocator.create(domain, numOfAddress, objectInfo, scheme, reuseDataObject).then(function (allocated) {\n          var objectRegistration = deepClone(msg.body.value);\n          objectRegistration.url = allocated.address[0];\n          objectRegistration.authorise = msg.body.authorise;\n          objectRegistration.childrens = childrens; //objectRegistration.expires = 30;//TODO: get it from data object configuration description when present\n\n          delete objectRegistration.data;\n          SyncherManager_log.log('[SyncherManager._newCreate] ALLOCATOR CREATE:', allocated);\n          var subscriptionURL = objectRegistration.url + '/subscription';\n          SyncherManager_log.log('[SyncherManager._newCreate] Subscription URL', subscriptionURL); //To register the dataObject in the runtimeRegistry\n\n          SyncherManager_log.info('[SyncherManager._newCreate] Register Object: ', objectRegistration); //_this._registry.registerDataObject(msg.body.value.name, msg.body.value.schema, objURL, msg.body.value.reporter, msg.body.value.resources, allocated, msg.body.authorise).then((resolve) => {\n\n          _this._registry.registerDataObject(objectRegistration).then(function (registeredObject) {\n            SyncherManager_log.log('[SyncherManager._newCreate] DataObject successfully registered', registeredObject); //all OK -> create reporter and register listeners\n\n            var reporter;\n\n            if (!_this3._reporters[objectRegistration.url]) {\n              var offline = objectRegistration.offline ? objectRegistration.offline : false;\n              reporter = new syncher_ReporterObject(_this, owner, objectRegistration.url, childrens, offline);\n            } else {\n              reporter = _this3._reporters[objectRegistration.url];\n            }\n\n            SyncherManager_log.log('[SyncherManager - new Create] - ', msg); // Store for each reporter hyperty the dataObject\n\n            var userURL; // let interworking = false;\n\n            if (msg.body.hasOwnProperty('identity') && msg.body.identity.userProfile && msg.body.identity.userProfile.userURL) {\n              userURL = msg.body.identity.userProfile.userURL; // if (!userURL.includes('user://')) {\n              //   interworking = true;\n              // }\n            } else {\n              userURL = _this._registry.getHypertyOwner(msg.from); // if (!userURL) {\n              //   interworking = true;\n              // }\n            } // should we use the msg.body.value instead?\n\n\n            var metadata = deepClone(objectRegistration);\n            metadata.subscriberUser = userURL;\n            metadata.isReporter = true; // Store the dataObject information\n            //if (!interworking) {\n\n            if (msg.body.hasOwnProperty('store') && msg.body.store) {\n              reporter.isToSaveData = true;\n              metadata.isToSaveData = true;\n\n              if (msg.body.value.data) {\n                metadata.data = deepClone(msg.body.value.data); //              _this._dataObjectsStorage.saveData(true, objectRegistration.url, null, msg.body.value.data); }\n                //            _this._dataObjectsStorage.update(true, objectRegistration.url, 'isToSaveData', true);\n                //            if (msg.body.value.data) { _this._dataObjectsStorage.saveData(true, objectRegistration.url, null, msg.body.value.data); }\n              }\n            }\n\n            _this._dataObjectsStorage.set(metadata).then(function (storeObject) {\n              if (metadata.offline) {\n                //register new DataObject at Offline Subscription Manager\n                msg.body.identity.guid = _this._identityModule._identities.guid;\n                var forward = {\n                  from: msg.to,\n                  to: metadata.offline + '/register',\n                  type: 'forward',\n                  body: msg\n                };\n                forward.body.body.resource = objectRegistration.url;\n                forward.body.body.value = metadata;\n                SyncherManager_log.log('[SyncherManager.newCreate] registering new object at offline manager ', forward);\n\n                _this._bus.postMessage(forward);\n              } //}\n\n\n              var responseMsg = {\n                id: msg.id,\n                type: 'response',\n                from: msg.to,\n                to: owner,\n                body: {\n                  code: 200,\n                  resource: objectRegistration.url,\n                  childrenResources: childrens\n                }\n              }; // adding listeners to forward to reporter\n\n              if (domainRouting) {\n                reporter.forwardSubscribe([objectRegistration.url, subscriptionURL]).then(function () {\n                  reporter.addChildrens().then(function () {\n                    _this._reporters[objectRegistration.url] = reporter; //FLOW-OUT: message response to Syncher -> create\n\n                    _this._bus.postMessage(responseMsg);\n                  });\n                });\n              } else {\n                reporter.addChildrens().then(function () {\n                  _this._reporters[objectRegistration.url] = reporter; //FLOW-OUT: message response to Syncher -> create\n\n                  _this._bus.postMessage(responseMsg);\n                });\n              }\n            }, function (error) {\n              SyncherManager_log.error(error);\n            });\n          }, function (error) {\n            SyncherManager_log.error(error);\n          });\n        });\n      }).catch(function (reason) {\n        //FLOW-OUT: error message response to Syncher -> create\n        var responseMsg = {\n          id: msg.id,\n          type: 'response',\n          from: msg.to,\n          to: owner,\n          body: {\n            code: 500,\n            desc: reason\n          }\n        };\n\n        _this._bus.postMessage(responseMsg);\n      });\n    }\n  }, {\n    key: \"_resumeCreate\",\n    value: function _resumeCreate(msg, storedObject) {\n      var _this4 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        var owner = msg.from;\n        var schema = storedObject.schema;\n        var resource = storedObject.url;\n        var domainRegistration = storedObject.hasOwnProperty('domain_registration') ? storedObject.domain_registration : true;\n        var initialData = storedObject.data;\n        SyncherManager_log.log('[SyncherManager] - resume create', msg, storedObject); //get schema from catalogue and parse -> (scheme, children)\n\n        _this._catalog.getDataSchemaDescriptor(schema).then(function (descriptor) {\n          var properties = descriptor.sourcePackage.sourceCode.properties;\n          var scheme = properties.scheme ? properties.scheme.constant : 'resource';\n          var childrens = properties.children ? properties.children.constant : [];\n          SyncherManager_log.log('[SyncherManager] - getDataSchemaDescriptor: ', descriptor, childrens); // Do schema validation\n          // TODO: check if is need to handle with the result of validation\n          //        schemaValidation(scheme, descriptor, initialData);\n          //all OK -> create reporter and register listeners\n\n          var reporter;\n          var offline;\n\n          if (!_this4._reporters[resource]) {\n            offline = storedObject.offline ? storedObject.offline : false;\n            reporter = new syncher_ReporterObject(_this, owner, resource, childrens, offline);\n          } else {\n            reporter = _this4._reporters[resource];\n          }\n\n          reporter.isToSaveData = storedObject.isToSaveData;\n\n          if (offline) {\n            //update new DataObject at Offline Subscription Manager\n            var _msg = {\n              from: _this._url,\n              to: offline + '/register',\n              type: 'update',\n              body: {}\n            };\n            SyncherManager_log.log('[SyncherManager._resumeCreate] update object at offline manager ', _msg);\n\n            _this._bus.postMessage(_msg);\n          }\n\n          if (domainRegistration) {\n            reporter.forwardSubscribe([storedObject.url]).then(function () {\n              SyncherManager_log.log('[SyncherManager._resumeCreate] resumingReporterSubscription ', storedObject);\n\n              _this._resumeReporterSubscriptions(msg, storedObject, reporter, childrens, domainRegistration).then(function (resumeObject) {\n                SyncherManager_log.log('[SyncherManager._resumeCreate] resolved resumed object ', resumeObject);\n                resolve(resumeObject);\n              });\n            });\n          } else resolve(_this._resumeReporterSubscriptions(msg, storedObject, reporter, childrens, domainRegistration)); //  resolve();\n\n        }).catch(function (reason) {\n          SyncherManager_log.error('[SyncherManager - resume create] - fail on getDataSchemaDescriptor: ', reason);\n          resolve(false);\n        });\n      });\n    }\n  }, {\n    key: \"_resumeReporterSubscriptions\",\n    value: function _resumeReporterSubscriptions(msg, storedObject, reporter, childrens, domainRegistration) {\n      var _this = this;\n\n      var resource = storedObject.url;\n      var objectRegistration = deepClone(msg.body.value);\n      objectRegistration.url = storedObject.url;\n      objectRegistration.expires = storedObject.expires;\n      objectRegistration.domain_registration = domainRegistration;\n      delete objectRegistration.data;\n      return new Promise(function (resolve) {\n        reporter.addChildrens().then(function () {\n          reporter.resumeSubscriptions(storedObject.subscriptions);\n          _this._reporters[resource] = reporter;\n          SyncherManager_log.info('[SyncherManager - resume create] - resolved resumed: ', storedObject);\n          return _this._decryptChildrens(storedObject, childrens);\n        }).then(function (decryptedObject) {\n          SyncherManager_log.info('[SyncherManager._resumeReporterSubscriptions] Register Object: ', objectRegistration);\n\n          _this._registry.registerDataObject(objectRegistration).then(function (registered) {\n            SyncherManager_log.log('[SyncherManager._resumeReporterSubscriptions] DataObject registration successfully updated', registered);\n            SyncherManager_log.log('[SyncherManager._resumeReporterSubscriptions] resolving object', decryptedObject);\n            resolve(decryptedObject);\n          }); // log.log('result of previous promise');\n\n        }).catch(function (reason) {\n          SyncherManager_log.error('[SyncherManager - resume create] - fail on addChildrens: ', reason);\n          resolve(false);\n        });\n      });\n    } // to decrypt DataChildObjects if they are encrypted\n\n  }, {\n    key: \"_decryptChildrens\",\n    value: function _decryptChildrens(encryptedObject, childrens) {\n      var _this = this;\n\n      var storedObject = deepClone(encryptedObject);\n      return new Promise(function (resolve) {\n        if (!childrens) {\n          resolve(storedObject);\n        } else {\n          var childrensObj = Object.keys(storedObject.childrenObjects);\n\n          if (childrensObj.length === 0) {\n            resolve(storedObject);\n          }\n\n          childrens.forEach(function (children) {\n            //          let childObjects = storedObject.childrenObjects[children];\n            var childObjects = storedObject.childrenObjects;\n            SyncherManager_log.log('[SyncherManager._decryptChildrens] dataObjectChilds to decrypt ', childObjects);\n            var listOfDecryptedObjects = [];\n            Object.keys(childObjects).forEach(function (childId) {\n              var child = childObjects[childId];\n              var owner = childId.split('#')[0];\n\n              if (typeof child.value === 'string') {\n                SyncherManager_log.log('[SyncherManager._decryptChildrens] createdBy ', owner, ' object: ', child.value);\n                var decrypted = cryptoManager_CryptoManager.decryptDataObject(JSON.parse(child.value), storedObject.url);\n                listOfDecryptedObjects.push(decrypted);\n              }\n            });\n            Promise.all(listOfDecryptedObjects).then(function (decryptedObjects) {\n              SyncherManager_log.log('[SyncherManager._decryptChildrens] returning decrypted ', decryptedObjects);\n              decryptedObjects.forEach(function (decryptedObject) {\n                var childId = decryptedObject.value.url;\n                storedObject.childrenObjects[childId].value = decryptedObject.value;\n              });\n              SyncherManager_log.log('[SyncherManager._decryptChildrens] storedObject ', storedObject);\n              resolve(storedObject);\n            }).catch(function (reason) {\n              SyncherManager_log.warn('[SyncherManager._decryptChildrens] failed : ', reason);\n            });\n          });\n        }\n      });\n    } // Process invitations to observers\n\n  }, {\n    key: \"_authorise\",\n    value: function _authorise(msg) {\n      var _this = this;\n\n      if (!msg.body.resource) {\n        throw new Error('[SyncherManager._authorise] invitation request without data object url:', msg);\n      }\n\n      var objSubscriptorURL = msg.body.resource + '/subscription';\n      var p2p = msg.body.p2p ? msg.body.p2p : false;\n      SyncherManager_log.log('[SyncherManager -  authorise] - ', msg);\n\n      if (msg.body.authorise) {\n        msg.body.authorise.forEach(function (hypertyURL) {\n          //FLOW-OUT: send invites to list of remote Syncher -> _onRemoteCreate -> onNotification\n          _this._bus.postMessage({\n            type: 'create',\n            from: objSubscriptorURL,\n            to: hypertyURL,\n            body: {\n              p2p: p2p,\n              identity: msg.body.identity,\n              source: msg.from,\n              value: msg.body.value,\n              schema: msg.body.schema\n            }\n          }, function (reply) {\n            // lets forward the invitation response\n            var response = {\n              from: msg.to,\n              to: msg.from,\n              id: msg.id,\n              type: reply.type,\n              body: reply.body\n            };\n\n            _this._bus.postMessage(response);\n          });\n        });\n      }\n    } //FLOW-IN: message received from DataObjectReporter -> delete\n\n  }, {\n    key: \"_onDelete\",\n    value: function _onDelete(msg) {\n      var _this = this;\n\n      var objURL = msg.body.resource;\n      var object = _this._reporters[objURL];\n\n      if (object) {\n        //TODO: is there any policy verification before delete?\n        if (object.offline) {\n          //register new DataObject at Offline Subscription Manager\n          var forward = {\n            from: msg.to,\n            to: object.offline + '/register',\n            type: 'forward',\n            body: msg\n          };\n          SyncherManager_log.log('[SyncherManager._onDelete] unregistering object from offline manager ', forward);\n\n          _this._bus.postMessage(forward);\n        }\n\n        object.delete();\n\n        this._dataObjectsStorage.deleteResource(objURL).then(function (result) {\n          SyncherManager_log.log('[SyncherManager - onDelete] - deleteResource: ', result);\n\n          _this._registry.unregisterDataObject(objURL); //TODO: unregister object?\n\n\n          _this._bus.postMessage({\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: 200\n            }\n          });\n        });\n      }\n    } //FLOW-IN: message received from local Syncher -> subscribe\n\n  }, {\n    key: \"_onLocalSubscribe\",\n    value: function _onLocalSubscribe(msg) {\n      var _this5 = this;\n\n      //debugger;\n      if (msg.body.hasOwnProperty('resume') && msg.body.resume) {\n        this._dataObjectsStorage.getResourcesByCriteria(msg, false).then(function (result) {\n          SyncherManager_log.info('[SyncherManager.onLocalSubscribe. resume]: ', msg, ' result: ', result);\n\n          if (result && Object.keys(result).length > 0) {\n            var listOfObservers = []; // TODO: should reuse the stored information\n\n            Object.keys(result).forEach(function (objURL) {\n              SyncherManager_log.log('[SyncherManager - resume Subscribe] - reuse current object url: ', result[objURL]);\n              listOfObservers.push(_this5._resumeSubscription(msg, result[objURL]));\n            });\n            Promise.all(listOfObservers).then(function (resumedObservers) {\n              SyncherManager_log.log('[SyncherManager - Observers Resumed]', resumedObservers); // TODO: shoud send the information if some object is failing;\n\n              var successfullyResumed = Object.values(resumedObservers).filter(function (observer) {\n                return observer !== false;\n              });\n              var response = {\n                id: msg.id,\n                type: 'response',\n                from: msg.to,\n                to: msg.from,\n                body: {\n                  code: 200,\n                  value: successfullyResumed\n                }\n              };\n              SyncherManager_log.log('[SyncherManager - Observers Resumed] replying ', response); //FLOW-OUT: message response to Syncher -> create\n\n              _this5._bus.postMessage(response);\n            });\n          } else {\n            //forward to hyperty:\n            var reply = {};\n            reply.id = msg.id;\n            reply.from = msg.to;\n            reply.to = msg.from;\n            reply.type = 'response';\n            reply.body = {\n              code: 404,\n              desc: 'No data objects observers to be resumed'\n            };\n\n            _this5._bus.postMessage(reply);\n          }\n        });\n      } else {\n        SyncherManager_log.log('[SyncherManager.onLocalSubscribe - new Subscribe] - ', msg.body.schema, msg.body.resource);\n\n        this._newSubscription(msg);\n      }\n    }\n  }, {\n    key: \"_newSubscription\",\n    value: function _newSubscription(msg) {\n      var _this = this;\n\n      var objURL = msg.body.resource;\n      var hypertyURL = msg.from;\n      var domain = divideURL(objURL).domain;\n      var domainSubscription = msg.body.hasOwnProperty('domain_subscription') ? msg.body.domain_subscription : true;\n      var childBaseURL = objURL + '/children/'; //get schema from catalogue and parse -> (children)\n\n      _this._catalog.getDataSchemaDescriptor(msg.body.schema).then(function (descriptor) {\n        var properties = descriptor.sourcePackage.sourceCode.properties;\n        var childrens = properties.children ? properties.children.constant : [];\n        var subscriptions = [];\n        subscriptions.push(objURL + '/changes'); //      childrens.forEach((child) => subscriptions.push(childBaseURL + child));\n\n        subscriptions.push(childBaseURL); //children addresses\n\n        if (domainSubscription) {\n          //FLOW-OUT: subscribe message to the msg-node, registering listeners on the broker\n          var nodeSubscribeMsg = {\n            type: 'subscribe',\n            from: _this._url,\n            to: 'domain://msg-node.' + domain + '/sm',\n            body: {\n              identity: msg.body.identity,\n              resources: subscriptions,\n              source: hypertyURL\n            }\n          }; //subscribe in msg-node\n\n          _this._bus.postMessage(nodeSubscribeMsg, function (reply) {\n            SyncherManager_log.log('node-subscribe-response(observer): ', reply);\n            console.log('REUSETEST SyncherManager - node-subscribe-response(observer): ', reply);\n\n            if (reply.body.code === 200) {\n              _this._newReporterSubscribe(msg, hypertyURL, objURL, childrens);\n            } else {\n              //listener rejected\n              _this._bus.postMessage({\n                id: msg.id,\n                type: 'response',\n                from: msg.to,\n                to: hypertyURL,\n                body: reply.body\n              });\n            }\n          });\n        } else _this._newReporterSubscribe(msg, hypertyURL, objURL, childrens);\n      });\n    }\n  }, {\n    key: \"_newReporterSubscribe\",\n    value: function _newReporterSubscribe(msg, hypertyURL, objURL, childrens) {\n      var _this = this;\n\n      var objURLSubscription = objURL + '/subscription'; //FLOW-OUT: reply with provisional response\n\n      _this._bus.postMessage({\n        id: msg.id,\n        type: 'response',\n        from: msg.to,\n        to: hypertyURL,\n        body: {\n          code: 100,\n          childrenResources: childrens,\n          schema: msg.body.schema,\n          resource: msg.body.resource\n        }\n      }); //FLOW-OUT: subscribe message to remote ReporterObject -> _onRemoteSubscribe\n\n\n      var objSubscribeMsg = {\n        type: 'subscribe',\n        from: _this._url,\n        to: objURLSubscription,\n        body: {\n          identity: msg.body.identity,\n          subscriber: hypertyURL\n        }\n      }; //TODO: For Further Study\n\n      if (msg.body.hasOwnProperty('mutual')) objSubscribeMsg.body.mutual = msg.body.mutual;\n      SyncherManager_log.log('[SyncherManager._newSubscription]', objSubscribeMsg, msg);\n      console.log('REUSETEST SyncherManager - [SyncherManager._newSubscription]', objSubscribeMsg, msg); //subscribe to reporter SM\n\n      _this._bus.postMessage(objSubscribeMsg, function (reply) {\n        SyncherManager_log.log('reporter-subscribe-response-new: ', reply);\n        console.log('REUSETEST SyncherManager - reporter-subscribe-response-new: ', reply);\n        if (reply.body.code === 200) _this._processSuccessfullSubscription(reply, hypertyURL, objURL, childrens, msg);else if (msg.body.offline) _this._processOfflineSubscription(objSubscribeMsg, msg.body.offline, hypertyURL, objURL, childrens, msg);else {//TODO: send response back to Hyperty with error message received in the reply\n        }\n      });\n    }\n  }, {\n    key: \"_processOfflineSubscription\",\n    value: function _processOfflineSubscription(subscription, redirectTo, hypertyURL, objURL, childrens, msg) {\n      var _this = this;\n\n      var forward = {\n        from: subscription.from,\n        type: 'forward',\n        to: redirectTo,\n        body: subscription\n      };\n      console.log('[SyncherManager._processOfflineSubscription] forwading ', forward);\n\n      _this._bus.postMessage(forward, function (reply) {\n        SyncherManager_log.log('[SyncherManager._processOfflineSubscription] reply ', reply);\n        if (reply.body.code === 200) _this._processSuccessfullSubscription(reply, hypertyURL, objURL, childrens, msg);else {//TODO: send response back to Hyperty with error message received in the reply\n        }\n      });\n    }\n  }, {\n    key: \"_processSuccessfullSubscription\",\n    value: function _processSuccessfullSubscription(reply, hypertyURL, objURL, childrens, msg) {\n      var _this = this;\n\n      SyncherManager_log.log('[SyncherManager._newSubscription] - observers: ', _this._observers, objURL, _this._observers[objURL]);\n      console.log('REUSETEST SyncherManager - 200 code[SyncherManager._newSubscription] - observers: ', _this._observers, objURL, _this._observers[objURL]);\n      var observer = _this._observers[objURL];\n\n      if (!observer) {\n        observer = new syncher_ObserverObject(_this, objURL, childrens);\n        SyncherManager_log.log('[SyncherManager._newSubscription] - observers: create new ObserverObject: ', observer);\n        _this._observers[objURL] = observer; // register new hyperty subscription\n\n        observer.addSubscription(hypertyURL); // add childrens and listeners to save data if necessary\n\n        observer.addChildrens();\n      }\n\n      var interworking = false; //debugger;\n      // Store for each reporter hyperty the dataObject\n\n      var userURL;\n\n      if (msg.body.hasOwnProperty('identity') && msg.body.identity.userProfile && msg.body.identity.userProfile.userURL) {\n        userURL = msg.body.identity.userProfile.userURL;\n\n        if (!userURL.includes('user://')) {\n          interworking = true;\n        }\n      } else {\n        userURL = _this._registry.getHypertyOwner(msg.from);\n        if (!userURL) interworking = true;\n      }\n\n      var metadata = deepClone(reply.body.value); // let childrenObjects = metadata.childrenObjects || {};\n\n      delete metadata.data;\n      delete metadata.childrenObjects;\n      metadata.childrens = childrens;\n      metadata.subscriberUser = userURL;\n      metadata.isReporter = false;\n      metadata.subscriberHyperty = hypertyURL;\n\n      if (!interworking) {\n        //_this._dataObjectsStorage.set(objURL, false, msg.body.schema, 'on', reply.body.owner, hypertyURL, childrens, userURL);\n        _this._dataObjectsStorage.set(metadata);\n\n        if (metadata.hasOwnProperty('store') && metadata.store || metadata.hasOwnProperty('isToSaveData') && metadata.isToSaveData) {\n          observer.isToSaveData = true;\n\n          _this._dataObjectsStorage.update(false, objURL, 'isToSaveData', true);\n\n          _this._dataObjectsStorage.saveData(false, objURL, null, reply.body.value.data); //                  if (childrens) _this._dataObjectsStorage.initialObserverSync(objURL, reply.body.value.data.backupRevision);\n\n        }\n      } //forward to hyperty:\n\n\n      reply.id = msg.id;\n      reply.from = _this._url;\n      reply.to = hypertyURL;\n      reply.body.schema = msg.body.schema;\n      reply.body.resource = msg.body.resource; //TODO: For Further Study\n\n      if (msg.body.hasOwnProperty('mutual')) reply.body.mutual = msg.body.mutual;\n      SyncherManager_log.log('[subscribe] - new subscription: ', msg, reply, observer);\n\n      this._bus.postMessage(reply);\n    }\n  }, {\n    key: \"_resumeSubscription\",\n    value: function _resumeSubscription(msg, storedObject) {\n      var _this6 = this;\n\n      return new Promise(function (resolve) {\n        var objURL = storedObject.url;\n        var schema = storedObject.schema;\n        var hypertyURL = msg.from; // let objURLSubscription = objURL + '/subscription';\n\n        var childBaseURL = objURL + '/children/';\n        SyncherManager_log.log('[SyncherManager - ReuseSubscription] - objURL: ', objURL, ' - schema:', schema); //get schema from catalogue and parse -> (children)\n        // TODO: remove this since children resources should be available in the DataObjectsStorage\n\n        _this6._catalog.getDataSchemaDescriptor(schema).then(function (descriptor) {\n          var properties = descriptor.sourcePackage.sourceCode.properties;\n          var childrens = properties.children ? properties.children.constant : []; //children addresses\n\n          var subscriptions = [];\n          subscriptions.push(objURL + '/changes'); //        childrens.forEach((child) => subscriptions.push(childBaseURL + child));\n\n          subscriptions.push(childBaseURL); //FLOW-OUT: reply with provisional response\n\n          _this6._bus.postMessage({\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: hypertyURL,\n            body: {\n              code: 100,\n              childrenResources: childrens,\n              schema: schema,\n              resource: objURL\n            }\n          }); //FLOW-OUT: subscribe message to remote ReporterObject -> _onRemoteSubscribe\n\n          /*let objSubscribeMsg = {\r\n            type: 'subscribe', from: this._url, to: objURLSubscription,\r\n            body: { subscriber: hypertyURL, identity: msg.body.identity }\r\n          };\r\n            //subscribe to reporter SM\r\n          this._bus.postMessage(objSubscribeMsg, (reply) => {*/\n\n\n          var observer = _this6._observers[objURL];\n\n          if (!observer) {\n            observer = new syncher_ObserverObject(_this6, objURL, childrens);\n            observer.isToSaveData = storedObject.isToSaveData;\n            _this6._observers[objURL] = observer;\n          } //register new hyperty subscription\n\n\n          observer.addSubscription(hypertyURL);\n          observer.addChildrens(); // Object.assign(storedObject.data, reply.body.value.data);\n          // Object.assign(storedObject.childrens, reply.body.value.childrens);\n          //log.log('[subscribe] - resume subscription: ', msg, reply, storedObject, observer);\n\n          return _this6._decryptChildrens(storedObject, childrens);\n        }).then(function (decryptedObject) {\n          // log.log('result of previous promise');\n          resolve(decryptedObject);\n        }).catch(function (reason) {\n          SyncherManager_log.error('[SyncherManager - resume subscription] - fail on getDataSchemaDescriptor: ', reason);\n          resolve(false);\n        });\n      });\n    } //FLOW-IN: message received from local DataObjectObserver -> unsubscribe\n\n  }, {\n    key: \"_onLocalUnSubscribe\",\n    value: function _onLocalUnSubscribe(msg) {\n      var _this = this;\n\n      var hypertyURL = msg.from;\n      var objURL = msg.body.resource;\n      var observer = _this._observers[objURL];\n\n      if (observer) {\n        //TODO: is there any policy verification before delete?\n        observer.removeSubscription(msg); //TODO: destroy object in the registry?\n\n        _this._bus.postMessage({\n          id: msg.id,\n          type: 'response',\n          from: msg.to,\n          to: msg.from,\n          body: {\n            code: 200\n          }\n        });\n\n        this._dataObjectsStorage.deleteResource(objURL); //TODO: remove Object if no more subscription?\n\n\n        delete _this._observers[objURL];\n      }\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this._url;\n    }\n  }]);\n\n  return SyncherManager;\n}();\n\n/* harmony default export */ var syncher_SyncherManager = (SyncherManager_SyncherManager);\n// CONCATENATED MODULE: ./src/subscriptionManager/Subscription.js\nfunction subscriptionManager_Subscription_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction subscriptionManager_Subscription_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction subscriptionManager_Subscription_createClass(Constructor, protoProps, staticProps) { if (protoProps) subscriptionManager_Subscription_defineProperties(Constructor.prototype, protoProps); if (staticProps) subscriptionManager_Subscription_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar subscriptionManager_Subscription_log = loglevel[\"getLogger\"]('Subscription');\n\nvar Subscription_Subscription =\n/*#__PURE__*/\nfunction () {\n  function Subscription(bus, subscriber, resource) {\n    subscriptionManager_Subscription_classCallCheck(this, Subscription);\n\n    var _this = this;\n\n    _this._subscriber = subscriber;\n    _this.resource = resource;\n    subscriptionManager_Subscription_log.log('[SubscriptionManager.Subscription] new: ', subscriber, resource); //add forward\n\n    _this._listener = bus.addForward(resource, subscriber);\n  }\n\n  subscriptionManager_Subscription_createClass(Subscription, [{\n    key: \"_releaseListeners\",\n    value: function _releaseListeners() {\n      var _this = this;\n\n      _this._listener.remove();\n    }\n  }]);\n\n  return Subscription;\n}();\n\n/* harmony default export */ var subscriptionManager_Subscription = (Subscription_Subscription);\n// CONCATENATED MODULE: ./src/subscriptionManager/SubscriptionManager.js\nfunction SubscriptionManager_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction SubscriptionManager_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction SubscriptionManager_createClass(Constructor, protoProps, staticProps) { if (protoProps) SubscriptionManager_defineProperties(Constructor.prototype, protoProps); if (staticProps) SubscriptionManager_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n// Log System\n\nvar SubscriptionManager_log = loglevel[\"getLogger\"]('SubscriptionManager');\n\n\n/**\r\n * @author paulo-g-chainho@alticelabs.com\r\n * Subscription Manager used to manage routing paths at the runtime.\r\n */\n\nvar SubscriptionManager_SubscriptionManager =\n/*#__PURE__*/\nfunction () {\n  function SubscriptionManager(runtimeURL, bus, storage) {\n    SubscriptionManager_classCallCheck(this, SubscriptionManager);\n\n    if (!runtimeURL) throw new Error('[SubscriptionManager] - needs the runtimeURL parameter');\n    if (!bus) throw new Error('[SubscriptionManager] - needs the MessageBus instance');\n\n    var _this = this;\n\n    _this._bus = bus;\n    _this._storage = storage;\n    _this._subscriptions = {};\n    _this._subscriptionsStorage = {}; //TODO: these should be saved in persistence engine?\n\n    _this.runtimeURL = runtimeURL;\n    _this._url = runtimeURL + '/subscriptions'; //TODO: this should not be hardcoded!\n\n    _this._domain = divideURL(runtimeURL).domain;\n    bus.addListener(_this._url, function (msg) {\n      SubscriptionManager_log.info('[SubscriptionManager] RCV: ', msg);\n\n      switch (msg.type) {\n        case 'subscribe':\n          _this._onSubscribe(msg);\n\n          break;\n\n        case 'unsubscribe':\n          _this._onUnSubscribe(msg);\n\n          break;\n\n        case 'read':\n          _this._onRead(msg);\n\n          break;\n      }\n    });\n  }\n\n  SubscriptionManager_createClass(SubscriptionManager, [{\n    key: \"init\",\n    value: function init() {\n      var _this = this;\n\n      return new Promise(function (resolve) {\n        _this._storage.get('subscriptions').then(function (subscriptions) {\n          SubscriptionManager_log.log('[SubscriptionManager.init] resume subscriptions: ', subscriptions);\n\n          if (subscriptions) {\n            _this._subscriptionsStorage = subscriptions;\n            Object.values(subscriptions).forEach(function (subscription) {\n              _this.createSubscription(subscription.domain, subscription.resources, subscription.subscriber, subscription.identity);\n            });\n          }\n\n          resolve();\n        });\n      });\n    }\n  }, {\n    key: \"_onSubscribe\",\n    //message received to set a routing path\n    value: function _onSubscribe(msg) {\n      var _this = this;\n\n      var resources = msg.body.resources;\n      var subscriber = msg.from;\n      var domain = divideURL(resources[0]).domain; //we are assuming resources are all from the same domain\n\n      var identity = msg.body.identity;\n\n      _this.createSubscription(domain, resources, subscriber, identity).then(function (reply) {\n        //forward to hyperty:\n        reply.id = msg.id;\n        reply.from = _this._url;\n        reply.to = subscriber;\n        reply.body = msg.body;\n        reply.body.code = 200;\n        SubscriptionManager_log.log('[SubscriptionManager] - craeteSubscription: ', msg, reply, subscriber);\n\n        _this._bus.postMessage(reply);\n\n        if (!_this._subscriptionsStorage[subscriber]) {\n          _this._subscriptionsStorage[subscriber] = {\n            domain: domain,\n            resources: resources,\n            subscriber: subscriber,\n            identity: identity\n          };\n        } else {\n          resources.forEach(function (resource) {\n            if (!_this._subscriptionsStorage[subscriber].resources.includes(resource)) {\n              _this._subscriptionsStorage[subscriber].resources.push(resource);\n            }\n          });\n        }\n\n        _this._storage.set('subscriptions', 1, _this._subscriptionsStorage);\n      });\n    }\n  }, {\n    key: \"createSubscription\",\n    value: function createSubscription(domain, resources, subscriber, identity) {\n      var _this = this; //debugger;\n\n\n      return new Promise(function (resolve) {\n        //FLOW-OUT: subscribe message to the msg-node, registering listeners on the broker\n        var nodeSubscribeMsg = {\n          type: 'subscribe',\n          from: _this._url,\n          to: 'domain://msg-node.' + domain + '/sm',\n          body: {\n            identity: identity,\n            resources: resources,\n            source: subscriber\n          }\n        }; //subscribe in msg-node\n\n        _this._bus.postMessage(nodeSubscribeMsg, function (reply) {\n          SubscriptionManager_log.log('[SubscriptionManager] node-subscribe-response: ', reply); //if (reply.body.code === 200) {//TODO: uncomment when  MN replies with correct response body code\n          //TODO: support multiple routes for multiple resources\n\n          var subscription = _this._subscriptions[subscriber];\n          SubscriptionManager_log.log('[SubscriptionManager] - ', _this._subscriptions, resources, _this._subscriptions.hasOwnProperty(subscriber));\n\n          if (!subscription) {\n            _this._subscriptions[subscriber] = {};\n          }\n\n          resources.forEach(function (resource) {\n            _this._subscriptions[subscriber][resource] = new subscriptionManager_Subscription(_this._bus, subscriber, resource);\n          });\n          resolve(reply);\n        });\n      });\n    } // message received to remove routing path\n\n  }, {\n    key: \"_onUnSubscribe\",\n    value: function _onUnSubscribe(msg) {\n      var _this = this;\n\n      var unsubscriber = msg.from;\n      var resource = msg.body.resource;\n\n      if (_this._subscriptions[unsubscriber] && _this._subscriptions[unsubscriber][resource]) {\n        var domain = divideURL(resource).domain;\n        var subscription = _this._subscriptions[unsubscriber][resource]; //FLOW-OUT: message sent to msg-node SubscriptionManager component\n\n        _this._bus.postMessage({\n          type: 'unsubscribe',\n          from: _this._url,\n          to: 'domain://msg-node.' + domain + '/sm',\n          body: {\n            resources: [resource],\n            source: unsubscriber\n          }\n        });\n\n        subscription._releaseListeners();\n\n        delete _this._subscriptions[unsubscriber][resource];\n\n        if (_this._subscriptionsStorage[unsubscriber]) {\n          var i = _this._subscriptionsStorage[unsubscriber].resources.indexOf(resource);\n\n          if (i != -1) {\n            _this._subscriptionsStorage[unsubscriber].resources.splice(i, 1);\n          }\n\n          _this._storage.set('subscriptions', 1, _this._subscriptionsStorage);\n        }\n      }\n\n      _this._bus.postMessage({\n        id: msg.id,\n        type: 'response',\n        from: msg.to,\n        to: msg.from,\n        body: {\n          code: 200\n        }\n      });\n    } //message received to read existing routing paths. At this point limited to read all existing routing paths set for one listener\n\n  }, {\n    key: \"_onRead\",\n    value: function _onRead(msg) {\n      var _this = this;\n\n      var listenerAddress = msg.body.resource;\n      var reply;\n      SubscriptionManager_log.log('[SubscriptionManager] - request to read Subscriptions: ', msg);\n\n      _this._storage.get('subscriptions').then(function (subscriptions) {\n        if (subscriptions && subscriptions[listenerAddress]) {\n          var resources = subscriptions[listenerAddress].resources;\n          reply = {\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: 200,\n              value: resources\n            }\n          };\n        } else {\n          reply = {\n            id: msg.id,\n            type: 'response',\n            from: msg.to,\n            to: msg.from,\n            body: {\n              code: 404,\n              description: 'Not Found'\n            }\n          };\n        }\n\n        _this._bus.postMessage(reply);\n      });\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this._url;\n    }\n  }]);\n\n  return SubscriptionManager;\n}();\n\n/* harmony default export */ var subscriptionManager_SubscriptionManager = (SubscriptionManager_SubscriptionManager);\n// CONCATENATED MODULE: ./src/policy/ReThinkCtx.js\nfunction ReThinkCtx_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ReThinkCtx_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ReThinkCtx_createClass(Constructor, protoProps, staticProps) { if (protoProps) ReThinkCtx_defineProperties(Constructor.prototype, protoProps); if (staticProps) ReThinkCtx_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\nvar ReThinkCtx_ReThinkCtx =\n/*#__PURE__*/\nfunction () {\n  function ReThinkCtx() {\n    ReThinkCtx_classCallCheck(this, ReThinkCtx);\n\n    this.defaultBehaviour = true;\n    this.groups = {};\n  }\n\n  ReThinkCtx_createClass(ReThinkCtx, [{\n    key: \"scheme\",\n    get: function get() {\n      return this._scheme;\n    },\n    set: function set(params) {\n      var from = params.message.from;\n\n      if (isDataObjectURL(from)) {\n        this._scheme = divideURL(from).type;\n      } else {\n        this._scheme = undefined;\n      }\n    }\n  }, {\n    key: \"date\",\n    get: function get() {\n      return this._date;\n    },\n    set: function set(now) {\n      var date = new Date();\n      var day = String(date.getDate());\n\n      if (day.length === 1) {\n        day = '0' + day;\n      }\n\n      var month = String(date.getMonth() + 1);\n\n      if (month.length === 1) {\n        month = '0' + month;\n      }\n\n      this._date = day + '/' + month + '/' + date.getFullYear();\n    }\n  }, {\n    key: \"domain\",\n    get: function get() {\n      return this._domain;\n    },\n    set: function set(params) {\n      if (params.message.body.identity !== undefined) {\n        this._domain = divideEmail(params.message.body.identity.userProfile.username).domain;\n      }\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this._type;\n    },\n    set: function set(params) {\n      var message = params.message;\n\n      if (message.body.value !== undefined) {\n        this._type = message.body.value.resourceType;\n      }\n    }\n  }, {\n    key: \"source\",\n    get: function get() {\n      return this._source;\n    },\n    set: function set(params) {\n      if (params.message.body.identity !== undefined) {\n        this._source = params.message.body.identity.userProfile.username;\n      }\n    }\n  }, {\n    key: \"time\",\n    get: function get() {\n      return this._time;\n    },\n    set: function set(now) {\n      now = new Date();\n      var minutes = String(now.getMinutes());\n\n      if (minutes.length === 1) {\n        minutes = '0' + minutes;\n      }\n\n      this._time = parseInt(String(now.getHours()) + minutes);\n    }\n  }, {\n    key: \"weekday\",\n    get: function get() {\n      return this._weekday;\n    },\n    set: function set(now) {\n      this._weekday = String(new Date().getDay());\n    }\n  }]);\n\n  return ReThinkCtx;\n}();\n\n/* harmony default export */ var policy_ReThinkCtx = (ReThinkCtx_ReThinkCtx);\n// CONCATENATED MODULE: ./src/policy/context/RuntimeCoreCtx.js\nfunction RuntimeCoreCtx_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { RuntimeCoreCtx_typeof = function _typeof(obj) { return typeof obj; }; } else { RuntimeCoreCtx_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return RuntimeCoreCtx_typeof(obj); }\n\nfunction RuntimeCoreCtx_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction RuntimeCoreCtx_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction RuntimeCoreCtx_createClass(Constructor, protoProps, staticProps) { if (protoProps) RuntimeCoreCtx_defineProperties(Constructor.prototype, protoProps); if (staticProps) RuntimeCoreCtx_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction RuntimeCoreCtx_possibleConstructorReturn(self, call) { if (call && (RuntimeCoreCtx_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return RuntimeCoreCtx_assertThisInitialized(self); }\n\nfunction RuntimeCoreCtx_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction RuntimeCoreCtx_getPrototypeOf(o) { RuntimeCoreCtx_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return RuntimeCoreCtx_getPrototypeOf(o); }\n\nfunction RuntimeCoreCtx_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) RuntimeCoreCtx_setPrototypeOf(subClass, superClass); }\n\nfunction RuntimeCoreCtx_setPrototypeOf(o, p) { RuntimeCoreCtx_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return RuntimeCoreCtx_setPrototypeOf(o, p); }\n\n\nvar RuntimeCoreCtx_log = loglevel[\"getLogger\"]('PEP');\n\n\n\n\n\n\nvar RuntimeCoreCtx_RuntimeCoreCtx =\n/*#__PURE__*/\nfunction (_ReThinkCtx) {\n  RuntimeCoreCtx_inherits(RuntimeCoreCtx, _ReThinkCtx);\n\n  function RuntimeCoreCtx(runtimeURL, idModule, runtimeRegistry, storageManager, runtimeCapabilities) {\n    var _this2;\n\n    RuntimeCoreCtx_classCallCheck(this, RuntimeCoreCtx);\n\n    _this2 = RuntimeCoreCtx_possibleConstructorReturn(this, RuntimeCoreCtx_getPrototypeOf(RuntimeCoreCtx).call(this));\n    _this2._runtimeURL = runtimeURL;\n    _this2._pepURL = _this2._runtimeURL + '/pep';\n    _this2._guiURL = _this2._runtimeURL + '/policy-gui';\n    _this2.idModule = idModule;\n    _this2.runtimeRegistry = runtimeRegistry;\n    _this2.activeUserPolicy = undefined;\n    _this2.serviceProviderPolicy = {};\n    _this2.userPolicies = {};\n    _this2.storageManager = storageManager;\n    _this2.runtimeCapabilities = runtimeCapabilities;\n    return _this2;\n  }\n\n  RuntimeCoreCtx_createClass(RuntimeCoreCtx, [{\n    key: \"loadConfigurations\",\n    value: function loadConfigurations() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        console.log(_this.storageManager);\n\n        _this.storageManager.get('rethink:activePolicy').then(function (value) {\n          _this.activeUserPolicy = value;\n          return _this.storageManager.get('rethink:groups');\n        }).then(function (groupInfo) {\n          var groups = groupInfo;\n          _this.groups = groups === undefined ? {} : groups;\n          return _this.storageManager.get('rethink:spPolicies');\n        }).then(function (policiesInfo) {\n          var spPolicies = policiesInfo;\n          _this.serviceProviderPolicy = spPolicies === undefined ? {} : spPolicies;\n\n          _this._loadUserPolicies().then(function () {\n            resolve();\n          });\n        });\n      });\n    }\n  }, {\n    key: \"getPolicies\",\n    value: function getPolicies(message, isIncomingMessage) {\n      var policies = {};\n\n      if (this.activeUserPolicy !== undefined) {\n        policies.userPolicy = this.userPolicies[this.activeUserPolicy];\n      }\n\n      policies.serviceProviderPolicy = this.getServiceProviderPolicy(message, isIncomingMessage);\n      return policies;\n    }\n  }, {\n    key: \"_isValidUpdate\",\n    value: function _isValidUpdate(message) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (message.from.split('://').length > 1) {\n          _this.idModule._getHypertyFromDataObject(message.from).then(function (hypertyURL) {\n            if (hypertyURL === message.body.source) {\n              resolve(message);\n            } else {\n              reject('The source of the message is not valid.');\n            }\n          }, function (error) {\n            reject(error);\n          });\n        } else {\n          resolve(message);\n        }\n      });\n    }\n  }, {\n    key: \"getMyEmails\",\n    value: function getMyEmails() {\n      var identities = this.idModule.getIdentities();\n      var emails = [];\n\n      for (var i in identities) {\n        emails.push(getUserEmailFromURL(identities[i].identity));\n      }\n\n      return emails;\n    }\n  }, {\n    key: \"getMyHyperties\",\n    value: function getMyHyperties() {\n      var hyperties = this.runtimeRegistry.hypertiesList;\n      var hypertiesNames = [];\n\n      for (var i in hyperties) {\n        var hypertyName = hyperties[i].objectName;\n\n        if (hypertiesNames.indexOf(hypertyName) === -1) {\n          hypertiesNames.push(hypertyName);\n        }\n      }\n\n      return hypertiesNames;\n    }\n  }, {\n    key: \"getServiceProviderPolicy\",\n    value: function getServiceProviderPolicy(message, isIncoming) {\n      var policy;\n\n      if (isIncoming) {\n        var toHyperty = this.runtimeRegistry.getHypertyName(message.to);\n        policy = this.serviceProviderPolicy[toHyperty];\n      } else {\n        var fromHyperty = this.runtimeRegistry.getHypertyName(message.from);\n        policy = this.serviceProviderPolicy[fromHyperty];\n      }\n\n      return policy;\n    }\n  }, {\n    key: \"getURL\",\n    value: function getURL(url) {\n      var splitURL = url.split('/');\n      return splitURL[0] + '//' + splitURL[2] + '/' + splitURL[3];\n    }\n    /**\r\n    * Creates a group with the given name.\r\n    * @param  {String}  groupName\r\n    */\n\n  }, {\n    key: \"_loadUserPolicies\",\n    value: function _loadUserPolicies() {\n      var _this3 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.storageManager.get('rethink:userPolicies').then(function (value) {\n          var policies = value;\n\n          if (policies !== undefined) {\n            for (var i in policies) {\n              _this3.pep.addPolicy('USER', i, policies[i]);\n            }\n          }\n\n          resolve();\n        });\n      });\n    }\n  }, {\n    key: \"_getLastComponentOfURL\",\n    value: function _getLastComponentOfURL(url) {\n      var split = url.split('/');\n      return split[split.length - 1];\n    }\n  }, {\n    key: \"_getPoliciesJSON\",\n    value: function _getPoliciesJSON(policies) {\n      for (var i in policies) {\n        var combiningAlgorithm = policies[i].combiningAlgorithm;\n\n        if (combiningAlgorithm instanceof combiningAlgorithms_BlockOverrides) {\n          policies[i].combiningAlgorithm = 'blockOverrides';\n        } else {\n          if (combiningAlgorithm instanceof combiningAlgorithms_AllowOverrides) {\n            policies[i].combiningAlgorithm = 'allowOverrides';\n          } else {\n            if (combiningAlgorithm instanceof combiningAlgorithms_FirstApplicable) {\n              policies[i].combiningAlgorithm = 'firstApplicable';\n            } else {\n              policies[i].combiningAlgorithm = undefined;\n            }\n          }\n        }\n      }\n\n      return policies;\n    }\n  }, {\n    key: \"saveActivePolicy\",\n    value: function saveActivePolicy() {\n      var _this4 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.storageManager.set('rethink:activePolicy', 0, _this4.activeUserPolicy).then(function () {\n          resolve();\n        });\n      });\n    }\n  }, {\n    key: \"saveGroups\",\n    value: function saveGroups() {\n      var _this5 = this;\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        _this.storageManager.set('rethink:groups', 0, _this5.groups).then(function () {\n          resolve();\n        });\n      });\n    }\n  }, {\n    key: \"savePolicies\",\n    value: function savePolicies(source, policy, key) {\n      var policiesJson;\n\n      switch (source) {\n        case 'USER':\n          policiesJson = JSON.stringify(this.userPolicies);\n          policiesJson = this._getPoliciesJSON(JSON.parse(policiesJson));\n          this.storageManager.set('rethink:userPolicies', 0, policiesJson);\n          break;\n\n        case 'SERVICE_PROVIDER':\n          if (policy !== undefined & key !== undefined) {\n            this.serviceProviderPolicy[key] = policy;\n          }\n\n          policiesJson = JSON.stringify(this.serviceProviderPolicy);\n          policiesJson = this._getPoliciesJSON(JSON.parse(policiesJson));\n          this.storageManager.set('rethink:spPolicies', 0, policiesJson);\n          break;\n\n        default:\n          throw Error('Unknown policy source: ' + source);\n      }\n    }\n  }, {\n    key: \"getGroupsNames\",\n    value: function getGroupsNames() {\n      var myGroups = this.groups;\n      var groupsNames = [];\n\n      if (myGroups !== undefined) {\n        for (var groupName in myGroups) {\n          groupsNames.push(groupName);\n        }\n      }\n\n      return groupsNames;\n    }\n  }, {\n    key: \"getGroup\",\n    value: function getGroup(groupName, destination) {\n      var members = [];\n\n      if (groupName === 'preauthorised') {\n        var dataObjectURL = destination.split('/');\n        dataObjectURL.pop();\n        dataObjectURL = dataObjectURL[0] + '//' + dataObjectURL[2];\n        members = this.runtimeRegistry.getPreAuthSubscribers(dataObjectURL);\n      } else {\n        if (this.groups[groupName] !== undefined) {\n          members = this.groups[groupName];\n        }\n      }\n\n      return members;\n    }\n    /**\r\n    * Creates a group with the given name.\r\n    * @param  {String}  groupName\r\n    */\n\n  }, {\n    key: \"createGroup\",\n    value: function createGroup(groupName) {\n      this.groups[groupName] = [];\n      this.saveGroups();\n    }\n  }, {\n    key: \"deleteGroup\",\n    value: function deleteGroup(groupName) {\n      delete this.groups[groupName];\n      this.saveGroups();\n    }\n    /**\r\n    * Adds the given user email to the group with the given name.\r\n    * @param  {String}  userEmail\r\n    * @param  {String}  groupName\r\n    */\n\n  }, {\n    key: \"addToGroup\",\n    value: function addToGroup(groupName, userEmail) {\n      var myGroups = this.groups;\n\n      if (myGroups[groupName] !== undefined) {\n        if (myGroups[groupName].indexOf(userEmail) === -1) {\n          myGroups[groupName].push(userEmail);\n          this.saveGroups();\n        }\n      } else {\n        throw Error('Group \"' + groupName + '\" does not exist!');\n      }\n    }\n  }, {\n    key: \"removeFromGroup\",\n    value: function removeFromGroup(groupName, userEmail) {\n      var group = this.groups[groupName];\n      group.splice(group.indexOf(userEmail), 1);\n      this.saveGroups();\n    }\n  }, {\n    key: \"pepURL\",\n    get: function get() {\n      var _this = this;\n\n      return _this._pepURL;\n    }\n  }, {\n    key: \"guiURL\",\n    get: function get() {\n      var _this = this;\n\n      return _this._guiURL;\n    }\n  }, {\n    key: \"runtimeURL\",\n    get: function get() {\n      var _this = this;\n\n      return _this._runtimeURL;\n    }\n    /**\r\n    * return the messageBus in this Registry\r\n    * @param {MessageBus}           messageBus\r\n    */\n\n  }, {\n    key: \"messageBus\",\n    get: function get() {\n      var _this = this;\n\n      return _this._messageBus;\n    }\n    /**\r\n    * Set the messageBus in this Registry\r\n    * @param {MessageBus}           messageBus\r\n    */\n    ,\n    set: function set(messageBus) {\n      var _this = this;\n\n      _this._messageBus = messageBus;\n    }\n  }, {\n    key: \"subscription\",\n    get: function get() {\n      return this._subscription;\n    },\n    set: function set(params) {\n      this._subscription = params.message.body.subscriber;\n    }\n  }]);\n\n  return RuntimeCoreCtx;\n}(policy_ReThinkCtx);\n\n/* harmony default export */ var context_RuntimeCoreCtx = (RuntimeCoreCtx_RuntimeCoreCtx);\n// EXTERNAL MODULE: ./node_modules/tv4/tv4.js\nvar tv4 = __webpack_require__(83);\nvar tv4_default = /*#__PURE__*/__webpack_require__.n(tv4);\n\n// CONCATENATED MODULE: ./src/runtime-catalogue/RethinkObject.js\nfunction RethinkObject_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction RethinkObject_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction RethinkObject_createClass(Constructor, protoProps, staticProps) { if (protoProps) RethinkObject_defineProperties(Constructor.prototype, protoProps); if (staticProps) RethinkObject_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n * Copyright 2016 PT Inovação e Sistemas SA\r\n * Copyright 2016 INESC-ID\r\n * Copyright 2016 QUOBIS NETWORKS SL\r\n * Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n * Copyright 2016 ORANGE SA\r\n * Copyright 2016 Deutsche Telekom AG\r\n * Copyright 2016 Apizee\r\n * Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n **/\n\nvar RethinkObject_RethinkObject =\n/*#__PURE__*/\nfunction () {\n  function RethinkObject() {\n    RethinkObject_classCallCheck(this, RethinkObject);\n  }\n\n  RethinkObject_createClass(RethinkObject, [{\n    key: \"validate\",\n\n    /**\r\n     * Validates this RethinkObject against the provided schema.\r\n     *\r\n     * LIMITATIONS: The provided schema cannot contain references to other schemas, since they can't be resolved.\r\n     * @param schema - schema to validate against\r\n     * @returns {boolean} true if valid, false otherwise\r\n     */\n    value: function validate(schema) {\n      // add schema itself so local references work\n      tv4_default.a.addSchema(schema.id, schema); // JSON stringify -> parse needed to have proper validation\n\n      var result = tv4_default.a.validateMultiple(JSON.parse(JSON.stringify(this)), schema); // delete error stacks to improve logging\n\n      result.errors.forEach(function (error) {\n        delete error.stack;\n      }); // print more details about validation if it fails or schema contains $refs\n\n      if (!result.valid || result.missing.length > 0) {\n        console.warn(\"Object validation \" + (result.valid ? \"succeeded, but schema contained references:\" : \"failed:\"), JSON.stringify(result, null, 2));\n        console.log(\"Object:\", JSON.stringify(this, null, 2));\n      }\n\n      return result.valid;\n    }\n  }]);\n\n  return RethinkObject;\n}();\n/* harmony default export */ var runtime_catalogue_RethinkObject = (RethinkObject_RethinkObject);\n// CONCATENATED MODULE: ./src/runtime-catalogue/CatalogueDataObject.js\nfunction CatalogueDataObject_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { CatalogueDataObject_typeof = function _typeof(obj) { return typeof obj; }; } else { CatalogueDataObject_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return CatalogueDataObject_typeof(obj); }\n\nfunction CatalogueDataObject_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction CatalogueDataObject_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction CatalogueDataObject_createClass(Constructor, protoProps, staticProps) { if (protoProps) CatalogueDataObject_defineProperties(Constructor.prototype, protoProps); if (staticProps) CatalogueDataObject_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction CatalogueDataObject_possibleConstructorReturn(self, call) { if (call && (CatalogueDataObject_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return CatalogueDataObject_assertThisInitialized(self); }\n\nfunction CatalogueDataObject_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction CatalogueDataObject_getPrototypeOf(o) { CatalogueDataObject_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return CatalogueDataObject_getPrototypeOf(o); }\n\nfunction CatalogueDataObject_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) CatalogueDataObject_setPrototypeOf(subClass, superClass); }\n\nfunction CatalogueDataObject_setPrototypeOf(o, p) { CatalogueDataObject_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return CatalogueDataObject_setPrototypeOf(o, p); }\n\n/**\r\n * Copyright 2016 PT Inovação e Sistemas SA\r\n * Copyright 2016 INESC-ID\r\n * Copyright 2016 QUOBIS NETWORKS SL\r\n * Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n * Copyright 2016 ORANGE SA\r\n * Copyright 2016 Deutsche Telekom AG\r\n * Copyright 2016 Apizee\r\n * Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n **/\n\n/**\r\n * @author alice.cheambe[at]fokus.fraunhofer.de\r\n * The CatalogueDataObject class is the representation of the reTHINK Catalogue Data Model\r\n */\n\nvar CatalogueDataObject =\n/*#__PURE__*/\nfunction (_RethinkObject) {\n  CatalogueDataObject_inherits(CatalogueDataObject, _RethinkObject);\n\n  /**\r\n   * Creates the Catalogue Data Object\r\n   * @param guid - Global Unique identifier of the Catalogue Object (e.g. Hyperty descriptor, ProtocolStub descriptor,\r\n   * etc) enabling the same object to be stored and discovered in different Catalogues. That means, guid corresponds to\r\n   * [resource-type-id] per BNF of Resource Path. Couldn't we have problems with too long URL paths?\r\n   * @param type - indicates the type of Catalogue Data Object e.g. Hyperty, ProtocolStub, etc\r\n   * @param {string} version - Indicates the version of Catalogue Data\r\n   * @param objectName - human-understandable name of the catalogue object e.g. \"My Awesome Hyperty\"\r\n   * @param description - description of the source package\r\n   * @param language - the programming language used in the SourcePackage.SourceCode\r\n   * @param sourcePackageURL - A string containing the URL from where the source code package of the corresponding\r\n   * catalogue object, e.g. deployable packages containing executable code for Hyperties or ProtoStubs, can be downloaded\r\n   */\n  function CatalogueDataObject(guid, type, version, objectName, description, language, sourcePackageURL) {\n    var _this;\n\n    CatalogueDataObject_classCallCheck(this, CatalogueDataObject);\n\n    _this = CatalogueDataObject_possibleConstructorReturn(this, CatalogueDataObject_getPrototypeOf(CatalogueDataObject).call(this));\n    _this._guid = guid;\n    _this._type = type;\n    _this._version = version;\n    _this._objectName = objectName;\n    _this._description = description;\n    _this._language = language;\n    _this._sourcePackageURL = sourcePackageURL;\n    _this._signature = null;\n    _this._sourcePackage = null;\n    return _this;\n  } // Getters\n\n\n  CatalogueDataObject_createClass(CatalogueDataObject, [{\n    key: \"guid\",\n    get: function get() {\n      return this._guid;\n    },\n    set: function set(guid) {\n      if (guid) this._guid = guid;\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this._type;\n    },\n    set: function set(type) {\n      if (type) this._type = type;\n    }\n  }, {\n    key: \"version\",\n    get: function get() {\n      return this._version;\n    },\n    set: function set(version) {\n      if (version) {\n        this._version = version;\n      }\n    }\n  }, {\n    key: \"objectName\",\n    get: function get() {\n      return this._objectName;\n    },\n    set: function set(objectName) {\n      if (objectName) this._objectName = objectName;\n    }\n  }, {\n    key: \"description\",\n    get: function get() {\n      return this._description;\n    },\n    set: function set(description) {\n      if (description) this._description = description;\n    }\n  }, {\n    key: \"language\",\n    get: function get() {\n      return this._language;\n    },\n    set: function set(language) {\n      if (language) this._language = language;\n    }\n  }, {\n    key: \"signature\",\n    get: function get() {\n      return this._signature;\n    },\n    // Setters\n\n    /**\r\n     * Set the signature to enables integrity and authenticity verification\r\n     * @param signature\r\n     */\n    set: function set(signature) {\n      if (signature) this._signature = signature;\n    }\n  }, {\n    key: \"sourcePackage\",\n    get: function get() {\n      return this._sourcePackage;\n    },\n    set: function set(sourcePackage) {\n      if (sourcePackage) this._sourcePackage = sourcePackage;\n    }\n  }, {\n    key: \"sourcePackageURL\",\n    get: function get() {\n      return this._sourcePackageURL;\n    },\n    set: function set(sourcePackageURL) {\n      if (sourcePackageURL) this._sourcePackageURL = sourcePackageURL;\n    }\n  }]);\n\n  return CatalogueDataObject;\n}(runtime_catalogue_RethinkObject); //Alice: removed POLICY_ENFORCER: 'policy_enforcer', DATA_SCHEMA: 'data_schema' from the list\n//wrt: https://github.com/reTHINK-project/dev-service-framework/blob/develop/docs/datamodel/core/hyperty-catalogue/readme.md#data-object-schema\n\n\nvar CatalogueObjectType = {\n  HYPERTY: 'hyperty',\n  PROTOSTUB: 'protostub',\n  HYPERTY_RUNTIME: 'hyperty_runtime',\n  HYPERTY_INTERCEPTOR: 'hyperty_inspector',\n  HYPERTY_DATA_OBJECT: 'hyperty_data_object'\n};\nvar DataObjectSourceLanguage = {\n  JAVASCRIPT_ECMA6: 'javascript_ecma6',\n  JAVASCRIPT_ECMA5: 'javascript_ecma5',\n  JSON_SCHEMA_V4: 'json_schema_v4',\n  PYTHON: 'python',\n  TYPESCRIPT: 'typescript'\n};\n/* harmony default export */ var runtime_catalogue_CatalogueDataObject = (CatalogueDataObject);\n// CONCATENATED MODULE: ./src/runtime-catalogue/SourcePackage.js\nfunction SourcePackage_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction SourcePackage_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction SourcePackage_createClass(Constructor, protoProps, staticProps) { if (protoProps) SourcePackage_defineProperties(Constructor.prototype, protoProps); if (staticProps) SourcePackage_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n * Created by amo on 14/11/2015.\r\n */\nvar SourcePackage =\n/*#__PURE__*/\nfunction () {\n  function SourcePackage(sourceCodeClassname, sourceCode) {\n    SourcePackage_classCallCheck(this, SourcePackage);\n\n    this._sourceCode = sourceCode;\n    this._sourceCodeClassname = sourceCodeClassname;\n    this._encoding = null;\n    this._signature = null;\n  }\n\n  SourcePackage_createClass(SourcePackage, [{\n    key: \"sourceCode\",\n    get: function get() {\n      return this._sourceCode;\n    },\n    set: function set(sourceCode) {\n      if (sourceCode) this._sourceCode = sourceCode;\n    }\n  }, {\n    key: \"sourceCodeClassname\",\n    get: function get() {\n      return this._sourceCodeClassname;\n    },\n    set: function set(sourceCodeClassname) {\n      if (sourceCodeClassname) this._sourceCodeClassname = sourceCodeClassname;\n    }\n  }, {\n    key: \"encoding\",\n    get: function get() {\n      return this._encoding;\n    },\n    set: function set(encoding) {\n      if (encoding) this._encoding = encoding;\n    }\n  }, {\n    key: \"signature\",\n    get: function get() {\n      return this._signature;\n    },\n    set: function set(sign) {\n      if (sign) this._signature = sign;\n    }\n  }]);\n\n  return SourcePackage;\n}();\n\n/* harmony default export */ var runtime_catalogue_SourcePackage = (SourcePackage);\n// CONCATENATED MODULE: ./src/runtime-catalogue/HypertyDescriptor.js\nfunction HypertyDescriptor_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { HypertyDescriptor_typeof = function _typeof(obj) { return typeof obj; }; } else { HypertyDescriptor_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return HypertyDescriptor_typeof(obj); }\n\nfunction HypertyDescriptor_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction HypertyDescriptor_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction HypertyDescriptor_createClass(Constructor, protoProps, staticProps) { if (protoProps) HypertyDescriptor_defineProperties(Constructor.prototype, protoProps); if (staticProps) HypertyDescriptor_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction HypertyDescriptor_possibleConstructorReturn(self, call) { if (call && (HypertyDescriptor_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return HypertyDescriptor_assertThisInitialized(self); }\n\nfunction HypertyDescriptor_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction HypertyDescriptor_getPrototypeOf(o) { HypertyDescriptor_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return HypertyDescriptor_getPrototypeOf(o); }\n\nfunction HypertyDescriptor_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) HypertyDescriptor_setPrototypeOf(subClass, superClass); }\n\nfunction HypertyDescriptor_setPrototypeOf(o, p) { HypertyDescriptor_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return HypertyDescriptor_setPrototypeOf(o, p); }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n * Created by amo on 14/11/2015.\r\n */\n\n\nvar HypertyDescriptor =\n/*#__PURE__*/\nfunction (_CatalogueDataObject) {\n  HypertyDescriptor_inherits(HypertyDescriptor, _CatalogueDataObject);\n\n  /**\r\n   *\r\n   * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object enabling the same object to be\r\n   * stored and discovered in different Catalogues. Guid corresponds to <resource-type-id> per BNF of Resource Path.\r\n   * @param {CatalogueObjectType} catalogueType - \tIndicates the type of Catalogue Data Object\r\n   * @param {string} version\r\n   * @param {string} objectName\r\n   * @param {string} description\r\n   * @param {string} language\r\n   * @param {string} sourcePackageURL\r\n   * @param {HypertyResourceType[]} hypertyType A tag that identifies what type of hyperty is described in the object.\r\n   * @param {URL.HypertyCatalogueURLList} dataObjectUrls - It defines the Data Object Schemas supported by the Hyperty\r\n   * through a list of Catalogue URLs from where these schemas can be reached\r\n   */\n  function HypertyDescriptor(guid, catalogueType, version, objectName, description, language, sourcePackageURL, hypertyType, dataObjectUrls) {\n    var _this;\n\n    HypertyDescriptor_classCallCheck(this, HypertyDescriptor);\n\n    _this = HypertyDescriptor_possibleConstructorReturn(this, HypertyDescriptor_getPrototypeOf(HypertyDescriptor).call(this, guid, catalogueType, version, objectName, description, language, sourcePackageURL));\n    _this._configuration = {};\n    _this._constraints = {};\n    _this._policies = {};\n    _this._messageSchema = null;\n    _this._hypertyType = hypertyType;\n    _this._dataObjects = dataObjectUrls;\n    return _this;\n  }\n\n  HypertyDescriptor_createClass(HypertyDescriptor, [{\n    key: \"hypertyType\",\n    get: function get() {\n      return this._hypertyType;\n    },\n    set: function set(hType) {\n      if (hType) this._hypertyType = hType;\n    }\n  }, {\n    key: \"dataObjects\",\n    get: function get() {\n      return this._dataObjects;\n    },\n    set: function set(dataObjects) {\n      if (dataObjects) this._dataObjects = dataObjects;\n    }\n  }, {\n    key: \"configuration\",\n    get: function get() {\n      return this._configuration;\n    },\n    set: function set(configuration) {\n      if (configuration) this._configuration = configuration;\n    }\n  }, {\n    key: \"constraints\",\n    get: function get() {\n      return this._constraints;\n    },\n    set: function set(constraints) {\n      if (constraints) this._constraints = constraints;\n    }\n  }, {\n    key: \"messageSchema\",\n    get: function get() {\n      return this._messageSchema;\n    },\n    set: function set(messageSchema) {\n      if (messageSchema) this._messageSchema = messageSchema;\n    }\n  }, {\n    key: \"policies\",\n    get: function get() {\n      return this._policies;\n    },\n    set: function set(policies) {\n      if (policies) this._policies = policies;\n    }\n  }]);\n\n  return HypertyDescriptor;\n}(runtime_catalogue_CatalogueDataObject);\n\nvar RuntimeHypertyCapabilityType = {};\nvar HypertyType = {\n  COMMUNICATOR: 'communicator',\n  IDENTITY: 'identity',\n  CONTEXT: 'context'\n};\nvar HypertyResourceType = {\n  chat: 'CHAT',\n  audio: 'Audio',\n  video: 'Video',\n  av: 'AV',\n  screen: 'SCREEN',\n  file: 'FILe',\n  midi: 'MIDI'\n};\n/* harmony default export */ var runtime_catalogue_HypertyDescriptor = (HypertyDescriptor);\n// CONCATENATED MODULE: ./src/runtime-catalogue/ProtocolStubDescriptor.js\nfunction ProtocolStubDescriptor_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { ProtocolStubDescriptor_typeof = function _typeof(obj) { return typeof obj; }; } else { ProtocolStubDescriptor_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return ProtocolStubDescriptor_typeof(obj); }\n\nfunction ProtocolStubDescriptor_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction ProtocolStubDescriptor_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction ProtocolStubDescriptor_createClass(Constructor, protoProps, staticProps) { if (protoProps) ProtocolStubDescriptor_defineProperties(Constructor.prototype, protoProps); if (staticProps) ProtocolStubDescriptor_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction ProtocolStubDescriptor_possibleConstructorReturn(self, call) { if (call && (ProtocolStubDescriptor_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return ProtocolStubDescriptor_assertThisInitialized(self); }\n\nfunction ProtocolStubDescriptor_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction ProtocolStubDescriptor_getPrototypeOf(o) { ProtocolStubDescriptor_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return ProtocolStubDescriptor_getPrototypeOf(o); }\n\nfunction ProtocolStubDescriptor_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) ProtocolStubDescriptor_setPrototypeOf(subClass, superClass); }\n\nfunction ProtocolStubDescriptor_setPrototypeOf(o, p) { ProtocolStubDescriptor_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return ProtocolStubDescriptor_setPrototypeOf(o, p); }\n\n/**\r\n * Copyright 2016 PT Inovação e Sistemas SA\r\n * Copyright 2016 INESC-ID\r\n * Copyright 2016 QUOBIS NETWORKS SL\r\n * Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n * Copyright 2016 ORANGE SA\r\n * Copyright 2016 Deutsche Telekom AG\r\n * Copyright 2016 Apizee\r\n * Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n **/\n\n/**\r\n * Created by amo on 14/11/2015.\r\n */\n\n\nvar ProtocolStubDescriptor =\n/*#__PURE__*/\nfunction (_CatalogueDataObject) {\n  ProtocolStubDescriptor_inherits(ProtocolStubDescriptor, _CatalogueDataObject);\n\n  function ProtocolStubDescriptor(guid, type, version, objectName, description, language, sourcePackageURL, messageSchemas, configuration, constraints, hypertyType, dataObjects, interworking, idpProxy, mutualAuthentication) {\n    var _this;\n\n    ProtocolStubDescriptor_classCallCheck(this, ProtocolStubDescriptor);\n\n    _this = ProtocolStubDescriptor_possibleConstructorReturn(this, ProtocolStubDescriptor_getPrototypeOf(ProtocolStubDescriptor).call(this, guid, type, version, objectName, description, language, sourcePackageURL));\n    _this._messageSchemas = messageSchemas;\n    if (configuration) _this._configuration = configuration;else _this._configuration = {};\n    if (constraints) _this._constraints = constraints;else _this._constraints = {};\n    _this._hypertyType = hypertyType;\n    if (dataObjects) _this._dataObjects = dataObjects;else _this._dataObjects = [];\n    _this._interworking = interworking;\n    _this._idpProxy = idpProxy;\n    _this._mutualAuthentication = mutualAuthentication;\n    return _this;\n  }\n\n  ProtocolStubDescriptor_createClass(ProtocolStubDescriptor, [{\n    key: \"messageSchemas\",\n    get: function get() {\n      return this._messageSchemas;\n    },\n    set: function set(messageSchemas) {\n      if (messageSchemas) this._messageSchemas = messageSchemas;\n    }\n  }, {\n    key: \"constraints\",\n    get: function get() {\n      return this._constraints;\n    },\n    set: function set(constraints) {\n      if (constraints) this._constraints = constraints;\n    }\n  }, {\n    key: \"configuration\",\n    get: function get() {\n      return this._configuration;\n    },\n    set: function set(configuration) {\n      if (configuration) this._configuration = configuration;\n    }\n  }, {\n    key: \"hypertyType\",\n    get: function get() {\n      return this._hypertyType;\n    },\n    set: function set(value) {\n      this._hypertyType = value;\n    }\n  }, {\n    key: \"dataObjects\",\n    get: function get() {\n      return this._dataObjects;\n    },\n    set: function set(value) {\n      this._dataObjects = value;\n    }\n  }, {\n    key: \"interworking\",\n    get: function get() {\n      return this._interworking;\n    },\n    set: function set(value) {\n      this._interworking = value;\n    }\n  }, {\n    key: \"idpProxy\",\n    get: function get() {\n      return this._idpProxy;\n    },\n    set: function set(value) {\n      this._idpProxy = value;\n    }\n  }, {\n    key: \"mutualAuthentication\",\n    get: function get() {\n      return this._mutualAuthentication;\n    },\n    set: function set(value) {\n      this._mutualAuthentication = value;\n    }\n  }]);\n\n  return ProtocolStubDescriptor;\n}(runtime_catalogue_CatalogueDataObject);\n\n/* harmony default export */ var runtime_catalogue_ProtocolStubDescriptor = (ProtocolStubDescriptor);\n// CONCATENATED MODULE: ./src/runtime-catalogue/HypertyRuntimeDescriptor.js\nfunction HypertyRuntimeDescriptor_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { HypertyRuntimeDescriptor_typeof = function _typeof(obj) { return typeof obj; }; } else { HypertyRuntimeDescriptor_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return HypertyRuntimeDescriptor_typeof(obj); }\n\nfunction HypertyRuntimeDescriptor_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction HypertyRuntimeDescriptor_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction HypertyRuntimeDescriptor_createClass(Constructor, protoProps, staticProps) { if (protoProps) HypertyRuntimeDescriptor_defineProperties(Constructor.prototype, protoProps); if (staticProps) HypertyRuntimeDescriptor_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction HypertyRuntimeDescriptor_possibleConstructorReturn(self, call) { if (call && (HypertyRuntimeDescriptor_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return HypertyRuntimeDescriptor_assertThisInitialized(self); }\n\nfunction HypertyRuntimeDescriptor_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction HypertyRuntimeDescriptor_getPrototypeOf(o) { HypertyRuntimeDescriptor_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return HypertyRuntimeDescriptor_getPrototypeOf(o); }\n\nfunction HypertyRuntimeDescriptor_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) HypertyRuntimeDescriptor_setPrototypeOf(subClass, superClass); }\n\nfunction HypertyRuntimeDescriptor_setPrototypeOf(o, p) { HypertyRuntimeDescriptor_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return HypertyRuntimeDescriptor_setPrototypeOf(o, p); }\n\n/**\r\n * Copyright 2016 PT Inovação e Sistemas SA\r\n * Copyright 2016 INESC-ID\r\n * Copyright 2016 QUOBIS NETWORKS SL\r\n * Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n * Copyright 2016 ORANGE SA\r\n * Copyright 2016 Deutsche Telekom AG\r\n * Copyright 2016 Apizee\r\n * Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n **/\n\n/**\r\n * Created by amo on 14/11/2015.\r\n */\n\n\nvar HypertyRuntimeDescriptor =\n/*#__PURE__*/\nfunction (_CatalogueDataObject) {\n  HypertyRuntimeDescriptor_inherits(HypertyRuntimeDescriptor, _CatalogueDataObject);\n\n  function HypertyRuntimeDescriptor(guid, catalogueType, version, objectName, description, language, sourcePackageURL, runtimeType, hypertyCapabilities, protocolCapabilities, p2pHandlerStub, p2pRequesterStub) {\n    var _this;\n\n    HypertyRuntimeDescriptor_classCallCheck(this, HypertyRuntimeDescriptor);\n\n    _this = HypertyRuntimeDescriptor_possibleConstructorReturn(this, HypertyRuntimeDescriptor_getPrototypeOf(HypertyRuntimeDescriptor).call(this, guid, catalogueType, version, objectName, description, language, sourcePackageURL));\n    _this._runtimeType = runtimeType;\n    if (hypertyCapabilities) _this._hypertyCapabilities = hypertyCapabilities;else _this._hypertyCapabilities = new RuntimeHypertyCapability(true, false, false, false, false);\n    if (protocolCapabilities) _this._protocolCapabilities = protocolCapabilities;else _this._protocolCapabilities = new RuntimeProtocolCapability(true, false, true, false, false, false);\n    _this._p2pHandlerStub = p2pHandlerStub;\n    _this._p2pRequesterStub = p2pRequesterStub;\n    return _this;\n  }\n\n  HypertyRuntimeDescriptor_createClass(HypertyRuntimeDescriptor, [{\n    key: \"runtimeType\",\n    get: function get() {\n      return this._runtimeType;\n    },\n    set: function set(runtimeType) {\n      if (runtimeType) this._runtimeType = runtimeType;\n    }\n  }, {\n    key: \"hypertyCapabilities\",\n    get: function get() {\n      return this._hypertyCapabilities;\n    },\n    set: function set(hypertyCapabilities) {\n      if (hypertyCapabilities) this._hypertyCapabilities = hypertyCapabilities;\n    }\n  }, {\n    key: \"protocolCapabilities\",\n    get: function get() {\n      return this._hypertyCapabilities;\n    },\n    set: function set(protocolCapabilities) {\n      if (protocolCapabilities) this._protocolCapabilities = protocolCapabilities;\n    }\n  }, {\n    key: \"p2pHandlerStub\",\n    get: function get() {\n      return this._p2pHandlerStub;\n    },\n    set: function set(value) {\n      this._p2pHandlerStub = value;\n    }\n  }, {\n    key: \"p2pRequesterStub\",\n    get: function get() {\n      return this._p2pRequesterStub;\n    },\n    set: function set(value) {\n      this._p2pRequesterStub = value;\n    }\n  }]);\n\n  return HypertyRuntimeDescriptor;\n}(runtime_catalogue_CatalogueDataObject);\n/**\r\n * A class representation of the capability set of the Runtime Hyperty\r\n */\n\n\nvar RuntimeHypertyCapability =\n/*#__PURE__*/\nfunction () {\n  /**\r\n   * Creates an object of the Runtime Hyperty capability set\r\n   * @param {boolean} isWebRTCSupported\r\n   * @param {boolean} isMicSupported\r\n   * @param {boolean} isCameraSupported\r\n   * @param {boolean} isSensorSupported\r\n   * @param {boolean} isORTCSupported\r\n   */\n  function RuntimeHypertyCapability(isWebRTCSupported, isMicSupported, isCameraSupported, isSensorSupported, isORTCSupported) {\n    HypertyRuntimeDescriptor_classCallCheck(this, RuntimeHypertyCapability);\n\n    this._isWebRTC = isWebRTCSupported;\n    this._isMic = isMicSupported;\n    this._isCamera = isCameraSupported;\n    this._isSensor = isSensorSupported;\n    this._isORTC = isORTCSupported;\n  }\n\n  HypertyRuntimeDescriptor_createClass(RuntimeHypertyCapability, [{\n    key: \"getCapabilitySet\",\n    value: function getCapabilitySet() {\n      return JSON.stringify(this);\n    }\n  }, {\n    key: \"isMic\",\n    get: function get() {\n      return this._isMic;\n    }\n  }, {\n    key: \"isCamera\",\n    get: function get() {\n      return this._isCamera;\n    }\n  }, {\n    key: \"isSensor\",\n    get: function get() {\n      return this._isSensor;\n    }\n  }, {\n    key: \"isWebRTC\",\n    get: function get() {\n      return this._isWebRTC;\n    }\n  }, {\n    key: \"isORTCS\",\n    get: function get() {\n      return this._isORTC;\n    }\n  }]);\n\n  return RuntimeHypertyCapability;\n}();\n/**\r\n * A class representation of the protocol capability set of the Runtime Hyperty\r\n */\n\nvar RuntimeProtocolCapability =\n/*#__PURE__*/\nfunction () {\n  /**\r\n   * Creates an object of the runtime protocol capability\r\n   * @param {boolean} isHttp\r\n   * @param {boolean} isHttps\r\n   * @param {boolean} isWS\r\n   * @param {boolean} isWSS\r\n   * @param {boolean} isCoap\r\n   * @param {boolean} isDataChannel\r\n   */\n  function RuntimeProtocolCapability(isHttp, isHttps, isWS, isWSS, isCoap, isDataChannel) {\n    HypertyRuntimeDescriptor_classCallCheck(this, RuntimeProtocolCapability);\n\n    this._isHttp = isHttp;\n    this._isHttps = isHttps;\n    this._isWS = isWS;\n    this._isWSS = isWSS;\n    this._isCoap = isCoap;\n    this._isDataChannel = isDataChannel;\n  }\n\n  HypertyRuntimeDescriptor_createClass(RuntimeProtocolCapability, [{\n    key: \"isHttp\",\n    value: function isHttp() {\n      return this._isHttp;\n    }\n  }, {\n    key: \"isHttps\",\n    value: function isHttps() {\n      return this._isHttps;\n    }\n  }, {\n    key: \"isWS\",\n    value: function isWS() {\n      return this._isWS;\n    }\n  }, {\n    key: \"isSensorSupported\",\n    value: function isSensorSupported() {\n      return this._isSensor;\n    }\n  }, {\n    key: \"isWSS\",\n    value: function isWSS() {\n      return this._isWSS;\n    }\n  }, {\n    key: \"isCoap\",\n    value: function isCoap() {\n      return this._isCoap;\n    }\n  }, {\n    key: \"isDataChannel\",\n    value: function isDataChannel() {\n      return this._isDataChannel;\n    }\n  }, {\n    key: \"getCapabilitySet\",\n    value: function getCapabilitySet() {\n      return JSON.stringify(this);\n    }\n  }]);\n\n  return RuntimeProtocolCapability;\n}();\nvar RuntimeType = {\n  BROWSER: 'browser',\n  STANDALONE: 'standalone',\n  SERVER: 'server',\n  GATEWAY: 'gateway'\n};\n/* harmony default export */ var runtime_catalogue_HypertyRuntimeDescriptor = (HypertyRuntimeDescriptor);\n// CONCATENATED MODULE: ./src/runtime-catalogue/HypertyInterceptorDescriptor.js\nfunction HypertyInterceptorDescriptor_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { HypertyInterceptorDescriptor_typeof = function _typeof(obj) { return typeof obj; }; } else { HypertyInterceptorDescriptor_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return HypertyInterceptorDescriptor_typeof(obj); }\n\nfunction HypertyInterceptorDescriptor_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction HypertyInterceptorDescriptor_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction HypertyInterceptorDescriptor_createClass(Constructor, protoProps, staticProps) { if (protoProps) HypertyInterceptorDescriptor_defineProperties(Constructor.prototype, protoProps); if (staticProps) HypertyInterceptorDescriptor_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction HypertyInterceptorDescriptor_possibleConstructorReturn(self, call) { if (call && (HypertyInterceptorDescriptor_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return HypertyInterceptorDescriptor_assertThisInitialized(self); }\n\nfunction HypertyInterceptorDescriptor_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction HypertyInterceptorDescriptor_getPrototypeOf(o) { HypertyInterceptorDescriptor_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return HypertyInterceptorDescriptor_getPrototypeOf(o); }\n\nfunction HypertyInterceptorDescriptor_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) HypertyInterceptorDescriptor_setPrototypeOf(subClass, superClass); }\n\nfunction HypertyInterceptorDescriptor_setPrototypeOf(o, p) { HypertyInterceptorDescriptor_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return HypertyInterceptorDescriptor_setPrototypeOf(o, p); }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n * Created by pzu on 19.11.15.\r\n */\n\n\nvar PolicyEnforcerDescriptor =\n/*#__PURE__*/\nfunction (_CatalogueDataObject) {\n  HypertyInterceptorDescriptor_inherits(PolicyEnforcerDescriptor, _CatalogueDataObject);\n\n  function PolicyEnforcerDescriptor(guid, type, version, objectName, description, language, sourcePackageURL, configuration, policies) {\n    var _this;\n\n    HypertyInterceptorDescriptor_classCallCheck(this, PolicyEnforcerDescriptor);\n\n    _this = HypertyInterceptorDescriptor_possibleConstructorReturn(this, HypertyInterceptorDescriptor_getPrototypeOf(PolicyEnforcerDescriptor).call(this, guid, type, version, objectName, description, language, sourcePackageURL));\n    _this._configuration = configuration;\n    _this._policies = policies;\n    return _this;\n  }\n\n  HypertyInterceptorDescriptor_createClass(PolicyEnforcerDescriptor, [{\n    key: \"configuration\",\n    get: function get() {\n      return this._configuration;\n    },\n    set: function set(configuration) {\n      this._configuration = configuration;\n    }\n  }, {\n    key: \"policies\",\n    get: function get() {\n      return this._policies;\n    },\n    set: function set(policies) {\n      this._policies = policies;\n    }\n  }]);\n\n  return PolicyEnforcerDescriptor;\n}(runtime_catalogue_CatalogueDataObject);\n\n/* harmony default export */ var HypertyInterceptorDescriptor = (PolicyEnforcerDescriptor);\n// CONCATENATED MODULE: ./src/runtime-catalogue/DataObjectSchema.js\nfunction DataObjectSchema_typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { DataObjectSchema_typeof = function _typeof(obj) { return typeof obj; }; } else { DataObjectSchema_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return DataObjectSchema_typeof(obj); }\n\nfunction DataObjectSchema_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction DataObjectSchema_possibleConstructorReturn(self, call) { if (call && (DataObjectSchema_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return DataObjectSchema_assertThisInitialized(self); }\n\nfunction DataObjectSchema_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction DataObjectSchema_getPrototypeOf(o) { DataObjectSchema_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return DataObjectSchema_getPrototypeOf(o); }\n\nfunction DataObjectSchema_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) DataObjectSchema_setPrototypeOf(subClass, superClass); }\n\nfunction DataObjectSchema_setPrototypeOf(o, p) { DataObjectSchema_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return DataObjectSchema_setPrototypeOf(o, p); }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n\n/**\r\n * Created by pzu on 19.11.15.\r\n */\n\nvar DataObjectSchema =\n/*#__PURE__*/\nfunction (_CatalogueDataObject) {\n  DataObjectSchema_inherits(DataObjectSchema, _CatalogueDataObject);\n\n  function DataObjectSchema(guid, type, version, objectName, description, language, sourcePackageURL) {\n    DataObjectSchema_classCallCheck(this, DataObjectSchema);\n\n    return DataObjectSchema_possibleConstructorReturn(this, DataObjectSchema_getPrototypeOf(DataObjectSchema).call(this, guid, type, version, objectName, description, language, sourcePackageURL));\n  }\n\n  return DataObjectSchema;\n}(runtime_catalogue_CatalogueDataObject); //Children\n\nvar MessageDataObjectSchema =\n/*#__PURE__*/\nfunction (_DataObjectSchema) {\n  DataObjectSchema_inherits(MessageDataObjectSchema, _DataObjectSchema);\n\n  function MessageDataObjectSchema(guid, type, version, objectName, description, language, sourcePackageURL) {\n    DataObjectSchema_classCallCheck(this, MessageDataObjectSchema);\n\n    return DataObjectSchema_possibleConstructorReturn(this, DataObjectSchema_getPrototypeOf(MessageDataObjectSchema).call(this, guid, type, version, objectName, description, language, sourcePackageURL));\n  }\n\n  return MessageDataObjectSchema;\n}(DataObjectSchema);\nvar HypertyDataObjectSchema =\n/*#__PURE__*/\nfunction (_DataObjectSchema2) {\n  DataObjectSchema_inherits(HypertyDataObjectSchema, _DataObjectSchema2);\n\n  function HypertyDataObjectSchema(guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy, dataUrlScheme) {\n    var _this;\n\n    DataObjectSchema_classCallCheck(this, HypertyDataObjectSchema);\n\n    _this = DataObjectSchema_possibleConstructorReturn(this, DataObjectSchema_getPrototypeOf(HypertyDataObjectSchema).call(this, guid, type, version, objectName, description, language, sourcePackageURL));\n    _this._accessControlPolicy = accessControlPolicy;\n    _this._scheme = dataUrlScheme;\n    return _this;\n  }\n\n  return HypertyDataObjectSchema;\n}(DataObjectSchema); //Children\n\nvar CommunicationDataObjectSchema =\n/*#__PURE__*/\nfunction (_HypertyDataObjectSch) {\n  DataObjectSchema_inherits(CommunicationDataObjectSchema, _HypertyDataObjectSch);\n\n  function CommunicationDataObjectSchema(guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy) {\n    DataObjectSchema_classCallCheck(this, CommunicationDataObjectSchema);\n\n    return DataObjectSchema_possibleConstructorReturn(this, DataObjectSchema_getPrototypeOf(CommunicationDataObjectSchema).call(this, guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy));\n  }\n\n  return CommunicationDataObjectSchema;\n}(HypertyDataObjectSchema);\nvar ConnectionDataObjectSchema =\n/*#__PURE__*/\nfunction (_HypertyDataObjectSch2) {\n  DataObjectSchema_inherits(ConnectionDataObjectSchema, _HypertyDataObjectSch2);\n\n  function ConnectionDataObjectSchema(guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy) {\n    DataObjectSchema_classCallCheck(this, ConnectionDataObjectSchema);\n\n    return DataObjectSchema_possibleConstructorReturn(this, DataObjectSchema_getPrototypeOf(ConnectionDataObjectSchema).call(this, guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy));\n  }\n\n  return ConnectionDataObjectSchema;\n}(HypertyDataObjectSchema);\nvar IdentityDataObjectSchema =\n/*#__PURE__*/\nfunction (_HypertyDataObjectSch3) {\n  DataObjectSchema_inherits(IdentityDataObjectSchema, _HypertyDataObjectSch3);\n\n  function IdentityDataObjectSchema(guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy) {\n    DataObjectSchema_classCallCheck(this, IdentityDataObjectSchema);\n\n    return DataObjectSchema_possibleConstructorReturn(this, DataObjectSchema_getPrototypeOf(IdentityDataObjectSchema).call(this, guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy));\n  }\n\n  return IdentityDataObjectSchema;\n}(HypertyDataObjectSchema);\nvar ContextDataObjectSchema =\n/*#__PURE__*/\nfunction (_HypertyDataObjectSch4) {\n  DataObjectSchema_inherits(ContextDataObjectSchema, _HypertyDataObjectSch4);\n\n  function ContextDataObjectSchema(guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy) {\n    DataObjectSchema_classCallCheck(this, ContextDataObjectSchema);\n\n    return DataObjectSchema_possibleConstructorReturn(this, DataObjectSchema_getPrototypeOf(ContextDataObjectSchema).call(this, guid, type, version, objectName, description, language, sourcePackageURL, accessControlPolicy));\n  }\n\n  return ContextDataObjectSchema;\n}(HypertyDataObjectSchema);\nvar DataUrlScheme = {\n  COMM: 'COMM',\n  CONNECTION: 'CONNECTION',\n  CTXT: 'CTXT',\n  IDENTITY: 'IDENTITY'\n};\n/* harmony default export */ var runtime_catalogue_DataObjectSchema = (DataObjectSchema);\n// CONCATENATED MODULE: ./src/runtime-catalogue/CatalogueDataObjectFactory.js\nfunction CatalogueDataObjectFactory_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction CatalogueDataObjectFactory_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction CatalogueDataObjectFactory_createClass(Constructor, protoProps, staticProps) { if (protoProps) CatalogueDataObjectFactory_defineProperties(Constructor.prototype, protoProps); if (staticProps) CatalogueDataObjectFactory_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n * Copyright 2016 PT Inovação e Sistemas SA\r\n * Copyright 2016 INESC-ID\r\n * Copyright 2016 QUOBIS NETWORKS SL\r\n * Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n * Copyright 2016 ORANGE SA\r\n * Copyright 2016 Deutsche Telekom AG\r\n * Copyright 2016 Apizee\r\n * Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n **/\n\n\n\n\n\n\n\n\nvar CatalogueDataObjectFactory_CatalogueDataObjectFactory =\n/*#__PURE__*/\nfunction () {\n  function CatalogueDataObjectFactory() {\n    CatalogueDataObjectFactory_classCallCheck(this, CatalogueDataObjectFactory);\n  }\n\n  CatalogueDataObjectFactory_createClass(CatalogueDataObjectFactory, [{\n    key: \"createCatalogueDataObject\",\n\n    /**\r\n     * Create CatalogueDataObject\r\n     * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object\r\n     * @param {CatalogueObjectType} type - Indicates the type of Catalogue Data Object\r\n     * @param {string} version - Indicates the version of Catalogue Data\r\n     * @param {string} objectName - Human-understandable name of the catalogue object\r\n     * @param {string} description\r\n     * @param {DataObjectSourceLanguage} language - Programming language used in the SourcePackage\r\n     * @param {string} sourcePackageURL - URL from where the source code package of the corresponding catalogue object can be downloaded.\r\n     * @returns {CatalogueDataObject}\r\n     */\n    value: function createCatalogueDataObject(guid, type, version, objectName, description, language, sourcePackageURL) {\n      if (typeof guid === \"undefined\" || typeof type === \"undefined\" || typeof version === \"undefined\" || typeof objectName === \"undefined\" || typeof description === \"undefined\" || typeof language === \"undefined\" || typeof sourcePackageURL === \"undefined\") throw new Error(\"Invalid parameters!\");\n      return new runtime_catalogue_CatalogueDataObject(guid, type, version, objectName, description, language, sourcePackageURL);\n    }\n    /**\r\n     * Create HypertyDescriptor\r\n     * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object\r\n     * @param {string} version - Indicates the version of Catalogue Data\r\n     * @param {string} objectName - Human-understandable name of the catalogue object\r\n     * @param {string} description\r\n     * @param {DataObjectSourceLanguage} language - Programming language used in the SourcePackage\r\n     * @param {string} sourcePackageURL - URL from where the source code package of the corresponding catalogue object\r\n     * can be downloaded.\r\n     * @param {HypertyResourceType[]} hypertyType - An array of HypertyResourceType that identifies what type of hyperty\r\n     * resources are handled by the object.\r\n     * @param {URL.URLList} dataObjects - Defines the Data Object Schemas supported by the Hyperty through a list of Catalogue URLs from where these schemas can be reached.\r\n     * @returns {HypertyDescriptor}\r\n     */\n\n  }, {\n    key: \"createHypertyDescriptorObject\",\n    value: function createHypertyDescriptorObject(guid, version, objectName, description, language, sourcePackageURL, hypertyType, dataObjects) {\n      if (typeof guid === \"undefined\" || typeof version === \"undefined\" || typeof objectName === \"undefined\" || typeof description === \"undefined\" || typeof language === \"undefined\" || typeof sourcePackageURL === \"undefined\" || typeof hypertyType === \"undefined\" || typeof dataObjects === \"undefined\") throw new Error(\"Invalid parameters!\");\n      return new runtime_catalogue_HypertyDescriptor(guid, CatalogueObjectType.HYPERTY, version, objectName, description, language, sourcePackageURL, hypertyType, dataObjects);\n    }\n    /**\r\n     * Create ProtocolStubDescriptor\r\n     * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object\r\n     * @param {string} version - Indicates the version of Catalogue Data\r\n     * @param {string} objectName - Human-understandable name of the catalogue object\r\n     * @param {string} description\r\n     * @param {DataObjectSourceLanguage} language - Programming language used in the SourcePackage\r\n     * @param {string} sourcePackageURL - URL from where the source code package of the corresponding catalogue object can be downloaded.\r\n     * @param {URL.URL} messageSchemas - Defines the Schema describing the Message Data Model used by the Hyperty through the Catalogue URL from where the Message schema can be reached. If not defined, by default it is assumed the standard Message Model is used.\r\n     * @param configuration - Data required to configure the ProtocolStub\r\n     * @param constraints - Describes capabilities required from the Hyperty Runtime in order to be able to execute the ProtocolStub\r\n     * @param hypertyType\r\n     * @param dataObjects\r\n     * @param interworking\r\n     * @param idpProxy\r\n     * @param mutualAuthentication\r\n     * @returns {ProtocolStubDescriptor}\r\n     */\n\n  }, {\n    key: \"createProtoStubDescriptorObject\",\n    value: function createProtoStubDescriptorObject(guid, version, objectName, description, language, sourcePackageURL, messageSchemas, configuration, constraints, hypertyType, dataObjects, interworking, idpProxy, mutualAuthentication) {\n      if (typeof guid === \"undefined\" || typeof version === \"undefined\" || typeof objectName === \"undefined\" || typeof description === \"undefined\" || typeof language === \"undefined\" || typeof sourcePackageURL === \"undefined\" || typeof messageSchemas === \"undefined\" || typeof configuration === \"undefined\" || typeof constraints === \"undefined\") throw new Error(\"Invalid parameters!\");\n      return new runtime_catalogue_ProtocolStubDescriptor(guid, CatalogueObjectType.PROTOSTUB, version, objectName, description, language, sourcePackageURL, messageSchemas, configuration, constraints, hypertyType, dataObjects, interworking, idpProxy, mutualAuthentication);\n    }\n    /**\r\n     * Create HypertyRuntimeDescriptor\r\n     * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object\r\n     * @param {string} version - Indicates the version of Catalogue Data\r\n     * @param {string} objectName - Human-understandable name of the catalogue object\r\n     * @param {string} description\r\n     * @param {DataObjectSourceLanguage} language - Programming language used in the SourcePackage\r\n     * @param {string} sourcePackageURL - URL from where the source code package of the corresponding catalogue object can be downloaded.\r\n     * @param {RuntimeType}runtimeType\r\n     * @param {RuntimeHypertyCapabilities} hypertyCapabilities - Supported capabilities to execute Hyperties\r\n     * @param {RuntimeProtocolCapabilities} protocolCapabilities - Supported capabilities to execute Protocol Stubs\r\n     * @param p2pHandlerStub\r\n     * @param p2pRequesterStub\r\n     * @returns {HypertyRuntimeDescriptor} the data object of the Hyperty Runtime Descriptor\r\n     */\n\n  }, {\n    key: \"createHypertyRuntimeDescriptorObject\",\n    value: function createHypertyRuntimeDescriptorObject(guid, version, objectName, description, language, sourcePackageURL, runtimeType, hypertyCapabilities, protocolCapabilities, p2pHandlerStub, p2pRequesterStub) {\n      if (typeof guid === \"undefined\" || typeof version === \"undefined\" || typeof objectName === \"undefined\" || typeof description === \"undefined\" || typeof language === \"undefined\" || typeof sourcePackageURL === \"undefined\" || typeof runtimeType === \"undefined\") throw new Error(\"Invalid parameters!\");\n      return new runtime_catalogue_HypertyRuntimeDescriptor(guid, CatalogueObjectType.HYPERTY_RUNTIME, version, objectName, description, language, sourcePackageURL, runtimeType, hypertyCapabilities, protocolCapabilities, p2pHandlerStub, p2pRequesterStub);\n    }\n    /**\r\n     * Create Hyperty Interceptor Descriptor\r\n     * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object\r\n     * @param {string} version - Indicates the version of Catalogue Data\r\n     * @param {string} objectName - Human-understandable name of the catalogue object\r\n     * @param {string} description\r\n     * @param {DataObjectSourceLanguage} language - Programming language used in the SourcePackage\r\n     * @param {string} sourcePackageURL - URL from where the source code package of the corresponding catalogue object can be downloaded.\r\n     * @param configuration\r\n     * @param policies\r\n     * @returns {PolicyEnforcerDescriptor}\r\n     */\n\n  }, {\n    key: \"createHypertyInterceptorDescriptorObject\",\n    value: function createHypertyInterceptorDescriptorObject(guid, version, objectName, description, language, sourcePackageURL, configuration, policies) {\n      if (typeof guid === \"undefined\" || typeof version === \"undefined\" || typeof objectName === \"undefined\" || typeof description === \"undefined\" || typeof language === \"undefined\" || typeof sourcePackageURL === \"undefined\") throw new Error(\"Invalid parameters!\");\n      return new HypertyInterceptorDescriptor(guid, CatalogueObjectType.HYPERTY_INTERCEPTOR, version, objectName, description, language, sourcePackageURL, configuration, policies);\n    }\n    /**\r\n     * Create DataObjectSchema which in effect is the MessageDataObjectSchema\r\n     * @deprecated Use either createMessageDataObjectSchema or createHypertyDataObjectSchema instead\r\n     * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object\r\n     * @param {string} version - Indicates the version of Catalogue Data\r\n     * @param {string} objectName - Human-understandable name of the catalogue object\r\n     * @param {string} description\r\n     * @param {DataObjectSourceLanguage} language - Programming language used in the SourcePackage\r\n     * @param {string} sourcePackageURL - URL from where the source code package of the corresponding catalogue object can be downloaded.\r\n     * @returns {DataObjectSchema}\r\n     */\n\n  }, {\n    key: \"createDataObjectSchema\",\n    value: function createDataObjectSchema(guid, version, objectName, description, language, sourcePackageURL) {\n      if (typeof guid === \"undefined\" || typeof version === \"undefined\" || typeof objectName === \"undefined\" || typeof description === \"undefined\" || typeof language === \"undefined\" || typeof sourcePackageURL === \"undefined\") throw new Error(\"Invalid parameters!\");\n      return new DataObjectSchema(guid, CatalogueObjectType.HYPERTY_DATA_OBJECT, version, objectName, description, language, sourcePackageURL);\n    }\n    /**\r\n     * Create DataObjectSchema which in effect is the MessageDataObjectSchema\r\n     * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object\r\n     * @param {string} version - Indicates the version of Catalogue Data\r\n     * @param {string} objectName - Human-understandable name of the catalogue object\r\n     * @param {string} description\r\n     * @param {DataObjectSourceLanguage} language - Programming language used in the SourcePackage\r\n     * @param {string} sourcePackageURL - URL from where the source code package of the corresponding catalogue object can be downloaded.\r\n     * @returns {DataObjectSchema}\r\n     */\n\n  }, {\n    key: \"createMessageDataObjectSchema\",\n    value: function createMessageDataObjectSchema(guid, version, objectName, description, language, sourcePackageURL) {\n      if (typeof guid === \"undefined\" || typeof version === \"undefined\" || typeof objectName === \"undefined\" || typeof description === \"undefined\" || typeof language === \"undefined\" || typeof sourcePackageURL === \"undefined\") throw new Error(\"Invalid parameters!\");\n      return new DataObjectSchema(guid, CatalogueObjectType.HYPERTY_DATA_OBJECT, version, objectName, description, language, sourcePackageURL);\n    }\n    /**\r\n     * Create HypertyDataObjectSchema\r\n     * @param {string} guid - Catalogue Global Unique identifier of the Catalogue Object\r\n     * @param {string} version - Indicates the version of Catalogue Data\r\n     * @param {string} objectName - Human-understandable name of the catalogue object\r\n     * @param {string} description\r\n     * @param {DataObjectSourceLanguage} language - Programming language used in the SourcePackage\r\n     * @param {string} sourcePackageURL - URL from where the source code package of the corresponding catalogue object can be downloaded.\r\n     * @param {string} accessControlPolicy - policy rule to access object (see Reporter-Observer Comm pattern)\r\n     * @param {DataUrlScheme} scheme - identifies the data scheme (COMM, CONNECTION, CTXT or IDENTITY)\r\n     * @returns {DataObjectSchema}\r\n     */\n\n  }, {\n    key: \"createHypertyDataObjectSchema\",\n    value: function createHypertyDataObjectSchema(guid, version, objectName, description, language, sourcePackageURL, accessControlPolicy, scheme) {\n      if (typeof guid === \"undefined\" || typeof version === \"undefined\" || typeof objectName === \"undefined\" || typeof description === \"undefined\" || typeof language === \"undefined\" || typeof sourcePackageURL === \"undefined\" || typeof scheme === \"undefined\" || typeof accessControlPolicy === \"undefined\") throw new Error(\"Invalid parameters!\");\n      if (scheme === DataUrlScheme.COMM) return new CommunicationDataObjectSchema(guid, CatalogueObjectType.HYPERTY_DATA_OBJECT, version, objectName, description, language, sourcePackageURL, scheme, accessControlPolicy);else if (scheme === DataUrlScheme.CONNECTION) return new ConnectionDataObjectSchema(guid, CatalogueObjectType.HYPERTY_DATA_OBJECT, version, objectName, description, language, sourcePackageURL, scheme, accessControlPolicy);else if (scheme === DataUrlScheme.CTXT) return new ContextDataObjectSchema(guid, CatalogueObjectType.HYPERTY_DATA_OBJECT, version, objectName, description, language, sourcePackageURL, scheme, accessControlPolicy);else if (scheme === DataUrlScheme.IDENTITY) return new IdentityDataObjectSchema(guid, CatalogueObjectType.HYPERTY_DATA_OBJECT, version, objectName, description, language, sourcePackageURL, scheme, accessControlPolicy);\n    }\n    /**\r\n     * Create SourcePackage\r\n     * @param sourceCodeClassname - The Class-name of the SourceCode\r\n     * @param sourceCode - The source code of the catalogue object\r\n     * @returns {SourcePackage}\r\n     */\n\n  }, {\n    key: \"createSourcePackage\",\n    value: function createSourcePackage(sourceCodeClassname, sourceCode) {\n      if (typeof sourceCode === \"undefined\" || typeof sourceCodeClassname === \"undefined\") throw new Error(\"Invalid parameters!\");\n      return new runtime_catalogue_SourcePackage(sourceCodeClassname, sourceCode);\n    }\n  }]);\n\n  return CatalogueDataObjectFactory;\n}();\n\n/* harmony default export */ var runtime_catalogue_CatalogueDataObjectFactory = (CatalogueDataObjectFactory_CatalogueDataObjectFactory);\n// CONCATENATED MODULE: ./src/runtime-catalogue/RuntimeCatalogue.js\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction RuntimeCatalogue_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction RuntimeCatalogue_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction RuntimeCatalogue_createClass(Constructor, protoProps, staticProps) { if (protoProps) RuntimeCatalogue_defineProperties(Constructor.prototype, protoProps); if (staticProps) RuntimeCatalogue_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Log System\n\nvar RuntimeCatalogue_log = loglevel[\"getLogger\"]('RuntimeCatalogue');\n\n\nvar RuntimeCatalogue_RuntimeCatalogue =\n/*#__PURE__*/\nfunction () {\n  function RuntimeCatalogue(runtimeFactory, name, schema) {\n    RuntimeCatalogue_classCallCheck(this, RuntimeCatalogue);\n\n    if (!runtimeFactory) throw Error('The catalogue needs the runtimeFactory');\n    this._factory = new runtime_catalogue_CatalogueDataObjectFactory();\n    this.httpRequest = runtimeFactory.createHttpRequest();\n    this.atob = runtimeFactory.atob ? runtimeFactory.atob : atob;\n    var storageName = name ? name : 'runtimeCatalogue';\n    var storageSchema = schema ? schema : '&cguid, accessControlPolicy, constraints, dataObjects, hypertyType, objectName, sourcePackage, version';\n    var schemas = {};\n    schemas[storageName] = storageSchema;\n    this.storageManager = runtimeFactory.storageManager(storageName, schemas);\n  }\n  /**\r\n     * Get a Catalogue Data Object (Descriptor) from a URL, and construct it using the provided function\r\n     * @param {String} descriptorURL - e.g. mydomain.com/.well-known/hyperty/MyHyperty\r\n     * @param {function} createFunc - e.g. createHyperty\r\n     * @param {boolean} [getFull] - whether or not to get descriptor with sourcePackage, or only the descriptor part\r\n     * @param {JSON} constraints - constraints object\r\n     * @returns {Promise} - Promise that fulfills with the requested descriptor in the appropriate type.\r\n     * If constraints were provided, a descriptor is only returned if it meets the constraints, otherwise the promise will be rejected.\r\n     */\n\n\n  RuntimeCatalogue_createClass(RuntimeCatalogue, [{\n    key: \"getDescriptor\",\n    value: function getDescriptor(descriptorURL, createFunc) {\n      var _this = this;\n\n      var getFull = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var constraints = arguments.length > 3 ? arguments[3] : undefined;\n      RuntimeCatalogue_log.info('[RuntimeCatalogue] - getting descriptor from: ', descriptorURL, ' with constraints: ', constraints); // some flags for optimization\n      // (later the descriptor will not be saved in case both of these booleans are true)\n\n      var isSavedDescriptor = false;\n      var isCompleteDescriptor = false; // get raw descriptor\n      // first checks if descriptor is already in localStorage (based on cguid and version)\n\n      var descriptorPromise;\n\n      if (constraints != undefined) {\n        descriptorPromise = Promise.all([this.httpRequest.post(descriptorURL + '/version', {\n          body: JSON.stringify(constraints)\n        }), this.httpRequest.post(descriptorURL + '/cguid', {\n          body: JSON.stringify(constraints)\n        })]);\n      } else {\n        descriptorPromise = Promise.all([this.httpRequest.get(descriptorURL + '/version'), this.httpRequest.get(descriptorURL + '/cguid')]);\n      }\n\n      descriptorPromise = descriptorPromise.then(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            version = _ref2[0],\n            cguid = _ref2[1];\n\n        RuntimeCatalogue_log.log('[RuntimeCatalogue.getDescriptor] - got version (' + version + ') and cguid (' + cguid + ') for descriptor ' + descriptorURL); // check if same version is contained in localStorage\n\n        return _this.storageManager.getVersion('cguid', cguid).then(function (dbVersion) {\n          if (dbVersion >= version) {\n            RuntimeCatalogue_log.log('[RuntimeCatalogue.getDescriptor] local version is updated for ', descriptorURL);\n            isSavedDescriptor = true;\n            return _this.storageManager.get('cguid', cguid);\n          } else {\n            RuntimeCatalogue_log.log('[RuntimeCatalogue.getDescriptor] local version not updated for ', descriptorURL, ' retrieving from remote catalogue ...'); // no saved copy, proceed with retrieving descriptor\n\n            var retrievePromise = constraints != undefined ? _this.httpRequest.post(descriptorURL, {\n              body: JSON.stringify(constraints)\n            }) : _this.httpRequest.get(descriptorURL);\n            return retrievePromise.then(function (descriptor) {\n              descriptor = JSON.parse(descriptor); //log.log(\"got descriptor:\", JSON.stringify(descriptor, null, 2));\n\n              if (descriptor['ERROR']) {\n                // TODO handle error properly\n                throw new Error(descriptor);\n              } else {\n                return descriptor;\n              }\n            });\n          }\n        });\n      }).catch(function (error) {\n        var errorString = 'Unable to get descriptor for ' + descriptorURL + (constraints != undefined ? ' with constraints ' + constraints : '') + ': ' + error;\n        RuntimeCatalogue_log.error(errorString);\n        throw new Error(errorString);\n      });\n      var returnPromise = descriptorPromise; // if getFull, attach sourcePackage\n\n      if (getFull) {\n        RuntimeCatalogue_log.log('adding promise to attach sourcePackage');\n        returnPromise = descriptorPromise.then(function (descriptor) {\n          if (descriptor.sourcePackage) {\n            isCompleteDescriptor = true;\n            return descriptor;\n          } else {\n            isCompleteDescriptor = false;\n            return _this.attachRawSourcePackage(descriptor);\n          }\n        });\n      } // finally create object\n\n\n      returnPromise = returnPromise.then(function (descriptor) {\n        // store if not saved before, or if full descriptor was requested and only partial descriptor was stored.\n        if (!isSavedDescriptor || isSavedDescriptor && !isCompleteDescriptor && getFull) {\n          _this.storageManager.set(descriptor.cguid, descriptor.version, descriptor);\n        }\n\n        return createFunc.apply(_this, [descriptor, constraints]);\n      });\n      return returnPromise;\n    }\n    /**\r\n       * Uses the sourcePackageURL from the descriptor, requests the sourcePackage and attaches it to the descriptor.\r\n       * @param {CatalogueDataObject} descriptor\r\n       * @param {JSON} constraints - constraints object\r\n       * @returns {Promise} - fulfills with complete descriptor\r\n       */\n\n  }, {\n    key: \"attachRawSourcePackage\",\n    value: function attachRawSourcePackage(descriptor, constraints) {\n      var _this2 = this;\n\n      RuntimeCatalogue_log.log('attaching raw sourcePackage from:', descriptor.sourcePackageURL);\n      return new Promise(function (resolve, reject) {\n        var retrievePromise = constraints != undefined ? _this2.httpRequest.post(descriptor.sourcePackageURL, {\n          body: JSON.stringify(constraints)\n        }) : _this2.httpRequest.get(descriptor.sourcePackageURL);\n        retrievePromise.then(function (sourcePackage) {\n          sourcePackage = JSON.parse(sourcePackage); //delete descriptor.sourcePackageURL;\n          //log.log(\"attaching sourcePackage:\", sourcePackage);\n\n          descriptor.sourcePackage = sourcePackage;\n          resolve(descriptor);\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n    /**\r\n       * Get HypertyDescriptor\r\n       * @param hypertyURL - e.g. mydomain.com/.well-known/hyperty/MyHyperty\r\n       * @param {boolean} [getFull] - boolean to decide to get the descriptor with the sourcePackage or (potentially) without\r\n       * @param {JSON} constraints - constraints object\r\n       * @returns {Promise}\r\n       */\n\n  }, {\n    key: \"getHypertyDescriptor\",\n    value: function getHypertyDescriptor(hypertyURL) {\n      var getFull = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var constraints = arguments.length > 2 ? arguments[2] : undefined;\n      return this.getDescriptor(hypertyURL, this.createHyperty, getFull, constraints);\n    }\n    /**\r\n       * Get StubDescriptor\r\n       * @param stubURL - e.g. mydomain.com/.well-known/protostub/MyProtostub\r\n       * @param {boolean} [getFull] - boolean to decide to get the descriptor with the sourcePackage or (potentially) without\r\n       * @param {JSON} constraints - constraints object\r\n       * @returns {Promise}\r\n       */\n\n  }, {\n    key: \"getStubDescriptor\",\n    value: function getStubDescriptor(stubURL) {\n      var getFull = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var constraints = arguments.length > 2 ? arguments[2] : undefined;\n      return this.getDescriptor(stubURL, this.createStub, getFull, constraints);\n    }\n    /**\r\n       * Get RuntimeDescriptor\r\n       * @param runtimeURL - e.g. mydomain.com/.well-known/runtime/MyRuntime\r\n       * @param {boolean} [getFull] - boolean to decide to get the descriptor with the sourcePackage or (potentially) without\r\n       * @param {JSON} constraints - constraints object\r\n       * @returns {Promise}\r\n       */\n\n  }, {\n    key: \"getRuntimeDescriptor\",\n    value: function getRuntimeDescriptor(runtimeURL) {\n      var getFull = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var constraints = arguments.length > 2 ? arguments[2] : undefined;\n      return this.getDescriptor(runtimeURL, this.createRuntimeDescriptor, getFull, constraints);\n    }\n    /**\r\n       * Get DataSchemaDescriptor\r\n       * @param dataSchemaURL - e.g. mydomain.com/.well-known/dataschema/MyDataSchema\r\n       * @param {boolean} [getFull] - boolean to decide to get the descriptor with the sourcePackage or (potentially) without\r\n       * @param {JSON} constraints - constraints object\r\n       * @returns {Promise}\r\n       */\n\n  }, {\n    key: \"getDataSchemaDescriptor\",\n    value: function getDataSchemaDescriptor(dataSchemaURL) {\n      var getFull = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var constraints = arguments.length > 2 ? arguments[2] : undefined;\n      //    return this.getDescriptor(dataSchemaURL, this.createDataSchema, getFull, constraints)\n      return new Promise(function (resolve) {\n        var schema = dataSchemaURL.split('/dataschema/')[1];\n        RuntimeCatalogue_log.log('[RuntimeCatalogue.getDataSchemaDescriptor] schema ', schema);\n        var descriptor = {\n          sourcePackage: {\n            sourceCode: {\n              properties: {}\n            }\n          }\n        }; //      let scheme = properties.scheme ? properties.scheme.co : [];\n\n        switch (schema) {\n          case 'Context':\n          case 'ContextReporter':\n          case 'ContextObserver':\n            descriptor.sourcePackage.sourceCode.properties.scheme = 'context';\n            break;\n\n          case 'Connection':\n            descriptor.sourcePackage.sourceCode.properties.scheme = 'connection';\n            break;\n\n          case 'WalletData':\n            descriptor.sourcePackage.sourceCode.properties.scheme = 'walletData';\n            break;\n\n          case 'Communication':\n            descriptor.sourcePackage.sourceCode.properties.scheme = 'comm';\n            descriptor.sourcePackage.sourceCode.properties.childrens = ['resources'];\n            break;\n\n          case 'HelloWorldDataSchema':\n            descriptor.sourcePackage.sourceCode.properties.scheme = 'hello';\n            break;\n\n          default:\n            descriptor.sourcePackage.sourceCode.properties.scheme = 'resource';\n            descriptor.sourcePackage.sourceCode.properties.childrens = [];\n            break;\n        }\n\n        resolve(descriptor);\n      });\n    }\n    /**\r\n       * Get IDPProxyDescriptor\r\n       * @param idpProxyURL - e.g. mydomain.com/.well-known/idp-proxy/MyProxy\r\n       * @param {boolean} [getFull] - boolean to decide to get the descriptor with the sourcePackage or (potentially) without\r\n       * @param {JSON} constraints - constraints object\r\n       * @returns {Promise}\r\n       */\n\n  }, {\n    key: \"getIdpProxyDescriptor\",\n    value: function getIdpProxyDescriptor(idpProxyURL) {\n      var getFull = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var constraints = arguments.length > 2 ? arguments[2] : undefined;\n      return this.getDescriptor(idpProxyURL, this.createIdpProxy, getFull, constraints);\n    }\n    /**\r\n       * Create HypertyDescriptor based on raw object that contains its attributes\r\n       * @param {JSON} rawHyperty\r\n       * @returns {HypertyDescriptor}\r\n       */\n\n  }, {\n    key: \"createHyperty\",\n    value: function createHyperty(rawHyperty) {\n      //log.log(\"createHyperty:\", rawHyperty);\n      // create the descriptor\n      var hyperty = this._factory.createHypertyDescriptorObject(rawHyperty['cguid'], rawHyperty['version'], rawHyperty['objectName'], rawHyperty['description'], rawHyperty['language'], rawHyperty['sourcePackageURL'], rawHyperty['type'] || rawHyperty['hypertyType'], rawHyperty['dataObjects']); //log.log(\"factory returned:\", hyperty);\n      // optional fields\n\n\n      hyperty.configuration = rawHyperty['configuration'];\n      hyperty.constraints = rawHyperty['constraints'];\n      hyperty.messageSchema = rawHyperty['messageSchema'];\n      hyperty.policies = rawHyperty['policies'];\n      hyperty.signature = rawHyperty['signature']; // parse and attach sourcePackage\n\n      var sourcePackage = rawHyperty['sourcePackage'];\n\n      if (sourcePackage) {\n        hyperty.sourcePackage = this.createSourcePackage(sourcePackage);\n      }\n\n      return hyperty;\n    }\n    /**\r\n       * Create ProtocolStubDescriptor based on raw object that contains its attributes\r\n       * @param rawStub\r\n       * @returns {ProtocolStubDescriptor}\r\n       */\n\n  }, {\n    key: \"createStub\",\n    value: function createStub(rawStub) {\n      // log.log(\"creating stub descriptor based on: \", rawStub);\n      // create the descriptor\n      var stub = this._factory.createProtoStubDescriptorObject(rawStub['cguid'], rawStub['version'], rawStub['objectName'], rawStub['description'], rawStub['language'], rawStub['sourcePackageURL'], rawStub['messageSchemas'], rawStub['configuration'], rawStub['constraints'], rawStub['hypertyType'], rawStub['dataObjects'], rawStub['interworking'], rawStub['idpProxy'], rawStub['mutualAuthentication']); // optional fields\n\n\n      stub.signature = rawStub['signature']; // parse and attach the sourcePackage\n\n      var sourcePackage = rawStub['sourcePackage'];\n\n      if (sourcePackage) {\n        stub.sourcePackage = this.createSourcePackage(sourcePackage);\n      }\n\n      return stub;\n    }\n    /**\r\n       * Create HypertyRuntimeDescriptor based on raw object that contains its attributes\r\n       * @param rawRuntime\r\n       * @returns {HypertyRuntimeDescriptor}\r\n       */\n\n  }, {\n    key: \"createRuntimeDescriptor\",\n    value: function createRuntimeDescriptor(rawRuntime) {\n      // parse capabilities first\n      try {\n        rawRuntime['hypertyCapabilities'] = JSON.parse(rawRuntime['hypertyCapabilities']);\n        rawRuntime['protocolCapabilities'] = JSON.parse(rawRuntime['protocolCapabilities']);\n      } catch (e) {} // already json object\n      //log.log(\"creating runtime descriptor based on: \", rawRuntime);\n      // create the descriptor\n\n\n      var runtime = this._factory.createHypertyRuntimeDescriptorObject(rawRuntime['cguid'], rawRuntime['version'], rawRuntime['objectName'], rawRuntime['description'], rawRuntime['language'], rawRuntime['sourcePackageURL'], rawRuntime['type'] || rawRuntime['runtimeType'], rawRuntime['hypertyCapabilities'], rawRuntime['protocolCapabilities'], rawRuntime['p2pHandlerStub'], rawRuntime['p2pRequesterStub']); // optional fields\n\n\n      runtime.signature = rawRuntime['signature']; // parse and attach sourcePackage\n\n      var sourcePackage = rawRuntime['sourcePackage'];\n\n      if (sourcePackage) {\n        // log.log(\"runtime has sourcePackage:\", sourcePackage);\n        runtime.sourcePackage = this.createSourcePackage(sourcePackage);\n      }\n\n      return runtime;\n    }\n    /**\r\n       * Create DataObjectSchema based on raw object that contains its attributes\r\n       * @param rawSchema\r\n       * @returns {DataObjectSchema}\r\n       */\n\n  }, {\n    key: \"createDataSchema\",\n    value: function createDataSchema(rawSchema) {\n      //log.log(\"creating dataSchema based on: \", rawSchema);\n      var dataSchema; //log.log('1. createMessageDataObjectSchema: ', rawSchema[\"accessControlPolicy\"]);\n      //log.log('2. createMessageDataObjectSchema: ', rawSchema[\"scheme\"]);\n\n      if (rawSchema['accessControlPolicy'] && rawSchema['scheme']) {\n        dataSchema = this._factory.createHypertyDataObjectSchema(rawSchema['cguid'], rawSchema['version'], rawSchema['objectName'], rawSchema['description'], rawSchema['language'], rawSchema['sourcePackageURL'], rawSchema['accessControlPolicy'], rawSchema['scheme']);\n      } else {\n        //log.log('3. createMessageDataObjectSchema: ', rawSchema);\n        dataSchema = this._factory.createMessageDataObjectSchema(rawSchema['cguid'], rawSchema['version'], rawSchema['objectName'], rawSchema['description'], rawSchema['language'], rawSchema['sourcePackageURL']);\n      } // optional fields\n\n\n      dataSchema.signature = rawSchema['signature']; // parse and attach sourcePackage\n\n      var sourcePackage = rawSchema['sourcePackage'];\n\n      if (sourcePackage) {\n        //log.log(\"dataSchema has sourcePackage:\", sourcePackage);\n        dataSchema.sourcePackage = this.createSourcePackage(sourcePackage);\n\n        try {\n          dataSchema.sourcePackage.sourceCode = JSON.parse(dataSchema.sourcePackage.sourceCode);\n        } catch (e) {\n          RuntimeCatalogue_log.log('DataSchema Source code is already parsed');\n        }\n\n        return dataSchema;\n      } //log.log(\"created dataSchema descriptor object:\", dataSchema);\n\n\n      return dataSchema;\n    }\n    /**\r\n       * Create ProtocolStubDescriptor based on raw object that contains its attributes\r\n       * @param rawProxy\r\n       * @returns {ProtocolStubDescriptor}\r\n       */\n\n  }, {\n    key: \"createIdpProxy\",\n    value: function createIdpProxy(rawProxy) {\n      // log.log(\"creating idpproxy descriptor based on: \", rawProxy);\n      // create the descriptor\n      var idpproxy = this._factory.createProtoStubDescriptorObject(rawProxy['cguid'], rawProxy['version'], rawProxy['objectName'], rawProxy['description'], rawProxy['language'], rawProxy['sourcePackageURL'], rawProxy['messageSchemas'], rawProxy['configuration'], rawProxy['constraints'], rawProxy['hypertyType'], rawProxy['dataObjects'], rawProxy['interworking'], rawProxy['idpProxy'], rawProxy['mutualAuthentication']); // optional fields\n\n\n      idpproxy.signature = rawProxy['signature']; // parse and attach the sourcePackage\n\n      var sourcePackage = rawProxy['sourcePackage'];\n\n      if (sourcePackage) {\n        sourcePackage = this.createSourcePackage(sourcePackage);\n        idpproxy.sourcePackage = sourcePackage;\n      }\n\n      return idpproxy;\n    }\n  }, {\n    key: \"createSourcePackage\",\n    value: function createSourcePackage(sp) {\n      //log.log(\"createSourcePackage:\", sp);\n      // check encoding\n      if (sp['encoding'] === 'base64') {\n        sp['sourceCode'] = this.atob(sp['sourceCode']);\n        sp['encoding'] = 'utf-8';\n      }\n\n      var sourcePackage = this._factory.createSourcePackage(sp['sourceCodeClassname'], sp['sourceCode']);\n\n      if (sp['encoding']) sourcePackage.encoding = sp['encoding'];\n      if (sp['signature']) sourcePackage.signature = sp['signature'];\n      return sourcePackage;\n    }\n    /**\r\n       * Get source Package from a URL\r\n       * @param sourcePackageURL - e.g. mydomain.com/.well-known/hyperty/MyHyperty/sourcePackage\r\n       * @returns {Promise}\r\n       */\n\n  }, {\n    key: \"getSourcePackageFromURL\",\n    value: function getSourcePackageFromURL(sourcePackageURL) {\n      var _this3 = this;\n\n      RuntimeCatalogue_log.log('getting sourcePackage from:', sourcePackageURL);\n      return new Promise(function (resolve, reject) {\n        _this3.httpRequest.get(sourcePackageURL).then(function (result) {\n          //log.log(\"got raw sourcePackage:\", result);\n          if (result['ERROR']) {\n            // TODO handle error properly\n            reject(result);\n          } else {\n            result = JSON.parse(result);\n\n            var sourcePackage = _this3.createSourcePackage(result);\n\n            resolve(sourcePackage);\n          }\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n    /**\r\n       * Returns the sourceCode of a given descriptor\r\n       * @param {CatalogueDataObject} descriptor - Catalogue Object that was retrieved using e.g. getHypertyDescriptor()\r\n       * @returns {Promise}\r\n       */\n\n  }, {\n    key: \"getSourceCodeFromDescriptor\",\n    value: function getSourceCodeFromDescriptor(descriptor) {\n      var _this4 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (descriptor.sourcePackage) {\n          //log.log(\"descriptor has sourcePackage\");\n          //log.log(\"returning sourceCode:\", descriptor.sourcePackage.sourceCode);\n          resolve(descriptor.sourcePackage.sourceCode);\n        } else {\n          _this4.storageManager.getVersion(descriptor.sourcePackageURL + '/sourceCode').then(function (dbVersion) {\n            if (dbVersion >= descriptor.version) {\n              RuntimeCatalogue_log.log('returning cached version from storageManager');\n\n              _this4.storageManager.get(descriptor.sourcePackageURL + '/sourceCode').then(function (sourceCode) {\n                resolve(sourceCode);\n              }).catch(function (reason) {\n                reject(reason);\n              });\n            } else {\n              _this4.httpRequest.get(descriptor.sourcePackageURL + '/sourceCode').then(function (sourceCode) {\n                if (sourceCode['ERROR']) {\n                  // TODO handle error properly\n                  reject(sourceCode);\n                } else {\n                  _this4.storageManager.set(descriptor.sourcePackageURL + '/sourceCode', descriptor.version, sourceCode);\n\n                  resolve(sourceCode);\n                }\n              }).catch(function (reason) {\n                reject(reason);\n              });\n            }\n          }).catch(function (reason) {\n            reject(reason);\n          });\n        }\n      });\n    }\n    /**\r\n       * Returns the list of available catalogue objects for the given \"type URL\",\r\n       * i.e. a catalogue URL that specifies a type, but no catalogue object name.\r\n       * @param typeURL - URL pointing to the catalogue object type you want a list of available objects for,\r\n       * e.g. hyperty-catalogue://catalogue.fokus.fraunhofer.de/.well-known/idp-proxy\r\n       * @param {JSON} constraints - constraints object\r\n       * @returns {Promise} typeListPromise - Promise that fulfills with the list of available catalogue object names for the requested type,\r\n       * rejects on HTTP error or if the HTTP response is not in JSON.\r\n       * If constraints were provided, then the list only contains those objects that meet the constraints\r\n       */\n\n  }, {\n    key: \"getTypeList\",\n    value: function getTypeList(typeURL, constraints) {\n      var _this5 = this;\n\n      return new Promise(function (resolve, reject) {\n        var requestPromise = constraints != undefined ? _this5.httpRequest.post(typeURL, {\n          body: JSON.stringify(constraints)\n        }) : _this5.httpRequest.get(typeURL);\n        requestPromise.then(function (typeList) {\n          typeList = JSON.parse(typeList);\n          resolve(typeList);\n        }).catch(function (reason) {\n          reject(reason);\n        });\n      });\n    }\n  }, {\n    key: \"deleteFromPM\",\n    value: function deleteFromPM(url) {\n      return this.storageManager.delete(url);\n    }\n  }, {\n    key: \"runtimeURL\",\n    set: function set(runtimeURL) {\n      this._runtimeURL = runtimeURL;\n    },\n    get: function get() {\n      return this._runtimeURL;\n    }\n  }]);\n\n  return RuntimeCatalogue;\n}();\n\n/* harmony default export */ var runtime_catalogue_RuntimeCatalogue = (RuntimeCatalogue_RuntimeCatalogue);\n// CONCATENATED MODULE: ./src/runtime/RuntimeUA.js\nfunction RuntimeUA_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction RuntimeUA_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction RuntimeUA_createClass(Constructor, protoProps, staticProps) { if (protoProps) RuntimeUA_defineProperties(Constructor.prototype, protoProps); if (staticProps) RuntimeUA_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n* Copyright 2016 PT Inovação e Sistemas SA\r\n* Copyright 2016 INESC-ID\r\n* Copyright 2016 QUOBIS NETWORKS SL\r\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\r\n* Copyright 2016 ORANGE SA\r\n* Copyright 2016 Deutsche Telekom AG\r\n* Copyright 2016 Apizee\r\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n**/\n // Log System\n\n\nvar RuntimeUA_log = loglevel[\"getLogger\"]('RuntimeUA'); //Main dependecies\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n //import GraphConnector from '../graphconnector/GraphConnector';\n\n\n\n\n\n\n\n\n/**\r\n * Runtime User Agent Interface will process all the dependecies of the core runtime;\r\n * @author Vitor Silva [vitor-t-silva@telecom.pt]\r\n * @version 0.4.0\r\n *\r\n * @property {runtimeFactory} runtimeFactory - Specific implementation for all environments;\r\n * @property {RuntimeCatalogue} runtimeCatalogue - Catalogue of components can be installed;\r\n * @property {runtimeURL} runtimeURL - This identify the core runtime, should be unique;\r\n * @property {IdentityModule} identityModule - Identity Module;\r\n * @property {PEP} policyEngine - Policy Engine Module;\r\n * @property {Registry} registry - Registry Module;\r\n * @property {MessageBus} messageBus - Message Bus is used like a router to redirect the messages from one component to other(s)\r\n * @property {GraphConnector} graphConnector - Graph Connector handling GUID and contacts\r\n * @property {CoreDiscovery} coreDiscovery - Discovery for discovery hyperties/dataObjects\r\n */\n\nvar RuntimeUA_RuntimeUA =\n/*#__PURE__*/\nfunction () {\n  /**\r\n   * Create a new instance of Runtime User Agent\r\n   * @param {descriptor} runtimeDescriptor - pass all the hyperty runtime descriptor\r\n   * @param {runtimeFactory} runtimeFactory - Specific implementation for the environment where the core runtime will run;\r\n   * @param {domain} domainURL - specify the domain base for the runtime;\r\n   */\n  function RuntimeUA(runtimeDescriptor, runtimeFactory, domain) {\n    RuntimeUA_classCallCheck(this, RuntimeUA);\n\n    if (!runtimeDescriptor) throw new Error('The runtime descriptor is a needed parameter');\n    if (!runtimeFactory) throw new Error('The sandbox factory is a needed parameter');\n    if (!domain) throw new Error('You need the domain of runtime'); // Configuration object with information related with servers\n\n    this.runtimeConfiguration = Object.assign({\n      domain: domain\n    }, runtimeConfiguration_runtimeConfiguration);\n    this.runtimeFactory = runtimeFactory;\n    this.log = RuntimeUA_log;\n    this.logLevels = loglevel_default.a;\n\n    if (runtimeDescriptor.p2pHandlerStub && typeof runtimeDescriptor.p2pHandlerStub === 'string' && runtimeDescriptor.p2pHandlerStub.includes('://')) {\n      this.p2p = true;\n    } else {\n      this.p2p = false;\n    }\n\n    runtimeUtils.runtimeDescriptor = runtimeDescriptor;\n    this.runtimeUtils = runtimeUtils;\n    this.storages = {};\n    /*    if (typeof runtimeFactory.createRuntimeCatalogue === 'function') {\r\n          this.runtimeCatalogue = runtimeFactory.createRuntimeCatalogue();\r\n        } else {\r\n          throw new Error('Check your Runtime Factory because it needs the Runtime Catalogue implementation');\r\n        }*/\n\n    this.runtimeCatalogue = new runtime_catalogue_RuntimeCatalogue(runtimeFactory);\n    /*    if (typeof runtimeFactory.persistenceManager === 'function') {\r\n          this.persistenceManager = runtimeFactory.persistenceManager();\r\n        } else {\r\n          throw new Error('Check your Runtime Factory because it needs the Persistence Manager implementation');\r\n        }*/\n\n    if (typeof runtimeFactory.storageManager === 'function') {\n      this.storages = Storage_storage(runtimeFactory, this);\n    } else {\n      throw new Error('Check your Runtime Factory because it needs the Storage Manager implementation');\n    }\n\n    if (typeof runtimeFactory.runtimeCapabilities === 'function') {\n      this.runtimeCapabilities = runtimeFactory.runtimeCapabilities(this.storages.capabilities);\n    } else {\n      RuntimeUA_log.info('Check your RuntimeFactory because it needs the Runtime Capabilities implementation');\n    }\n  }\n  /**\r\n   * Intialize the installation of runtime\r\n   *\r\n   * @access public\r\n   * @return {Promise<Boolean, Error>} this is Promise and if the installation process happened without any problems returns true otherwise the error.\r\n   *\r\n   * @memberOf RuntimeUA\r\n   */\n\n\n  RuntimeUA_createClass(RuntimeUA, [{\n    key: \"init\",\n    value: function init(guid) {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this2.domain = _this2.runtimeConfiguration.domain;\n        RuntimeUA_log.info('[RuntimeUA - init] Starting ');\n\n        try {\n          var getCapabilities = _this2.runtimeCapabilities.getRuntimeCapabilities();\n\n          var getRuntimeURL = _this2.storages.runtime.get('runtime:URL');\n\n          var getStoredDataObjects = _this2.storages.syncherManager.get('syncherManager:ObjectURLs');\n\n          var getHypertyStorageObjects = _this2.storages.hypertyResources.get();\n\n          var getP2PHandlerURL = _this2.storages.runtime.get('p2pHandler:URL'); //        let getRemotes = this.storages.syncherManager.get('remotes');\n\n\n          Promise.all([getRuntimeURL, getCapabilities, getStoredDataObjects, getHypertyStorageObjects, getP2PHandlerURL]).then(function (results) {\n            _this2.runtimeURL = results[0] ? results[0].runtimeURL : results[0];\n\n            if (!_this2.runtimeURL) {\n              _this2.runtimeURL = 'runtime://' + _this2.domain + '/' + generateGUID();\n\n              _this2.storages.runtime.set('runtime:URL', 1, {\n                runtimeURL: _this2.runtimeURL\n              });\n            }\n\n            _this2.capabilities = results[1];\n            Object.assign(runtimeUtils.runtimeCapabilities.constraints, results[1]);\n            _this2._dataObjectsStorage = new store_objects_DataObjectsStorage(_this2.storages.syncherManager, results[2] || {}, _this2.runtimeFactory, _this2);\n            _this2._hypertyResources = results[3] || {};\n            _this2.p2pHandlerURL = results[4] ? results[4].p2pHandlerURL : results[4];\n\n            if (!_this2.p2pHandlerURL) {\n              _this2.p2pHandlerURL = _this2.runtimeURL + '/p2phandler/' + generateGUID();\n              RuntimeUA_log.info('[RuntimeUA - init] P2PHandlerURL: ', _this2.p2pHandlerURL);\n\n              _this2.storages.runtime.set('p2pHandler:URL', 1, {\n                p2pHandlerURL: _this2.p2pHandlerURL\n              });\n            }\n            /*          log.info('[RuntimeUA - init] dataObjectsStorage remote load starting');\r\n                      this._dataObjectsStorage.loadRemote().then(()=> {\r\n                        log.info('[RuntimeUA - init] dataObjectsStorage remote load concluded');*/\n\n\n            return _this2._loadComponents(guid); //          });\n          }).then(function (status) {\n            _this2._hypertyResourcesStorage = new hyperty_resource_HypertyResourcesStorage(_this2.runtimeURL, _this2.messageBus, _this2.storages.hypertyResources, _this2._hypertyResources);\n\n            if (_this2.p2p) {\n              RuntimeUA_log.info('[RuntimeUA - init] load p2pHandler: ', status);\n              return _this2._loadP2PHandler();\n            } else {\n              RuntimeUA_log.info('[RuntimeUA - init] P2P not supported');\n              return 'P2P Not Supported';\n            }\n          }).then(function (result) {\n            RuntimeUA_log.info('[runtime ua - init] - status: ', result);\n            resolve(true);\n          }, function (reason) {\n            RuntimeUA_log.error('ERROR: ', reason);\n            resolve(true);\n          });\n        } catch (e) {\n          reject(e);\n        }\n      });\n    }\n  }, {\n    key: \"_updateRuntimeStatus\",\n    value: function _updateRuntimeStatus(event) {\n      var _this = this;\n\n      _this.messageBus.postMessage({\n        from: this.runtimeURL,\n        to: this.runtimeURL + '/status',\n        type: 'update',\n        body: event\n      });\n    }\n  }, {\n    key: \"_loadP2PHandler\",\n    value: function _loadP2PHandler() {\n      var _this3 = this;\n\n      return new Promise(function (resolve) {\n        var runtimeDescriptor = runtimeUtils.runtimeDescriptor;\n        var p2pStubHandler = runtimeDescriptor.p2pHandlerStub;\n        var p2pConfig = {\n          isHandlerStub: true,\n          runtimeURL: _this3.runtimeURL\n        };\n        RuntimeUA_log.log('[RuntimeUA loadP2PHandler] P2PStubHandler: ', p2pStubHandler);\n\n        _this3.loader.loadStub(p2pStubHandler, p2pConfig).then(function (result) {\n          var runtimeUAURL = _this3.runtimeURL + '/ua';\n          var msg = {\n            type: 'subscribe',\n            from: runtimeUAURL,\n            to: 'domain://msg-node.' + _this3.domain + '/sm',\n            body: {\n              subscribe: [result.url],\n              source: _this3.runtimeURL\n            }\n          };\n\n          _this3.messageBus.addListener(runtimeUAURL, function (msg) {\n            RuntimeUA_log.log('[runtime ua - listener] - receive msg: ', msg);\n          });\n\n          _this3.messageBus.postMessage(msg, function (reply) {\n            RuntimeUA_log.log('[runtime ua - postMessage] - reply: ', reply);\n          });\n\n          RuntimeUA_log.info('[runtime ua - p2p installation] - success: ', result);\n          resolve(true);\n        }).catch(function (reason) {\n          RuntimeUA_log.info('[runtime ua - p2p installation] - fail: ', reason);\n          resolve(false);\n        });\n      });\n    }\n    /**\r\n     *\r\n     * @access private\r\n     * @return {Promise<Boolean, Error>} this is Promise and returns true if all components are loaded with success or an error if someone fails.\r\n     *\r\n     * @memberOf RuntimeUA\r\n     */\n\n  }, {\n    key: \"_loadComponents\",\n    value: function _loadComponents(guid) {\n      var _this4 = this;\n\n      return new Promise(function (resolve, reject) {\n        try {\n          // Prepare the on instance to handle with the fallbacks and runtimeCatalogue;\n          _this4.descriptorInstance = new runtime_Descriptors(_this4.runtimeURL, _this4.runtimeCatalogue, _this4.runtimeConfiguration); // Prepare the loader to load the hyperties, protostubs and idpproxy;\n\n          _this4.loader = new runtime_Loader(_this4.runtimeURL, _this4.runtimeConfiguration, _this4.descriptorInstance); // Instantiate the identity Module\n\n          _this4.identityModule = new identity_IdentityModule(_this4.runtimeURL, _this4.runtimeCapabilities, _this4.storages.identity, _this4._dataObjectsStorage, cryptoManager_CryptoManager, _this4.runtimeCatalogue); // Use the sandbox factory to create an AppSandbox;\n          // In the future can be decided by policyEngine if we need\n          // create a AppSandbox or not;\n\n          var appSandbox = _this4.runtimeFactory.createAppSandbox(); // Instantiate the Registry Module\n\n\n          _this4.registry = new registry_Registry(_this4.runtimeURL, appSandbox, _this4.identityModule, _this4.runtimeCatalogue, _this4.runtimeCapabilities, _this4.storages.registry, _this4.p2pHandlerURL); // Set the loader to load Hyperties, Stubs and IdpProxies\n\n          _this4.registry.loader = _this4.loader; // Instantiate the Message Bus\n\n          _this4.messageBus = new bus_MessageBus(_this4.registry); // Instanciate the SubscriptionManager;\n\n          _this4.subscriptionManager = new subscriptionManager_SubscriptionManager(_this4.runtimeURL, _this4.messageBus, _this4.storages.subscriptions); // Prepare the address allocation instance;\n\n          _this4.addressAllocation = new allocation_AddressAllocation(_this4.runtimeURL, _this4.messageBus, _this4.registry, _this4.subscriptionManager); // Instantiate the Policy Engine\n\n          _this4.policyEngine = new policy_PEP(new context_RuntimeCoreCtx(_this4.runtimeURL, _this4.identityModule, _this4.registry, _this4.storages.policy, _this4.runtimeCapabilities)); // Instantiate Discovery\n\n          _this4.coreDiscovery = new discovery_CoreDiscovery(_this4.runtimeURL, _this4.messageBus, _this4.graphConnector, _this4.runtimeFactory, _this4.registry); // Instantiate the identityHandler\n\n          _this4.identityHandler = new identity_IdentityHandler(_this4.identityModule); // initialise the CryptoManager\n\n          cryptoManager_CryptoManager.init(_this4.runtimeURL, _this4.runtimeCapabilities, _this4.storages.cryptoManager, _this4._dataObjectsStorage, _this4.registry, _this4.coreDiscovery, _this4.identityModule, _this4.runtimeFactory); // Instantiate the Graph Connector\n          //        this.graphConnector = process.env.MODE !== 'light' ? new GraphConnector(this.runtimeURL, this.messageBus, this.storageManager) : null;\n\n          _this4.handlers = new runtime_MsgBusHandlers(_this4.policyEngine, _this4.identityHandler, cryptoManager_CryptoManager); // (un)comment bellow to not encrypt messages\n\n          _this4.messageBus.pipelineOut.handlers = [_this4.handlers.idmHandler, _this4.handlers.pepOutHandler];\n          _this4.messageBus.pipelineIn.handlers = [_this4.handlers.pepInHandler]; // (un)comment bellow to encrypt messages\n          //      this.messageBus.pipelineOut.handlers = [this.handlers.idmHandler, this.handlers.pepOutHandler, this.handlers.encryptHandler];\n          //      this.messageBus.pipelineIn.handlers = [this.handlers.decryptHandler, this.handlers.pepInHandler];\n          // Add to App Sandbox the listener;\n\n          appSandbox.addListener('*', function (msg) {\n            _this4.messageBus.postMessage(msg);\n          });\n          cryptoManager_CryptoManager.messageBus = _this4.messageBus; // Register messageBus on Registry\n\n          _this4.registry.messageBus = _this4.messageBus; // Policy Engine\n\n          _this4.policyEngine.messageBus = _this4.messageBus; // Register messageBus on IDM\n\n          _this4.identityModule.messageBus = _this4.messageBus; // Register registry on IdentityModule\n\n          _this4.identityModule.registry = _this4.registry; // Register coreDiscovery on IdentityModule\n\n          _this4.identityModule.coreDiscovery = _this4.coreDiscovery; // Use sandbox factory to use specific methods\n          // and set the message bus to the factory\n\n          _this4.runtimeFactory.messageBus = _this4.messageBus; // Instanciate the SyncherManager;\n\n          _this4.syncherManager = new syncher_SyncherManager(_this4.runtimeURL, _this4.messageBus, _this4.registry, _this4.runtimeCatalogue, _this4.storages.syncherManager, null, _this4._dataObjectsStorage, _this4.identityModule); // Set into loader the needed components;\n\n          _this4.loader.runtimeURL = _this4.runtimeURL;\n          _this4.loader.messageBus = _this4.messageBus;\n          _this4.loader.registry = _this4.registry;\n          _this4.loader.runtimeCatalogue = _this4.runtimeCatalogue;\n          _this4.loader.runtimeFactory = _this4.runtimeFactory; //Instantiate Discovery Lib for notification testing\n          // this.discovery = new Discovery(\"hyperty://localhost/test\", this.runtimeURL, this.messageBus);\n          // this.loadStub(\"localhost\");\n          // setTimeout(() => {\n          //   this.discovery.discoverHypertiesDO(\"user://google.com/openidtest20@gmail.com\")\n          //   .then(hyperties => {\n          //     hyperties.forEach(hyperty =>{\n          //       hyperty.onLive(() => log.log(`Notification from ${hyperty.data.hypertyID} changed to live`));\n          //       hyperty.onDisconnected(() => log.log(`Notification from ${hyperty.data.hypertyID} changed to disconnected`));\n          //     });\n          //   });\n          // }, 2000);\n          // this.subscriptionManager.init().then(()=>{\n          //   resolve(true);\n          // });\n\n          var prepareComponents = [];\n          prepareComponents.push(_this4.subscriptionManager.init());\n          prepareComponents.push(_this4.identityModule.init(guid));\n          prepareComponents.push(cryptoManager_CryptoManager.loadSessionKeys());\n          prepareComponents.push(_this4.registry.loadRegistry());\n          prepareComponents.push(_this4._dataObjectsStorage.loadRemote());\n          Promise.all(prepareComponents).then(function (result) {\n            if (result.length === 5) {\n              resolve(true);\n            } else {\n              reject('[RuntimeUA._loadComponents] Error ] ', result);\n            }\n          }).catch(function (reason) {\n            throw Error(reason);\n          });\n        } catch (e) {\n          reject(e);\n        }\n      });\n    }\n    /**\r\n     * Deploy Hyperty from Catalogue URL\r\n     *\r\n     * @see https://github.com/reTHINK-project/specs/tree/master/datamodel/core/address\r\n     *\r\n     * @param {URL.HypertyCatalogueURL} hypertyCatalogueURL - The Catalogue URL used to identify descriptors in the Catalogue.\r\n     * @param {boolean|URL.HypertyURL} [reuseURL=false] reuseURL - reuseURL is used to reuse the hypertyURL previously registred, by default the reuse is disabled;\r\n     * @param {URL} appURL - the app url address; // TODO: improve this description;\r\n     * @returns {Promise<Boolean, Error>} this is Promise and returns true if all components are loaded with success or an error if someone fails.\r\n     *\r\n     * @memberOf RuntimeUA\r\n     */\n\n  }, {\n    key: \"loadHyperty\",\n    value: function loadHyperty(hypertyCatalogueURL) {\n      var reuseURL = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var appURL = arguments.length > 2 ? arguments[2] : undefined;\n      if (!hypertyCatalogueURL) throw new Error('Hyperty descriptor url parameter is needed');\n      return this.loader.loadHyperty(hypertyCatalogueURL, reuseURL, appURL);\n    }\n    /**\r\n    * Deploy Stub from Catalogue URL or domain url\r\n    * @param  {URL.URL}     domain          domain\r\n    */\n\n  }, {\n    key: \"loadStub\",\n    value: function loadStub(protocolstubCatalogueURL) {\n      if (!protocolstubCatalogueURL) throw new Error('ProtoStub descriptor url parameter is needed');\n      return this.loader.loadStub(protocolstubCatalogueURL);\n    }\n    /**\r\n    * Deploy idpProxy from Catalogue URL or domain url\r\n    * @param  {URL.URL}     domain          domain\r\n    */\n\n  }, {\n    key: \"loadIdpProxy\",\n    value: function loadIdpProxy(ipdProxyCatalogueURL) {\n      RuntimeUA_log.log('ipdProxyCatalogueURL', ipdProxyCatalogueURL);\n      if (!ipdProxyCatalogueURL) throw new Error('The IDP Proxy URL is a needed parameter, could be a DOMAIN or a URL');\n      return this.loader.loadIdpProxy(ipdProxyCatalogueURL);\n    }\n    /**\r\n     * Used to close all the runtime; Unregister all hyperties;\r\n     * @return {Promise<Boolean>} result of the close method, with true or false to the operation success;\r\n     */\n\n  }, {\n    key: \"close\",\n    value: function close(logOut) {\n      console.log('Runtime core logout: ', logOut);\n\n      var _this = this;\n\n      if (logOut === true) {\n        this.identityHandler.reset();\n      }\n\n      RuntimeUA_log.info('Unregister all hyperties');\n      return new Promise(function (resolve, reject) {\n        _this.registry.unregisterAllHyperties().then(function (result) {\n          RuntimeUA_log.info('All the hyperties are unregisted with Success:', result);\n          resolve(true);\n        }).catch(function (reason) {\n          RuntimeUA_log.error('Failed to unregister the hyperties', reason);\n          reject(false);\n        });\n      });\n    }\n    /**\r\n     * Used to reset the runtime by deleting all data from the storage manager;\r\n     * @return {Promise<Boolean>} result of the reset method, with true or false to the operation success;\r\n     */\n\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      var _this5 = this;\n\n      console.log('RuntimeUA.Runtime core reset: ');\n      var reseting = [];\n\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        //TODO: delegate db reset operation to each component\n        //    this.identityManager.reset();\n        _this5._dataObjectsStorage.deleteRemotes().then(function () {\n          return resolve();\n        }).then(function () {\n          _this5.storages.identity.get(false, false, 'identities').then(function (identities) {\n            var identitiesKeys = Object.keys(identities);\n            identitiesKeys.forEach(function (key) {\n              reseting.push(_this5.storages.identity.delete(key, false, 'identities'));\n            });\n            reseting.push(_this5.storages.capabilities.delete('capabilities'));\n            reseting.push(_this5.storages.cryptoManager.delete('userAsymmetricKey'));\n            reseting.push(_this5.storages.hypertyResources.delete('hypertyResources'));\n            reseting.push(_this5.storages.identity.delete('accessTokens'));\n            reseting.push(_this5.storages.registry.delete('registry:DataObjectURLs'));\n            reseting.push(_this5.storages.registry.delete('registry:HypertyURLs'));\n            reseting.push(_this5.storages.runtime.delete('p2pHandler:URL'));\n            reseting.push(_this5.storages.runtime.delete('runtime:URL')); //    reseting.push(this.storages.runtimeCatalogue.delete('runtimeCatalogue'));\n\n            reseting.push(_this5.storages.subscriptions.delete('subscriptions'));\n            reseting.push(_this5.storages.syncherManager.delete('syncherManager:ObjectURLs'));\n            reseting.push(_this5.storages.syncherManager.delete('remotes'));\n            Promise.all(reseting).then(function (result) {\n              RuntimeUA_log.info('[RuntimeUA.reset] reset with Success:', result);\n              return resolve(true);\n            }).catch(function (reason) {\n              RuntimeUA_log.error('Failed to reset all DBs', reason);\n              resolve(false);\n            });\n          });\n        });\n      });\n    }\n  }]);\n\n  return RuntimeUA;\n}();\n\n/* harmony default export */ var runtime_RuntimeUA = __webpack_exports__[\"default\"] = (RuntimeUA_RuntimeUA);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2xvZ0xldmVscy5qcz83ZDM0Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9ydW50aW1lL3J1bnRpbWVVdGlscy5qcz83YTFhIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy91dGlscy5qcz9mYTdkIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9zeW5jaGVyL1Byb3h5T2JqZWN0LmpzPzRlZWIiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3N5bmNoZXIvRGF0YU9iamVjdENoaWxkLmpzPzIxZTEiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3N5bmNoZXIvSGVhcnRCZWF0LmpzP2IxNjciLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2h5cGVydHktcmVzb3VyY2UvSHlwZXJ0eVJlc291cmNlLmpzP2NjNmMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL0ltYWdlVG9vbHMuanM/MWUwNyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvaHlwZXJ0eS1yZXNvdXJjZS9GaWxlSHlwZXJ0eVJlc291cmNlLmpzPzUzNmYiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2h5cGVydHktcmVzb3VyY2UvSHlwZXJ0eVJlc291cmNlRmFjdG9yeS5qcz9mMDgzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9zeW5jaGVyL0RhdGFPYmplY3QuanM/OWQwMiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3luY2hlci9EYXRhT2JqZWN0UmVwb3J0ZXIuanM/MjNmZiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3luY2hlci9EYXRhT2JqZWN0T2JzZXJ2ZXIuanM/YzVjMyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3luY2hlci9EYXRhUHJvdmlzaW9uYWwuanM/NDA0NyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3luY2hlci9TeW5jaGVyLmpzPzE2ZDgiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3N5bmNoZXIvTm90aWZpY2F0aW9uSGFuZGxlci5qcz8yOGIyIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9pZGVudGl0eS9JZGVudGl0eU1hbmFnZXIuanM/MTYzOCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZGlzY292ZXJ5L1JlZ2lzdHJhdGlvblN0YXR1cy5qcz83Yzg1Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9kaXNjb3ZlcnkvRGlzY292ZXJlZE9iamVjdC5qcz8wMjM5Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9kaXNjb3ZlcnkvRGlzY292ZXJ5LmpzPzRhNDYiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL1NlYXJjaC5qcz9mYzlhIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9FdmVudEVtaXR0ZXIuanM/OGE4YSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29udGV4dE1hbmFnZXIvQ29udGV4dE9ic2VydmVyLmpzP2NjZjAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbnRleHRNYW5hZ2VyL0NvbnRleHRSZXBvcnRlci5qcz8yZGY4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9pZGVudGl0eS9Vc2VyUHJvZmlsZS5qcz81ODU4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9pZGVudGl0eS9NZXNzYWdlQm9keUlkZW50aXR5LmpzPzc1NDkiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NoYXRNYW5hZ2VyL2NvbW11bmljYXRpb24uanM/Mzc5YiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY2hhdE1hbmFnZXIvSW52aXRhdGlvbnNIYW5kbGVyLmpzPzI3ZDAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NoYXRNYW5hZ2VyL0NoYXRDb250cm9sbGVyLmpzPzFkOWIiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NoYXRNYW5hZ2VyL1VzZXJJbmZvLmpzPzU3ZDQiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NoYXRNYW5hZ2VyL0NoYXRNYW5hZ2VyLmpzPzhkYWYiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NoYXRNYW5hZ2VyL0NoYXQuanM/MDBiZCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY2hhdE1hbmFnZXIvU2ltcGxlQ2hhdE1hbmFnZXIuanM/YTk1NSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc2FuZGJveC9TYW5kYm94RmFjdG9yeS5qcz8wYTZhIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9zYW5kYm94L1NhbmRib3hSZWdpc3RyeS5qcz84YmU0Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9idXMvQnVzLmpzPzJlZjIiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2J1cy9NaW5pQnVzLmpzP2Q5YWQiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3NhbmRib3gvU2FuZGJveC5qcz83NTYzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hbGxvY2F0aW9uL0FkZHJlc3NBbGxvY2F0aW9uLmpzPzU2OGQiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlZ2lzdHJ5L1JlZ2lzdHJ5RGF0YU1vZGVsLmpzP2M2OWYiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlZ2lzdHJ5L0h5cGVydHlJbnN0YW5jZS5qcz9hYjZhIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9yZWdpc3RyeS9Eb21haW5SZWdpc3RyYXRpb24uanM/ZWRlMSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVnaXN0cnkvUDJQQ29ubmVjdGlvblJlc29sdmUuanM/NjJiZiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvV2F0Y2hpbmdZb3UuanM/MTExZiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvVXRpbHMuanM/OWM4ZSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVnaXN0cnkvUmVnaXN0cnkuanM/ZDdiZCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcnVudGltZS9ydW50aW1lQ29uZmlndXJhdGlvbi5qcz8wODNkIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9pZGVudGl0eS9JZGVudGl0aWVzLmpzP2M0MjAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2lkZW50aXR5L0d1aUZha2UuanM/OTA3ZSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvaWRlbnRpdHkvSWRlbnRpdHlNb2R1bGUuanM/NGVjNCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvaWRlbnRpdHkvSWRlbnRpdHlIYW5kbGVyLmpzPzMyZjUiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3BvbGljeS9BY3Rpb25zU2VydmljZS5qcz85ZTcyIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9wb2xpY3kvT3BlcmF0b3JzLmpzPzNiMmYiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3BvbGljeS9QRFAuanM/MjJlZCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcG9saWN5L2NvbWJpbmluZ0FsZ29yaXRobXMvQWxsb3dPdmVycmlkZXMuanM/MGQxNyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcG9saWN5L2NvbWJpbmluZ0FsZ29yaXRobXMvQmxvY2tPdmVycmlkZXMuanM/N2Q2NyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcG9saWN5L2NvbWJpbmluZ0FsZ29yaXRobXMvRmlyc3RBcHBsaWNhYmxlLmpzP2ExMzIiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3BvbGljeS9jb25kaXRpb25zL0NvbmRpdGlvbi5qcz8zMzE1Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9wb2xpY3kvY29uZGl0aW9ucy9TdWJzY3JpcHRpb25Db25kaXRpb24uanM/N2UxYiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcG9saWN5L2NvbmRpdGlvbnMvQWR2YW5jZWRDb25kaXRpb24uanM/OWMzMiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcG9saWN5L1J1bGUuanM/NWRkOCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcG9saWN5L1BvbGljeS5qcz9kMWFkIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9wb2xpY3kvUEVQLmpzPzlhMWYiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2J1cy9QaXBlbGluZS5qcz84ZjhiIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9idXMvTWVzc2FnZUJ1cy5qcz85OTViIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jcnlwdG9NYW5hZ2VyL3V0ZjguanM/OWRhZSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY3J5cHRvTWFuYWdlci9DcnlwdG8uanM/OTMzMiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY3J5cHRvTWFuYWdlci9DcnlwdG9NYW5hZ2VyLmpzP2JiNGMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3J1bnRpbWUvTG9hZGVyLmpzP2U4YmQiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3J1bnRpbWUvU3RvcmFnZS5qcz83MzM4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9ydW50aW1lL0Rlc2NyaXB0b3JzLmpzP2M2MmYiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3J1bnRpbWUvTXNnQnVzSGFuZGxlcnMuanM/NzYzNyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZGlzY292ZXJ5L0NvcmVEaXNjb3ZlcnkuanM/YmY3NyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3RvcmUtb2JqZWN0cy9EYXRhT2JqZWN0c1N0b3JhZ2UuanM/ODlkNyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvUHJvbWlzZVF1ZXVlLmpzP2Q4NjIiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2h5cGVydHktcmVzb3VyY2UvSHlwZXJ0eVJlc291cmNlc1N0b3JhZ2UuanM/ZjllOSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3luY2hlci9TdWJzY3JpcHRpb24uanM/Mjg5OSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3luY2hlci9SZXBvcnRlck9iamVjdC5qcz81ZjllIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9zeW5jaGVyL09ic2VydmVyT2JqZWN0LmpzP2FhMzgiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3N5bmNoZXIvU3luY2hlck1hbmFnZXIuanM/NjU5OCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3Vic2NyaXB0aW9uTWFuYWdlci9TdWJzY3JpcHRpb24uanM/Nzk2MCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvc3Vic2NyaXB0aW9uTWFuYWdlci9TdWJzY3JpcHRpb25NYW5hZ2VyLmpzP2QwMjMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3BvbGljeS9SZVRoaW5rQ3R4LmpzP2NjMzEiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3BvbGljeS9jb250ZXh0L1J1bnRpbWVDb3JlQ3R4LmpzPzE2NGQiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3J1bnRpbWUtY2F0YWxvZ3VlL1JldGhpbmtPYmplY3QuanM/YjkwYSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcnVudGltZS1jYXRhbG9ndWUvQ2F0YWxvZ3VlRGF0YU9iamVjdC5qcz9mZTMxIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9ydW50aW1lLWNhdGFsb2d1ZS9Tb3VyY2VQYWNrYWdlLmpzP2FlMjkiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3J1bnRpbWUtY2F0YWxvZ3VlL0h5cGVydHlEZXNjcmlwdG9yLmpzP2VhOWMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3J1bnRpbWUtY2F0YWxvZ3VlL1Byb3RvY29sU3R1YkRlc2NyaXB0b3IuanM/YjBjYiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcnVudGltZS1jYXRhbG9ndWUvSHlwZXJ0eVJ1bnRpbWVEZXNjcmlwdG9yLmpzP2VlMjgiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3J1bnRpbWUtY2F0YWxvZ3VlL0h5cGVydHlJbnRlcmNlcHRvckRlc2NyaXB0b3IuanM/YzY0YiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcnVudGltZS1jYXRhbG9ndWUvRGF0YU9iamVjdFNjaGVtYS5qcz9mMTIzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9ydW50aW1lLWNhdGFsb2d1ZS9DYXRhbG9ndWVEYXRhT2JqZWN0RmFjdG9yeS5qcz82ZTM0Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9ydW50aW1lLWNhdGFsb2d1ZS9SdW50aW1lQ2F0YWxvZ3VlLmpzPzQwYTYiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3J1bnRpbWUvUnVudGltZVVBLmpzPzgwYjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XHJcblxyXG5jb25zdCBhID0gbG9nLmdldExvZ2dlcignYWRkcmVzcy1hbGxvY2F0aW9uJyk7XHJcbmNvbnN0IGIgPSBsb2cuZ2V0TG9nZ2VyKCdCdXMnKTtcclxuY29uc3QgYyA9IGxvZy5nZXRMb2dnZXIoJ01lc3NhZ2VCdXMnKTtcclxuY29uc3QgZCA9IGxvZy5nZXRMb2dnZXIoJ0NvcmVEaXNjb3ZlcnknKTtcclxuY29uc3QgZSA9IGxvZy5nZXRMb2dnZXIoJ1N0b3JhZ2VNYW5hZ2VyJyk7XHJcbmNvbnN0IGYgPSBsb2cuZ2V0TG9nZ2VyKCdIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZScpO1xyXG5jb25zdCBnID0gbG9nLmdldExvZ2dlcignSWRlbnRpdHlNb2R1bGUnKTtcclxuY29uc3QgaCA9IGxvZy5nZXRMb2dnZXIoJ1BFUCcpO1xyXG5jb25zdCBpID0gbG9nLmdldExvZ2dlcignUDJQQ29ubmVjdGlvblJlc29sdmUnKTtcclxuY29uc3QgaiA9IGxvZy5nZXRMb2dnZXIoJ1JlZ2lzdHJ5Jyk7XHJcbmNvbnN0IGsgPSBsb2cuZ2V0TG9nZ2VyKCdSdW50aW1lVUEnKTtcclxuY29uc3QgbCA9IGxvZy5nZXRMb2dnZXIoJ0xvYWRlcicpO1xyXG5jb25zdCBtID0gbG9nLmdldExvZ2dlcignRGVzY3JpcHRvcnMnKTtcclxuY29uc3QgbiA9IGxvZy5nZXRMb2dnZXIoJ0RhdGFPYmplY3RzU3RvcmFnZScpO1xyXG5jb25zdCBvID0gbG9nLmdldExvZ2dlcignU3Vic2NyaXB0aW9uJyk7XHJcbmNvbnN0IHAgPSBsb2cuZ2V0TG9nZ2VyKCdTdWJzY3JpcHRpb25NYW5hZ2VyJyk7XHJcbmNvbnN0IHEgPSBsb2cuZ2V0TG9nZ2VyKCdPYnNlcnZlck9iamVjdCcpO1xyXG5jb25zdCByID0gbG9nLmdldExvZ2dlcignUmVwb3J0ZXJPYmplY3QnKTtcclxuY29uc3QgcyA9IGxvZy5nZXRMb2dnZXIoJ1N5blN1YnNjcmlwdGlvbicpO1xyXG5jb25zdCB0ID0gbG9nLmdldExvZ2dlcignU3luY2hlck1hbmFnZXInKTtcclxuY29uc3QgdSA9IGxvZy5nZXRMb2dnZXIoJ0lkZW50aXR5SGFuZGxlcicpO1xyXG5jb25zdCB2ID0gbG9nLmdldExvZ2dlcignQ3J5cHRvTWFuYWdlcicpO1xyXG5jb25zdCB4ID0gbG9nLmdldExvZ2dlcignUGlwZWxpbmUnKTtcclxuY29uc3QgZjEgPSBsb2cuZ2V0TG9nZ2VyKCdTeW5jaGVyJyk7XHJcbmNvbnN0IGYyID0gbG9nLmdldExvZ2dlcignUnVudGltZUNhdGFsb2d1ZScpO1xyXG5cclxuXHJcbmV4cG9ydCB7IGxvZyB9O1xyXG5cclxuLyoqXHJcbiAgMCBhY3R1YWwgbG9nZ2luZyBtZXRob2RzLCBvcmRlcmVkIGFuZCBhdmFpbGFibGUgYXM6XHJcblxyXG4gICAgICAwIC0gbG9nLnRyYWNlKG1zZylcclxuICAgICAgMSAtIGxvZy5kZWJ1Zyhtc2cpXHJcbiAgICAgIDIgLSBsb2cuaW5mbyhtc2cpXHJcbiAgICAgIDMgLSBsb2cud2Fybihtc2cpXHJcbiAgICAgIDQgLSBsb2cuZXJyb3IobXNnKVxyXG5cclxuICBsb2cubG9nKG1zZykgaXMgYWxzbyBhdmFpbGFibGUsIGFzIGFuIGFsaWFzIGZvciBsb2cuZGVidWcobXNnKSwgdG8gaW1wcm92ZSBjb21wYXRpYmlsaXR5IHdpdGggY29uc29sZSwgYW5kIG1ha2UgbWlncmF0aW9uIGVhc2llci5cclxuXHJcbiAgRXhhY3Qgb3V0cHV0IGZvcm1hdHRpbmcgb2YgdGhlc2Ugd2lsbCBkZXBlbmQgb24gdGhlIGNvbnNvbGUgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGNvbnRleHQgb2YgeW91ciBhcHBsaWNhdGlvbi4gRm9yIGV4YW1wbGUsIG1hbnkgZW52aXJvbm1lbnRzIHdpbGwgaW5jbHVkZSBhIGZ1bGwgc3RhY2sgdHJhY2Ugd2l0aCBhbGwgdHJhY2UoKSBjYWxscywgYW5kIGljb25zIG9yIHNpbWlsYXIgdG8gaGlnaGxpZ2h0IG90aGVyIGNhbGxzLlxyXG5cclxuICBUaGVzZSBtZXRob2RzIHNob3VsZCBuZXZlciBmYWlsIGluIGFueSBlbnZpcm9ubWVudCwgZXZlbiBpZiBubyBjb25zb2xlIG9iamVjdCBpcyBjdXJyZW50bHkgYXZhaWxhYmxlLCBhbmQgc2hvdWxkIGFsd2F5cyBmYWxsIGJhY2sgdG8gYW4gYXZhaWxhYmxlIGxvZyBtZXRob2QgZXZlbiBpZiB0aGUgc3BlY2lmaWMgbWV0aG9kIGNhbGxlZCAoZS5nLiB3YXJuKSBpc24ndCBhdmFpbGFibGUuXHJcblxyXG4gIEJlIGF3YXJlIHRoYXQgYWxsIHRoaXMgbWVhbnMgdGhhdCB0aGVzZSBtZXRob2Qgd29uJ3QgbmVjZXNzYXJpbHkgYWx3YXlzIHByb2R1Y2UgZXhhY3RseSB0aGUgb3V0cHV0IHlvdSBleHBlY3QgaW4gZXZlcnkgZW52aXJvbm1lbnQ7IGxvZ2xldmVsIG9ubHkgZ3VhcmFudGVlcyB0aGF0IHRoZXNlIG1ldGhvZHMgd2lsbCBuZXZlciBleHBsb2RlIG9uIHlvdSwgYW5kIHRoYXQgaXQgd2lsbCBjYWxsIHRoZSBtb3N0IHJlbGV2YW50IG1ldGhvZCBpdCBjYW4gZmluZCwgd2l0aCB5b3VyIGFyZ3VtZW50LiBGaXJlZm94IGlzIGEgbm90YWJsZSBleGFtcGxlIGhlcmU6IGR1ZSB0byBhIGN1cnJlbnQgRmlyZWZveCBidWcgbG9nLnRyYWNlKG1zZykgY2FsbHMgaW4gRmlyZWZveCB3aWxsIHByaW50IG9ubHkgdGhlIHN0YWNrdHJhY2UsIGFuZCB3b24ndCBpbmNsdWRlIGFueSBwYXNzZWQgbWVzc2FnZSBhcmd1bWVudHMuXHJcblxyXG4qL1xyXG5cclxuXHJcbi8vIGFkZHJlc3MtYWxsb2NhdGlvblxyXG5hLnNldExldmVsKDApO1xyXG5cclxuLy8gQnVzXHJcbmIuc2V0TGV2ZWwoMyk7XHJcblxyXG4vLyBNZXNzYWdlQnVzXHJcbmMuc2V0TGV2ZWwoMyk7XHJcblxyXG4vLyBDb3JlRGlzY292ZXJ5XHJcbmQuc2V0TGV2ZWwoNSk7XHJcblxyXG4vLyBTdG9yYWdlTWFuYWdlclxyXG5lLnNldExldmVsKDApO1xyXG5cclxuLy8gSHlwZXJ0eVJlc291cmNlc1N0b3JhZ2VcclxuZi5zZXRMZXZlbCgzKTtcclxuXHJcbi8vIElkZW50aXR5TW9kdWxlXHJcbmcuc2V0TGV2ZWwoMCk7XHJcblxyXG4vLyBQRVBcclxuaC5zZXRMZXZlbCgzKTtcclxuXHJcbi8vIFAyUENvbm5lY3Rpb25SZXNvbHZlXHJcbmkuc2V0TGV2ZWwoMyk7XHJcblxyXG4vLyBSZWdpc3RyeVxyXG5qLnNldExldmVsKDApO1xyXG5cclxuLy8gUnVudGltZVVBXHJcbmsuc2V0TGV2ZWwoMCk7XHJcblxyXG4vLyBMb2FkZXJcclxubC5zZXRMZXZlbCgwKTtcclxuXHJcbi8vIERlc2NyaXB0b3JzXHJcbm0uc2V0TGV2ZWwoMyk7XHJcblxyXG4vLyBEYXRhT2JqZWN0c1N0b3JhZ2Vcclxubi5zZXRMZXZlbCgwKTtcclxuXHJcbi8vIFN1YnNjcmlwdGlvblxyXG5vLnNldExldmVsKDMpO1xyXG5cclxuLy8gU3Vic2NyaXB0aW9uTWFuYWdlclxyXG5wLnNldExldmVsKDMpO1xyXG5cclxuLy8gT2JzZXJ2ZXJPYmplY3RcclxucS5zZXRMZXZlbCgwKTtcclxuXHJcbi8vIFJlcG9ydGVyT2JqZWN0XHJcbnIuc2V0TGV2ZWwoMCk7XHJcblxyXG4vLyBTeW5TdWJzY3JpcHRpb25cclxucy5zZXRMZXZlbCgzKTtcclxuXHJcbi8vIFN5bmNoZXJNYW5hZ2VyXHJcbnQuc2V0TGV2ZWwoMCk7XHJcblxyXG4vLyBJZGVudGl0eUhhbmRsZXJcclxudS5zZXRMZXZlbCgzKTtcclxuXHJcbi8vIENyeXB0b01hbmFnZXJcclxudi5zZXRMZXZlbCgwKTtcclxuXHJcbi8vIFBpcGVsaW5lXHJcbnguc2V0TGV2ZWwoMCk7XHJcblxyXG4vLyBTeW5jaGVyXHJcbmYxLnNldExldmVsKDApO1xyXG5cclxuLy8gU3luY2hlciBEYXRhT2JqZWN0T2JzZXJ2ZXJcclxuZjEuc2V0TGV2ZWwoMCk7XHJcblxyXG4vLyBSdW50aW1lQ2F0YWxvZ3VlXHJcbmYyLnNldExldmVsKDApO1xyXG4iLCJleHBvcnQgbGV0IHJ1bnRpbWVVdGlscyA9IHtcclxuICBydW50aW1lRGVzY3JpcHRvcjoge30sXHJcbiAgcnVudGltZUNhcGFiaWxpdGllczoge1xyXG4gICAgY29uc3RyYWludHM6IHt9XHJcbiAgfVxyXG59O1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcbi8qKlxyXG4gKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsXHJcbiAqIEBtb2R1bGUgdXRpbHNcclxuICovXHJcblxyXG4vKipcclxuICogQHR5cGVkZWYgZGl2aWRlVVJMXHJcbiAqIEB0eXBlIE9iamVjdFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBvZiBVUkxcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG9mIFVSTFxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTFxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHlcclxuICogQHBhcmFtICB7VVJMLlVSTH0gdXJsIC0gdXJsIGFkZHJlc3NcclxuICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHtcclxuXHJcbiAgZnVuY3Rpb24gcmVjdXJzZSh2YWx1ZSkge1xyXG4gICAgY29uc3QgcmVnZXggPSAvKFthLXpBLVotXSopKDpcXC9cXC8oPzpcXC4pP3w6KShbLWEtekEtWjAtOUA6JS5fK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fK34jPS9dKikvZ2k7XHJcbiAgICBjb25zdCBzdWJzdCA9ICckMSwkMywkNCc7XHJcbiAgICBsZXQgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTtcclxuICAgIHJldHVybiBwYXJ0cztcclxuICB9XHJcblxyXG4gIGxldCBwYXJ0cyA9IHJlY3Vyc2UodXJsKTtcclxuXHJcbiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lXHJcbiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHtcclxuXHJcbiAgICBsZXQgcmVzdWx0ID0ge1xyXG4gICAgICB0eXBlOiAnJyxcclxuICAgICAgZG9tYWluOiB1cmwsXHJcbiAgICAgIGlkZW50aXR5OiAnJ1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zb2xlLndhcm4oJ1tEaXZpZGVVUkxdIERpdmlkZVVSTCBkb25cXCd0IHN1cHBvcnQgdXJsIHdpdGhvdXQgc2NoZW1lLiBQbGVhc2UgcmV2aWV3IHlvdXIgdXJsIGFkZHJlc3MnLCB1cmwpO1xyXG5cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICAvLyBjaGVjayBpZiB0aGUgdXJsIGhhcyB0aGUgc2NoZW1lIGFuZCBpbmNsdWRlcyBhbiBAXHJcbiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgcGFydHNbMF0uaW5jbHVkZXMoJ0AnKSkge1xyXG4gICAgbGV0IHNjaGVtZSA9IHBhcnRzWzBdID09PSB1cmwgPyAnc210cCcgOiBwYXJ0c1swXTtcclxuICAgIHBhcnRzID0gcmVjdXJzZShzY2hlbWUgKyAnOi8vJyArIHBhcnRzWzBdKTtcclxuICB9XHJcblxyXG4gIC8vIGlmIHRoZSBkb21haW4gaW5jbHVkZXMgYW4gQCwgZGl2aWRlIGl0IHRvIGRvbWFpbiBhbmQgaWRlbnRpdHkgcmVzcGVjdGl2ZWx5XHJcbiAgaWYgKHBhcnRzWzFdLmluY2x1ZGVzKCdAJykpIHtcclxuICAgIHBhcnRzWzJdID0gcGFydHNbMF0gKyAnOi8vJyArIHBhcnRzWzFdO1xyXG4gICAgcGFydHNbMV0gPSBwYXJ0c1sxXS5zdWJzdHIocGFydHNbMV0uaW5kZXhPZignQCcpICsgMSk7XHJcbiAgfSBcdC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkge1xyXG4gICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTtcclxuICB9Ki9cclxuXHJcbiAgbGV0IHJlc3VsdCA9IHtcclxuICAgIHR5cGU6IHBhcnRzWzBdLFxyXG4gICAgZG9tYWluOiBwYXJ0c1sxXSxcclxuICAgIGlkZW50aXR5OiBwYXJ0c1syXVxyXG4gIH07XHJcblxyXG4gIHJldHVybiByZXN1bHQ7XHJcblxyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgYW4gT2JqZWN0IGlzIGVtcHR5XHJcbiAqIEBwYXJhbSAge09iamVjdH0gb2JqZWN0IE9iamVjdCB0byBiZSBjaGVja2VkXHJcbiAqIEByZXR1cm4ge0Jvb2xlYW59ICAgICAgIHN0YXR1cyBvZiBPYmplY3QsIGVtcHR5IG9yIG5vdCAodHJ1ZXxmYWxzZSk7XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZW1wdHlPYmplY3Qob2JqZWN0KSB7XHJcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNlY29uZHNTaW5jZUVwb2NoKCkge1xyXG4gIHJldHVybiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YVxyXG4gKiBAcGFyYW0gIHtPYmplY3R9ICBvYmogLSBvYmplY3QgdG8gYmUgY2xvbmVkXHJcbiAqIEByZXR1cm4ge09iamVjdH1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWVwQ2xvbmUob2JqKSB7XHJcbiAgLy9UT0RPOiBzaW1wbGUgYnV0IGluZWZmaWNpZW50IEpTT04gZGVlcCBjbG9uZS4uLlxyXG4gIGlmIChvYmopIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlUGF0aEZyb21VUkwodXJsKSB7XHJcbiAgbGV0IHNwbGl0VVJMID0gdXJsLnNwbGl0KCcvJyk7XHJcbiAgcmV0dXJuIHNwbGl0VVJMWzBdICsgJy8vJyArIHNwbGl0VVJMWzJdICsgJy8nICsgc3BsaXRVUkxbM107XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWxcclxuICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWxcclxuICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyVVJMRnJvbUVtYWlsKHVzZXJFbWFpbCkge1xyXG4gIGxldCBpbmRleE9mQXQgPSB1c2VyRW1haWwuaW5kZXhPZignQCcpO1xyXG4gIHJldHVybiAndXNlcjovLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKGluZGV4T2ZBdCArIDEsIHVzZXJFbWFpbC5sZW5ndGgpICsgJy8nICsgdXNlckVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpO1xyXG59XHJcblxyXG4vKipcclxuICogT2J0YWlucyB0aGUgdXNlciBlbWFpbCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gVVJMXHJcbiAqIEBwYXJhbSAge1VSTC5VUkx9IHVzZXJVUkwgVGhlIHVzZXIgVVJMXHJcbiAqIEByZXR1cm4ge3N0cmluZ30gdXNlckVtYWlsIFRoZSB1c2VyIGVtYWlsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXNlckVtYWlsRnJvbVVSTCh1c2VyVVJMKSB7XHJcbiAgbGV0IHVybCA9IGRpdmlkZVVSTCh1c2VyVVJMKTtcclxuICByZXR1cm4gdXJsLmlkZW50aXR5LnJlcGxhY2UoJy8nLCAnJykgKyAnQCcgKyB1cmwuZG9tYWluOyAvLyBpZGVudGl0eSBmaWVsZCBoYXMgJy9leGFtcGxlSUQnIGluc3RlYWQgb2YgJ2V4YW1wbGVJRCdcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHRoZSB1c2VyIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgVVJMIGZvcm1hdCwgaWYgbm90LCBjb252ZXJ0IHRvIFVSTCBmb3JtYXRcclxuICogQHBhcmFtICB7c3RyaW5nfSAgIGlkZW50aWZpZXIgIHVzZXIgaWRlbnRpZmllclxyXG4gKiBAcmV0dXJuIHtzdHJpbmd9ICAgdXNlclVSTCAgICB0aGUgdXNlciBVUkxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHtcclxuXHJcbiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdFxyXG4gIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7XHJcbiAgICBsZXQgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTtcclxuXHJcbiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZFxyXG4gICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHtcclxuICAgICAgcmV0dXJuIGlkZW50aWZpZXI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7XHJcbiAgICB9XHJcblxyXG4gIC8vaWYgbm90LCBjb252ZXJ0IHRoZSB1c2VyIGVtYWlsIHRvIFVSTCBmb3JtYXRcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIGdldFVzZXJVUkxGcm9tRW1haWwoaWRlbnRpZmllcik7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNEYXRhT2JqZWN0VVJMKHVybCkge1xyXG4gIGxldCBzY2hlbWFzVG9JZ25vcmUgPSBbJ2RvbWFpbi1pZHAnLCAncnVudGltZScsICdkb21haW4nLCAnaHlwZXJ0eSddO1xyXG4gIGxldCBzcGxpdFVSTCA9ICh1cmwpLnNwbGl0KCc6Ly8nKTtcclxuICBsZXQgdXJsU2NoZW1hID0gc3BsaXRVUkxbMF07XHJcblxyXG4gIHJldHVybiBzY2hlbWFzVG9JZ25vcmUuaW5kZXhPZih1cmxTY2hlbWEpID09PSAtMTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzTGVnYWN5KHVybCkge1xyXG4gIGlmICh1cmwuc3BsaXQoJ0AnKS5sZW5ndGggPiAxKSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzVVJMKHVybCkge1xyXG4gIHJldHVybiAodXJsKS5zcGxpdCgnLycpLmxlbmd0aCA+PSAzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNVc2VyVVJMKHVybCkge1xyXG4gIHJldHVybiBkaXZpZGVVUkwodXJsKS50eXBlID09PSAndXNlcic7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0h5cGVydHlVUkwodXJsKSB7XHJcbiAgcmV0dXJuIGRpdmlkZVVSTCh1cmwpLnR5cGUgPT09ICdoeXBlcnR5JztcclxufVxyXG5cclxuLyoqXHJcbiAqIGdldCBpbmZvcm1hdGlvbiByZWxhdGl2ZSBlYWNoIGNvbXBvbmVudCBjb25maWd1cmVkIG9uIHJ1bnRpbWUgY29uZmlndXJhdGlvbjtcclxuICogQHBhcmFtICB7b2JqZWN0fSBjb25maWd1cmF0aW9uIG9iamVjdCB3aXRoIGFsbCBjb25maWd1cmF0aW9uXHJcbiAqIEBwYXJhbSAge3N0cmluZ30gY29tcG9uZW50ICAgICBzdHJpbmcgd2l0aCB0aGUgY29tcG9uZW50IHRvIGdldCB0aGUgY29uZmlndXJhdGlvbiwgbGlrZSwgcnVudGltZVVSTFMsIGNhdGFsb2d1ZVVSTHMsIG1zZ05vZGVVUkwsIGRvbWFpblJlZ2lzdHJ5VVJMO1xyXG4gKiBAcGFyYW0gIHtzdHJpbmd9IHJlc291cmNlICAgICAgdHlwZSBvZiByZXNvdXJjZSB0byBnZXQsIGxpa2UsIGNhdGFsb2d1ZSwgcnVudGltZVVBLCBwcm90b2NvbHN0dWIsIGlkcFByb3h5XHJcbiAqIEByZXR1cm4ge29iamVjdH0gICAgICAgICAgICAgICByZXR1cm4gYW4gb2JqZWN0IHdpdGggYWxsIGNvbmZpZ3VyYXRpb25zO1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbmZpZ3VyYXRpb25SZXNvdXJjZXMoY29uZmlndXJhdGlvbiwgY29tcG9uZW50LCByZXNvdXJjZSkge1xyXG4gIGxldCBvYmplY3RSZXNvdXJjZSA9IGNvbmZpZ3VyYXRpb25bY29tcG9uZW50XTtcclxuICBsZXQgcmVzb3VyY2VUeXBlID0gb2JqZWN0UmVzb3VyY2VbcmVzb3VyY2VdO1xyXG5cclxuICByZXR1cm4gcmVzb3VyY2VUeXBlO1xyXG59XHJcblxyXG4vKipcclxuICogQnVpbGQgYSBmdWxsIHVybCB3aXRoIHRoZSBydW50aW1lIGNvbmZpZ3VyYXRpb247XHJcbiAqIEBwYXJhbSAge29iamVjdH0gY29uZmlndXJhdGlvbiBvYmplY3Qgd2l0aCBhbGwgY29uZmlndXJhdGlvblxyXG4gKiBAcGFyYW0gIHtzdHJpbmd9IGNvbXBvbmVudCAgICAgc3RyaW5nIHdpdGggdGhlIGNvbXBvbmVudCB0byBnZXQgdGhlIGNvbmZpZ3VyYXRpb24sIGxpa2UsIHJ1bnRpbWVVUkxTLCBjYXRhbG9ndWVVUkxzLCBtc2dOb2RlVVJMLCBkb21haW5SZWdpc3RyeVVSTDtcclxuICogQHBhcmFtICB7c3RyaW5nfSByZXNvdXJjZSAgICAgIHR5cGUgb2YgcmVzb3VyY2UgdG8gZ2V0LCBsaWtlLCBjYXRhbG9ndWUsIHJ1bnRpbWVVQSwgcHJvdG9jb2xzdHViLCBpZHBQcm94eVxyXG4gKiBAcGFyYW0gIHtzdHJpbmd9IHR5cGUgICAgICAgICAgcmVzb3VyY2UgdG8gZ2V0LCBsaWtlIGEgaHlwZXJ0eSBuYW1lIG9yIHByb3RvY29sc3R1YiBuYW1lO1xyXG4gKiBAcGFyYW0gIHtib29sZWFufSB1c2VGYWxsYmFjayAgaWYgdHJ1ZSB0aGUgZnVuY3Rpb24gd2lsbCBjaGVjayBpZiBoYXZlIGEgZmFsbGJhY2sgdXJsO1xyXG4gKiBAcmV0dXJuIHtzdHJpbmd9ICAgICAgICAgICAgICAgcGFydGlhbCB1cmwgdG8gY29udGFjdCB0aGUgcmVzb3VyY2U7XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRVUkwoY29uZmlndXJhdGlvbiwgY29tcG9uZW50LCByZXNvdXJjZSwgdHlwZSwgdXNlRmFsbGJhY2sgPSBmYWxzZSkge1xyXG4gIGxldCBvYmplY3RSZXNvdXJjZSA9IGNvbmZpZ3VyYXRpb25bY29tcG9uZW50XTtcclxuICBsZXQgdXJsO1xyXG5cclxuICBpZiAoIW9iamVjdFJlc291cmNlLmhhc093blByb3BlcnR5KHJlc291cmNlKSkge1xyXG4gICAgdGhyb3cgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uICcgKyBKU09OLnN0cmluZ2lmeShvYmplY3RSZXNvdXJjZSwgJycsIDIpICsgJyBkb25cXCd0IGhhdmUgdGhlICcgKyByZXNvdXJjZSArICcgcmVzb3VyY2UgeW91IGFyZSBsb29raW5nIGZvcicpO1xyXG4gIH1cclxuXHJcbiAgbGV0IHJlc291cmNlVHlwZSA9IG9iamVjdFJlc291cmNlW3Jlc291cmNlXTtcclxuXHJcbiAgaWYgKHR5cGUpIHtcclxuICAgIHVybCA9IHJlc291cmNlVHlwZS5wcmVmaXggKyBjb25maWd1cmF0aW9uLmRvbWFpbiArIHJlc291cmNlVHlwZS5zdWZmaXggKyB0eXBlO1xyXG4gICAgaWYgKHJlc291cmNlVHlwZS5oYXNPd25Qcm9wZXJ0eSgnZmFsbGJhY2snKSAmJiB1c2VGYWxsYmFjaykge1xyXG4gICAgICBpZiAocmVzb3VyY2VUeXBlLmZhbGxiYWNrLmluZGV4T2YoJyVkb21haW4lJykpIHtcclxuICAgICAgICB1cmwgPSByZXNvdXJjZVR5cGUuZmFsbGJhY2sucmVwbGFjZSgvKCVkb21haW4lKS9nLCBjb25maWd1cmF0aW9uLmRvbWFpbikgKyB0eXBlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHVybCA9IHJlc291cmNlVHlwZS5mYWxsYmFjayArIHR5cGU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9IGVsc2Uge1xyXG4gICAgdXJsID0gcmVzb3VyY2VUeXBlLnByZWZpeCArIGNvbmZpZ3VyYXRpb24uZG9tYWluICsgcmVzb3VyY2VUeXBlLnN1ZmZpeDtcclxuICB9XHJcblxyXG4gIC8vIGNvbnNvbGUubG9nKHVybCk7XHJcblxyXG4gIHJldHVybiB1cmw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZSBhIEdsb2JhbCBVbmlxdWUgSURcclxuICpcclxuICogQHJldHVybnMgU3RyaW5nO1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlR1VJRCgpIHtcclxuXHJcbiAgZnVuY3Rpb24gczQoKSB7XHJcbiAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcclxuICAgICAgLnRvU3RyaW5nKDE2KVxyXG4gICAgICAuc3Vic3RyaW5nKDEpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xyXG5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFVzZXJJZGVudGl0eURvbWFpbih1cmwpIHtcclxuICBsZXQgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTCh1cmwpO1xyXG4gIGxldCBzcGxpdGVkRG9tYWluID0gZGl2aWRlZFVSTC5kb21haW4uc3BsaXQoJy4nKTtcclxuICBsZXQgc3BsaXRlZExlbmd0aCA9IHNwbGl0ZWREb21haW4ubGVuZ3RoO1xyXG4gIGlmIChzcGxpdGVkTGVuZ3RoID09IDEpIHtcclxuICAgIHJldHVybiBzcGxpdGVkRG9tYWluW3NwbGl0ZWRMZW5ndGggLSAxXTtcclxuICB9XHJcbiAgbGV0IGRvbWFpbiA9IHNwbGl0ZWREb21haW5bc3BsaXRlZExlbmd0aCAtIDJdICsgJy4nICsgc3BsaXRlZERvbWFpbltzcGxpdGVkTGVuZ3RoIC0gMV07XHJcbiAgcmV0dXJuIGRvbWFpbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIFVSTCBpcyBmcm9tIGEgYmFja2VuZCBzZXJ2aWNlXHJcbiAqIEBwYXJhbSAge3N0cmluZ30gdXJsICAgICBVUkwgdG8gYmUgcHJvY2Vzc2VkXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XHJcbiAqL1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQmFja2VuZFNlcnZpY2VVUkwodXJsKSB7XHJcbiAgbGV0IGRpdmlkZWRVUkwgPSBkaXZpZGVVUkwodXJsKTtcclxuICBsZXQgc3BsaXRlZERvbWFpbiA9IGRpdmlkZWRVUkwuZG9tYWluLnNwbGl0KCcuJyk7XHJcbiAgbGV0IGJhY2tlbmRTY2hlbWVzID0gWydkb21haW4nLCAnZ2xvYmFsJywgJ2RvbWFpbi1pZHAnXTsgLy8gc2hvdWxkIGJlIGRlZmluZWQgaW4gdGhlIHJ1bnRpbWUgY29uZmlndXJhdGlvblxyXG4gIGxldCBiYWNrZW5kU3ViRG9tYWlucyA9IFsncmVnaXN0cnknLCAnbXNnLW5vZGUnXTsgLy8gc2hvdWxkIGJlIGRlZmluZWQgaW4gdGhlIHJ1bnRpbWUgY29uZmlndXJhdGlvblxyXG4gIGxldCBzdWJEb21haW47XHJcblxyXG4gIGlmIChzcGxpdGVkRG9tYWluLmxlbmd0aCA+IDEpIHtcclxuICAgIHN1YkRvbWFpbiA9IHNwbGl0ZWREb21haW4uZmlsdGVyKGl0ZW0gPT4gYmFja2VuZFN1YkRvbWFpbnMuaW5kZXhPZihpdGVtKSAhPT0gLTEpWzBdO1xyXG4gIH1cclxuXHJcbiAgaWYgKHN1YkRvbWFpbiAmJiBiYWNrZW5kU3ViRG9tYWlucy5pbmRleE9mKHN1YkRvbWFpbikgIT09IC0xKSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIGlmIChkaXZpZGVkVVJMLnR5cGUpIHtcclxuICAgIHJldHVybiAoYmFja2VuZFNjaGVtZXMuaW5kZXhPZihkaXZpZGVkVVJMLnR5cGUpICE9PSAtMSk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkaXZpZGVFbWFpbChlbWFpbCkge1xyXG4gIGxldCBpbmRleE9mQXQgPSBlbWFpbC5pbmRleE9mKCdAJyk7XHJcblxyXG4gIGxldCByZXN1bHQgPSB7XHJcbiAgICB1c2VybmFtZTogZW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCksXHJcbiAgICBkb21haW46IGVtYWlsLnN1YnN0cmluZyhpbmRleE9mQXQgKyAxLCBlbWFpbC5sZW5ndGgpXHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhc3NpZ24ob2JqLCBrZXlQYXRoLCB2YWx1ZSkge1xyXG5cclxuICBpZiAoIW9iaikgb2JqID0ge307XHJcbiAgaWYgKHR5cGVvZihrZXlQYXRoKSA9PT0gJ3N0cmluZycpIGtleVBhdGggPSBwYXJzZUF0dHJpYnV0ZXMoa2V5UGF0aCk7XHJcblxyXG4gIGxldCBsYXN0S2V5SW5kZXggPSBrZXlQYXRoLmxlbmd0aCAtIDE7XHJcblxyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGFzdEtleUluZGV4OyArK2kpIHtcclxuICAgIGxldCBrZXkgPSBrZXlQYXRoW2ldO1xyXG4gICAgaWYgKCEoa2V5IGluIG9iaikpIHtcclxuICAgICAgb2JqW2tleV0gPSB7fTtcclxuICAgIH1cclxuXHJcbiAgICBvYmogPSBvYmpba2V5XTtcclxuXHJcbiAgfVxyXG5cclxuICBvYmpba2V5UGF0aFtsYXN0S2V5SW5kZXhdXSA9IHZhbHVlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc3BsaXRPYmplY3RVUkwoZGF0YU9iamVjdFVSTCkge1xyXG4gIGNvbnNvbGUuaW5mbygnW3V0aWxzIC0gc3BsaXRPYmplY3RVUkxdOiAnLCBkYXRhT2JqZWN0VVJMKTtcclxuXHJcbiAgbGV0IHNwbGl0ZWRVUkwgPSBkYXRhT2JqZWN0VVJMLnNwbGl0KCcvJyk7XHJcbiAgbGV0IHVybCA9IHNwbGl0ZWRVUkxbMF0gKyAnLy8nICsgc3BsaXRlZFVSTFsyXSArICcvJyArIHNwbGl0ZWRVUkxbM107XHJcbiAgbGV0IHJlc291cmNlID0gc3BsaXRlZFVSTFs1XTtcclxuXHJcbiAgbGV0IHJlc3VsdCA9IHtcclxuICAgIHVybDogdXJsLFxyXG4gICAgcmVzb3VyY2U6IHJlc291cmNlXHJcbiAgfTtcclxuXHJcbiAgY29uc29sZS5pbmZvKCdbdXRpbHMgLSBzcGxpdE9iamVjdFVSTF06ICcsIHJlc3VsdCk7XHJcblxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja0F0dHJpYnV0ZShwYXRoKSB7XHJcblxyXG4gIGxldCByZWdleCA9IC8oKChbYS16QS1aXSspOlxcL1xcLyhbMC05YS16QS1aXVstXFx3XSpbMC05YS16QS1aXVxcLikrW2EtekEtWl17Miw5fSlcXC9bYS16QS1aMC05Ll0rQFthLXpBLVowLTldKygtKT9bYS16QS1aMC05XSsoXFwuKT9bYS16QS1aMC05XXsyLDEwfT9cXC5bYS16QS1aXXsyLDEwfSkoLisoPz0uaWRlbnRpdHkpKT8vZ207XHJcblxyXG4gIGxldCBsaXN0ID0gW107XHJcbiAgbGV0IGZpbmFsID0gW107XHJcbiAgbGV0IHRlc3QgPSBwYXRoLm1hdGNoKHJlZ2V4KTtcclxuXHJcbiAgaWYgKHRlc3QgPT0gbnVsbCkge1xyXG4gICAgZmluYWwgPSBwYXRoLnNwbGl0KCcuJyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGxldCBtO1xyXG4gICAgd2hpbGUgKChtID0gcmVnZXguZXhlYyhwYXRoKSkgIT09IG51bGwpIHtcclxuICAgICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgdG8gYXZvaWQgaW5maW5pdGUgbG9vcHMgd2l0aCB6ZXJvLXdpZHRoIG1hdGNoZXNcclxuICAgICAgaWYgKG0uaW5kZXggPT09IHJlZ2V4Lmxhc3RJbmRleCkge1xyXG4gICAgICAgIHJlZ2V4Lmxhc3RJbmRleCsrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBUaGUgcmVzdWx0IGNhbiBiZSBhY2Nlc3NlZCB0aHJvdWdoIHRoZSBgbWAtdmFyaWFibGUuXHJcbiAgICAgIG0uZm9yRWFjaCgobWF0Y2gsIGdyb3VwSW5kZXgpID0+IHtcclxuICAgICAgICBpZiAoZ3JvdXBJbmRleCA9PT0gMCkge1xyXG4gICAgICAgICAgbGlzdC5wdXNoKG1hdGNoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgbGV0IHJlc3VsdDtcclxuICAgIGxpc3QuZm9yRWFjaCgodXJsKSA9PiB7XHJcblxyXG4gICAgICByZXN1bHQgPSBwYXRoLnJlcGxhY2UodXJsLCAnKi0qJyk7XHJcbiAgICAgIGZpbmFsID0gcmVzdWx0LnNwbGl0KCcuJykubWFwKChpdGVtKSA9PiB7XHJcblxyXG4gICAgICAgIGlmIChpdGVtID09PSAnKi0qJykgeyByZXR1cm4gdXJsOyB9XHJcblxyXG4gICAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc29sZS5sb2coJ1tSdW50aW1lQ29yZS5VdGlscy5jaGVja0F0dHJpYnV0ZV0nLCBmaW5hbCk7XHJcbiAgcmV0dXJuIGZpbmFsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VBdHRyaWJ1dGVzKHBhdGgpIHtcclxuICBsZXQgcmVnZXggPSAvKFswLTlhLXpBLVpdWy1cXHddKik6XFwvXFwvL2c7XHJcblxyXG4gIGxldCBzdHJpbmczID0gJ2lkZW50aXR5JztcclxuXHJcbiAgaWYgKCFwYXRoLmluY2x1ZGVzKCc6Ly8nKSkge1xyXG4gICAgcmV0dXJuIChwYXRoLnNwbGl0KCcuJykpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBsZXQgc3RyaW5nMSA9IHBhdGguc3BsaXQocmVnZXgpWzBdO1xyXG5cclxuICAgIGxldCBhcnJheTEgPSBzdHJpbmcxLnNwbGl0KCcuJyk7XHJcblxyXG4gICAgbGV0IHN0cmluZzIgPSBwYXRoLnJlcGxhY2Uoc3RyaW5nMSwgJycpO1xyXG5cclxuICAgIGlmIChwYXRoLmluY2x1ZGVzKHN0cmluZzMpKSB7XHJcblxyXG4gICAgICBsZXQgYXJyYXkyID0gc3RyaW5nMi5zcGxpdChzdHJpbmczICsgJy4nKTtcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCdhcnJheTIgJyArIGFycmF5Mik7XHJcblxyXG4gICAgICBzdHJpbmcyID0gYXJyYXkyWzBdLnNsaWNlKCcuJywgLTEpO1xyXG5cclxuICAgICAgYXJyYXkyID0gYXJyYXkyWzFdLnNwbGl0KCcuJyk7XHJcblxyXG4gICAgICBhcnJheTEucHVzaChzdHJpbmcyLCBzdHJpbmczKTtcclxuXHJcbiAgICAgIGFycmF5MSA9IGFycmF5MS5jb25jYXQoYXJyYXkyKTtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhcnJheTEucHVzaChzdHJpbmcyKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIChhcnJheTEuZmlsdGVyKEJvb2xlYW4pKTtcclxuXHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzRW1wdHkob2JqKSB7XHJcbiAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcclxuXHJcbiAgICBpZiAob2JqLmhhc093blByb3BlcnR5KHByb3ApKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKSA9PT0gSlNPTi5zdHJpbmdpZnkoe30pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hhdGtleXNUb1N0cmluZ0Nsb25lcihzZXNzaW9uS2V5cykge1xyXG4gIGxldCBkYXRhT2JqZWN0U2Vzc2lvbktleXNDbG9uZSA9IHt9O1xyXG4gIGxldCBmaWVsZHMgPSBPYmplY3Qua2V5cyhzZXNzaW9uS2V5cyk7XHJcbiAgaWYgKGZpZWxkcykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAgZmllbGRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGZpZWxkID0gZmllbGRzW2ldO1xyXG4gICAgICAgIGRhdGFPYmplY3RTZXNzaW9uS2V5c0Nsb25lW2ZpZWxkXSA9IHt9O1xyXG4gICAgICAgIGRhdGFPYmplY3RTZXNzaW9uS2V5c0Nsb25lW2ZpZWxkXS5zZXNzaW9uS2V5ID0gc2Vzc2lvbktleXNbZmllbGRdLnNlc3Npb25LZXkudG9TdHJpbmcoKTtcclxuICAgICAgICBkYXRhT2JqZWN0U2Vzc2lvbktleXNDbG9uZVtmaWVsZF0uaXNUb0VuY3J5cHQgPSBzZXNzaW9uS2V5c1tmaWVsZF0uaXNUb0VuY3J5cHQ7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdfY2hhdGtleXNUb1N0cmluZ0Nsb25lcjplcnInLCBlcnIpO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gZGF0YU9iamVjdFNlc3Npb25LZXlzQ2xvbmU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGF0a2V5c1RvQXJyYXlDbG9uZXIoc2Vzc2lvbktleXMpIHtcclxuICBsZXQgZGF0YU9iamVjdFNlc3Npb25LZXlzQ2xvbmUgPSB7fTtcclxuICBsZXQgZmllbGRzID0gT2JqZWN0LmtleXMoc2Vzc2lvbktleXMpO1xyXG4gIGlmIChmaWVsZHMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgIGZpZWxkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBmaWVsZCA9IGZpZWxkc1tpXTtcclxuICAgICAgICBkYXRhT2JqZWN0U2Vzc2lvbktleXNDbG9uZVtmaWVsZF0gPSB7fTtcclxuICAgICAgICBsZXQgYXJyYXlWYWx1ZXMgPSBKU09OLnBhcnNlKCdbJyArIHNlc3Npb25LZXlzW2ZpZWxkXS5zZXNzaW9uS2V5ICsgJ10nKTtcclxuICAgICAgICBkYXRhT2JqZWN0U2Vzc2lvbktleXNDbG9uZVtmaWVsZF0uc2Vzc2lvbktleSA9IG5ldyBVaW50OEFycmF5KGFycmF5VmFsdWVzKTtcclxuICAgICAgICBkYXRhT2JqZWN0U2Vzc2lvbktleXNDbG9uZVtmaWVsZF0uaXNUb0VuY3J5cHQgPSBzZXNzaW9uS2V5c1tmaWVsZF0uaXNUb0VuY3J5cHQ7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdfY2hhdGtleXNUb0FycmF5Q2xvbmVyOmVycicsIGVycik7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiBkYXRhT2JqZWN0U2Vzc2lvbktleXNDbG9uZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTWVzc2FnZVVSTChVUkwpIHtcclxuICBsZXQgc3BsaXRlZFRvVVJMID0gVVJMLnNwbGl0KCcvJyk7XHJcbiAgaWYgKHNwbGl0ZWRUb1VSTC5sZW5ndGggPD0gNikge1xyXG4gICAgcmV0dXJuIHNwbGl0ZWRUb1VSTFswXSArICcvLycgKyBzcGxpdGVkVG9VUkxbMl0gKyAnLycgKyBzcGxpdGVkVG9VUkxbM107XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiBzcGxpdGVkVG9VUkxbMF0gKyAnLy8nICsgc3BsaXRlZFRvVVJMWzJdICsgJy8nICsgc3BsaXRlZFRvVVJMWzNdICsgJy8nICsgc3BsaXRlZFRvVVJMWzRdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGF2YWlsYWJsZVNwYWNlKHVzYWdlLCBxdW90YSkge1xyXG4gIGNvbnN0IGF2YWlsYWJsZSA9ICh1c2FnZSAvIHF1b3RhKS50b0ZpeGVkKDIpO1xyXG4gIHJldHVybiB7XHJcbiAgICBxdW90YTogcXVvdGEsXHJcbiAgICB1c2FnZTogdXNhZ2UsXHJcbiAgICBwZXJjZW50OiBOdW1iZXIoYXZhaWxhYmxlKVxyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4qIEVuY29kZXMgYSBKUyBvYmplY3QgdG8gYmFzZSA2NCBlbmNvZGVcclxuKiBAcGFyYW0gICB7T2JqZWN0fSAgICB2YWx1ZSAgICBieXRlQXJyYXkgdmFsdWVcclxuKiBAcmV0dXJuICB7c3RyaW5nfSAgIGVuY29kZWQgdmFsdWVcclxuKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZSh2YWx1ZSkge1xyXG4gIHRyeSB7XHJcbiAgICBsZXQgc3RyaW5nVmFsdWUgPSBzdHJpbmdpZnkodmFsdWUpO1xyXG4gICAgcmV0dXJuIGJ0b2Eoc3RyaW5nVmFsdWUpO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcignW1V0aWxzLmVuY29kZTplcnJdICcgKyBlcnIpO1xyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAgKiBEZWNvZGUgYSBiYXNlNjQgc3RyaW5nIHRvIG9iamVjdFxyXG4gICogQHBhcmFtICAge3N0cmluZ19iNjR9ICAgIHZhbHVlICAgIHZhbHVlIGVuY29kZWQgaW4gYmFzZSA2NFxyXG4gICogQHJldHVybiAge09iamVjdH0gZGVjb2RlZFZhbHVlXHJcbiAgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZSh2YWx1ZSkge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gSlNPTi5wYXJzZShhdG9iKHZhbHVlKSk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmxvZygnW1V0aWxzLmRlY29kZTplcnJdICcgKyBlcnIpO1xyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiogRGVjb2RlIGEgYmFzZTY0IHN0cmluZyB0byBVaW50OEFycmF5XHJcbiogQHBhcmFtICAge3N0cmluZ19iNjR9ICAgIHZhbHVlICAgIGJ5dGVBcnJheSB2YWx1ZVxyXG4qIEByZXR1cm4gIHtVaW50OEFycmF5fSAgIGVuY29kZWQgdmFsdWVcclxuKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZVRvVWludDhBcnJheSh2YWx1ZSkge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoZGVjb2RlKHZhbHVlKSk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbVXRpbHMuZGVjb2RlVG9VaW50OEFycmF5OmVycl0gJyArIGVycik7XHJcbiAgICB0aHJvdyBlcnI7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuKiBDb252ZXJ0cyBhIEpTIG9iamVjdCB0byBzdHJpbmdcclxuKiBOT1RFOiBTcGVjaWFsIGNvbnZlcnNpb24gZm9yIFVpbnQ4QXJyYXlzXHJcbiogQHBhcmFtICAge09iamVjdH0gICAgdmFsdWUgICAgYnl0ZUFycmF5IHZhbHVlXHJcbiogQHJldHVybiAge1VpbnQ4QXJyYXl9ICAgZW5jb2RlZCB2YWx1ZVxyXG4qL1xyXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5naWZ5KHZhbHVlKSB7XHJcbiAgdHJ5IHtcclxuICAgIGxldCBzdHJpbmdWYWx1ZTtcclxuICAgIGlmICh2YWx1ZS5jb25zdHJ1Y3RvciA9PT0gVWludDhBcnJheSkge1xyXG4gICAgICBzdHJpbmdWYWx1ZSA9ICdbJyArIHZhbHVlLnRvU3RyaW5nKCkgKyAnXSc7IC8vIHRoZSBbXSBpcyBmb3IgSlNPTi5wYXJzZSBjb21wYXRpYmlsaXR5XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzdHJpbmdWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBzdHJpbmdWYWx1ZTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tVdGlscy5zdHJpbmdpZnk6ZXJyXSAnICsgZXJyKTtcclxuICAgIHRocm93IGVycjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4qIENvbnZlcnRzIGEgc3RyaW5naWZpZWQgb2JqZWN0IHRvIG9iamVjdFxyXG4qIEBwYXJhbSAgIHtTdHJpbmd9ICAgIHZhbHVlICAgIGJ5dGVBcnJheSB2YWx1ZVxyXG4qIEByZXR1cm4gIHtPYmplY3R9ICAgZW5jb2RlZCB2YWx1ZVxyXG4qL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2UodmFsdWUpIHtcclxuICB0cnkge1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UodmFsdWUpO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcignW1V0aWxzLnBhcnNlOmVycl0nICsgZXJyKTtcclxuICAgIGNvbnNvbGUudHJhY2UoKTtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1RoYXQgdGhhdCBjYXVzZSB0aGUgZXJyb3I6JywgdmFsdWUpO1xyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiogQ29udmVydHMgYSBzdHJpbmdpZmllZCBvYmplY3QgdG8gb2JqZWN0XHJcbiogQHBhcmFtICAge1N0cmluZ30gICAgdmFsdWUgICAgYnl0ZUFycmF5IHZhbHVlXHJcbiogQHJldHVybiAge1VpbnQ4QXJyYXl9ICAgZW5jb2RlZCB2YWx1ZVxyXG4qL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VUb1VpbnQ4QXJyYXkodmFsdWUpIHtcclxuICB0cnkge1xyXG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KHBhcnNlKHZhbHVlKSk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbVXRpbHMucGFyc2VUb1VpbnQ4QXJyYXk6ZXJyXScgKyBlcnIpO1xyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgJ3Byb3h5LW9ic2VydmUnO1xyXG5pbXBvcnQge3BhcnNlQXR0cmlidXRlc30gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuY29uc3Qgb2JqZWN0VHlwZSA9IHtBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9O1xyXG5cclxuLyoqXHJcbiAqIEBhY2Nlc3MgcHJpdmF0ZVxyXG4gKiBNYWluIGNsYXNzIHRoYXQgbWFpbnRhaW5zIGEgSlNPTiBvYmplY3QsIGFuZCBvYnNlcnZlcyBjaGFuZ2VzIGluIHRoaXMgb2JqZWN0LCByZWN1cnNpdmVseS5cclxuICogSW50ZXJuYWwgb2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBhbHNvIG9ic2VydmVkLlxyXG4gKi9cclxuY2xhc3MgU3luY09iamVjdCB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGluaXRpYWxEYXRhKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9vYnNlcnZlcnMgPSBbXTtcclxuICAgIF90aGlzLl9maWx0ZXJzID0ge307XHJcblxyXG4gICAgdGhpcy5fZGF0YSA9IGluaXRpYWxEYXRhIHx8IHt9O1xyXG5cclxuICAgIHRoaXMuX2ludGVybmFsT2JzZXJ2ZSh0aGlzLl9kYXRhKTtcclxuICB9XHJcblxyXG4gIGdldCBkYXRhKCkgeyByZXR1cm4gdGhpcy5fZGF0YTsgfVxyXG5cclxuICBvYnNlcnZlKGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9vYnNlcnZlcnMucHVzaChjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICBmaW5kKHBhdGgpIHtcclxuICAgIGxldCBsaXN0ID0gcGFyc2VBdHRyaWJ1dGVzKHBhdGgpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpO1xyXG4gIH1cclxuXHJcbiAgZmluZEJlZm9yZShwYXRoKSB7XHJcbiAgICBsZXQgcmVzdWx0ID0ge307XHJcbiAgICBsZXQgbGlzdCA9IHBhcnNlQXR0cmlidXRlcyhwYXRoKTtcclxuICAgIHJlc3VsdC5sYXN0ID0gbGlzdC5wb3AoKTtcclxuICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpO1xyXG5cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICBfZmluZFdpdGhTcGxpdChsaXN0KSB7XHJcbiAgICBsZXQgb2JqID0gdGhpcy5fZGF0YTtcclxuICAgIGxpc3QuZm9yRWFjaCgodmFsdWUpID0+IHtcclxuICAgICAgb2JqID0gb2JqW3ZhbHVlXTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBvYmo7XHJcbiAgfVxyXG5cclxuICBfaW50ZXJuYWxPYnNlcnZlKG9iamVjdCkge1xyXG5cclxuICAgIGxldCBoYW5kbGVyID0gKGNoYW5nZXNldCkgPT4ge1xyXG5cclxuICAgICAgY2hhbmdlc2V0LmV2ZXJ5KChjaGFuZ2UpID0+IHtcclxuICAgICAgICB0aGlzLl9vbkNoYW5nZXMoY2hhbmdlKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLl9kYXRhID0gT2JqZWN0LmRlZXBPYnNlcnZlKG9iamVjdCwgaGFuZGxlcik7XHJcblxyXG4gIH1cclxuXHJcbiAgX2ZpcmVFdmVudChldmVudCkge1xyXG4gICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XHJcbiAgICAgIGNhbGxiYWNrKGV2ZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX29uQ2hhbmdlcyhjaGFuZ2UpIHtcclxuXHJcbiAgICBsZXQgb2JqID0gY2hhbmdlLm9iamVjdDtcclxuICAgIGxldCBvYmpUeXBlO1xyXG5cclxuICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IE9iamVjdCkge1xyXG4gICAgICBvYmpUeXBlID0gT2JqZWN0VHlwZS5PQkpFQ1Q7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHtcclxuICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuQVJSQVk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGZpZWxkU3RyaW5nID0gY2hhbmdlLmtleXBhdGg7XHJcblxyXG4gICAgLy8gY29uc29sZS5sb2coJ0ZpZWxkOicsIGZpZWxkU3RyaW5nKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTtcclxuXHJcbiAgICAvL2xldCBvbGRWYWx1ZSA9IGNoYW5nZS5vbGRWYWx1ZTtcclxuICAgIGxldCBuZXdWYWx1ZSA9IG9ialtjaGFuZ2UubmFtZV07XHJcblxyXG4gICAgLy8gY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsIEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlKSwgZmllbGRTdHJpbmcuaW5jbHVkZXMoJ2xlbmd0aCcpKTtcclxuXHJcbiAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICd1cGRhdGUnICYmICFmaWVsZFN0cmluZy5pbmNsdWRlcygnLmxlbmd0aCcpKSB7XHJcbiAgICAgIHRoaXMuX2ZpcmVFdmVudCh7XHJcbiAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuVVBEQVRFLFxyXG4gICAgICAgIG9UeXBlOiBvYmpUeXBlLFxyXG4gICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZyxcclxuICAgICAgICBkYXRhOiBuZXdWYWx1ZVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdhZGQnKSB7XHJcbiAgICAgIHRoaXMuX2ZpcmVFdmVudCh7XHJcbiAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELFxyXG4gICAgICAgIG9UeXBlOiBvYmpUeXBlLFxyXG4gICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZyxcclxuICAgICAgICBkYXRhOiBuZXdWYWx1ZVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdkZWxldGUnKSB7XHJcbiAgICAgIHRoaXMuX2ZpcmVFdmVudCh7XHJcbiAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuUkVNT1ZFLFxyXG4gICAgICAgIG9UeXBlOiBvYmpUeXBlLFxyXG4gICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgbGV0IENoYW5nZVR5cGUgPSB7VVBEQVRFOiAndXBkYXRlJywgQUREOiAnYWRkJywgUkVNT1ZFOiAncmVtb3ZlJ307XHJcbmV4cG9ydCBsZXQgT2JqZWN0VHlwZSA9IHtPQkpFQ1Q6ICdvYmplY3QnLCBBUlJBWTogJ2FycmF5J307XHJcbmV4cG9ydCBkZWZhdWx0IFN5bmNPYmplY3Q7XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignRGF0YU9iamVjdENoaWxkJyk7XHJcblxyXG5pbXBvcnQgU3luY09iamVjdCBmcm9tICcuL1Byb3h5T2JqZWN0JztcclxuXHJcbmltcG9ydCB7IGRlZXBDbG9uZSB9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcclxuXHJcbi8qKlxyXG4gKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgRGF0YU9iamVjdCBhZGRDaGlsZHJlbiBjYWxsIG9yIGZyb20gb25BZGRDaGlsZHJlbiBpZiByZW1vdGVseSBjcmVhdGVkLlxyXG4gKi9cclxuY2xhc3MgRGF0YU9iamVjdENoaWxkIC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyB7XHJcbiAgLyogcHJpdmF0ZVxyXG5cclxuICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tXHJcbiAgX29uUmVzcG9uc2VIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWRcclxuICAqL1xyXG5cclxuICAvKipcclxuICAgKiBAaWdub3JlXHJcbiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIERhdGFPYmplY3QuYWRkQ2hpbGRcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvcihpbnB1dCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBmdW5jdGlvbiB0aHJvd01hbmRhdG9yeVBhcm1NaXNzaW5nRXJyb3IocGFyKSB7XHJcbiAgICAgIHRocm93ICdbRGF0YU9iamVjdENoaWxkXSAnICsgcGFyICsgJyBtYW5kYXRvcnkgcGFyYW1ldGVyIGlzIG1pc3NpbmcnO1xyXG4gICAgfVxyXG5cclxuICAgIGlucHV0LnBhcmVudCA/ICBfdGhpcy5fcGFyZW50ID0gaW5wdXQucGFyZW50IDogdGhyb3dNYW5kYXRvcnlQYXJtTWlzc2luZ0Vycm9yKCdwYXJlbnQnKTtcclxuICAgIGlucHV0LnVybCA/ICBfdGhpcy5fdXJsID0gaW5wdXQudXJsIDogdGhyb3dNYW5kYXRvcnlQYXJtTWlzc2luZ0Vycm9yKCd1cmwnKTtcclxuICAgIGlucHV0LmNyZWF0ZWQgPyBfdGhpcy5fY3JlYXRlZCA9IGlucHV0LmNyZWF0ZWQgOiB0aHJvd01hbmRhdG9yeVBhcm1NaXNzaW5nRXJyb3IoJ2NyZWF0ZWQnKTtcclxuICAgIGlucHV0LnJlcG9ydGVyID8gX3RoaXMuX3JlcG9ydGVyID0gaW5wdXQucmVwb3J0ZXIgOiB0aHJvd01hbmRhdG9yeVBhcm1NaXNzaW5nRXJyb3IoJ3JlcG9ydGVyJyk7XHJcbiAgICBpbnB1dC5ydW50aW1lID8gX3RoaXMuX3J1bnRpbWUgPSBpbnB1dC5ydW50aW1lIDogdGhyb3dNYW5kYXRvcnlQYXJtTWlzc2luZ0Vycm9yKCdydW50aW1lJyk7XHJcbiAgICBpbnB1dC5zY2hlbWEgPyBfdGhpcy5fc2NoZW1hID0gaW5wdXQuc2NoZW1hIDogdGhyb3dNYW5kYXRvcnlQYXJtTWlzc2luZ0Vycm9yKCdzY2hlbWEnKTtcclxuICAgIGlucHV0LnBhcmVudE9iamVjdCA/IF90aGlzLl9wYXJlbnRPYmplY3QgPSBpbnB1dC5wYXJlbnRPYmplY3QgOiB0aHJvd01hbmRhdG9yeVBhcm1NaXNzaW5nRXJyb3IoJ3BhcmVudE9iamVjdCcpO1xyXG5cclxuICAgIGlmIChpbnB1dC5uYW1lKSBfdGhpcy5fbmFtZSA9IGlucHV0Lm5hbWU7XHJcbiAgICBpZiAoaW5wdXQuZGVzY3JpcHRpb24pIF90aGlzLl9kZXNjcmlwdGlvbiA9IGlucHV0LmRlc2NyaXB0aW9uO1xyXG4gICAgaWYgKGlucHV0LnRhZ3MpIF90aGlzLl90YWdzID0gaW5wdXQudGFncztcclxuICAgIGlmIChpbnB1dC5yZXNvdXJjZXMpIF90aGlzLl9yZXNvdXJjZXMgPSBpbnB1dC5yZXNvdXJjZXM7XHJcbiAgICBpZiAoaW5wdXQub2JzZXJ2ZXJTdG9yYWdlKSBfdGhpcy5fb2JzZXJ2ZXJTdG9yYWdlID0gaW5wdXQub2JzZXJ2ZXJTdG9yYWdlO1xyXG4gICAgaWYgKGlucHV0LnB1YmxpY09ic2VydmF0aW9uKSBfdGhpcy5fcHVibGljT2JzZXJ2YXRpb24gPSBpbnB1dC5wdWJsaWNPYnNlcnZhdGlvbjtcclxuXHJcbiAgICBfdGhpcy5fY2hpbGRJZCA9IGlucHV0LnVybDtcclxuXHJcbiAgICBpZiAoaW5wdXQuZGF0YSkge1xyXG4gICAgICBfdGhpcy5fc3luY09iaiA9IG5ldyBTeW5jT2JqZWN0KGlucHV0LmRhdGEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgU3luY09iamVjdCh7fSk7XHJcbiAgICB9XHJcblxyXG4gICAgbG9nLmxvZygnW0RhdGFPYmplY3RDaGlsZCAtICBDb25zdHJ1Y3Rvcl0gLSAnLCBfdGhpcy5fc3luY09iaik7XHJcblxyXG4gICAgX3RoaXMuX2J1cyA9IF90aGlzLl9wYXJlbnRPYmplY3QuX2J1cztcclxuICAgIF90aGlzLl9vd25lciA9IF90aGlzLl9wYXJlbnRPYmplY3QuX293bmVyO1xyXG5cclxuICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpO1xyXG5cclxuICAgIF90aGlzLl9tZXRhZGF0YSA9IGlucHV0O1xyXG5cclxuICAgIC8vIGRlbGV0ZSBfdGhpcy5fbWV0YWRhdGEuZGF0YTtcclxuICAgIGRlbGV0ZSBfdGhpcy5fbWV0YWRhdGEucGFyZW50T2JqZWN0O1xyXG5cclxuICAgIF90aGlzLl9zaGFyaW5nU3RhdHVzID0gZmFsc2U7XHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0IHNoYXJlYWJsZSgpIHtcclxuICAgIGxldCBzaGFyZWFibGUgPSB0aGlzLm1ldGFkYXRhO1xyXG4gICAgc2hhcmVhYmxlLmRhdGEgPSB0aGlzLmRhdGE7XHJcblxyXG4gICAgcmV0dXJuIHNoYXJlYWJsZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBzaGFyZSB0aGUgY2hpbGQgT2JqZWN0IGFtb25nIGF1dGhvcmlzZWQgSHlwZXJ0aWVzXHJcbiAgICogQHBhcmFtICB7Ym9vbGVhbn0gICAgIHJlcG9ydGVyICBJZiB0cnVlIHRoZSBjaGlsZCBvYmplY3QgaXMgb25seSBzaGFyZWQgdG8gUGFyZW50IHJlcG9ydGVyXHJcbiAgICogQHJldHVybiB7UHJvbWlzZTxKU09OPn0gICAgICAgIEl0IHJldHVybnMgYSBwcm9taXNlIHdpdGggdGhlIHNoYXJpbmcgcmVzdWx0cy5cclxuICAgKi9cclxuXHJcbiAgc2hhcmUodG9SZXBvcnRlcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fc2hhcmluZ1N0YXR1cyA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIGxldCB0bztcclxuICAgICAgbGV0IHJlcG9ydGVyID0gdG9SZXBvcnRlcjtcclxuXHJcbiAgICAgIGlmIChyZXBvcnRlcikge1xyXG4gICAgICAgIHRvID0gX3RoaXMubWV0YWRhdGEucGFyZW50O1xyXG4gICAgICB9IGVsc2UgdG8gPSBfdGhpcy5tZXRhZGF0YS5wYXJlbnQgKyAnL2NoaWxkcmVuLyc7XHJcblxyXG4gICAgICBsZXQgY2hpbGRWYWx1ZSA9IF90aGlzLm1ldGFkYXRhO1xyXG4gICAgICBjaGlsZFZhbHVlLmRhdGEgPSBfdGhpcy5kYXRhO1xyXG5cclxuICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoaWxkIGFkZHJlc3M6IE1lc3NhZ2VCdXNcclxuICAgICAgbGV0IHJlcXVlc3RNc2cgPSB7XHJcbiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLm1ldGFkYXRhLnJlcG9ydGVyLCB0bzogdG8sXHJcbiAgICAgICAgYm9keTogeyByZXNvdXJjZTogY2hpbGRWYWx1ZS51cmwsIHZhbHVlOiBjaGlsZFZhbHVlIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5pZGVudGl0eSkgICAgICB7XHJcbiAgICAgICAgcmVxdWVzdE1zZy5ib2R5LmlkZW50aXR5ID0gX3RoaXMuaWRlbnRpdHk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vdG8gYmUgdXNlZCB0byBkaXNhYmxlIG11dHVhbCBhdXRoZW50aWNhdGlvbiBmb3IgbGVnYWN5IHVzZXJzXHJcblxyXG4gICAgICBpZiAoX3RoaXMuX3BhcmVudE9iamVjdC5kYXRhLmhhc093blByb3BlcnR5KCdtdXR1YWwnKSkgcmVxdWVzdE1zZy5ib2R5Lm11dHVhbCA9IF90aGlzLl9wYXJlbnRPYmplY3QuZGF0YS5tdXR1YWw7XHJcblxyXG4gICAgICBpZiAoX3RoaXMuX3BhcmVudE9iamVjdC5tZXRhZGF0YS5yZXBvcnRlciA9PT0gX3RoaXMubWV0YWRhdGEucmVwb3J0ZXIpIHtcclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlZXBDbG9uZShyZXF1ZXN0TXNnKSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcclxuICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgbGV0IGNhbGxiYWNrID0gKHJlcGx5KSA9PiB7XHJcblxyXG4gICAgICAgICAgaWYgKHJlcGx5LnRvID09PSBfdGhpcy5fcmVwb3J0ZXIpIHtcclxuICAgICAgICAgICAgX3RoaXMuX2J1cy5yZW1vdmVSZXNwb25zZUxpc3RlbmVyKHJlcXVlc3RNc2cuZnJvbSwgcmVwbHkuaWQpO1xyXG5cclxuICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXIuRGF0YU9iamVjdENoaWxkLnNoYXJlXSBQYXJlbnQgcmVwb3J0ZXIgcmVwbHkgJywgcmVwbHkpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICBjb2RlOiByZXBseS5ib2R5ICYmIHJlcGx5LmJvZHkuY29kZSA/IHJlcGx5LmJvZHkuY29kZSA6IDUwMCxcclxuICAgICAgICAgICAgICBkZXNjOiByZXBseS5ib2R5ICYmIHJlcGx5LmJvZHkuZGVzYyA/IHJlcGx5LmJvZHkuZGVzYyA6ICdVbmtub3duJ1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA8IDMwMCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSByZXR1cm4gcmVqZWN0KHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGxldCBpZCA9IF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZGVlcENsb25lKHJlcXVlc3RNc2cpLCBjYWxsYmFjaywgZmFsc2UpO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpPT4ge1xyXG5cclxuICAgICAgICAgIC8vIElmIFJlcG9ydGVyIGRvZXMgIG5vdCByZXBseSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZFxyXG4gICAgICAgICAgX3RoaXMuX2J1cy5yZW1vdmVSZXNwb25zZUxpc3RlbmVyKHJlcXVlc3RNc2cuZnJvbSwgaWQpO1xyXG5cclxuICAgICAgICAgIGxldCByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIGNvZGU6IDQwOCxcclxuICAgICAgICAgICAgZGVzYzogJ3RpbW91dCdcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KHJlc3VsdCk7XHJcblxyXG4gICAgICAgIH0sIDMwMDApO1xyXG5cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gc2hhcmUgdGhlIGNoaWxkIE9iamVjdCBhbW9uZyBhdXRob3Jpc2VkIEh5cGVydGllc1xyXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gICAgIHJlcG9ydGVyICBJZiB0cnVlIHRoZSBjaGlsZCBvYmplY3QgaXMgb25seSBzaGFyZWQgdG8gUGFyZW50IHJlcG9ydGVyXHJcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPEpTT04+fSAgICAgICAgSXQgcmV0dXJucyBhIHByb21pc2Ugd2l0aCB0aGUgc2hhcmluZyByZXN1bHRzLlxyXG4gICAgICovXHJcblxyXG4gIHN0b3JlKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgY2hpbGQgPSB7fTtcclxuICAgIGxldCBrZXkgPSBfdGhpcy5tZXRhZGF0YS5jaGlsZHJlbiArICcuJyArIF90aGlzLm1ldGFkYXRhLnVybDtcclxuXHJcbiAgICBjaGlsZC52YWx1ZSA9IF90aGlzLm1ldGFkYXRhO1xyXG4gICAgY2hpbGQuaWRlbnRpdHkgPSBfdGhpcy5pZGVudGl0eTtcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG5cclxuICAgICAgZnJvbTogX3RoaXMubWV0YWRhdGEucmVwb3J0ZXIsXHJcbiAgICAgIHRvOiBfdGhpcy5fcGFyZW50T2JqZWN0Ll9zeW5jaGVyLl9zdWJVUkwsXHJcbiAgICAgIHR5cGU6ICdjcmVhdGUnLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6IF90aGlzLm1ldGFkYXRhLnBhcmVudCxcclxuICAgICAgICBhdHRyaWJ1dGU6IGtleSxcclxuICAgICAgICB2YWx1ZTogY2hpbGRcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsb2cubG9nKCdbRGF0YU9iamVjdENoaWxkLnN0b3JlXTonLCBtc2cpO1xyXG5cclxuICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTtcclxuICB9XHJcblxyXG4gIF9hbGxvY2F0ZUxpc3RlbmVycygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy90aGlzIGlzIG9ubHkgbmVlZGVkIGZvciBjaGlsZHJlbiByZXBvcnRlcnNcclxuICAgIGlmIChfdGhpcy5fcmVwb3J0ZXIgPT09IF90aGlzLl9vd25lcikge1xyXG4gICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl9yZXBvcnRlciwgKG1zZykgPT4ge1xyXG4gICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJyAmJiBtc2cuaWQgPT09IF90aGlzLl9tc2dJZCkge1xyXG4gICAgICAgICAgbG9nLmxvZygnRGF0YU9iamVjdENoaWxkLm9uUmVzcG9uc2U6JywgbXNnKTtcclxuICAgICAgICAgIF90aGlzLl9vblJlc3BvbnNlKG1zZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9yZWxlYXNlTGlzdGVuZXJzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoX3RoaXMuX2xpc3RlbmVyKSB7XHJcbiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YVxyXG4gICAqL1xyXG4gIGRlbGV0ZSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG5cclxuICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcblxyXG4gICAgLy9UT0RPOiBzZW5kIGRlbGV0ZSBtZXNzYWdlID9cclxuXHJcbiAgICAvLyBub3RoaW5nIHRvIGJlIGRvbmVcclxuICAgIC8vIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgLy8gICBsb2cubG9nKCdbRGF0YU9iamVjdENoaWxkLmRlbGV0ZV0nKTtcclxuICAgIC8vICAgcmVzb2x2ZSgpO1xyXG4gICAgLy8gfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBbGwgTWV0YWRhdGEgYWJvdXQgdGhlIENoaWxkIERhdGEgT2JqZWN0XHJcbiAgICogQHR5cGUge09iamVjdH0gLVxyXG4gICAqL1xyXG4gIGdldCBtZXRhZGF0YSgpIHsgcmV0dXJuIHRoaXMuX21ldGFkYXRhOyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoaWxkcmVuIElEIGdlbmVyYXRlZCBvbiBhZGRDaGlsZHJlbi4gVW5pcXVlIGlkZW50aWZpZXJcclxuICAgKiBAdHlwZSB7VVJMfSAtIFVSTCBvZiB0aGUgZm9ybWF0IDxIeXBlcnR5VVJMPiM8bnVtZXJpYy1zZXF1ZW5jZT5cclxuICAgKi9cclxuICBnZXQgY2hpbGRJZCgpIHsgcmV0dXJuIHRoaXMuX2NoaWxkSWQ7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGF0YSBTdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLlxyXG4gICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS5cclxuICAgKi9cclxuXHJcbiAgZ2V0IHNoYXJpbmdTdGF0dXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fc2hhcmluZ1N0YXR1cztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAgKiBEYXRhIFN0cnVjdHVyZSB0byBiZSBzeW5jaHJvbml6ZWQuXHJcbiAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS5cclxuICAgICovXHJcblxyXG4gIGdldCBkYXRhKCkgeyByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldCBmb3IgdGhpcyBkYXRhT2JqZWN0Q2hpbGQgYW4gaWRlbnRpdHlcclxuICAgKiBAbWV0aG9kIGlkZW50aXR5XHJcbiAgICogQHBhcmFtICB7SWRlbnRpdHl9IGlkZW50aXR5IGlkZW50aXR5IGZyb20gd2hvIGNyZWF0ZWQgdGhlIG1lc3NhZ2VcclxuICAgKi9cclxuICBzZXQgaWRlbnRpdHkoaWRlbnRpdHkpIHsgdGhpcy5faWRlbnRpdHkgPSBpZGVudGl0eTsgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgZm9yIHRoaXMgZGF0YU9iamVjdENoaWxkIGFuIGlkZW50aXR5XHJcbiAgICogQG1ldGhvZCBpZGVudGl0eVxyXG4gICAqIEByZXR1cm4ge0lkZW50aXR5fSBpZGVudGl0eSBmcm9tIHdobyBjcmVhdGVkIHRoZSBtZXNzYWdlXHJcbiAgICovXHJcbiAgZ2V0IGlkZW50aXR5KCkgeyByZXR1cm4gdGhpcy5faWRlbnRpdHk7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIgY2hpbGRcclxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrXHJcbiAgICovXHJcbiAgb25DaGFuZ2UoY2FsbGJhY2spIHtcclxuICAgIHRoaXMuX3N5bmNPYmoub2JzZXJ2ZSgoZXZlbnQpID0+IHtcclxuICAgICAgbG9nLmxvZygnW0RhdGFPYmplY3RDaGlsZCAtIG9ic2VydmVyXSAtICcsIGV2ZW50KTtcclxuICAgICAgY2FsbGJhY2soZXZlbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGVzXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFja1xyXG4gICAqL1xyXG4gIG9uUmVzcG9uc2UoY2FsbGJhY2spIHtcclxuICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IF9vbkNoaWxkQ3JlYXRlXHJcbiAgX29uUmVzcG9uc2UobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBldmVudCA9IHtcclxuICAgICAgdHlwZTogbXNnLnR5cGUsXHJcbiAgICAgIHVybDogbXNnLmJvZHkuc291cmNlLFxyXG4gICAgICBjb2RlOiBtc2cuYm9keS5jb2RlXHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHtcclxuICAgICAgX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKGV2ZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBEYXRhT2JqZWN0Q2hpbGQ7XHJcbiIsIlxyXG5cclxuaW1wb3J0IHsgc2Vjb25kc1NpbmNlRXBvY2ggfSBmcm9tICcuLi91dGlscy91dGlscy5qcyc7XHJcblxyXG4vKipcclxuICogQ2xhc3MgdG8gaGFuZGxlIENoaWxkcmVuIERhdGEgT2JqZWN0IEhlYXJ0IGJlYXRzIFxyXG4gKiByZXF1aXJlZCB0byBtYW5hZ2Ugc3luY2hyb25pc2F0aW9uIHdpdGggcmVtb3RlIHN0b3JhZ2Ugc2VydmVycy5cclxuICovXHJcbmNsYXNzIEhlYXJ0QmVhdCB7XHJcbiAgLyogcHJpdmF0ZVxyXG5cclxuICAqL1xyXG5cclxuICAvKipcclxuICAgKiBAaWdub3JlXHJcbiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIERhdGFPYmplY3QgY29uc3RydWN0b3JcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvcihidXMsIGh5cGVydHlVcmwsIHJ1bnRpbWVVcmwsIGRhdGFPYmplY3QsIGhlYXJ0QmVhdFJhdGUgPSA2MCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBmdW5jdGlvbiB0aHJvd01hbmRhdG9yeVBhcm1NaXNzaW5nRXJyb3IocGFyKSB7XHJcbiAgICAgIHRocm93ICdbSGVhcnRCZWF0XSAnICsgcGFyICsgJyBtYW5kYXRvcnkgcGFyYW1ldGVyIGlzIG1pc3NpbmcnO1xyXG4gICAgfVxyXG5cclxuICAgIGJ1cyA/IF90aGlzLl9idXMgPSBidXMgOiB0aHJvd01hbmRhdG9yeVBhcm1NaXNzaW5nRXJyb3IoJ2J1cycpO1xyXG4gICAgZGF0YU9iamVjdCA/IF90aGlzLl9kYXRhT2JqZWN0ID0gZGF0YU9iamVjdCA6IHRocm93TWFuZGF0b3J5UGFybU1pc3NpbmdFcnJvcignZGF0YU9iamVjdCcpO1xyXG4gICAgaGVhcnRCZWF0UmF0ZSA/IF90aGlzLl9oZWFydEJlYXRSYXRlID0gaGVhcnRCZWF0UmF0ZSA6IHRocm93TWFuZGF0b3J5UGFybU1pc3NpbmdFcnJvcignaGVhcnRCZWF0UmF0ZScpO1xyXG4gICAgcnVudGltZVVybCA/IF90aGlzLl9ydW50aW1lVXJsID0gcnVudGltZVVybCA6IHRocm93TWFuZGF0b3J5UGFybU1pc3NpbmdFcnJvcigncnVudGltZVVybCcpO1xyXG4gICAgaHlwZXJ0eVVybCA/IF90aGlzLl9oeXBlcnR5VXJsID0gaHlwZXJ0eVVybCA6IHRocm93TWFuZGF0b3J5UGFybU1pc3NpbmdFcnJvcignaHlwZXJ0eVVybCcpO1xyXG4gICAgdGhpcy5oZWFydGJlYXQgPSAwO1xyXG5cclxuICAgIF90aGlzLl9zdG9wID0ge1xyXG4gICAgICBoZWFydEJlYXQ6IGZhbHNlLFxyXG4gICAgICBzeW5jOiBmdW5jdGlvbiAoYnVzKSB7XHJcbiAgICAgICAgbGV0IHN0b3BTeW5jTXNnID0ge1xyXG4gICAgICAgICAgZnJvbTogaHlwZXJ0eVVybCxcclxuICAgICAgICAgIHRvOiBydW50aW1lVXJsICsgJy9zbScsXHJcbiAgICAgICAgICB0eXBlOiAnZXhlY3V0ZScsXHJcbiAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ3N0b3BTeW5jJyxcclxuICAgICAgICAgICAgcGFyYW1zOiBbZGF0YU9iamVjdC51cmxdXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tIZWFydGJlYXQuc3RvcC5zeW5jKCldIHNlbmRpbmcgbXNnOicsIHN0b3BTeW5jTXNnKTtcclxuXHJcbiAgICAgICAgYnVzLnBvc3RNZXNzYWdlKHN0b3BTeW5jTXNnKTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICB9O1xyXG5cclxuICB9XHJcblxyXG4gIHN0YXJ0KHJlc3VtZSwgaXNSZXBvcnRlciA9IGZhbHNlKSB7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tIZWFydEJlYXRdIHN0YXJ0aW5nLiBpc1JlcG9ydGVyOiAnLCBpc1JlcG9ydGVyKTtcclxuXHJcbiAgICBpZiAocmVzdW1lIHx8ICFpc1JlcG9ydGVyKSB7XHJcbiAgICAgIHRoaXMuX2dldExhc3RIZWFyQmVhdCgpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGxldCBpc0hlYXJ0QmVhdEFjdGl2ZSA9IHRoaXMuX2lzSGVhcnRCZWF0QWN0aXZlKHRoaXMuaGVhcnRCZWF0LCB0aGlzLl9oZWFydEJlYXRSYXRlICogMik7XHJcblxyXG4gICAgICAgIGlmICghaXNIZWFydEJlYXRBY3RpdmUpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbSGVhcnRCZWF0XSBoZWFydCBiZWF0cyBhcmUgZGlzYWJsZWQgZm9yICcsIHRoaXMuX2RhdGFPYmplY3QpO1xyXG5cclxuICAgICAgICAgIC8vIElzIGRpc2FibGVkOiBsZXRzIHN0YXJ0IG9ic2VydmVyIGhlYXJ0IGJlYXQgYW5kIHN0YXJ0IHN5bmNoaW5nIHdpdGggcmVtb3RlIHN0b3JhZ2Ugc2VydmVyXHJcbiAgICAgICAgICB0aGlzLl9zdG9wLmhlYXJ0QmVhdCA9IHRoaXMuX3N0YXJ0SGVhcnRCZWF0KHRoaXMuX2hlYXJ0QmVhdFJhdGUpO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1tIZWFydEJlYXRdICAnLCB0aGlzLl9oeXBlcnR5VXJsLCAnIHN0YXJ0ZWQgc3luY2hpbmcgd2l0aCByZW1vdGUgc3RvcmFnZSBzZXJ2ZXInKTtcclxuICAgICAgICAgIHRoaXMuX3N0YXJ0U3luYygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyAgaGVhcnQgYmVhdCBpcyBhY3RpdmUsIFxyXG4gICAgICAgICAgLy8gaXQgbWVhbnMgdGhlIGRhdGEgb2JqZWN0IGlzIGFscmVhZHkgYmVpbmcgc3luY2hyb25pc2VkIHdpdGggcmVtb3RlIHN0b3JhZ2Ugc2VydmVyXHJcbiAgICAgICAgICAvLyB3ZSBvbmx5IG5lZWQgdG8gd2F0Y2ggdGhlIGhlYXJ0IGJlYXQgYW5kIHRyeSB0byByZXBsYWNlIGl0IGluIGNhc2UgaXQgZmFpbHMuXHJcbiAgICAgICAgICB0aGlzLl93YXRjaEhlYXJ0QmVhdCh0aGlzLl9oZWFydEJlYXRSYXRlLCB0cnVlLCB0aGlzLl9vbkhlcnRiZWF0U3RvcHBlZCk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3RhcnRIZWFydEJlYXQodGhpcy5faGVhcnRCZWF0UmF0ZSk7XHJcbiAgICAgIHRoaXMuX3N0YXJ0U3luYygpO1xyXG4gICAgfSBcclxuXHJcbiAgfVxyXG5cclxuICBfZ2V0TGFzdEhlYXJCZWF0KCkge1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gIFxyXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0hlYXJ0QmVhdC5fZ2V0TGFzdEhlYXJCZWF0XSBzdG9wIHdhaXRpbmcgJyk7XHJcbiAgICAgICAgcmVzb2x2ZSgpO1xyXG5cclxuICAgICAgfSwgdGhpcy5faGVhcnRCZWF0UmF0ZSAqIDEwMDAgKiAxLjUpO1xyXG4gIFxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgc3RvcCgpIHtcclxuICAgIGlmICh0aGlzLl9zdG9wLmhlYXJ0QmVhdClcclxuICAgICAgdGhpcy5fc3RvcC5oZWFydEJlYXQoKTtcclxuXHJcbiAgICB0aGlzLl9zdG9wLnN5bmModGhpcy5fYnVzKTtcclxuICB9XHJcblxyXG4gIGdldCBoZWFydEJlYXQoKSB7XHJcbiAgICBpZiAodGhpcy5oZWFydGJlYXQpXHJcbiAgICAgIHJldHVybiB0aGlzLmhlYXJ0YmVhdDtcclxuICAgIGVsc2UgcmV0dXJuIDA7XHJcbiAgfVxyXG5cclxuICBvbk5ld0hlYXJ0YmVhdChoZWFydGJlYXQpIHtcclxuICAgIHRoaXMuaGVhcnRiZWF0ID0gaGVhcnRiZWF0O1xyXG4gIH1cclxuXHJcbiAgX2lzSGVhcnRCZWF0QWN0aXZlKGxhc3RIZWFydGJlYXQsIG1heEhlYXJ0QmVhdEludGVydmFsKSB7XHJcbiAgICBsZXQgbGFzdEhlYXJ0UGVyaW9kSW50ZXJ2YWwgPSBzZWNvbmRzU2luY2VFcG9jaCgpIC0gbGFzdEhlYXJ0YmVhdDtcclxuICAgIGNvbnNvbGUubG9nKCdbSGVhcnRCZWF0Ll9pc0hlYXJ0QmVhdEFjdGl2ZV0gbm93IC0gbGFzdEhlYXJ0QmVhdCcsIGxhc3RIZWFydFBlcmlvZEludGVydmFsKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnW0hlYXJ0QmVhdC5faXNIZWFydEJlYXRBY3RpdmVdICcsICEobGFzdEhlYXJ0UGVyaW9kSW50ZXJ2YWwgPiBtYXhIZWFydEJlYXRJbnRlcnZhbCAqIDIpKTtcclxuICAgIHJldHVybiAoIShsYXN0SGVhcnRQZXJpb2RJbnRlcnZhbCA+IG1heEhlYXJ0QmVhdEludGVydmFsICogMikpO1xyXG4gIH1cclxuXHJcblxyXG4gIF9zdGFydEhlYXJ0QmVhdChyYXRlKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBtc2cgPSB7XHJcbiAgICAgIGZyb206IF90aGlzLl9oeXBlcnR5VXJsLFxyXG4gICAgICB0bzogX3RoaXMuX2RhdGFPYmplY3QudXJsICsgJy9jaGlsZHJlbi8nLFxyXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcclxuICAgICAgYm9keToge1xyXG4gICAgICAgIHJlc291cmNlOiAnaGVhcnRiZWF0JyxcclxuICAgICAgICBtdXR1YWw6IGZhbHNlLFxyXG4gICAgICAgIHZhbHVlOiBzZWNvbmRzU2luY2VFcG9jaCgpLFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZygnW0hlYXJ0QmVhdC5fc3RhcnRIZWFydEJlYXRdIHN0YXJ0aW5nIC4uLiAnLCBtc2cuYm9keS52YWx1ZSk7XHJcblxyXG4gICAgdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZyk7XHJcblxyXG4gICAgdGhpcy5oZWFydGJlYXQgPSBzZWNvbmRzU2luY2VFcG9jaCgpO1xyXG5cclxuICAgIGxldCBpZCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIGxldCBtc2cgPSB7XHJcbiAgICAgICAgZnJvbTogX3RoaXMuX2h5cGVydHlVcmwsXHJcbiAgICAgICAgdG86IF90aGlzLl9kYXRhT2JqZWN0LnVybCArICcvY2hpbGRyZW4vJyxcclxuICAgICAgICB0eXBlOiAnY3JlYXRlJyxcclxuICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICByZXNvdXJjZTogJ2hlYXJ0YmVhdCcsXHJcbiAgICAgICAgICBtdXR1YWw6IGZhbHNlLFxyXG4gICAgICAgICAgdmFsdWU6IHNlY29uZHNTaW5jZUVwb2NoKCksXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbSGVhcnRCZWF0XSAnLCBtc2cpO1xyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZyk7XHJcbiAgICAgIHRoaXMuaGVhcnRiZWF0ID0gc2Vjb25kc1NpbmNlRXBvY2goKTtcclxuXHJcbiAgICB9LCByYXRlICogMTAwMCk7XHJcblxyXG4gICAgLy8gcmV0dXJucyBmdW5jdGlvbiB0byBzdG9wIHRoZSBoZWFydCBiZWF0XHJcblxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2xlYXJJbnRlcnZhbChpZCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc3RhcnRTeW5jKCkge1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbSGVhcnRCZWF0Ll9zdGFydFN5bmNdIHN0YXJ0aW5nIG9ic2VydmVyIHN5bmMgJywgdGhpcy5fZGF0YU9iamVjdC5kYXRhKTtcclxuICAgIGxldCBiYWNrdXBSZXZpc2lvbiA9IHRoaXMuX2RhdGFPYmplY3QuZGF0YS5iYWNrdXBSZXZpc2lvbjtcclxuICAgIGNvbnNvbGUubG9nKCdbSGVhcnRCZWF0Ll9zdGFydFN5bmNdIGJhY2t1cFJldmlzaW9uICcsIGJhY2t1cFJldmlzaW9uKTtcclxuICAgIGxldCBtc2cgPSB7XHJcbiAgICAgIGZyb206IHRoaXMuX2h5cGVydHlVcmwsXHJcbiAgICAgIHRvOiB0aGlzLl9ydW50aW1lVXJsICsgJy9zbScsXHJcbiAgICAgIHR5cGU6ICdleGVjdXRlJyxcclxuICAgICAgYm9keToge1xyXG4gICAgICAgIG1ldGhvZDogJ3N5bmMnLFxyXG4gICAgICAgIHBhcmFtczogW3RoaXMuX2RhdGFPYmplY3QudXJsLCBiYWNrdXBSZXZpc2lvbl1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbSGVhcnRCZWF0Ll9zdGFydFN5bmNdIHNlbmRpbmcgbXNnICcsIG1zZyk7XHJcblxyXG4gICAgdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZyk7XHJcblxyXG4gIH1cclxuXHJcbiAgX3dhdGNoSGVhcnRCZWF0KHJhdGUsIG9uV2F0Y2hpbmdJc0VuYWJsZWQsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyAgcWRvIG8gaGVhcnRCZWF0IHRlcm1pbmFyIGNoYW1hIGNhbGxiYWNrIFxyXG4gICAgLy8gdXNhIGhlYXJ0QmVhdCBSYXRpbmcgcGFyYSBpbmljaWFyIHRpbWVyIG5vIHJlc3BlY3Rpdm8gXHJcbiAgICAvLyBjYW1wbyBkbyBETyBjaGFtYW5kbyBpc0hlYXJ0QmVhdEFjdGl2ZSgpXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBzeW5jRnVuID0gY2FsbGJhY2s7XHJcbiAgICBjb25zb2xlLmxvZygnW0hlYXJ0QmVhdC5fd2F0Y2hIZWFydEJlYXRdIHN0YXJ0ZWQgd2F0Y2hpbmcgJywgX3RoaXMuaGVhcnRCZWF0KTtcclxuXHJcbiAgICAvL2xldCBoZWFydEJlYXQgPSB0eXBlICsgJ0hlYXJ0QmVhdCc7XHJcblxyXG4gICAgbGV0IHdhdGNoZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICBpZiAob25XYXRjaGluZ0lzRW5hYmxlZCAmJiAhX3RoaXMuX2lzSGVhcnRCZWF0QWN0aXZlKF90aGlzLmhlYXJ0QmVhdCwgX3RoaXMuX2hlYXJ0QmVhdFJhdGUpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tIZWFydEJlYXQuX3dhdGNoSGVhcnRCZWF0XSBoYXMgc3RvcHBlZCAnLCBfdGhpcy5fZGF0YU9iamVjdC5kYXRhKTtcclxuXHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh3YXRjaGVyKTtcclxuICAgICAgICBzeW5jRnVuKF90aGlzKTtcclxuICAgICAgfSBlbHNlIGlmICghb25XYXRjaGluZ0lzRW5hYmxlZCAmJiB0aGlzLl9pc0hlYXJ0QmVhdEFjdGl2ZShfdGhpcy5oZWFydEJlYXQsIF90aGlzLl9oZWFydEJlYXRSYXRlKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbSGVhcnRCZWF0Ll93YXRjaEhlYXJ0QmVhdF0gaGFzIGNoYW5nZWQgdG8gZGlzYWJsZWQgJywgX3RoaXMuX2RhdGFPYmplY3QuZGF0YSk7XHJcblxyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwod2F0Y2hlcik7XHJcbiAgICAgICAgc3luY0Z1bigpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSwgcmF0ZSAqIDEwMDAgKiAyKTtcclxuXHJcbiAgfVxyXG5cclxuICBfb25IZXJ0YmVhdFN0b3BwZWQoX3RoaXMpIHtcclxuXHJcbiAgICBfdGhpcy5fc3RhcnRIZWFydEJlYXQoX3RoaXMuX2hlYXJ0QmVhdFJhdGUpO1xyXG4gICAgX3RoaXMuX3N0YXJ0U3luYygpO1xyXG4gIH1cclxuXHJcblxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgSGVhcnRCZWF0O1xyXG4iLCIvKipcclxuKiBUaGUgSHlwZXJ0eSBSZXNvdXJjZSBEYXRhIE1vZGVsIGlzIHVzZWQgdG8gbW9kZWwgcmVzb3VjZXMgaGFuZGxlZCBieSBIeXBlcnRpZXMgYW5kIERhdGEgT2JqZWN0cyBpbmNsdWRpbmcgY2hhdCBtZXNzYWdlcywgZmlsZXMsIHJlYWwgdGltZSBodW1hbiBhdWRpbyBhbmQgdmlkZW8uLlxyXG4qXHJcbiovXHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdIeXBlcnR5UmVzb3VyY2UnKTtcclxuXHJcbmltcG9ydCB7IGRlZXBDbG9uZSB9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcclxuaW1wb3J0IERhdGFPYmplY3RDaGlsZCBmcm9tICcuLi9zeW5jaGVyL0RhdGFPYmplY3RDaGlsZC5qcyc7XHJcblxyXG5jbGFzcyBIeXBlcnR5UmVzb3VyY2UgZXh0ZW5kcyBEYXRhT2JqZWN0Q2hpbGQge1xyXG5cclxuICAvKipcclxuICAqIEh5cGVydHlSZXNvdXJjZSBjb25zdHJ1Y3RvclxyXG4gICpcclxuICAqIEBwYXJhbSAge1VSTH0gbG9jYWxSdW50aW1lVVJMIFJ1bnRpbWVVUkwgb2YgbG9jYWwgcnVudGltZVxyXG4gICogQHBhcmFtICB7VVJMfSBpbnB1dC5vd25lciBIeXBlcnR5VVJMIG9mIHRoZSBIeXBlcnR5IGhhbmRsaW5nIHRoaXMgcmVzb3VyY2VcclxuICAqIEBwYXJhbSAge1VSTH0gaW5wdXQucnVudGltZSBSdW50aW1lIFVSTCB3aGVyZSB0aGlzIHJlc291cmNlIGlzIGhvc3RlZFxyXG4gICogQHBhcmFtICB7QnVzfSBpbnB1dC5idXMgc2FuZGJveCBtZXNzYWdlIGJ1c1xyXG4gICogQHBhcmFtICB7RGF0YU9iamVjdH0gaW5wdXQucGFyZW50IFBhcmVudCBEYXRhIE9iamVjdCB3aGVyZSB0aGUgSHlwZXJ0eVJlc291cmNlIGlzIGhhbmRsZWQgYXMgYSBjaGlsZFxyXG4gICogQHBhcmFtICB7Qm9vbGVhbn0gaXNTZW5kZXIgaW5kaWNhdGVzIGlmIHBhcmVudCBpcyBSZXBvcnRlciBvciBhbiBPYnNlcnZlclxyXG4gICogQHBhcmFtICB7QXJyYXl9IGlucHV0IG9wdGlvbmFsIGlucHV0IHBhcmFtZXRlcnNcclxuICAqL1xyXG5cclxuICBjb25zdHJ1Y3Rvcihpc1NlbmRlciwgaW5wdXQpIHtcclxuICAgIHN1cGVyKGlucHV0KTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuYXJyYXlidWZmZXJTaXplTGltaXQgPSA1MjQyODgwOyAvL2Fib3ZlIHRoaXMgbGltaXQgY29udGVudCBpcyBub3Qgc2F2ZWQgYXMgQXJyYXlCdWZmZXJcclxuXHJcbiAgICBfdGhpcy5faXNTZW5kZXIgPSBpc1NlbmRlcjtcclxuXHJcbiAgICBfdGhpcy5fbG9jYWxTdG9yYWdlVVJMID0gX3RoaXMuX3BhcmVudE9iamVjdC5fc3luY2hlci5fcnVudGltZVVybCArICcvc3RvcmFnZSc7XHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0IHJlc291cmNlVHlwZSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMubWV0YWRhdGEucmVzb3VyY2VUeXBlO1xyXG4gIH1cclxuXHJcbiAgZ2V0IG1pbWV0eXBlKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fbWV0YWRhdGEudHlwZTtcclxuICB9XHJcblxyXG4gIGdldCBjb250ZW50KCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fY29udGVudDtcclxuICB9XHJcblxyXG4gIGdldCBjb250ZW50VVJMKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fbWV0YWRhdGEuY29udGVudFVSTDtcclxuICB9XHJcblxyXG4gIGdldCBzaGFyZWFibGUoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IHNoYXJlYWJsZSA9IHN1cGVyLm1ldGFkYXRhO1xyXG4gICAgc2hhcmVhYmxlLnJlc291cmNlVHlwZSA9IF90aGlzLnJlc291cmNlVHlwZTtcclxuICAgIHJldHVybiBzaGFyZWFibGU7XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gIHNldCBwYXJlbnQocGFyZW50KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX3BhcmVudCA9IHBhcmVudDtcclxuICB9Ki9cclxuXHJcbiAgc2F2ZSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IG1zZyA9IHtcclxuICAgICAgICBmcm9tOiBfdGhpcy5fb3duZXIsXHJcbiAgICAgICAgdG86IF90aGlzLl9sb2NhbFN0b3JhZ2VVUkwsXHJcbiAgICAgICAgdHlwZTogJ2NyZWF0ZScsXHJcbiAgICAgICAgYm9keTogeyB2YWx1ZTogZGVlcENsb25lKF90aGlzLl9tZXRhZGF0YSkgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgbGV0IGNhbGxiYWNrID0gKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmluZm8oJ1tIeXBlcnR5UmVzb3VyY2Uuc2F2ZV0gcmVwbHk6ICcsIHJlcGx5KTtcclxuICAgICAgICBfdGhpcy5fYnVzLnJlbW92ZVJlc3BvbnNlTGlzdGVuZXIoX3RoaXMuX293bmVyLCByZXBseS5pZCk7XHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICBpZiAocmVwbHkuYm9keS52YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAoIV90aGlzLl9tZXRhZGF0YS5jb250ZW50VVJMKSBfdGhpcy5fbWV0YWRhdGEuY29udGVudFVSTCA9IFtdO1xyXG4gICAgICAgICAgICBfdGhpcy5fbWV0YWRhdGEuY29udGVudFVSTC5wdXNoKHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH0gZWxzZSByZWplY3QocmVwbHkuYm9keS5jb2RlICsgJyAnICsgcmVwbHkuYm9keS5kZXNjKTtcclxuXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBtc2cuYm9keS52YWx1ZS5jb250ZW50ID0gX3RoaXMuX2NvbnRlbnQ7XHJcblxyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZywgY2FsbGJhY2ssIGZhbHNlKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIEZ1bmN0aW9uIHRvIFJlYWQgSHlwZXJ0eVJlc291cmNlXHJcbiAgKlxyXG4gICogQHBhcmFtICB7fSBjYWxsYmFjayBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2l0aCBwcm9ncmVzcyBpbmZvcm1hdGlvbiBpbiB0ZXJtcyBvZiBwZXJjZW50YWdlXHJcbiAgKiBAcmV0dXJuICB7UHJvbWlzZX0gIGlucHV0IG9wdGlvbmFsIGlucHV0IHBhcmFtZXRlcnNcclxuICAqL1xyXG5cclxuXHJcbiAgcmVhZChjYWxsYmFjaykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxvZy5pbmZvKCdbSHlwZXJ0eVJlc291cmNlLnJlYWRdICcsIHRoaXMpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5jb250ZW50KSB7XHJcbiAgICAgICAgcmVzb2x2ZShfdGhpcyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIC8vVE9ETzogdXNlIGFuIGl0ZXJhdGlvbiB0byBnZXQgb25saW5lIHJ1bnRpbWUgc3RvcmFnZXMgd2hlbiBzb21lIGFyZSBvZmZsaW5lXHJcbiAgICAgICAgbGV0IHN0b3JhZ2UgPSBfdGhpcy5fZ2V0QmVzdENvbnRlbnRVUkwoX3RoaXMuX21ldGFkYXRhLmNvbnRlbnRVUkwpO1xyXG5cclxuICAgICAgICBsb2cubG9nKCdTdG9yYWdlOicsIHN0b3JhZ2UpO1xyXG5cclxuICAgICAgICBsZXQgbXNnID0ge1xyXG4gICAgICAgICAgZnJvbTogX3RoaXMuX293bmVyLFxyXG4gICAgICAgICAgdG86IHN0b3JhZ2UudXJsLFxyXG4gICAgICAgICAgdHlwZTogJ3JlYWQnLFxyXG4gICAgICAgICAgYm9keTogeyByZXNvdXJjZTogc3RvcmFnZS51cmwgKyAnLycgKyBzdG9yYWdlLnJlc291cmNlLCBwMnA6IHRydWUgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChfdGhpcy5tZXRhZGF0YS5wMnBSZXF1ZXN0ZXIgJiYgX3RoaXMubWV0YWRhdGEucDJwSGFuZGxlcikge1xyXG4gICAgICAgICAgbXNnLmJvZHkucDJwUmVxdWVzdGVyID0gX3RoaXMubWV0YWRhdGEucDJwUmVxdWVzdGVyO1xyXG4gICAgICAgICAgbXNnLmJvZHkucDJwSGFuZGxlciA9IF90aGlzLm1ldGFkYXRhLnAycEhhbmRsZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBnZXQgdGhlIHJlc291cmNlIGZpcnN0IG9uIHRoZSBMb2NhbCBIeXBlcnR5IFJlc291cmNlIFN0b3JhZ2U7XHJcbiAgICAgICAgX3RoaXMuX2dldEJlc3RSZXNvdXJjZShtc2csIGNhbGxiYWNrKS50aGVuKChyZXBseSkgPT4ge1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1tIeXBlcnR5UmVzb3VyY2VdIC0gZ2V0IGxvY2FsbHkgdGhlIHJlc291cmNlOicsIHJlcGx5KTtcclxuICAgICAgICAgIHJlc29sdmUoX3RoaXMpO1xyXG4gICAgICAgIH0pLmNhdGNoKChyZXBseSkgPT4ge1xyXG5cclxuICAgICAgICAgIGxvZy53YXJuKCdbSHlwZXJ0eVJlc291cmNlXSAtIGdldCBsb2NhbGx5IHRoZSByZXNvdXJjZSBmYWlsJywgcmVwbHkpO1xyXG5cclxuICAgICAgICAgIC8vIEdlbmVyYXRlIG5ldyBtZXNzYWdlIHRvIG5vdCB1c2UgdGhlIHNhbWUgaWQgb2YgdGhlIGxhc3Qgb25lO1xyXG4gICAgICAgICAgbGV0IG1zZyA9IHtcclxuICAgICAgICAgICAgZnJvbTogX3RoaXMuX293bmVyLFxyXG4gICAgICAgICAgICB0bzogc3RvcmFnZS5yZW1vdGVVUkwsXHJcbiAgICAgICAgICAgIHR5cGU6ICdyZWFkJyxcclxuICAgICAgICAgICAgYm9keTogeyByZXNvdXJjZTogc3RvcmFnZS5yZW1vdGVVUkwgKyAnLycgKyBzdG9yYWdlLnJlc291cmNlLCBwMnA6IHRydWUgfVxyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICBpZiAoX3RoaXMubWV0YWRhdGEucDJwUmVxdWVzdGVyICYmIF90aGlzLm1ldGFkYXRhLnAycEhhbmRsZXIpIHtcclxuICAgICAgICAgICAgbXNnLmJvZHkucDJwUmVxdWVzdGVyID0gX3RoaXMubWV0YWRhdGEucDJwUmVxdWVzdGVyO1xyXG4gICAgICAgICAgICBtc2cuYm9keS5wMnBIYW5kbGVyID0gX3RoaXMubWV0YWRhdGEucDJwSGFuZGxlcjtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBnZXQgdGhlIHJlc291cmNlIG9uIHRoZSBSZW1vdGUgSHlwZXJ0eSBSZXNvdXJjZSBTdG9yYWdlO1xyXG4gICAgICAgICAgX3RoaXMuX2dldEJlc3RSZXNvdXJjZShtc2csIGNhbGxiYWNrKS50aGVuKChyZXBseSkgPT4ge1xyXG4gICAgICAgICAgICBsb2cud2FybignW0h5cGVydHlSZXNvdXJjZV0gLSBnZXQgcmVtb3RlbHkgdGhlIHJlc291cmNlJywgcmVwbHkpO1xyXG4gICAgICAgICAgICByZXNvbHZlKF90aGlzKTtcclxuICAgICAgICAgIH0pLmNhdGNoKChyZXBseSkgPT4ge1xyXG4gICAgICAgICAgICBsb2cud2FybignW0h5cGVydHlSZXNvdXJjZV0gLSBnZXQgcmVtb3RlbHkgdGhlIHJlc291cmNlIGZhaWwnLCByZXBseSk7XHJcbiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmNvZGUgKyAnICcgKyByZXBseS5ib2R5LmRlc2MpO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZ2V0QmVzdFJlc291cmNlKG1zZywgaW5Qcm9ncmVzc0NhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgd2FpdEZvclJlc3BvbnNlID0gc2V0VGltZW91dCgoKSA9PiB7XHJcblxyXG4gICAgICAgIC8vIElmIFJlcG9ydGVyIGRvZXMgIG5vdCByZXBseSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZFxyXG4gICAgICAgIF90aGlzLl9idXMucmVtb3ZlUmVzcG9uc2VMaXN0ZW5lcihfdGhpcy5fb3duZXIsIGlkKTtcclxuXHJcbiAgICAgICAgbXNnLmJvZHkuY29kZSA9IDQwODtcclxuICAgICAgICBtc2cuYm9keS5kZXNjID0gJ1Jlc3BvbnNlIHRpbWVvdXQnXHJcblxyXG4gICAgICAgIHJldHVybiByZWplY3QobXNnKTtcclxuXHJcbiAgICAgIH0sIDMwMDApO1xyXG5cclxuICAgICAgbGV0IGNhbGxiYWNrID0gKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmxvZygnW0h5cGVydHlSZXNvdXJjZS5yZWFkXSByZXBseTogJywgcmVwbHkpO1xyXG4gICAgICAgIGxldCBpZCA9IHJlcGx5LmlkO1xyXG5cclxuICAgICAgICBjbGVhclRpbWVvdXQod2FpdEZvclJlc3BvbnNlKTtcclxuXHJcbiAgICAgICAgc3dpdGNoIChyZXBseS5ib2R5LmNvZGUpIHtcclxuICAgICAgICAgIGNhc2UgMjAwOlxyXG4gICAgICAgICAgICBfdGhpcy5fY29udGVudCA9IHJlcGx5LmJvZHkudmFsdWUuY29udGVudDtcclxuXHJcbiAgICAgICAgICAgIC8vIHNhdmUgbG9jYWxseSBpZiBub3QgdG9vIGJpZ1xyXG4gICAgICAgICAgICBpZiAocmVwbHkuYm9keS52YWx1ZS5zaXplIDwgX3RoaXMuYXJyYXlidWZmZXJTaXplTGltaXQpIHtcclxuICAgICAgICAgICAgICBfdGhpcy5zYXZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF90aGlzLl9idXMucmVtb3ZlUmVzcG9uc2VMaXN0ZW5lcihfdGhpcy5fb3duZXIsIGlkKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXBseSk7XHJcblxyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICBjYXNlIDE4MzpcclxuICAgICAgICAgICAgaW5Qcm9ncmVzc0NhbGxiYWNrKHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBfdGhpcy5fYnVzLnJlbW92ZVJlc3BvbnNlTGlzdGVuZXIoX3RoaXMuX293bmVyLCBpZCk7XHJcbiAgICAgICAgICAgIHJlamVjdChyZXBseSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBsZXQgaWQgPSBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZywgY2FsbGJhY2ssIGZhbHNlKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvLyBSZW1vdmUgSHlwZXJ0eSBmcm9tIHRoZSBsb2NhbCBzdG9yYWdlXHJcblxyXG4gIGRlbGV0ZSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbG9nLmluZm8oJ1tIeXBlcnR5UmVzb3VyY2UuZGVsZXRlXScsIF90aGlzLm1ldGFkYXRhKTtcclxuXHJcblxyXG4gICAgbGV0IG1zZyA9IHtcclxuICAgICAgZnJvbTogX3RoaXMuX293bmVyLFxyXG4gICAgICB0bzogX3RoaXMuX2xvY2FsU3RvcmFnZVVSTCxcclxuICAgICAgdHlwZTogJ2RlbGV0ZScsXHJcbiAgICAgIGJvZHk6IHsgcmVzb3VyY2VzOiBfdGhpcy5tZXRhZGF0YS5jb250ZW50VVJMIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMzAwKSByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIGVsc2UgcmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZ2V0QmVzdENvbnRlbnRVUkwoY29udGVudFVSTExpc3QpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGNvbnN0IGNvbnRlbnRVUkwgPSBjb250ZW50VVJMTGlzdFswXTtcclxuICAgIGNvbnN0IHNwbGl0ZWRSZXNvdXJjZSA9IGNvbnRlbnRVUkwuc3Vic3RyKGNvbnRlbnRVUkwubGFzdEluZGV4T2YoJy8nKSArIDEpO1xyXG4gICAgY29uc3QgdXJsID0gX3RoaXMuX2xvY2FsU3RvcmFnZVVSTDsgLy8gY29udGVudFVSTC5zdWJzdHIoMCwgY29udGVudFVSTC5sYXN0SW5kZXhPZignLycpKTtcclxuICAgIGNvbnN0IHJlbW90ZVJlc291cmNlID0gY29udGVudFVSTC5zdWJzdHIoMCwgY29udGVudFVSTC5sYXN0SW5kZXhPZignLycpKTtcclxuXHJcbiAgICByZXR1cm4ge3VybDogdXJsLCByZXNvdXJjZTogc3BsaXRlZFJlc291cmNlLCByZW1vdGVVUkw6IHJlbW90ZVJlc291cmNlIH07XHJcblxyXG4gIH1cclxuXHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBIeXBlcnR5UmVzb3VyY2U7XHJcbiIsImxldCBoYXNCbG9iQ29uc3RydWN0b3IgPSB0eXBlb2YoQmxvYikgIT09ICd1bmRlZmluZWQnICYmIChmdW5jdGlvbiAoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBCb29sZWFuKG5ldyBCbG9iKCkpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufSgpKTtcclxuXHJcbmxldCBoYXNBcnJheUJ1ZmZlclZpZXdTdXBwb3J0ID0gaGFzQmxvYkNvbnN0cnVjdG9yICYmIHR5cGVvZihVaW50OEFycmF5KSAhPT0gJ3VuZGVmaW5lZCcgJiYgKGZ1bmN0aW9uICgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBCbG9iKFtuZXcgVWludDhBcnJheSgxMDApXSkuc2l6ZSA9PT0gMTAwO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufSgpKTtcclxuXHJcbmxldCBoYXNUb0Jsb2JTdXBwb3J0ID0gKHR5cGVvZiBIVE1MQ2FudmFzRWxlbWVudCAhPT0gXCJ1bmRlZmluZWRcIiA/IEhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZS50b0Jsb2IgOiBmYWxzZSk7XHJcblxyXG5sZXQgaGFzQmxvYlN1cHBvcnQgPSAoaGFzVG9CbG9iU3VwcG9ydCB8fCAodHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGF0b2IgIT09ICd1bmRlZmluZWQnKSk7XHJcblxyXG5sZXQgaGFzUmVhZGVyU3VwcG9ydCA9ICh0eXBlb2YgRmlsZVJlYWRlciAhPT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIFVSTCAhPT0gJ3VuZGVmaW5lZCcpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW1hZ2VUb29scyB7XHJcbiAgICBzdGF0aWMgcmVzaXplKGZpbGUsIG1heERpbWVuc2lvbnMsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBtYXhEaW1lbnNpb25zID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrID0gbWF4RGltZW5zaW9ucztcclxuICAgICAgICAgICAgbWF4RGltZW5zaW9ucyA9IHtcclxuICAgICAgICAgICAgICAgIHdpZHRoOiA2NDAsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQ4MFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IG1heFdpZHRoICA9IG1heERpbWVuc2lvbnMud2lkdGg7XHJcbiAgICAgICAgbGV0IG1heEhlaWdodCA9IG1heERpbWVuc2lvbnMuaGVpZ2h0O1xyXG5cclxuICAgICAgICBpZiAoIUltYWdlVG9vbHMuaXNTdXBwb3J0ZWQoKSB8fCAhZmlsZS50eXBlLm1hdGNoKC9pbWFnZS4qLykpIHtcclxuICAgICAgICAgICAgY2FsbGJhY2soZmlsZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZmlsZS50eXBlLm1hdGNoKC9pbWFnZVxcL2dpZi8pKSB7XHJcbiAgICAgICAgICAgIC8vIE5vdCBhdHRlbXB0aW5nLCBjb3VsZCBiZSBhbiBhbmltYXRlZCBnaWZcclxuICAgICAgICAgICAgY2FsbGJhY2soZmlsZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiB1c2UgaHR0cHM6Ly9naXRodWIuY29tL2FudGltYXR0ZXIxNS93aGFtbXkgdG8gY29udmVydCBnaWYgdG8gd2VibVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgaW1hZ2Uub25sb2FkID0gKGltZ0V2dCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgd2lkdGggID0gaW1hZ2Uud2lkdGg7XHJcbiAgICAgICAgICAgIGxldCBoZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XHJcbiAgICAgICAgICAgIGxldCBpc1Rvb0xhcmdlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAod2lkdGggPj0gaGVpZ2h0ICYmIHdpZHRoID4gbWF4RGltZW5zaW9ucy53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgLy8gd2lkdGggaXMgdGhlIGxhcmdlc3QgZGltZW5zaW9uLCBhbmQgaXQncyB0b28gYmlnLlxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0ICo9IG1heERpbWVuc2lvbnMud2lkdGggLyB3aWR0aDtcclxuICAgICAgICAgICAgICAgIHdpZHRoID0gbWF4RGltZW5zaW9ucy53aWR0aDtcclxuICAgICAgICAgICAgICAgIGlzVG9vTGFyZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGhlaWdodCA+IG1heERpbWVuc2lvbnMuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBlaXRoZXIgd2lkdGggd2Fzbid0IG92ZXItc2l6ZSBvciBoZWlnaHQgaXMgdGhlIGxhcmdlc3QgZGltZW5zaW9uXHJcbiAgICAgICAgICAgICAgICAvLyBhbmQgdGhlIGhlaWdodCBpcyBvdmVyLXNpemVcclxuICAgICAgICAgICAgICAgIHdpZHRoICo9IG1heERpbWVuc2lvbnMuaGVpZ2h0IC8gaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gbWF4RGltZW5zaW9ucy5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBpc1Rvb0xhcmdlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFpc1Rvb0xhcmdlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBlYXJseSBleGl0OyBubyBuZWVkIHRvIHJlc2l6ZVxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZmlsZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgbGV0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgICAgICAgICBjdHguZHJhd0ltYWdlKGltYWdlLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoYXNUb0Jsb2JTdXBwb3J0KSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMudG9CbG9iKChibG9iKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soYmxvYiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9LCBmaWxlLnR5cGUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IGJsb2IgPSBJbWFnZVRvb2xzLl90b0Jsb2IoY2FudmFzLCBmaWxlLnR5cGUpO1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soYmxvYiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIEltYWdlVG9vbHMuX2xvYWRJbWFnZShpbWFnZSwgZmlsZSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBfdG9CbG9iKGNhbnZhcywgdHlwZSkge1xyXG4gICAgICAgIGxldCBkYXRhVVJJID0gY2FudmFzLnRvRGF0YVVSTCh0eXBlKTtcclxuICAgICAgICBsZXQgZGF0YVVSSVBhcnRzID0gZGF0YVVSSS5zcGxpdCgnLCcpO1xyXG4gICAgICAgIGxldCBieXRlU3RyaW5nO1xyXG4gICAgICAgIGlmIChkYXRhVVJJUGFydHNbMF0uaW5kZXhPZignYmFzZTY0JykgPj0gMCkge1xyXG4gICAgICAgICAgICAvLyBDb252ZXJ0IGJhc2U2NCB0byByYXcgYmluYXJ5IGRhdGEgaGVsZCBpbiBhIHN0cmluZzpcclxuICAgICAgICAgICAgYnl0ZVN0cmluZyA9IGF0b2IoZGF0YVVSSVBhcnRzWzFdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBDb252ZXJ0IGJhc2U2NC9VUkxFbmNvZGVkIGRhdGEgY29tcG9uZW50IHRvIHJhdyBiaW5hcnkgZGF0YTpcclxuICAgICAgICAgICAgYnl0ZVN0cmluZyA9IGRlY29kZVVSSUNvbXBvbmVudChkYXRhVVJJUGFydHNbMV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgYXJyYXlCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoYnl0ZVN0cmluZy5sZW5ndGgpO1xyXG4gICAgICAgIGxldCBpbnRBcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBieXRlU3RyaW5nLmxlbmd0aDsgaSArPSAxKSB7XHJcbiAgICAgICAgICAgIGludEFycmF5W2ldID0gYnl0ZVN0cmluZy5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IG1pbWVTdHJpbmcgPSBkYXRhVVJJUGFydHNbMF0uc3BsaXQoJzonKVsxXS5zcGxpdCgnOycpWzBdO1xyXG4gICAgICAgIGxldCBibG9iID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKGhhc0Jsb2JDb25zdHJ1Y3Rvcikge1xyXG4gICAgICAgICAgICBibG9iID0gbmV3IEJsb2IoXHJcbiAgICAgICAgICAgICAgICBbaGFzQXJyYXlCdWZmZXJWaWV3U3VwcG9ydCA/IGludEFycmF5IDogYXJyYXlCdWZmZXJdLFxyXG4gICAgICAgICAgICAgICAge3R5cGU6IG1pbWVTdHJpbmd9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IGJiID0gbmV3IEJsb2JCdWlsZGVyKCk7XHJcbiAgICAgICAgICAgIGJiLmFwcGVuZChhcnJheUJ1ZmZlcik7XHJcbiAgICAgICAgICAgIGJsb2IgPSBiYi5nZXRCbG9iKG1pbWVTdHJpbmcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGJsb2I7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIF9sb2FkSW1hZ2UoaW1hZ2UsIGZpbGUsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZihVUkwpID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgICAgICAgICAgICAgaW1hZ2Uuc3JjID0gZXZ0LnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHsgY2FsbGJhY2soKTsgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGltYWdlLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7XHJcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykgeyBjYWxsYmFjaygpOyB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBzdGF0aWMgaXNTdXBwb3J0ZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgKHR5cGVvZihIVE1MQ2FudmFzRWxlbWVudCkgIT09ICd1bmRlZmluZWQnKSBcclxuICAgICAgICAgICAgJiYgaGFzQmxvYlN1cHBvcnRcclxuICAgICAgICAgICAgJiYgaGFzUmVhZGVyU3VwcG9ydFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuIiwiLyoqXHJcbiogVGhlIEh5cGVydHkgUmVzb3VyY2UgRGF0YSBNb2RlbCBpcyB1c2VkIHRvIG1vZGVsIHJlc291Y2VzIGhhbmRsZWQgYnkgSHlwZXJ0aWVzIGFuZCBEYXRhIE9iamVjdHMgaW5jbHVkaW5nIGNoYXQgbWVzc2FnZXMsIGZpbGVzLCByZWFsIHRpbWUgaHVtYW4gYXVkaW8gYW5kIHZpZGVvLi5cclxuKlxyXG4qL1xyXG5cclxuLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignRmlsZUh5cGVydHlSZXNvdXJjZScpO1xyXG5cclxuaW1wb3J0IEh5cGVydHlSZXNvdXJjZSBmcm9tICcuL0h5cGVydHlSZXNvdXJjZSc7XHJcbmltcG9ydCB7IGRlZXBDbG9uZSB9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcclxuaW1wb3J0IEltYWdlVG9vbHMgZnJvbSAnLi4vdXRpbHMvSW1hZ2VUb29scy5qcyc7XHJcblxyXG5cclxuY2xhc3MgRmlsZUh5cGVydHlSZXNvdXJjZSBleHRlbmRzIEh5cGVydHlSZXNvdXJjZSB7XHJcblxyXG4gIC8qKlxyXG4gICogRmlsZUh5cGVydHlSZXNvdXJjZSBjb25zdHJ1Y3RvclxyXG4gICpcclxuICAqIEBwYXJhbSAge1VSTH0gb3duZXIgSHlwZXJ0eVVSTCBvZiB0aGUgSHlwZXJ0eSBoYW5kbGluZyB0aGlzIHJlc291cmNlXHJcbiAgKiBAcGFyYW0gIHtVUkx9IHJ1bnRpbWUgUnVudGltZSBVUkwgd2hlcmUgdGhpcyByZXNvdXJjZSBpcyBob3N0ZWRcclxuICAqIEBwYXJhbSAge0J1c30gYnVzIHNhbmRib3ggbWVzc2FnZSBidXNcclxuICAqIEBwYXJhbSAge0RhdGFPYmplY3R9IHBhcmVudCBQYXJlbnQgRGF0YSBPYmplY3Qgd2hlcmUgdGhlIEh5cGVydHlSZXNvdXJjZSBpcyBoYW5kbGVkIGFzIGEgY2hpbGRcclxuICAqIEBwYXJhbSAge0ZpbGV9IGZpbGUgZmlsZSB0byBiZSBlbmNvZGVkIGFzIEh5cGVydHlSZXNvdXJjZVxyXG4gICogQHBhcmFtICB7Qm9vbGVhbn0gaXNSZXBvcnRlciBpbmRpY2F0ZXMgaWYgcGFyZW50IGlzIFJlcG9ydGVyIG9yIGFuIE9ic2VydmVyXHJcbiAgKiBAcGFyYW0gIHtBcnJheX0gaW5wdXQgb3B0aW9uYWwgaW5wdXQgcGFyYW1ldGVyc1xyXG4gICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKGlzU2VuZGVyLCBpbnB1dCkge1xyXG5cclxuICAgIHN1cGVyKGlzU2VuZGVyLCBpbnB1dCk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5tZXRhZGF0YS5yZXNvdXJjZVR5cGUgPSAnZmlsZSc7XHJcblxyXG4gIH1cclxuXHJcbiAgaW5pdChmaWxlKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGlmICghZmlsZSkgdGhyb3cgbmV3IEVycm9yKCdbRmlsZUh5cGVydHlSZXNvdXJjZS5jb25zdHJ1Y3Rvcl0gbWlzc2luZyBtYW5kYXRvcnkgKmZpbGUqIGlucHV0ICcpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIF90aGlzLl9tZXRhZGF0YS5uYW1lID0gZmlsZS5uYW1lO1xyXG4gICAgICBfdGhpcy5fbWV0YWRhdGEubGFzdE1vZGlmaWVkID0gZmlsZS5sYXN0TW9kaWZpZWQ7XHJcbiAgICAgIF90aGlzLl9tZXRhZGF0YS5zaXplID0gZmlsZS5zaXplO1xyXG4gICAgICBfdGhpcy5fbWV0YWRhdGEubWltZXR5cGUgPSBmaWxlLnR5cGU7XHJcblxyXG4gICAgICBsb2cubG9nKCdbRmlsZUh5cGVydHlSZXNvdXJjZS5pbml0XSBmaWxlOiAnLCBmaWxlKTtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5faXNTZW5kZXIpIHtcclxuXHJcbiAgICAgICAgbGV0IG1pbWV0eXBlID0gZmlsZS50eXBlLnNwbGl0KCcvJylbMF07XHJcblxyXG4gICAgICAgIHN3aXRjaCAobWltZXR5cGUpIHtcclxuICAgICAgICAgIGNhc2UgJ2ltYWdlJyA6XHJcbiAgICAgICAgICAgIF90aGlzLl9nZXRJbWFnZVByZXZpZXcoZmlsZSkudGhlbigocHJldmlldyk9PntcclxuICAgICAgICAgICAgICBfdGhpcy5fbWV0YWRhdGEucHJldmlldyA9IHByZXZpZXc7XHJcbiAgICAgICAgICAgICAgX3RoaXMuX2NvbnRlbnQgPSBmaWxlO1xyXG4gICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgZGVmYXVsdCA6XHJcbiAgICAgICAgICAgIF90aGlzLl9jb250ZW50ID0gZmlsZTtcclxuICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGlmIHRvbyBiaWcgbGV0cyBzdG9yZSBhcyBGaWxlIGFuZCBhc0FycmF5IEJ1ZmZlclxyXG5cclxuICAgICAgLy8gIGlmIChmaWxlLnNpemUgPiBfdGhpcy5hcnJheWJ1ZmZlclNpemVMaW1pdCkge1xyXG4gICAgICAvKiAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuXHJcbiAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24odGhlRmlsZSkge1xyXG5cclxuICAgICAgICAgICAgbG9nLmxvZygnW0ZpbGVIeXBlcnR5UmVzb3VyY2UuaW5pdF0gZmlsZSBsb2FkZWQgJywgdGhlRmlsZSk7XHJcblxyXG4gICAgICAgICAgICBfdGhpcy5fY29udGVudCA9IHRoZUZpbGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG5cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7XHJcblxyXG4gICAgICAgIH0qL1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICBfdGhpcy5fY29udGVudCA9IGZpbGUuY29udGVudDtcclxuICAgICAgaWYgKGZpbGUucHJldmlldykgX3RoaXMuX21ldGFkYXRhLnByZXZpZXcgPSBmaWxlLnByZXZpZXc7XHJcbiAgICAgIHJlc29sdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuIF9nZXRJbWFnZVByZXZpZXcoaW1hZ2Upe1xyXG4gICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLHJlamVjdCk9PntcclxuXHJcbiAgIEltYWdlVG9vbHMucmVzaXplKGltYWdlLCB7XHJcbiAgICAgICAgd2lkdGg6IDEwMCwgLy8gbWF4aW11bSB3aWR0aFxyXG4gICAgICAgIGhlaWdodDogMTAwIC8vIG1heGltdW0gaGVpZ2h0XHJcbiAgICB9LCBmdW5jdGlvbihibG9iLCBkaWRJdFJlc2l6ZSkge1xyXG4gICAgICAgIC8vIGRpZEl0UmVzaXplIHdpbGwgYmUgdHJ1ZSBpZiBpdCBtYW5hZ2VkIHRvIHJlc2l6ZSBpdCwgb3RoZXJ3aXNlIGZhbHNlIChhbmQgd2lsbCByZXR1cm4gdGhlIG9yaWdpbmFsIGZpbGUgYXMgJ2Jsb2InKVxyXG4gICAgICAgIGlmIChkaWRJdFJlc2l6ZSkge1xyXG4gICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYmxvYik7XHJcblxyXG4gICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKHRoZUltYWdlKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUodGhlSW1hZ2UudGFyZ2V0LnJlc3VsdCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsb2cud2FybignW0ZpbGVIeXBlcnR5UmVzb3VyY2UuX2dldEltYWdlUHJldmlld10gdW5hYmxlIHRvIGNyZWF0ZSBpbWFnZSBwcmV2aWV3IGZyb20gb3JpZ2luYWwgaW1hZ2UgJyk7XHJcbiAgICAgICAgcmVzb2x2ZSh1bmRlZmluZWQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuIH1cclxuXHJcblxyXG5cclxuICBnZXQgbmFtZSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX21ldGFkYXRhLm5hbWU7XHJcbiAgfVxyXG5cclxuICBnZXQgcHJldmlldygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX21ldGFkYXRhLnByZXZpZXc7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFNoYXJlIGZpbGUgYXMgYSBkYXRhIG9iamVjdCBjaGlsZCBvZiBhIGRhdGEgb2JqZWN0IHBhcmVudFxyXG4gICpcclxuICAqIEBwYXJhbSAge3N0cmluZ30gY2hpbGRyZW4gRGF0YSBPYmplY3QgUGFyZW50IGNoaWxkcmVuIG5hbWUgd2hlcmUgdGhlIGZpbGUgaXMgc2hhcmVkXHJcbiAgKi9cclxuXHJcbi8qICBzaGFyZShjaGlsZHJlbikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIC8vdG8gYmUgaW1wcm92ZWQgYW5kIGFkYXB0ZWRcclxuXHJcbiAgICAgIGlmICghX3RoaXMuX2lzU2VuZGVyKSByZXR1cm4gcmVqZWN0KCdbRmlsZUh5cGVydHlSZXNvdXJjZS5zaGFyZV0gT2JzZXJ2ZXJzIGNhbiBub3Qgc2hhcmUgZmlsZXMnKTtcclxuXHJcbiAgICAgIGxldCBmaWxlMnNoYXJlID0gX3RoaXMuX21ldGFkYXRhO1xyXG4gICAgICBmaWxlMnNoYXJlLnR5cGUgPSBfdGhpcy5fdHlwZTtcclxuXHJcbiAgICAgIF90aGlzLl9wYXJlbnQuYWRkQ2hpbGQoY2hpbGRyZW4sIGZpbGUyc2hhcmUpLnRoZW4oZnVuY3Rpb24oZGF0YU9iamVjdENoaWxkKSB7XHJcbiAgICAgICAgbG9nLmxvZygnW0ZpbGVIeXBlcnR5UmVzb3VyY2Uuc2hhcmVdIG9iamVjdCBjaGlsZDogJywgZGF0YU9iamVjdENoaWxkKTtcclxuXHJcbiAgICAgICAgbGV0IHNoYXJlZEZpbGUgPSBkYXRhT2JqZWN0Q2hpbGQuZGF0YTtcclxuXHJcbiAgICAgICAgcmVzb2x2ZShzaGFyZWRGaWxlKTtcclxuXHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbikge1xyXG4gICAgICAgIGxvZy5lcnJvcignUmVhc29uOicsIHJlYXNvbik7XHJcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9Ki9cclxuXHJcbiAgLyoqXHJcbiAgKiBSZXR1cm5zIGZpbGUgY29udGVudCBvcHRpbWlzZWQgdG8gYmUgZGlzcGxheWVkIGluIGEgbWVzc2FnZSBsaW5lXHJcbiAgKlxyXG4gICogQHBhcmFtICB7c3RyaW5nfSBjaGlsZHJlbiBEYXRhIE9iamVjdCBQYXJlbnQgY2hpbGRyZW4gbmFtZSB3aGVyZSB0aGUgZmlsZSBpcyBzaGFyZWRcclxuICAqL1xyXG5cclxuICB0b01lc3NhZ2UoKSB7XHJcbiAgICAvL1RPRE86IHRvIGJlIGltcGxlbWVudGVkLiBJdCBzaG91bGQgcmV0dXJuIEhUTUwgd2l0aCBpbWcgYXR0cmlidXRlIGFzIGEgdGh1bWJuYWlsIHBsdXMgdGhlIG5hbWUuXHJcbiAgfVxyXG5cclxufVxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZpbGVIeXBlcnR5UmVzb3VyY2U7XHJcbiIsIi8qKlxyXG4qIFRoZSBIeXBlcnR5IFJlc291cmNlIERhdGEgTW9kZWwgaXMgdXNlZCB0byBtb2RlbCByZXNvdWNlcyBoYW5kbGVkIGJ5IEh5cGVydGllcyBhbmQgRGF0YSBPYmplY3RzIGluY2x1ZGluZyBjaGF0IG1lc3NhZ2VzLCBmaWxlcywgcmVhbCB0aW1lIGh1bWFuIGF1ZGlvIGFuZCB2aWRlby4uXHJcbipcclxuKi9cclxuXHJcbmltcG9ydCBGaWxlSHlwZXJ0eVJlc291cmNlIGZyb20gJy4vRmlsZUh5cGVydHlSZXNvdXJjZSc7XHJcblxyXG5jbGFzcyBIeXBlcnR5UmVzb3VyY2VGYWN0b3J5IHtcclxuXHJcbiAgLyoqXHJcbiAgKiBIeXBlcnR5UmVzb3VyY2VGYWN0b3J5IGNvbnN0cnVjdG9yXHJcbiAgKlxyXG4gICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG5cclxuICB9XHJcblxyXG4gIGNyZWF0ZUh5cGVydHlSZXNvdXJjZShpc1NlbmRlciwgdHlwZSwgbWV0YWRhdGEpIHtcclxuICAgIGxldCBuZXdIeXBlcnR5UmVzb3VyY2U7XHJcblxyXG4gICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgIGNhc2UgJ2ZpbGUnOlxyXG4gICAgICAgIG5ld0h5cGVydHlSZXNvdXJjZSA9IG5ldyBGaWxlSHlwZXJ0eVJlc291cmNlKGlzU2VuZGVyLCBtZXRhZGF0YSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbSHlwZXJ0eVJlc291cmNlRmFjdG9yeS5jcmVhdGVIeXBlcnR5UmVzb3VyY2VdIG5vdCBzdXBwb3J0ZWQgdHlwZTogJywgdHlwZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybihuZXdIeXBlcnR5UmVzb3VyY2UpO1xyXG5cclxuICB9XHJcblxyXG4gIGNyZWF0ZUh5cGVydHlSZXNvdXJjZVdpdGhDb250ZW50KGlzU2VuZGVyLCB0eXBlLCBjb250ZW50LCBtZXRhZGF0YSkge1xyXG4gICAgbGV0IG5ld0h5cGVydHlSZXNvdXJjZTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHJcbiAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgY2FzZSAnZmlsZSc6XHJcbiAgICAgICAgbmV3SHlwZXJ0eVJlc291cmNlID0gbmV3IEZpbGVIeXBlcnR5UmVzb3VyY2UoaXNTZW5kZXIsIG1ldGFkYXRhKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZWplY3QoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgbmV3SHlwZXJ0eVJlc291cmNlLmluaXQoY29udGVudCkudGhlbigoKT0+e1xyXG4gICAgICAgIHJldHVybiBuZXdIeXBlcnR5UmVzb3VyY2Uuc2F2ZSgpOy8vIHNraXAgc2F2ZT9cclxuICAgICAgfSkudGhlbigoKT0+e1xyXG4gICAgICAgIHJlc29sdmUobmV3SHlwZXJ0eVJlc291cmNlKTtcclxuICAgICAgfSk7XHJcblxyXG4gIH0pO1xyXG5cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEh5cGVydHlSZXNvdXJjZUZhY3Rvcnk7XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbi8vIExvZyBTeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ0RhdGFPYmplY3QnKTtcclxuXHJcbmltcG9ydCBTeW5jT2JqZWN0LCB7IENoYW5nZVR5cGUsIE9iamVjdFR5cGUgfSBmcm9tICcuL1Byb3h5T2JqZWN0JztcclxuaW1wb3J0IERhdGFPYmplY3RDaGlsZCBmcm9tICcuL0RhdGFPYmplY3RDaGlsZCc7XHJcbmltcG9ydCBIZWFydEJlYXQgZnJvbSAnLi9IZWFydEJlYXQnO1xyXG5pbXBvcnQgeyBkZWVwQ2xvbmUsIGRpdmlkZVVSTCB9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcclxuaW1wb3J0IEh5cGVydHlSZXNvdXJjZUZhY3RvcnkgZnJvbSAnLi4vaHlwZXJ0eS1yZXNvdXJjZS9IeXBlcnR5UmVzb3VyY2VGYWN0b3J5LmpzJztcclxuXHJcbi8qKlxyXG4gKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuXHJcbiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy5cclxuICovXHJcbmNsYXNzIERhdGFPYmplY3Qge1xyXG4gIC8qIHByaXZhdGVcclxuICBfdmVyc2lvbjogbnVtYmVyXHJcblxyXG4gIF9vd25lcjogSHlwZXJ0eVVSTFxyXG4gIF91cmw6IE9iamVjdFVSTFxyXG4gIF9zY2hlbWE6IFNjaGVtYVxyXG4gIF9idXM6IE1pbmlCdXNcclxuICBfc3RhdHVzOiBvbiB8IHBhdXNlZFxyXG4gIF9zeW5jT2JqOiBTeW5jRGF0YVxyXG5cclxuICBfY2hpbGRyZW46IHsgaWQ6IERhdGFPYmplY3RDaGlsZCB9XHJcbiAgX2NoaWxkcmVuTGlzdGVuZXI6IFtNc2dMaXN0ZW5lcl1cclxuXHJcbiAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLVxyXG4gIF9vbkFkZENoaWxkSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkXHJcbiAgKi9cclxuXHJcbiAgLyoqXHJcbiAgICogQGlnbm9yZVxyXG4gICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyIGNyZWF0ZSBvciBzdWJzY3JpYmUgbWV0aG9kJ3NcclxuICAgKi9cclxuXHJcbiAgY29uc3RydWN0b3IoaW5wdXQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgZnVuY3Rpb24gdGhyb3dNYW5kYXRvcnlQYXJtTWlzc2luZ0Vycm9yKHBhcikge1xyXG4gICAgICB0aHJvdyAnW0RhdGFPYmplY3RdICcgKyBwYXIgKyAnIG1hbmRhdG9yeSBwYXJhbWV0ZXIgaXMgbWlzc2luZyc7XHJcbiAgICB9XHJcblxyXG4gICAgaW5wdXQuc3luY2hlciA/IF90aGlzLl9zeW5jaGVyID0gaW5wdXQuc3luY2hlciA6IHRocm93TWFuZGF0b3J5UGFybU1pc3NpbmdFcnJvcignc3luY2hlcicpO1xyXG4gICAgaW5wdXQudXJsID8gX3RoaXMuX3VybCA9IGlucHV0LnVybCA6IHRocm93TWFuZGF0b3J5UGFybU1pc3NpbmdFcnJvcigndXJsJyk7XHJcbiAgICBpbnB1dC5jcmVhdGVkID8gX3RoaXMuX2NyZWF0ZWQgPSBpbnB1dC5jcmVhdGVkIDogdGhyb3dNYW5kYXRvcnlQYXJtTWlzc2luZ0Vycm9yKCdjcmVhdGVkJyk7XHJcbiAgICBpbnB1dC5yZXBvcnRlciA/IF90aGlzLl9yZXBvcnRlciA9IGlucHV0LnJlcG9ydGVyIDogdGhyb3dNYW5kYXRvcnlQYXJtTWlzc2luZ0Vycm9yKCdyZXBvcnRlcicpO1xyXG4gICAgaW5wdXQucnVudGltZSA/IF90aGlzLl9ydW50aW1lID0gaW5wdXQucnVudGltZSA6IHRocm93TWFuZGF0b3J5UGFybU1pc3NpbmdFcnJvcigncnVudGltZScpO1xyXG4gICAgaW5wdXQuc2NoZW1hID8gX3RoaXMuX3NjaGVtYSA9IGlucHV0LnNjaGVtYSA6IHRocm93TWFuZGF0b3J5UGFybU1pc3NpbmdFcnJvcignc2NoZW1hJyk7XHJcbiAgICBpbnB1dC5uYW1lID8gX3RoaXMuX25hbWUgPSBpbnB1dC5uYW1lIDogdGhyb3dNYW5kYXRvcnlQYXJtTWlzc2luZ0Vycm9yKCduYW1lJyk7XHJcblxyXG5cclxuICAgIF90aGlzLl9zdGF0dXMgPSBpbnB1dC5zdGF0dXM7XHJcblxyXG4gICAgaWYgKGlucHV0LmRhdGEpIHtcclxuICAgICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgU3luY09iamVjdChpbnB1dC5kYXRhKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IFN5bmNPYmplY3Qoe30pO1xyXG4gICAgfVxyXG4gICAgX3RoaXMuX2NoaWxkcmVucyA9IGlucHV0LmNoaWxkcmVucztcclxuXHJcbiAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5XHJcbiAgICBfdGhpcy5fbXV0dWFsID0gaW5wdXQubXV0dWFsO1xyXG5cclxuICAgIF90aGlzLl92ZXJzaW9uID0gMDtcclxuICAgIF90aGlzLl9jaGlsZElkID0gMTtcclxuICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVyOyAvL2J1cyBsaXN0ZW5lciBmb3IgY2hpbGRyZW5cclxuICAgIF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcjsgLy9IeXBlcnR5IHNpZGUgaGFuZGxlcnMgdG8gcHJvY2VzcyBjaGlsZCBvYmplY3RzIGNyZWF0ZWQgYnkgcmVtb3RlIEh5cGVydGllc1xyXG5cclxuICAgIF90aGlzLl9yZXN1bWVkID0gaW5wdXQucmVzdW1lO1xyXG5cclxuICAgIGlmIChpbnB1dC5yZXN1bWUpIHsgX3RoaXMuX3ZlcnNpb24gPSBpbnB1dC52ZXJzaW9uOyB9XHJcblxyXG4gICAgX3RoaXMuX293bmVyID0gaW5wdXQuc3luY2hlci5fb3duZXI7XHJcbiAgICBfdGhpcy5fYnVzID0gaW5wdXQuc3luY2hlci5fYnVzO1xyXG5cclxuICAgIGlmIChpbnB1dC5kZXNjcmlwdGlvbikgX3RoaXMuX2Rlc2NyaXB0aW9uID0gaW5wdXQuZGVzY3JpcHRpb247XHJcbiAgICBpZiAoaW5wdXQudGFncykgX3RoaXMuX3RhZ3MgPSBpbnB1dC50YWdzO1xyXG4gICAgaWYgKGlucHV0LnJlc291cmNlcykgX3RoaXMuX3Jlc291cmNlcyA9IGlucHV0LnJlc291cmNlcztcclxuICAgIGlmIChpbnB1dC5vYnNlcnZlclN0b3JhZ2UpIF90aGlzLl9vYnNlcnZlclN0b3JhZ2UgPSBpbnB1dC5vYnNlcnZlclN0b3JhZ2U7XHJcbiAgICBpZiAoaW5wdXQucHVibGljT2JzZXJ2YXRpb24pIF90aGlzLl9wdWJsaWNPYnNlcnZhdGlvbiA9IGlucHV0LnB1YmxpY09ic2VydmF0aW9uO1xyXG5cclxuICAgIF90aGlzLl9tZXRhZGF0YSA9IE9iamVjdC5hc3NpZ24oaW5wdXQpO1xyXG5cclxuICAgIC8vICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdF0gbXV0dWFsICcsIF90aGlzLl9tZXRhZGF0YS5tdXR1YWwpO1xyXG5cclxuICAgIGlmICghaW5wdXQuaGFzT3duUHJvcGVydHkoJ3Jlc3VtZScpIHx8IChpbnB1dC5oYXNPd25Qcm9wZXJ0eSgncmVzdW1lJykgJiYgIWlucHV0LnJlc3VtZSkpIHtcclxuICAgICAgX3RoaXMuX21ldGFkYXRhLmxhc3RNb2RpZmllZCA9IF90aGlzLl9tZXRhZGF0YS5jcmVhdGVkO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZSBfdGhpcy5fbWV0YWRhdGEuZGF0YTtcclxuICAgIGRlbGV0ZSBfdGhpcy5fbWV0YWRhdGEuc3luY2hlcjtcclxuICAgIGRlbGV0ZSBfdGhpcy5fbWV0YWRhdGEuYXV0aG9yaXNlO1xyXG5cclxuICAgIF90aGlzLl9oeXBlcnR5UmVzb3VyY2VGYWN0b3J5ID0gbmV3IEh5cGVydHlSZXNvdXJjZUZhY3RvcnkoKTtcclxuICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHMgPSB7fTtcclxuICAgIF90aGlzLl9zaGFyZWRDaGlsZHMgPSBbXTsgLy9jaGlsZE9iamVjdHMgdGhhdCB3ZXJlIG5vdCBzZW50IHlldCB0byBSZXBvcnRlcnNcclxuXHJcbiAgICBpZiAoaW5wdXQuYmFja3VwICYmIF90aGlzLl9jaGlsZHJlbnMpIHtcclxuICAgICAgbGV0IGxhc3RIZWFydGJlYXQgPSAoaW5wdXQuaGFzT3duUHJvcGVydHkoJ2NoaWxkcmVuT2JqZWN0cycpICYmIGlucHV0LmNoaWxkcmVuT2JqZWN0cy5oYXNPd25Qcm9wZXJ0eSgnaGVhcnRiZWF0JykpXHJcbiAgICAgICAgPyBpbnB1dC5jaGlsZHJlbk9iamVjdHMuaGVhcnRiZWF0IDogMDtcclxuICAgICAgX3RoaXMuX2hlYXJ0QmVhdCA9IG5ldyBIZWFydEJlYXQoX3RoaXMuX2J1cywgX3RoaXMuX293bmVyLCBfdGhpcy5fc3luY2hlci5fcnVudGltZVVybCwgdGhpcywgMTUsIGxhc3RIZWFydGJlYXQpO1xyXG4gICAgICBpZiAoX3RoaXMuX3Jlc3VtZWQpIF90aGlzLl9oZWFydEJlYXQuc3RhcnQodHJ1ZSwgX3RoaXMubWV0YWRhdGEuaXNSZXBvcnRlcik7XHJcbiAgICAgIGVsc2UgX3RoaXMuX2hlYXJ0QmVhdC5zdGFydChmYWxzZSwgX3RoaXMubWV0YWRhdGEuaXNSZXBvcnRlcik7XHJcblxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2dldExhc3RDaGlsZElkKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgY2hpbGRJZEludCA9IDA7XHJcbiAgICBsZXQgY2hpbGRJZFN0cmluZyA9IF90aGlzLl9vd25lciArICcjJyArIGNoaWxkSWRJbnQ7XHJcblxyXG5cclxuICAgIE9iamVjdC5rZXlzKF90aGlzLl9jaGlsZHJlbnMpLmZpbHRlcigoa2V5KSA9PiB7XHJcbiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zW2tleV0uY2hpbGRJZCA+IGNoaWxkSWRTdHJpbmcpIHtcclxuICAgICAgICBjaGlsZElkU3RyaW5nID0gX3RoaXMuX2NoaWxkcmVuc1trZXldLmNoaWxkSWQ7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBjaGlsZElkSW50ID0gTnVtYmVyKGNoaWxkSWRTdHJpbmcuc3BsaXQoJyMnKVsxXSk7XHJcbiAgfVxyXG5cclxuICBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBjaGlsZEJhc2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nO1xyXG4gICAgbG9nLmxvZygnW0RhdGEgT2JqZWN0IC0gQWxsb2NhdGVMaXN0ZW5lcnNdIC0gJywgX3RoaXMuX2NoaWxkcmVucyk7XHJcbiAgICBpZiAoX3RoaXMuX2NoaWxkcmVucykge1xyXG4gICAgICAvLyAgICAgIF90aGlzLl9jaGlsZHJlbnMuZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuICAgICAgbGV0IGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMO1xyXG4gICAgICBsZXQgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCAobXNnKSA9PiB7XHJcbiAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZlxyXG4gICAgICAgIGlmIChtc2cuZnJvbSAhPT0gdGhpcy5fb3duZXIpIHtcclxuICAgICAgICAgIGxvZy5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpO1xyXG4gICAgICAgICAgc3dpdGNoIChtc2cudHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlICdjcmVhdGUnOiBfdGhpcy5fb25DaGlsZENyZWF0ZShtc2cpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzogbG9nLmxvZyhtc2cpOyBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDogX3RoaXMuX2NoYW5nZUNoaWxkcmVuKG1zZyk7IGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVyID0gbGlzdGVuZXI7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3JlbGVhc2VMaXN0ZW5lcnMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGlmIChfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcikge1xyXG4gICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lci5yZW1vdmUoKTtcclxuXHJcbiAgICAgIE9iamVjdC5rZXlzKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgLyogICAgICBpZiAoY2hpbGRyZW4gPT09ICdyZXNvdXJjZXMnKSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkcmVuXSkuZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZHJlbl1bY2hpbGRdLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9IGVsc2UgeyovXHJcbiAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZF0uX3JlbGVhc2VMaXN0ZW5lcnMoKTtcclxuICAgICAgICAvLyAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN5bmMgRGF0YSBPYmplY3QgT2JzZXJ2ZXIgd2l0aCBsYXN0IHZlcnNpb24gb2YgRGF0YSBPYmplY3QgUmVwb3J0ZXIuIFVzZWZ1bCBmb3IgUmVzdW1lc1xyXG4gICAqL1xyXG4gIHN5bmMoKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxvZy5pbmZvKCdbRGF0YU9iamVjdC5zeW5jXSBzeW5jaHJvbmlzaW5nICcpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgY3JpdGVyaWEgPSB7fTtcclxuXHJcbiAgICAgIGlmICh0aGlzLm1ldGFkYXRhLmJhY2t1cFJldmlzaW9uKSBjcml0ZXJpYS5iYWNrdXBSZXZpc2lvbiA9IHRoaXMubWV0YWRhdGEuYmFja3VwUmV2aXNpb247XHJcblxyXG4gICAgICBfdGhpcy5fc3luY2hlci5yZWFkKF90aGlzLl9tZXRhZGF0YS51cmwsIGNyaXRlcmlhKS50aGVuKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgIGxvZy5pbmZvKCdbRGF0YU9iamVjdC5zeW5jXSB2YWx1ZSB0byBzeW5jOiAnLCB2YWx1ZSk7XHJcblxyXG4gICAgICAgIE9iamVjdC5hc3NpZ24oX3RoaXMuZGF0YSwgZGVlcENsb25lKHZhbHVlLmRhdGEpKTtcclxuXHJcbiAgICAgICAgX3RoaXMuX3ZlcnNpb24gPSB2YWx1ZS52ZXJzaW9uO1xyXG5cclxuICAgICAgICBfdGhpcy5fbWV0YWRhdGEubGFzdE1vZGlmaWVkID0gdmFsdWUubGFzdE1vZGlmaWVkO1xyXG5cclxuICAgICAgICAvL1RPRE86IGNoZWNrIGZpcnN0IGlmIHRoZXJlIGFyZSBuZXcgY2hpbGRyZW5PYmplY3RzIHRvIGF2b2lkIG92ZXJoZWFkXHJcblxyXG4gICAgICAgIGlmICh2YWx1ZS5jaGlsZHJlbk9iamVjdHMpIHtcclxuICAgICAgICAgIF90aGlzLnJlc3VtZUNoaWxkcmVucyh2YWx1ZS5jaGlsZHJlbk9iamVjdHMpO1xyXG4gICAgICAgICAgX3RoaXMuX3N0b3JlQ2hpbGRyZW5zKCk7XHJcbiAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIH0gZWxzZSByZXNvbHZlKHRydWUpO1xyXG5cclxuXHJcbiAgICAgICAgLyppZiAodmFsdWUudmVyc2lvbiAhPSBfdGhpcy5fdmVyc2lvbikge1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1tEYXRhT2JqZWN0LnN5bmNdIHVwZGF0aW5nIGV4aXN0aW5nIGRhdGE6ICcsIF90aGlzLmRhdGEpO1xyXG5cclxuICAgICAgICAgIE9iamVjdC5hc3NpZ24oX3RoaXMuZGF0YSB8fCB7fSwgZGVlcENsb25lKHZhbHVlLmRhdGEpKTtcclxuXHJcbiAgICAgICAgICBfdGhpcy5fbWV0YWRhdGEgPSBkZWVwQ2xvbmUodmFsdWUpO1xyXG5cclxuICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fbWV0YWRhdGEuZGF0YTtcclxuXHJcbiAgICAgICAgICBfdGhpcy5fdmVyc2lvbiA9IHZhbHVlLnZlcnNpb247XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuaW5mbygnW0RhdGFPYmplY3Quc3luY10gZXhpc3RpbmcgZGF0YSBpcyB1cGRhdGVkOiAnLCB2YWx1ZSk7XHJcbiAgICAgICAgfSovXHJcblxyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbG9nLmluZm8oJ1tEYXRhT2JqZWN0LnN5bmNdIHN5bmMgZmFpbGVkOiAnLCByZWFzb24pO1xyXG4gICAgICAgIHJlc29sdmUoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcblxyXG4gIH1cclxuICAvKipcclxuICAgKlxyXG4gICAqL1xyXG4gIHJlc3VtZUNoaWxkcmVucyhjaGlsZHJlbnMpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IGNoaWxkSWRTdHJpbmcgPSB0aGlzLl9vd25lci5zcGxpdCgnLycpWzNdICsgJyMnICsgdGhpcy5fY2hpbGRJZDtcclxuXHJcbiAgICAvL3NldHVwIGNoaWxkcmVucyBkYXRhIGZyb20gc3Vic2NyaXB0aW9uXHJcbiAgICAvLyAgICBPYmplY3Qua2V5cyhjaGlsZHJlbnMpLmZvckVhY2goKGNoaWxkcmVuUmVzb3VyY2UpID0+IHtcclxuICAgIC8vICAgICAgbGV0IGNoaWxkcmVuID0gY2hpbGRyZW5zW2NoaWxkcmVuUmVzb3VyY2VdO1xyXG4gICAgbGV0IGNoaWxkcmVuID0gY2hpbGRyZW5zO1xyXG5cclxuICAgIC8vX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZHJlblJlc291cmNlXSA9IHt9O1xyXG4gICAgT2JqZWN0LmtleXMoY2hpbGRyZW4pLmZvckVhY2goKGNoaWxkSWQpID0+IHtcclxuICAgICAgbGV0IG5ld0NoaWxkID0gZmFsc2U7XHJcblxyXG4vKiAgICAgICAgaWYgKCFfdGhpcy5fY2hpbGRyZW5PYmplY3RzLmhhc093blByb3BlcnR5KGNoaWxkcmVuUmVzb3VyY2UpKVxyXG4gICAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZHJlblJlc291cmNlXSA9IHt9OyovXHJcblxyXG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGlzIHRoZSBsYXN0IGhlYXJ0YmVhdFxyXG5cclxuICAgICAgICBpZiAoY2hpbGRJZCA9PT0gJ2hlYXJ0YmVhdCcpIHtcclxuLy8gICAgICAgICAgX3RoaXMuX2hlYXJ0QmVhdC5vbk5ld0hlYXJ0YmVhdChjaGlsZHJlbltjaGlsZElkXS52YWx1ZSk7XHJcbi8vICAgICAgICAgIF90aGlzLl9oZWFydEJlYXQuc3RhcnQodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNoaWxkcmVuW2NoaWxkSWRdLmhhc093blByb3BlcnR5KCd2YWx1ZScpICYmIGNoaWxkcmVuW2NoaWxkSWRdLnZhbHVlLnJlc291cmNlVHlwZSAmJiAhX3RoaXMuX2NoaWxkcmVuT2JqZWN0cy5oYXNPd25Qcm9wZXJ0eShjaGlsZElkKSkge1xyXG4gICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0gPSBfdGhpcy5fcmVzdW1lSHlwZXJ0eVJlc291cmNlKGNoaWxkcmVuW2NoaWxkSWRdKTtcclxuICAgICAgICBuZXdDaGlsZCA9IHRydWU7XHJcbiAgICAgIH0gZWxzZSBpZiAoIV90aGlzLl9jaGlsZHJlbk9iamVjdHMuaGFzT3duUHJvcGVydHkoY2hpbGRJZCkpIHtcclxuXHJcbiAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IF90aGlzLl9yZXN1bWVDaGlsZChjaGlsZHJlbltjaGlsZElkXSk7XHJcbiAgICAgICAgbG9nLmxvZygnW0RhdGFPYmplY3QucmVzdW1lQ2hpbGRyZW5zXSBuZXcgRGF0YU9iamVjdENoaWxkOiAnLCBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdKTtcclxuICAgICAgICBuZXdDaGlsZCA9IHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChuZXdDaGlsZCAmJiBjaGlsZElkID4gY2hpbGRJZFN0cmluZykge1xyXG4gICAgICAgIGNoaWxkSWRTdHJpbmcgPSBjaGlsZElkO1xyXG4gICAgICAgIGxvZy5sb2coJ1tEYXRhT2JqZWN0UmVwb3J0ZXIucmVzdW1lQ2hpbGRyZW5zXSAtIHJlc3VtaW5nOiAnLCB0aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcbiAgICAvLyAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jaGlsZElkID0gTnVtYmVyKGNoaWxkSWRTdHJpbmcuc3BsaXQoJyMnKVsxXSk7XHJcblxyXG4gIH1cclxuXHJcbiAgX3Jlc3VtZUNoaWxkKGlucHV0KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGNoaWxkSW5wdXQgPSBpbnB1dC52YWx1ZTtcclxuICAgIGNoaWxkSW5wdXQucGFyZW50T2JqZWN0ID0gX3RoaXM7XHJcbiAgICBjaGlsZElucHV0LnBhcmVudCA9IF90aGlzLl91cmw7XHJcblxyXG4gICAgbGV0IGNoaWxkID0gbmV3IERhdGFPYmplY3RDaGlsZChjaGlsZElucHV0KTtcclxuXHJcbiAgICBjaGlsZC5pZGVudGl0eSA9IGlucHV0LmlkZW50aXR5O1xyXG5cclxuICAgIGxldCBldmVudCA9IHtcclxuICAgICAgdHlwZTogJ2NyZWF0ZScsXHJcbiAgICAgIGZyb206IGNoaWxkLnJlcG9ydGVyLFxyXG4gICAgICB1cmw6IGNoaWxkLnBhcmVudCxcclxuICAgICAgdmFsdWU6IGNoaWxkLmRhdGEsXHJcbiAgICAgIGNoaWxkSWQ6IGNoaWxkLnVybCxcclxuICAgICAgaWRlbnRpdHk6IGNoaWxkLmlkZW50aXR5LFxyXG4gICAgICBjaGlsZDogY2hpbGRcclxuICAgIH07XHJcblxyXG4gICAgaWYgKGNoaWxkLnJlc291cmNlVHlwZSkge1xyXG4gICAgICBldmVudC5yZXNvdXJjZSA9IGNoaWxkO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSBfdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIoZXZlbnQpO1xyXG5cclxuICAgIHJldHVybiBjaGlsZDtcclxuXHJcbiAgfVxyXG5cclxuICBfcmVzdW1lSHlwZXJ0eVJlc291cmNlKGlucHV0KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGNoaWxkSW5wdXQgPSBpbnB1dC52YWx1ZTtcclxuICAgIGNoaWxkSW5wdXQucGFyZW50T2JqZWN0ID0gX3RoaXM7XHJcbiAgICBjaGlsZElucHV0LnBhcmVudCA9IF90aGlzLl91cmw7XHJcblxyXG4gICAgbGV0IGh5cGVydHlSZXNvdXJjZSA9IF90aGlzLl9oeXBlcnR5UmVzb3VyY2VGYWN0b3J5LmNyZWF0ZUh5cGVydHlSZXNvdXJjZShmYWxzZSwgY2hpbGRJbnB1dC5yZXNvdXJjZVR5cGUsIGNoaWxkSW5wdXQpXHJcblxyXG4gICAgaHlwZXJ0eVJlc291cmNlLmlkZW50aXR5ID0gaW5wdXQuaWRlbnRpdHk7XHJcblxyXG4gICAgbGV0IGV2ZW50ID0ge1xyXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcclxuICAgICAgZnJvbTogaHlwZXJ0eVJlc291cmNlLnJlcG9ydGVyLFxyXG4gICAgICB1cmw6IGh5cGVydHlSZXNvdXJjZS5wYXJlbnQsXHJcbiAgICAgIHZhbHVlOiBoeXBlcnR5UmVzb3VyY2UuZGF0YSxcclxuICAgICAgY2hpbGRJZDogaHlwZXJ0eVJlc291cmNlLnVybCxcclxuICAgICAgaWRlbnRpdHk6IGh5cGVydHlSZXNvdXJjZS5pZGVudGl0eSxcclxuICAgICAgY2hpbGQ6IGh5cGVydHlSZXNvdXJjZVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoaHlwZXJ0eVJlc291cmNlLnJlc291cmNlVHlwZSkge1xyXG4gICAgICBldmVudC5yZXNvdXJjZSA9IGh5cGVydHlSZXNvdXJjZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcikgX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKGV2ZW50KTtcclxuXHJcbiAgICByZXR1cm4gaHlwZXJ0eVJlc291cmNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWxsIE1ldGFkYXRhIGFib3V0IHRoZSBEYXRhIE9iamVjdFxyXG4gICAqIEB0eXBlIHtPYmplY3R9IC1cclxuICAgKi9cclxuXHJcbiAgZ2V0IG1ldGFkYXRhKCkgeyByZXR1cm4gdGhpcy5fbWV0YWRhdGE7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogT2JqZWN0IFVSTCBvZiByZXBvcnRlciBvciBvYnNlcnZlclxyXG4gICAqIEB0eXBlIHtPYmplY3RVUkx9XHJcbiAgICovXHJcbiAgZ2V0IHVybCgpIHsgcmV0dXJuIHRoaXMuX3VybDsgfVxyXG5cclxuICAvKipcclxuICAgKiBPYmplY3Qgc2NoZW1hIFVSTCAodGhpcyBmaWVsZCBpcyBub3QgeWV0IHN0YWJsZSwgYW5kIGlzIHN1YnNqZWN0IHRvIGNoYW5nZSlcclxuICAgKiBAdHlwZSB7U2NoZW1hVVJMfVxyXG4gICAqL1xyXG4gIGdldCBzY2hlbWEoKSB7IHJldHVybiB0aGlzLl9zY2hlbWE7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhdHVzIG9mIHRoZSByZXBvcnRlciBvciBvYnNlcnZlciBjb25uZWN0aW9uICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKVxyXG4gICAqIEB0eXBlIHtTdGF0dXN9IC0gRW51bSBvZjogb24gfCBwYXVzZWRcclxuICAgKi9cclxuICBnZXQgc3RhdHVzKCkgeyByZXR1cm4gdGhpcy5fc3RhdHVzOyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERhdGEgc3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC5cclxuICAgKiBAdHlwZSB7SlNPTn0gLSBKU09OIHN0cnVjdHVyZSB0aGF0IHNob3VsZCBmb2xsb3cgdGhlIGRlZmluZWQgc2NoZW1hLCBpZiBhbnkuXHJcbiAgICovXHJcbiAgZ2V0IGRhdGEoKSB7IHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWxsIGNyZWF0ZWQgY2hpbGRyZW4ncyBzaW5jZSB0aGUgc3Vic2NyaXB0aW9uLCBkb2Vzbid0IGNvbnRhaW4gYWxsIGNoaWxkcmVuJ3Mgc2luY2UgcmVwb3J0ZXIgY3JlYXRpb24uXHJcbiAgICogQHR5cGUge09iamVjdDxDaGlsZElkLCBEYXRhT2JqZWN0Q2hpbGQ+fVxyXG4gICAqL1xyXG4gIGdldCBjaGlsZHJlbnMoKSB7IHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGlnbm9yZVxyXG4gICAqL1xyXG4gIHBhdXNlKCkge1xyXG4gICAgLy9UT0RPOiB0aGlzIGZlYXR1cmUgbmVlZHMgbW9yZSBhbmFsaXNlXHJcbiAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBpZ25vcmVcclxuICAgKi9cclxuICByZXN1bWUoKSB7XHJcbiAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2VcclxuICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGlnbm9yZVxyXG4gICAqL1xyXG4gIHN0b3AoKSB7XHJcbiAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlP1xyXG4gICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgYW5kIGFkZCBhIERhdGFPYmplY3RDaGlsZCB0byBhIGNoaWxkcmVuIGNvbGxlY3Rpb24uXHJcbiAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGRcclxuICAgKiBAcGFyYW0gIHtNZXNzYWdlQm9keUlkZW50aXR5fSBpZGVudGl0eSAtIChvcHRpb25hbCkgaWRlbnRpdHkgZGF0YSB0byBiZSBhZGRlZCB0byBpZGVudGl0eSB0aGUgdXNlciByZXBvcnRlci4gVG8gYmUgdXNlZCBmb3IgbGVnYWN5IGlkZW50aXRpZXMuXHJcbiAgICogQHBhcmFtICB7U3luY0NoaWxkTWV0YWRhdGF9IGlucHV0IC0gKG9wdGlvbmFsKSBBbGwgYWRkaXRpb25hbCBtZXRhZGF0YSBhYm91dCB0aGUgRGF0YU9iamVjdENoaWxkLlxyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdENoaWxkPn0gLSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBEYXRhT2JqZWN0Q2hpbGQuXHJcbiAgICovXHJcblxyXG4gIGFkZENoaWxkKGluaXRpYWxEYXRhLCBpZGVudGl0eSwgaW5wdXQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgbmV3Q2hpbGQ7XHJcblxyXG4gICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbFxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblxyXG4gICAgICBsZXQgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJztcclxuXHJcblxyXG4gICAgICBsZXQgY2hpbGRJbnB1dCA9IF90aGlzLl9nZXRDaGlsZElucHV0KGlucHV0KTtcclxuICAgICAgY2hpbGRJbnB1dC5kYXRhID0gaW5pdGlhbERhdGE7XHJcbiAgICAgIC8vICAgICAgY2hpbGRJbnB1dC5jaGlsZHJlbiA9IGNoaWxkcmVuO1xyXG4gICAgICBuZXdDaGlsZCA9IG5ldyBEYXRhT2JqZWN0Q2hpbGQoY2hpbGRJbnB1dCk7XHJcblxyXG4gICAgICBpZiAoaWRlbnRpdHkpIG5ld0NoaWxkLmlkZW50aXR5ID0gaWRlbnRpdHk7XHJcblxyXG4gICAgICBuZXdDaGlsZC5zaGFyZSgpO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0LmFkZENoaWxkXSBhZGRlZCAnLCBuZXdDaGlsZCk7XHJcblxyXG4gICAgICBuZXdDaGlsZC5vbkNoYW5nZSgoZXZlbnQpID0+IHtcclxuICAgICAgICBfdGhpcy5fb25DaGFuZ2UoZXZlbnQsIHsgcGF0aDogbXNnQ2hpbGRQYXRoLCBjaGlsZElkOiBjaGlsZElucHV0LnVybCB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyAgICAgaWYgKCFfdGhpcy5fY2hpbGRyZW5PYmplY3RzLmhhc093blByb3BlcnR5KGNoaWxkcmVuKSkgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZHJlbl0gPSB7fTtcclxuXHJcbiAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJbnB1dC51cmxdID0gbmV3Q2hpbGQ7XHJcblxyXG4gICAgICByZXNvbHZlKG5ld0NoaWxkKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2RlbGV0ZUNoaWxkcmVucygpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGRlbGV0ZVByb21pc2VzID0gW107XHJcblxyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICBpZiAoX3RoaXMuY2hpbGRyZW5zKSB7XHJcbiAgICAgICAgbG9nLmxvZygnW0RhdGFPYmplY3QuZGVsZXRlQ2hpbGRyZW5zXScsIF90aGlzLmNoaWxkcmVucyk7XHJcbiAgICAgICAgbGV0IGNoaWxkO1xyXG5cclxuICAgICAgICBmb3IgKGNoaWxkIGluIF90aGlzLmNoaWxkcmVucykge1xyXG4gICAgICAgICAgLy8gICAgICAgICAgbGV0IGNoaWxkO1xyXG5cclxuICAgICAgICAgIC8qICAgICAgICAgIGlmIChjaGlsZHJlbiA9PT0gJ3Jlc291cmNlcycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGZvciAoY2hpbGQgaW4gX3RoaXMuY2hpbGRyZW5zW2NoaWxkcmVuXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2hpbGRPYmogPSBfdGhpcy5jaGlsZHJlbnNbY2hpbGRyZW5dW2NoaWxkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmxvZygnW0RhdGFPYmplY3QuX2RlbGV0ZUNoaWxkcmVuc10gY2hpbGQnLGNoaWxkT2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkT2JqLm1ldGFkYXRhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZVR5cGUnKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVQcm9taXNlcy5wdXNoKF90aGlzLmNoaWxkcmVuc1tjaGlsZHJlbl1bY2hpbGRdLmRlbGV0ZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsqL1xyXG4gICAgICAgICAgbGV0IGNoaWxkT2JqID0gX3RoaXMuY2hpbGRyZW5zW2NoaWxkXTtcclxuICAgICAgICAgIGxvZy5sb2coJ1tEYXRhT2JqZWN0Ll9kZWxldGVDaGlsZHJlbnNdIGNoaWxkJywgY2hpbGRPYmopO1xyXG4gICAgICAgICAgaWYgKGNoaWxkT2JqLm1ldGFkYXRhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZVR5cGUnKSlcclxuICAgICAgICAgICAgZGVsZXRlUHJvbWlzZXMucHVzaChfdGhpcy5jaGlsZHJlbnNbY2hpbGRdLmRlbGV0ZSgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9nLmxvZygnW0RhdGFPYmplY3QuX2RlbGV0ZUNoaWxkcmVuc10gcHJvbWlzZXMgJywgZGVsZXRlUHJvbWlzZXMpO1xyXG5cclxuICAgICAgICBpZiAoZGVsZXRlUHJvbWlzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgUHJvbWlzZS5hbGwoZGVsZXRlUHJvbWlzZXMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICByZXNvbHZlKCdbRGF0YU9iamVjdC5fZGVsZXRlQ2hpbGRyZW5zXSBkb25lJyk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2UgcmVzb2x2ZSgnW0RhdGFPYmplY3QuX2RlbGV0ZUNoaWxkcmVuc10gbm90aGluZyB0byBkZWxldGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIF9nZXRDaGlsZElucHV0KGlucHV0KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGNoaWxkSW5wdXQgPSBPYmplY3QuYXNzaWduKHt9LCBpbnB1dCk7XHJcblxyXG4gICAgX3RoaXMuX2NoaWxkSWQrKztcclxuXHJcbiAgICAvL3JlbW92aW5nIGRvbWFpbiBmcm9tIGNoaWxkSWQgdG8gYXZvaWQgYmFja3VwIGlzc3VlcyB3aXRoICcuJ1xyXG5cclxuICAgIGNoaWxkSW5wdXQudXJsID0gX3RoaXMuX293bmVyLnNwbGl0KCcvJylbM10gKyAnIycgKyBfdGhpcy5fY2hpbGRJZDtcclxuXHJcbiAgICBjaGlsZElucHV0LnBhcmVudE9iamVjdCA9IF90aGlzO1xyXG4gICAgY2hpbGRJbnB1dC5yZXBvcnRlciA9IF90aGlzLl9vd25lcjtcclxuICAgIGNoaWxkSW5wdXQuY3JlYXRlZCA9IChuZXcgRGF0ZSkudG9JU09TdHJpbmcoKTtcclxuICAgIGNoaWxkSW5wdXQucnVudGltZSA9IF90aGlzLl9zeW5jaGVyLl9ydW50aW1lVXJsO1xyXG4gICAgY2hpbGRJbnB1dC5wMnBIYW5kbGVyID0gX3RoaXMuX3N5bmNoZXIuX3AycEhhbmRsZXI7XHJcbiAgICBjaGlsZElucHV0LnAycFJlcXVlc3RlciA9IF90aGlzLl9zeW5jaGVyLl9wMnBSZXF1ZXN0ZXI7XHJcbiAgICBjaGlsZElucHV0LnNjaGVtYSA9IF90aGlzLl9zY2hlbWE7XHJcbiAgICBjaGlsZElucHV0LnBhcmVudCA9IF90aGlzLnVybDtcclxuICAgIGNoaWxkSW5wdXQubXV0dWFsID0gX3RoaXMubWV0YWRhdGEubXV0dWFsO1xyXG4gICAgLy8gICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0Ll9nZXRDaGlsZElucHV0XSBtdXR1YWwgJywgY2hpbGRJbnB1dC5tdXR1YWwpO1xyXG5cclxuICAgIHJldHVybiBjaGlsZElucHV0O1xyXG4gIH1cclxuXHJcbiAgYWRkSHlwZXJ0eVJlc291cmNlKHR5cGUsIHJlc291cmNlLCBpZGVudGl0eSwgaW5wdXQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbFxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblxyXG4gICAgICBsZXQgaHlwZXJ0eVJlc291cmNlO1xyXG4gICAgICBsZXQgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJztcclxuXHJcbiAgICAgIGxldCBjaGlsZElucHV0ID0gX3RoaXMuX2dldENoaWxkSW5wdXQoaW5wdXQpO1xyXG4gICAgICAvLyAgICAgIGNoaWxkSW5wdXQuY2hpbGRyZW4gPSBjaGlsZHJlbjtcclxuXHJcbiAgICAgIF90aGlzLl9oeXBlcnR5UmVzb3VyY2VGYWN0b3J5LmNyZWF0ZUh5cGVydHlSZXNvdXJjZVdpdGhDb250ZW50KHRydWUsIHR5cGUsIHJlc291cmNlLCBjaGlsZElucHV0KS50aGVuKChyZXNvdXJjZSkgPT4ge1xyXG4gICAgICAgIGh5cGVydHlSZXNvdXJjZSA9IHJlc291cmNlO1xyXG5cclxuICAgICAgICBpZiAoaWRlbnRpdHkpIGh5cGVydHlSZXNvdXJjZS5pZGVudGl0eSA9IGlkZW50aXR5O1xyXG5cclxuICAgICAgICBoeXBlcnR5UmVzb3VyY2Uuc2hhcmUoKTtcclxuXHJcbiAgICAgICAgbG9nLmxvZygnW0RhdGFPYmplY3QuYWRkSHlwZXJ0eVJlc291cmNlXSBhZGRlZCAnLCBoeXBlcnR5UmVzb3VyY2UpO1xyXG5cclxuICAgICAgICBoeXBlcnR5UmVzb3VyY2Uub25DaGFuZ2UoKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICBfdGhpcy5fb25DaGFuZ2UoZXZlbnQsIHsgcGF0aDogbXNnQ2hpbGRQYXRoLCBjaGlsZElkOiBoeXBlcnR5UmVzb3VyY2UuY2hpbGRJZCB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gICAgICAgIGlmICghX3RoaXMuX2NoaWxkcmVuT2JqZWN0cy5oYXNPd25Qcm9wZXJ0eShjaGlsZHJlbikpIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRyZW5dID0ge307XHJcblxyXG4gICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbaHlwZXJ0eVJlc291cmNlLmNoaWxkSWRdID0gaHlwZXJ0eVJlc291cmNlO1xyXG5cclxuICAgICAgICByZXNvbHZlKGh5cGVydHlSZXNvdXJjZSk7XHJcbiAgICAgIH0pO1xyXG5cclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIG9mIGNoaWxkcmVucy5cclxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrXHJcbiAgICogVE9ETzogYWRkIGNoaWxkcmVuSWQgdG8gc3VwcG9ydCBkaWZmZXJlbnQgaGFuZGxlcnMgcGVyIGNoaWxkcmVuXHJcbiAgICovXHJcbiAgb25BZGRDaGlsZChjYWxsYmFjaykge1xyXG5cclxuICAgIHRoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkXHJcbiAgX29uQ2hpbGRDcmVhdGUobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIC8vICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdC5fb25DaGlsZENyZWF0ZV0gcmVjZWl2ZWRCeSAnICsgX3RoaXMuX293bmVyICsgJyA6ICcsIG1zZyk7XHJcblxyXG4gICAgLy8gaWYgdGhpcyBpcyBhbiBoZWFydGJlYXQgbXNnIGZvd2FyZCBpdCB0byBoZWF0YmVhdCBoYW5kbGVyXHJcblxyXG4gICAgaWYgKG1zZy5ib2R5LnJlc291cmNlID09PSAnaGVhcnRiZWF0Jykge1xyXG4gICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3QuX29uQ2hpbGRDcmVhdGVdIG5ldyBoZWFydGJlYXQgcmVjZWl2ZWQgJyArIG1zZy5ib2R5LnZhbHVlKTtcclxuICAgICAgdGhpcy5faGVhcnRCZWF0Lm9uTmV3SGVhcnRiZWF0KG1zZy5ib2R5LnZhbHVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdC5fb25DaGlsZENyZWF0ZV0gbmV3IGNoaWxkIHJlY2VpdmVkQnkgJyArIF90aGlzLl9vd25lciArICcgOiAnLCBtc2cpO1xyXG4gICAgICBsZXQgcmVzcG9uc2UgPSB7XHJcbiAgICAgICAgZnJvbTogbXNnLnRvLFxyXG4gICAgICAgIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICB0eXBlOiAncmVzcG9uc2UnLFxyXG4gICAgICAgIGlkOiBtc2cuaWQsXHJcbiAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgY29kZTogMTAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlc3BvbnNlKTtcclxuXHJcbiAgICAgIGlmIChtc2cuYm9keS52YWx1ZS5yZXNvdXJjZVR5cGUpIHtcclxuICAgICAgICBfdGhpcy5fb25IeXBlcnR5UmVzb3VyY2VBZGRlZChtc2cpO1xyXG4gICAgICB9IGVsc2UgX3RoaXMuX29uQ2hpbGRBZGRlZChtc2cpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICBfb25DaGlsZEFkZGVkKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBjaGlsZElucHV0ID0gZGVlcENsb25lKG1zZy5ib2R5LnZhbHVlKTtcclxuICAgIGNoaWxkSW5wdXQucGFyZW50T2JqZWN0ID0gX3RoaXM7XHJcblxyXG4gICAgLy8gICAgbGV0IGNoaWxkcmVuID0gY2hpbGRJbnB1dC5jaGlsZHJlbjtcclxuXHJcbiAgICBsZXQgbmV3Q2hpbGQgPSBuZXcgRGF0YU9iamVjdENoaWxkKGNoaWxkSW5wdXQpO1xyXG4gICAgbmV3Q2hpbGQuaWRlbnRpdHkgPSBtc2cuYm9keS5pZGVudGl0eTtcclxuXHJcblxyXG4gICAgLy8gICAgaWYgKCFfdGhpcy5fY2hpbGRyZW5PYmplY3RzLmhhc093blByb3BlcnR5KGNoaWxkcmVuKSkgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZHJlbl0gPSB7fTtcclxuXHJcbiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSW5wdXQudXJsXSA9IG5ld0NoaWxkO1xyXG5cclxuICAgIGlmIChtc2cudG8gPT09IF90aGlzLm1ldGFkYXRhLnVybCkgbmV3Q2hpbGQuc3RvcmUoKTtcclxuXHJcbiAgICBfdGhpcy5faHlwZXJ0eUV2dChtc2csIG5ld0NoaWxkKTtcclxuICB9XHJcblxyXG4gIF9vbkh5cGVydHlSZXNvdXJjZUFkZGVkKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBpbnB1dCA9IG1zZy5ib2R5LnZhbHVlO1xyXG4gICAgbGV0IGh5cGVydHlSZXNvdXJjZTtcclxuXHJcbiAgICAvLyAgICBsZXQgY2hpbGRyZW4gPSBpbnB1dC5jaGlsZHJlbjtcclxuXHJcbiAgICBpbnB1dC5wYXJlbnRPYmplY3QgPSBfdGhpcztcclxuXHJcbiAgICBoeXBlcnR5UmVzb3VyY2UgPSBfdGhpcy5faHlwZXJ0eVJlc291cmNlRmFjdG9yeS5jcmVhdGVIeXBlcnR5UmVzb3VyY2UoZmFsc2UsIGlucHV0LnJlc291cmNlVHlwZSwgaW5wdXQpO1xyXG4gICAgaHlwZXJ0eVJlc291cmNlLmlkZW50aXR5ID0gbXNnLmJvZHkuaWRlbnRpdHk7XHJcblxyXG4gICAgLy8gICAgaWYgKCFfdGhpcy5fY2hpbGRyZW5PYmplY3RzLmhhc093blByb3BlcnR5KGNoaWxkcmVuKSkgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZHJlbl0gPSB7fTtcclxuXHJcbiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2h5cGVydHlSZXNvdXJjZS5jaGlsZElkXSA9IGh5cGVydHlSZXNvdXJjZTtcclxuXHJcbiAgICBfdGhpcy5faHlwZXJ0eUV2dChtc2csIGh5cGVydHlSZXNvdXJjZSk7XHJcblxyXG4gICAgLy8gbG9jYWxseSBzdG9yZSBtZXNzYWdlcyB0aGF0IGFyZSBkaXJlY3RseSBzZW50IHRvIHRoZSBoeXBlcnR5XHJcbiAgICAvLyBpZSB0byBzeW5jIHdpdGggbWVzc2FnZXMgc2VudCB3aGVuIG9mZmxpbmVcclxuXHJcbiAgICBpZiAobXNnLnRvID09PSBfdGhpcy5tZXRhZGF0YS51cmwpIGh5cGVydHlSZXNvdXJjZS5zdG9yZSgpO1xyXG4gIH1cclxuXHJcbiAgX2h5cGVydHlFdnQobXNnLCBjaGlsZCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgZXZlbnQgPSB7XHJcbiAgICAgIHR5cGU6IG1zZy50eXBlLFxyXG4gICAgICBmcm9tOiBtc2cuZnJvbSxcclxuICAgICAgdXJsOiBtc2cudG8sXHJcbiAgICAgIHZhbHVlOiBjaGlsZC5kYXRhLFxyXG4gICAgICBjaGlsZElkOiBjaGlsZC51cmwsXHJcbiAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSxcclxuICAgICAgY2hpbGQ6IGNoaWxkXHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChjaGlsZC5yZXNvdXJjZVR5cGUpIHtcclxuICAgICAgZXZlbnQucmVzb3VyY2UgPSBjaGlsZDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcikgX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKGV2ZW50KTtcclxuICB9XHJcblxyXG4gIC8vc2VuZCBkZWx0YSBtZXNzYWdlcyB0byBzdWJzY3JpcHRpb25zXHJcbiAgX29uQ2hhbmdlKGV2ZW50LCBjaGlsZEluZm8pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX21ldGFkYXRhLmxhc3RNb2RpZmllZCA9IChuZXcgRGF0ZSkudG9JU09TdHJpbmcoKTtcclxuXHJcbiAgICBfdGhpcy5fdmVyc2lvbisrO1xyXG5cclxuICAgIGlmIChfdGhpcy5fc3RhdHVzID09PSAnbGl2ZScpIHtcclxuICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoYW5nZXMgYWRkcmVzczogTWVzc2FnZUJ1c1xyXG4gICAgICBsZXQgY2hhbmdlTXNnID0ge1xyXG4gICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsXHJcbiAgICAgICAgYm9keTogeyB2ZXJzaW9uOiBfdGhpcy5fdmVyc2lvbiwgc291cmNlOiBfdGhpcy5fb3duZXIsIGF0dHJpYnV0ZTogZXZlbnQuZmllbGQsIGxhc3RNb2RpZmllZDogX3RoaXMuX21ldGFkYXRhLmxhc3RNb2RpZmllZCB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBsb2cubG9nKCdbRGF0YU9iamVjdCAtIF9vbkNoYW5nZV0gLSAnLCBldmVudCwgY2hpbGRJbmZvLCBjaGFuZ2VNc2cpO1xyXG5cclxuICAgICAgaWYgKGV2ZW50Lm9UeXBlID09PSBPYmplY3RUeXBlLk9CSkVDVCkge1xyXG4gICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gQ2hhbmdlVHlwZS5SRU1PVkUpIHtcclxuICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZGVlcENsb25lKGV2ZW50LmRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjaGFuZ2VNc2cuYm9keS5hdHRyaWJ1dGVUeXBlID0gZXZlbnQub1R5cGU7XHJcbiAgICAgICAgY2hhbmdlTXNnLmJvZHkudmFsdWUgPSBldmVudC5kYXRhO1xyXG4gICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gQ2hhbmdlVHlwZS5VUERBVEUpIHtcclxuICAgICAgICAgIGNoYW5nZU1zZy5ib2R5Lm9wZXJhdGlvbiA9IGV2ZW50LmNUeXBlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy9jaGlsZEluZm8gbXVzdCBoYXZlIChwYXRoLCBjaGlsZElkKVxyXG4gICAgICBpZiAoY2hpbGRJbmZvKSB7XHJcbiAgICAgICAgY2hhbmdlTXNnLnRvID0gY2hpbGRJbmZvLnBhdGg7XHJcbiAgICAgICAgY2hhbmdlTXNnLmJvZHkucmVzb3VyY2UgPSBjaGlsZEluZm8uY2hpbGRJZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeVxyXG4gICAgICBpZiAoIV90aGlzLmRhdGEuX211dHVhbCkgY2hhbmdlTXNnLmJvZHkubXV0dWFsID0gX3RoaXMuX211dHVhbDtcclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhXHJcbiAgX2NoYW5nZU9iamVjdChzeW5jT2JqLCBtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy9UT0RPOiB1cGRhdGUgdmVyc2lvbiA/XHJcbiAgICAvL2hvdyB0byBoYW5kbGUgYW4gaW5jb3JyZWN0IHZlcnNpb24gPyBFeGFtcGxlOiByZWNlaXZlIGEgdmVyc2lvbiAzIHdoZW4gdGhlIG9ic2VydmVyIGlzIGluIHZlcnNpb24gMSwgd2hlcmUgaXMgdGhlIHZlcnNpb24gMiA/XHJcbiAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gP1xyXG4gICAgaWYgKF90aGlzLl92ZXJzaW9uICsgMSA8PSBtc2cuYm9keS52ZXJzaW9uKSB7XHJcbiAgICAgIF90aGlzLl92ZXJzaW9uID0gbXNnLmJvZHkudmVyc2lvbjtcclxuICAgICAgbGV0IHBhdGggPSBtc2cuYm9keS5hdHRyaWJ1dGU7XHJcbiAgICAgIGxldCB2YWx1ZTtcclxuICAgICAgaWYgKHR5cGVvZiBtc2cuYm9keS52YWx1ZSA9PT0gJ29iamVjdCcpIHZhbHVlID0gZGVlcENsb25lKG1zZy5ib2R5LnZhbHVlKTtcclxuICAgICAgZWxzZSB2YWx1ZSA9IG1zZy5ib2R5LnZhbHVlO1xyXG5cclxuICAgICAgbGV0IGZpbmRSZXN1bHQgPSBzeW5jT2JqLmZpbmRCZWZvcmUocGF0aCk7XHJcblxyXG4gICAgICBpZiAobXNnLmJvZHkubGFzdE1vZGlmaWVkKSB7XHJcbiAgICAgICAgX3RoaXMuX21ldGFkYXRhLmxhc3RNb2RpZmllZCA9IG1zZy5ib2R5Lmxhc3RNb2RpZmllZDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBfdGhpcy5fbWV0YWRhdGEubGFzdE1vZGlmaWVkID0gKG5ldyBEYXRlKS50b0lTT1N0cmluZygpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gT2JqZWN0VHlwZS5BUlJBWSkge1xyXG4gICAgICAgIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IENoYW5nZVR5cGUuQUREKSB7XHJcbiAgICAgICAgICBsZXQgYXJyID0gZmluZFJlc3VsdC5vYmo7XHJcbiAgICAgICAgICBsZXQgaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7XHJcbiAgICAgICAgICBBcnJheS5wcm90b3R5cGUuc3BsaWNlLmFwcGx5KGFyciwgW2luZGV4LCAwXS5jb25jYXQodmFsdWUpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gQ2hhbmdlVHlwZS5SRU1PVkUpIHtcclxuICAgICAgICAgIGxldCBhcnIgPSBmaW5kUmVzdWx0Lm9iajtcclxuICAgICAgICAgIGxldCBpbmRleCA9IGZpbmRSZXN1bHQubGFzdDtcclxuICAgICAgICAgIGFyci5zcGxpY2UoaW5kZXgsIHZhbHVlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEVcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCd2YWx1ZScpKSB7XHJcbiAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURSBvciBBRERcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZGVsZXRlIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF07IC8vIFJFTU9WRVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy9UT0RPOiBob3cgdG8gaGFuZGxlIHVuc3luY2hyb25pemVkIHZlcnNpb25zP1xyXG4gICAgICBsb2cubG9nKCdVTlNZTkNIUk9OSVpFRCBWRVJTSU9OOiAoZGF0YSA9PiAnICsgX3RoaXMuX3ZlcnNpb24gKyAnLCBtc2cgPT4gJyArIG1zZy5ib2R5LnZlcnNpb24gKyAnKScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdENoaWxkIHdoZW4gY2hhbmdpbmcgZGF0YVxyXG4gIF9jaGFuZ2VDaGlsZHJlbihtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBjb25zdCBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKG1zZy50byk7XHJcbiAgICBjb25zdCBpZGVudGl0eSA9IGRpdmlkZWRVUkwuaWRlbnRpdHk7XHJcbiAgICAvLyAgICBjb25zdCByZXNvdXJjZSA9IGlkZW50aXR5ID8gaWRlbnRpdHkuc3Vic3RyaW5nKGlkZW50aXR5Lmxhc3RJbmRleE9mKCcvJykgKyAxKSA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICBsZXQgY2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlO1xyXG4gICAgbGV0IGNoaWxkcmVuID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXTtcclxuXHJcbiAgICBsb2cubG9nKCdDaGFuZ2UgY2hpbGRyZW46ICcsIF90aGlzLl9vd25lciwgbXNnLCByZXNvdXJjZSk7XHJcblxyXG4gICAgaWYgKGNoaWxkcmVuKSB7XHJcbiAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoY2hpbGRyZW4uX3N5bmNPYmosIG1zZyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsb2cud2FybignTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBEYXRhT2JqZWN0O1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdEYXRhT2JqZWN0UmVwb3J0ZXInKTtcclxuXHJcbmltcG9ydCBEYXRhT2JqZWN0IGZyb20gJy4vRGF0YU9iamVjdCc7XHJcblxyXG5pbXBvcnQgeyBkZWVwQ2xvbmUsIGRpdmlkZVVSTCB9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcclxuXHJcbi8qKlxyXG4gKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBjcmVhdGUgY2FsbC5cclxuICogVG8gYmUgdXNlZCBhcyBhIHJlcG9ydGVyIHBvaW50LCBjaGFuZ2VzIHdpbGwgYmUgc3VibWl0ZWQgdG8gRGF0YU9iamVjdE9ic2VydmVyIGluc3RhbmNlcy5cclxuICovXHJcbmNsYXNzIERhdGFPYmplY3RSZXBvcnRlciBleHRlbmRzIERhdGFPYmplY3QgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovIHtcclxuICAvKiBwcml2YXRlXHJcbiAgX3N1YnNjcmlwdGlvbnM6IDxoeXBlcnR5VXJsOiB7IHN0YXR1czogc3RyaW5nIH0gfT5cclxuXHJcbiAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLVxyXG4gIF9vblN1YnNjcmlwdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZFxyXG4gIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkXHJcbiAgX29uUmVhZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZFxyXG4gICovXHJcblxyXG4gIC8qKlxyXG4gICAqIEBpZ25vcmVcclxuICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlci5jcmVhdGUgbWV0aG9kXHJcbiAgICovXHJcblxyXG4gIC8vY29uc3RydWN0b3Ioc3luY2hlciwgdXJsLCBjcmVhdGVkLCByZXBvcnRlciwgcnVudGltZSwgc2NoZW1hLCBuYW1lLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zLCBtdXR1YWwgPSB0cnVlLCByZXN1bWVkID0gZmFsc2UsIGRlc2NyaXB0aW9uLCB0YWdzLCByZXNvdXJjZXMsIG9ic2VydmVyU3RvcmFnZSwgcHVibGljT2JzZXJ2YXRpb24pIHtcclxuICBjb25zdHJ1Y3RvcihpbnB1dCkge1xyXG5cclxuICAgIHN1cGVyKGlucHV0KTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTtcclxuXHJcbiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKChldmVudCkgPT4ge1xyXG4gICAgICBsb2cubG9nKCdbU3luY2hlci5EYXRhT2JqZWN0UmVwb3J0ZXJdICcgKyBfdGhpcy51cmwgKyAnIHB1Ymxpc2ggY2hhbmdlOiAnLCBldmVudCk7XHJcbiAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICBfdGhpcy5pbnZpdGF0aW9ucyA9IFtdOyAvLyBhcnJheSBvZiBwcm9taXNlcyB3aXRoIHBlbmRpbmcgaW52aXRhdGlvbnNcclxuICAgIF90aGlzLl9jaGlsZHJlblNpemVUaHJlc2hvbGQgPSA1MDAwMDsvLyB0byBiZSB1c2VkIHdoZW4gcmVwbHlpbmcgdG8gc3luYyByZXF1ZXN0cyB0byBlbnN1cmUgZWFjaCByZXNwb25zZSBtc2cgaXMgbm90IHRvbyBsYXJnZVxyXG5cclxuICB9XHJcblxyXG4gIF9hbGxvY2F0ZUxpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLl9hbGxvY2F0ZUxpc3RlbmVycygpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fb2JqZWN0TGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIChtc2cpID0+IHtcclxuICAgICAgbG9nLmxvZygnW1N5bmNoZXIuRGF0YU9iamVjdFJlcG9ydGVyXSBsaXN0ZW5lciAnICsgX3RoaXMuX3VybCArICcgUmVjZWl2ZWQ6ICcsIG1zZyk7XHJcbiAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHtcclxuICAgICAgICBjYXNlICdyZXNwb25zZSc6IF90aGlzLl9vblJlc3BvbnNlKG1zZyk7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3JlYWQnOiBfdGhpcy5fb25SZWFkKG1zZyk7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2V4ZWN1dGUnOiBfdGhpcy5fb25FeGVjdXRlKG1zZyk7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2NyZWF0ZSc6IF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7IGJyZWFrOy8vIHRvIGNyZWF0ZSBjaGlsZCBvYmplY3RzIHRoYXQgd2VyZSBzZW50IHdoZW5uIG9mZmxpbmVcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgX3RoaXMuX3J1bnRpbWVTdGF0dXNMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3N5bmNoZXIuX3J1bnRpbWVVcmwrJy9zdGF0dXMnICwgKGV2dCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZygnW1N5bmNoZXIuRGF0YU9iamVjdFJlcG9ydGVyXSBydW50aW1lIHN0YXR1cyBldmVudCByZWNlaXZlZCAnICsgZXZ0KTtcclxuXHJcbiAgICAgIGlmIChldnQuYm9keSAmJiBldnQuYm9keS5yZXNvdXJjZSAmJiBldnQuYm9keS5yZXNvdXJjZSA9PT0gX3RoaXMuX3VybCAmJiBcclxuICAgICAgICBldnQuYm9keS52YWx1ZSAmJiBldnQuYm9keS52YWx1ZS5iYWNrdXBSZXZpc2lvbiApIHtcclxuICAgICAgICAgIC8vIGJyb2FkY2FzdCBiYWNrdXBSZXZpc2lvbiB1cGRhdGVcclxuXHJcbiAgICAgICAgICBfdGhpcy5kYXRhLmJhY2t1cFJldmlzaW9uID0gZXZ0LmJvZHkudmFsdWUuYmFja3VwUmV2aXNpb247XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnW1N5bmNoZXIuRGF0YU9iamVjdFJlcG9ydGVyXSBETyB1cGRhdGVkIHdpdGggYmFja3VwIHJldmlzaW9uICcgKyBfdGhpcy5kYXRhLmJhY2t1cFJldmlzaW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBfcmVsZWFzZUxpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lci5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNlbmQgaW52aXRhdGlvbnMgKGNyZWF0ZSBtZXNzYWdlcykgdG8gaHlwZXJ0aWVzLCBvYnNlcnZlcnMgbGlzdC5cclxuICAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMW119IG9ic2VydmVycyBMaXN0IG9mIEh5cGVydHkgVVJMJ3NcclxuICAgKi9cclxuICBpbnZpdGVPYnNlcnZlcnMob2JzZXJ2ZXJzLCBwMnApIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG5cclxuICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uQ3JlYXRlXHJcbiAgICAvLyBUT0RPOiByZW1vdmUgdmFsdWUgYW5kIGFkZCByZXNvdXJjZXM/IHNob3VsZCBzaW1pbGFyIHRvIDFzdCBjcmVhdGVcclxuXHJcbiAgICBsZXQgdG9JbnZpdGUgPSBvYnNlcnZlcnM7XHJcblxyXG4gICAgLy8gbGV0IGludml0ZVByb21pc2VzID0gW107XHJcblxyXG4gICAgLyogIG9ic2VydmVycy5mb3JFYWNoKChvYnNlcnZlcik9PiB7XHJcbiAgICAgIGlmICghX3RoaXMuaW52aXRhdGlvbnNbb2JzZXJ2ZXJdKSB7XHJcbiAgICAgICAgdG9JbnZpdGUucHVzaChvYnNlcnZlcik7XHJcbiAgICAgICAgX3RoaXMuaW52aXRhdGlvbnNbb2JzZXJ2ZXJdID0gb2JzZXJ2ZXI7XHJcbiAgICAgIH1cclxuICAgIH0pOyovXHJcblxyXG5cclxuICAgIGlmICh0b0ludml0ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGxvZy5sb2coJ1tTeW5jaGVyLkRhdGFPYmplY3RSZXBvcnRlcl0gSW52aXRlT2JzZXJ2ZXJzICcsIHRvSW52aXRlLCBfdGhpcy5fbWV0YWRhdGEpO1xyXG5cclxuICAgICAgdG9JbnZpdGUuZm9yRWFjaCgob2JzZXJ2ZXIpPT57XHJcblxyXG4gICAgICAgIGxldCBpbnZpdGF0aW9uID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgICAgIGxldCBpbnZpdGVNc2cgPSB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLFxyXG4gICAgICAgICAgICBib2R5OiB7IHJlc3VtZTogZmFsc2UsIHJlc291cmNlOiBfdGhpcy5fdXJsLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZhbHVlOiBfdGhpcy5fbWV0YWRhdGEsIGF1dGhvcmlzZTogW29ic2VydmVyXSB9XHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIGlmIChwMnApIGludml0ZU1zZy5ib2R5LnAycCA9IHAycDtcclxuXHJcbiAgICAgICAgICBpZiAoIV90aGlzLmRhdGEubXV0dWFsKSBpbnZpdGVNc2cuYm9keS5tdXR1YWwgPSBfdGhpcy5kYXRhLm11dHVhbDtcclxuXHJcbiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGludml0ZU1zZywgKHJlcGx5KT0+e1xyXG4gICAgICAgICAgICBsb2cubG9nKCdbU3luY2hlci5EYXRhT2JqZWN0UmVwb3J0ZXJdIEludml0YXRpb24gcmVwbHkgJywgcmVwbHkpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICBpbnZpdGVkOiBvYnNlcnZlcixcclxuICAgICAgICAgICAgICBjb2RlOiByZXBseS5ib2R5ICYmIHJlcGx5LmJvZHkuY29kZSA/IHJlcGx5LmJvZHkuY29kZSA6IDUwMCxcclxuICAgICAgICAgICAgICBkZXNjOiByZXBseS5ib2R5ICYmIHJlcGx5LmJvZHkuZGVzYyA/IHJlcGx5LmJvZHkuZGVzYyA6ICdVbmtub3duJ1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlIDwgMzAwKSByZXNvbHZlKHJlc3VsdCk7XHJcbi8qICAgICAgICAgICAgZWxzZSBpZiAocmVzdWx0LmNvZGUgPj0gMzAwKSB7XHJcbiAgICAgICAgICAgICAgaWYgKF90aGlzLm1ldGFkYXRhLm9mZmxpbmUpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuX3Byb2Nlc3NPZmZsaW5lSW52aXRhdGlvbihpbnZpdGVNc2cpKTtcclxuICAgICAgICAgICAgICB9Ki8gZWxzZSByZWplY3QocmVzdWx0KTtcclxuLy8gICAgICAgICAgICB9IFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIF90aGlzLmludml0YXRpb25zLnB1c2goaW52aXRhdGlvbik7XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vICAgICAgcmV0dXJuKGludml0ZVByb21pc2VzKTtcclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhXHJcbiAgICovXHJcbiAgZGVsZXRlKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgIGlmKF90aGlzLl9oZWFydEJlYXQpIF90aGlzLl9oZWFydEJlYXQuc3RvcCgpO1xyXG5cclxuICAgIF90aGlzLl9kZWxldGVDaGlsZHJlbnMoKS50aGVuKChyZXN1bHQpPT57XHJcbiAgICAgIGxvZy5sb2cocmVzdWx0KTtcclxuICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25EZWxldGVcclxuICAgICAgbGV0IGRlbGV0ZU1zZyA9IHtcclxuICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCxcclxuICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZGVsZXRlTXNnLCAocmVwbHkpID0+IHtcclxuICAgICAgICBsb2cubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItREVMRVRFOiAnLCByZXBseSk7XHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpO1xyXG4gICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9yZXBvcnRlcnNbX3RoaXMuX3VybF07XHJcblxyXG4gICAgICAgICAgLy9fdGhpcy5fc3luY09iai51bm9ic2VydmUoKTtcclxuICAgICAgICAgIF90aGlzLl9zeW5jT2JqID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN1YnNjcmlwdGlvbnMgcmVxdWVzdGVkIGFuZCBhY2NlcHRlZCB0byB0aGlzIHJlcG9ydGVyXHJcbiAgICogQHR5cGUge09iamVjdDxIeXBlcnR5VVJMLCBTeW5jU3Vic2NyaXB0aW9uPn1cclxuICAgKi9cclxuICBnZXQgc3Vic2NyaXB0aW9ucygpIHsgcmV0dXJuIHRoaXMuX3N1YnNjcmlwdGlvbnM7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3Mgc3Vic2NyaWJlIGFuZCB1bnN1YnNjcmliZSBub3RpZmljYXRpb25zXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50c1xyXG4gICAqL1xyXG4gIG9uU3Vic2NyaXB0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIgPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZSdzXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50c1xyXG4gICAqL1xyXG4gIG9uUmVzcG9uc2UoY2FsbGJhY2spIHtcclxuICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZWFkIG5vdGlmaWNhdGlvbnNcclxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrXHJcbiAgICovXHJcblxyXG4gIG9uUmVhZChjYWxsYmFjaykge1xyXG4gICAgdGhpcy5fb25SZWFkSGFuZGxlciA9IGNhbGxiYWNrO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgZXhlY3V0ZSBub3RpZmljYXRpb25zXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFja1xyXG4gICAqL1xyXG5cclxuICBvbkV4ZWN1dGUoY2FsbGJhY2spIHtcclxuICAgIHRoaXMuX29uRXhlY3V0ZUhhbmRsZXIgPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHBhcmVudCBTeW5jaGVyIC0+IF9vbkZvcndhcmRcclxuICBfb25Gb3J3YXJkKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsb2cubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItUkNWOiAnLCBtc2cpO1xyXG4gICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7XHJcbiAgICAgIGNhc2UgJ3N1YnNjcmliZSc6IF90aGlzLl9vblN1YnNjcmliZShtc2cpOyBicmVhaztcclxuICAgICAgY2FzZSAndW5zdWJzY3JpYmUnOiBfdGhpcy5fb25VblN1YnNjcmliZShtc2cpOyBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBTeW5jaGVyIC0+IHN1YnNjcmliZVxyXG4gIF9vblN1YnNjcmliZShtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207XHJcbiAgICBsZXQgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChoeXBlcnR5VXJsKTtcclxuICAgIGxldCBkb21haW4gPSBkaXZpZGVkVVJMLmRvbWFpbjtcclxuICAgIGxldCBtdXR1YWwgPSB0cnVlO1xyXG5cclxuICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykgJiYgIW1zZy5ib2R5Lm11dHVhbCkgbXV0dWFsID0gZmFsc2U7XHJcblxyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFJlcG9ydGVyLl9vblN1YnNjcmliZV0nLCBtc2csIGRvbWFpbiwgZGl2aWRlZFVSTCk7XHJcblxyXG4gICAgbGV0IGV2ZW50ID0ge1xyXG4gICAgICB0eXBlOiBtc2cuYm9keS50eXBlLFxyXG4gICAgICB1cmw6IGh5cGVydHlVcmwsXHJcblxyXG4gICAgICBkb21haW46IGRvbWFpbixcclxuXHJcbiAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSxcclxuXHJcbiAgICAgIG51dHVhbDogbXV0dWFsLFxyXG5cclxuICAgICAgYWNjZXB0OiAoKSA9PiB7XHJcbiAgICAgICAgLy9jcmVhdGUgbmV3IHN1YnNjcmlwdGlvblxyXG4gICAgICAgIGxldCBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnbGl2ZScgfTtcclxuICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjtcclxuICAgICAgICBpZiAoX3RoaXMubWV0YWRhdGEuc3Vic2NyaXB0aW9ucykgeyBfdGhpcy5tZXRhZGF0YS5zdWJzY3JpcHRpb25zLnB1c2goc3ViLnVybCk7IH1cclxuXHJcbiAgICAgICAgbGV0IG1zZ1ZhbHVlID0gZGVlcENsb25lKF90aGlzLl9tZXRhZGF0YSk7XHJcbiAgICAgICAgbXNnVmFsdWUuZGF0YSA9IGRlZXBDbG9uZShfdGhpcy5kYXRhKTtcclxuICAgICAgICBtc2dWYWx1ZS52ZXJzaW9uID0gX3RoaXMuX3ZlcnNpb247XHJcblxyXG4gICAgICAgIC8vcHJvY2VzcyBhbmQgc2VuZCBjaGlsZHJlbnMgZGF0YVxyXG4gICAgICAgIC8vIGxldCBjaGlsZHJlblZhbHVlcyA9IHt9O1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gaWYgKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpIHtcclxuICAgICAgICAvLyAgIE9iamVjdC5rZXlzKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goKGNoaWxkcmVuSWQpID0+IHtcclxuICAgICAgICAvLyAgICAgbGV0IGNoaWxkcmVuRGF0YSA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRyZW5JZF07XHJcbiAgICAgICAgLy8gICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkcmVuSWRdID0gZGVlcENsb25lKGNoaWxkcmVuRGF0YSk7XHJcbiAgICAgICAgLy8gICB9KTtcclxuICAgICAgICAvLyAgIG1zZ1ZhbHVlLmNoaWxkcmVuT2JqZWN0cyA9IGNoaWxkcmVuVmFsdWVzO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgbGV0IHNlbmRNc2cgPSB7XHJcbiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZhbHVlOiBtc2dWYWx1ZSB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeVxyXG4gICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykgJiYgIW1zZy5ib2R5Lm11dHVhbCkge1xyXG4gICAgICAgICAgc2VuZE1zZy5ib2R5Lm11dHVhbCA9IG1zZy5ib2R5Lm11dHVhbDsvLyBUT0RPOiByZW1vdmU/XHJcbiAgICAgICAgICBfdGhpcy5kYXRhLm11dHVhbCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKF90aGlzLl9oZWFydEJlYXQpIHtcclxuICAgICAgICAgIHNlbmRNc2cuYm9keS52YWx1ZS5jaGlsZHJlbk9iamVjdHMgPSB7fTtcclxuICAgICAgICAgIHNlbmRNc2cuYm9keS52YWx1ZS5jaGlsZHJlbk9iamVjdHMuaGVhcnRiZWF0ID0gX3RoaXMuX2hlYXJ0QmVhdC5oZWFydGJlYXQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlci5fb25TdWJzY3JpYmUuYWNjZXB0XSBzZW5kaW5nIHJlc3BvbnNlOiAnLCBzZW5kTXNnKVxyXG5cclxuICAgICAgICAvL3NlbmQgb2sgcmVzcG9uc2UgbWVzc2FnZVxyXG4gICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoc2VuZE1zZyk7XHJcblxyXG4gICAgICAgIHJldHVybiBzdWI7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICByZWplY3Q6IChyZWFzb24pID0+IHtcclxuICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2VcclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHtcclxuICAgICAgbG9nLmxvZygnU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7XHJcbiAgICAgIF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIoZXZlbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gdGhpcyAtPiBfb25Gb3J3YXJkOiBlbWl0dGVkIGJ5IGEgcmVtb3RlIERhdGFPYmplY3RPYnNlcnZlciAtPiB1bnN1YnNjcmliZVxyXG4gIF9vblVuU3Vic2NyaWJlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBoeXBlcnR5VXJsID0gbXNnLmJvZHkuZnJvbTtcclxuICAgIGxldCBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKGh5cGVydHlVcmwpO1xyXG4gICAgbGV0IGRvbWFpbiA9IGRpdmlkZWRVUkwuZG9tYWluO1xyXG5cclxuICAgIGxvZy5sb2coJ1tEYXRhT2JqZWN0UmVwb3J0ZXIuX29uVW5TdWJzY3JpYmVdJywgbXNnLCBkb21haW4sIGRpdmlkZWRVUkwpO1xyXG5cclxuICAgIC8vbGV0IHN1YiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdO1xyXG4gICAgZGVsZXRlIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdO1xyXG4gICAgZGVsZXRlIF90aGlzLmludml0YXRpb25zW2h5cGVydHlVcmxdO1xyXG5cclxuICAgIGxldCBldmVudCA9IHtcclxuICAgICAgdHlwZTogbXNnLmJvZHkudHlwZSxcclxuICAgICAgdXJsOiBoeXBlcnR5VXJsLFxyXG4gICAgICBkb21haW46IGRvbWFpbixcclxuICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFRPRE86IGNoZWNrIGlmIHRoZSBfb25TdWJzY3JpcHRpb25IYW5kbGVyIGl0IGlzIHRoZSBzYW1lIG9mIHRoZSBzdWJzY3JpcHRpb25zPz8/XHJcbiAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikge1xyXG4gICAgICBsb2cubG9nKCdVTi1TVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTtcclxuICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrXHJcbiAgX29uUmVzcG9uc2UobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBldmVudCA9IHtcclxuICAgICAgdHlwZTogbXNnLnR5cGUsXHJcbiAgICAgIHVybDogbXNnLmZyb20sXHJcbiAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGVcclxuICAgIH07XHJcblxyXG4gICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikge1xyXG4gICAgICBsb2cubG9nKCdSRVNQT05TRS1FVkVOVDogJywgZXZlbnQpO1xyXG4gICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZFxyXG4gIF9vblJlYWQobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGNoaWxkcmVuc1NpemUgPSBKU09OLnN0cmluZ2lmeShfdGhpcy5jaGlsZHJlbnNKU09OKS5sZW5ndGg7XHJcblxyXG4gICAgbGV0IGxhcmdlT2JqZWN0ID0gKGNoaWxkcmVuc1NpemUgPiBfdGhpcy5fY2hpbGRyZW5TaXplVGhyZXNob2xkKSA/IHRydWUgOiBmYWxzZTtcclxuXHJcbiAgICBsZXQgZXZlbnQgPSB7XHJcbiAgICAgIHR5cGU6IG1zZy50eXBlLFxyXG4gICAgICB1cmw6IG1zZy5mcm9tLFxyXG5cclxuICAgICAgYWNjZXB0OiAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGxhcmdlT2JqZWN0KSBfdGhpcy5fc3luY1JlcGx5Rm9yTGFyZ2VEYXRhKG1zZyk7XHJcbiAgICAgICAgZWxzZSBfdGhpcy5fc3luY1JlcGx5KG1zZyk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICByZWplY3Q6IChyZWFzb24pID0+IHtcclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gaWYgdGhlIHJlcXVlc3RlciBpcyBhbiBhdXRob3Jpc2VkIG9ic2VydmVyLCB0aGUgZGF0YSBvYmplY3QgaXMgcmVzcG9uZGVkIG90aGVyd2lzZSBhbiBldmVudCBpcyB0cmlnZ2VyZWRcclxuICAgIGxldCBzdWJzY3JpcHRpb25zID0gW107XHJcblxyXG4gICAgaWYgKF90aGlzLm1ldGFkYXRhLnN1YnNjcmlwdGlvbnMpIHtcclxuICAgICAgc3Vic2NyaXB0aW9ucyA9IF90aGlzLm1ldGFkYXRhLnN1YnNjcmlwdGlvbnM7XHJcbiAgICB9IGVsc2UgaWYgKF90aGlzLl9zdWJzY3JpcHRpb25zKSB7XHJcbiAgICAgIHN1YnNjcmlwdGlvbnMgPSBPYmplY3Qua2V5cyhfdGhpcy5fc3Vic2NyaXB0aW9ucykubWFwKGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gX3RoaXMuX3N1YnNjcmlwdGlvbnNba2V5XS51cmw7IH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzdWJzY3JpcHRpb25zLmluZGV4T2YobXNnLmZyb20pICE9IC0xKSB7XHJcbiAgICAgIGlmIChsYXJnZU9iamVjdCkgX3RoaXMuX3N5bmNSZXBseUZvckxhcmdlRGF0YShtc2cpO1xyXG4gICAgICBlbHNlIF90aGlzLl9zeW5jUmVwbHkobXNnKTtcclxuICAgIH0gZWxzZSBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHtcclxuICAgICAgbG9nLmxvZygnUkVBRC1FVkVOVDogJywgZXZlbnQpO1xyXG4gICAgICBfdGhpcy5fb25SZWFkSGFuZGxlcihldmVudCk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0IGNoaWxkcmVuc0pTT04oKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGNoaWxkcmVucyA9IHt9O1xyXG5cclxuLy8gICAgbGV0IGNoaWxkcmVuO1xyXG5cclxuLy8gICAgZm9yIChjaGlsZHJlbiBpbiBfdGhpcy5fY2hpbGRyZW5PYmplY3RzKSB7XHJcbiAgICAgIGxldCBjaGlsZDtcclxuLy8gICAgICBjaGlsZHJlbnNbY2hpbGRyZW5dID0ge307XHJcbiAgICAgIGZvciAoY2hpbGQgaW4gX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykge1xyXG4gICAgICAgIGNoaWxkcmVuc1tjaGlsZF0gPSB7fTtcclxuICAgICAgICBjaGlsZHJlbnNbY2hpbGRdLnZhbHVlID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZF0ubWV0YWRhdGE7XHJcbiAgICAgICAgY2hpbGRyZW5zW2NoaWxkXS5pZGVudGl0eSA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRdLmlkZW50aXR5O1xyXG4gICAgICB9XHJcbi8vICAgIH1cclxuXHJcbiAgICByZXR1cm4gY2hpbGRyZW5zO1xyXG4gIH1cclxuXHJcbiAgX3N5bmNSZXBseShtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IG9iamVjdFZhbHVlID0gZGVlcENsb25lKF90aGlzLm1ldGFkYXRhKTtcclxuXHJcbiAgICBvYmplY3RWYWx1ZS5kYXRhID0gZGVlcENsb25lKF90aGlzLmRhdGEpO1xyXG4gICAgb2JqZWN0VmFsdWUuY2hpbGRyZW5PYmplY3RzID0gZGVlcENsb25lKF90aGlzLmNoaWxkcmVuc0pTT04pO1xyXG5cclxuICAgIG9iamVjdFZhbHVlLnZlcnNpb24gPSBfdGhpcy5fdmVyc2lvbjtcclxuXHJcbiAgICBsZXQgcmVzcG9uc2UgPSB7XHJcbiAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6IG9iamVjdFZhbHVlIH1cclxuICAgIH07XHJcblxyXG4gICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXNwb25zZSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBvbmx5IHVzZWQgaWYgdGhlIGRhdGEgb2JqZWN0IHRvIGJlIHN5bmNoZWQgaGFzIGNoaWxkcmVuT2plY3RzIHRvbyBsYXJnZVxyXG5cclxuICBfc3luY1JlcGx5Rm9yTGFyZ2VEYXRhKG1zZykge1xyXG4gIC8vc2V0IGF0dHJpYnV0ZSB3aXRoIG51bWJlciBvZiBzcGxsaXRlZCBtZXNzYWdlc1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAvLyBsZXRzIHNldCB0aGUgaW5pdGlhbCBtZXNzYWdlIHdpdGggbm8gY2hpbGRPYmplY3RzXHJcblxyXG4gICAgbGV0IG9iamVjdFZhbHVlID0gZGVlcENsb25lKF90aGlzLm1ldGFkYXRhKTtcclxuXHJcbiAgICBvYmplY3RWYWx1ZS5kYXRhID0gZGVlcENsb25lKF90aGlzLmRhdGEpO1xyXG5cclxuICAgIG9iamVjdFZhbHVlLnZlcnNpb24gPSBfdGhpcy5fdmVyc2lvbjtcclxuXHJcbiAgICBkZWxldGUgb2JqZWN0VmFsdWUuY2hpbGRyZW5PYmplY3RzO1xyXG5cclxuICAgIGxldCBjaGlsZHJlbjtcclxuICAgIGxldCB2YWx1ZXMgPSBbXTsgLy8gYXJyYXkgb2YgdmFsdWVzIHRvIGJlIHNlbnQgaW4gc2VwYXJhdGVkIHJlc3BvbnNlc1xyXG4gICAgbGV0IGNoaWxkcmVuVmFsdWUgPSB7fTsgLy8gdmFsdWUgdG8gYmUgdXNlZCBpbiBlYWNoIHJlc3BvbnNlXHJcblxyXG4gICAgZm9yIChjaGlsZCBpbiBfdGhpcy5fY2hpbGRyZW5PYmplY3RzKSB7XHJcbi8vICAgICAgbGV0IGNoaWxkO1xyXG4gICAgICBjaGlsZHJlblZhbHVlW2NoaWxkXSA9IHt9O1xyXG4vLyAgICAgIGZvciAoY2hpbGQgaW4gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZHJlbl0pIHtcclxuICAgICAgICBpZiAoSlNPTi5zdHJpbmdpZnkoY2hpbGRyZW5WYWx1ZSkubGVuZ3RoID4gX3RoaXMuX2NoaWxkcmVuU2l6ZVRocmVzaG9sZCkge1xyXG4gICAgICAgICAgLy9jaGlsZHJlblZhbHVlIGJpZyBlbm91Z2ggdG8gYmUgc2VudCBpbiBhIHJlc3BvbnNlIG1lc3NhZ2VcclxuICAgICAgICAgIHZhbHVlcy5wdXNoKGNoaWxkcmVuVmFsdWUpO1xyXG4vLyAgICAgICAgICBjaGlsZHJlblZhbHVlID0ge307XHJcbi8vICAgICAgICAgIGNoaWxkcmVuVmFsdWVbY2hpbGRdID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNoaWxkcmVuVmFsdWVbY2hpbGRdID0ge307XHJcbiAgICAgICAgY2hpbGRyZW5WYWx1ZVtjaGlsZF0udmFsdWUgPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkXS5tZXRhZGF0YTtcclxuICAgICAgICBjaGlsZHJlblZhbHVlW2NoaWxkXS5pZGVudGl0eSA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRdLmlkZW50aXR5O1xyXG4vLyAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YWx1ZXMucHVzaChjaGlsZHJlblZhbHVlKTtcclxuXHJcbiAgICBvYmplY3RWYWx1ZS5yZXNwb25zZXMgPSB2YWx1ZXMubGVuZ3RoICsgMTsgLy9udW1iZXIgb2YgcmVzcG9uc2VzIHRvIGJlIHNlbnRcclxuXHJcbiAgICBsZXQgaW5pdGlhbFJlc3BvbnNlID0ge1xyXG4gICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSxcclxuICAgICAgYm9keTogeyBjb2RlOiAxMDAsIHZhbHVlOiBvYmplY3RWYWx1ZSB9XHJcbiAgICB9O1xyXG5cclxuICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW5pdGlhbFJlc3BvbnNlKTtcclxuXHJcbiAgICB2YWx1ZXMuZm9yRWFjaCgodmFsdWUpID0+IHtcclxuXHJcbiAgICAgIGxldCByZXNwb25zZSA9IGRlZXBDbG9uZShpbml0aWFsUmVzcG9uc2UpO1xyXG5cclxuICAgICAgcmVzcG9uc2UuYm9keS52YWx1ZSA9IHZhbHVlO1xyXG5cclxuICAgICAgcmVzcG9uc2UuYm9keS52YWx1ZS5yZXNwb25zZXMgPSBvYmplY3RWYWx1ZS5yZXNwb25zZXM7XHJcblxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHsgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXNwb25zZSk7IH0sIDUwKTtcclxuXHJcbiAgICAgIC8vIHNob3VsZCBwdXQgYSB0aW1lb3V0P1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8vIEV4ZWN1dGUgcmVxdWVzdCByZWNlaXZlZFxyXG4gIF9vbkV4ZWN1dGUobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGlmICghbXNnLmJvZHkubWV0aG9kKSB0aHJvdyAnW0RhdGFPYmplY3RSZXBvcnRlci5fb25FeGVjdXRlXSBtZXRob2QgbWlzc2luZyAnLCBtc2c7XHJcblxyXG4gICAgbGV0IHJlc3BvbnNlID0ge1xyXG4gICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSxcclxuICAgICAgYm9keTogeyBjb2RlOiAyMDAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsZXQgZXZlbnQgPSB7XHJcbiAgICAgIHR5cGU6IG1zZy50eXBlLFxyXG4gICAgICB1cmw6IG1zZy5mcm9tLFxyXG4gICAgICBtZXRob2Q6IG1zZy5ib2R5Lm1ldGhvZCxcclxuICAgICAgcGFyYW1zOiBtc2cuYm9keS5wYXJhbXMsXHJcblxyXG4gICAgICBhY2NlcHQ6ICgpID0+IHtcclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlc3BvbnNlKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHJlamVjdDogKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sXHJcbiAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwMSwgZGVzYzogcmVhc29uIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoX3RoaXMuX29uRXhlY3V0ZUhhbmRsZXIpIHtcclxuICAgICAgbG9nLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlcl0gRVhFQ1VURS1FVkVOVDogJywgZXZlbnQpO1xyXG4gICAgICBfdGhpcy5fb25FeGVjdXRlSGFuZGxlcihldmVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRGF0YU9iamVjdFJlcG9ydGVyO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdEYXRhT2JqZWN0T2JzZXJ2ZXInKTtcclxuXHJcbmltcG9ydCB7IGRlZXBDbG9uZSB9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IERhdGFPYmplY3QgZnJvbSAnLi9EYXRhT2JqZWN0JztcclxuXHJcbmxldCBGaWx0ZXJUeXBlID0ge0FOWTogJ2FueScsIFNUQVJUOiAnc3RhcnQnLCBFWEFDVDogJ2V4YWN0J307XHJcblxyXG4vKipcclxuICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgc3Vic2NyaWJlIGNhbGwuXHJcbiAqIFRvIGJlIHVzZWQgYXMgYW4gb2JzZXJ2YXRpb24gcG9pbnQgZnJvbSBhIERhdGFPYmplY3RSZXBvcnRlciBjaGFuZ2UuXHJcbiAqL1xyXG5jbGFzcyBEYXRhT2JqZWN0T2JzZXJ2ZXIgZXh0ZW5kcyBEYXRhT2JqZWN0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyB7XHJcbiAgLyogcHJpdmF0ZVxyXG4gIF9jaGFuZ2VMaXN0ZW5lcjogTXNnTGlzdGVuZXJcclxuXHJcbiAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLVxyXG4gIF9maWx0ZXJzOiB7PGZpbHRlcj46IHt0eXBlOiA8c3RhcnQsIGV4YWN0PiwgY2FsbGJhY2s6IDxmdW5jdGlvbj59IH1cclxuICAqL1xyXG5cclxuICAvKipcclxuICAgKiBAaWdub3JlXHJcbiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuc3Vic2NyaWJlIG1ldGhvZFxyXG4gICAqL1xyXG5cclxuICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5XHJcbiAgY29uc3RydWN0b3IoaW5wdXQpIHtcclxuICAgIC8vdG9kbzogY2hlY2sgd2h5XHJcbiAgICAvL2lucHV0LmluaXRpYWxEYXRhID0gaW5wdXQuaW5pdGlhbERhdGEuZGF0YTtcclxuXHJcbiAgICBzdXBlcihpbnB1dCk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fdmVyc2lvbiA9IGlucHV0LnZlcnNpb247XHJcbiAgICBfdGhpcy5fZmlsdGVycyA9IHt9O1xyXG5cclxuICAgIF90aGlzLl9zeW5jT2JqLm9ic2VydmUoKGV2ZW50KSA9PiB7XHJcbiAgICAgIF90aGlzLl9vbkZpbHRlcihldmVudCk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTeW5jIERhdGEgT2JqZWN0IE9ic2VydmVyIHdpdGggbGFzdCB2ZXJzaW9uIG9mIERhdGEgT2JqZWN0IFJlcG9ydGVyLiBVc2VmdWwgZm9yIFJlc3VtZXNcclxuICAgKi9cclxuICBzeW5jKCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsb2cuaW5mbygnW0RhdGFPYmplY3RPYnNlcnZlcl9zeW5jXSBzeW5jaHJvbmlzaW5nICcpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgY3JpdGVyaWEgPSB7fTtcclxuXHJcbi8vICAgICAgaWYgKHRoaXMubWV0YWRhdGEuYmFja3VwUmV2aXNpb24pIGNyaXRlcmlhLmJhY2t1cFJldmlzaW9uID0gdGhpcy5tZXRhZGF0YS5iYWNrdXBSZXZpc2lvbjtcclxuXHJcbiAgICAgIF90aGlzLl9zeW5jaGVyLnJlYWQoX3RoaXMuX21ldGFkYXRhLnVybCwgY3JpdGVyaWEpLnRoZW4oKHZhbHVlKT0+e1xyXG4gICAgICAgIGxvZy5pbmZvKCdbRGF0YU9iamVjdE9ic2VydmVyX3N5bmNdIHZhbHVlIHRvIHN5bmM6ICcsIHZhbHVlKTtcclxuXHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbihfdGhpcy5kYXRhLCBkZWVwQ2xvbmUodmFsdWUuZGF0YSkpO1xyXG5cclxuICAgICAgICBfdGhpcy5fdmVyc2lvbiA9IHZhbHVlLnZlcnNpb247XHJcblxyXG4gICAgICAgIF90aGlzLl9tZXRhZGF0YS5sYXN0TW9kaWZpZWQgPSB2YWx1ZS5sYXN0TW9kaWZpZWQ7XHJcblxyXG4gICAgICAgIC8vVE9ETzogY2hlY2sgZmlyc3QgaWYgdGhlcmUgYXJlIG5ldyBjaGlsZHJlbk9iamVjdHMgdG8gYXZvaWQgb3ZlcmhlYWRcclxuXHJcbiAgICAgICAgaWYgKHZhbHVlLmNoaWxkcmVuT2JqZWN0cykge1xyXG4gICAgICAgICAgX3RoaXMucmVzdW1lQ2hpbGRyZW5zKHZhbHVlLmNoaWxkcmVuT2JqZWN0cyk7XHJcbiAgICAgICAgICBfdGhpcy5fc3RvcmVDaGlsZHJlbnMoKTtcclxuICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHJlc29sdmUodHJ1ZSk7XHJcblxyXG5cclxuICAgICAgICAvKmlmICh2YWx1ZS52ZXJzaW9uICE9IF90aGlzLl92ZXJzaW9uKSB7XHJcbiAgICAgICAgICBsb2cuaW5mbygnW0RhdGFPYmplY3RPYnNlcnZlcl9zeW5jXSB1cGRhdGluZyBleGlzdGluZyBkYXRhOiAnLCBfdGhpcy5kYXRhKTtcclxuXHJcbiAgICAgICAgICBPYmplY3QuYXNzaWduKF90aGlzLmRhdGEgfHwge30sIGRlZXBDbG9uZSh2YWx1ZS5kYXRhKSk7XHJcblxyXG4gICAgICAgICAgX3RoaXMuX21ldGFkYXRhID0gZGVlcENsb25lKHZhbHVlKTtcclxuXHJcbiAgICAgICAgICBkZWxldGUgX3RoaXMuX21ldGFkYXRhLmRhdGE7XHJcblxyXG4gICAgICAgICAgX3RoaXMuX3ZlcnNpb24gPSB2YWx1ZS52ZXJzaW9uO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1tEYXRhT2JqZWN0T2JzZXJ2ZXJfc3luY10gZXhpc3RpbmcgZGF0YSBpcyB1cGRhdGVkOiAnLCB2YWx1ZSk7XHJcbiAgICAgICAgfSovXHJcblxyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbG9nLmluZm8oJ1tEYXRhT2JqZWN0T2JzZXJ2ZXJfc3luY10gc3luYyBmYWlsZWQ6ICcsIHJlYXNvbik7XHJcbiAgICAgICAgcmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgfVxyXG5cclxuICBfc3RvcmVDaGlsZHJlbnMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBjaGlsZHJlbnMgPSB7fTtcclxuXHJcbiAgICAvL1RPRE86IHRvIGJlIHNlbnQgdG8gSHlwZXJ0eVJlc291cmNlU3RvcmFnZSB3aGVuIHJlYWR5IHRvIGhhbmRsZSBDaGF0IE1lc3NhZ2VzXHJcblxyXG4gICAgT2JqZWN0LmtleXMoX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykuZm9yRWFjaCgoY2hpbGRJZCkgPT4ge1xyXG4gICAgICBsZXQgY2hpbGRyZW4gPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzO1xyXG4vLyAgICAgIGNoaWxkcmVuc1tjaGlsZHJlblJlc291cmNlXSA9IHt9O1xyXG5cclxuLy8gICAgICBPYmplY3Qua2V5cyhjaGlsZHJlbikuZm9yRWFjaCgoY2hpbGRJZCkgPT4ge1xyXG4gICAgICAgIGNoaWxkcmVuc1tjaGlsZElkXSA9IHt9O1xyXG4gICAgICAgIGNoaWxkcmVuc1tjaGlsZElkXS52YWx1ZSA9IGNoaWxkcmVuW2NoaWxkSWRdLm1ldGFkYXRhO1xyXG4gICAgICAgIGNoaWxkcmVuc1tjaGlsZElkXS5pZGVudGl0eSA9IGNoaWxkcmVuW2NoaWxkSWRdLmlkZW50aXR5O1xyXG4vLyAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgICBsZXQgbXNnID0ge1xyXG5cclxuICAgICAgICBmcm9tOiBfdGhpcy5fb3duZXIsXHJcbiAgICAgICAgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsXHJcbiAgICAgICAgdHlwZTogJ2NyZWF0ZScsXHJcbiAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgcmVzb3VyY2U6IF90aGlzLl91cmwsXHJcbiAgICAgICAgICBhdHRyaWJ1dGU6ICdjaGlsZHJlbk9iamVjdHMnLFxyXG4gICAgICAgICAgdmFsdWU6IGNoaWxkcmVuc1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTtcclxuXHJcbiAgfVxyXG5cclxuICBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5fYWxsb2NhdGVMaXN0ZW5lcnMoKTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJywgKG1zZykgPT4ge1xyXG4gICAgICBpZiAobXNnLnR5cGUgPT09ICd1cGRhdGUnKSB7XHJcbiAgICAgICAgbG9nLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7XHJcbiAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfcmVsZWFzZUxpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lci5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YVxyXG4gICAqL1xyXG4gIGRlbGV0ZSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgaWYgKF90aGlzLl9oZWFydEJlYXQpIF90aGlzLl9oZWFydEJlYXQuc3RvcCgpO1xyXG5cclxuICAgIF90aGlzLl9kZWxldGVDaGlsZHJlbnMoKS50aGVuKCgpPT57XHJcbiAgICAgIF90aGlzLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcbiAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fb2JzZXJ2ZXJzW190aGlzLl91cmxdO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhXHJcbiAgICovXHJcbiAgdW5zdWJzY3JpYmUoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uTG9jYWxVblN1YnNjcmliZVxyXG4gICAgbGV0IHVuU3Vic2NyaWJlTXNnID0ge1xyXG4gICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLFxyXG4gICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH1cclxuICAgIH07XHJcblxyXG4gICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh1blN1YnNjcmliZU1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgIGxvZy5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci1VTlNVQlNDUklCRTogJywgcmVwbHkpO1xyXG4gICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHtcclxuICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpO1xyXG4gICAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fb2JzZXJ2ZXJzW190aGlzLl91cmxdO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZpbHRlciAtIEZpbHRlciB0aGF0IGlkZW50aWZpZXMgdGhlIGZpZWxkIChzZXBhcmF0ZWQgZG90IHBhdGgpLiBBY2NlcHRzICogYXQgdGhlIGVuZCBmb3IgYSBtb3JlIHVucmVzdHJpY3RlZCBmaWx0ZXJpbmcuXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFja1xyXG4gICAqL1xyXG4gIG9uQ2hhbmdlKGZpbHRlciwgY2FsbGJhY2spIHtcclxuICAgIGxldCBrZXkgPSBmaWx0ZXI7XHJcbiAgICBsZXQgZmlsdGVyT2JqID0ge1xyXG4gICAgICB0eXBlOiBGaWx0ZXJUeXBlLkVYQUNULFxyXG4gICAgICBjYWxsYmFjazogY2FsbGJhY2tcclxuICAgIH07XHJcblxyXG4gICAgbGV0IGlkeCA9IGZpbHRlci5pbmRleE9mKCcqJyk7XHJcbiAgICBpZiAoaWR4ID09PSBmaWx0ZXIubGVuZ3RoIC0gMSkge1xyXG4gICAgICBpZiAoaWR4ID09PSAwKSB7XHJcbiAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLkFOWTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7XHJcbiAgICAgICAga2V5ID0gZmlsdGVyLnN1YnN0cigwLCBmaWx0ZXIubGVuZ3RoIC0gMSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9maWx0ZXJzW2tleV0gPSBmaWx0ZXJPYmo7XHJcbiAgfVxyXG5cclxuICBfb25GaWx0ZXIoZXZlbnQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgT2JqZWN0LmtleXMoX3RoaXMuX2ZpbHRlcnMpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICBsZXQgZmlsdGVyID0gX3RoaXMuX2ZpbHRlcnNba2V5XTtcclxuICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkge1xyXG4gICAgICAgIC8vbWF0Y2ggYW55dGhpbmdcclxuICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpO1xyXG4gICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7XHJcbiAgICAgICAgLy9pZiBzdGFydHMgd2l0aCBmaWx0ZXIuLi5cclxuICAgICAgICBpZiAoZXZlbnQuZmllbGQuaW5kZXhPZihrZXkpID09PSAwKSB7XHJcbiAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5FWEFDVCkge1xyXG4gICAgICAgIC8vZXhhY3QgbWF0Y2hcclxuICAgICAgICBpZiAoZXZlbnQuZmllbGQgPT09IGtleSkge1xyXG4gICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb25EaXNjb25uZWN0ZWQoY2FsbGJhY2spIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgdGhpcy5fc3Vic2NyaWJlUmVnaXN0cmF0aW9uKClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX29uRGlzY29ubmVjdGVkID0gY2FsbGJhY2s7XHJcbiAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gcmVqZWN0KGVycikpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc3Vic2NyaWJlUmVnaXN0cmF0aW9uKCkge1xyXG5cclxuICAgIGNvbnN0IG1zZyA9IHtcclxuICAgICAgdHlwZTogJ3N1YnNjcmliZScsXHJcbiAgICAgIGZyb206IHRoaXMuX293bmVyLFxyXG4gICAgICB0bzogdGhpcy5fc3luY2hlci5fcnVudGltZVVybCArICcvc3Vic2NyaXB0aW9ucycsXHJcbiAgICAgIGJvZHk6IHtcclxuICAgICAgICByZXNvdXJjZXM6IFt0aGlzLl91cmwgKyAnL3JlZ2lzdHJhdGlvbiddXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2csIChyZXBseSkgPT4ge1xyXG4gICAgICAgIGxvZy5sb2coYFtEYXRhT2JqZWN0T2JzZXJ2ZXIuX3N1YnNjcmliZVJlZ2lzdHJhdGlvbl0gJHt0aGlzLl91cmx9IHJjdmVkIHJlcGx5IGAsIHJlcGx5KTtcclxuXHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICB0aGlzLl9nZW5lcmF0ZUxpc3RlbmVyKHRoaXMuX3VybCArICcvcmVnaXN0cmF0aW9uJyk7XHJcbiAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5lcnJvcignRXJyb3Igc3Vic2NyaWJpbmcgcmVnaXN0cmF0aW9uIHN0YXR1cyBmb3IgJywgdGhpcy5fdXJsKTtcclxuICAgICAgICAgIHJlamVjdCgnRXJyb3Igc3Vic2NyaWJpbmcgcmVnaXN0cmF0aW9uIHN0YXR1cyBmb3IgJyArIHRoaXMuX3VybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2dlbmVyYXRlTGlzdGVuZXIobm90aWZpY2F0aW9uVVJMKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9idXMuYWRkTGlzdGVuZXIobm90aWZpY2F0aW9uVVJMLCAobXNnKSA9PiB7XHJcbiAgICAgIGxvZy5sb2coYFtEYXRhT2JqZWN0T2JzZXJ2ZXIucmVnaXN0cmF0aW9uTm90aWZpY2F0aW9uXSAke190aGlzLl91cmx9OiBgLCBtc2cpO1xyXG4gICAgICBpZiAobXNnLmJvZHkudmFsdWUgJiYgbXNnLmJvZHkudmFsdWUgPT09ICdkaXNjb25uZWN0ZWQnICYmIF90aGlzLl9vbkRpc2Nvbm5lY3RlZCkge1xyXG4gICAgICAgIGxvZy5sb2coYFtEYXRhT2JqZWN0T2JzZXJ2ZXJdICR7X3RoaXMuX3VybH06IHdhcyBkaXNjb25uZWN0ZWQgYCwgbXNnKTtcclxuICAgICAgICBfdGhpcy5fb25EaXNjb25uZWN0ZWQoKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVxdWVzdHMgdGhlIHJlcG9ydGVyIHRvIGV4ZWN1dGUgYSBtZXRob2Qgb24gdGhlIGRhdGEgb2JqZWN0XHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1ldGhvZCAtIE5hbWUgb2YgdGhlIGZ1bmN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxyXG4gICAqIEBwYXJhbSB7YXJyYXl9IHBhcmFtcyAtIGFycmF5IG9mIHBhcmFtZXRlcnMgZm9yIHRoZSByZXF1ZXN0ZWQgZnVuY3Rpb25cclxuICAgKiBAcmV0dXJuIHtwcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBleGVjdXRlKG1ldGhvZCwgcGFyYW1zKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBjb25zdCBtc2cgPSB7XHJcbiAgICAgICAgdHlwZTogJ2V4ZWN1dGUnLFxyXG4gICAgICAgIGZyb206IHRoaXMuX293bmVyLFxyXG4gICAgICAgIHRvOiBfdGhpcy5fdXJsLFxyXG4gICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgIG1ldGhvZDogbWV0aG9kLFxyXG4gICAgICAgICAgcGFyYW1zOiBwYXJhbXNcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmxvZyhgW0RhdGFPYmplY3RPYnNlcnZlci5leGVjdXRlXSAke190aGlzLl91cmx9IHJjdmVkIHJlcGx5IGAsIHJlcGx5KTtcclxuXHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy53YXJuKGBbRGF0YU9iamVjdE9ic2VydmVyLmV4ZWN1dGVdIGV4ZWN1dGlvbiBvZiBtZXRob2QgJHttZXRob2R9IHdhcyByZWplY3QgYnkgcmVwb3J0ZXJgKTtcclxuICAgICAgICAgIHJlamVjdChgW0RhdGFPYmplY3RPYnNlcnZlci5leGVjdXRlXSBleGVjdXRpb24gb2YgbWV0aG9kICR7bWV0aG9kfSB3YXMgcmVqZWN0IGJ5IHJlcG9ydGVyYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRGF0YU9iamVjdE9ic2VydmVyO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vKipcclxuICogQGFjY2VzcyBwcml2YXRlXHJcbiAqIFRoaXMgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIGNvbGxlY3RpbmcgZGVsdGEgY2hhbmdlcyBpbiByZW1vdGUgb2JqZWN0cywgYmVmb3JlIHRoZSByZXNwb25zZSBvZiBzdWJzY3JpcHRpb24gcmVhY2ggdGhlIG9ic2VydmVyLlxyXG4gKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6XHJcbiAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKVxyXG4gKiAyLiAob2JzZXJ2ZXIpIDwtLWRlbHRhIHVwZGF0ZXMtLSAocmVwb3J0ZXIpXHJcbiAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKVxyXG4gKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uXHJcbiAqIFNpbmNlIHRoZXJlIGlzIG5vIERhdGFPYmplY3RPYnNlcnZlciBiZWZvcmUgdGhlIHVic2NyaXB0aW9uIGNvbmZpcm1hdGlvbiwgdGhlcmUgc2hvdWxkIGJlIHNvbWUgb3RoZXIgb2JqZWN0IGNvbGxlY3RpbmcgdGhlIHVwZGF0ZXMuXHJcbiAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi5cclxuICovXHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdEYXRhUHJvdmlzaW9uYWwnKTtcclxuXHJcbmNsYXNzIERhdGFQcm92aXNpb25hbCB7XHJcbiAgLyogcHJpdmF0ZVxyXG4gIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXVxyXG4gIF9saXN0ZW5lcjogTXNnTGlzdGVuZXJcclxuXHJcbiAgX2NoYW5nZXM6IFtdXHJcbiAgKi9cclxuXHJcbiAgY29uc3RydWN0b3Iob3duZXIsIHVybCwgYnVzLCBjaGlsZHJlbikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjtcclxuICAgIF90aGlzLl91cmwgPSB1cmw7XHJcbiAgICBfdGhpcy5fYnVzID0gYnVzO1xyXG4gICAgX3RoaXMuX2NoaWxkcmVuID0gY2hpbGRyZW47XHJcblxyXG4gICAgX3RoaXMuX2NoYW5nZXMgPSBbXTtcclxuICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgX2FsbG9jYXRlTGlzdGVuZXJzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIChtc2cpID0+IHtcclxuICAgICAgbG9nLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7XHJcbiAgICAgIF90aGlzLl9jaGFuZ2VzLnB1c2gobXNnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8qXHJcbiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTtcclxuICAgIGlmIChfdGhpcy5fY2hpbGRyZW4pIHtcclxuICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJztcclxuICAgICAgX3RoaXMuX2NoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgbGV0IGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7XHJcbiAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZlxyXG4gICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikge1xyXG4gICAgICAgICAgICBsb2cubG9nKG1zZyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcclxuICAgICAgfSk7XHJcbiAgICB9Ki9cclxuICB9XHJcblxyXG4gIF9yZWxlYXNlTGlzdGVuZXJzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fbGlzdGVuZXIucmVtb3ZlKCk7XHJcblxyXG4gICAgLypfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXIpID0+IHtcclxuICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7XHJcbiAgICB9KTsqL1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNoaWxkcmVuKCkgeyByZXR1cm4gdGhpcy5fY2hpbGRyZW47IH1cclxuXHJcbiAgYXBwbHkob2JzZXJ2ZXIpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fY2hhbmdlcy5mb3JFYWNoKChjaGFuZ2UpID0+IHtcclxuICAgICAgb2JzZXJ2ZXIuX2NoYW5nZU9iamVjdChvYnNlcnZlci5fc3luY09iaiwgY2hhbmdlKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRGF0YVByb3Zpc2lvbmFsO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdTeW5jaGVyJyk7XHJcblxyXG5pbXBvcnQgeyBkZWVwQ2xvbmUsIGRpdmlkZVVSTCB9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuXHJcbmltcG9ydCBEYXRhT2JqZWN0UmVwb3J0ZXIgZnJvbSAnLi9EYXRhT2JqZWN0UmVwb3J0ZXInO1xyXG5pbXBvcnQgRGF0YU9iamVjdE9ic2VydmVyIGZyb20gJy4vRGF0YU9iamVjdE9ic2VydmVyJztcclxuaW1wb3J0IERhdGFQcm92aXNpb25hbCBmcm9tICcuL0RhdGFQcm92aXNpb25hbCc7XHJcblxyXG4vKipcclxuKiBUaGUgbWFpbiBjbGFzcyBmb3IgdGhlIHN5bmNoZXIgcGFja2FnZS5cclxuKiBUaGUgU3luY2hlciBpcyBhIHNpbmdsZXRvbiBjbGFzcyBwZXIgSHlwZXJ0eS9VUkwgYW5kIGl0IGlzIHRoZSBvd25lciBvZiBhbGwgY3JlYXRlZCBEYXRhIFN5bmMgT2JqZWN0cyBhY2NvcmRpbmcgdG8gdGhlIFJlcG9ydGVyIC0gT2JzZXJ2ZXIgcGF0dGVybi5cclxuKiBNYWluIGZ1bmN0aW9uYWxpdHkgaXMgdG8gY3JlYXRlIHJlcG9ydGVycyBhbmQgdG8gc3Vic2NyaWJlIHRvIGV4aXN0aW5nIG9uZXMuXHJcbiovXHJcbmNsYXNzIFN5bmNoZXIge1xyXG4gIC8qIHByaXZhdGVcclxuICBfb3duZXI6IFVSTFxyXG4gIF9idXM6IE1pbmlCdXNcclxuXHJcbiAgX3N1YlVSTDogVVJMXHJcblxyXG4gIF9yZXBvcnRlcnM6IDx1cmw6IERhdGFPYmplY3RSZXBvcnRlcj5cclxuICBfb2JzZXJ2ZXJzOiA8dXJsOiBEYXRhT2JqZWN0T2JzZXJ2ZXI+XHJcbiAgX3Byb3Zpc2lvbmFsczogPHVybDogRGF0YVByb3Zpc2lvbmFsPlxyXG5cclxuICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tXHJcbiAgX29uTm90aWZpY2F0aW9uSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkXHJcbiAgX29uUmVzdW1lOiAoZXZlbnQpID0+IHZvaWRcclxuICAqL1xyXG5cclxuICAvKipcclxuICAqIENvbnN0cnVjdG9yIHRoYXQgc2hvdWxkIGJlIHVzZWQgYnkgdGhlIEh5cGVydHkgb3duZXJcclxuICAqIEBwYXJhbSB7SHlwZXJ0eVVSTH0gb3duZXIgLSBIeXBlcnR5IFVSTCBvd25lci4gQW4gVVJMIGFsbG9jYXRlZCBieSB0aGUgcnVudGltZSB0aGF0IHVuaXF1ZWx5IGlkZW50aWZpZXMgdGhlIEh5cGVydHkuXHJcbiAgKiBAcGFyYW0ge01pbmlCdXN9IGJ1cyAtIEFuIGluc3RhbmNlIG9mIHRoZSBNaW5pQnVzIHByb3ZpZGVkIGluIHRoZSBzYW5kYm94LiBXaGVuIGFuIG9iamVjdCAoUmVwb3J0ZXIgb3IgT2JzZXJ2ZWQpIGlzIGNyZWF0ZWQsIHRoZSBTeW5jaGVyTWFuYWdlciB3aWxsIGFkZCBhIGxpc3RlbmVyIGluIHRoZSBNaW5pQnVzIHRvIHJlY2VpdmUvc2VuZCBNZXNzYWdlcyBvZiB0aGF0IG9iamVjdC5cclxuICAqIEBwYXJhbSB7SlNPTn0gY29uZmlnIC0gQ29uZmlndXJhdGlvbiBkYXRhLiBUaGUgb25seSByZXF1aXJlZCBmaWVsZCBmb3Igbm93IGlzIHRoZSBydW50aW1lVVJMLlxyXG4gICovXHJcbiAgY29uc3RydWN0b3Iob3duZXIsIGJ1cywgY29uZmlnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9vd25lciA9IG93bmVyO1xyXG4gICAgX3RoaXMuX2J1cyA9IGJ1cztcclxuXHJcbiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJztcclxuICAgIF90aGlzLl9ydW50aW1lVXJsID0gY29uZmlnLnJ1bnRpbWVVUkw7XHJcblxyXG4gICAgX3RoaXMuX3AycEhhbmRsZXIgPSBjb25maWcucDJwSGFuZGxlcjtcclxuICAgIF90aGlzLl9wMnBSZXF1ZXN0ZXIgPSBjb25maWcucDJwUmVxdWVzdGVyO1xyXG5cclxuICAgIF90aGlzLl9yZXBvcnRlcnMgPSB7fTtcclxuICAgIF90aGlzLl9vYnNlcnZlcnMgPSB7fTtcclxuICAgIF90aGlzLl9wcm92aXNpb25hbHMgPSB7fTtcclxuXHJcbiAgICBidXMuYWRkTGlzdGVuZXIob3duZXIsIChtc2cpID0+IHtcclxuICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZlxyXG4gICAgICBpZiAobXNnLmZyb20gIT09IG93bmVyKSB7XHJcbiAgICAgICAgbG9nLmluZm8oJ1tTeW5jaGVyXSBTeW5jaGVyLVJDVjogJywgbXNnLCBfdGhpcyk7XHJcbiAgICAgICAgc3dpdGNoIChtc2cudHlwZSkge1xyXG4gICAgICAgICAgY2FzZSAnZm9yd2FyZCc6IF90aGlzLl9vbkZvcndhcmQobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICdjcmVhdGUnOiBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICdkZWxldGUnOiBfdGhpcy5fb25SZW1vdGVEZWxldGUobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICdleGVjdXRlJzogX3RoaXMuX29uRXhlY3V0ZShtc2cpOyBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBUaGUgb3duZXIgb2YgdGhlIFN5bmNoZXIgYW5kIGFsbCBjcmVhdGVkIHJlcG9ydGVycy5cclxuICAqIEB0eXBlIHtIeXBlcnR5VVJMfVxyXG4gICovXHJcbiAgZ2V0IG93bmVyKCkgeyByZXR1cm4gdGhpcy5fb3duZXI7IH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBbGwgb3duZWQgcmVwb3J0ZXJzLCB0aGUgb25lcyB0aGF0IHdlcmUgY3JlYXRlZCBieSBhIGNyZWF0ZVxyXG4gICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59XHJcbiAgKi9cclxuICBnZXQgcmVwb3J0ZXJzKCkgeyByZXR1cm4gdGhpcy5fcmVwb3J0ZXJzOyB9XHJcblxyXG4gIC8qKlxyXG4gICogQWxsIG93bmVkIG9ic2VydmVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBsb2NhbCBzdWJzY3JpcHRpb25cclxuICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fVxyXG4gICovXHJcbiAgZ2V0IG9ic2VydmVycygpIHsgcmV0dXJuIHRoaXMuX29ic2VydmVyczsgfVxyXG5cclxuICAvKipcclxuICAqIFJlcXVlc3QgYSBEYXRhT2JqZWN0UmVwb3J0ZXIgY3JlYXRpb24uIFRoZSBVUkwgd2lsbCBiZSBiZSByZXF1ZXN0ZWQgYnkgdGhlIGFsbG9jYXRpb24gbWVjaGFuaXNtLlxyXG4gICogQHBhcmFtICB7U2NoZW1hVVJMfSBzY2hlbWEgLSBIeXBlcnR5IENhdGFsb2d1ZSBVUkwgYWRkcmVzcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBKU09OLVNjaGVtYSBkZXNjcmliaW5nIHRoZSBEYXRhIE9iamVjdCBzY2hlbWFcclxuICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvblxyXG4gICogQHBhcmFtICB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIHJlcG9ydGVyXHJcbiAgKiBAcGFyYW0gIHtib29sZWFufSBzdG9yZSAtIChPcHRpb25hbCkgaWYgdHJ1ZSwgb2JqZWN0IHdpbGwgYmUgc3RvcmVkIGJ5IHRoZSBydW50aW1lXHJcbiAgKiBAcGFyYW0gIHtib29sZWFufSBwMnAgLSAoT3B0aW9uYWwpIGlmIHRydWUsIGRhdGEgc3luY2hyb25pc2F0aW9uIHN0cmVhbSB3aWxsIHVzZSBwMnAgY29ubmVjdGlvbiBhcyBtdWNoIGFzIHBvc3NpYmxlXHJcbiAgKiBAcGFyYW0gIHtzdHJpbmd9IG5hbWUgLSAoT3B0aW9uYWwpIHRoZSBuYW1lIG9mIHRoZSBkYXRhb2JqZWN0XHJcbiAgKiBAcGFyYW0gIHtNZXNzYWdlQm9keUlkZW50aXR5fSBpZGVudGl0eSAtIChvcHRpb25hbCkgaWRlbnRpdHkgZGF0YSB0byBiZSBhZGRlZCB0byBpZGVudGl0eSB0aGUgdXNlciByZXBvcnRlci4gVG8gYmUgdXNlZCBmb3IgbGVnYWN5IGlkZW50aXRpZXMuXHJcbiAgKiBAcGFyYW0gIHtTeW5jTWV0YWRhdGF9IGlucHV0IC0gKG9wdGlvbmFsKSBhbGwgbWV0YWRhdGEgcmVxdWlyZWQgdG8gc3VuYyB0aGUgRGF0YSBPYmplY3QuXHJcbiAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVBcclxuICAqL1xyXG4gIGNyZWF0ZShzY2hlbWEsIG9ic2VydmVycywgaW5pdGlhbERhdGEsIHN0b3JlID0gZmFsc2UsIHAycCA9IGZhbHNlLCBuYW1lID0gJ25vIG5hbWUnLCBpZGVudGl0eSwgaW5wdXQpIHtcclxuXHJcbiAgICBpZiAoIXNjaGVtYSkgdGhyb3cgRXJyb3IoJ1tTeW5jaGVyIC0gQ3JlYXRlXSAtIFlvdSBuZWVkIHNwZWNpZnkgdGhlIGRhdGEgb2JqZWN0IHNjaGVtYScpO1xyXG4gICAgaWYgKCFvYnNlcnZlcnMpIHRocm93IEVycm9yKCdbU3luY2hlciAtIENyZWF0ZV0gLVRoZSBvYnNlcnZlcnMgc2hvdWxkIGJlIGRlZmluZWQnKTtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgaW5wdXQgPSBpbnB1dCB8fCB7fTtcclxuICAgIGxldCBjcmVhdGVJbnB1dCAgPSBPYmplY3QuYXNzaWduKHt9LCBpbnB1dCk7XHJcblxyXG4gICAgY3JlYXRlSW5wdXQucDJwID0gcDJwO1xyXG4gICAgY3JlYXRlSW5wdXQuc3RvcmUgPSBzdG9yZTtcclxuICAgIGNyZWF0ZUlucHV0LnNjaGVtYSA9IHNjaGVtYTtcclxuICAgIGNyZWF0ZUlucHV0LmF1dGhvcmlzZSA9IG9ic2VydmVycztcclxuICAgIGNyZWF0ZUlucHV0LnAycEhhbmRsZXIgPSBfdGhpcy5fcDJwSGFuZGxlcjtcclxuICAgIGNyZWF0ZUlucHV0LnAycFJlcXVlc3RlciA9IF90aGlzLl9wMnBSZXF1ZXN0ZXI7XHJcbiAgICAoaW5pdGlhbERhdGEpID8gY3JlYXRlSW5wdXQuZGF0YSA9IGRlZXBDbG9uZShpbml0aWFsRGF0YSkgOiBjcmVhdGVJbnB1dC5kYXRhID0ge307XHJcbiAgICBjcmVhdGVJbnB1dC5uYW1lID0gbmFtZS5sZW5ndGggPT09IDAgPyAnbm8gbmFtZScgOiBuYW1lO1xyXG4gICAgY3JlYXRlSW5wdXQucmVwb3J0ZXIgPSAoaW5wdXQuaGFzT3duUHJvcGVydHkoJ3JlcG9ydGVyJykgJiYgKCh0eXBlb2YgaW5wdXQucmVwb3J0ZXIpICE9PSAnYm9vbGVhbicpKSA/IGlucHV0LnJlcG9ydGVyIDogX3RoaXMuX293bmVyO1xyXG4gICAgY3JlYXRlSW5wdXQucmVzdW1lID0gZmFsc2U7XHJcbiAgICBpZiAoaW5wdXQpIHtcclxuICAgICAgY3JlYXRlSW5wdXQubXV0dWFsID0gaW5wdXQuaGFzT3duUHJvcGVydHkoJ211dHVhbCcpID8gaW5wdXQubXV0dWFsIDogZmFsc2U7XHJcbiAgICAgIGNyZWF0ZUlucHV0Lm5hbWUgPSBpbnB1dC5oYXNPd25Qcm9wZXJ0eSgnbmFtZScpID8gaW5wdXQubmFtZSA6IGNyZWF0ZUlucHV0Lm5hbWU7XHJcbiAgICB9IGVsc2UgeyBjcmVhdGVJbnB1dC5tdXR1YWwgPSBmYWxzZTsgfVxyXG5cclxuICAgIGlmIChpbnB1dC5oYXNPd25Qcm9wZXJ0eSgncmV1c2VVUkwnKSkge1xyXG4gICAgICBjcmVhdGVJbnB1dC5yZXNvdXJjZSA9IGlucHV0LnJldXNlVVJMO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChpZGVudGl0eSkgICAgICB7IGNyZWF0ZUlucHV0LmlkZW50aXR5ID0gaWRlbnRpdHk7IH1cclxuXHJcbiAgICAvL09iamVjdC5hc3NpZ24oY3JlYXRlSW5wdXQsIHtyZXN1bWU6IGZhbHNlfSk7XHJcbiAgICAvL2RlYnVnZ2VyO1xyXG4vLyAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gY3JlYXRlIFJlcG9ydGVyIC0gY3JlYXRlSW5wdXQ6ICcsIGNyZWF0ZUlucHV0KTtcclxuXHJcbiAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcmVhdGVJbnB1dCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFJlcXVlc3QgYSBEYXRhT2JqZWN0UmVwb3J0ZXIgY3JlYXRpb24uIFRoZSBVUkwgd2lsbCBiZSBiZSByZXF1ZXN0ZWQgYnkgdGhlIGFsbG9jYXRpb24gbWVjaGFuaXNtLlxyXG4gICogQHBhcmFtICB7T2JqZWN0fSBjcml0ZXJpYSAtIChvcHRpb25hbCkgaWRlbnRpdHkgZGF0YSB0byBiZSBhZGRlZCB0byBpZGVudGl0eSB0aGUgdXNlciByZXBvcnRlci4gVG8gYmUgdXNlZCBmb3IgbGVnYWN5IGlkZW50aXRpZXMuXHJcbiAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj5bXX0gUmV0dXJuIGEgcHJvbWlzZSB3aXRoIGEgbGlzdCBvZiBEYXRhT2JqZWN0UmVwb3J0ZXIgdG8gYmUgcmVzdW1lZDtcclxuICAqL1xyXG4gIHJlc3VtZVJlcG9ydGVycyhjcml0ZXJpYSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxvZy5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7XHJcblxyXG4gICAgT2JqZWN0LmFzc2lnbihjcml0ZXJpYSwge3Jlc3VtZTogdHJ1ZX0pO1xyXG5cclxuICAgIHJldHVybiBfdGhpcy5fcmVzdW1lQ3JlYXRlKGNyaXRlcmlhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogUmVxdWVzdCBhIHN1YnNjcmlwdGlvbiB0byBhbiBleGlzdGVudCByZXBvcnRlciBvYmplY3QuXHJcbiAgKiBAcGFyYW0ge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hXHJcbiAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkXHJcbiAgKiBAcGFyYW0ge0Jvb2xlYW59IFtzdG9yZT1mYWxzZV0gLSBTYXZlIHRoZSBzdWJzY3JpcHRpb24gb24gdGhlIFN5bmNoZXIgTWFuYWdlciBmb3IgZnVydGhlciByZXN1bWUgKERlZmF1bHQgaXMgZmFsc2UpXHJcbiAgKiBAcGFyYW0ge0Jvb2xlYW59IFtwMnA9ZmFsc2VdIC0gSW5mbyBhYm91dCBpZiBzaG91bGQgdXNlIHAycCBjb25uZWN0aW9uIChEZWZhdWx0IGlzIGZhbHNlKVxyXG4gICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpXHJcbiAgKiBAcGFyYW0gIHtNZXNzYWdlQm9keUlkZW50aXR5fSBpZGVudGl0eSAtIChvcHRpb25hbCkgaWRlbnRpdHkgZGF0YSB0byBiZSBhZGRlZCB0byBpZGVudGl0eSB0aGUgdXNlciByZXBvcnRlci4gVG8gYmUgdXNlZCBmb3IgbGVnYWN5IGlkZW50aXRpZXMuXHJcbiAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuXHJcbiAgKi9cclxuXHJcbiAgc3Vic2NyaWJlKGlucHV0KSB7XHJcbiAgLyogIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgY3JpdGVyaWEgPSB7fTtcclxuXHJcbiAgICBjcml0ZXJpYS5wMnAgPSBwMnA7XHJcbiAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlO1xyXG4gICAgY3JpdGVyaWEuc2NoZW1hID0gc2NoZW1hO1xyXG4gICAgY3JpdGVyaWEuZG9tYWluX3N1YnNjcmlwdGlvbiA9IGRvbWFpbl9zdWJzY3JpcHRpb247XHJcblxyXG4gICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7XHJcbiAgICBpZiAoaWRlbnRpdHkpICAgICAgeyBjcml0ZXJpYS5pZGVudGl0eSA9IGlkZW50aXR5OyB9XHJcblxyXG4gICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeVxyXG4gICAgY3JpdGVyaWEubXV0dWFsID0gbXV0dWFsO1xyXG5cclxuICAgIGxvZy5sb2coJ1tzeW5jaGVyIC0gc3Vic2NyaWJlXSAtIHN1YnNjcmliZSBjcml0ZXJpYTogJywgY3JpdGVyaWEpO1xyXG5cclxuICAgIE9iamVjdC5hc3NpZ24oY3JpdGVyaWEsIHtyZXN1bWU6IGZhbHNlfSk7Ki9cclxuXHJcbiAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKGlucHV0KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogUmVxdWVzdCBhIHN1YnNjcmlwdGlvbiB0byBhbiBleGlzdGVudCByZXBvcnRlciBvYmplY3QuXHJcbiAgKiBAcGFyYW0ge2NyaXRlcmlhfSBjcml0ZXJpYSAtIEluZm9ybWF0aW9uIHRvIGRpc2NvdmVyeSB0aGUgb2JzZXJ2ZXIgb2JqZWN0XHJcbiAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuXHJcbiAgKi9cclxuICByZXN1bWVPYnNlcnZlcnMoY3JpdGVyaWEpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307XHJcblxyXG4gICAgT2JqZWN0LmFzc2lnbihfY3JpdGVyaWEsIHtyZXN1bWU6IHRydWV9KTtcclxuXHJcbiAgICByZXR1cm4gX3RoaXMuX3Jlc3VtZVN1YnNjcmliZShfY3JpdGVyaWEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBSZXF1ZXN0IGEgcmVhZCBhY3Rpb24gb24gdGhlIHJlcG9ydGVyIG9iamVjdFxyXG4gICogQHBhcmFtIHtPYmplY3RVUkx9IG9ialVSTCAtIFVSTCBvZiB0aGUgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIHJlYWRcclxuICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJuIFByb21pc2UgdG8gbGFzdCBhdmFpbGFibGUgZGF0YSBvZiB0aGUgcmVwb3J0ZXJcclxuICAqL1xyXG4gIHJlYWQob2JqVVJMLCBjcml0ZXJpYSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGNvbnNvbGUubG9nKCdbU3luY2hlci5yZWFkXSAnLCBvYmpVUkwpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgLy8gaW4gY2FzZSB0aGUgb2JqZWN0IGlzIHN5bmNoZWQgaW4gYSByZW1vdGUgc3RvcmFnZSwgbGV0cyBzeW5jIHdpdGggaXRcclxuLyogICAgICBpZiAoX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdICYmIF90aGlzLl9vYnNlcnZlcnNbb2JqVVJMXS5tZXRhZGF0YS5oYXNPd25Qcm9wZXJ0eSgnYmFja3VwJykgJiYgX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdLm1ldGFkYXRhLmJhY2t1cCkge1xyXG5cclxuICAgICAgICBsZXQgcmVhZE1zZyA9IHtcclxuICAgICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCwgXHJcbiAgICAgICAgICBib2R5OiB7IHJlc291cmNlOiBvYmpVUkx9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKGNyaXRlcmlhKSByZWFkTXNnLmJvZHkuY3JpdGVyaWEgPSBjcml0ZXJpYTtcclxuXHJcbiAgICAgICAgICBsZXQgY2FsbGJhY2sgPSAocmVwbHkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9yZWFkQ2FsbEJhY2socmVwbHksIHJlc29sdmUsIHJlamVjdCk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgXHJcbiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlYWRNc2csIGNhbGxiYWNrLCBmYWxzZSk7XHJcbiAgICBcclxuICAgICAgfSBlbHNlIHsqL1xyXG4gICAgICAgIF90aGlzLl9yZWFkUmVwb3J0ZXIob2JqVVJMKS50aGVuKChyZXN1bHQpPT4ge1xyXG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgfSk7XHJcbi8vICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBfcmVhZENhbGxCYWNrKHJlcGx5LCByZXNvbHZlLHJlamVjdCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCdbU3luY2hlci5yZWFkXSByZXBseTogJywgcmVwbHkpO1xyXG5cclxuICAgICAgbGV0IGNoaWxkcmVucyA9IHt9O1xyXG4gICAgICBsZXQgdmFsdWUgPSB7fTtcclxuICAgICAgbGV0IG4gPSAwO1xyXG5cclxuICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA8IDMwMCkge1xyXG4gICAgICAgIGlmICghcmVwbHkuYm9keS52YWx1ZS5oYXNPd25Qcm9wZXJ0eSgncmVzcG9uc2VzJykpIHtcclxuICAgICAgICAgIF90aGlzLl9idXMucmVtb3ZlUmVzcG9uc2VMaXN0ZW5lcihyZXBseS5mcm9tLCByZXBseS5pZCk7XHJcbiAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSB7IC8vZGF0YSBvYmplY3QgaXMgc2VudCBpbiBzZXBhcmF0ZWQgbWVzc2FnZXNcclxuICAgICAgICAgIGlmIChuID09PSAwKSB7IC8vaW5pdGlhbCByZXNwb25zZSB3aXRob3V0IGNoaWxkcmVuc1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHJlcGx5LmJvZHkudmFsdWU7XHJcbiAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgIH0gZWxzZSB7IC8vIHJlY2VpdmVkIHJlc3BvbnNlIGNvbnRhaW5zIGNoaWxkcmVuc1xyXG4gICAgICAgICAgICBkZWxldGUgcmVwbHkuYm9keS52YWx1ZS5yZXNwb25zZXM7XHJcbiAgICAgICAgICAgIGxldCBjaGlsZHJlbjtcclxuICAgICAgICAgICAgZm9yIChjaGlsZHJlbiBpbiByZXBseS5ib2R5LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCFjaGlsZHJlbnMuaGFzT3duUHJvcGVydHkoY2hpbGRyZW4pKSBjaGlsZHJlbnNbY2hpbGRyZW5dID0ge307XHJcbiAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjaGlsZHJlbnNbY2hpbGRyZW5dLCByZXBseS5ib2R5LnZhbHVlW2NoaWxkcmVuXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICBpZiAobiA9PT0gdmFsdWUucmVzcG9uc2VzKSB7XHJcbiAgICAgICAgICAgICAgdmFsdWUuY2hpbGRyZW5PYmplY3RzID0gY2hpbGRyZW5zO1xyXG4gICAgICAgICAgICAgIGRlbGV0ZSB2YWx1ZS5yZXNwb25zZXM7XHJcbiAgICAgICAgICAgICAgX3RoaXMuX2J1cy5yZW1vdmVSZXNwb25zZUxpc3RlbmVyKHJlcGx5LmZyb20sIHJlcGx5LmlkKTtcclxuICAgICAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpO1xyXG4gICAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgX3JlYWRSZXBvcnRlcihvYmpVUkwpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byByZXBvcnRlciBvYmplY3QgKG1heWJlIHRoZXJlIGlzIG5vIGxpc3RlbmVyIGF2YWlsYWJsZSwgc28gaXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIE1lc3NhZ2VCdXMgLT4gcmVzb2x2ZSlcclxuICAgIC8vd2lsbCByZWFjaCB0aGUgcmVtb3RlIG9iamVjdCBpbiBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gX29uUmVhZFxyXG4gICAgbGV0IHJlYWRNc2cgPSB7XHJcbiAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogb2JqVVJMXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlYWRNc2csIChyZXBseSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBfdGhpcy5fcmVhZENhbGxCYWNrKHJlcGx5LCByZXNvbHZlLCByZWplY3QpO1xyXG4gICAgICB9LCBmYWxzZSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy5cclxuICAqIFRoaXMgaXMgcmVsZWF0ZWQgdG8gdGhlIG1lc3NhZ2VucyBzZW50IGJ5IGNyZWF0ZSB0byB0aGUgb2JzZXJ2ZXJzIEh5cGVydHkgYXJyYXkuXHJcbiAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrXHJcbiAgKi9cclxuICBvbk5vdGlmaWNhdGlvbihjYWxsYmFjaykge1xyXG4gICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNsb3NlIGV2ZW50cyBmcm9tIHRoZSBydW50aW1lLlxyXG4gICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFja1xyXG4gICovXHJcbiAgb25DbG9zZShjYWxsYmFjaykge1xyXG4gICAgdGhpcy5fb25DbG9zZSA9IGNhbGxiYWNrO1xyXG4gIH1cclxuXHJcbiAgX2NyZWF0ZShpbnB1dCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IHJlcG9ydGVySW5wdXQgID0gT2JqZWN0LmFzc2lnbih7fSwgaW5wdXQpO1xyXG5cclxuICAgICAgbGV0IHJlc3VtZSA9IGlucHV0LnJlc3VtZTtcclxuXHJcbiAgICAgIHJlcG9ydGVySW5wdXQuY3JlYXRlZCA9IChuZXcgRGF0ZSkudG9JU09TdHJpbmcoKTtcclxuICAgICAgcmVwb3J0ZXJJbnB1dC5ydW50aW1lID0gX3RoaXMuX3J1bnRpbWVVcmw7XHJcblxyXG4gICAgICBsZXQgcmVxdWVzdFZhbHVlID0gZGVlcENsb25lKHJlcG9ydGVySW5wdXQpO1xyXG5cclxuICAgICAgZGVsZXRlIHJlcXVlc3RWYWx1ZS5wMnA7XHJcbiAgICAgIGRlbGV0ZSByZXF1ZXN0VmFsdWUuc3RvcmU7XHJcbiAgICAgIGRlbGV0ZSByZXF1ZXN0VmFsdWUub2JzZXJ2ZXJzO1xyXG4gICAgICBkZWxldGUgcmVxdWVzdFZhbHVlLmlkZW50aXR5O1xyXG5cclxuICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGVcclxuICAgICAgLy9kZWJ1Z2dlcjtcclxuICAgICAgbGV0IHJlcXVlc3RNc2cgPSB7XHJcbiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsXHJcbiAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSwgdmFsdWU6IHJlcXVlc3RWYWx1ZSAgfVxyXG4gICAgICB9O1xyXG5cclxuXHJcbiAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSByZXBvcnRlcklucHV0LnNjaGVtYTtcclxuXHJcbiAgICAgIGlmIChyZXBvcnRlcklucHV0LnAycCkgcmVxdWVzdE1zZy5ib2R5LnAycCA9IHJlcG9ydGVySW5wdXQucDJwO1xyXG4gICAgICBpZiAocmVwb3J0ZXJJbnB1dC5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gcmVwb3J0ZXJJbnB1dC5zdG9yZTtcclxuICAgICAgaWYgKHJlcG9ydGVySW5wdXQuaWRlbnRpdHkpIHJlcXVlc3RNc2cuYm9keS5pZGVudGl0eSA9IHJlcG9ydGVySW5wdXQuaWRlbnRpdHk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIuX2NyZWF0ZV06ICcsIHJlcG9ydGVySW5wdXQsIHJlcXVlc3RNc2cpO1xyXG5cclxuICAgICAgLy9yZXF1ZXN0IGNyZWF0ZSB0byB0aGUgYWxsb2NhdGlvbiBzeXN0ZW0uIENhbiBiZSByZWplY3RlZCBieSB0aGUgUG9saWN5RW5naW5lLlxyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIChyZXBseSkgPT4ge1xyXG4gICAgICAgIGxvZy5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpO1xyXG4gICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkge1xyXG4gICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiBhY2NlcHRlZFxyXG4gICAgICAgICAgcmVwb3J0ZXJJbnB1dC51cmwgPSByZXBseS5ib2R5LnJlc291cmNlO1xyXG5cclxuLyogICAgICAgICAgaWYgKHJlcGx5LmJvZHkucDJwSGFuZGxlcikgcmVwb3J0ZXJJbnB1dC5wMnBIYW5kbGVyID0gcmVwbHkuYm9keS5wMnBIYW5kbGVyO1xyXG4gICAgICAgICAgaWYgKHJlcGx5LmJvZHkucDJwUmVxdWVzdGVyKSByZXBvcnRlcklucHV0LnAycFJlcXVlc3RlciA9IHJlcGx5LmJvZHkucDJwUmVxdWVzdGVyOyovXHJcblxyXG4gICAgICAgICAgcmVwb3J0ZXJJbnB1dC5zdGF0dXMgPSAnbGl2ZSc7Ly8gcGNoOiBkbyB3ZSBuZWQgdGhpcz9cclxuICAgICAgICAgIHJlcG9ydGVySW5wdXQuc3luY2hlciA9IF90aGlzO1xyXG4gICAgICAgICAgcmVwb3J0ZXJJbnB1dC5jaGlsZHJlbnMgPSByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzO1xyXG5cclxuICAgICAgICAgIGxldCBuZXdPYmogPSBfdGhpcy5fcmVwb3J0ZXJzW3JlcG9ydGVySW5wdXQudXJsXTtcclxuXHJcbiAgICAgICAgICBpZiAoIW5ld09iaikge1xyXG4gICAgICAgICAgICBuZXdPYmogPSBuZXcgRGF0YU9iamVjdFJlcG9ydGVyKHJlcG9ydGVySW5wdXQpO1xyXG4gICAgICAgICAgICBfdGhpcy5fcmVwb3J0ZXJzW3JlcG9ydGVySW5wdXQudXJsXSA9IG5ld09iajtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBuZXdPYmouaW52aXRlT2JzZXJ2ZXJzKGlucHV0LmF1dGhvcmlzZSwgaW5wdXQucDJwKTtcclxuXHJcbiAgICAgICAgICByZXNvbHZlKG5ld09iaik7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvL3JlcG9ydGVyIGNyZWF0aW9uIHJlamVjdGVkXHJcbiAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgX3Jlc3VtZUNyZWF0ZShjcml0ZXJpYSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBsZXQgcmVzdW1lID0gY3JpdGVyaWEucmVzdW1lO1xyXG5cclxuICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGVcclxuICAgICAgbGV0IHJlcXVlc3RNc2cgPSB7XHJcbiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsXHJcbiAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBsb2cubG9nKCdbc3luY2hlciAtIGNyZWF0ZV06ICcsIGNyaXRlcmlhLCByZXF1ZXN0TXNnKTtcclxuICAgICAgaWYgKGNyaXRlcmlhKSB7XHJcbiAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnZhbHVlID0gY3JpdGVyaWE7XHJcbiAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXBvcnRlcicpKSB7XHJcbiAgICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBjcml0ZXJpYS5yZXBvcnRlcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnZhbHVlLnJlcG9ydGVyID0gX3RoaXMuX293bmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGNyaXRlcmlhLnAycCkgcmVxdWVzdE1zZy5ib2R5LnAycCA9IGNyaXRlcmlhLnAycDtcclxuICAgICAgaWYgKGNyaXRlcmlhLnN0b3JlKSByZXF1ZXN0TXNnLmJvZHkuc3RvcmUgPSBjcml0ZXJpYS5zdG9yZTtcclxuICAgICAgaWYgKGNyaXRlcmlhLm9ic2VydmVycykgcmVxdWVzdE1zZy5ib2R5LmF1dGhvcmlzZSA9IGNyaXRlcmlhLm9ic2VydmVycztcclxuICAgICAgaWYgKGNyaXRlcmlhLmlkZW50aXR5KSByZXF1ZXN0TXNnLmJvZHkuaWRlbnRpdHkgPSBjcml0ZXJpYS5pZGVudGl0eTtcclxuXHJcbiAgICAgIGxvZy5sb2coJ1tzeW5jaGVyLl9yZXN1bWVDcmVhdGVdIC0gcmVzdW1lIG1lc3NhZ2U6ICcsIHJlcXVlc3RNc2cpO1xyXG5cclxuICAgICAgLy9kZWJ1Z2dlcjtcclxuXHJcbiAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS5cclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVxdWVzdE1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmxvZygnW3N5bmNoZXIuX3Jlc3VtZUNyZWF0ZV0gLSBjcmVhdGUtcmVzdW1lZC1yZXNwb25zZTogJywgcmVwbHkpO1xyXG4gICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkge1xyXG4gICAgICAgICAgLy9kZWJ1Z2dlcjtcclxuICAgICAgICAgIGxldCBsaXN0T2ZSZXBvcnRlcnMgPSByZXBseS5ib2R5LnZhbHVlO1xyXG5cclxuICAgICAgICAgIGZvciAobGV0IGluZGV4IGluIGxpc3RPZlJlcG9ydGVycykge1xyXG5cclxuICAgICAgICAgICAgbGV0IGRhdGFPYmplY3QgPSBsaXN0T2ZSZXBvcnRlcnNbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiBhY2NlcHRlZFxyXG5cclxuICAgICAgICAgICAgZGF0YU9iamVjdC5kYXRhID0gZGVlcENsb25lKGRhdGFPYmplY3QuZGF0YSkgfHwge307XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YU9iamVjdC5jaGlsZHJlbk9iamVjdHMpIHsgZGF0YU9iamVjdC5jaGlsZHJlbk9iamVjdHMgPSBkZWVwQ2xvbmUoZGF0YU9iamVjdC5jaGlsZHJlbk9iamVjdHMpOyB9XHJcblxyXG4gICAgICAgICAgICBkYXRhT2JqZWN0Lm11dHVhbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBkYXRhT2JqZWN0LnJlc3VtZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGRhdGFPYmplY3Quc3RhdHVzID0gJ2xpdmUnOy8vIHBjaDogZG8gd2UgbmVkIHRoaXM/XHJcbiAgICAgICAgICAgIGRhdGFPYmplY3Quc3luY2hlciA9IF90aGlzO1xyXG5cclxuICAgICAgICAgICAgbG9nLmxvZygnW3N5bmNoZXIuX3Jlc3VtZUNyZWF0ZV0gLSBjcmVhdGUtcmVzdW1lZC1kYXRhT2JqZWN0UmVwb3J0ZXInLCBkYXRhT2JqZWN0KTtcclxuXHJcbiAgICAgICAgICAgIGxldCBuZXdPYmogPSBuZXcgRGF0YU9iamVjdFJlcG9ydGVyKGRhdGFPYmplY3QpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGFPYmplY3QuY2hpbGRyZW5PYmplY3RzKSB7XHJcbiAgICAgICAgICAgICAgbmV3T2JqLnJlc3VtZUNoaWxkcmVucyhkYXRhT2JqZWN0LmNoaWxkcmVuT2JqZWN0cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuX3JlcG9ydGVyc1tkYXRhT2JqZWN0LnVybF0gPSBuZXdPYmo7XHJcblxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJlc29sdmUoX3RoaXMuX3JlcG9ydGVycyk7XHJcbiAgICAgICAgICBpZiAodGhpcy5fb25SZXBvcnRlcnNSZXN1bWUpIHRoaXMuX29uUmVwb3J0ZXJzUmVzdW1lKHRoaXMuX3JlcG9ydGVycyk7XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAocmVwbHkuYm9keS5jb2RlID09PSA0MDQpIHtcclxuICAgICAgICAgIHJlc29sdmUoe30pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvL3JlcG9ydGVyIGNyZWF0aW9uIHJlamVjdGVkXHJcbiAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc3Vic2NyaWJlKGlucHV0KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlXHJcbiAgICAgIGxldCBzdWJzY3JpYmVNc2cgPSB7XHJcbiAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsXHJcbiAgICAgICAgYm9keTogaW5wdXRcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIEh5cGVydHkgcmVxdWVzdCB0byBiZSBhbiBPYnNlcnZlclxyXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXJcclxuXHJcbiAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciB0aGUgc2FtZSBIeXBlcnR5IFVSTFxyXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNyZXN1bWUtc3Vic2NyaXB0aW9ucy1mb3ItdGhlLXNhbWUtaHlwZXJ0eS11cmxcclxuXHJcbiAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuXHJcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI3Jlc3VtZS1zdWJzY3JpcHRpb25zLWZvci1hLWNlcnRhaW4tdXNlci1hbmQtZGF0YS1zY2hlbWEtaW5kZXBlbmRlbnRseS1vZi10aGUtaHlwZXJ0eS11cmxcclxuLyogICAgICBpZiAoaW5wdXQpIHtcclxuICAgICAgICBpZiAoaW5wdXQuaGFzT3duUHJvcGVydHkoJ3AycCcpKSBzdWJzY3JpYmVNc2cuYm9keS5wMnAgPSBpbnB1dC5wMnA7XHJcbiAgICAgICAgaWYgKGlucHV0Lmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGlucHV0LnN0b3JlO1xyXG4gICAgICAgIGlmIChpbnB1dC5oYXNPd25Qcm9wZXJ0eSgnc2NoZW1hJykpIHN1YnNjcmliZU1zZy5ib2R5LnNjaGVtYSA9IGlucHV0LnNjaGVtYTtcclxuICAgICAgICBpZiAoaW5wdXQuaGFzT3duUHJvcGVydHkoJ2lkZW50aXR5JykpIHN1YnNjcmliZU1zZy5ib2R5LmlkZW50aXR5ID0gaW5wdXQuaWRlbnRpdHk7XHJcbiAgICAgICAgaWYgKGlucHV0Lmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGlucHV0LnJlc291cmNlO1xyXG4gICAgICAgIGlmIChpbnB1dC5oYXNPd25Qcm9wZXJ0eSgnZG9tYWluX3N1YnNjcmlwdGlvbicpKSBzdWJzY3JpYmVNc2cuYm9keS5kb21haW5fc3Vic2NyaXB0aW9uID0gaW5wdXQuZG9tYWluX3N1YnNjcmlwdGlvbjtcclxuICAgICAgfVxyXG4gICAgICBcclxuXHJcbiAgICAgIHN1YnNjcmliZU1zZy5ib2R5LnJlc3VtZSA9IGlucHV0LnJlc3VtZTtcclxuXHJcbiAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHlcclxuICAgICAgaWYgKGlucHV0Lmhhc093blByb3BlcnR5KCdtdXR1YWwnKSkgc3Vic2NyaWJlTXNnLmJvZHkubXV0dWFsID0gaW5wdXQubXV0dWFsOyovXHJcblxyXG4gICAgICBsb2cubG9nKCdbc3luY2hlcl9zdWJzY3JpYmVdIC0gc3Vic2NyaWJlIG1lc3NhZ2U6ICcsIGlucHV0LCBzdWJzY3JpYmVNc2cpO1xyXG5cclxuICAgICAgLy9yZXF1ZXN0IHN1YnNjcmlwdGlvblxyXG4gICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi5cclxuICAgICAgLy9mb3IgbW9yZSBpbmZvIHNlZSB0aGUgRGF0YVByb3Zpc2lvbmFsIGNsYXNzIGRvY3VtZW50YXRpb24uXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoc3Vic2NyaWJlTXNnLCAocmVwbHkpID0+IHtcclxuICAgICAgICBsb2cubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUtcmVzcG9uc2U6ICcsIHJlcGx5KTtcclxuXHJcbiAgICAgICAgbGV0IG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7XHJcblxyXG4gICAgICAgIGxldCBuZXdQcm92aXNpb25hbCA9IF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTtcclxuICAgICAgICBkZWxldGUgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdO1xyXG4gICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA8IDIwMCkge1xyXG4gICAgICAgICAgbG9nLmxvZygnW3N5bmNoZXJdIC0gbmV3IERhdGFQcm92aXNpb25hbDogJywgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcywgb2JqVVJMKTtcclxuICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsID0gbmV3IERhdGFQcm92aXNpb25hbChfdGhpcy5fb3duZXIsIG9ialVSTCwgX3RoaXMuX2J1cywgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7XHJcbiAgICAgICAgICBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF0gPSBuZXdQcm92aXNpb25hbDtcclxuICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICBsb2cubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTtcclxuXHJcbiAgICAgICAgICBsZXQgb2JzZXJ2ZXJJbnB1dCA9IHJlcGx5LmJvZHkudmFsdWU7XHJcblxyXG4gICAgICAgICAgb2JzZXJ2ZXJJbnB1dC5zeW5jaGVyID0gX3RoaXM7XHJcbiAgICAgICAgICBvYnNlcnZlcklucHV0LnAycCA9IGlucHV0LnAycDtcclxuICAgICAgICAgIG9ic2VydmVySW5wdXQuc3RvcmUgPSBpbnB1dC5zdG9yZTtcclxuICAgICAgICAgIG9ic2VydmVySW5wdXQuaWRlbnRpdHkgPSBpbnB1dC5pZGVudGl0eTtcclxuICAgICAgICAgIG9ic2VydmVySW5wdXQucmVzdW1lID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgLy8gdG9kbzogRm9yIEZ1cnRoZXIgU3R1ZHlcclxuICAgICAgICAgIG9ic2VydmVySW5wdXQubXV0dWFsID0gaW5wdXQubXV0dWFsO1xyXG5cclxuICAgICAgICAgIC8vb2JzZXJ2ZXJJbnB1dC5jaGlsZHJlbiA9IG5ld1Byb3Zpc2lvbmFsLmNoaWxkcmVuO1xyXG5cclxuICAgICAgICAgIC8vVE9ETzogbXV0dWFsIEZvciBGdXJ0aGVyIFN0dWR5XHJcbiAgICAgICAgICBsZXQgbmV3T2JqID0gX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdO1xyXG4gICAgICAgICAgaWYgKCFuZXdPYmopIHtcclxuICAgICAgICAgICAgbmV3T2JqID0gbmV3IERhdGFPYmplY3RPYnNlcnZlcihvYnNlcnZlcklucHV0KTtcclxuICAgICAgICAgICAgX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdID0gbmV3T2JqO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbmV3T2JqLnN5bmMoKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBsb2cubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXIgYWxyZWFkeSBleGlzdDogJywgbmV3T2JqKTtcclxuXHJcbiAgICAgICAgICByZXNvbHZlKG5ld09iaik7XHJcblxyXG4gICAgICAgICAgaWYgKG5ld1Byb3Zpc2lvbmFsKSB7IG5ld1Byb3Zpc2lvbmFsLmFwcGx5KG5ld09iaik7IH1cclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbi8qXHJcbiAgX3Byb2Nlc3NPZmZsaW5lU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbiwgcmVkaXJlY3RUbykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgZm9yd2FyZCA9IHtcclxuICAgICAgZnJvbTogc3Vic2NyaXB0aW9uLmZyb20sXHJcbiAgICAgIHR5cGU6ICdmb3J3YXJkJyxcclxuICAgICAgdG86IHJlZGlyZWN0VG8sXHJcbiAgICAgIGJvZHk6IHN1YnNjcmlwdGlvblxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnW1N5bmNoZXIuX3Byb2Nlc3NPZmZsaW5lU3Vic2NyaXB0aW9uXSBmb3J3YWRpbmcgJywgZm9yd2FyZCk7XHJcblxyXG4gICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShmb3J3YXJkKTtcclxuXHJcbiAgICBsZXQgcmVzdWx0ID0ge1xyXG4gICAgICBjb2RlOiAzMDIsXHJcbiAgICAgIGRlc2M6IFwiRm91bmQgXCIgKyByZWRpcmVjdFRvXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybihyZXN1bHQpO1xyXG5cclxuICB9Ki9cclxuXHJcblxyXG4gIF9yZXN1bWVTdWJzY3JpYmUoY3JpdGVyaWEpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uTG9jYWxTdWJzY3JpYmVcclxuICAgICAgbGV0IHN1YnNjcmliZU1zZyA9IHtcclxuICAgICAgICB0eXBlOiAnc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCxcclxuICAgICAgICBib2R5OiB7fVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gSHlwZXJ0eSByZXF1ZXN0IHRvIGJlIGFuIE9ic2VydmVyXHJcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI2h5cGVydHktcmVxdWVzdC10by1iZS1hbi1vYnNlcnZlclxyXG5cclxuICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMXHJcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI3Jlc3VtZS1zdWJzY3JpcHRpb25zLWZvci10aGUtc2FtZS1oeXBlcnR5LXVybFxyXG5cclxuICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIGEgY2VydGFpbiB1c2VyIGFuZCBkYXRhIHNjaGVtYSBpbmRlcGVuZGVudGx5IG9mIHRoZSBIeXBlcnR5IFVSTC5cclxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybFxyXG4gICAgICBpZiAoY3JpdGVyaWEpIHtcclxuICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3AycCcpKSBzdWJzY3JpYmVNc2cuYm9keS5wMnAgPSBjcml0ZXJpYS5wMnA7XHJcbiAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlO1xyXG4gICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnc2NoZW1hJykpIHN1YnNjcmliZU1zZy5ib2R5LnNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTtcclxuICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ2lkZW50aXR5JykpIHN1YnNjcmliZU1zZy5ib2R5LmlkZW50aXR5ID0gY3JpdGVyaWEuaWRlbnRpdHk7XHJcbiAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBzdWJzY3JpYmVNc2cuYm9keS5yZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7XHJcblxyXG4gICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5XHJcbiAgICAgIGxldCBtdXR1YWwgPSBjcml0ZXJpYS5tdXR1YWw7XHJcbiAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykpIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbCA9IG11dHVhbDtcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7XHJcblxyXG4gICAgICAvL3JlcXVlc3Qgc3Vic2NyaXB0aW9uXHJcbiAgICAgIC8vUHJvdmlzaW9uYWwgZGF0YSBpcyBhcHBsaWVkIHRvIHRoZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgYWZ0ZXIgY29uZmlybWF0aW9uLiBPciBkaXNjYXJkZWQgaWYgdGhlcmUgaXMgbm8gY29uZmlybWF0aW9uLlxyXG4gICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi5cclxuICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShzdWJzY3JpYmVNc2csIChyZXBseSkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUtcmVzdW1lZC1yZXNwb25zZTogJywgcmVwbHkpO1xyXG5cclxuICAgICAgICBsZXQgb2JqVVJMID0gcmVwbHkuYm9keS5yZXNvdXJjZTtcclxuXHJcbiAgICAgICAgbGV0IG5ld1Byb3Zpc2lvbmFsID0gX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdO1xyXG4gICAgICAgIGRlbGV0ZSBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF07XHJcbiAgICAgICAgaWYgKG5ld1Byb3Zpc2lvbmFsKSBuZXdQcm92aXNpb25hbC5fcmVsZWFzZUxpc3RlbmVycygpO1xyXG5cclxuICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMjAwKSB7IC8vIHRvZG86IGNoZWNrIGlmIHRoaXMgaXMgbmVlZGVkIGZvciB0aGUgcmVzdW1lXHJcblxyXG4gICAgICAgICAgbG9nLmxvZygnW3N5bmNoZXJdIC0gcmVzdW1lIG5ldyBEYXRhUHJvdmlzaW9uYWw6ICcsIHJlcGx5LCBvYmpVUkwpO1xyXG4gICAgICAgICAgbmV3UHJvdmlzaW9uYWwgPSBuZXcgRGF0YVByb3Zpc2lvbmFsKF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTtcclxuICAgICAgICAgIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXSA9IG5ld1Byb3Zpc2lvbmFsO1xyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcblxyXG4gICAgICAgICAgbGV0IGxpc3RPZk9ic2VydmVycyA9IHJlcGx5LmJvZHkudmFsdWU7XHJcblxyXG4gICAgICAgICAgZm9yIChsZXQgaW5kZXggaW4gbGlzdE9mT2JzZXJ2ZXJzKSB7XHJcblxyXG4gICAgICAgICAgICBsZXQgZGF0YU9iamVjdCA9IGxpc3RPZk9ic2VydmVyc1tpbmRleF07XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBSZXN1bWUgT2JqZWN0IE9ic2VydmVyOiAnLCByZXBseSwgZGF0YU9iamVjdCwgX3RoaXMuX3Byb3Zpc2lvbmFscyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YU9iamVjdC5jaGlsZHJlbk9iamVjdHMpIHsgZGF0YU9iamVjdC5jaGlsZHJlbk9iamVjdHMgPSBkZWVwQ2xvbmUoZGF0YU9iamVjdC5jaGlsZHJlbk9iamVjdHMpOyB9XHJcblxyXG4gICAgICAgICAgICBkYXRhT2JqZWN0LmRhdGEgPSBkZWVwQ2xvbmUoZGF0YU9iamVjdC5kYXRhKSB8fCB7fTtcclxuICAgICAgICAgICAgZGF0YU9iamVjdC5yZXN1bWUgPSB0cnVlO1xyXG4gICAgICAgICAgICBkYXRhT2JqZWN0LnN5bmNoZXIgPSBfdGhpcztcclxuXHJcbiAgICAgICAgICAgIC8vVE9ETzogbXV0dWFsIEZvciBGdXJ0aGVyIFN0dWR5XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlci5fcmVzdW1lU3Vic2NyaWJlXSAtIGNyZWF0ZSBuZXcgZGF0YU9iamVjdDogJywgZGF0YU9iamVjdCk7XHJcbiAgICAgICAgICAgIGxldCBuZXdPYmogPSBuZXcgRGF0YU9iamVjdE9ic2VydmVyKGRhdGFPYmplY3QpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGFPYmplY3QuY2hpbGRyZW5PYmplY3RzKSB7IG5ld09iai5yZXN1bWVDaGlsZHJlbnMoZGF0YU9iamVjdC5jaGlsZHJlbk9iamVjdHMpOyB9XHJcbiAgICAgICAgICAgIGxvZy5sb2coJ1tzeW5jaGVyLl9yZXN1bWVTdWJzY3JpYmVdIC0gbmV3IGRhdGFPYmplY3QnLCBuZXdPYmopO1xyXG4gICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW25ld09iai51cmxdID0gbmV3T2JqO1xyXG5cclxuICAgICAgICAgICAgaWYgKF90aGlzLl9wcm92aXNpb25hbHNbbmV3T2JqLnVybF0pIHtcclxuICAgICAgICAgICAgICBfdGhpcy5fcHJvdmlzaW9uYWxzW25ld09iai51cmxdLmFwcGx5KG5ld09iaik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vbGV0cyBzeW5jIHdpdGggUmVwb3J0ZXJcclxuICAgICAgICAgICAgLy8gaXQgd2FzIGNvbW1lbnRlZCB0byBsZXQgaHlwZXJ0aWVzIGRlY2lkZSB3aGVuIHRvIHN5bmNcclxuICAgICAgICAgICAgLy9uZXdPYmouc3luYygpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJlc29sdmUoX3RoaXMuX29ic2VydmVycyk7XHJcblxyXG4gICAgICAgICAgaWYgKHRoaXMuX29uT2JzZXJ2ZXJzUmVzdW1lKSB0aGlzLl9vbk9ic2VydmVyc1Jlc3VtZShfdGhpcy5fb2JzZXJ2ZXJzKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDQwNCkge1xyXG4gICAgICAgICAgcmVzb2x2ZSh7fSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIGxvY2FsIHJ1bnRpbWUgUmVwb3J0ZXJPYmplY3QgLT4gX29uUmVtb3RlU3Vic2NyaWJlXHJcbiAgX29uRm9yd2FyZChtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IHJlcG9ydGVyID0gX3RoaXMuX3JlcG9ydGVyc1ttc2cuYm9keS50b107XHJcbiAgICByZXBvcnRlci5fb25Gb3J3YXJkKG1zZyk7XHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBTeW5jaGVyIC0+IGNyZWF0ZSAodGhpcyBpcyBhY3R1YWxseSBhbiBpbnZpdGF0aW9uIHRvIHN1YnNjcmliZSlcclxuICBfb25SZW1vdGVDcmVhdGUobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IHJlc291cmNlID0gbXNnLmZyb20uc2xpY2UoMCwgLTEzKTsgLy9yZW1vdmUgXCIvc3Vic2NyaXB0aW9uXCIgZnJvbSB0aGUgVVJMXHJcbiAgICBsZXQgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChyZXNvdXJjZSk7XHJcbiAgICBsZXQgZG9tYWluID0gZGl2aWRlZFVSTC5kb21haW47XHJcblxyXG4gICAgbGV0IGV2ZW50ID0ge1xyXG4gICAgICB0eXBlOiBtc2cudHlwZSxcclxuICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLFxyXG4gICAgICB1cmw6IHJlc291cmNlLFxyXG4gICAgICBkb21haW46IGRvbWFpbixcclxuICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsXHJcbiAgICAgIHZhbHVlOiBtc2cuYm9keS52YWx1ZSxcclxuICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LFxyXG5cclxuICAgICAgYWNrOiAodHlwZSkgPT4ge1xyXG4gICAgICAgIGxldCBsVHlwZSA9IDIwMDtcclxuICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgbFR5cGUgPSB0eXBlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2VcclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYgKF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIpIHtcclxuICAgICAgbG9nLmluZm8oJ1tTeW5jaGVyXSBOT1RJRklDQVRJT04tRVZFTlQ6ICcsIGV2ZW50KTtcclxuICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlXHJcbiAgX29uUmVtb3RlRGVsZXRlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgIC8vcmVtb3ZlIFwiL3N1YnNjcmlwdGlvblwiIGZyb20gdGhlIFVSTFxyXG4gICAgbGV0IHJlc291cmNlID0gbXNnLmJvZHkucmVzb3VyY2U7XHJcblxyXG4gICAgbGV0IG9iamVjdCA9IF90aGlzLl9vYnNlcnZlcnNbcmVzb3VyY2VdO1xyXG5cclxuICAgIGxldCB1bnN1YnNjcmliZSA9IHtcclxuICAgICAgZnJvbTogX3RoaXMub3duZXIsXHJcbiAgICAgIHRvOiBfdGhpcy5fc3ViVVJMLFxyXG4gICAgICBpZDogbXNnLmlkLFxyXG4gICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLFxyXG4gICAgICBib2R5OiB7IHJlc291cmNlOiBtc2cuYm9keS5yZXNvdXJjZSB9XHJcbiAgICB9O1xyXG5cclxuICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UodW5zdWJzY3JpYmUpO1xyXG5cclxuICAgIGRlbGV0ZSBfdGhpcy5fb2JzZXJ2ZXJzW3Jlc291cmNlXTtcclxuXHJcbiAgICBpZiAob2JqZWN0KSB7XHJcbiAgICAgIGxldCBldmVudCA9IHtcclxuICAgICAgICB0eXBlOiBtc2cudHlwZSxcclxuICAgICAgICB1cmw6IHJlc291cmNlLFxyXG4gICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSxcclxuXHJcbiAgICAgICAgYWNrOiAodHlwZSkgPT4ge1xyXG4gICAgICAgICAgbGV0IGxUeXBlID0gMjAwO1xyXG4gICAgICAgICAgaWYgKHR5cGUpIHtcclxuICAgICAgICAgICAgbFR5cGUgPSB0eXBlO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgLy9UT0RPOiBhbnkgb3RoZXIgZGlmZmVyZW50IG9wdGlvbnMgZm9yIHRoZSByZWxlYXNlIHByb2Nlc3MsIGxpa2UgYWNjZXB0IGJ1dCBub3IgcmVsZWFzZSBsb2NhbD9cclxuICAgICAgICAgIGlmIChsVHlwZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgIG9iamVjdC5kZWxldGUoKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2VcclxuICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSwgc291cmNlOiBfdGhpcy5fb3duZXIgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWYgKF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIpIHtcclxuICAgICAgICBsb2cubG9nKCdOT1RJRklDQVRJT04tRVZFTlQ6ICcsIGV2ZW50KTtcclxuICAgICAgICBfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKGV2ZW50KTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sXHJcbiAgICAgICAgYm9keTogeyBjb2RlOiA0MDQsIHNvdXJjZTogX3RoaXMuX293bmVyIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBjbG9zZSBldmVudCByZWNlaXZlZCBmcm9tIHJ1bnRpbWUgcmVnaXN0cnlcclxuICBfb25FeGVjdXRlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgcmVwbHkgPSB7XHJcbiAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICBib2R5OiB7IGNvZGU6IDIwMCB9XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICgobXNnLmZyb20gPT09IF90aGlzLl9ydW50aW1lVXJsICsgJy9yZWdpc3RyeS8nIHx8IG1zZy5mcm9tID09PSBfdGhpcy5fcnVudGltZVVybCArICcvcmVnaXN0cnknKSAmJiBtc2cuYm9keSAmJiBtc2cuYm9keS5tZXRob2QgJiYgbXNnLmJvZHkubWV0aG9kID09PSAnY2xvc2UnICYmIF90aGlzLl9vbkNsb3NlKSB7XHJcbiAgICAgIGxldCBldmVudCA9IHtcclxuICAgICAgICB0eXBlOiAnY2xvc2UnLFxyXG5cclxuICAgICAgICBhY2s6ICh0eXBlKSA9PiB7XHJcbiAgICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICByZXBseS5ib2R5LmNvZGUgPSB0eXBlO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgLy9zZW5kIGFjayByZXNwb25zZSBtZXNzYWdlXHJcbiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcGx5KTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBsb2cuaW5mbygnW1N5bmNoZXJdIENsb3NlLUVWRU5UOiAnLCBldmVudCk7XHJcbiAgICAgIF90aGlzLl9vbkNsb3NlKGV2ZW50KTtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcGx5KTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIENhbGxiYWNrIHN5c3RlbSB0byB0cmlnZ2VyIHRoZSByZXN1bWVkIHJlcG9ydGVyc1xyXG4gICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIC0gZnVuY3Rpb24gY2FsbGJhY2sgd2hpY2ggd2lsbCBiZSBpbnZva2VkXHJcbiAgKiBAcmV0dXJuIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0UmVwb3J0ZXI+fSBSZXR1cm4gb25lIG9iamVjdCB3aXRoIGFsbCByZXN1bWVkIHJlcG9ydGVycztcclxuICAqL1xyXG4gIG9uUmVwb3J0ZXJzUmVzdW1lKGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9vblJlcG9ydGVyc1Jlc3VtZSA9IGNhbGxiYWNrO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBDYWxsYmFjayBzeXN0ZW0gdG8gdHJpZ2dlciB0aGUgcmVzdW1lZCBvYnNlcnZlcnNcclxuICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYWxsYmFjayAtIGZ1bmN0aW9uIGNhbGxiYWNrIHdoaWNoIHdpbGwgYmUgaW52b2tlZFxyXG4gICogQHJldHVybiB7T2JqZWN0PFVSTCwgRGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIG9uZSBvYmplY3Qgd2l0aCBhbGwgcmVzdW1lZCBvYnNlcnZlcnM7XHJcbiAgKi9cclxuICBvbk9ic2VydmVyc1Jlc3VtZShjYWxsYmFjaykge1xyXG4gICAgdGhpcy5fb25PYnNlcnZlcnNSZXN1bWUgPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTeW5jaGVyO1xyXG4iLCIvKipcclxuKiBUaGUgTm90aXRpZmljYXRpb24gSGFuZGxlciBpcyB1c2VkIHRvIGhhbmRsZSBub3RpZmljYXRpb25zIG5vdCBwcm9jZXNzZWQgYnkgdGhlIHN5bmNoZXIgd2hlbiBydW5uaW5nIGluIGEgc2FuZGJveC5cclxuKi9cclxuXHJcbmltcG9ydCB7IGRpdmlkZVVSTCB9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuXHJcbmNsYXNzIE5vdGlmaWNhdGlvbkhhbmRsZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcihidXMpIHtcclxuXHJcbiAgICBpZiAoIWJ1cykgdGhyb3cgRXJyb3IoJ1tOb3RpZmljYXRpb25IYW5kbGVyIENvbnN0cnVjdG9yXSBidXMgaW5wdXQgaXMgbWFuZGF0b3J5Jyk7XHJcbiAgICB0aGlzLl9idXMgPSBidXM7XHJcbiAgICB0aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIgPSB7fTtcclxuICB9XHJcblxyXG4gIG9uTm90aWZpY2F0aW9uKHNjaGVtZSwgY2FsbGJhY2spIHtcclxuICAgIHRoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcltzY2hlbWVdID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICBvbkNyZWF0ZShtc2cpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gIC8vICBsZXQgcmVzb3VyY2UgPSBtc2cuZnJvbS5zbGljZSgwLCAtMTMpOyAvL3JlbW92ZSBcIi9zdWJzY3JpcHRpb25cIiBmcm9tIHRoZSBVUkxcclxuXHJcbiAgICBsZXQgcmVzb3VyY2UgPSBtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgncmVzb3VyY2UnKSA/IG1zZy5ib2R5LnJlc291cmNlIDogbXNnLmZyb20uc2xpY2UoMCwgLTEzKTtcclxuICAgIGxldCBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKHJlc291cmNlKTtcclxuICAgIGxldCBkb21haW4gPSBkaXZpZGVkVVJMLmRvbWFpbjtcclxuICAgIGxldCBzY2hlbWUgPSByZXNvdXJjZS5zcGxpdCgnOi8vJylbMF07XHJcblxyXG4gICAgbGV0IGVycm9yID0gKHJlYXNvbikgPT4ge1xyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICBib2R5OiB7IGNvZGU6IDQwMCwgZGVzYzogJ0JhZCBSZXF1ZXN0OiAnICsgcmVhc29uIH1cclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICghbXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ3NvdXJjZScpKSB7IGVycm9yKCdNaXNzaW5nIHNvdXJjZScpOyB9XHJcbiAgICBpZiAoIW1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgeyBlcnJvcignTWlzc2luZyBzY2hlbWEnKTsgfVxyXG4gICAgaWYgKCFtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSkgeyBlcnJvcignTWlzc2luZyB2YWx1ZScpOyB9XHJcbiAgICBpZiAoIW1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSB7IGVycm9yKCdNaXNzaW5nIGlkZW50aXR5Jyk7IH1cclxuXHJcbiAgICBsZXQgZXZlbnQgPSB7XHJcbiAgICAgIHR5cGU6IG1zZy50eXBlLFxyXG4gICAgICBmcm9tOiBtc2cuYm9keS5zb3VyY2UsXHJcbiAgICAgIHVybDogcmVzb3VyY2UsXHJcbiAgICAgIGRvbWFpbjogZG9tYWluLFxyXG4gICAgICBzY2hlbWE6IG1zZy5ib2R5LnNjaGVtYSxcclxuICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLFxyXG4gICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksXHJcbiAgICAgIHRvOiBtc2cudG8sXHJcbiAgICAgIHZpYTogbXNnLmJvZHkudmlhLFxyXG5cclxuICAgICAgYWNrOiAodHlwZSkgPT4ge1xyXG4gICAgICAgIGxldCBsVHlwZSA9IDIwMDtcclxuICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgbFR5cGUgPSB0eXBlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2VcclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGVycm9yOiAocmVhc29uKSA9PiB7XHJcbiAgICAgICAgZXJyb3IocmVhc29uKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyW3NjaGVtZV0pIHtcclxuICAgICAgY29uc29sZS5pbmZvKCdbTm90aWZpY2F0aW9uSGFuZGxlcl0gTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7XHJcbiAgICAgIF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXJbc2NoZW1lXShldmVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbkRlbGV0ZShtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAvL3JlbW92ZSBcIi9zdWJzY3JpcHRpb25cIiBmcm9tIHRoZSBVUkxcclxuICAgIGxldCByZXNvdXJjZSA9IG1zZy5ib2R5LnJlc291cmNlO1xyXG5cclxuICAgIGxldCBvYmplY3QgPSBfdGhpcy5fb2JzZXJ2ZXJzW3Jlc291cmNlXTtcclxuXHJcbiAgICBsZXQgdW5zdWJzY3JpYmUgPSB7XHJcbiAgICAgIGZyb206IF90aGlzLm93bmVyLFxyXG4gICAgICB0bzogX3RoaXMuX3N1YlVSTCxcclxuICAgICAgaWQ6IG1zZy5pZCxcclxuICAgICAgdHlwZTogJ3Vuc3Vic2NyaWJlJyxcclxuICAgICAgYm9keTogeyByZXNvdXJjZTogbXNnLmJvZHkucmVzb3VyY2UgfVxyXG4gICAgfTtcclxuXHJcbiAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHVuc3Vic2NyaWJlKTtcclxuXHJcbiAgICBkZWxldGUgX3RoaXMuX29ic2VydmVyc1tyZXNvdXJjZV07XHJcblxyXG4gICAgaWYgKG9iamVjdCkge1xyXG4gICAgICBsZXQgZXZlbnQgPSB7XHJcbiAgICAgICAgdHlwZTogbXNnLnR5cGUsXHJcbiAgICAgICAgdXJsOiByZXNvdXJjZSxcclxuICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksXHJcblxyXG4gICAgICAgIGFjazogKHR5cGUpID0+IHtcclxuICAgICAgICAgIGxldCBsVHlwZSA9IDIwMDtcclxuICAgICAgICAgIGlmICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGxUeXBlID0gdHlwZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/XHJcbiAgICAgICAgICBpZiAobFR5cGUgPT09IDIwMCkge1xyXG4gICAgICAgICAgICBvYmplY3QuZGVsZXRlKCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy9zZW5kIGFjayByZXNwb25zZSBtZXNzYWdlXHJcbiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sXHJcbiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogbFR5cGUsIHNvdXJjZTogX3RoaXMuX293bmVyIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7XHJcbiAgICAgICAgbG9nLmxvZygnTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7XHJcbiAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICAgIGJvZHk6IHsgY29kZTogNDA0LCBzb3VyY2U6IF90aGlzLl9vd25lciB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgTm90aWZpY2F0aW9uSGFuZGxlcjtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5pbXBvcnQge2RpdmlkZVVSTH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuLyoqXHJcbiogQ29yZSBJZGVudGl0eU1hbmFnZXIgaW50ZXJmYWNlXHJcbiogQ2xhc3MgdG8gYWxsb3cgYXBwbGljYXRpb25zIHRvIHNlYXJjaCBmb3IgSWRlbnRpdGllcyByZWdpc3RlcmVkIGluIHJ1bnRpbWUtY29yZVxyXG4qL1xyXG5jbGFzcyBJZGVudGl0eU1hbmFnZXIge1xyXG5cclxuICAvKipcclxuICAqIFRvIGluaXRpYWxpc2UgdGhlIElkZW50aXR5TWFuYWdlciwgd2hpY2ggd2lsbCBwcm92aWRlIHRoZSBzdXBwb3J0IGZvciBoeXBlcnRpZXMgdG9cclxuICAqIHF1ZXJ5IGFib3V0IGlkZW50aXRpZXMgcmVnaXN0ZXJlZFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICBvd25lciAgICAgICAgICAgIG93bmVyXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgIHJ1bnRpbWVVUkwgICAgICAgICAgICBydW50aW1lVVJMXHJcbiAgKiBAcGFyYW0gIHtNZXNzYWdlQnVzfSAgICAgICAgICBtc2didXMgICAgICAgICAgICAgICAgbXNnYnVzXHJcbiAgKi9cclxuICBjb25zdHJ1Y3Rvcihvd25lciwgcnVudGltZVVSTCwgbXNnQnVzKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMubWVzc2FnZUJ1cyA9IG1zZ0J1cztcclxuXHJcbiAgICBfdGhpcy5kb21haW4gPSBkaXZpZGVVUkwob3duZXIpLmRvbWFpbjtcclxuICAgIF90aGlzLm93bmVyID0gb3duZXI7XHJcbiAgICBfdGhpcy5ydW50aW1lVVJMID0gcnVudGltZVVSTDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogRnVuY3Rpb24gdG8gcXVlcnkgdGhlIHJ1bnRpbWUgcmVnaXN0cnkgYWJvdXQgdGhlIGlkZW50aXR5IHRvIHdoaWNoIHRoZSBoeXBlcnR5IHdhcyBhc3NvY2lhdGVkXHJcbiAgKiBAcGFyYW0ge1N0cmluZ30gICAgICAgdHlwZSAoT3B0aW9uYWwpICAgICAgICAgdHlwZSBvZiB1c2VyIGluZm8gcmVxdWlyZWRcclxuICAqIEBwYXJhbSB7U3RyaW5nfSAgICAgICBvd25lciAoT3B0aW9uYWwpICAgb3duZXIgdG8gc2VhcmNoIGZvclxyXG4gICogQHJldHVybiB7UHJvbWlzZX0gICAgIHVzZXJVUkwgICAgICAgdXNlclVSTCBhc3NvY2lhdGVkIHRvIHRoZSBoeXBlcnR5XHJcbiAgKi9cclxuICBkaXNjb3ZlclVzZXJSZWdpc3RlcmVkKHR5cGUsIGh5cGVydHkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IGFjdGl2ZUh5cGVydHlVUkw7XHJcblxyXG4gICAgICAvLyBpZiBhbnkgdHlwZSBvZiBzZWFyY2ggaXMgc2VsZWN0ZWQgcXVlcnkgZm9yIHRoYXQgdHlwZSwgb3RoZXJ3aXNlIHF1ZXJ5IGZvciBkZWZhdWx0IHVzZXIgaW5mb1xyXG4gICAgICBsZXQgc2VhcmNoVHlwZSA9ICh0eXBlKSA/IHR5cGUgOiAnLic7XHJcblxyXG4gICAgICBpZiAoIWh5cGVydHkpIHtcclxuICAgICAgICBhY3RpdmVIeXBlcnR5VVJMID0gX3RoaXMub3duZXI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYWN0aXZlSHlwZXJ0eVVSTCA9IGh5cGVydHk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBtc2cgPSB7XHJcbiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBhY3RpdmVIeXBlcnR5VVJMLCB0bzogX3RoaXMucnVudGltZVVSTCArICcvcmVnaXN0cnkvJywgYm9keTogeyByZXNvdXJjZTogc2VhcmNoVHlwZSwgY3JpdGVyaWE6IGFjdGl2ZUh5cGVydHlVUkx9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcblxyXG4gICAgICAgIGxldCB1c2VyVVJMID0gcmVwbHkuYm9keS5yZXNvdXJjZTtcclxuXHJcbiAgICAgICAgaWYgKHVzZXJVUkwgJiYgcmVwbHkuYm9keS5jb2RlID09PSAyMDApIHtcclxuICAgICAgICAgIHJlc29sdmUodXNlclVSTCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlamVjdCgnY29kZTogJyArIHJlcGx5LmJvZHkuY29kZSArICcgTm8gdXNlciB3YXMgZm91bmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIEZ1bmN0aW9uIHRvIHF1ZXJ5IHRoZSBJZGVudGl0eSBNb2R1bGUgYWJvdXQgYXV0aGVudGljYXRlZCBpZGVudGl0aWVzIGZyb20gYSBjZXJ0YWluIGRvbWFpblxyXG4gICogQHBhcmFtIHtTdHJpbmd9ICAgICAgIGlkcCBpZHAgZG9tYWluIG9mIHRoZSBpZGVudGl0eSB0byBiZSBkaXNjb3ZlcmVkXHJcbiAgKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgaWRlbnRpdHlcclxuICAqL1xyXG5cclxuICBkaXNjb3ZlcklkZW50aXR5UGVySWRQKGlkcCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBsZXQgbXNnID0ge1xyXG4gICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogdGhpcy5vd25lciwgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2lkbScsIGJvZHk6IHsgcmVzb3VyY2U6IGlkcCwgY3JpdGVyaWE6ICdpZHAnfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIChyZXBseSkgPT4ge1xyXG5cclxuICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHtcclxuICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmNvZGUgKyAnICcgKyByZXBseS5ib2R5LmRlc2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IElkZW50aXR5TWFuYWdlcjtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5cclxuLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignUmVnaXN0cmF0aW9uU3RhdHVzJyk7XHJcblxyXG5pbXBvcnQgeyBkaXZpZGVVUkwgfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcblxyXG4vKipcclxuKiBUaGUgUmVnaXN0cmF0aW9uU3RhdHVzIGxpYiBhbGxvd3MgdG8gbW9uaXRvciByZWdpc3RyYXRpb24gc3RhdHVzIG9mIGFuIEh5cGVydHkgb3IgRGF0YSBPYmplY3RcclxuKlxyXG4qL1xyXG5jbGFzcyBSZWdpc3RyYXRpb25TdGF0dXMge1xyXG5cclxuICAvKipcclxuICAqIEBwYXJhbSB7VVJMfSB1cmwgVVJMIGFkZHJlc3Mgb2YgdGhlIGVudGl0eSB0byBiZSBtb25pdG9yZWRcclxuICAqIEBwYXJhbSB7VVJMfSBydW50aW1lVVJMIHRoZSBjdXJyZW50IFVSTCBvZiB0aGUgUnVudGltZSBJbnN0YW5jZSB1c2VkXHJcbiAgKiBAcGFyYW0ge0h5cGVydHlVUkx9IG93bmVyIHRoZSBVUkwgb2YgdGhlIEh5cGVydHkgaW5zdGFuY2UgdGhhdCBpcyB1c2luZyB0aGlzIGxpYlxyXG4gICogQHBhcmFtIHtNaW5pQnVzfSBvd25lciB0aGUgVVJMIG9mIHRoZSBIeXBlcnR5IGluc3RhbmNlIHRoYXQgaXMgdXNpbmcgdGhpcyBsaWJcclxuICAqXHJcbiAgKi9cclxuXHJcbiAgY29uc3RydWN0b3IodXJsLCBydW50aW1lVVJMLCBvd25lciwgbXNnQnVzKSB7XHJcbiAgICB0aGlzLl9yZWdpc3RyeU9iamVjdFVSTCA9IHVybDtcclxuICAgIHRoaXMuX3J1bnRpbWVVUkwgPSBydW50aW1lVVJMO1xyXG4gICAgdGhpcy5fZG9tYWluID0gZGl2aWRlVVJMKHJ1bnRpbWVVUkwpLmRvbWFpbjtcclxuICAgIHRoaXMuX2Rpc2NvdmVyZWRPYmplY3RVUkwgPSBvd25lcjtcclxuICAgIHRoaXMuX21lc3NhZ2VCdXMgPSBtc2dCdXM7XHJcbiAgICB0aGlzLl9zdWJzY3JpcHRpb25TZXQgPSBmYWxzZTtcclxuICAgIHRoaXMuX3N1YnNjcmliZXJzID0ge1xyXG4gICAgICBsaXZlOiB7fSxcclxuICAgICAgZGlzY29ubmVjdGVkOiB7fVxyXG4gICAgfTtcclxuICB9XHJcblxyXG5cclxuICBvbkxpdmUoc3Vic2NyaWJlciwgY2FsbGJhY2spIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgaWYgKCF0aGlzLl9zdWJzY3JpcHRpb25TZXQpIHtcclxuICAgICAgICB0aGlzLl9zdWJzY3JpYmUoKVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHRoaXMuX3N1YnNjcmliZXJzLmxpdmVbc3Vic2NyaWJlcl0gPSBjYWxsYmFjaztcclxuICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiByZWplY3QoZXJyKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlcnMubGl2ZVtzdWJzY3JpYmVyXSA9IGNhbGxiYWNrO1xyXG4gICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBvbkRpc2Nvbm5lY3RlZChzdWJzY3JpYmVyLCBjYWxsYmFjaykge1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBpZiAoIXRoaXMuX3N1YnNjcmlwdGlvblNldCkge1xyXG4gICAgICAgIHRoaXMuX3N1YnNjcmliZSgpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5fc3Vic2NyaWJlcnMuZGlzY29ubmVjdGVkW3N1YnNjcmliZXJdID0gY2FsbGJhY2s7XHJcbiAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gcmVqZWN0KGVycikpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuX3N1YnNjcmliZXJzLmRpc2Nvbm5lY3RlZFtzdWJzY3JpYmVyXSA9IGNhbGxiYWNrO1xyXG4gICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc3Vic2NyaWJlKCkge1xyXG5cclxuICAgIGNvbnN0IG1zZyA9IHtcclxuICAgICAgdHlwZTogJ3N1YnNjcmliZScsXHJcbiAgICAgIGZyb206IHRoaXMuX2Rpc2NvdmVyZWRPYmplY3RVUkwsXHJcbiAgICAgIHRvOiB0aGlzLl9ydW50aW1lVVJMICsgJy9zdWJzY3JpcHRpb25zJyxcclxuICAgICAgYm9keToge1xyXG4gICAgICAgIHJlc291cmNlczogW3RoaXMuX3JlZ2lzdHJ5T2JqZWN0VVJMICsgJy9yZWdpc3RyYXRpb24nXVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICB0aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmxvZyhgW0Rpc2NvdmVyZWRPYmplY3Quc3Vic2NyaWJlXSAke3RoaXMuX3JlZ2lzdHJ5T2JqZWN0VVJMfSByY3ZlZCByZXBseSBgLCByZXBseSk7XHJcblxyXG4gICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkge1xyXG4gICAgICAgICAgdGhpcy5fZ2VuZXJhdGVMaXN0ZW5lcih0aGlzLl9yZWdpc3RyeU9iamVjdFVSTCArICcvcmVnaXN0cmF0aW9uJyk7XHJcbiAgICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb25TZXQgPSB0cnVlO1xyXG4gICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZXJyb3IoJ0Vycm9yIHN1YnNjcmliaW5nICcsIHRoaXMuX3JlZ2lzdHJ5T2JqZWN0VVJMKTtcclxuICAgICAgICAgIHJlamVjdCgnRXJyb3Igc3Vic2NyaWJpbmcgJyArIHRoaXMuX3JlZ2lzdHJ5T2JqZWN0VVJMKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZ2VuZXJhdGVMaXN0ZW5lcihub3RpZmljYXRpb25VUkwpIHtcclxuXHJcbiAgICB0aGlzLl9tZXNzYWdlQnVzLmFkZExpc3RlbmVyKG5vdGlmaWNhdGlvblVSTCwgKG1zZykgPT4ge1xyXG4gICAgICBsb2cubG9nKGBbRGlzY292ZXJlZE9iamVjdC5ub3RpZmljYXRpb25dICR7dGhpcy5fcmVnaXN0cnlPYmplY3RVUkx9OiBgLCBtc2cpO1xyXG4gICAgICB0aGlzLl9wcm9jZXNzTm90aWZpY2F0aW9uKG1zZyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9wcm9jZXNzTm90aWZpY2F0aW9uKG1zZykge1xyXG4gICAgY29uc3Qgc3RhdHVzID0gbXNnLmJvZHkudmFsdWU7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcblxyXG4gICAgICAvLyBIYWNrIHRvIGdpdmUgdGltZSBmb3Igb25MaXZlIEh5cGVydGllcyB0byBnZXQgcmVhZHkuIFRvIGJlIHJlbW92ZWQgd2hlbiBIeXBlcnR5IFN0YXRlIG1hY2hhaW5lIGlzIGltcGxlbWVudGVkXHJcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMuX3N1YnNjcmliZXJzW3N0YXR1c10pLmZvckVhY2goXHJcbiAgICAgICAgc3Vic2NyaWJlciA9PiB0aGlzLl9zdWJzY3JpYmVyc1tzdGF0dXNdW3N1YnNjcmliZXJdKClcclxuICAgICAgKTtcclxuXHJcbiAgICB9LCA1MDAwKTtcclxuXHJcbiAgfVxyXG5cclxuXHJcbiAgX3Vuc3Vic2NyaWJlKCkge1xyXG5cclxuICAgIGNvbnN0IG1zZyA9IHtcclxuICAgICAgdHlwZTogJ3Vuc3Vic2NyaWJlJyxcclxuICAgICAgZnJvbTogdGhpcy5fZGlzY292ZXJlZE9iamVjdFVSTCxcclxuICAgICAgdG86IHRoaXMuX3J1bnRpbWVVUkwgKyAnL3N1YnNjcmlwdGlvbnMnLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6IHRoaXMuX3JlZ2lzdHJ5T2JqZWN0VVJMICsgJy9yZWdpc3RyYXRpb24nXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIHRoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuICAgICAgICBsb2cubG9nKGBbRGlzY292ZXJlZE9iamVjdC51bnN1YnNjcmliZV0gJHt0aGlzLl9yZWdpc3RyeU9iamVjdFVSTH0gcmN2ZWQgcmVwbHkgYCwgcmVwbHkpO1xyXG5cclxuICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHtcclxuICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nLmVycm9yKCdFcnJvciB1bnN1YnNjcmliaW5nICcsIHRoaXMuX3JlZ2lzdHJ5T2JqZWN0VVJMKTtcclxuICAgICAgICAgIHJlamVjdCgnRXJyb3IgdW5zdWJzY3JpYmluZyAnICsgdGhpcy5fcmVnaXN0cnlPYmplY3RVUkwpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVuc3Vic2NyaWJlTGl2ZShzdWJzY3JpYmVyKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgaWYgKHN1YnNjcmliZXIgaW4gdGhpcy5fc3Vic2NyaWJlcnMubGl2ZSkge1xyXG5cclxuICAgICAgICAgIC8vVE9ETzogdW5zdWJzY3JpYmUgb3V0c2lkZSB0aGlzIGNvbmRpdGlvblxyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9zdWJzY3JpYmVycy5saXZlW3N1YnNjcmliZXJdO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGhpcy5fYXJlU3Vic2NyaXB0aW9uc0VtcHR5KCkpIHtcclxuICAgICAgICB0aGlzLl91bnN1YnNjcmliZSgpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHJlc29sdmUoKSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHJlamVjdChlcnIpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVqZWN0KGAke3N1YnNjcmliZXJ9IGRvZXNuJ3Qgc3Vic2NyaWJlIG9uTGl2ZSBmb3IgJHt0aGlzLl9yZWdpc3RyeU9iamVjdFVSTH1gKTtcclxuICAgICAgICB9Ki9cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdW5zdWJzY3JpYmVEaXNjb25uZWN0ZWQoc3Vic2NyaWJlcikge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIGlmIChzdWJzY3JpYmVyIGluIHRoaXMuX3N1YnNjcmliZXJzLmRpc2Nvbm5lY3RlZCkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9zdWJzY3JpYmVycy5kaXNjb25uZWN0ZWRbc3Vic2NyaWJlcl07XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9hcmVTdWJzY3JpcHRpb25zRW1wdHkoKSkge1xyXG4gICAgICAgICAgdGhpcy5fdW5zdWJzY3JpYmUoKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4gcmVzb2x2ZSgpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHJlamVjdChlcnIpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZWplY3QoYCR7c3Vic2NyaWJlcn0gZG9lc24ndCBzdWJzY3JpYmUgb25EaXNjb25uZWN0ZWQgZm9yICR7dGhpcy5fcmVnaXN0cnlPYmplY3RVUkx9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2FyZVN1YnNjcmlwdGlvbnNFbXB0eSgpIHtcclxuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9zdWJzY3JpYmVycy5saXZlKS5sZW5ndGggPT09IDBcclxuICAgICAgJiYgT2JqZWN0LmtleXModGhpcy5fc3Vic2NyaWJlcnMuZGlzY29ubmVjdGVkKS5sZW5ndGggPT09IDA7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUmVnaXN0cmF0aW9uU3RhdHVzO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vL2ltcG9ydCB7ZGl2aWRlVVJMLCBjb252ZXJ0VG9Vc2VyVVJMfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBSZWdpc3RyYXRpb25TdGF0dXMgZnJvbSAnLi9SZWdpc3RyYXRpb25TdGF0dXMnO1xyXG5cclxuLyoqXHJcbiogRGlzY292ZXJlZCBPYmplY3QgaW50ZXJmYWNlXHJcbiovXHJcbmNsYXNzIERpc2NvdmVyZWRPYmplY3QgZXh0ZW5kcyBSZWdpc3RyYXRpb25TdGF0dXMge1xyXG5cclxuICBnZXQgZGF0YSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9kYXRhO1xyXG4gIH1cclxuXHJcbiAgY29uc3RydWN0b3IoZGF0YSwgcnVudGltZVVSTCwgZGlzY292ZXJ5VVJMLCBtc2dCdXMsIGRpc2NvdmVyeSkge1xyXG4gICAgc3VwZXIoZGF0YS5oeXBlcnR5SUQgfHwgZGF0YS51cmwsIHJ1bnRpbWVVUkwsIGRpc2NvdmVyeVVSTCwgbXNnQnVzKTtcclxuXHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX2Rpc2NvdmVyeSA9IGRpc2NvdmVyeTtcclxuICB9XHJcblxyXG5cclxuXHJcblxyXG4gIC8qKlxyXG4gICogZnVuY3Rpb24gdG8gY2hlY2sgdGhlIHN0YXR1cyBvZiB0aGUgRGlzY292ZXJlZE9iamVjdC5cclxuICAqIERlcGVuZGluZyBvbiBleGlzdGluZyBzdWJzY3JpYmVycyBpdCBtYXkgdHJpZ2dlciBvbkxpdmUgb3Igb25EaXNjb25uZWN0ZWQgZXZlbnRzLlxyXG4gICpcclxuICAqL1xyXG5cclxuICBjaGVjaygpIHtcclxuICAgIC8vIHF1ZXJ5IERSIGZvciB0aGUgc3RhdHVzIGFuZCBjYWxsIHByb2Nlc3NOb3RpZmljYXRpb24gd2l0aCBtc2cgcmVjZWl2ZWRcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IG1lc3NhZ2UgPSB7XHJcbiAgICAgIGJvZHk6IHt9XHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChfdGhpcy5fZGlzY292ZXJlZE9iamVjdFVSTC5zdGFydHNXaXRoKCdoeXBlcnR5Oi8vJykgKSB7XHJcbiAgICAgIF90aGlzLl9kaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5UGVyVVJMKF90aGlzLl9kaXNjb3ZlcmVkT2JqZWN0VVJMKS50aGVuKChyZWdpc3RyYXRpb24pPT57XHJcbiAgICAgICAgbWVzc2FnZS5ib2R5LnN0YXR1cyA9IHJlZ2lzdHJhdGlvbi5zdGF0dXM7XHJcbiAgICAgICAgX3RoaXMuX3Byb2Nlc3NOb3RpZmljYXRpb24obWVzc2FnZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgX3RoaXMuX2Rpc2NvdmVyeS5kaXNjb3ZlckRhdGFPYmplY3RzUGVyVVJMKF90aGlzLl9kaXNjb3ZlcmVkT2JqZWN0VVJMKS50aGVuKChyZWdpc3RyYXRpb24pPT57XHJcbiAgICAgICAgbWVzc2FnZS5ib2R5LnN0YXR1cyA9IHJlZ2lzdHJhdGlvbi5zdGF0dXM7XHJcbiAgICAgICAgX3RoaXMuX3Byb2Nlc3NOb3RpZmljYXRpb24obWVzc2FnZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRGlzY292ZXJlZE9iamVjdDtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5cclxuLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignRGlzY292ZXJ5Jyk7XHJcblxyXG5pbXBvcnQge2RpdmlkZVVSTCwgY29udmVydFRvVXNlclVSTH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgRGlzY292ZXJlZE9iamVjdCBmcm9tICcuL0Rpc2NvdmVyZWRPYmplY3QnO1xyXG5cclxuLyoqXHJcbiogQ29yZSBEaXNjb3ZlcnkgaW50ZXJmYWNlXHJcbiogQ2xhc3MgdG8gYWxsb3cgYXBwbGljYXRpb25zIHRvIHNlYXJjaCBmb3IgaHlwZXJ0aWVzIGFuZCBEYXRhT2JqZWN0cyB1c2luZyB0aGUgbWVzc2FnZSBidXNcclxuKi9cclxuY2xhc3MgRGlzY292ZXJ5IHtcclxuXHJcbiAgLyoqXHJcbiAgKiBUbyBpbml0aWFsaXNlIHRoZSBIeXBlcnR5RGlzY292ZXIsIHdoaWNoIHdpbGwgcHJvdmlkZSB0aGUgc3VwcG9ydCBmb3IgaHlwZXJ0aWVzIHRvXHJcbiAgKiBxdWVyeSB1c2VycyByZWdpc3RlcmVkIGluIG91dHNpZGUgdGhlIGludGVybmFsIGNvcmUuXHJcbiAgKiBAcGFyYW0gIHtNZXNzYWdlQnVzfSAgICAgICAgICBtc2didXMgICAgICAgICAgICAgICAgbXNnYnVzXHJcbiAgKiBAcGFyYW0gIHtSdW50aW1lVVJMfSAgICAgICAgICBydW50aW1lVVJMICAgICAgICAgICAgcnVudGltZVVSTFxyXG4gICovXHJcbiAgY29uc3RydWN0b3IoaHlwZXJ0eVVSTCwgcnVudGltZVVSTCwgbXNnQnVzKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMubWVzc2FnZUJ1cyA9IG1zZ0J1cztcclxuICAgIF90aGlzLnJ1bnRpbWVVUkwgPSBydW50aW1lVVJMO1xyXG5cclxuICAgIF90aGlzLmRvbWFpbiA9IGRpdmlkZVVSTChoeXBlcnR5VVJMKS5kb21haW47XHJcbiAgICBfdGhpcy5kaXNjb3ZlcnlVUkwgPSBoeXBlcnR5VVJMO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIEh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSB1c2VyIGlkZW50aWZpZXIgKGVnIGVtYWlsLCBuYW1lIC4uLilcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIHVzZXJJZGVudGlmaWVyXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBzY2hlbWEgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgaHlwZXJ0aWVzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzXHJcbiAgKi9cclxuICBfaXNMZWdhY3lVc2VyKHVzZXJJZGVudGlmaWVyKSB7XHJcbiAgICBpZiAodXNlcklkZW50aWZpZXIuaW5jbHVkZXMoJzonKSAmJiAhdXNlcklkZW50aWZpZXIuaW5jbHVkZXMoJ3VzZXI6Ly8nKSkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogQWR2YW5jZWQgU2VhcmNoIGZvciBIeXBlcnRpZXMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnkgYXNzb2NpYXRlZCB3aXRoIHNvbWUgdXNlciBpZGVudGlmaWVyIChlZyBlbWFpbCwgbmFtZSAuLi4pXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICB1c2VySWRlbnRpZmllclxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICByZXNvdXJjZXMgKE9wdGlvbmFsKSAgdHlwZXMgb2YgaHlwZXJ0aWVzIHJlc291cmNlc1xyXG4gICovXHJcbiAgZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyUHJvZmlsZURhdGEodXNlcklkZW50aWZpZXIsIHNjaGVtYSwgcmVzb3VyY2VzKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGZpbHRlcmVkSHlwZXJ0aWVzID0gW107XHJcblxyXG4gICAgbGV0IG1zZyA9IHtcclxuICAgICAgdHlwZTogJ3JlYWQnLFxyXG4gICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsXHJcbiAgICAgIHRvOiBfdGhpcy5ydW50aW1lVVJMICsgJy9kaXNjb3ZlcnkvJyxcclxuICAgICAgYm9keToge1xyXG4gICAgICAgIHJlc291cmNlOiAnL2h5cGVydHkvdXNlcnByb2ZpbGUvJyArIHVzZXJJZGVudGlmaWVyLFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChzY2hlbWEgfHwgcmVzb3VyY2VzKSB7XHJcbiAgICAgIG1zZy5ib2R5Wydjcml0ZXJpYSddID0ge1xyXG4gICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzLFxyXG4gICAgICAgIGRhdGFTY2hlbWVzOiBzY2hlbWFcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBpZiAoIV90aGlzLl9pc0xlZ2FjeVVzZXIodXNlcklkZW50aWZpZXIpKSB7Ly8gdG9kbzogdG8gcmVvbXZlIHdoZW4gZGlzY292ZXJ5IG9mIGxlZ2NheSB1c2VycyBhcmUgc3VwcG9ydGVkXHJcblxyXG4gICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuXHJcbiAgICAgICAgICBpZihyZXBseS5ib2R5LmNvZGUgPT09IDIwMCl7XHJcbiAgICAgICAgICAgIHJlcGx5LmJvZHkudmFsdWUubWFwKGZ1bmN0aW9uKGh5cGVydHkpIHtcclxuICAgICAgICAgICAgICAgaWYoaHlwZXJ0eS5oeXBlcnR5SUQgIT0gX3RoaXMuZGlzY292ZXJ5VVJMKVxyXG4gICAgICAgICAgICAgICAgICAgZmlsdGVyZWRIeXBlcnRpZXMucHVzaChoeXBlcnR5KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmKGZpbHRlcmVkSHlwZXJ0aWVzLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgICByZXNvbHZlKFtdKTtcclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgbG9nLmxvZyhcIltEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyUHJvZmlsZURhdGFdIFJlcGx5IGxvZzogXCIsZmlsdGVyZWRIeXBlcnRpZXMpO1xyXG4gICAgICAgICAgICAgIHJlc29sdmUoZmlsdGVyZWRIeXBlcnRpZXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbG9nLndhcm4oXCJbRGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlclByb2ZpbGVEYXRhXSBFcnJvciBSZXBseSBmb3IgXCIgKyB1c2VySWRlbnRpZmllciArIFwiIFJlYXNvbjogXCIsIHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICByZXNvbHZlKFtdKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNvbHZlKFt7aHlwZXJ0eUlEOiB1c2VySWRlbnRpZmllciwgc3RhdHVzOiAnbGl2ZSd9XSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIEh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSB1c2VyIGlkZW50aWZpZXIgKGVnIGVtYWlsLCBuYW1lIC4uLilcclxuICAqIHJldHVybnMgRGlzY292ZXJlZE9iamVjdFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlcklkZW50aWZpZXJcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBoeXBlcnRpZXMgc2NoZW1hc1xyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXNcclxuICAqL1xyXG4gIGRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlclByb2ZpbGVEYXRhRE8odXNlcklkZW50aWZpZXIsIHNjaGVtYSwgcmVzb3VyY2VzKSB7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgdGhpcy5kaXNjb3Zlckh5cGVydGllc1BlclVzZXJQcm9maWxlRGF0YSguLi5hcmd1bWVudHMpXHJcbiAgICAgIC50aGVuKGh5cGVydGllcyA9PiB7XHJcbiAgICAgICAgcmVzb2x2ZSh0aGlzLl9jb252ZXJ0VG9EaXNjb3ZlcmVkT2JqZWN0KGh5cGVydGllcykpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gcmVqZWN0KGVycm9yKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogQWR2YW5jZWQgU2VhcmNoIGZvciBEYXRhT2JqZWN0cyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSB1c2VyIGlkZW50aWZpZXIgKGVnIGVtYWlsLCBuYW1lIC4uLilcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIHVzZXJJZGVudGlmaWVyXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBzY2hlbWEgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgaHlwZXJ0aWVzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzXHJcbiAgKi9cclxuICBkaXNjb3ZlckRhdGFPYmplY3RzUGVyVXNlclByb2ZpbGVEYXRhKHVzZXJJZGVudGlmaWVyLCBzY2hlbWEsIHJlc291cmNlcykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG4gICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCxcclxuICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6ICcvZGF0YU9iamVjdC91c2VycHJvZmlsZS8nICsgdXNlcklkZW50aWZpZXIsXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYoc2NoZW1hIHx8IHJlc291cmNlcykge1xyXG4gICAgICBtc2cuYm9keVsnY3JpdGVyaWEnXSA9IHtcclxuICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcyxcclxuICAgICAgICBkYXRhU2NoZW1lczogc2NoZW1hXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgaWYgKCFfdGhpcy5faXNMZWdhY3lVc2VyKHVzZXJJZGVudGlmaWVyKSkgey8vIHRvZG86IHRvIHJlb212ZSB3aGVuIGRpc2NvdmVyeSBvZiBsZWdjYXkgdXNlcnMgYXJlIHN1cHBvcnRlZFxyXG5cclxuICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcblxyXG4gICAgICAgICAgaWYocmVwbHkuYm9keS5jb2RlID09PSAyMDApe1xyXG4gICAgICAgICAgICBsb2cubG9nKFwiUmVwbHkgbG9nOiBcIixyZXBseS5ib2R5LnZhbHVlKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsb2cud2FybihcIltEaXNjb3ZlcnkuZGlzY292ZXJEYXRhT2JqZWN0c1BlclVzZXJQcm9maWxlRGF0YV0gRXJyb3IgUmVwbHkgZm9yIFwiICsgdXNlcklkZW50aWZpZXIgKyBcIiBSZWFzb246IFwiLCByZXBseS5ib2R5LmRlc2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShbXSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXNvbHZlKFt7aHlwZXJ0eUlEOiB1c2VySWRlbnRpZmllciwgc3RhdHVzOiAnbGl2ZSd9XSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgZGF0YU9iamVjdCByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSwgYW5kXHJcbiAgKiByZXR1cm5zIGRpc2NvdmVyZWRPYmplY3QuXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBndWlkVVJMICAgICAgICAgICAgICAgIGd1aWQgVVJMIGUuZyB1c2VyLWd1aWQ6Ly88dW5pcXVlLXVzZXItaWRlbnRpZmllcj5cclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBoeXBlcnRpZXMgc2NoZW1hc1xyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXNcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaFxyXG4gICovXHJcbiAgZGlzY292ZXJEYXRhT2JqZWN0c1BlclVzZXJQcm9maWxlRGF0YURPKGd1aWRVUkwsIHNjaGVtYSwgcmVzb3VyY2VzKSB7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgdGhpcy5kaXNjb3ZlckRhdGFPYmplY3RzUGVyVXNlclByb2ZpbGVEYXRhKC4uLmFyZ3VtZW50cylcclxuICAgICAgICAudGhlbihyZWdpc3RyeU9iamVjdHMgPT4gcmVzb2x2ZSh0aGlzLl9jb252ZXJ0VG9EaXNjb3ZlcmVkT2JqZWN0KHJlZ2lzdHJ5T2JqZWN0cykpKVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiByZWplY3QoZXJyb3IpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIEh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSBHVUlEXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBndWlkVVJMICAgICAgICAgICAgICAgIGd1aWQgVVJMIGUuZyB1c2VyLWd1aWQ6Ly88dW5pcXVlLXVzZXItaWRlbnRpZmllcj5cclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBoeXBlcnRpZXMgc2NoZW1hc1xyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXNcclxuICAqL1xyXG4gIGRpc2NvdmVySHlwZXJ0aWVzUGVyR1VJRChndWlkVVJMLCBzY2hlbWEsIHJlc291cmNlcykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBmaWx0ZXJlZEh5cGVydGllcyA9IFtdO1xyXG5cclxuICAgIGxldCBtc2cgPSB7XHJcbiAgICAgIHR5cGU6ICdyZWFkJyxcclxuICAgICAgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLFxyXG4gICAgICB0bzogX3RoaXMucnVudGltZVVSTCArICcvZGlzY292ZXJ5LycsXHJcbiAgICAgIGJvZHk6IHtcclxuICAgICAgICByZXNvdXJjZTogJy9oeXBlcnR5L2d1aWQvJyArIGd1aWRVUkwsXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYoc2NoZW1hIHx8IHJlc291cmNlcykge1xyXG4gICAgICBtc2cuYm9keVsnY3JpdGVyaWEnXSA9IHtcclxuICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcyxcclxuICAgICAgICBkYXRhU2NoZW1lczogc2NoZW1hXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIChyZXBseSkgPT4ge1xyXG5cclxuICAgICAgICBpZihyZXBseS5ib2R5LmNvZGUgPT09IDIwMCl7XHJcbiAgICAgICAgICByZXBseS5ib2R5LnZhbHVlLm1hcChmdW5jdGlvbihoeXBlcnR5KSB7XHJcbiAgICAgICAgICAgICBpZihoeXBlcnR5Lmh5cGVydHlJRCAhPSBfdGhpcy5kaXNjb3ZlcnlVUkwpXHJcbiAgICAgICAgICAgICAgICAgZmlsdGVyZWRIeXBlcnRpZXMucHVzaChoeXBlcnR5KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgaWYoZmlsdGVyZWRIeXBlcnRpZXMubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICByZWplY3QoJ05vIEh5cGVydHkgd2FzIGZvdW5kJyk7XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbG9nLmxvZyhcIlJlcGx5IGxvZzogXCIsZmlsdGVyZWRIeXBlcnRpZXMpO1xyXG4gICAgICAgICAgICByZXNvbHZlKGZpbHRlcmVkSHlwZXJ0aWVzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBsb2cud2FybihcIltEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnRpZXNQZXJHVUlEXSBFcnJvciBSZXBseSBmb3IgXCIgKyBndWlkVVJMICsgXCIgUmVhc29uOiBcIiwgcmVwbHkuYm9keS5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICByZXNvbHZlKFtdKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIEFkdmFuY2VkIFNlYXJjaCBmb3IgSHlwZXJ0aWVzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IGFzc29jaWF0ZWQgd2l0aCBzb21lIEdVSURcclxuICAqIHJldHVybnMgRGlzY292ZXJlZE9iamVjdFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZ3VpZFVSTCAgICAgICAgICAgICAgICBndWlkIFVSTCBlLmcgdXNlci1ndWlkOi8vPHVuaXF1ZS11c2VyLWlkZW50aWZpZXI+XHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBzY2hlbWEgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgaHlwZXJ0aWVzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzXHJcbiAgKi9cclxuICBkaXNjb3Zlckh5cGVydGllc1BlckdVSURETyhndWlkVVJMLCBzY2hlbWEsIHJlc291cmNlcykge1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHRoaXMuZGlzY292ZXJIeXBlcnRpZXNQZXJHVUlEKC4uLmFyZ3VtZW50cylcclxuICAgICAgLnRoZW4oaHlwZXJ0aWVzID0+IHtcclxuICAgICAgICByZXNvbHZlKHRoaXMuX2NvbnZlcnRUb0Rpc2NvdmVyZWRPYmplY3QoaHlwZXJ0aWVzKSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlcnJvciA9PiByZWplY3QoZXJyb3IpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIERhdGFPYmplY3RzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IGFzc29jaWF0ZWQgd2l0aCBzb21lIEdVSURcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGd1aWRVUkwgICAgICAgICAgICAgICAgZ3VpZCBVUkwgZS5nIHVzZXItZ3VpZDovLzx1bmlxdWUtdXNlci1pZGVudGlmaWVyPlxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICByZXNvdXJjZXMgKE9wdGlvbmFsKSAgdHlwZXMgb2YgaHlwZXJ0aWVzIHJlc291cmNlc1xyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZG9tYWluIChPcHRpb25hbCkgICAgIGRvbWFpbiBvZiB0aGUgcmVnaXN0cnkgdG8gc2VhcmNoXHJcbiAgKi9cclxuICBkaXNjb3ZlckRhdGFPYmplY3RzUGVyR1VJRChndWlkVVJMLCBzY2hlbWEsIHJlc291cmNlcykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG4gICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCxcclxuICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6ICcvZGF0YU9iamVjdC9ndWlkLycgKyBndWlkVVJMLFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGlmKHNjaGVtYSB8fCByZXNvdXJjZXMpIHtcclxuICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7XHJcbiAgICAgICAgcmVzb3VyY2VzOiByZXNvdXJjZXMsXHJcbiAgICAgICAgZGF0YVNjaGVtZXM6IHNjaGVtYVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuXHJcbiAgICAgICAgaWYocmVwbHkuYm9keS5jb2RlID09PSAyMDApe1xyXG4gICAgICAgICAgbG9nLmxvZyhcIlJlcGx5IGxvZzogXCIscmVwbHkuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIGxvZy53YXJuKFwiW0Rpc2NvdmVyeS5kaXNjb3ZlckRhdGFPYmplY3RzUGVyR1VJRF0gRXJyb3IgUmVwbHkgZm9yIFwiICsgZ3VpZFVSTCArIFwiIFJlYXNvbjogXCIsIHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgcmVzb2x2ZShbXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IGRhdGFPYmplY3QgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZFxyXG4gICogcmV0dXJucyBkaXNjb3ZlcmVkT2JqZWN0LlxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZ3VpZFVSTCAgICAgICAgICAgICAgICBndWlkIFVSTCBlLmcgdXNlci1ndWlkOi8vPHVuaXF1ZS11c2VyLWlkZW50aWZpZXI+XHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBzY2hlbWEgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgaHlwZXJ0aWVzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKSAgICAgZG9tYWluIG9mIHRoZSByZWdpc3RyeSB0byBzZWFyY2hcclxuICAqL1xyXG4gIGRpc2NvdmVyRGF0YU9iamVjdHNQZXJHVUlERE8oZ3VpZFVSTCwgc2NoZW1hLCByZXNvdXJjZXMpIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICB0aGlzLmRpc2NvdmVyRGF0YU9iamVjdHNQZXJHVUlEKC4uLmFyZ3VtZW50cylcclxuICAgICAgICAudGhlbihyZWdpc3RyeU9iamVjdHMgPT4gcmVzb2x2ZSh0aGlzLl9jb252ZXJ0VG9EaXNjb3ZlcmVkT2JqZWN0KHJlZ2lzdHJ5T2JqZWN0cykpKVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiByZWplY3QoZXJyb3IpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqIEFkdmFuY2VkIFNlYXJjaCBmb3IgSHlwZXJ0aWVzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5XHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICB1c2VyICAgICAgICAgICAgICAgICAgdXNlciBpZGVudGlmaWVyLCBlaXRoZXIgaW4gdXJsIG9yIGVtYWlsIGZvcm1hdFxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICByZXNvdXJjZXMgKE9wdGlvbmFsKSAgdHlwZXMgb2YgaHlwZXJ0aWVzIHJlc291cmNlc1xyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZG9tYWluIChPcHRpb25hbCkgICAgIGRvbWFpbiBvZiB0aGUgcmVnaXN0cnkgdG8gc2VhcmNoXHJcbiAgKi9cclxuICBkaXNjb3Zlckh5cGVydGllcyh1c2VyLCBzY2hlbWEsIHJlc291cmNlcywgZG9tYWluKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGFjdGl2ZURvbWFpbjtcclxuICAgIGxldCBmaWx0ZXJlZEh5cGVydGllcyA9IFtdO1xyXG5cclxuICAgIGFjdGl2ZURvbWFpbiA9ICghZG9tYWluKSA/IF90aGlzLmRvbWFpbiA6IGRvbWFpbjtcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG4gICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCxcclxuICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6ICcvaHlwZXJ0eS91c2VyLycgKyB1c2VyLFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGlmKHNjaGVtYSB8fCByZXNvdXJjZXMpIHtcclxuICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7XHJcbiAgICAgICAgcmVzb3VyY2VzOiByZXNvdXJjZXMsXHJcbiAgICAgICAgZGF0YVNjaGVtZXM6IHNjaGVtYSxcclxuICAgICAgICBkb21haW46IGFjdGl2ZURvbWFpblxyXG4gICAgICB9O1xyXG4gICAgfWVsc2Uge1xyXG4gICAgICBtc2cuYm9keVsnY3JpdGVyaWEnXSA9IHtcclxuICAgICAgICBkb21haW46IGFjdGl2ZURvbWFpblxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgaWYgKCFfdGhpcy5faXNMZWdhY3lVc2VyKHVzZXIpKSB7Ly8gdG9kbzogdG8gcmVvbXZlIHdoZW4gZGlzY292ZXJ5IG9mIGxlZ2NheSB1c2VycyBhcmUgc3VwcG9ydGVkXHJcblxyXG4gICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuXHJcbiAgICAgICAgICBpZihyZXBseS5ib2R5LmNvZGUgPT09IDIwMCB8fCByZXBseS5ib2R5LmNvZGUgPT09IDUwMCl7XHJcbiAgICAgICAgICAgIHJlcGx5LmJvZHkudmFsdWUubWFwKGZ1bmN0aW9uKGh5cGVydHkpIHtcclxuICAgICAgICAgICAgICAgaWYoaHlwZXJ0eS5oeXBlcnR5SUQgIT0gX3RoaXMuZGlzY292ZXJ5VVJMKVxyXG4gICAgICAgICAgICAgICAgICAgZmlsdGVyZWRIeXBlcnRpZXMucHVzaChoeXBlcnR5KTtcclxuICAgICAgICAgICAgfSk7XHJcbi8qICAgICAgICAgICAgaWYoZmlsdGVyZWRIeXBlcnRpZXMubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICAgIHJlamVjdCgnTm8gSHlwZXJ0eSB3YXMgZm91bmQnKTtcclxuICAgICAgICAgICAgZWxzZSB7Ki9cclxuICAgICAgICAgICAgICBsb2cubG9nKFwiW0Rpc2NvdmVyeS5kaXNjb3Zlckh5cGVydGllc10gUmVwbHkgOiBcIixmaWx0ZXJlZEh5cGVydGllcyk7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShmaWx0ZXJlZEh5cGVydGllcyk7XHJcbi8vICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGxvZy53YXJuKFwiW0Rpc2NvdmVyeS5kaXNjb3Zlckh5cGVydGllc10gRXJyb3IgUmVwbHkgZm9yIFwiICsgdXNlciArIFwiIFJlYXNvbjogXCIsIHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICByZXNvbHZlKGZpbHRlcmVkSHlwZXJ0aWVzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNvbHZlKFt7aHlwZXJ0eUlEOiB1c2VyLCBzdGF0dXM6ICdsaXZlJ31dKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKiogQWR2YW5jZWQgU2VhcmNoIGZvciBIeXBlcnRpZXMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksXHJcbiAgKnJldHVybnMgRGlzY292ZXJlZE9iamVjdFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlciAgICAgICAgICAgICAgICAgIHVzZXIgaWRlbnRpZmllciwgZWl0aGVyIGluIHVybCBvciBlbWFpbCBmb3JtYXRcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBoeXBlcnRpZXMgc2NoZW1hc1xyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXNcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaFxyXG4gICovXHJcbiAgZGlzY292ZXJIeXBlcnRpZXNETyh1c2VyLCBzY2hlbWEsIHJlc291cmNlcywgZG9tYWluKSB7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgdGhpcy5kaXNjb3Zlckh5cGVydGllcyguLi5hcmd1bWVudHMpXHJcbiAgICAgIC50aGVuKGh5cGVydGllcyA9PiB7XHJcbiAgICAgICAgcmVzb2x2ZSh0aGlzLl9jb252ZXJ0VG9EaXNjb3ZlcmVkT2JqZWN0KGh5cGVydGllcykpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gcmVqZWN0KGVycm9yKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKiBBZHZhbmNlZCBTZWFyY2ggZm9yIERhdGFPYmplY3RzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5XHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICB1c2VyICAgICAgICAgICAgICAgICAgdXNlciBpZGVudGlmaWVyLCBlaXRoZXIgaW4gdXJsIG9yIGVtYWlsIGZvcm1hdFxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBkYXRhT2JqZWN0cyByZXNvdXJjZXNcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaFxyXG4gICovXHJcbiAgZGlzY292ZXJEYXRhT2JqZWN0cyh1c2VyLCBzY2hlbWEsIHJlc291cmNlcywgZG9tYWluKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGFjdGl2ZURvbWFpbjtcclxuXHJcbiAgICBhY3RpdmVEb21haW4gPSAoIWRvbWFpbikgPyBfdGhpcy5kb21haW4gOiBkb21haW47XHJcblxyXG4gICAgbGV0IG1zZyA9IHtcclxuICAgICAgdHlwZTogJ3JlYWQnLFxyXG4gICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsXHJcbiAgICAgIHRvOiBfdGhpcy5ydW50aW1lVVJMICsgJy9kaXNjb3ZlcnkvJyxcclxuICAgICAgYm9keToge1xyXG4gICAgICAgIHJlc291cmNlOiAnL2RhdGFPYmplY3QvdXNlci8nICsgdXNlcixcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpZihzY2hlbWEgfHwgcmVzb3VyY2VzKSB7XHJcbiAgICAgIG1zZy5ib2R5Wydjcml0ZXJpYSddID0ge1xyXG4gICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzLFxyXG4gICAgICAgIGRhdGFTY2hlbWVzOiBzY2hlbWEsXHJcbiAgICAgICAgZG9tYWluOiBhY3RpdmVEb21haW5cclxuICAgICAgfTtcclxuICAgIH1lbHNlIHtcclxuICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7XHJcbiAgICAgICAgZG9tYWluOiBhY3RpdmVEb21haW5cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuXHJcbiAgICAgICAgaWYocmVwbHkuYm9keS5jb2RlID09PSAyMDApe1xyXG4gICAgICAgICAgbG9nLmxvZyhcIlJlcGx5IFZhbHVlIExvZzogXCIscmVwbHkuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIGxvZy53YXJuKFwiW0Rpc2NvdmVyeS5kaXNjb3ZlckRhdGFPYmplY3RzXSBFcnJvciBSZXBseSBmb3IgXCIgKyB1c2VyICsgXCIgUmVhc29uOiBcIiwgcmVwbHkuYm9keS5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICByZXNvbHZlKFtdKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgZGF0YU9iamVjdCByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSwgYW5kXHJcbiAgKiByZXR1cm5zIGRpc2NvdmVyZWRPYmplY3QuXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICB1c2VyICAgICAgICAgICAgICAgICAgdXNlciBpZGVudGlmaWVyLCBlaXRoZXIgaW4gdXJsIG9yIGVtYWlsIGZvcm1hdFxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBkYXRhT2JqZWN0cyByZXNvdXJjZXNcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaFxyXG4gICovXHJcbiAgZGlzY292ZXJEYXRhT2JqZWN0c0RPKHVzZXIsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICB0aGlzLmRpc2NvdmVyRGF0YU9iamVjdHMoLi4uYXJndW1lbnRzKVxyXG4gICAgICAgIC50aGVuKHJlZ2lzdHJ5T2JqZWN0cyA9PiByZXNvbHZlKHRoaXMuX2NvbnZlcnRUb0Rpc2NvdmVyZWRPYmplY3QocmVnaXN0cnlPYmplY3RzKSkpXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IHJlamVjdChlcnJvcikpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgaHlwZXJ0aWVzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5LCBhbmRcclxuICAqIHJldHVybiB0aGUgaHlwZXJ0eSBpbmZvcm1hdGlvbiwgaWYgZm91bmQuXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgICB1cmwgIGh5cGVydHkgVVJMXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgZG9tYWluIChPcHRpb25hbClcclxuICAqL1xyXG4gIGRpc2NvdmVySHlwZXJ0eVBlclVSTCh1cmwsIGRvbWFpbikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBhY3RpdmVEb21haW47XHJcblxyXG4gICAgYWN0aXZlRG9tYWluID0gKCFkb21haW4pID8gX3RoaXMuZG9tYWluIDogZG9tYWluO1xyXG5cclxuICAgIGxldCBtc2cgPSB7XHJcbiAgICAgIHR5cGU6ICdyZWFkJyxcclxuICAgICAgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLFxyXG4gICAgICB0bzogX3RoaXMucnVudGltZVVSTCArICcvZGlzY292ZXJ5LycsXHJcbiAgICAgIGJvZHk6IHtcclxuICAgICAgICByZXNvdXJjZTogJy9oeXBlcnR5L3VybC8nICsgdXJsLFxyXG4gICAgICAgIGNyaXRlcmlhOiB7XHJcbiAgICAgICAgICBkb21haW46IGFjdGl2ZURvbWFpblxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcblxyXG4gICAgICAgIGlmKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKXtcclxuICAgICAgICAgIGxvZy5sb2coXCJSZXBseSBWYWx1ZSBMb2c6IFwiLHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBsb2cud2FybihcIltEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5UGVyVVJMXSBFcnJvciBSZXBseSBmb3IgXCIgKyB1cmwgKyBcIiBSZWFzb246IFwiLCByZXBseS5ib2R5LmRlc2NyaXB0aW9uKTtcclxuICAgICAgICAgIHJlc29sdmUoW10pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZnVuY3Rpb24gdG8gcmVxdWVzdCBhYm91dCBoeXBlcnRpZXMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZFxyXG4gICogcmV0dXJucyBkaXNjb3ZlcmVkT2JqZWN0LlxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgICAgdXJsICBoeXBlcnR5IFVSTFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpXHJcbiAgKi9cclxuICBkaXNjb3Zlckh5cGVydHlQZXJVUkxETyh1cmwsIGRvbWFpbikge1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHRoaXMuZGlzY292ZXJIeXBlcnR5UGVyVVJMKC4uLmFyZ3VtZW50cylcclxuICAgICAgICAudGhlbihoeXBlcnR5ID0+IHJlc29sdmUobmV3IERpc2NvdmVyZWRPYmplY3QoaHlwZXJ0eSwgdGhpcy5ydW50aW1lVVJMLCB0aGlzLmRpc2NvdmVyeVVSTCwgdGhpcy5tZXNzYWdlQnVzLCB0aGlzKSkpXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IHJlamVjdChlcnJvcikpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgZGF0YU9iamVjdCByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSwgYW5kXHJcbiAgKiByZXR1cm4gdGhlIGRhdGFPYmplY3QgaW5mb3JtYXRpb24sIGlmIGZvdW5kLlxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgICAgdXJsICBkYXRhT2JqZWN0IFVSTFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpXHJcbiAgKi9cclxuICBkaXNjb3ZlckRhdGFPYmplY3RQZXJVUkwodXJsLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG5cclxuICAgIGFjdGl2ZURvbWFpbiA9ICghZG9tYWluKSA/IF90aGlzLmRvbWFpbiA6IGRvbWFpbjtcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG4gICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCxcclxuICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6ICcvZGF0YU9iamVjdC91cmwvJyArIHVybCxcclxuICAgICAgICBjcml0ZXJpYToge1xyXG4gICAgICAgICAgZG9tYWluOiBhY3RpdmVEb21haW5cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIChyZXBseSkgPT4ge1xyXG5cclxuICAgICAgICBpZihyZXBseS5ib2R5LmNvZGUgPT09IDIwMCl7XHJcbiAgICAgICAgICBsb2cubG9nKFwiUmVwbHkgVmFsdWUgTG9nOiBcIixyZXBseS5ib2R5LnZhbHVlKTtcclxuICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgbG9nLndhcm4oXCJbRGlzY292ZXJ5LmRpc2NvdmVyRGF0YU9iamVjdFBlclVSTF0gRXJyb3IgUmVwbHkgZm9yIFwiICsgdXJsICsgXCIgUmVhc29uOiBcIiwgcmVwbHkuYm9keS5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICByZXNvbHZlKFtdKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgZGF0YU9iamVjdCByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSwgYW5kXHJcbiAgKiByZXR1cm5zIGRpc2NvdmVyZWRPYmplY3QuXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgICB1cmwgIGRhdGFPYmplY3QgVVJMXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgZG9tYWluIChPcHRpb25hbClcclxuICAqL1xyXG4gIGRpc2NvdmVyRGF0YU9iamVjdFBlclVSTERPKHVybCwgZG9tYWluKSB7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgdGhpcy5kaXNjb3ZlckRhdGFPYmplY3RQZXJVUkwoLi4uYXJndW1lbnRzKVxyXG4gICAgICAgIC50aGVuKHJlZ2lzdHJ5T2JqZWN0ID0+IHJlc29sdmUobmV3IERpc2NvdmVyZWRPYmplY3QocmVnaXN0cnlPYmplY3QsIHRoaXMucnVudGltZVVSTCwgdGhpcy5kaXNjb3ZlcnlVUkwsIHRoaXMubWVzc2FnZUJ1cywgdGhpcykpKVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiByZWplY3QoZXJyb3IpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IGFuIGRhdGFPYmplY3RzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IHdpdGggYSBnaXZlbiBuYW1lLCBhbmRcclxuICAqIHJldHVybiB0aGUgZGF0YU9iamVjdHMgaW5mb3JtYXRpb24sIGlmIGZvdW5kLlxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgICAgbmFtZSAgZGF0YU9iamVjdCBVUkxcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBkYXRhT2JqZWN0cyBzY2hlbWFzXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICByZXNvdXJjZXMgKE9wdGlvbmFsKSAgdHlwZXMgb2YgZGF0YU9iamVjdHMgcmVzb3VyY2VzXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgZG9tYWluIChPcHRpb25hbClcclxuICAqL1xyXG4gIGRpc2NvdmVyRGF0YU9iamVjdHNQZXJOYW1lKG5hbWUsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG5cclxuICAgIGFjdGl2ZURvbWFpbiA9ICghZG9tYWluKSA/IF90aGlzLmRvbWFpbiA6IGRvbWFpbjtcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG4gICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCxcclxuICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6ICcvZGF0YU9iamVjdC9uYW1lLycgKyBuYW1lXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYoc2NoZW1hIHx8IHJlc291cmNlcykge1xyXG4gICAgICBtc2cuYm9keVsnY3JpdGVyaWEnXSA9IHtcclxuICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcyxcclxuICAgICAgICBkYXRhU2NoZW1lczogc2NoZW1hLFxyXG4gICAgICAgIGRvbWFpbjogYWN0aXZlRG9tYWluXHJcbiAgICAgIH07XHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgIG1zZy5ib2R5Wydjcml0ZXJpYSddID0ge1xyXG4gICAgICAgIGRvbWFpbjogYWN0aXZlRG9tYWluXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcblxyXG4gICAgICAgIGlmKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKXtcclxuICAgICAgICAgIGxvZy5sb2coXCJSZXBseSBWYWx1ZSBMb2c6IFwiLHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBsb2cud2FybihcIltEaXNjb3ZlcnkuZGlzY292ZXJEYXRhT2JqZWN0c1Blck5hbWVdIEVycm9yIFJlcGx5IGZvciBcIiArIG5hbWUgKyBcIiBSZWFzb246IFwiLCByZXBseS5ib2R5LmRlc2NyaXB0aW9uKTtcclxuICAgICAgICAgIHJlc29sdmUoW10pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZnVuY3Rpb24gdG8gcmVxdWVzdCBhYm91dCBkYXRhT2JqZWN0IHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5LCBhbmRcclxuICAqIHJldHVybnMgZGlzY292ZXJlZE9iamVjdC5cclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgICAgIG5hbWUgIGRhdGFPYmplY3QgVVJMXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBzY2hlbWEgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgZGF0YU9iamVjdHMgc2NoZW1hc1xyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHJlc291cmNlc1xyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpXHJcbiAgKi9cclxuICBkaXNjb3ZlckRhdGFPYmplY3RzUGVyTmFtZURPKG5hbWUsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICB0aGlzLmRpc2NvdmVyRGF0YU9iamVjdHNQZXJOYW1lKC4uLmFyZ3VtZW50cylcclxuICAgICAgICAudGhlbihyZWdpc3RyeU9iamVjdHMgPT4gcmVzb2x2ZSh0aGlzLl9jb252ZXJ0VG9EaXNjb3ZlcmVkT2JqZWN0KHJlZ2lzdHJ5T2JqZWN0cykpKVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiByZWplY3QoZXJyb3IpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IHNwZWNpZmljIHJlcG9ydGVyIGRhdGFPYmplY3QgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZFxyXG4gICogcmV0dXJuIHRoZSBkYXRhT2JqZWN0cyBmcm9tIHRoYXQgcmVwb3J0ZXIuXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICByZXBvcnRlciAgICAgZGF0YU9iamVjdCByZXBvcnRlclxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBkYXRhT2JqZWN0cyByZXNvdXJjZXNcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAgICAgICAoT3B0aW9uYWwpXHJcbiAgKi9cclxuICBkaXNjb3ZlckRhdGFPYmplY3RzUGVyUmVwb3J0ZXIocmVwb3J0ZXIsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG5cclxuICAgIGFjdGl2ZURvbWFpbiA9ICghZG9tYWluKSA/IF90aGlzLmRvbWFpbiA6IGRvbWFpbjtcclxuXHJcblxyXG4gICAgbGV0IG1zZyA9IHtcclxuICAgICAgdHlwZTogJ3JlYWQnLFxyXG4gICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsXHJcbiAgICAgIHRvOiBfdGhpcy5ydW50aW1lVVJMICsgJy9kaXNjb3ZlcnkvJyxcclxuICAgICAgYm9keToge1xyXG4gICAgICAgIHJlc291cmNlOiAnL2RhdGFPYmplY3QvcmVwb3J0ZXIvJyArIHJlcG9ydGVyXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYoc2NoZW1hIHx8IHJlc291cmNlcykge1xyXG4gICAgICBtc2cuYm9keVsnY3JpdGVyaWEnXSA9IHtcclxuICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcyxcclxuICAgICAgICBkYXRhU2NoZW1lczogc2NoZW1hLFxyXG4gICAgICAgIGRvbWFpbjogYWN0aXZlRG9tYWluXHJcbiAgICAgIH07XHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgIG1zZy5ib2R5Wydjcml0ZXJpYSddID0ge1xyXG4gICAgICAgIGRvbWFpbjogYWN0aXZlRG9tYWluXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcblxyXG4gICAgICAgIGlmKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKXtcclxuICAgICAgICAgIGxvZy5sb2coXCJSZXBseSBWYWx1ZSBMb2c6IFwiLHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBsb2cud2FybihcIltEaXNjb3ZlcnkuZGlzY292ZXJEYXRhT2JqZWN0c1Blck5hbWVdIEVycm9yIFJlcGx5IGZvciBcIiArIHJlcG9ydGVyICsgXCIgUmVhc29uOiBcIiwgcmVwbHkuYm9keS5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICByZXNvbHZlKFtdKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgZGF0YU9iamVjdCByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSwgYW5kXHJcbiAgKiByZXR1cm5zIGRpc2NvdmVyZWRPYmplY3QuXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgICBuYW1lICBkYXRhT2JqZWN0IFVSTFxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBkYXRhT2JqZWN0cyByZXNvdXJjZXNcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKVxyXG4gICovXHJcbiAgZGlzY292ZXJEYXRhT2JqZWN0c1BlclJlcG9ydGVyRE8ocmVwb3J0ZXIsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICB0aGlzLmRpc2NvdmVyRGF0YU9iamVjdHNQZXJSZXBvcnRlciguLi5hcmd1bWVudHMpXHJcbiAgICAgICAgLnRoZW4ocmVnaXN0cnlPYmplY3RzID0+IHJlc29sdmUodGhpcy5fY29udmVydFRvRGlzY292ZXJlZE9iamVjdChyZWdpc3RyeU9iamVjdHMpKSlcclxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4gcmVqZWN0KGVycm9yKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9jb252ZXJ0VG9EaXNjb3ZlcmVkT2JqZWN0KHJlZ2lzdHJ5T2JqZWN0cykge1xyXG4gICAgcmV0dXJuIHJlZ2lzdHJ5T2JqZWN0cy5tYXAoKHJlZ2lzdHJ5T2JqZWN0KSA9PiB7XHJcbiAgICAgIHJldHVybiBuZXcgRGlzY292ZXJlZE9iamVjdChyZWdpc3RyeU9iamVjdCwgdGhpcy5ydW50aW1lVVJMLCB0aGlzLmRpc2NvdmVyeVVSTCwgdGhpcy5tZXNzYWdlQnVzLCB0aGlzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqIEFkdmFuY2VkIFNlYXJjaCBmb3IgZGF0YU9iamVjdHMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnlcclxuICAqIEBkZXByZWNhdGVkIERlcHJlY2F0ZWQuIFVzZSBkaXNjb3ZlckRhdGFPYmplY3RzUGVyTmFtZSBpbnN0ZWFkXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBuYW1lICAgICAgICAgICAgICAgICAgbmFtZSBvZiB0aGUgZGF0YU9iamVjdFxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3Qgc2NoZW1hc1xyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGRhdGFPYmplY3QgcmVzb3VyY2VzXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKSAgICAgZG9tYWluIG9mIHRoZSByZWdpc3RyeSB0byBzZWFyY2hcclxuICAqL1xyXG4gIGRpc2NvdmVyRGF0YU9iamVjdChuYW1lLCBzY2hlbWEsIHJlc291cmNlcywgZG9tYWluKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGFjdGl2ZURvbWFpbjtcclxuICAgIC8vbGV0IHVzZXJJZGVudGlmaWVyID0gY29udmVydFRvVXNlclVSTCh1c2VyKTtcclxuXHJcbiAgICBhY3RpdmVEb21haW4gPSAoIWRvbWFpbikgPyBfdGhpcy5kb21haW4gOiBkb21haW47XHJcblxyXG4gICAgbGV0IG1zZyA9IHtcclxuICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIGFjdGl2ZURvbWFpbiwgYm9keTogeyByZXNvdXJjZTogbmFtZSxcclxuICAgICAgY3JpdGVyaWE6IHtyZXNvdXJjZXM6IHJlc291cmNlcywgZGF0YVNjaGVtZXM6IHNjaGVtYX1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmxvZygnW0Rpc2NvdmVyeV0nLCByZXBseSlcclxuXHJcbiAgICAgICAgaWYocmVwbHkuYm9keS5jb2RlPjI5OSkge1xyXG4gICAgICAgICAgbG9nLndhcm4oXCJbRGlzY292ZXJ5LmRpc2NvdmVyRGF0YU9iamVjdF0gRXJyb3IgUmVwbHkgZm9yIFwiICsgbmFtZSArIFwiIFJlYXNvbjogXCIsIHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUoW10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGh5cGVydGllcyA9IHJlcGx5LmJvZHkudmFsdWU7XHJcblxyXG4gICAgICAgIGlmIChoeXBlcnRpZXMpIHtcclxuICAgICAgICAgIHJlc29sdmUoaHlwZXJ0aWVzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzb2x2ZShbXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqIEFkdmFuY2VkIFNlYXJjaCBmb3IgSHlwZXJ0aWVzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5XHJcbiAgKiBAZGVwcmVjYXRlZCBEZXByZWNhdGVkLiBVc2UgZGlzY292ZXJIeXBlcnRpZXMgaW5zdGVhZFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlciAgICAgICAgICAgICAgICAgIHVzZXIgaWRlbnRpZmllciwgZWl0aGVyIGluIHVybCBvciBlbWFpbCBmb3JtYXRcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBoeXBlcnRpZXMgc2NoZW1hc1xyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXNcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaFxyXG4gICovXHJcbiAgZGlzY292ZXJIeXBlcnR5KHVzZXIsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG4gICAgbGV0IHVzZXJJZGVudGlmaWVyID0gY29udmVydFRvVXNlclVSTCh1c2VyKTtcclxuXHJcbiAgICBpZiAoIWRvbWFpbikge1xyXG4gICAgICBhY3RpdmVEb21haW4gPSBfdGhpcy5kb21haW47XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhY3RpdmVEb21haW4gPSBkb21haW47XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbG9nLmxvZygnW0Rpc2NvdmVyeS5kaXNjb3Zlckh5cGVydHldIEFDVElWRSBET01BSU4gLT4gJywgYWN0aXZlRG9tYWluLCAndXNlci0+JywgdXNlciwgJ3NjaGVtYS0+Jywgc2NoZW1hLCAncmVzb3VyY2VzLT4nLCByZXNvdXJjZXMsICdkb21haW4tPicsIGRvbWFpbik7XHJcbiAgICAgIGlmICh1c2VyLmluY2x1ZGVzKCc6JykgJiYgIXVzZXIuaW5jbHVkZXMoJ3VzZXI6Ly8nKSkge1xyXG4gICAgICAgIGxvZy5sb2coJ1tEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5XSAnICsgdXNlciArICcgaXMgbGVnYWN5IGRvbWFpbicpO1xyXG4gICAgICAgIGxldCBsZWdhY3lVc2VyID0geyB1c2VySUQ6IHVzZXIsIGh5cGVydHlJRDogdXNlciwgc2NoZW1hOiBzY2hlbWEsIHJlc291cmNlczogcmVzb3VyY2VzIH07XHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUobGVnYWN5VXNlcik7XHJcbiAgICAgIH1cclxuICAgICAgbGV0IG1zZyA9IHtcclxuICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluLCBib2R5OiB7IHJlc291cmNlOiB1c2VySWRlbnRpZmllcixcclxuICAgICAgICBjcml0ZXJpYToge3Jlc291cmNlczogcmVzb3VyY2VzLCBkYXRhU2NoZW1lczogc2NoZW1hfVxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIGxvZy5pbmZvKCdbRGlzY292ZXJ5XSBtc2cgdG8gc2VuZC0+JywgbXNnKTtcclxuXHJcbiAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuXHJcbiAgICAgICAgbG9nLmluZm8oJ1tEaXNjb3ZlcnldIE9OIGRpc2NvdmVySHlwZXJ0eS0+JywgcmVwbHkpO1xyXG4gICAgICAgIGxldCBoeXBlcnRpZXMgPSByZXBseS5ib2R5LnZhbHVlO1xyXG5cclxuICAgICAgICBpZiAoaHlwZXJ0aWVzKSB7XHJcbiAgICAgICAgICByZXNvbHZlKGh5cGVydGllcyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlamVjdCgnTm8gSHlwZXJ0eSB3YXMgZm91bmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgdXNlcnMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZFxyXG4gICogcmV0dXJuIHRoZSBsYXN0IGh5cGVydHkgaW5zdGFuY2UgcmVnaXN0ZXJlZCBieSB0aGUgdXNlci5cclxuICAqIEBkZXByZWNhdGVkIERlcHJlY2F0ZWQuIFVzZSBkaXNjb3Zlckh5cGVydHkgaW5zdGVhZFxyXG4gICogQHBhcmFtICB7ZW1haWx9ICAgICAgICAgICAgICBlbWFpbFxyXG4gICogQHBhcmFtICB7ZG9tYWlufSAgICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpXHJcbiAgKi9cclxuICBkaXNjb3Zlckh5cGVydHlQZXJVc2VyKGVtYWlsLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIC8vIEhhY2sgZm9yIGxlZ2FjeSB1c2Vyc1xyXG4gICAgICBpZiAoZW1haWwuaW5jbHVkZXMoJzonKSAmJiAhZW1haWwuaW5jbHVkZXMoJ3VzZXI6Ly8nKSkge1xyXG4gICAgICAgIGxvZy5sb2coJ1tEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5XSAnICsgZW1haWwgKydpcyBsZWdhY3kgZG9tYWluJyk7XHJcbiAgICAgICAgbGV0IGxlZ2FjeVVzZXIgPSB7IGlkOiBlbWFpbCwgaHlwZXJ0eVVSTDogZW1haWwsIGRlc2NyaXB0b3I6ICd1bmtub3duJyB9O1xyXG4gICAgICAgIHJldHVybiByZXNvbHZlKGxlZ2FjeVVzZXIpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIWRvbWFpbikge1xyXG4gICAgICAgIGFjdGl2ZURvbWFpbiA9IF90aGlzLmRvbWFpbjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhY3RpdmVEb21haW4gPSBkb21haW47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBpZGVudGl0eVVSTCA9ICd1c2VyOi8vJyArIGVtYWlsLnN1YnN0cmluZyhlbWFpbC5pbmRleE9mKCdAJykgKyAxLCBlbWFpbC5sZW5ndGgpICsgJy8nICsgZW1haWwuc3Vic3RyaW5nKDAsIGVtYWlsLmluZGV4T2YoJ0AnKSk7XHJcblxyXG5cclxuICAgICAgLy8gbWVzc2FnZSB0byBxdWVyeSBkb21haW4gcmVnaXN0cnksIGFza2luZyBmb3IgYSB1c2VyIGh5cGVydHkuXHJcbiAgICAgIGxldCBtZXNzYWdlID0ge1xyXG4gICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLCB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBhY3RpdmVEb21haW4sIGJvZHk6IHsgcmVzb3VyY2U6IGlkZW50aXR5VVJMfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgbG9nLmluZm8oJ1tEaXNjb3ZlcnldIE1lc3NhZ2U6ICcsIG1lc3NhZ2UsIGFjdGl2ZURvbWFpbiwgaWRlbnRpdHlVUkwpO1xyXG5cclxuICAgICAgLy9sb2cuaW5mbygnW0Rpc2NvdmVyeV0gbWVzc2FnZSBSRUFEJywgbWVzc2FnZSk7XHJcblxyXG4gICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIChyZXBseSkgPT4ge1xyXG4gICAgICAgIGxvZy5pbmZvKCdbRGlzY292ZXJ5XSBtZXNzYWdlIHJlcGx5JywgcmVwbHkpO1xyXG5cclxuICAgICAgICBsZXQgaHlwZXJ0eTtcclxuICAgICAgICBsZXQgbW9zdFJlY2VudDtcclxuICAgICAgICBsZXQgbGFzdEh5cGVydHk7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gcmVwbHkuYm9keS52YWx1ZTtcclxuXHJcbiAgICAgICAgZm9yIChoeXBlcnR5IGluIHZhbHVlKSB7XHJcbiAgICAgICAgICBpZiAodmFsdWVbaHlwZXJ0eV0ubGFzdE1vZGlmaWVkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgaWYgKG1vc3RSZWNlbnQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgIG1vc3RSZWNlbnQgPSBuZXcgRGF0ZSh2YWx1ZVtoeXBlcnR5XS5sYXN0TW9kaWZpZWQpO1xyXG4gICAgICAgICAgICAgIGxhc3RIeXBlcnR5ID0gaHlwZXJ0eTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBsZXQgaHlwZXJ0eURhdGUgPSBuZXcgRGF0ZSh2YWx1ZVtoeXBlcnR5XS5sYXN0TW9kaWZpZWQpO1xyXG4gICAgICAgICAgICAgIGlmIChtb3N0UmVjZW50LmdldFRpbWUoKSA8IGh5cGVydHlEYXRlLmdldFRpbWUoKSkge1xyXG4gICAgICAgICAgICAgICAgbW9zdFJlY2VudCA9IGh5cGVydHlEYXRlO1xyXG4gICAgICAgICAgICAgICAgbGFzdEh5cGVydHkgPSBoeXBlcnR5O1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9nLmluZm8oJ1tEaXNjb3ZlcnldIExhc3QgSHlwZXJ0eTogJywgbGFzdEh5cGVydHksIG1vc3RSZWNlbnQpO1xyXG5cclxuICAgICAgICBsZXQgaHlwZXJ0eVVSTCA9IGxhc3RIeXBlcnR5O1xyXG5cclxuICAgICAgICBpZiAoaHlwZXJ0eVVSTCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KCdVc2VyIEh5cGVydHkgbm90IGZvdW5kJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaWRQYWNrYWdlID0ge1xyXG4gICAgICAgICAgaWQ6IGVtYWlsLFxyXG4gICAgICAgICAgZGVzY3JpcHRvcjogdmFsdWVbaHlwZXJ0eVVSTF0uZGVzY3JpcHRvcixcclxuICAgICAgICAgIGh5cGVydHlVUkw6IGh5cGVydHlVUkxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsb2cuaW5mbygnW0Rpc2NvdmVyeV0gPT09PiBoeXBlcnR5RGlzY292ZXJ5IG1lc3NhZ2VCdW5kbGU6ICcsIGlkUGFja2FnZSk7XHJcbiAgICAgICAgcmVzb2x2ZShpZFBhY2thZ2UpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IHVzZXJzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5LCBhbmRcclxuICAqIHJldHVybiB0aGUgYWxsIHRoZSBoeXBlcnRpZXMgcmVnaXN0ZXJlZCBieSB0aGUgdXNlclxyXG4gICogQGRlcHJlY2F0ZWQgRGVwcmVjYXRlZC4gVXNlIGRpc2NvdmVySHlwZXJ0eSBpbnN0ZWFkXHJcbiAgKiBAcGFyYW0gIHtlbWFpbH0gICAgICAgICAgICAgIGVtYWlsXHJcbiAgKiBAcGFyYW0gIHtkb21haW59ICAgICAgICAgICAgZG9tYWluIChPcHRpb25hbClcclxuICAqL1xyXG4gIGRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlcihlbWFpbCwgZG9tYWluKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGFjdGl2ZURvbWFpbjtcclxuICAgIGxvZy5sb2coJ29uIEZ1bmN0aW9uLT4nLCBlbWFpbCk7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBpZiAoZW1haWwuaW5jbHVkZXMoJzonKSAmJiAhZW1haWwuaW5jbHVkZXMoJ3VzZXI6Ly8nKSkge1xyXG4gICAgICAgIGxvZy5sb2coJ1tEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5XSBpcyBsZWdhY3kgZG9tYWluJyk7XHJcbiAgICAgICAgbGV0IGxlZ2FjeVVzZXIgPSB7IHVzZXJJRDogZW1haWwsIGh5cGVydHlJRDogZW1haWwsIHNjaGVtYTogc2NoZW1hLCByZXNvdXJjZXM6IHJlc291cmNlcyB9O1xyXG4gICAgICAgIHJldHVybiByZXNvbHZlKGxlZ2FjeVVzZXIpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIWRvbWFpbikge1xyXG4gICAgICAgIGFjdGl2ZURvbWFpbiA9IF90aGlzLmRvbWFpbjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhY3RpdmVEb21haW4gPSBkb21haW47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBpZGVudGl0eVVSTCA9ICd1c2VyOi8vJyArIGVtYWlsLnN1YnN0cmluZyhlbWFpbC5pbmRleE9mKCdAJykgKyAxLCBlbWFpbC5sZW5ndGgpICsgJy8nICsgZW1haWwuc3Vic3RyaW5nKDAsIGVtYWlsLmluZGV4T2YoJ0AnKSk7XHJcblxyXG4gICAgICAvLyBtZXNzYWdlIHRvIHF1ZXJ5IGRvbWFpbiByZWdpc3RyeSwgYXNraW5nIGZvciBhIHVzZXIgaHlwZXJ0eS5cclxuICAgICAgbGV0IG1lc3NhZ2UgPSB7XHJcbiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIGFjdGl2ZURvbWFpbiwgYm9keTogeyByZXNvdXJjZTogaWRlbnRpdHlVUkx9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBsb2cubG9nKCdbRGlzY292ZXJ5XSBNZXNzYWdlIGRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlcjogJywgbWVzc2FnZSwgYWN0aXZlRG9tYWluLCBpZGVudGl0eVVSTCk7XHJcblxyXG4gICAgICAvL2xvZy5pbmZvKCdbRGlzY292ZXJ5XSBtZXNzYWdlIFJFQUQnLCBtZXNzYWdlKTtcclxuXHJcbiAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmluZm8oJ1tEaXNjb3ZlcnldIGRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlciByZXBseScsIHJlcGx5KTtcclxuXHJcbiAgICAgICAgbGV0IHZhbHVlID0gcmVwbHkuYm9keS52YWx1ZTtcclxuXHJcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHJlamVjdCgnVXNlciBIeXBlcnR5IG5vdCBmb3VuZCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgdXNlcnMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZFxyXG4gICogcmV0dXJuIHRoZSBhbGwgdGhlIGh5cGVydGllcyByZWdpc3RlcmVkIGJ5IHRoZSB1c2VyXHJcbiAgKiBAZGVwcmVjYXRlZCBEZXByZWNhdGVkLiBVc2UgZGlzY292ZXJIeXBlcnR5IGluc3RlYWRcclxuICAqIEBwYXJhbSAge2VtYWlsfSAgICAgICAgICAgICAgZW1haWxcclxuICAqIEBwYXJhbSAge2RvbWFpbn0gICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKVxyXG4gICovXHJcbiAgcmVzdW1lRGlzY292ZXJpZXMoKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsb2cubG9nKCdbRGlzY292ZXJ5XSByZXN1bWVEaXNjb3ZlcmllcycpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGxldCBtc2cgPSB7XHJcbiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsIHRvOiBfdGhpcy5ydW50aW1lVVJMICsgJy9zdWJzY3JpcHRpb25zJywgYm9keTogeyByZXNvdXJjZTogX3RoaXMuZGlzY292ZXJ5VVJMfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIChyZXBseSk9PntcclxuICAgICAgICBsb2cubG9nKCdbRGlzY292ZXJ5LnJlc3VtZURpc2NvdmVyaWVzXSByZXBseTogJywgcmVwbHkpO1xyXG5cclxuICAgICAgICBsZXQgbm90aWZpY2F0aW9ucyA9IFtdO1xyXG5cclxuICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHtcclxuICAgICAgICAgIGxldCB1cmxzID0gcmVwbHkuYm9keS52YWx1ZTsvLyBVUkxzIHRvIGFkZCBsaXN0ZW5lcnMgdG9cclxuXHJcbiAgICAgICAgICAvL2xldHMgY3JlYXRlIG9uZSBEaXNjb3ZlcnlPYmplY3QgcGVyIG5vdGlmaWNhdGlvblxyXG4gICAgICAgICAgdXJscy5mb3JFYWNoKCh1cmwpID0+IHtcclxuICAgICAgICAgICAgbGV0IG9iamVjdFVybCA9IHVybC5zcGxpdCgnL3JlZ2lzdHJhdGlvbicpWzBdO1xyXG4gICAgICAgICAgICBsZXQgZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICBkYXRhLnVybCA9IG9iamVjdFVybDtcclxuICAgICAgICAgICAgbG9nLmxvZygnW0Rpc2NvdmVyeS5yZXN1bWVEaXNjb3Zlcmllc10gYWRkaW5nIGxpc3RlbmVyIHRvOiAnLCBvYmplY3RVcmwpO1xyXG5cclxuICAgICAgICAgICAgaWYgKG9iamVjdFVybC5pbmNsdWRlcygnaHlwZXJ0eTovLycpKSB7XHJcbiAgICAgICAgICAgICAgbm90aWZpY2F0aW9ucy5wdXNoKF90aGlzLmRpc2NvdmVySHlwZXJ0eVBlclVSTERPKG9iamVjdFVybCkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIG5vdGlmaWNhdGlvbnMucHVzaChfdGhpcy5kaXNjb3ZlckRhdGFPYmplY3RQZXJVUkxETyhvYmplY3RVcmwpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBQcm9taXNlLmFsbChub3RpZmljYXRpb25zKS50aGVuKHZhbHVlcz0+eyByZXNvbHZlKHZhbHVlcyk7IH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXNvbHZlKFtdKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IERpc2NvdmVyeTtcclxuIiwiY2xhc3MgU2VhcmNoIHtcclxuXHJcbiAgY29uc3RydWN0b3IoZGlzY292ZXJ5LCBpZGVudGl0eU1hbmFnZXIpIHtcclxuXHJcbiAgICBpZiAoIWRpc2NvdmVyeSkgdGhyb3cgbmV3IEVycm9yKCdUaGUgZGlzY292ZXJ5IGNvbXBvbmVudCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTtcclxuICAgIGlmICghaWRlbnRpdHlNYW5hZ2VyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBpZGVudGl0eU1hbmFnZXIgY29tcG9uZW50IGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuZGlzY292ZXJ5ID0gZGlzY292ZXJ5O1xyXG4gICAgX3RoaXMuaWRlbnRpdHlNYW5hZ2VyID0gaWRlbnRpdHlNYW5hZ2VyO1xyXG5cclxuICB9XHJcblxyXG4gIG15SWRlbnRpdHkoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIF90aGlzLmlkZW50aXR5TWFuYWdlci5kaXNjb3ZlclVzZXJSZWdpc3RlcmVkKCkudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGh5cGVydGllcyh1c2Vycywgc2NoZW1lcywgcmVzb3VyY2VzLCBnbG9iYWxGbGFnID0gZmFsc2UpIHtcclxuICAgIC8vVE9ETzogcmV1c2UgdXNlcnMgb3IgdGhlIG90aGVyIHdheSBhcm91bmRcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMaXN0IG9mIHVzZXJzVVJMIHRvIHNlYXJjaFxyXG4gICAqIEBwYXJhbSAge2FycmF5PFVSTC51c2VyVVJMPn0gIHVzZXJzIExpc3Qgb2YgVXNlclVSLCBsaWtlIHRoaXMgZm9ybWF0IHVzZXI6Ly88aXBkZG9tYWluPi88dXNlci1pZGVudGlmaWVyPlxyXG4gICAqIEByZXR1cm4ge1Byb21pc2V9XHJcbiAgICovXHJcbiAgdXNlcnModXNlcnNVUkxzLCBwcm92aWRlZERvbWFpbnMsIHNjaGVtZXMsIHJlc291cmNlcywgZ2xvYmFsRmxhZyA9IGZhbHNlKSB7XHJcblxyXG4gICAgaWYgKCF1c2Vyc1VSTHMpIHRocm93IG5ldyBFcnJvcignWW91IG5lZWQgdG8gcHJvdmlkZSBhIGxpc3Qgb2YgdXNlcnMnKTtcclxuICAgIGlmICghcHJvdmlkZWREb21haW5zKSB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBuZWVkIHRvIHByb3ZpZGUgYSBsaXN0IG9mIGRvbWFpbnMnKTtcclxuICAgIGlmICghcmVzb3VyY2VzKSB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBuZWVkIHRvIHByb3ZpZGUgYSBsaXN0IG9mIHJlc291cmNlcycpO1xyXG4gICAgaWYgKCFzY2hlbWVzKSB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBuZWVkIHRvIHByb3ZpZGUgYSBsaXN0IG9mIHNjaGVtZXMnKTtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGNvbnNvbGUuaW5mbygnW1NlYXJjaF0gVXNlcnM6ICcsIHVzZXJzVVJMcywgdXNlcnNVUkxzLmxlbmd0aCk7XHJcbiAgICAgIGNvbnNvbGUuaW5mbygnW1NlYXJjaF0gRG9tYWluczogJywgcHJvdmlkZWREb21haW5zLCBwcm92aWRlZERvbWFpbnMubGVuZ3RoKTtcclxuICAgICAgaWYgKHVzZXJzVVJMcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBjb25zb2xlLmluZm8oJ0RvblxcJ3QgaGF2ZSB1c2VycyB0byBkaXNjb3ZlcnknKTtcclxuICAgICAgICByZXNvbHZlKHVzZXJzVVJMcyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IGdldFVzZXJzID0gW107XHJcblxyXG4gICAgICAgIHVzZXJzVVJMcy5mb3JFYWNoKCh1c2VyVVJMLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgbGV0IGN1cnJlbnREb21haW4gPSBwcm92aWRlZERvbWFpbnNbaW5kZXhdO1xyXG4gICAgICAgICAgY29uc29sZS5pbmZvKCdbU2VhcmNoXSBTZWFyY2ggdXNlciAnICsgdXNlclVSTCArICcgZm9yIHByb3ZpZGVkIGRvbWFpbjonLCBjdXJyZW50RG9tYWluKTtcclxuICAgICAgICAgIGlmICghZ2xvYmFsRmxhZykge1xyXG4gICAgICAgICAgICBnZXRVc2Vycy5wdXNoKF90aGlzLmRpc2NvdmVyeS5kaXNjb3Zlckh5cGVydGllcyh1c2VyVVJMLCBzY2hlbWVzLCByZXNvdXJjZXMsIGN1cnJlbnREb21haW4pKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGdldFVzZXJzLnB1c2goX3RoaXMuZGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlclByb2ZpbGVEYXRhKHVzZXJVUkwsIHNjaGVtZXMsIHJlc291cmNlcykpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdSZXF1ZXN0cyBwcm9taXNlczogJywgZ2V0VXNlcnMpO1xyXG5cclxuICAgICAgICBQcm9taXNlLmFsbChnZXRVc2Vycy5tYXAoKHByb21pc2UpID0+IHtcclxuICAgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oKGh5cGVydHkpID0+IHsgcmV0dXJuIGh5cGVydHk7IH0sIChlcnJvcikgPT4geyByZXR1cm4gZXJyb3I7IH0pO1xyXG4gICAgICAgIH0pKS50aGVuKChoeXBlcnRpZXMpID0+IHtcclxuXHJcbiAgICAgICAgICBjb25zb2xlLmluZm8oJ1tTZWFyY2hdIEh5cGVydGllcyBmcm9tIG5ldyBEaXNjb3ZlcnknLCBoeXBlcnRpZXMpO1xyXG4gICAgICAgICAgbGV0IHJlc3VsdCA9IGh5cGVydGllcy5tYXAoZnVuY3Rpb24oaHlwZXJ0eSkge1xyXG5cclxuICAgICAgICAgICAgaWYgKGh5cGVydHkuaGFzT3duUHJvcGVydHkoJ2h5cGVydHlJRCcpKVxyXG4gICAgICAgICAgICAgIHJldHVybiBoeXBlcnR5O1xyXG4gICAgICAgICAgICBsZXQgcmVjZW50ID0gT2JqZWN0LmtleXMoaHlwZXJ0eSkucmVkdWNlUmlnaHQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgICAgICAgIGxldCBoeXBlcnR5RGF0ZSA9IG5ldyBEYXRlKGh5cGVydHlbYl0ubGFzdE1vZGlmaWVkKTtcclxuICAgICAgICAgICAgICBsZXQgaHlwZXJ0eURhdGVQID0gbmV3IERhdGUoaHlwZXJ0eVthXS5sYXN0TW9kaWZpZWQpO1xyXG4gICAgICAgICAgICAgIGlmIChoeXBlcnR5RGF0ZVAuZ2V0VGltZSgpIDwgaHlwZXJ0eURhdGUuZ2V0VGltZSgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYjtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGE7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGh5cGVydHlbcmVjZW50XTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGxldCBjbGVhbiA9IHJlc3VsdC5maWx0ZXIoKGh5cGVydHkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGh5cGVydHkuaGFzT3duUHJvcGVydHkoJ2h5cGVydHlJRCcpO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1JlcXVlc3RzIHJlc3VsdDogJywgY2xlYW4pO1xyXG5cclxuICAgICAgICAgIGh5cGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKGVudHJ5KSB7XHJcbiAgICAgICAgICAgIGlmIChlbnRyeSAhPT0gJ05vIEh5cGVydHkgd2FzIGZvdW5kJykge1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGNsZWFuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgcmVqZWN0KCdObyBIeXBlcnR5IHdhcyBmb3VuZCcpO1xyXG5cclxuICAgICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgICByZXNvbHZlKHVzZXJzVVJMcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgU2VhcmNoO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcbi8qKlxyXG4gKiBFdmVudEVtaXR0ZXJcclxuICogQWxsIGNsYXNzZXMgd2hpY2ggZXh0ZW5kcyB0aGlzLCBjYW4gaGF2ZSBhZGRFdmVudExpc3RlbmVyIGFuZCB0cmlnZ2VyIGV2ZW50cztcclxuICovXHJcbmNsYXNzIEV2ZW50RW1pdHRlciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIGFkZEV2ZW50TGlzdGVuZXIgbGlzdGVuIGZvciBhbiBldmVudFR5cGVcclxuICAgKiBAcGFyYW0gIHtzdHJpbmd9ICAgICAgICAgZXZlbnRUeXBlIC0gbGlzdGVuaW5nIGZvciB0aGlzIHR5cGUgb2YgZXZlbnRcclxuICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gICAgICAgY2IgICAgICAgIC0gY2FsbGJhY2sgZnVuY3Rpb24gd2lsbCBiZSBleGVjdXRlZCB3aGVuIHRoZSBldmVudCBpdCBpcyBpbnZva2VkXHJcbiAgICovXHJcbiAgYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGNiKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXNbZXZlbnRUeXBlXSA9IGNiO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW52b2tlIHRoZSBldmVudFR5cGVcclxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IGV2ZW50VHlwZSAtIGV2ZW50IHdpbGwgYmUgaW52b2tlZFxyXG4gICAqIEBwYXJhbSAge29iamVjdH0gcGFyYW1zIC0gcGFyYW1ldGVycyB3aWxsIGJlIHBhc3NlZCB0byB0aGUgYWRkRXZlbnRMaXN0ZW5lclxyXG4gICAqL1xyXG4gIHRyaWdnZXIoZXZlbnRUeXBlLCBwYXJhbXMpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgaWYgKF90aGlzW2V2ZW50VHlwZV0pIHtcclxuICAgICAgX3RoaXNbZXZlbnRUeXBlXShwYXJhbXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEV2ZW50RW1pdHRlcjtcclxuIiwiLy9pbXBvcnQgSWRlbnRpdHlNYW5hZ2VyIGZyb20gJy4uL2lkZW50aXR5TWFuYWdlci9JZGVudGl0eU1hbmFnZXInO1xyXG4vL2ltcG9ydCBTeW5jaGVyIGZyb20gJy4uL3N5bmNoZXIvU3luY2hlci5qcyc7XHJcbi8vaW1wb3J0IERpc2NvdmVyeSBmcm9tICcuLi9kaXNjb3ZlcnkvRGlzY292ZXJ5LmpzJztcclxuLy9pbXBvcnQge2RpdmlkZVVSTH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuLy9pbXBvcnQgU2VhcmNoIGZyb20gJy4uL3V0aWxzL1NlYXJjaCc7XHJcbmltcG9ydCBFdmVudEVtaXR0ZXIgZnJvbSAnLi4vdXRpbHMvRXZlbnRFbWl0dGVyJztcclxuXHJcbi8qKlxyXG4qIENvbnRleHQgT2JzZXJ2ZXI7XHJcbiogQGF1dGhvciBQYXVsbyBDaGFpbmhvIFtwYXVsby1nLWNoYWluaG9AYWx0aWNlbGFicy5jb21dXHJcbiovXHJcblxyXG5jbGFzcyBDb250ZXh0T2JzZXJ2ZXIgZXh0ZW5kcyBFdmVudEVtaXR0ZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24sIGNvbnRleHRSZXNvdXJjZVR5cGVzLCBmYWN0b3J5LCBzeW5jaGVyKSB7XHJcbiAgICBpZiAoIWh5cGVydHlVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIGh5cGVydHlVUkwgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7XHJcbiAgICBpZiAoIWJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgTWluaUJ1cyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTtcclxuICAgIGlmICghY29uZmlndXJhdGlvbikgdGhyb3cgbmV3IEVycm9yKCdUaGUgY29uZmlndXJhdGlvbiBpcyBhIG5lZWRlZCBwYXJhbWV0ZXIgJyk7XHJcbiAgICBpZiAoIWZhY3RvcnkpIHRocm93IG5ldyBFcnJvcignVGhlIGZhY3RvcnkgaXMgYSBuZWVkZWQgcGFyYW1ldGVyICcpO1xyXG5cclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fY29udGV4dFJlc291cmNlVHlwZXMgPSBjb250ZXh0UmVzb3VyY2VUeXBlcztcclxuICAgIF90aGlzLl91cmwgPSBoeXBlcnR5VVJMO1xyXG4gICAgX3RoaXMuX2Rpc2NvdmVyVXNlcnNQcm9taXNlcyA9IHt9OyAvLyBvYmplY3Qgd2l0aCBwcm9taXNlcyBleGVjdXRlZCBhdCBkaXNjb3ZlclVzZXJzIGZ1bmN0aW9uXHJcbiAgICBfdGhpcy5fb2JzZXJ2ZVByb21pc2VzID0ge307IC8vIG9iamVjdCB3aXRoIHByb21pc2VzIGV4ZWN1dGVkIGF0IG9ic2VydmUgZnVuY3Rpb25cclxuXHJcblxyXG4gICAgLy9sZXQgaWRlbnRpdHlNYW5hZ2VyID0gbmV3IElkZW50aXR5TWFuYWdlcihoeXBlcnR5VVJMLCBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkwsIGJ1cyk7XHJcbiAgICBjb25zb2xlLmxvZygnW0NvbnRleHRPYnNlcnZlcl0gc3RhcnRlZCB3aXRoIGh5cGVydHlVUkwtPicsIGh5cGVydHlVUkwpO1xyXG4gICAgX3RoaXMuX2RvbWFpbiA9IGZhY3RvcnkuZGl2aWRlVVJMKGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTCkuZG9tYWluO1xyXG4gICAgX3RoaXMuX29iamVjdERlc2NVUkwgPSAnaHlwZXJ0eS1jYXRhbG9ndWU6Ly9jYXRhbG9ndWUuJyArIF90aGlzLl9kb21haW4gKyAnLy53ZWxsLWtub3duL2RhdGFzY2hlbWEvQ29udGV4dCc7XHJcblxyXG4gICAgX3RoaXMuX3VzZXJzMm9ic2VydmUgPSBbXTtcclxuICAgIF90aGlzLl9vYnNlcnZlcnMgPSB7fTtcclxuXHJcbiAgICB0aGlzLl9zeW5jaGVyID0gc3luY2hlciA/IHN5bmNoZXIgOiBmYWN0b3J5LmNyZWF0ZVN5bmNoZXIoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uKTtcclxuXHJcbiAgICBsZXQgZGlzY292ZXJ5ID0gZmFjdG9yeS5jcmVhdGVEaXNjb3ZlcnkoaHlwZXJ0eVVSTCwgY29uZmlndXJhdGlvbi5ydW50aW1lVVJMLCBidXMpO1xyXG4gICAgX3RoaXMuX2Rpc2NvdmVyeSA9IGRpc2NvdmVyeTtcclxuXHJcbiAgICBfdGhpcy5fZGlzY292ZXJpZXMgPSB7fTsgLy9saXN0IG9mIGRpc2NvdmVyZWQgb2JqZWN0c1xyXG4gICAgLy9fdGhpcy5pZGVudGl0eU1hbmFnZXIgPSBpZGVudGl0eU1hbmFnZXI7XHJcbiAgICAvL190aGlzLnNlYXJjaCA9IG5ldyBTZWFyY2goZGlzY292ZXJ5LCBpZGVudGl0eU1hbmFnZXIpO1xyXG4gICAgd2luZG93LmRpc2NvdmVyeSA9IF90aGlzLl9kaXNjb3Zlcnk7XHJcbiAgfVxyXG5cclxuXHJcbiAgc3RhcnQocmVzdW1lZENvbnRleHQsIGRpc2Nvbm5lY3RlZENhbGxCYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgY29uc29sZS5sb2coJ1tDb250ZXh0T2JzZXJ2ZXIuc3RhcnRdICcpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIF90aGlzLl9zeW5jaGVyLnJlc3VtZU9ic2VydmVycyh7c3RvcmU6IHRydWV9KS50aGVuKChvYnNlcnZlcnMpID0+IHtcclxuXHJcbiAgICAgICAgbGV0IG9ic2VydmVyc0xpc3QgPSBPYmplY3Qua2V5cyhvYnNlcnZlcnMpO1xyXG5cclxuICAgICAgICBpZiAob2JzZXJ2ZXJzTGlzdC5sZW5ndGggID4gMCkge1xyXG5cclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbQ29udGV4dE9ic2VydmVyLnN0YXJ0XSByZXN1bWluZzogJywgb2JzZXJ2ZXJzKTtcclxuXHJcbiAgICAgICAgICAvKm9ic2VydmVyc0xpc3QuZm9yRWFjaCgoaSk9PntcclxuICAgICAgICAgIF90aGlzLl91c2VyczJvYnNlcnZlLnB1c2gobmV3IFVzZXJBdmFpbGFiaWxpdHlDb250cm9sbGVyKG9ic2VydmVyc1tpXSkpO1xyXG4gICAgICAgIH0pOyovXHJcbiAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzID0gb2JzZXJ2ZXJzO1xyXG5cclxuICAgICAgICAgIHJlc29sdmUob2JzZXJ2ZXJzKTtcclxuXHJcbiAgICAgICAgICBvYnNlcnZlcnNMaXN0LmZvckVhY2goKG9ic2VydmVyKSA9PntcclxuICAgICAgICAgICAgbGV0IENvbnRleHQgPSBvYnNlcnZlcnNbb2JzZXJ2ZXJdO1xyXG5cclxuICAgICAgICAgICAgLy8gQnkgZGVmYXVsdCByZXN1bWVkIGNvbnRleHQgaXMgc2V0IHdpdGggcmVzdW1lZENvbnRleHQuXHJcbiAgICAgICAgICAgIGlmIChyZXN1bWVkQ29udGV4dCkgY29udGV4dC5kYXRhLnZhbHVlcyA9IHJlc3VtZWRDb250ZXh0O1xyXG5cclxuICAgICAgICAgICAgLy8gQ29udGV4dCB3aWxsIHdpbGwgYmUgdXBkYXRlZCB3aXRoIHZhbHVlIHN5bmNocm9uaXplZCB3aXRoIHJlcG9ydGVyIGlmIGNvbm5lY3RlZFxyXG4gICAgICAgICAgICBDb250ZXh0LnN5bmMoKTtcclxuXHJcbiAgICAgICAgICAgIC8vQWRkIGxpc3RlbmVyIHRvIGJlIG5vdGlmaWVkIHdoZW4gcmVwb3J0ZXIgaXMgYWJydXB0bHkgZGlzY29ubmVjdGVkXHJcbiAgICAgICAgICAgIGlmIChkaXNjb25uZWN0ZWRDYWxsQmFjaykgQ29udGV4dC5vbkRpc2Nvbm5lY3RlZChkaXNjb25uZWN0ZWRDYWxsQmFjayk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdbQ29udGV4dE9ic2VydmVyXSBSZXN1bWUgT2JzZXJ2ZXIgZmFpbGVkIHwgJywgcmVhc29uKTtcclxuICAgICAgICByZXNvbHZlKGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgIHJlamVjdCgnW0NvbnRleHRPYnNlcnZlcl0gU3RhcnQgZmFpbGVkIHwgJywgcmVhc29uKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVzdW1lRGlzY292ZXJpZXMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIF90aGlzLl9kaXNjb3ZlcnkucmVzdW1lRGlzY292ZXJpZXMoKS50aGVuKChkaXNjb3ZlcmllcykgPT4ge1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnW0NvbnRleHRPYnNlcnZlci5fcmVzdW1lRGlzY292ZXJpZXNdIGZvdW5kOiAnLCBkaXNjb3Zlcmllcyk7XHJcblxyXG4gICAgICAgIGRpc2NvdmVyaWVzLmZvckVhY2goKGRpc2NvdmVyeSkgPT57XHJcblxyXG4gICAgICAgICAgaWYgKGRpc2NvdmVyeS5kYXRhLnJlc291cmNlcyAmJiBkaXNjb3ZlcnkuZGF0YS5yZXNvdXJjZXNbMF0gPT09IF90aGlzLl9jb250ZXh0UmVzb3VyY2VUeXBlc1swXSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW0NvbnRleHRPYnNlcnZlci5fcmVzdW1lRGlzY292ZXJpZXNdIHJlc3VtaW5nOiAnLCBkaXNjb3ZlcnkpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRpc2NvdmVyeS5kYXRhLnN0YXR1cyA9PT0gJ2xpdmUnKSB7IC8vIHByZXZpb3VzbHkgZGlzY292ZXJlZCBvYmplY3QgaXMgbm93IGxpdmVcclxuICAgICAgICAgICAgICByZXNvbHZlKFtkaXNjb3ZlcnkuZGF0YV0pO1xyXG4gICAgICAgICAgICAgIGRpc2NvdmVyeS51bnN1YnNjcmliZUxpdmUoX3RoaXMuX3VybCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7IC8vIHByZXZpb3VzbHkgZGlzY292ZXJlZCBvYmplY3QgaXMgc3RpbGwgZGlzY29ubmVjdGVkXHJcbiAgICAgICAgICAgICAgZGlzY292ZXJ5Lm9uTGl2ZShfdGhpcy5fdXJsLCAoKT0+e1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tDb250ZXh0T2JzZXJ2ZXIuX3Jlc3VtZURpc2NvdmVyaWVzXSBkaXNjb25uZWN0ZWQgSHlwZXJ0eSBpcyBiYWNrIHRvIGxpdmUnLCBkaXNjb3ZlcnkpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShbZGlzY292ZXJ5LmRhdGFdKTtcclxuICAgICAgICAgICAgICAgIGRpc2NvdmVyeS51bnN1YnNjcmliZUxpdmUoX3RoaXMuX3VybCk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgIHJlamVjdCgnW0NvbnRleHRPYnNlcnZlcl0gcmVzdW1lRGlzY292ZXJpZXMgZmFpbGVkIHwgJywgcmVhc29uKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb25SZXN1bWVPYnNlcnZlcihjYWxsYmFjaykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9vblJlc3VtZU9ic2VydmVyID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuXHJcbiAgZGlzY292ZXJVc2VycyhlbWFpbCwgZG9tYWluKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuXHJcbiAgICBsZXQgdXNlciA9IGVtYWlsICsgJ0AnICsgZG9tYWluO1xyXG5cclxuICAgIGlmICghX3RoaXMuX2Rpc2NvdmVyVXNlcnNQcm9taXNlc1t1c2VyXSkge1xyXG4gICAgICBfdGhpcy5fZGlzY292ZXJVc2Vyc1Byb21pc2VzW3VzZXJdID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICAgIF90aGlzLl9kaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnRpZXNETyhlbWFpbCwgWydjb250ZXh0J10sIF90aGlzLl9jb250ZXh0UmVzb3VyY2VUeXBlcywgZG9tYWluKS50aGVuKGh5cGVydGllcyA9PntcclxuICAgICAgICAgIC8vX3RoaXMuc2VhcmNoLnVzZXJzKFtlbWFpbF0sIFtkb21haW5dLCBbJ2NvbnRleHQnXSwgWydDb250ZXh0X2NvbnRleHQnXSkudGhlbihmdW5jdGlvbihhKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnW0NvbnRleHRPYnNlcnZlci5kaXNjb3ZlclVzZXJzXSBkaXNjb3ZlcnkgcmVzdWx0LT4nLCBoeXBlcnRpZXMpO1xyXG4gICAgICAgICAgbGV0IGRpc2NvdmVyZWQgPSBbXTtcclxuICAgICAgICAgIGxldCBkaXNjb25uZWN0ZWQgPSBbXTtcclxuICAgICAgICAgIGh5cGVydGllcy5mb3JFYWNoKGh5cGVydHkgPT57XHJcbiAgICAgICAgICAgIF90aGlzLl9kaXNjb3Zlcmllc1toeXBlcnR5LmRhdGEuaHlwZXJ0eUlEXSA9IGh5cGVydHk7XHJcbiAgICAgICAgICAgIGlmIChoeXBlcnR5LmRhdGEuc3RhdHVzID09PSAnbGl2ZScpIHtcclxuICAgICAgICAgICAgICBkaXNjb3ZlcmVkLnB1c2goaHlwZXJ0eS5kYXRhKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBkaXNjb25uZWN0ZWQucHVzaChoeXBlcnR5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgIGlmIChkaXNjb3ZlcmVkLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tDb250ZXh0T2JzZXJ2ZXIuZGlzY292ZXJVc2Vyc10gcmV0dXJuaW5nIGRpc2NvdmVyZWQgaHlwZXJ0aWVzIGRhdGEtPicsIGRpc2NvdmVyZWQpO1xyXG4gICAgICAgICAgICByZXNvbHZlKGRpc2NvdmVyZWQpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChkaXNjb25uZWN0ZWQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW0NvbnRleHRPYnNlcnZlci5kaXNjb3ZlclVzZXJzXSBkaXNjb25uZWN0ZWQgSHlwZXJ0aWVzICcsIGRpc2Nvbm5lY3RlZCk7XHJcblxyXG4gICAgICAgICAgICAvL3Jlc29sdmUoW10pO1xyXG5cclxuICAgICAgICAgICAgZGlzY29ubmVjdGVkWzBdLm9uTGl2ZShfdGhpcy5fdXJsLCAoKT0+e1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbQ29udGV4dE9ic2VydmVyLmRpc2NvdmVyVXNlcnNdIGRpc2Nvbm5lY3RlZCBIeXBlcnR5IGlzIGJhY2sgdG8gbGl2ZScsIGRpc2Nvbm5lY3RlZFswXSk7XHJcblxyXG4gICAgICAgICAgICAgIGRpc2NvdmVyZWQucHVzaChkaXNjb25uZWN0ZWRbMF0uZGF0YSk7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShkaXNjb3ZlcmVkKTtcclxuICAgICAgICAgICAgICBkaXNjb25uZWN0ZWRbMF0udW5zdWJzY3JpYmVMaXZlKF90aGlzLl91cmwpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX3RoaXMuX2Rpc2NvdmVyVXNlcnNQcm9taXNlc1t1c2VyXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBzdGFydCB0aGUgdXNlciBDb250ZXh0IG9ic2VydmF0aW9uIGZvciBhIGNlcnRhaW4gdXNlciBDb250ZXh0IHJlcG9ydGVyXHJcbiAgICogQHBhcmFtICB7RGlzY292ZXJlZE9iamVjdH0gaHlwZXJ0eSAgICAgICBIeXBlcnR5IHRvIGJlIG9ic2VydmVkLlxyXG4gICAqIEByZXR1cm4gezxQcm9taXNlPiBEYXRhT2JqZWN0T2JzZXJ2ZXJ9ICAgICAgSXQgcmV0dXJucyBhcyBhIFByb21pc2UgdGhlIFVzZXJBdmFpbGFiaWxpdHkgRGF0YSBPYmplY3QgT2JzZXJ2ZXIuXHJcbiAgICovXHJcblxyXG4gIG9ic2VydmUoaHlwZXJ0eSwgZG9tYWluU3Vic2NyaXB0aW9uID0gdHJ1ZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGlmICghX3RoaXMuX29ic2VydmVQcm9taXNlc1toeXBlcnR5Lmh5cGVydHlJRF0pIHtcclxuICAgICAgX3RoaXMuX29ic2VydmVQcm9taXNlc1toeXBlcnR5Lmh5cGVydHlJRF0gPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgLy9jaGVjayBpZiB3ZSBhcmUgYWxyZWFkeSBvYnNlcnZpbmcgaXRcclxuICAgICAgICBfdGhpcy5fdXNlcnMyb2JzZXJ2ZS5mb3JFYWNoKChDb250ZXh0KSA9PiB7XHJcbiAgICAgICAgICBpZiAoQ29udGV4dC5fcmVwb3J0ZXIgPT09IGh5cGVydHkuaHlwZXJ0eUlEKSByZXR1cm4gcmVzb2x2ZShDb250ZXh0KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgX3RoaXMuX2Rpc2NvdmVyeS5kaXNjb3ZlckRhdGFPYmplY3RzUGVyUmVwb3J0ZXIoaHlwZXJ0eS5oeXBlcnR5SUQsIFsnY29udGV4dCddLCBfdGhpcy5fY29udGV4dFJlc291cmNlVHlwZXMsICBfdGhpcy5fZG9tYWluKS50aGVuKGZ1bmN0aW9uKGRhdGFPYmplY3RzKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnW0NvbnRleHRPYnNlcnZlci5kaXNjb3ZlckF2YWlsYWJpbGl0eV0gZGlzY292ZXJlZCBjb250ZXh0IG9iamVjdHMgJywgZGF0YU9iamVjdHMpO1xyXG4gICAgICAgICAgbGV0IGxhc3QgPSAwO1xyXG4gICAgICAgICAgbGV0IHVybDtcclxuXHJcbiAgICAgICAgICBkYXRhT2JqZWN0cy5mb3JFYWNoKChkYXRhT2JqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhT2JqZWN0Lmhhc093blByb3BlcnR5KCdsYXN0TW9kaWZpZWQnKSAmJiBkYXRhT2JqZWN0Lmhhc093blByb3BlcnR5KCd1cmwnKSAmJiBEYXRlLnBhcnNlKGRhdGFPYmplY3QubGFzdE1vZGlmaWVkKSA+IGxhc3QpIHtcclxuICAgICAgICAgICAgICBsYXN0ID0gZGF0YU9iamVjdC5sYXN0TW9kaWZpZWQ7XHJcbiAgICAgICAgICAgICAgdXJsID0gZGF0YU9iamVjdC51cmw7XHJcblxyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdVUkwgREFUQSBPYmplY3QnLCB1cmwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGlmIChsYXN0ICE9IDAgJiYgdXJsKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuX3N1YnNjcmliZUNvbnRleHQoaHlwZXJ0eSwgdXJsLCBkb21haW5TdWJzY3JpcHRpb24pKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCgnW0NvbnRleHRPYnNlcnZlci5vYnNlcnZlXSBkaXNjb3ZlcmVkIERhdGFPYmplY3MgYXJlIGludmFsaWQnLCBkYXRhT2JqZWN0cyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF90aGlzLl9vYnNlcnZlUHJvbWlzZXNbaHlwZXJ0eS5oeXBlcnR5SURdO1xyXG4gIH1cclxuXHJcbiAgX3N1YnNjcmliZUNvbnRleHQoaHlwZXJ0eSwgdXJsLCBkb21haW5TdWJzY3JpcHRpb24gPSB0cnVlKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIC8vIGF2b2lkIGR1cGxpY2F0ZWQgc3Vic2NyaXB0aW9uc1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgX3RoaXMuX3VzZXJzMm9ic2VydmUuZm9yRWFjaCgoQ29udGV4dCkgPT4ge1xyXG4gICAgICAgIGlmIChDb250ZXh0LnVybCA9PT0gdXJsKSByZXR1cm4gcmVzb2x2ZShDb250ZXh0KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBsZXQgaW5wdXQgPSB7XHJcbiAgICAgICAgc2NoZW1hOiBfdGhpcy5fb2JqZWN0RGVzY1VSTCxcclxuICAgICAgICByZXNvdXJjZTogdXJsLFxyXG4gICAgICAgIHN0b3JlOiBudWxsLFxyXG4gICAgICAgIHAycDogbnVsbCxcclxuICAgICAgICBtdXR1YWw6IG51bGwsXHJcbiAgICAgICAgZG9tYWluX3N1YnNjcmlwdGlvbjogZG9tYWluU3Vic2NyaXB0aW9uXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBfdGhpcy5fc3luY2hlci5zdWJzY3JpYmUoaW5wdXQpLnRoZW4oKENvbnRleHQpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0NvbnRleHRPYnNlcnZlci5fc3Vic2NyaWJlQ29udGV4dF0gb2JzZXJ2ZXIgb2JqZWN0JywgQ29udGV4dCk7XHJcblxyXG4gICAgICAgIC8vbGV0IG5ld1VzZXJBdmFpbGFiaWxpdHkgPSBuZXcgVXNlckF2YWlsYWJpbGl0eUNvbnRyb2xsZXIoQ29udGV4dCwgdXNlcklEKTtcclxuXHJcbiAgICAgICAgX3RoaXMuX3VzZXJzMm9ic2VydmUucHVzaChDb250ZXh0KTtcclxuXHJcbiAgICAgICAgLy8gV2hlbiBPYmplY3QgaXMgZGlzY29ubmVjdGVkIHNldCB1c2VyIENvbnRleHQgc3RhdHVzIGFzIHVuYXZhaWxhYmxlXHJcbiAgICAgICAgQ29udGV4dC5vbkRpc2Nvbm5lY3RlZCgoKT0+e1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1tDb250ZXh0T2JzZXJ2ZXIub25EaXNjb25uZWN0ZWRdOiAnLCBDb250ZXh0KTtcclxuXHJcbiAgICAgICAgICBDb250ZXh0LmRhdGEudmFsdWVzWzBdLnZhbHVlID0gJ3VuYXZhaWxhYmxlJztcclxuICAgICAgICAgIENvbnRleHQuc3luYygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXNvbHZlKENvbnRleHQpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2NvdmVyQW5kU3Vic2NyaWJlTGVnYWN5VXNlcnMobmFtZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgX3RoaXMuX2Rpc2NvdmVyeS5kaXNjb3ZlckRhdGFPYmplY3RzUGVyTmFtZShuYW1lKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbQ29udGV4dE9ic2VydmVyLl9kaXNjb3ZlckFuZFN1YnNjcmliZUxlZ2FjeVVzZXJzXSBBbGwgRGF0YU9iamVjdHMgUmVzdWx0JywgcmVzdWx0KTtcclxuICAgICAgICByZXN1bHQuZm9yRWFjaChmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgIGlmIChvYmouc3RhdHVzID09PSAnbGl2ZScpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0xpdmUgb2JqJywgb2JqKTtcclxuICAgICAgICAgICAgaWYgKCFvYmouaHlwZXJ0eUlEKSB7XHJcbiAgICAgICAgICAgICAgb2JqLmh5cGVydHlJRCA9IG9iai5yZXBvcnRlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfdGhpcy5fc3Vic2NyaWJlQ29udGV4dChvYmouc2NoZW1hLCBvYmoudXJsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdFN1YnNjcmliZSkge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbQ29udGV4dE9ic2VydmVyLl9kaXNjb3ZlckFuZFN1YnNjcmliZUxlZ2FjeVVzZXJzXSBfc3Vic2NyaWJlQ29udGV4dCcsIHJlc3VsdFN1YnNjcmliZSk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUocmVzdWx0U3Vic2NyaWJlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnJvciAnLCBlcnIpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBzdG9wIHRoZSB1c2VyIENvbnRleHQgb2JzZXJ2YXRpb24gZm9yIGEgY2VydGFpbiB1c2VyXHJcbiAqIEBwYXJhbSAge3N0cmluZ30gQ29udGV4dCAgICAgICB0aGUgVXNlckF2YWlsYWJpbGl0eSBEYXRhIE9iamVjdCBPYnNlcnZlciBVUkwgdG8gYmUgdW5vYnNlcnZlZC5cclxuICovXHJcblxyXG4gIHVub2JzZXJ2ZShDb250ZXh0KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl91c2VyczJvYnNlcnZlLmZvckVhY2goKHVzZXIsIGluZGV4KSA9PiB7XHJcbiAgICAgIGlmICh1c2VyLnVybCA9PT0gQ29udGV4dCkge1xyXG4gICAgICAgIHVzZXIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICBfdGhpcy5fdXNlcnMyb2JzZXJ2ZS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ29udGV4dE9ic2VydmVyO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vLyBTZXJ2aWNlIEZyYW1ld29ya1xyXG4vL2ltcG9ydCBTeW5jaGVyIGZyb20gJy4uL3N5bmNoZXIvU3luY2hlcic7XHJcblxyXG4vLyBVdGlsc1xyXG5pbXBvcnQgRXZlbnRFbWl0dGVyIGZyb20gJy4uL3V0aWxzL0V2ZW50RW1pdHRlci5qcyc7XHJcbi8vaW1wb3J0IHtkaXZpZGVVUkx9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcclxuXHJcbi8vIGltcG9ydCBhdmFpbGFiaWxpdHkgZnJvbSAnLi9hdmFpbGFiaWxpdHkuanMnO1xyXG5cclxuLyoqXHJcbiogQ29udGV4dCBSZXBvcnRlcjtcclxuKiBAYXV0aG9yIFBhdWxvIENoYWluaG8gW3BhdWxvLWctY2hhaW5ob0BhbHRpY2VsYWJzLmNvbV1cclxuKi9cclxuY2xhc3MgQ29udGV4dFJlcG9ydGVyIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcclxuXHJcbiAgY29uc3RydWN0b3IoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uLCBmYWN0b3J5LCBzeW5jaGVyKSB7XHJcbiAgICBpZiAoIWh5cGVydHlVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIGh5cGVydHlVUkwgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7XHJcbiAgICBpZiAoIWJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgTWluaUJ1cyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTtcclxuICAgIGlmICghY29uZmlndXJhdGlvbikgdGhyb3cgbmV3IEVycm9yKCdUaGUgY29uZmlndXJhdGlvbiBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTtcclxuXHJcbiAgICBzdXBlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgY29uc29sZS5pbmZvKCdbQ29udGV4dFJlcG9ydGVyXSBzdGFydGVkIHdpdGggdXJsOiAnLCBoeXBlcnR5VVJMKTtcclxuXHJcbiAgICB0aGlzLnN5bmNoZXIgPSBzeW5jaGVyID8gc3luY2hlciA6IGZhY3RvcnkuY3JlYXRlU3luY2hlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24pO1xyXG5cclxuXHJcbiAgICAvLyAgICB0aGlzLmRpc2NvdmVyeSA9IG5ldyBEaXNjb3ZlcnkoaHlwZXJ0eVVSTCwgYnVzKTtcclxuICAgIHRoaXMuZG9tYWluID0gZmFjdG9yeS5kaXZpZGVVUkwoY29uZmlndXJhdGlvbi5ydW50aW1lVVJMKS5kb21haW47XHJcbiAgICB0aGlzLmNvbnRleHRzID0ge307XHJcblxyXG4gICAgdGhpcy5jb250ZXh0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nICsgdGhpcy5kb21haW4gKyAnLy53ZWxsLWtub3duL2RhdGFzY2hlbWEvQ29udGV4dCc7XHJcblxyXG5cclxuICAgIC8vICAgIHRoaXMuaGVhcnRiZWF0ID0gW107XHJcblxyXG4gICAgdGhpcy5zeW5jaGVyLm9uTm90aWZpY2F0aW9uKChldmVudCkgPT4ge1xyXG4gICAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgICBfdGhpcy5vbk5vdGlmaWNhdGlvbihldmVudCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL1RPRE86IHVuY29tbWVudCB3aGVuIHVzZWQgd2l0aCBzZXJ2aWNlIGZyYW1ld29yayBkZXZlbG9wIGJyYW5jaFxyXG5cclxuICAgIHRoaXMuc3luY2hlci5vbkNsb3NlKChldmVudCkgPT4ge1xyXG5cclxuICAgICAgY29uc29sZS5sb2coJ1tDb250ZXh0UmVwb3J0ZXIub25DbG9zZV0nKTtcclxuICAgICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgICAgX3RoaXMuc2V0U3RhdHVzKGV2ZW50LmlkLCAndW5hdmFpbGFibGUnKTtcclxuICAgICAgZXZlbnQuYWNrKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvL1RPRE86IG1vdmUgdG8gVXNlciBhdmFpbGFiaWxpdHkgUmVwb3J0ZXIgb3IgdG8gYWJzdHJhY3QgSHlwZXJ0eUNvbnRleHRSZXBvcnRlclxyXG5cclxuICBzdGFydCgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIHRoaXMuc3luY2hlci5yZXN1bWVSZXBvcnRlcnMoe3N0b3JlOiB0cnVlfSkudGhlbigocmVwb3J0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgIGxldCByZXBvcnRlcnNMaXN0ID0gT2JqZWN0LmtleXMocmVwb3J0ZXJzKTtcclxuXHJcbiAgICAgICAgaWYgKHJlcG9ydGVyc0xpc3QubGVuZ3RoICA+IDApIHtcclxuXHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnW0NvbnRleHRSZXBvcnRlci5zdGFydF0gcmVzdW1pbmcgJywgcmVwb3J0ZXJzW3JlcG9ydGVyc0xpc3RbMF1dKTtcclxuXHJcbiAgICAgICAgICAvLyBzZXQgYXZhaWxhYmlsaXR5IHRvIGF2YWlsYWJsZVxyXG5cclxuICAgICAgICAgIF90aGlzLmNvbnRleHRzID0gcmVwb3J0ZXJzO1xyXG5cclxuICAgICAgICAgIC8vVE9ETzpcclxuICAgICAgICAgIHJlcG9ydGVyc0xpc3QuZm9yRWFjaCgoY29udGV4dCkgPT4ge1xyXG4gICAgICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb24oX3RoaXMuY29udGV4dHNbY29udGV4dF0pO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgcmVzb2x2ZShfdGhpcy5jb250ZXh0cyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbQ29udGV4dFJlcG9ydGVyLnN0YXJ0XSBub3RoaW5nIHRvIHJlc3VtZSAnLCByZXBvcnRlcnMpO1xyXG4gICAgICAgICAgcmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDb250ZXh0UmVwb3J0ZXJdIFJlc3VtZSBmYWlsZWQgfCAnLCByZWFzb24pO1xyXG4gICAgICB9KTtcclxuICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgcmVqZWN0KCdbQ29udGV4dFJlcG9ydGVyXSBTdGFydCBmYWlsZWQgfCAnLCByZWFzb24pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgcHJvY2Vzc05vdGlmaWNhdGlvbihldmVudCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGNvbnNvbGUubG9nKCdbQ29udGV4dFJlcG9ydGVyLnByb2Nlc3NOb3RpZmljYXRpb246ICcsIGV2ZW50KTtcclxuXHJcbiAgICBldmVudC5hY2soKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIGEgbmV3IHN0YXR1cyBvYmplY3Qgc3luY2hlclxyXG4gICAqIEBwYXJhbSAge1VSTC5Vc2VyVVJMfSBjb250YWN0cyBMaXN0IG9mIFVzZXJzXHJcbiAgICogQHJldHVybiB7UHJvbWlzZX1cclxuICAgKi9cclxuICBjcmVhdGUoaWQsIGluaXQsIHJlc291cmNlcywgbmFtZSA9ICdteUNvbnRleHQnLCByZXBvcnRlciA9IG51bGwsIHJldXNlVVJMID0gbnVsbCkge1xyXG4gICAgLy9kZWJ1Z2dlcjtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgaW5wdXQ7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBpZiAoIXJlcG9ydGVyICYmICFyZXVzZVVSTCkge1xyXG4gICAgICAgIGlucHV0ID0ge3Jlc291cmNlczogcmVzb3VyY2VzLCBleHBpcmVzOiAzMH07XHJcbiAgICAgIH0gZWxzZSBpZiAocmVwb3J0ZXIgJiYgIXJldXNlVVJMKSB7XHJcbiAgICAgICAgaW5wdXQgPSB7cmVzb3VyY2VzOiByZXNvdXJjZXMsIGV4cGlyZXM6IDMwLCByZXBvcnRlcjogcmVwb3J0ZXJ9O1xyXG4gICAgICB9IGVsc2UgaWYgKCFyZXBvcnRlciAmJiByZXVzZVVSTCkge1xyXG4gICAgICAgIGlucHV0ID0ge3Jlc291cmNlczogcmVzb3VyY2VzLCBleHBpcmVzOiAzMCwgcmV1c2VVUkw6IHJldXNlVVJMfTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpbnB1dCA9IHtyZXNvdXJjZXM6IHJlc291cmNlcywgZXhwaXJlczogMzAsIHJldXNlVVJMOiByZXVzZVVSTCwgcmVwb3J0ZXI6IHJlcG9ydGVyfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5pbmZvKCdbQ29udGV4dFJlcG9ydGVyLmNyZWF0ZV0gbGV0cyBjcmVhdGUgYSBuZXcgVXNlciBhdmFpbGFiaWxpdHkgQ29udGV4dCBPYmplY3QgJywgaW5wdXQpO1xyXG4gICAgICBfdGhpcy5zeW5jaGVyLmNyZWF0ZShfdGhpcy5jb250ZXh0RGVzY1VSTCwgW10sIGluaXQsIHRydWUsIGZhbHNlLCBuYW1lLCBudWxsLCBpbnB1dClcclxuICAgICAgICAudGhlbigoY29udGV4dCkgPT4ge1xyXG4gICAgICAgICAgX3RoaXMuY29udGV4dHNbaWRdID0gY29udGV4dDtcclxuXHJcbiAgICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb24oY29udGV4dCk7XHJcbiAgICAgICAgICByZXNvbHZlKGNvbnRleHQpO1xyXG5cclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIF9vblN1YnNjcmlwdGlvbihjb250ZXh0KSB7XHJcbiAgICBjb250ZXh0Lm9uU3Vic2NyaXB0aW9uKChldmVudCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmluZm8oJ1tDb250ZXh0UmVwb3J0ZXIuX29uU3Vic2NyaXB0aW9uXSBhY2NlcHRpbmc6ICcsIGV2ZW50KTtcclxuICAgICAgZXZlbnQuYWNjZXB0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldENvbnRleHQoaWQsIG5ld0NvbnRleHQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZygnVEhJUyBbQ29udGV4dFJlcG9ydGVyLnNldENvbnRleHRdIGJlZm9yZSBjaGFuZ2UgOicsIF90aGlzLmNvbnRleHRzW2lkXSk7XHJcbiAgICBjb25zb2xlLmxvZygnW0NvbnRleHRSZXBvcnRlci5zZXRDb250ZXh0XSBiZWZvcmUgY2hhbmdlIDonLCBfdGhpcy5jb250ZXh0c1tpZF0uZGF0YSk7XHJcblxyXG4gICAgLy8gICAgX3RoaXMuY29udGV4dHNbaWRdLmRhdGEudmFsdWVzWzBdLnZhbHVlID0gbmV3Q29udGV4dDtcclxuXHJcbiAgICBfdGhpcy5jb250ZXh0c1tpZF0uZGF0YS52YWx1ZXMgPSBuZXdDb250ZXh0O1xyXG4gICAgY29uc29sZS5kZWJ1ZygnW0NvbnRleHRSZXBvcnRlci5zZXRDb250ZXh0XSBhZnRlciBjaGFuZ2UgOicsIF90aGlzLmNvbnRleHRzW2lkXS5kYXRhKTtcclxuICAgIF90aGlzLnRyaWdnZXIoaWQgKyAnLWNvbnRleHQtdXBkYXRlJywgbmV3Q29udGV4dCk7XHJcblxyXG4gIH1cclxuXHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb250ZXh0UmVwb3J0ZXI7XHJcbiIsIi8qKlxyXG4qIFRoZSBVc2VyUHJvZmlsZSBhY2NvcmRpbmcgdG8gVXNlciBJZGVudGl0eSBEYXRhIE1vZGVsXHJcbiovXHJcblxyXG5cclxuY2xhc3MgVXNlclByb2ZpbGUge1xyXG5cclxuICBjb25zdHJ1Y3Rvcih1c2VybmFtZSwgdXNlclVSTCwgcGljdHVyZSwgbmFtZSwgbG9jYWxlLCBwcm9maWxlKSB7XHJcblxyXG4gICAgaWYgKHVzZXJuYW1lKSB7IHRoaXMucHJlZmVycmVkX3VzZXJuYW1lID0gdXNlcm5hbWU7IH1cclxuICAgIGlmIChwaWN0dXJlKSB7IHRoaXMucGljdHVyZSA9IHBpY3R1cmU7IH1cclxuICAgIGlmIChuYW1lKSB7IHRoaXMubmFtZSA9IG5hbWU7IH1cclxuICAgIGlmIChsb2NhbGUpIHsgdGhpcy5sb2NhbGUgPSBsb2NhbGU7IH1cclxuICAgIGlmICh1c2VyVVJMKSB7IHRoaXMudXNlclVSTCA9IHVzZXJVUkw7IH1cclxuICAgIGlmIChwcm9maWxlKSBPYmplY3QuYXNzaWduKHRoaXMsIHByb2ZpbGUpO1xyXG5cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJQcm9maWxlO1xyXG4iLCIvKipcclxuKiBUaGUgSWRlbnRpdHkgaW5mbyB0byBiZSBhZGRlZCB0byBNZXNzYWdlLkJvZHkuSWRlbnRpdHlcclxuKi9cclxuXHJcbmltcG9ydCBVc2VyUHJvZmlsZSBmcm9tICcuL1VzZXJQcm9maWxlJztcclxuXHJcbmNsYXNzIE1lc3NhZ2VCb2R5SWRlbnRpdHkge1xyXG5cclxuICBjb25zdHJ1Y3Rvcih1c2VybmFtZSwgdXNlclVSTCwgcGljdHVyZSwgbmFtZSwgbG9jYWxlLCBpZHAsIGFzc2VydGlvbiwgcHJvZmlsZSkge1xyXG5cclxuICAgIGlmICghaWRwKSB0aHJvdyBuZXcgRXJyb3IoJ0lEUCBzaG91bGQgYmUgYSBwYXJhbWV0ZXInKTtcclxuICAgIGlmICghdXNlcm5hbWUpIHRocm93IG5ldyBFcnJvcigndXNlcm5hbWUgc2hvdWxkIGJlIGEgcGFyYW1ldGVyJyk7XHJcblxyXG4gICAgdGhpcy5pZHAgPSBpZHA7XHJcblxyXG4gICAgaWYgKGFzc2VydGlvbikgICAgICB7IHRoaXMuYXNzZXJ0aW9uID0gYXNzZXJ0aW9uOyB9XHJcbiAgICB0aGlzLnVzZXJQcm9maWxlID0gbmV3IFVzZXJQcm9maWxlKHVzZXJuYW1lLCB1c2VyVVJMLCBwaWN0dXJlLCBuYW1lLCBsb2NhbGUsIHByb2ZpbGUpO1xyXG5cclxuICB9XHJcblxyXG59XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgTWVzc2FnZUJvZHlJZGVudGl0eTtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5cclxuZXhwb3J0IGNvbnN0IENvbW11bmljYXRpb25TdGF0dXMgPSB7XHJcbiAgT1BFTjogJ29wZW4nLFxyXG4gIFBFTkRJTkc6ICdwZW5kaW5nJyxcclxuICBDTE9TRUQ6ICdjbG9zZWQnLFxyXG4gIFBBVVNFRDogJ3BhdXNlZCcsXHJcbiAgRkFJTEVEOiAnZmFpbGVkJ1xyXG59O1xyXG5cclxuZXhwb3J0IGxldCBjb21tdW5pY2F0aW9uT2JqZWN0ID0ge1xyXG4gIHN0YXJ0aW5nVGltZTogJycsXHJcbiAgc3RhdHVzOiAnJyxcclxuICBwYXJ0aWNpcGFudHM6IHt9XHJcbn07XHJcblxyXG5leHBvcnQgbGV0IGNvbW11bmljYXRpb25DaGlsZHJlbiA9IHtcclxuICBcInBhcmVudFwiIDogXCJjb21tdW5pY2F0aW9uXCIsXHJcbiAgXCJsaXN0ZW5lclwiIDogXCJyZXNvdXJjZXNcIixcclxuICBcInR5cGVcIiA6IFwiSHlwZXJ0eVJlc291cmNlXCJcclxufTtcclxuXHJcbi8qXHJcbmV4cG9ydCBsZXQgY29tbXVuaWNhdGlvbk9iamVjdCA9IHtcclxuICBpZDogJycsXHJcbiAgbmFtZTogJycsXHJcbiAgb3duZXI6ICcnLFxyXG4gIHNjaGVtZTogJ2NvbW0nLFxyXG4gIHN0YXJ0aW5nVGltZTogJycsXHJcbiAgbGFzdE1vZGlmaWVkOiAnJyxcclxuICBkdXJhdGlvbjogJycsXHJcbiAgc3RhdHVzOiAnJyxcclxuICBwYXJ0aWNpcGFudHM6IFtdXHJcbn07XHJcbiovXHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbi8qKlxyXG4qIFRvIG1hbmFnZSBHcm91cCBDaGF0IEludml0YXRpb25zXHJcbiogQGF1dGhvciBQYXVsbyBDaGFpbmhvIFtwYXVsby1nLWNoYWluaG9AYWx0aWNlbGFicy5jb21dXHJcbiogQHZlcnNpb24gMC4xLjBcclxuKi9cclxuXHJcbi8vIFRPRE86IGhhdmUgYW4gaW5zdGFuY2UgcGVyIENoYXRDb250cm9sbGVyXHJcblxyXG5jbGFzcyBJbnZpdGF0aW9uc0hhbmRsZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcihoeXBlcnR5VVJMKSB7XHJcblxyXG4gICAgaWYgKCFoeXBlcnR5VVJMKSB0aHJvdyBFcnJvcignaHlwZXJ0eVVSTCBpcyBhIG5lY2Vzc2FyeSBkZXBlbmRlY3knKTtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX2h5cGVydHlVUkwgPSBoeXBlcnR5VVJMO1xyXG5cclxuICAgIF90aGlzLl9wZW5kaW5nID0ge307IC8vIEFsbCBwZW5kaW5nIGludml0YXRpb25zXHJcbiAgfVxyXG5cclxuICBzZXQgaW52aXRhdGlvblJlc3BvbnNlKGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9pbnZpdGF0aW9uc1Jlc3BvbnNlID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gaGFuZGxlIG5vdGlmaWNhdGlvbnMgZm9yIGRpc2Nvbm5lY3RlZCBIeStlcnRpZXMuXHJcbiAgICogQHBhcmFtICB7RGlzY292ZXJlZE9iamVjdFtdfSAgICBkaXNjb25uZWN0ZWQgIGFycmF5IG9mIGRpc2NvdmVyZWQgaHlwZXJ0aWVzIHRoYXQgYXJlIGRpc2Nvbm5lY3RlZFxyXG4gICAqIEBwYXJhbSAge0RhdGFPYmplY3RSZXBvcnRlcn0gICAgRGF0YU9iamVjdFJlcG9ydGVyICAgRGF0YSBPYmplY3QgUmVwb3J0ZXIgYWRkcmVzc2VkIGJ5IGludml0YXRpb25zXHJcbiAgICovXHJcblxyXG4gIGludml0ZURpc2Nvbm5lY3RlZEh5cGVydGllcyhkaXNjb25uZWN0ZWQsIGRhdGFPYmplY3RSZXBvcnRlcikge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZygnW0dyb3VwQ2hhdE1hbmFnZXIuSW52aXRhdGlvbnNIYW5kbGVyLmludml0ZURpc2Nvbm5lY3RlZEh5cGVydGllc10gbGV0cyBpbnZpdGUgJywgZGlzY29ubmVjdGVkKTtcclxuXHJcbiAgICBkaXNjb25uZWN0ZWQuZm9yRWFjaCgoZGlzY29ubmVjdGVkSHlwZXJ0eSk9PntcclxuXHJcbiAgICAgIGlmICghX3RoaXMuX3BlbmRpbmdbZGF0YU9iamVjdFJlcG9ydGVyXSkge1xyXG4gICAgICAgIF90aGlzLl9wZW5kaW5nW2RhdGFPYmplY3RSZXBvcnRlcl0gPSB7fTtcclxuICAgICAgfVxyXG5cclxuICAgICAgX3RoaXMuX3BlbmRpbmdbZGF0YU9iamVjdFJlcG9ydGVyXVtkaXNjb25uZWN0ZWRIeXBlcnR5LmRhdGEuaHlwZXJ0eUlEXSA9IGRpc2Nvbm5lY3RlZEh5cGVydHk7XHJcblxyXG4gICAgICBkaXNjb25uZWN0ZWRIeXBlcnR5Lm9uTGl2ZShfdGhpcy5faHlwZXJ0eVVSTCwoKT0+e1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbR3JvdXBDaGF0TWFuYWdlci5jcmVhdGVdIGRpc2Nvbm5lY3RlZCBIeXBlcnR5IGlzIGJhY2sgdG8gbGl2ZScsIGRpc2Nvbm5lY3RlZEh5cGVydHkpO1xyXG5cclxuICAgICAgICBkYXRhT2JqZWN0UmVwb3J0ZXIuaW52aXRlT2JzZXJ2ZXJzKFtkaXNjb25uZWN0ZWRIeXBlcnR5LmRhdGEuaHlwZXJ0eUlEXSk7XHJcblxyXG4gICAgICAgIGRpc2Nvbm5lY3RlZEh5cGVydHkudW5zdWJzY3JpYmVMaXZlKF90aGlzLl9oeXBlcnR5VVJMKTtcclxuXHJcbiAgICAgICAgZGVsZXRlIF90aGlzLl9wZW5kaW5nW2RhdGFPYmplY3RSZXBvcnRlcl1bZGlzY29ubmVjdGVkSHlwZXJ0eS5kYXRhLmh5cGVydHlJRF07XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcHJvY2VzcyBzZW50IGludml0YXRpb25zLiBJbiBjYXNlIGludml0YXRpb25zIGFyZSBub3QgYWNrbm93bGVkZ2UgYnkgcmVjaXBpZW50IGl0IHdpbGwgYmUgaGFuZGxlZCBhcyBhIGRpc2Nvbm5lY3RlZCBoeXBlcnR5XHJcbiAgICogQHBhcmFtICB7RGlzY292ZXJlZE9iamVjdFtdfSAgICBsaXZlICBhcnJheSBvZiBkaXNjb3ZlcmVkIGh5cGVydGllcyB0aGF0IGFyZSBvciB3ZXJlIGxpdmVcclxuICAgKiBAcGFyYW0gIHtEYXRhT2JqZWN0UmVwb3J0ZXJ9ICAgIERhdGFPYmplY3RSZXBvcnRlciAgIERhdGEgT2JqZWN0IFJlcG9ydGVyIGFkZHJlc3NlZCBieSBpbnZpdGF0aW9uc1xyXG4gICAqL1xyXG5cclxuICBwcm9jZXNzSW52aXRhdGlvbnMobGl2ZSwgZGF0YU9iamVjdFJlcG9ydGVyKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBpbnZpdGF0aW9ucyA9IGRhdGFPYmplY3RSZXBvcnRlci5pbnZpdGF0aW9ucyB8fCBbXTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnW0dyb3VwQ2hhdE1hbmFnZXIuSW52aXRhdGlvbnNIYW5kbGVyLnByb2Nlc3NJbnZpdGF0aW9uc10gd2FpdGluZyBmb3IgcmVwbGllcyAnLCBpbnZpdGF0aW9ucywgdGhpcy5faW52aXRhdGlvbnNSZXNwb25zZSk7XHJcblxyXG4gICAgaW52aXRhdGlvbnMuZm9yRWFjaCgoaW52aXRhdGlvbikgPT4ge1xyXG4gICAgICBpbnZpdGF0aW9uLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbR3JvdXBDaGF0TWFuYWdlci5JbnZpdGF0aW9uc0hhbmRsZXIucHJvY2Vzc0ludml0YXRpb25zXSAtIE9LOiAnLCByZXN1bHQsIHRoaXMuX2ludml0YXRpb25zUmVzcG9uc2UpO1xyXG4gICAgICAgIGlmICh0aGlzLl9pbnZpdGF0aW9uc1Jlc3BvbnNlKSB7IHRoaXMuX2ludml0YXRpb25zUmVzcG9uc2UocmVzdWx0KTsgfVxyXG4gICAgICB9KS5jYXRjaCgocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tHcm91cENoYXRNYW5hZ2VyLkludml0YXRpb25zSGFuZGxlci5wcm9jZXNzSW52aXRhdGlvbnNdIC0gTk9UIE9LOiAnLCByZXN1bHQsIHRoaXMuX2ludml0YXRpb25zUmVzcG9uc2UpO1xyXG4gICAgICAgIGlmICh0aGlzLl9pbnZpdGF0aW9uc1Jlc3BvbnNlKSB7IHRoaXMuX2ludml0YXRpb25zUmVzcG9uc2UocmVzdWx0KTsgfVxyXG4gICAgICAgIF90aGlzLmludml0ZURpc2Nvbm5lY3RlZEh5cGVydGllcyhbbGl2ZVtyZXN1bHQuaW52aXRlZF1dLCBkYXRhT2JqZWN0UmVwb3J0ZXIpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIHJlc3VtZURpc2NvdmVyaWVzKGRpc2NvdmVyeUVuZ2luZSwgZ3JvdXBDaGF0KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgbGl2ZSA9IHt9O1xyXG4gICAgICBsZXQgbGl2ZUh5cGVydGllcyA9IFtdO1xyXG4gICAgICBsZXQgZGlzY29ubmVjdGVkID0gW107XHJcbiAgICAgIGxldCB1bnN1YnNjcmlwdG9uUHJvbWlzZXMgPSBbXTtcclxuXHJcbiAgICAgIGRpc2NvdmVyeUVuZ2luZS5yZXN1bWVEaXNjb3ZlcmllcygpLnRoZW4oKGRpc2NvdmVyaWVzKSA9PiB7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbR3JvdXBDaGF0TWFuYWdlci5JbnZpdGF0aW9uc0hhbmRsZXIucmVzdW1lRGlzY292ZXJpZXNdIGZvdW5kOiAnLCBkaXNjb3Zlcmllcyk7XHJcblxyXG4gICAgICAgIGRpc2NvdmVyaWVzLmZvckVhY2goKGRpc2NvdmVyeSkgPT57XHJcblxyXG4gICAgICAgICAgaWYgKGRpc2NvdmVyeS5kYXRhLnJlc291cmNlcyAmJiBkaXNjb3ZlcnkuZGF0YS5yZXNvdXJjZXNbMF0gPT09ICdjaGF0Jykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW0dyb3VwQ2hhdE1hbmFnZXIuSW52aXRhdGlvbnNIYW5kbGVyLnJlc3VtZURpc2NvdmVyaWVzXSByZXN1bWluZzogJywgZGlzY292ZXJ5KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChkaXNjb3ZlcnkuZGF0YS5zdGF0dXMgPT09ICdsaXZlJyApIHsvLyBwcmV2aW91c2x5IGRpc2NvdmVyZWQgb2JqZWN0IGlzIG5vdyBsaXZlXHJcbiAgICAgICAgICAgICAgbGl2ZVtkaXNjb3ZlcnkuZGF0YS5oeXBlcnR5SURdID0gZGlzY292ZXJ5O1xyXG4gICAgICAgICAgICAgIGxpdmVIeXBlcnRpZXMucHVzaChkaXNjb3ZlcnkuZGF0YS5oeXBlcnR5SUQpO1xyXG4gICAgICAgICAgICAgIHVuc3Vic2NyaXB0b25Qcm9taXNlcy5wdXNoKCBkaXNjb3ZlcnkudW5zdWJzY3JpYmVMaXZlKF90aGlzLl9oeXBlcnR5VVJMKSApO1xyXG4gICAgICAgICAgICB9IGVsc2Ugey8vIHByZXZpb3VzbHkgZGlzY292ZXJlZCBvYmplY3QgaXMgc3RpbGwgZGlzY29ubmVjdGVkXHJcbiAgICAgICAgICAgICAgZGlzY29ubmVjdGVkLnB1c2goZGlzY292ZXJ5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChkaXNjb25uZWN0ZWQubGVuZ3RoID4gMCkgX3RoaXMuaW52aXRlRGlzY29ubmVjdGVkSHlwZXJ0aWVzKGRpc2Nvbm5lY3RlZCwgZ3JvdXBDaGF0KTtcclxuXHJcbiAgICAgICAgaWYgKCBPYmplY3Qua2V5cyhsaXZlKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBncm91cENoYXQuaW52aXRlT2JzZXJ2ZXJzKGxpdmVIeXBlcnRpZXMpO1xyXG5cclxuICAgICAgICAgIGlmIChncm91cENoYXQuaW52aXRhdGlvbnMubGVuZ3RoID4gMCkgX3RoaXMucHJvY2Vzc0ludml0YXRpb25zKGxpdmUsIGdyb3VwQ2hhdCk7XHJcblxyXG4gICAgICAgICAgUHJvbWlzZS5hbGwodW5zdWJzY3JpcHRvblByb21pc2VzKS50aGVuKCgpPT57IHJlc29sdmUoKX0pO1xyXG5cclxuICAgICAgICB9IGVsc2UgcmVzb2x2ZSgpO1xyXG5cclxuICAgICAgfSk7XHJcbiAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICByZWplY3QoJ1tHcm91cENoYXRNYW5hZ2VyLkludml0YXRpb25zSGFuZGxlci5yZXN1bWVEaXNjb3Zlcmllc10gZmFpbGVkIHwgJywgcmVhc29uKTtcclxuICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byByZW1vdmUgYW5kIGNsZWFuIGFsbCBwZW5kaW5nIGludml0YXRpb25zLlxyXG4gICAqIEBwYXJhbSAge0RhdGFPYmplY3RSZXBvcnRlcn0gICAgRGF0YU9iamVjdFJlcG9ydGVyICAgRGF0YSBPYmplY3QgUmVwb3J0ZXIgYWRkcmVzc2VkIGJ5IGludml0YXRpb25zXHJcbiAgICogQHJldHVybiB7UHJvbWlzZX0gcmV0dXJuIGEgcHJvbWlzZSB3aGVuIGFsbCB1bnN1YnNjcmlwdG9ucyBmb3IgcGVuZGluZyBpbnZpdGF0aW9ucyBhcmUgZmluaXNoZWRcclxuICAgKi9cclxuXHJcbiAgY2xlYW5JbnZpdGF0aW9ucyhkYXRhT2JqZWN0UmVwb3J0ZXIpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IGNoYXRJbnZpdGF0aW9ucyA9IF90aGlzLl9wZW5kaW5nW2RhdGFPYmplY3RSZXBvcnRlcl07XHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tHcm91cENoYXRNYW5hZ2VyLkludml0YXRpb25zSGFuZGxlci5jbGVhbkludml0YXRpb25zXSAnLCBjaGF0SW52aXRhdGlvbnMpO1xyXG5cclxuICAgIGlmIChjaGF0SW52aXRhdGlvbnMpIHtcclxuXHJcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgbGV0IHBlbmRpbmdJbnZpdGF0aW9ucyA9IE9iamVjdC5rZXlzKGNoYXRJbnZpdGF0aW9ucyk7XHJcblxyXG4gICAgICAgIGxldCB1bnN1YnNjcmlwdG9uUHJvbWlzZXMgPSBbXTtcclxuXHJcbiAgICAgICAgcGVuZGluZ0ludml0YXRpb25zLmZvckVhY2goKGludml0YXRpb24pPT57XHJcbiAgICAgICAgICB1bnN1YnNjcmlwdG9uUHJvbWlzZXMucHVzaCggY2hhdEludml0YXRpb25zW2ludml0YXRpb25dLnVuc3Vic2NyaWJlTGl2ZShfdGhpcy5faHlwZXJ0eVVSTCkgKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgUHJvbWlzZS5hbGwocGVuZGluZ0ludml0YXRpb25zKS50aGVuKCgpPT57IHJlc29sdmUoKTsgfSk7XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9IGVsc2UgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG5cclxuXHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgSW52aXRhdGlvbnNIYW5kbGVyO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vKipcclxuKiBUaGUgR3JvdXAgQ2hhdCBBUEkgaXMgdXNlZCB0byBjb250cm9sIGEgR3JvdXAgQ2hhdCBpbnN0YW5jZS5cclxuKiBAYXV0aG9yIFZpdG9yIFNpbHZhIFt2aXRvci10LXNpbHZhQHRlbGVjb20ucHRdXHJcbiogQHZlcnNpb24gMC4xLjBcclxuKi9cclxuXHJcbi8vaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tICcuL1VzZXJJbmZvJztcclxuaW1wb3J0IFJlZ2lzdHJhdGlvblN0YXR1cyBmcm9tICcuLi9kaXNjb3ZlcnkvUmVnaXN0cmF0aW9uU3RhdHVzJztcclxuaW1wb3J0IEludml0YXRpb25zSGFuZGxlciBmcm9tICcuL0ludml0YXRpb25zSGFuZGxlcic7XHJcblxyXG5jbGFzcyBDaGF0Q29udHJvbGxlciB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHN5bmNoZXIsIGRpc2NvdmVyeSwgZG9tYWluLCBzZWFyY2gsIGlkZW50aXR5LCBtYW5hZ2VyKSB7XHJcblxyXG4gICAgaWYgKCFzeW5jaGVyKSB0aHJvdyBFcnJvcignU3luY2hlciBpcyBhIG5lY2Vzc2FyeSBkZXBlbmRlY3knKTtcclxuICAgIGlmICghZGlzY292ZXJ5KSB0aHJvdyBFcnJvcignRGlzY292ZXIgaXMgYSBuZWNlc3NhcnkgZGVwZW5kZWN5Jyk7XHJcbiAgICBpZiAoIWRvbWFpbikgdGhyb3cgRXJyb3IoJ0RvbWFpbiBpcyBhIG5lY2Vzc2FyeSBkZXBlbmRlY3knKTtcclxuICAgIGlmICghc2VhcmNoKSB0aHJvdyBFcnJvcignU2VhcmNoIGlzIGEgbmVjZXNzYXJ5IGRlcGVuZGVjeScpO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fc3luY2hlciA9IHN5bmNoZXI7XHJcbiAgICBfdGhpcy5kaXNjb3ZlcnkgPSBkaXNjb3Zlcnk7XHJcbiAgICBfdGhpcy5zZWFyY2ggPSBzZWFyY2g7XHJcbiAgICBfdGhpcy5teUlkZW50aXR5ID0gaWRlbnRpdHk7XHJcbiAgICBfdGhpcy5jb250cm9sbGVyTW9kZSA9ICdyZXBvcnRlcic7XHJcbiAgICBfdGhpcy5jaGlsZF9jc2VxID0gMDtcclxuICAgIF90aGlzLmRvbWFpbiA9IGRvbWFpbjtcclxuXHJcbiAgICBfdGhpcy5fbWFuYWdlciA9IG1hbmFnZXI7XHJcblxyXG4gICAgY29uc3QgaHlwZXJ0eVVSTCA9IHN5bmNoZXIub3duZXI7XHJcblxyXG4gICAgX3RoaXMuX29iamVjdERlc2NVUkwgPSAnaHlwZXJ0eS1jYXRhbG9ndWU6Ly9jYXRhbG9ndWUuJyArIGRvbWFpbiArICcvLndlbGwta25vd24vZGF0YXNjaGVtYS9Db21tdW5pY2F0aW9uJztcclxuXHJcbiAgICBfdGhpcy5faW52aXRhdGlvbnNIYW5kbGVyID0gbmV3IEludml0YXRpb25zSGFuZGxlcihoeXBlcnR5VVJMKTtcclxuXHJcbiAgfVxyXG5cclxuICBnZXQgaW52aXRhdGlvbnNIYW5kbGVyKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2ludml0YXRpb25zSGFuZGxlcjtcclxuICB9XHJcblxyXG4gIGdldCB1cmwoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jb250cm9sbGVyTW9kZSA9PT0gJ3JlcG9ydGVyJyA/IHRoaXMuZGF0YU9iamVjdFJlcG9ydGVyLnVybCA6IHRoaXMuZGF0YU9iamVjdE9ic2VydmVyLnVybDtcclxuICB9XHJcblxyXG4gIHNldCBkYXRhT2JqZWN0UmVwb3J0ZXIoZGF0YU9iamVjdFJlcG9ydGVyKSB7XHJcblxyXG4gICAgaWYgKCFkYXRhT2JqZWN0UmVwb3J0ZXIpIHRocm93IG5ldyBFcnJvcignW0NoYXRDb250cm9sbGVyXSBUaGUgZGF0YSBvYmplY3QgcmVwb3J0ZXIgaXMgbmVjZXNzYXJ5IHBhcmFtZXRlciAnKTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuY29udHJvbGxlck1vZGUgPSAncmVwb3J0ZXInO1xyXG5cclxuICAgIC8vIEhhbmRsZXIgdG8gcHJvY2VzcyByZWNlaXZlZCBmaWxlc1xyXG5cclxuICAgIC8vIGRhdGFPYmplY3RSZXBvcnRlci5vblJlc3BvbnNlKGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAvLyAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFJlcG9ydGVyIC0gb25SZXNwb25zZV0nLCBldmVudCk7XHJcbiAgICAvLyAgIGlmIChfdGhpcy5fb25JbnZpdGF0aW9uUmVzcG9uc2UpIHtcclxuICAgIC8vICAgICBfdGhpcy5fb25JbnZpdGF0aW9uUmVzcG9uc2UoZXZlbnQpO1xyXG4gICAgLy8gICB9XHJcbiAgICAvL1xyXG4gICAgLy8gfSk7XHJcblxyXG4gICAgZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG4gICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcclxuICAgICAgICBjYXNlICdzdWJzY3JpYmUnOiBfdGhpcy5fb25TdWJzY3JpYmUoZXZlbnQpOyBicmVhaztcclxuICAgICAgICBjYXNlICd1bnN1YnNjcmliZSc6IF90aGlzLl9vblVuc3Vic2NyaWJlKGV2ZW50KTsgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIF90aGlzLl9zZXRPbkFkZENoaWxkTGlzdGVuZXIoZGF0YU9iamVjdFJlcG9ydGVyKTtcclxuXHJcbiAgICBkYXRhT2JqZWN0UmVwb3J0ZXIub25SZWFkKChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5hY2NlcHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRhdGFPYmplY3RSZXBvcnRlci5vbkV4ZWN1dGUoKGV2ZW50KSA9PiB7XHJcbiAgICAgIHN3aXRjaCAoZXZlbnQubWV0aG9kKSB7XHJcbiAgICAgICAgY2FzZSAnYWRkVXNlcic6XHJcbiAgICAgICAgICBfdGhpcy5hZGRVc2VyKGV2ZW50LnBhcmFtc1swXSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGV2ZW50LmFjY2VwdCgpO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlYXNvbjonLCByZWFzb24pO1xyXG4gICAgICAgICAgICBldmVudC5yZWplY3QocmVhc29uKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICdyZW1vdmVVc2VyJzpcclxuICAgICAgICAgICAgX3RoaXMucmVtb3ZlVXNlcihldmVudC5wYXJhbXMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGV2ZW50LmFjY2VwdCgpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdSZWFzb246JywgcmVhc29uKTtcclxuICAgICAgICAgICAgICBldmVudC5yZWplY3QocmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6IGV2ZW50LnJlamVjdCgnW0NoYXRDb250cm9sbGVyLm9uRXhlY3V0ZV0gQ2hhdCBtZXRob2QgZXhlY3V0aW9uIG5vdCBhY2NlcHRlZCBieSBSZXBvcnRlcicpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIF90aGlzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPSBkYXRhT2JqZWN0UmVwb3J0ZXI7XHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0IGRhdGFPYmplY3RSZXBvcnRlcigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjtcclxuICB9XHJcblxyXG4gIGdldCBtZXNzYWdlcygpIHtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5jb250cm9sbGVyTW9kZSA9PT0gJ3JlcG9ydGVyJyA/IHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5fY2hpbGRyZW5PYmplY3RzIDogdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyLl9jaGlsZHJlbk9iamVjdHM7XHJcbiAgfVxyXG5cclxuICBzZXQgZGF0YU9iamVjdE9ic2VydmVyKGRhdGFPYmplY3RPYnNlcnZlcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5jb250cm9sbGVyTW9kZSA9ICdvYnNlcnZlcic7XHJcblxyXG4gICAgX3RoaXMuX2RhdGFPYmplY3RPYnNlcnZlciA9IGRhdGFPYmplY3RPYnNlcnZlcjtcclxuXHJcbiAgICBkYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICBjb25zb2xlLmluZm8oJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlcl1PYnNlcnZlciAtIG9uQ2hhbmdlJywgZXZlbnQpO1xyXG5cclxuICAgICAgaWYgKGV2ZW50LmZpZWxkLmluY2x1ZGVzKCdwYXJ0aWNpcGFudHMnKSkge1xyXG4gICAgICAgIHN3aXRjaCAoZXZlbnQuY1R5cGUpIHtcclxuICAgICAgICAgIGNhc2UgJ2FkZCc6XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5fb25Vc2VyQWRkZWQpIF90aGlzLl9vblVzZXJBZGRlZChldmVudCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgIGNhc2UgJ3JlbW92ZSc6XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5fb25Vc2VyUmVtb3ZlZCkgX3RoaXMuX29uVXNlclJlbW92ZWQoZXZlbnQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChfdGhpcy5fb25DaGFuZ2UpIF90aGlzLl9vbkNoYW5nZShldmVudCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgX3RoaXMuX3NldE9uQWRkQ2hpbGRMaXN0ZW5lcihkYXRhT2JqZWN0T2JzZXJ2ZXIpO1xyXG5cclxuICAgIC8vIGxldCBjaGlsZHJlbnMgPSBkYXRhT2JqZWN0T2JzZXJ2ZXIuY2hpbGRyZW5zO1xyXG4gICAgLy8gT2JqZWN0LmtleXMoY2hpbGRyZW5zKS5mb3JFYWNoKChjaGlsZCkgPT4ge1xyXG4gICAgLy8gICBpZiAoX3RoaXMuX29uTWVzc2FnZSkgX3RoaXMuX29uTWVzc2FnZSh7XHJcbiAgICAvLyAgICAgY2hpbGRJZDogY2hpbGQsXHJcbiAgICAvLyAgICAgaWRlbnRpdHk6IGNoaWxkcmVuc1tjaGlsZF0uaWRlbnRpdHksXHJcbiAgICAvLyAgICAgdmFsdWU6IGNoaWxkcmVuc1tjaGlsZF0uZGF0YVxyXG4gICAgLy8gICB9KTtcclxuICAgIC8vIH0pXHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0IGRhdGFPYmplY3RPYnNlcnZlcigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX2RhdGFPYmplY3RPYnNlcnZlcjtcclxuICB9XHJcblxyXG4gIF9zZXRPbkFkZENoaWxkTGlzdGVuZXIoZGF0YU9iamVjdCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgZGF0YU9iamVjdC5vbkFkZENoaWxkKGZ1bmN0aW9uKGNoaWxkKSB7XHJcbiAgICAgIF90aGlzLmNoaWxkX2NzZXEgKz0xO1xyXG4gICAgICBjb25zb2xlLmluZm8oJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5fc2V0T25BZGRDaGlsZExpc3RlbmVyXSBuZXcgQ2hpbGQgcmVjZWl2ZWQ6ICcsIGNoaWxkKTtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5fb25NZXNzYWdlKSBfdGhpcy5fb25NZXNzYWdlKGNoaWxkKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG5cclxuICBnZXQgZGF0YU9iamVjdCgpIHtcclxuICAgIHJldHVybiB0aGlzLmNvbnRyb2xsZXJNb2RlID09PSAncmVwb3J0ZXInID8gdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIgOiB0aGlzLmRhdGFPYmplY3RPYnNlcnZlcjtcclxuICB9XHJcblxyXG4gIHNldCBjbG9zZUV2ZW50KGV2ZW50KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX2Nsb3NlRXZlbnQgPSBldmVudDtcclxuXHJcbiAgICBpZiAoX3RoaXMuX29uQ2xvc2UpIF90aGlzLl9vbkNsb3NlKGV2ZW50KTtcclxuICB9XHJcblxyXG4gIGdldCBjbG9zZUV2ZW50KCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fY2xvc2VFdmVudDtcclxuICB9XHJcblxyXG5cclxuXHJcbiAgX29uU3Vic2NyaWJlKGV2ZW50KSB7XHJcblxyXG4gICAgbGV0IGRhdGFPYmplY3RSZXBvcnRlciA9IHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjtcclxuXHJcbiAgICBldmVudC5hY2NlcHQoKTtcclxuXHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5vblN1YnNjcmliZV0gZXZlbnQnLCBldmVudCwgZGF0YU9iamVjdFJlcG9ydGVyLnVybCk7XHJcbiAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLm9uU3Vic2NyaWJlXSBOZXcgdXNlciBoYXMgc3Vic2NyaWJlIHRoaXMgb2JqZWN0OiAnLCBkYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YSwgZXZlbnQuaWRlbnRpdHkpO1xyXG5cclxuICAgIGxldCBpZGVudGl0eSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZXZlbnQuaWRlbnRpdHkpKTtcclxuXHJcbiAgICBpZiAoaWRlbnRpdHkuaGFzT3duUHJvcGVydHkoJ2Fzc2VydGlvbicpKSB7XHJcbiAgICAgIGRlbGV0ZSBpZGVudGl0eS5hc3NlcnRpb25cclxuICAgIH1cclxuXHJcbiAgICBsZXQgdXNlckluZm8gPSB7XHJcbiAgICAgIGh5cGVydHlVUkw6IGV2ZW50LnVybCxcclxuICAgICAgZG9tYWluOiBldmVudC5kb21haW4sXHJcbiAgICAgIGlkZW50aXR5OiBpZGVudGl0eVxyXG4gICAgfVxyXG4gICAgbGV0IHVzZXJVUkwgPSBldmVudC5pZGVudGl0eS51c2VyUHJvZmlsZS5ndWlkO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25TdWJzY3JpYmVdICBuZXcgcGFydGljaXBhbnQnLCB1c2VySW5mbyk7XHJcbiAgICBpZiAoZXZlbnQuaWRlbnRpdHkubGVnYWN5KSB7XHJcbiAgICAgdXNlckluZm8ubGVnYWN5ID0gZXZlbnQuaWRlbnRpdHkubGVnYWN5O1xyXG4gICAgfVxyXG5cclxuICAgIGRhdGFPYmplY3RSZXBvcnRlci5kYXRhLnBhcnRpY2lwYW50c1t1c2VyVVJMXSA9IHVzZXJJbmZvO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25TdWJzY3JpYmVdIGNvbW11bmljYXRpb25PYmplY3QgT0JKIGNoYXRjb250cm9sbGVyJywgZGF0YU9iamVjdFJlcG9ydGVyLmRhdGEucGFydGljaXBhbnRzKTtcclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25TdWJzY3JpYmUgLSBvblN1YnNjcmlwdGlvbl0gJywgdXNlckluZm8pO1xyXG4gICAgLy8gY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5vblN1YnNjcmliZSAtIHRoaXMuX29uVXNlckFkZGVkXSAnLCB0aGlzLl9vblVzZXJBZGRlZCk7XHJcblxyXG4gICAgaWYgKHRoaXMuX29uVXNlckFkZGVkKSB0aGlzLl9vblVzZXJBZGRlZCh1c2VySW5mbyk7XHJcbiAgfVxyXG5cclxuICBfb25VbnN1YnNjcmliZShldmVudCkge1xyXG4gICAgbGV0IGRhdGFPYmplY3RSZXBvcnRlciA9IHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLm9uVW5zdWJzY3JpYmVdIGV2ZW50JywgZXZlbnQsIGRhdGFPYmplY3RSZXBvcnRlci51cmwpO1xyXG5cclxuICAgIGxldCBwYXJ0aWNpcGFudCA9IGV2ZW50LmlkZW50aXR5LnVzZXJQcm9maWxlO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25VbnN1YnNjcmliZV0gIHBhcnRpY2lwYW50IGxlZnQnLCBwYXJ0aWNpcGFudCk7XHJcbiAgICBpZiAoZXZlbnQuaWRlbnRpdHkubGVnYWN5KSB7XHJcbiAgICAgIHBhcnRpY2lwYW50LmxlZ2FjeSA9IGV2ZW50LmlkZW50aXR5LmxlZ2FjeTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGUgZGF0YU9iamVjdFJlcG9ydGVyLmRhdGEucGFydGljaXBhbnRzW3BhcnRpY2lwYW50LnVzZXJVUkxdO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25VbnN1YnNjcmliZSAtIHRoaXMuX29uVXNlclJlbW92ZWRdICcsIHRoaXMub25Vc2VyUmVtb3ZlZCk7XHJcbiAgICBpZiAodGhpcy5fb25Vc2VyUmVtb3ZlZCkgdGhpcy5fb25Vc2VyUmVtb3ZlZChwYXJ0aWNpcGFudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gc2VuZCBhIGZpbGUuXHJcbiAgICogQHBhcmFtICB7c3RyaW5nfSAgICAgZmlsZSAgICAgICAgICAgICAgICAgICAgICAgIElzIHRoZSBmaWxlIHRvIGJlIHNlbnQuXHJcbiAgICogQHJldHVybiB7UHJvbWlzZTxDb21tdW5pY2F0aW9uLkNoYXRNZXNzYWdlPn0gICAgICAgIEl0IHJldHVybnMgdGhlIENoYXRNZXNzYWdlIGNoaWxkIG9iamVjdCBjcmVhdGVkIGJ5IHRoZSBTeW5jaGVyIGFzIGEgUHJvbWlzZS5cclxuICAgKi9cclxuICBzZW5kRmlsZShmaWxlKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBtb2RlID0gX3RoaXMuY29udHJvbGxlck1vZGU7XHJcbiAgICBsZXQgZGF0YU9iamVjdCA9IG1vZGUgPT09ICdyZXBvcnRlcicgPyBfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIgOiBfdGhpcy5kYXRhT2JqZWN0T2JzZXJ2ZXI7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IGlkZW50aXR5ID0ge1xyXG4gICAgICAgIHVzZXJQcm9maWxlOiBfdGhpcy5teUlkZW50aXR5XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBkYXRhT2JqZWN0LmFkZEh5cGVydHlSZXNvdXJjZSgncmVzb3VyY2VzJywgJ2ZpbGUnLCAgZmlsZSwgaWRlbnRpdHkpLnRoZW4oZnVuY3Rpb24ocmVzb3VyY2VGaWxlKSB7XHJcblxyXG4gICAgICAgICAgbGV0IGlkZW50aXR5ID0ge1xyXG4gICAgICAgICAgICAgIHVzZXJQcm9maWxlOiBfdGhpcy5teUlkZW50aXR5XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgbGV0IGZpbGVTZW50RXZ0ID0geyB2YWx1ZSA6IHJlc291cmNlRmlsZSwgaWRlbnRpdHk6IGlkZW50aXR5LCByZXNvdXJjZTogcmVzb3VyY2VGaWxlfTtcclxuXHJcbiAgICAgICAgICBsZXQgcmVwb3J0ZXJTdGF0dXMgPSBuZXcgUmVnaXN0cmF0aW9uU3RhdHVzKGRhdGFPYmplY3QudXJsLCBfdGhpcy5fbWFuYWdlci5fcnVudGltZVVSTCwgX3RoaXMuX21hbmFnZXIuX2h5cGVydHlVUkwsIF90aGlzLl9tYW5hZ2VyLl9idXMgKTtcclxuXHJcbiAgICAgICAgICAvLyByZWN1cnNpdmUgZnVuY3Rpb24gdG8gc3luYyB3aXRoIGNoYXQgcmVwb3J0ZXJcclxuXHJcbiAgICAgICAgICAgIGxldCBzaGFyZTJSZXBvcnRlciA9IGZ1bmN0aW9uKGZpbGUsIHN1YnNjcmliZXIsIGV2dCwgc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgbGV0IHN0YXR1c09mUmVwb3J0ZXIgPSBzdGF0dXM7XHJcbiAgICAgICAgICAgICAgZmlsZS5zaGFyaW5nU3RhdHVzLnRoZW4ocmVzb2x2ZShldnQpKS5jYXRjaCgocmVzdWx0KT0+e1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5zZW5kRmlsZV0gc2hhcmUgZmFpbGVkOiAnLCByZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgICAgIHN0YXR1c09mUmVwb3J0ZXIub25MaXZlKCBzdWJzY3JpYmVyLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzdGF0dXNPZlJlcG9ydGVyLnVuc3Vic2NyaWJlTGl2ZShzdWJzY3JpYmVyKTtcclxuICAgICAgICAgICAgICAgIGZpbGUuc2hhcmUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBzaGFyZTJSZXBvcnRlcihmaWxlLCBzdWJzY3JpYmVyLCBldnQsIHN0YXR1c09mUmVwb3J0ZXIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIC8vVE9ETzogc3Vic2NyaWJlIHRvIHN5bmMgd2hlbiByZXBvcnRlciBpcyBsaXZlLiBOZXcgc3luY2hlZCBtZXNzYWdlcyBzaG91bGQgdHJpZ2dlciBvbk1lc3NhZ2UgaWUgb25DaGlsZFxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzaGFyZTJSZXBvcnRlcihyZXNvdXJjZUZpbGUsIF90aGlzLl9tYW5hZ2VyLl9oeXBlcnR5VVJMLCBmaWxlU2VudEV2dCwgcmVwb3J0ZXJTdGF0dXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlYXNvbjonLCByZWFzb24pO1xyXG4gICAgICByZWplY3QocmVhc29uKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBzZW5kIGEgY2hhdCBtZXNzYWdlLlxyXG4gICAqIEBwYXJhbSAge3N0cmluZ30gICAgIG1lc3NhZ2UgICAgICAgICAgICAgICAgICAgICAgICBJcyB0aGUgQ2hhdE1lc3NhZ2UgdG8gYmUgc2VudC5cclxuICAgKiBAcmV0dXJuIHtQcm9taXNlPENvbW11bmljYXRpb24uQ2hhdE1lc3NhZ2U+fSAgICAgICAgSXQgcmV0dXJucyB0aGUgQ2hhdE1lc3NhZ2UgY2hpbGQgb2JqZWN0IGNyZWF0ZWQgYnkgdGhlIFN5bmNoZXIgYXMgYSBQcm9taXNlLlxyXG4gICAqL1xyXG4gIHNlbmQobWVzc2FnZSwgaWRlbnRpdHkpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IG1vZGUgPSBfdGhpcy5jb250cm9sbGVyTW9kZTtcclxuICAgIGxldCBkYXRhT2JqZWN0ID0gbW9kZSA9PT0gJ3JlcG9ydGVyJyA/IF90aGlzLmRhdGFPYmplY3RSZXBvcnRlciA6IF90aGlzLmRhdGFPYmplY3RPYnNlcnZlcjtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4vLyAgICAgIGxldCBfZGF0YU9iamVjdENoaWxkO1xyXG4gICAgICBfdGhpcy5jaGlsZF9jc2VxICs9IDE7XHJcbiAgICAgIGxldCBtc2cgPSB7XHJcblxyXG4vKiAgICAgICAgdXJsOiBkYXRhT2JqZWN0LmRhdGEudXJsLFxyXG4gICAgICAgIGNzZXE6IF90aGlzLmNoaWxkX2NzZXEsXHJcbiAgICAgICAgcmVwb3J0ZXI6IGRhdGFPYmplY3QuZGF0YS5yZXBvcnRlcixcclxuICAgICAgICBzY2hlbWE6IGRhdGFPYmplY3QuZGF0YS5zY2hlbWEsXHJcbiAgICAgICAgbmFtZTogZGF0YU9iamVjdC5kYXRhLm5hbWUsXHJcbiAgICAgICAgY3JlYXRlZCA6IG5ldyBEYXRlKCkudG9KU09OKCksKi9cclxuXHJcbiAgICAgICAgdHlwZTogJ2NoYXQnLFxyXG4gICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2VcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IHNlbmRlciA9IGlkZW50aXR5ID8gaWRlbnRpdHkgOiB7XHJcbiAgICAgICAgdXNlclByb2ZpbGU6IF90aGlzLm15SWRlbnRpdHlcclxuICAgICAgfTtcclxuXHJcblxyXG4gICAgICAvLyBUT0RPOiBjaGFuZ2UgY2hhdG1lc3NhZ2VzIHRvIHJlc291cmNlIC0gY2hhdCwgZmlsZVxyXG4gICAgICAvLyBUT0RPOiBjaGFuZ2UgbWVzc2FnZSB0byBoeXBlcnR5UmVzb3VyY2UgLSBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2Rldi1zZXJ2aWNlLWZyYW1ld29yay90cmVlL2RldmVsb3AvZG9jcy9kYXRhbW9kZWwvZGF0YS1vYmplY3RzL2h5cGVydHktcmVzb3VyY2VcclxuICAgICAgLy8gVE9ETzogaGFuZGxlIHdpdGggbXVsdGlwbGUgcmVzb3VyY2VzIC0gaWYgdGhlIFwibWVzc2FnZVwiIHdpbGwgYmUgZGlmZmVyZW50IGZvciBlYWNoIHR5cGUgb2YgcmVzb3VyY2VzXHJcbiAgICAgIGRhdGFPYmplY3QuYWRkQ2hpbGQobXNnLCBzZW5kZXIpLnRoZW4oZnVuY3Rpb24oZGF0YU9iamVjdENoaWxkKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlcl1bYWRkQ2hpbGQgLSBDaGF0IE1lc3NhZ2VdOiAnLCBkYXRhT2JqZWN0Q2hpbGQpO1xyXG4gICAgICAgIC8vcmVzb2x2ZShkYXRhT2JqZWN0Q2hpbGQpO1xyXG5cclxuICAgICAgICAvL1RPRE86IG1vdmUgdG8gc2VwYXJhdGUgZnVuY3Rpb25cclxuXHJcblxyXG4gICAgICAgIGxldCBtc2cgPSB7XHJcbiAgICAgICAgICBjaGlsZElkOiBkYXRhT2JqZWN0Q2hpbGQuX2NoaWxkSWQsXHJcbiAgICAgICAgICBmcm9tOiBkYXRhT2JqZWN0Q2hpbGQuX293bmVyLFxyXG4gICAgICAgICAgdmFsdWU6IGRhdGFPYmplY3RDaGlsZC5kYXRhLFxyXG4gICAgICAgICAgdHlwZTogJ2NyZWF0ZScsXHJcbiAgICAgICAgICBpZGVudGl0eTogc2VuZGVyXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgbGV0IHJlcG9ydGVyU3RhdHVzID0gbmV3IFJlZ2lzdHJhdGlvblN0YXR1cyhkYXRhT2JqZWN0LnVybCwgX3RoaXMuX21hbmFnZXIuX3J1bnRpbWVVUkwsIF90aGlzLl9tYW5hZ2VyLl9oeXBlcnR5VVJMLCBfdGhpcy5fbWFuYWdlci5fYnVzICk7XHJcblxyXG4gICAgICAgIC8vIHJlY3Vyc2l2ZSBmdW5jdGlvbiB0byBzeW5jIHdpdGggY2hhdCByZXBvcnRlclxyXG5cclxuICAgICAgICAgIGxldCBzaGFyZTJSZXBvcnRlciA9IGZ1bmN0aW9uKGNoaWxkLCBzdWJzY3JpYmVyLCBtc2csIHN0YXR1cykge1xyXG4gICAgICAgICAgICBsZXQgc3RhdHVzT2ZSZXBvcnRlciA9IHN0YXR1cztcclxuICAgICAgICAgICAgY2hpbGQuc2hhcmluZ1N0YXR1cy50aGVuKHJlc29sdmUobXNnKSkuY2F0Y2goKHJlc3VsdCk9PntcclxuXHJcbiAgICAgICAgICAgICAgICBzdGF0dXNPZlJlcG9ydGVyLm9uTGl2ZSggc3Vic2NyaWJlciwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBzdGF0dXNPZlJlcG9ydGVyLnVuc3Vic2NyaWJlTGl2ZShzdWJzY3JpYmVyKTtcclxuICAgICAgICAgICAgICAgICAgY2hpbGQuc2hhcmUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgIHNoYXJlMlJlcG9ydGVyKGNoaWxkLCBzdWJzY3JpYmVyLCBtc2csIHN0YXR1c09mUmVwb3J0ZXIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvL1RPRE86IHN1YnNjcmliZSB0byBzeW5jIHdoZW4gcmVwb3J0ZXIgaXMgbGl2ZS4gTmV3IHN5bmNoZWQgbWVzc2FnZXMgc2hvdWxkIHRyaWdnZXIgb25NZXNzYWdlIGllIG9uQ2hpbGRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgc2hhcmUyUmVwb3J0ZXIoZGF0YU9iamVjdENoaWxkLCBfdGhpcy5fbWFuYWdlci5faHlwZXJ0eVVSTCwgbXNnLCByZXBvcnRlclN0YXR1cyk7XHJcblxyXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlYXNvbjonLCByZWFzb24pO1xyXG4gICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBbb25DaGFuZ2UgZGVzY3JpcHRpb25dXHJcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIFtkZXNjcmlwdGlvbl1cclxuICAgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG4gICAqL1xyXG4gIG9uQ2hhbmdlKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX29uQ2hhbmdlID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVjZWl2ZSBuZXcgbWVzc2FnZXMuXHJcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIEZ1bmN0aW9uIHRvIGhhbmRsZSB3aXRoIG5ldyBtZXNzYWdlc1xyXG4gICAqIEByZXR1cm4ge0NvbW11bmljYXRpb24uQ2hhdE1lc3NhZ2V9IG1cclxuICAgKi9cclxuICBvbk1lc3NhZ2UoY2FsbGJhY2spIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fb25NZXNzYWdlID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBbb25Vc2VyQWRkZWQgZGVzY3JpcHRpb25dXHJcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIFtkZXNjcmlwdGlvbl1cclxuICAgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG4gICAqL1xyXG4gIG9uVXNlckFkZGVkKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX29uVXNlckFkZGVkID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHRoZSBhbiB1c2VyIHdhcyByZW1vdmVkXHJcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIEZ1bmN0aW9uIGhhbmRsZSB3aXRoIHRoZSByZW1vdmVkIHVzZXJcclxuICAgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG4gICAqL1xyXG4gIG9uVXNlclJlbW92ZWQoY2FsbGJhY2spIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fb25Vc2VyUmVtb3ZlZCA9IGNhbGxiYWNrO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlY2VpdmUgcmVxdWVzdHMgdG8gY2xvc2UgdGhlIEdyb3VwIENoYXQgaW5zdGFuY2UuXHJcbiAgICogQHJldHVybiB7RGVsZXRlRXZlbnR9IFRoZSBEZWxldGVFdmVudCBmaXJlZCBieSB0aGUgU3luY2hlciB3aGVuIHRoZSBDaGF0IGlzIGNsb3NlZC5cclxuICAgKi9cclxuICBvbkNsb3NlKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX29uQ2xvc2UgPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIG9uUmVzcG9uc2UoY2FsbGJhY2spIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fb25SZXNwb25zZSA9IGNhbGxiYWNrO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGFkZCAvIGludml0ZSBuZXcgdXNlciBvbiBhbiBleGlzdGluZyBHcm91cCBDaGF0IGluc3RhbmNlLlxyXG4gICAqIE9ubHkgdGhlIFJlcG9ydGVyLCBpLmUuIHRoZSBIeXBlcnR5IHRoYXQgaGFzIGNyZWF0ZWQgdGhlIEdyb3VwIENoYXQsIGlzIGFsbG93ZWQgdG8gdXNlIHRoaXMgZnVuY3Rpb24uXHJcbiAgICogQHBhcmFtIHtVUkwuVXNlclVSTH0gIHVzZXJzICBVc2VyIHRvIGJlIGludml0ZWQgdG8gam9pbiB0aGUgR3JvdXAgQ2hhdCB0aGF0IGlzIGlkZW50aWZpZWQgd2l0aCByZVRISU5LIFVzZXIgVVJMLlxyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8Ym9vbGVhbj59ICAgSXQgcmV0dXJucyBhcyBhIFByb21pc2UgdHJ1ZSBpZiBzdWNjZXNzZnVsbHkgaW52aXRlZCBvciBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICovXHJcbiAgYWRkVXNlcih1c2Vycykge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IGhhdmVFbXB0eUVsZW1lbnRzID0gKGVsZW1lbnQpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ0VsZW1lbnQ6JywgZWxlbWVudC5sZW5ndGgpO1xyXG4gICAgICByZXR1cm4gZWxlbWVudC5sZW5ndGggIT09IDA7XHJcbiAgICB9O1xyXG5cclxuICAgIGxldCBub3RGb3VuZEVsZW1lbnRzID0gKGVsZW1lbnQpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ3VzZXIgbm90IGZvdW5kOiAnLCBlbGVtZW50KTtcclxuICAgICAgcmV0dXJuICEoZWxlbWVudCBpbnN0YW5jZW9mIFN0cmluZyk7XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGlmICh1c2Vycy5maWx0ZXIoaGF2ZUVtcHR5RWxlbWVudHMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiByZWplY3QoJ0RvblxcJ3QgaGF2ZSB1c2VycyB0byBpbnZpdGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5pbmZvKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIuYWRkVXNlcnMgXTogJywgdXNlcnMpO1xyXG5cclxuICAgICAgLypfdGhpcy5zZWFyY2gudXNlcnModXNlcnMsIGRvbWFpbnMsIFsnY29tbSddLCBbJ2NoYXQnXSlcclxuXHJcbiAgICAudGhlbigoaHlwZXJ0aWVzSURzKSA9PiB7XHJcblxyXG4gICAgICBpZiAoaHlwZXJ0aWVzSURzLmZpbHRlcihub3RGb3VuZEVsZW1lbnRzKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICB0aHJvdyAnVXNlcihzKSBub3QgZm91bmQnO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgc2VsZWN0ZWRIeXBlcnRpZXMgPSBoeXBlcnRpZXNJRHMubWFwKChoeXBlcnR5KSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGh5cGVydHkuaHlwZXJ0eUlEO1xyXG4gICAgICB9KTsqL1xyXG5cclxuICAgICAgbGV0IHVzZXJzRGlzY292ZXJ5ID0gW107XHJcbiAgICAgIGxldCBkaXNjb25uZWN0ZWQgPSBbXTtcclxuICAgICAgbGV0IGxpdmUgPSB7fTtcclxuXHJcbiAgICAgIHVzZXJzLmZvckVhY2goKHVzZXIpID0+IHtcclxuICAgICAgICBsZXQgdXNlckRpc2NvdmVyeVByb21pc2UgPSBfdGhpcy5kaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnRpZXNETyh1c2VyLnVzZXIsIFsnY29tbSddLCBbJ2NoYXQnXSwgdXNlci5kb21haW4pO1xyXG4gICAgICAgICAgdXNlcnNEaXNjb3ZlcnkucHVzaCh1c2VyRGlzY292ZXJ5UHJvbWlzZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICBQcm9taXNlLmFsbCh1c2Vyc0Rpc2NvdmVyeSkudGhlbigodXNlckRpc2NvdmVyeVJlc3VsdHMpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLmFkZFVzZXJzXSBVc2VycyBEaXNjb3ZlcnkgUmVzdWx0cy0+JywgdXNlckRpc2NvdmVyeVJlc3VsdHMpO1xyXG5cclxuICAgICAgICBsZXQgc2VsZWN0ZWRIeXBlcnRpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgIHVzZXJEaXNjb3ZlcnlSZXN1bHRzLmZvckVhY2goKHVzZXJEaXNjb3ZlcnlSZXN1bHQpID0+IHtcclxuXHJcbiAgICAgICAgICAgdXNlckRpc2NvdmVyeVJlc3VsdC5mb3JFYWNoKChkaXNjb3ZlcmVkKT0+e1xyXG4gICAgICAgICAgICAgaWYgKGRpc2NvdmVyZWQuZGF0YS5zdGF0dXMgPT09ICdsaXZlJyl7XHJcbiAgICAgICAgICAgICAgIHNlbGVjdGVkSHlwZXJ0aWVzLnB1c2goZGlzY292ZXJlZC5kYXRhLmh5cGVydHlJRCk7XHJcbiAgICAgICAgICAgICAgIGxpdmVbZGlzY292ZXJlZC5kYXRhLmh5cGVydHlJRF0gPSBkaXNjb3ZlcmVkO1xyXG4gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgZWxzZSBpZiAoZGlzY29ubmVjdGVkLmxlbmd0aCA8IDUpIGRpc2Nvbm5lY3RlZC5wdXNoKGRpc2NvdmVyZWQpO1xyXG4gICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXJdLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFN5bmNoZXIgQ3JlYXRlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gXFxuJyk7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXJdU2VsZWN0ZWQgSHlwZXJ0aWVzOiAhISEgJywgc2VsZWN0ZWRIeXBlcnRpZXMpO1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbyhgSGF2ZSAke3NlbGVjdGVkSHlwZXJ0aWVzLmxlbmd0aH0gdXNlcnM7YCk7XHJcbi8vICAgICAgICBjb25zb2xlLmluZm8oJ1tDaGF0TWFuYWdlcl0gSHlwZXJ0aWVzSURzICcsIGh5cGVydGllc0lEcyk7XHJcblxyXG4gICAgICAgIGxldCBkYXRhT2JqZWN0ID0gX3RoaXMuY29udHJvbGxlck1vZGUgPT09ICdyZXBvcnRlcicgPyBfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIgOiBfdGhpcy5kYXRhT2JqZWN0T2JzZXJ2ZXI7XHJcblxyXG4gICAgICAgIGlmIChkaXNjb25uZWN0ZWQubGVuZ3RoID4gMCkgX3RoaXMuX2ludml0YXRpb25zSGFuZGxlci5pbnZpdGVEaXNjb25uZWN0ZWRIeXBlcnRpZXMoZGlzY29ubmVjdGVkLCBkYXRhT2JqZWN0KTtcclxuXHJcbiAgICAgICAgZGF0YU9iamVjdC5pbnZpdGVPYnNlcnZlcnMoc2VsZWN0ZWRIeXBlcnRpZXMpO1xyXG5cclxuICAgICAgICBpZiAoZGF0YU9iamVjdC5pbnZpdGF0aW9ucy5sZW5ndGggPiAwKSBfdGhpcy5faW52aXRhdGlvbnNIYW5kbGVyLnByb2Nlc3NJbnZpdGF0aW9ucyhsaXZlLCBkYXRhT2JqZWN0KTtcclxuXHJcbiAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyXUFyZSBpbnZpdGVkIHdpdGggc3VjY2VzcyAnICsgdXNlcnMubGVuZ3RoICsgJyB1c2VyczsnKTtcclxuICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB0cnlpbmcgdG8gaW52aXRlIHVzZXJzO1xcbicsIHJlYXNvbik7XHJcbiAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVxdWVzdCB0aGUgUmVwb3J0ZXIgdG8gYWRkIC8gaW52aXRlIG5ldyB1c2VyIG9uIGFuIGV4aXN0aW5nIEdyb3VwIENoYXQgaW5zdGFuY2UuXHJcbiAgICogT25seSBPYnNlcnZlcnMgYXJlIGFsbG93ZWQgdG8gdXNlIHRoaXMgZnVuY3Rpb24uXHJcbiAgICogQHBhcmFtIHtVUkwuVXNlclVSTH0gIHVzZXJzICBVc2VyIHRvIGJlIGludml0ZWQgdG8gam9pbiB0aGUgR3JvdXAgQ2hhdCB0aGF0IGlzIGlkZW50aWZpZWQgd2l0aCByZVRISU5LIFVzZXIgVVJMLlxyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8Ym9vbGVhbj59ICAgSXQgcmV0dXJucyBhcyBhIFByb21pc2UgdHJ1ZSBpZiBzdWNjZXNzZnVsbHkgaW52aXRlZCBvciBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICovXHJcbiAgYWRkVXNlclJlcSh1c2Vycykge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy9jaGVjayBpcyBPYnNlcnZlciBhbmQgaW52b2tlIG9ic2VydmVyLmV4ZWN1dGUoKSB3aXRoIG5ldyBwcm9taXNlXHJcbiAgICBsZXQgaGF2ZUVtcHR5RWxlbWVudHMgPSAoZWxlbWVudCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZygnRWxlbWVudDonLCBlbGVtZW50Lmxlbmd0aCk7XHJcbiAgICAgIHJldHVybiBlbGVtZW50Lmxlbmd0aCAhPT0gMDtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgaWYgKHVzZXJzLmZpbHRlcihoYXZlRW1wdHlFbGVtZW50cykubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdCgnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLmFkZFVzZXJSZXFdIERvblxcJ3QgaGF2ZSB1c2VycyB0byBhZGQnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIV90aGlzLmNvbnRyb2xsZXJNb2RlID09PSAnb2JzZXJ2ZXInKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdCgnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLmFkZFVzZXJSZXFdIG9ubHkgYWxsb3dlZCB0byBDaGF0IE9ic2VydmVyJyk7XHJcblxyXG4gICAgICBsZXQgYWRkVXNlciA9IF90aGlzLmFkZFVzZXIodXNlcnMpO1xyXG5cclxuICAgICAgaWYgKF90aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIpIHtcclxuICAgICAgICBhZGRVc2VyID0gX3RoaXMuX2RhdGFPYmplY3RPYnNlcnZlci5leGVjdXRlKCdhZGRVc2VyJywgdXNlcnMpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhZGRVc2VyLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLmFkZFVzZXJSZXFdIFJlcXVlc3QgYWNjZXB0ZWQgYnkgUmVwb3J0ZXIgJyk7XHJcbiAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5hZGRVc2VyUmVxXSBSZXF1ZXN0IHJlamVjdGVkIGJ5IFJlcG9ydGVyO1xcbicsIHJlYXNvbik7XHJcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbn1cclxuXHJcbiAgb25JbnZpdGF0aW9uUmVzcG9uc2UoY2FsbGJhY2spIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fb25JbnZpdGF0aW9uUmVzcG9uc2UgPSBjYWxsYmFjaztcclxuICAgIF90aGlzLl9pbnZpdGF0aW9uc0hhbmRsZXIuaW52aXRhdGlvblJlc3BvbnNlID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlbW92ZSBhIHVzZXIgZnJvbSBhbiBleGlzdGluZyBHcm91cCBDaGF0IGluc3RhbmNlLlxyXG4gICAqIE9ubHkgdGhlIFJlcG9ydGVyLCBpLmUuIHRoZSBIeXBlcnR5IHRoYXQgaGFzIGNyZWF0ZWQgdGhlIEdyb3VwIENoYXQsIGlzIGFsbG93ZWQgdG8gdXNlIHRoaXMgZnVuY3Rpb24uXHJcbiAgICogQHJldHVybiB7PFByb21pc2U+IGJvb2xlYW59IFByb21pc2Ugd2l0aCB0aGUgc3RhdHVzXHJcbiAgICovXHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byByZW1vdmUgYSB1c2VyIGZyb20gYW4gZXhpc3RpbmcgR3JvdXAgQ2hhdCBpbnN0YW5jZS5cclxuICAgKiBPbmx5IHRoZSBSZXBvcnRlciwgaS5lLiB0aGUgSHlwZXJ0eSB0aGF0IGhhcyBjcmVhdGVkIHRoZSBHcm91cCBDaGF0LCBpcyBhbGxvd2VkIHRvIHVzZSB0aGlzIGZ1bmN0aW9uLlxyXG4gICAqIEBwYXJhbSAge1VSTC5Vc2VyVVJMfSB1c2VyICAgICAgIFVzZXIgdG8gYmUgcmVtb3ZlZCBmcm9tIHRoZSBHcm91cCBDaGF0IHRoYXQgaXMgaWRlbnRpZmllZCB3aXRoIHJlVEhJTksgVXNlciBVUkwuXHJcbiAgICogQHJldHVybiB7PFByb21pc2U+IGJvb2xlYW59ICAgICAgSXQgcmV0dXJucyBhcyBhIFByb21pc2UgdHJ1ZSBpZiBzdWNjZXNzZnVsbHkgcmVtb3ZlZCBvciBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICovXHJcbiAgcmVtb3ZlVXNlcih1c2VyKSB7XHJcblxyXG4gICAgLy8gVE9ETzogaW1wbGVtZW50IHRoZSByZW1vdmVVc2VyO1xyXG4gICAgY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlcl1Ob3QgeWV0IGltcGxlbWVudGVkOiAnLCB1c2VyKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY2xvc2UgYW4gZXhpc3RpbmcgR3JvdXAgQ2hhdCBpbnN0YW5jZS5cclxuICAgKiBPbmx5IGF2YWlsYWJsZSB0byBDaGF0IEdyb3VwIFJlcG9ydGVycyBpLmUuIHRoZSBIeXBlcnR5IGluc3RhbmNlIHRoYXQgY3JlYXRlZCB0aGUgR3JvdXAgQ2hhdC5cclxuICAgKiBAcmV0dXJuIHs8UHJvbWlzZT5Cb29sZWFufSBJdCByZXR1cm5zIGFzIGEgUHJvbWlzZSB0cnVlIGlmIHN1Y2Nlc3NmdWxseSBjbG9zZWQgb3IgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAqL1xyXG4gIGNsb3NlKGRlbCA9IHRydWUpIHtcclxuICAgIC8vIFRPRE86IHRoZSBkYXRhT2JqZWN0UmVwb3J0ZXIuZGVsZXRlIHNob3VsZCBiZSBhIFByb21pc2U7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIFxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBcclxuICAgICAgaWYgKF90aGlzLmNvbnRyb2xsZXJNb2RlID09PSAncmVwb3J0ZXInKSB7XHJcbiAgICAgICAgLy8gcmVwb3J0ZXJcclxuICAgICAgICBfdGhpcy5faW52aXRhdGlvbnNIYW5kbGVyLmNsZWFuSW52aXRhdGlvbnMoX3RoaXMuZGF0YU9iamVjdFJlcG9ydGVyKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIGlmICghZGVsKSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9tYW5hZ2VyLmNvbW11bmljYXRpb25PYmplY3Quc3RhdHVzID0gJ2Nsb3NlZCc7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG5cclxuICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXMuX21hbmFnZXIuX3JlcG9ydGVyc0NvbnRyb2xsZXJzW190aGlzLmRhdGFPYmplY3RSZXBvcnRlci51cmxdO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZGF0YU9iamVjdFJlcG9ydGVyLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fb25DbG9zZSkgX3RoaXMuX29uQ2xvc2Uoe1xyXG4gICAgICAgICAgICAgICAgICBjb2RlOiAyMDAsXHJcbiAgICAgICAgICAgICAgICAgIGRlc2M6ICdkZWxldGVkJyxcclxuICAgICAgICAgICAgICAgICAgdXJsOiBfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIudXJsXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZmFsc2UpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBvYnNlcnZlclxyXG4gICAgICAgIGlmKGRlbCl7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBkZWxldGUgX3RoaXMuX21hbmFnZXIuX29ic2VydmVyc0NvbnRyb2xsZXJzW190aGlzLmRhdGFPYmplY3RPYnNlcnZlci51cmxdO1xyXG4gICAgICAgICAgICBfdGhpcy5kYXRhT2JqZWN0T2JzZXJ2ZXIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICAgICAgcmVqZWN0KGZhbHNlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgIC8vIFRPRE86IHNlbmQgbWVzc2FnZSBcclxuICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgfSBcclxuICAgICAgICBcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENoYXRDb250cm9sbGVyO1xyXG4iLCJpbXBvcnQgeyBkZWVwQ2xvbmUgfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcblxyXG5leHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG5cclxuICBjb25zdHJ1Y3RvcihoeXBlcnR5VVJMLCBkb21haW4sIGlkZW50aXR5KSB7XHJcblxyXG4gICAgbGV0IGNvbXBsZXRlSWRlbnRpdHkgPSBkZWVwQ2xvbmUoaWRlbnRpdHkpO1xyXG4gICAgaWYgKCFpZGVudGl0eS5oYXNPd25Qcm9wZXJ0eSgndXNlclByb2ZpbGUnKSkge1xyXG4gICAgICBjb21wbGV0ZUlkZW50aXR5Wyd1c2VyUHJvZmlsZSddID0gaWRlbnRpdHk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaHlwZXJ0eVVSTDogaHlwZXJ0eVVSTCxcclxuICAgICAgZG9tYWluLCBkb21haW4sXHJcbiAgICAgIGlkZW50aXR5OiBjb21wbGV0ZUlkZW50aXR5XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbn1cclxuIiwiXHJcbi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbi8vIFNlcnZpY2UgRnJhbWV3b3JrXHJcbi8vaW1wb3J0IElkZW50aXR5TWFuYWdlciBmcm9tICcuLi9pZGVudGl0eU1hbmFnZXIvSWRlbnRpdHlNYW5hZ2VyJztcclxuLy9pbXBvcnQgUmVnaXN0cmF0aW9uU3RhdHVzIGZyb20gJy4uL2Rpc2NvdmVyeS9SZWdpc3RyYXRpb25TdGF0dXMnO1xyXG4vL2ltcG9ydCBEaXNjb3ZlcnkgZnJvbSAnLi4vZGlzY292ZXJ5L0Rpc2NvdmVyeSc7XHJcbi8vaW1wb3J0IFN5bmNoZXIgZnJvbSAnLi4vc3luY2hlci9TeW5jaGVyJztcclxuXHJcbi8vIFV0aWxzXHJcbi8vaW1wb3J0IHtkaXZpZGVVUkx9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuLy9pbXBvcnQgU2VhcmNoIGZyb20gJy4uL3V0aWxzL1NlYXJjaCc7XHJcblxyXG4vLyBJbnRlcm5hbHNcclxuaW1wb3J0IHsgY29tbXVuaWNhdGlvbk9iamVjdCwgQ29tbXVuaWNhdGlvblN0YXR1cywgY29tbXVuaWNhdGlvbkNoaWxkcmVuIH0gZnJvbSAnLi9jb21tdW5pY2F0aW9uJztcclxuaW1wb3J0IENoYXRDb250cm9sbGVyIGZyb20gJy4vQ2hhdENvbnRyb2xsZXInO1xyXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gJy4vVXNlckluZm8nO1xyXG5cclxuLyoqXHJcbiogSHlwZXJ0eSBHcm91cCBDaGF0IE1hbmFnZXIgQVBJIChIeXBlcnR5Q2hhdClcclxuKiBAYXV0aG9yIFZpdG9yIFNpbHZhIFt2aXRvci10LXNpbHZhQHRlbGVjb20ucHRdXHJcbiogQHZlcnNpb24gMC4xLjBcclxuKi9cclxuY2xhc3MgQ2hhdE1hbmFnZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcihteVVybCwgYnVzLCBjb25maWd1cmF0aW9uLCBzeW5jaGVyLCBmYWN0b3J5KSB7XHJcbiAgICBpZiAoIW15VXJsKSB0aHJvdyBuZXcgRXJyb3IoJ1tDaGF0TWFuYWdlci5jb25zdHJ1Y3Rvcl0gVGhlIG15VXJsIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO1xyXG4gICAgaWYgKCFidXMpIHRocm93IG5ldyBFcnJvcignW0NoYXRNYW5hZ2VyLmNvbnN0cnVjdG9yXSBUaGUgTWluaUJ1cyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTtcclxuICAgIGlmICghY29uZmlndXJhdGlvbikgdGhyb3cgbmV3IEVycm9yKCdbQ2hhdE1hbmFnZXIuY29uc3RydWN0b3JdIFRoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBpZiAoIXN5bmNoZXIpIHtcclxuICAgICAgc3luY2hlciA9IGZhY3RvcnkuY3JlYXRlU3luY2hlcihteVVybCwgYnVzLCBjb25maWd1cmF0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICBfdGhpcy5fcnVudGltZVVSTCA9IGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTDtcclxuXHJcbiAgICBsZXQgZG9tYWluID0gZmFjdG9yeS5kaXZpZGVVUkwoX3RoaXMuX3J1bnRpbWVVUkwpLmRvbWFpbjtcclxuICAgIGxldCBkaXNjb3ZlcnkgPSBmYWN0b3J5LmNyZWF0ZURpc2NvdmVyeShteVVybCwgY29uZmlndXJhdGlvbi5ydW50aW1lVVJMLCBidXMpO1xyXG4gICAgbGV0IGlkZW50aXR5TWFuYWdlciA9IGZhY3RvcnkuY3JlYXRlSWRlbnRpdHlNYW5hZ2VyKG15VXJsLCBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkwsIGJ1cyk7XHJcblxyXG4gICAgX3RoaXMuX29iamVjdERlc2NVUkwgPSAnaHlwZXJ0eS1jYXRhbG9ndWU6Ly9jYXRhbG9ndWUuJyArIGRvbWFpbiArICcvLndlbGwta25vd24vZGF0YXNjaGVtYS9Db21tdW5pY2F0aW9uJztcclxuXHJcbiAgICBfdGhpcy5fcmVwb3J0ZXJzQ29udHJvbGxlcnMgPSB7fTtcclxuICAgIF90aGlzLl9vYnNlcnZlcnNDb250cm9sbGVycyA9IHt9O1xyXG5cclxuICAgIF90aGlzLl9teVVybCA9IG15VXJsO1xyXG4gICAgX3RoaXMuX2J1cyA9IGJ1cztcclxuICAgIF90aGlzLl9zeW5jaGVyID0gc3luY2hlcjtcclxuICAgIF90aGlzLl9kb21haW4gPSBkb21haW47XHJcblxyXG4gICAgX3RoaXMuZGlzY292ZXJ5ID0gZGlzY292ZXJ5O1xyXG4gICAgX3RoaXMuaWRlbnRpdHlNYW5hZ2VyID0gaWRlbnRpdHlNYW5hZ2VyO1xyXG4gICAgX3RoaXMuY3VycmVudElkZW50aXR5O1xyXG5cclxuICAgIF90aGlzLnNlYXJjaCA9IGZhY3RvcnkuY3JlYXRlU2VhcmNoKGRpc2NvdmVyeSwgaWRlbnRpdHlNYW5hZ2VyKTtcclxuXHJcbiAgICBfdGhpcy5jb21tdW5pY2F0aW9uT2JqZWN0ID0gY29tbXVuaWNhdGlvbk9iamVjdDtcclxuXHJcbiAgICBfdGhpcy5jb21tdW5pY2F0aW9uQ2hpbGRyZW4gPSBjb21tdW5pY2F0aW9uQ2hpbGRyZW47XHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlcl0gRGlzY292ZXIgJywgZGlzY292ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXJdIElkZW50aXR5IE1hbmFnZXIgJywgaWRlbnRpdHlNYW5hZ2VyKTtcclxuXHJcblxyXG4gIH1cclxuXHJcbiAgc2V0IG9mZmxpbmUob2ZmbGluZSkge1xyXG4gICAgdGhpcy5fb2ZmbGluZSA9IG9mZmxpbmU7XHJcbiAgfVxyXG5cclxuICBnZXQgb2ZmbGluZSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9vZmZsaW5lID8gdGhpcy5fb2ZmbGluZSA6IGZhbHNlO1xyXG4gIH1cclxuXHJcblxyXG4gIHByb2Nlc3NOb3RpZmljYXRpb24oZXZlbnQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLnByb2Nlc3NOb3RpZmljYXRpb246ICcsIGV2ZW50KTtcclxuXHJcbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2NyZWF0ZScpIHtcclxuXHJcbiAgICAgIC8vIFRPRE86IHJlcGxhY2UgdGhlIDEwMCBmb3IgTWVzc2FnZS5SZXNwb25zZVxyXG4gICAgICAvLyBldmVudC5hY2soMjAwKTtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5fb25JbnZpdGF0aW9uKSB7IF90aGlzLl9vbkludml0YXRpb24oZXZlbnQpOyB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGV2ZW50LnR5cGUgPT09ICdkZWxldGUnKSB7XHJcbiAgICAgIC8vIFRPRE86IHJlcGxhY2UgdGhlIDIwMCBmb3IgTWVzc2FnZS5SZXNwb25zZVxyXG4gICAgICBldmVudC5hY2soMjAwKTtcclxuXHJcbiAgICAgIF90aGlzLl9vYnNlcnZlcnNDb250cm9sbGVyc1tldmVudC51cmxdLmNsb3NlRXZlbnQgPSBldmVudDtcclxuXHJcbiAgICAgIGRlbGV0ZSBfdGhpcy5fb2JzZXJ2ZXJzQ29udHJvbGxlcnNbZXZlbnQudXJsXTtcclxuXHJcbiAgICAgIF90aGlzLl9vYnNlcnZlcnNDb250cm9sbGVycy5jbG9zZUV2ZW50ID0gZXZlbnQ7XHJcblxyXG4gICAgICBfdGhpcy5jb21tdW5pY2F0aW9uT2JqZWN0ID0gY29tbXVuaWNhdGlvbk9iamVjdDtcclxuXHJcblxyXG4gICAgICBmb3IgKGxldCB1cmwgaW4gdGhpcy5fcmVwb3J0ZXJzQ29udHJvbGxlcnMpIHtcclxuICAgICAgICB0aGlzLl9yZXBvcnRlcnNDb250cm9sbGVyc1t1cmxdLmNsb3NlKGV2ZW50KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZm9yIChsZXQgdXJsIGluIHRoaXMuX29ic2VydmVyc0NvbnRyb2xsZXJzKSB7XHJcbiAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzQ29udHJvbGxlcnNbdXJsXS5jbG9zZShldmVudCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBteUlkZW50aXR5KGlkZW50aXR5KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyLm15SWRlbnRpdHldJyk7XHJcbiAgICAgIGlmIChpZGVudGl0eSkgcmV0dXJuIHJlc29sdmUoaWRlbnRpdHkpO1xyXG5cclxuICAgICAgaWYgKF90aGlzLl9teVVybC5pbmNsdWRlcygnaHlwZXJ0eTovLycpKSB7XHJcbiAgICAgICAgX3RoaXMuaWRlbnRpdHlNYW5hZ2VyLmRpc2NvdmVyVXNlclJlZ2lzdGVyZWQoKS50aGVuKChpZGVudGl0eSkgPT4ge1xyXG4gICAgICAgICAgcmVzb2x2ZShpZGVudGl0eSk7XHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBfdGhpcy5pZGVudGl0eU1hbmFnZXIuZGlzY292ZXJJZGVudGl0eVBlcklkUCgpLnRoZW4oKGlkZW50aXR5KSA9PiB7XHJcbiAgICAgICAgICByZXNvbHZlKGlkZW50aXR5KTtcclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBjcmVhdGUgYSBuZXcgR3JvdXAgQ2hhdCBwcm92aWRpbmcgdGhlIG5hbWUgYW5kIHRoZSBpZGVudGlmaWVycyBvZiB1c2VycyB0byBiZSBpbnZpdGVkLlxyXG4gICAqIEBwYXJhbSAge3N0cmluZ30gICAgICAgICAgICAgICAgICAgICBuYW1lICBJcyBhIHN0cmluZyB0byBpZGVudGlmeSB0aGUgR3JvdXAgQ2hhdFxyXG4gICAqIEBwYXJhbSAge2FycmF5PFVSTC51c2VyVVJMPn0gICAgICAgICB1c2VycyBBcnJheSBvZiB1c2VycyB0byBiZSBpbnZpdGVkIHRvIGpvaW4gdGhlIEdyb3VwIENoYXQuIFVzZXJzIGFyZSBpZGVudGlmaWVkIHdpdGggcmVUSElOSyBVc2VyIFVSTCwgbGlrZSB0aGlzIGZvcm1hdCB1c2VyOi8vPGlwZGRvbWFpbj4vPHVzZXItaWRlbnRpZmllcj5cclxuICAgKiBAcmV0dXJuIHs8UHJvbWlzZT5DaGF0Q29udHJvbGxlcn0gICAgQSBDaGF0Q29udHJvbGxlciBvYmplY3QgYXMgYSBQcm9taXNlLlxyXG4gICAqL1xyXG4gIGNyZWF0ZShuYW1lLCB1c2VycywgZXh0cmEgPSB7fSkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgc3luY2hlciA9IF90aGlzLl9zeW5jaGVyO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBfdGhpcy5jb21tdW5pY2F0aW9uT2JqZWN0ID0gY29tbXVuaWNhdGlvbk9iamVjdDtcclxuICAgICAgX3RoaXMuY29tbXVuaWNhdGlvbk9iamVjdC5jc2VxID0gMTtcclxuICAgICAgX3RoaXMuY29tbXVuaWNhdGlvbk9iamVjdC5zdGFydGluZ1RpbWUgPSBuZXcgRGF0ZSgpLnRvSlNPTigpO1xyXG4gICAgICBfdGhpcy5jb21tdW5pY2F0aW9uT2JqZWN0LnN0YXR1cyA9ICBDb21tdW5pY2F0aW9uU3RhdHVzLk9QRU47XHJcblxyXG4gICAgICBsZXQgbXlJZGVudGl0eTtcclxuXHJcbiAgICAgIF90aGlzLm15SWRlbnRpdHkoKS50aGVuKChpZGVudGl0eSkgPT4ge1xyXG4gICAgICAgIG15SWRlbnRpdHkgPSBpZGVudGl0eTtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLmNyZWF0ZSBdIE15IElkZW50aXR5JywgaWRlbnRpdHkpO1xyXG5cclxuICAgICAgICAvLyBsZXQgdXJsID0gX3RoaXMuY29tbXVuaWNhdGlvbk9iamVjdC5yZXBvcnRlcjtcclxuXHJcbiAgICAgICAgbGV0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKF90aGlzLl9teVVybCwgX3RoaXMuX2RvbWFpbiwgaWRlbnRpdHkpO1xyXG5cclxuICAgICAgICAvLyBBZGQgbXkgaWRlbnRpdHlcclxuICAgICAgICBfdGhpcy5jb21tdW5pY2F0aW9uT2JqZWN0LnBhcnRpY2lwYW50c1tpZGVudGl0eS5ndWlkXSA9IHVzZXJJbmZvO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLmNyZWF0ZSBdIHBhcnRpY2lwYW50czogJywgX3RoaXMuY29tbXVuaWNhdGlvbk9iamVjdC5wYXJ0aWNpcGFudHMpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuY3JlYXRlIF0gY29tbXVuaWNhdGlvbk9iamVjdCcsIF90aGlzLmNvbW11bmljYXRpb25PYmplY3QpO1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyLmNyZWF0ZV0gc2VhcmNoaW5nICcgKyB1c2Vycyk7XHJcblxyXG4gICAgICAgIC8vbGV0IHVzZXJzU2VhcmNoID0gX3RoaXMuc2VhcmNoLnVzZXJzKHVzZXJzLCBkb21haW5zLCBbJ2NvbW0nXSwgWydjaGF0J10pO1xyXG5cclxuICAgICAgICBsZXQgdXNlcnNEaXNjb3ZlcnkgPSBbXTtcclxuXHJcbiAgICAgICAgbGV0IGRpc2Nvbm5lY3RlZCA9IFtdO1xyXG4gICAgICAgIGxldCBsaXZlID0ge307XHJcblxyXG4gICAgICAgIHVzZXJzLmZvckVhY2goKHVzZXIpID0+IHtcclxuICAgICAgICAgIGxldCB1c2VyRGlzY292ZXJ5UHJvbWlzZSA9IF90aGlzLmRpc2NvdmVyeS5kaXNjb3Zlckh5cGVydGllc0RPKHVzZXIudXNlciwgWydjb21tJ10sIFsnY2hhdCddLCB1c2VyLmRvbWFpbik7XHJcbiAgICAgICAgICB1c2Vyc0Rpc2NvdmVyeS5wdXNoKHVzZXJEaXNjb3ZlcnlQcm9taXNlKTtcclxuXHJcbiAgICAgICAgICAvL2lmICh1c2VyLnVzZXIuaW5jbHVkZXMoJzovLycpKSBtdXR1YWwgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgUHJvbWlzZS5hbGwodXNlcnNEaXNjb3ZlcnkpLnRoZW4oKHVzZXJEaXNjb3ZlcnlSZXN1bHRzKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLmNyZWF0ZV0gVXNlcnMgRGlzY292ZXJ5IFJlc3VsdHMtPicsIHVzZXJEaXNjb3ZlcnlSZXN1bHRzKTtcclxuXHJcbiAgICAgICAgICBsZXQgc2VsZWN0ZWRIeXBlcnRpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICB1c2VyRGlzY292ZXJ5UmVzdWx0cy5mb3JFYWNoKCh1c2VyRGlzY292ZXJ5UmVzdWx0KSA9PiB7XHJcblxyXG4gICAgICAgICAgICB1c2VyRGlzY292ZXJ5UmVzdWx0LmZvckVhY2goKGRpc2NvdmVyZWQpPT57XHJcbiAgICAgICAgICAgICAgaWYgKGRpc2NvdmVyZWQuZGF0YS5zdGF0dXMgPT09ICdsaXZlJykge1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRIeXBlcnRpZXMucHVzaChkaXNjb3ZlcmVkLmRhdGEuaHlwZXJ0eUlEKTtcclxuICAgICAgICAgICAgICAgIGxpdmVbZGlzY292ZXJlZC5kYXRhLmh5cGVydHlJRF0gPSBkaXNjb3ZlcmVkO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUbyBjb250cm9sIHRoZSBudW1iZXIgb2Ygc3Vic2NyaXB0aW9ucyB0byBkaXNjb25uZWN0ZWQgZGV2aWNlc1xyXG4gICAgICAgICAgICAgICAgIGlmIChkaXNjb25uZWN0ZWQubGVuZ3RoIDwgNSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpc2Nvbm5lY3RlZC5wdXNoKGRpc2NvdmVyZWQpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgLyogICAgICAgIHJldHVybiB1c2Vyc1NlYXJjaDtcclxuICAgICAgfSkudGhlbigoaHlwZXJ0aWVzSURzKSA9PiB7XHJcbiAgICAgICAgbGV0IHNlbGVjdGVkSHlwZXJ0aWVzID0gaHlwZXJ0aWVzSURzLm1hcCgoaHlwZXJ0eSkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIGh5cGVydHkuaHlwZXJ0eUlEO1xyXG4gICAgICAgIH0pOyAqL1xyXG5cclxuICAgICAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyXSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFN5bmNoZXIgQ3JlYXRlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gXFxuJyk7XHJcbiAgICAgICAgICBjb25zb2xlLmluZm8oJ1tDaGF0TWFuYWdlcl0gU2VsZWN0ZWQgSHlwZXJ0aWVzOiAhISEgJywgc2VsZWN0ZWRIeXBlcnRpZXMpO1xyXG4gICAgICAgICAgY29uc29sZS5pbmZvKGBIYXZlICR7c2VsZWN0ZWRIeXBlcnRpZXMubGVuZ3RofSB1c2VycztgKTtcclxuICAgICAgICAgIGxldCBtdXR1YWwgPSBleHRyYS5tdXR1YWwgPyBleHRyYS5tdXR1YWwgOiB0cnVlO1xyXG5cclxuICAgICAgICAgIGxldCBpbnB1dCA9IE9iamVjdC5hc3NpZ24oe3Jlc291cmNlczogWydjaGF0J10sIG11dHVhbDogbXV0dWFsfSwgZXh0cmEpO1xyXG4gICAgICAgICAgZGVsZXRlIGlucHV0Lm5hbWU7XHJcblxyXG4gICAgICAgICAgaWYgKF90aGlzLm9mZmxpbmUpIGlucHV0Lm9mZmxpbmUgPSBfdGhpcy5vZmZsaW5lO1xyXG5cclxuICAgICAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyXSBpbnB1dCBkYXRhOicsIGlucHV0KTtcclxuICAgICAgICAgIHJldHVybiBzeW5jaGVyLmNyZWF0ZShfdGhpcy5fb2JqZWN0RGVzY1VSTCwgc2VsZWN0ZWRIeXBlcnRpZXMsIF90aGlzLmNvbW11bmljYXRpb25PYmplY3QsIHRydWUsIGZhbHNlLCBuYW1lLCB7fSwgaW5wdXQpO1xyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oZGF0YU9iamVjdFJlcG9ydGVyKSB7XHJcblxyXG4gICAgICAgICAgY29uc29sZS5pbmZvKCdbQ2hhdE1hbmFnZXJdIDMuIFJldHVybiBDcmVhdGUgRGF0YSBPYmplY3QgUmVwb3J0ZXInLCBkYXRhT2JqZWN0UmVwb3J0ZXIpO1xyXG5cclxuICAgICAgICAgIGxldCBjaGF0Q29udHJvbGxlciA9IG5ldyBDaGF0Q29udHJvbGxlcihzeW5jaGVyLCBfdGhpcy5kaXNjb3ZlcnksIF90aGlzLl9kb21haW4sIF90aGlzLnNlYXJjaCwgbXlJZGVudGl0eSwgX3RoaXMpO1xyXG4gICAgICAgICAgY2hhdENvbnRyb2xsZXIuZGF0YU9iamVjdFJlcG9ydGVyID0gZGF0YU9iamVjdFJlcG9ydGVyO1xyXG5cclxuICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNDb250cm9sbGVyc1tkYXRhT2JqZWN0UmVwb3J0ZXIudXJsXSA9IGNoYXRDb250cm9sbGVyO1xyXG5cclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXJdIGNoYXRDb250cm9sbGVyIGludml0YXRpb25zSGFuZGxlcjogJywgICBjaGF0Q29udHJvbGxlci5pbnZpdGF0aW9uc0hhbmRsZXIpO1xyXG5cclxuICAgICAgICAgIC8vIHByb2Nlc3MgaW52aXRhdGlvbnMgdG8gaGFuZGxlIG5vdCByZWNlaXZlZCBpbnZpdGF0aW9uc1xyXG4gICAgICAgICAgaWYgKGRhdGFPYmplY3RSZXBvcnRlci5pbnZpdGF0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNoYXRDb250cm9sbGVyLmludml0YXRpb25zSGFuZGxlci5wcm9jZXNzSW52aXRhdGlvbnMobGl2ZSwgZGF0YU9iamVjdFJlcG9ydGVyKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBJZiBhbnkgaW52aXRlZCBVc2VyIGlzIGRpc2Nvbm5lY3RlZCBsZXQncyB3YWl0IHVudGlsIGl0IGlzIGNvbm5lY3RlZCBhZ2FpblxyXG4gICAgICAgICAgaWYgKGRpc2Nvbm5lY3RlZC5sZW5ndGggPiAwKSBjaGF0Q29udHJvbGxlci5pbnZpdGF0aW9uc0hhbmRsZXIuaW52aXRlRGlzY29ubmVjdGVkSHlwZXJ0aWVzKGRpc2Nvbm5lY3RlZCwgZGF0YU9iamVjdFJlcG9ydGVyKTtcclxuXHJcbiAgICAgICAgICByZXNvbHZlKGNoYXRDb250cm9sbGVyKTtcclxuXHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLmNyZWF0ZV0gTXlJZGVudGl0eSBFcnJvcjonLCByZWFzb24pO1xyXG4gICAgICAgIHJldHVybiByZWplY3QocmVhc29uKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGhhbmRsZSBub3RpZmljYXRpb25zIGFib3V0IGluY29taW5nIGludml0YXRpb25zIHRvIGpvaW4gYSBHcm91cCBDaGF0LlxyXG4gICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBDcmVhdGVFdmVudCBUaGUgQ3JlYXRlRXZlbnQgZmlyZWQgYnkgdGhlIFN5bmNoZXIgd2hlbiBhbiBpbnZpdGFpb24gaXMgcmVjZWl2ZWRcclxuICAgKi9cclxuICBvbkludml0YXRpb24oY2FsbGJhY2spIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fb25JbnZpdGF0aW9uID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gam9pbiBhIEdyb3VwIENoYXQuXHJcbiAgICogQHBhcmFtICB7VVJMLkNvbW11bmljYXRpb25VUkx9IGludml0YXRpb25VUkwgIFRoZSBDb21tdW5pY2F0aW9uIFVSTCBvZiB0aGUgR3JvdXAgQ2hhdCB0byBqb2luIHRoYXQgaXMgcHJvdmlkZWQgaW4gdGhlIGludml0YXRpb24gZXZlbnRcclxuICAgKiBAcmV0dXJuIHs8UHJvbWlzZT5DaGF0Q29udHJvbGxlcn0gICAgICAgICAgICAgSXQgcmV0dXJucyB0aGUgQ2hhdENvbnRyb2xsZXIgb2JqZWN0IGFzIGEgUHJvbWlzZVxyXG4gICAqL1xyXG4gIGpvaW4oaW52aXRhdGlvblVSTCwgbXV0dWFsID0gdHJ1ZSwgaWRlbnRpdHkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBsZXQgc3luY2hlciA9IF90aGlzLl9zeW5jaGVyO1xyXG4gICAgICBsZXQgbXlJZGVudGl0eTtcclxuXHJcbiAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyXSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gU3luY2hlciBzdWJzY3JpYmUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBcXG4nKTtcclxuICAgICAgY29uc29sZS5pbmZvKCdpbnZpdGF0aW9uVVJMJywgaW52aXRhdGlvblVSTCk7XHJcbiAgICAgIF90aGlzLm15SWRlbnRpdHkoaWRlbnRpdHkpLnRoZW4oKGlkZW50aXR5KSA9PiB7XHJcbiAgICAgICAgbXlJZGVudGl0eSA9IGlkZW50aXR5O1xyXG4gICAgICAgIGxldCBpbnB1dCA9IHtcclxuICAgICAgICAgIHNjaGVtYTogX3RoaXMuX29iamVjdERlc2NVUkwsXHJcbiAgICAgICAgICByZXNvdXJjZTogaW52aXRhdGlvblVSTCxcclxuICAgICAgICAgIHN0b3JlOiB0cnVlLFxyXG4gICAgICAgICAgcDJwOiBmYWxzZSxcclxuICAgICAgICAgIG11dHVhbDogbXV0dWFsLFxyXG4gICAgICAgICAgZG9tYWluX3N1YnNjcmlwdGlvbjogdHJ1ZSxcclxuICAgICAgICAgIGlkZW50aXR5OiBpZGVudGl0eVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChfdGhpcy5vZmZsaW5lKSBpbnB1dC5vZmZsaW5lID0gX3RoaXMub2ZmbGluZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHN5bmNoZXIuc3Vic2NyaWJlKGlucHV0KTtcclxuXHJcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oZGF0YU9iamVjdE9ic2VydmVyKSB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdEYXRhIE9iamVjdCBPYnNlcnZlcjogJywgZGF0YU9iamVjdE9ic2VydmVyKTtcclxuXHJcbiAgICAgICAgbGV0IGNoYXRDb250cm9sbGVyID0gbmV3IENoYXRDb250cm9sbGVyKHN5bmNoZXIsIF90aGlzLmRpc2NvdmVyeSwgX3RoaXMuX2RvbWFpbiwgX3RoaXMuc2VhcmNoLCBteUlkZW50aXR5LCBfdGhpcyk7XHJcbiAgICAgICAgcmVzb2x2ZShjaGF0Q29udHJvbGxlcik7XHJcblxyXG4gICAgICAgIGNoYXRDb250cm9sbGVyLmRhdGFPYmplY3RPYnNlcnZlciA9IGRhdGFPYmplY3RPYnNlcnZlcjtcclxuXHJcbiAgICAgICAgX3RoaXMuX29ic2VydmVyc0NvbnRyb2xsZXJzW2RhdGFPYmplY3RPYnNlcnZlci51cmxdID0gY2hhdENvbnRyb2xsZXI7XHJcblxyXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2hhdE1hbmFnZXI7XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbi8qKlxyXG4qIFRoZSBHcm91cCBDaGF0IEFQSSBpcyB1c2VkIHRvIGNvbnRyb2wgYSBHcm91cCBDaGF0IGluc3RhbmNlLlxyXG4qIEBhdXRob3IgVml0b3IgU2lsdmEgW3ZpdG9yLXQtc2lsdmFAdGVsZWNvbS5wdF1cclxuKiBAdmVyc2lvbiAwLjEuMFxyXG4qL1xyXG5cclxuLy9pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gJy4vVXNlckluZm8nO1xyXG4vL2ltcG9ydCBSZWdpc3RyYXRpb25TdGF0dXMgZnJvbSAnLi4vZGlzY292ZXJ5L1JlZ2lzdHJhdGlvblN0YXR1cyc7XHJcbi8vaW1wb3J0IEludml0YXRpb25zSGFuZGxlciBmcm9tICcuL0ludml0YXRpb25zSGFuZGxlcic7XHJcblxyXG5jbGFzcyBDaGF0IHtcclxuXHJcbiAgY29uc3RydWN0b3Ioc3luY2hlciwgZG9tYWluLCBpZGVudGl0eSwgbWFuYWdlcikge1xyXG5cclxuICAgIGlmICghc3luY2hlcikgdGhyb3cgRXJyb3IoJ1N5bmNoZXIgaXMgYSBuZWNlc3NhcnkgZGVwZW5kZWN5Jyk7XHJcbi8vICAgIGlmICghZGlzY292ZXJ5KSB0aHJvdyBFcnJvcignRGlzY292ZXIgaXMgYSBuZWNlc3NhcnkgZGVwZW5kZWN5Jyk7XHJcbiAgICBpZiAoIWRvbWFpbikgdGhyb3cgRXJyb3IoJ0RvbWFpbiBpcyBhIG5lY2Vzc2FyeSBkZXBlbmRlY3knKTtcclxuLy8gICAgaWYgKCFzZWFyY2gpIHRocm93IEVycm9yKCdTZWFyY2ggaXMgYSBuZWNlc3NhcnkgZGVwZW5kZWN5Jyk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9zeW5jaGVyID0gc3luY2hlcjtcclxuLy8gICAgX3RoaXMuZGlzY292ZXJ5ID0gZGlzY292ZXJ5O1xyXG4vLyAgICBfdGhpcy5zZWFyY2ggPSBzZWFyY2g7XHJcbiAgICBfdGhpcy5teUlkZW50aXR5ID0gaWRlbnRpdHk7XHJcbiAgICBfdGhpcy5jb250cm9sbGVyTW9kZSA9ICdyZXBvcnRlcic7XHJcbiAgICBfdGhpcy5jaGlsZF9jc2VxID0gMDtcclxuICAgIF90aGlzLmRvbWFpbiA9IGRvbWFpbjtcclxuXHJcbiAgICBfdGhpcy5fbWFuYWdlciA9IG1hbmFnZXI7XHJcblxyXG4gICAgY29uc3QgaHlwZXJ0eVVSTCA9IHN5bmNoZXIub3duZXI7XHJcblxyXG4gICAgX3RoaXMuX29iamVjdERlc2NVUkwgPSAnaHlwZXJ0eS1jYXRhbG9ndWU6Ly9jYXRhbG9ndWUuJyArIGRvbWFpbiArICcvLndlbGwta25vd24vZGF0YXNjaGVtYS9Db21tdW5pY2F0aW9uJztcclxuXHJcbi8vICAgIF90aGlzLl9pbnZpdGF0aW9uc0hhbmRsZXIgPSBuZXcgSW52aXRhdGlvbnNIYW5kbGVyKGh5cGVydHlVUkwpO1xyXG5cclxuICB9XHJcblxyXG4vKiAgZ2V0IGludml0YXRpb25zSGFuZGxlcigpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnZpdGF0aW9uc0hhbmRsZXI7XHJcbiAgfSovXHJcblxyXG4gIGdldCB1cmwoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jb250cm9sbGVyTW9kZSA9PT0gJ3JlcG9ydGVyJyA/IHRoaXMuZGF0YU9iamVjdFJlcG9ydGVyLnVybCA6IHRoaXMuZGF0YU9iamVjdE9ic2VydmVyLnVybDtcclxuICB9XHJcblxyXG4gIHNldCBkYXRhT2JqZWN0UmVwb3J0ZXIoZGF0YU9iamVjdFJlcG9ydGVyKSB7XHJcblxyXG4gICAgaWYgKCFkYXRhT2JqZWN0UmVwb3J0ZXIpIHRocm93IG5ldyBFcnJvcignW0NoYXRDb250cm9sbGVyXSBUaGUgZGF0YSBvYmplY3QgcmVwb3J0ZXIgaXMgbmVjZXNzYXJ5IHBhcmFtZXRlciAnKTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuY29udHJvbGxlck1vZGUgPSAncmVwb3J0ZXInO1xyXG5cclxuICAgIC8vIEhhbmRsZXIgdG8gcHJvY2VzcyByZWNlaXZlZCBmaWxlc1xyXG5cclxuICAgIC8vIGRhdGFPYmplY3RSZXBvcnRlci5vblJlc3BvbnNlKGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAvLyAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFJlcG9ydGVyIC0gb25SZXNwb25zZV0nLCBldmVudCk7XHJcbiAgICAvLyAgIGlmIChfdGhpcy5fb25JbnZpdGF0aW9uUmVzcG9uc2UpIHtcclxuICAgIC8vICAgICBfdGhpcy5fb25JbnZpdGF0aW9uUmVzcG9uc2UoZXZlbnQpO1xyXG4gICAgLy8gICB9XHJcbiAgICAvL1xyXG4gICAgLy8gfSk7XHJcblxyXG4gICAgZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG4gICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcclxuICAgICAgICBjYXNlICdzdWJzY3JpYmUnOiBfdGhpcy5fb25TdWJzY3JpYmUoZXZlbnQpOyBicmVhaztcclxuICAgICAgICBjYXNlICd1bnN1YnNjcmliZSc6IF90aGlzLl9vblVuc3Vic2NyaWJlKGV2ZW50KTsgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIF90aGlzLl9zZXRPbkFkZENoaWxkTGlzdGVuZXIoZGF0YU9iamVjdFJlcG9ydGVyKTtcclxuXHJcbiAgICBkYXRhT2JqZWN0UmVwb3J0ZXIub25SZWFkKChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5hY2NlcHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRhdGFPYmplY3RSZXBvcnRlci5vbkV4ZWN1dGUoKGV2ZW50KSA9PiB7XHJcbiAgICAgIHN3aXRjaCAoZXZlbnQubWV0aG9kKSB7XHJcbiAgICAgICAgY2FzZSAnYWRkVXNlcic6XHJcbiAgICAgICAgICBfdGhpcy5hZGRVc2VyKGV2ZW50LnBhcmFtc1swXSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGV2ZW50LmFjY2VwdCgpO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlYXNvbjonLCByZWFzb24pO1xyXG4gICAgICAgICAgICBldmVudC5yZWplY3QocmVhc29uKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICdyZW1vdmVVc2VyJzpcclxuICAgICAgICAgICAgX3RoaXMucmVtb3ZlVXNlcihldmVudC5wYXJhbXMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGV2ZW50LmFjY2VwdCgpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdSZWFzb246JywgcmVhc29uKTtcclxuICAgICAgICAgICAgICBldmVudC5yZWplY3QocmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6IGV2ZW50LnJlamVjdCgnW0NoYXRDb250cm9sbGVyLm9uRXhlY3V0ZV0gQ2hhdCBtZXRob2QgZXhlY3V0aW9uIG5vdCBhY2NlcHRlZCBieSBSZXBvcnRlcicpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIF90aGlzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPSBkYXRhT2JqZWN0UmVwb3J0ZXI7XHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0IGRhdGFPYmplY3RSZXBvcnRlcigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjtcclxuICB9XHJcblxyXG4gIGdldCBtZXNzYWdlcygpIHtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5jb250cm9sbGVyTW9kZSA9PT0gJ3JlcG9ydGVyJyA/IHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5fY2hpbGRyZW5PYmplY3RzIDogdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyLl9jaGlsZHJlbk9iamVjdHM7XHJcbiAgfVxyXG5cclxuICBzZXQgZGF0YU9iamVjdE9ic2VydmVyKGRhdGFPYmplY3RPYnNlcnZlcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5jb250cm9sbGVyTW9kZSA9ICdvYnNlcnZlcic7XHJcblxyXG4gICAgX3RoaXMuX2RhdGFPYmplY3RPYnNlcnZlciA9IGRhdGFPYmplY3RPYnNlcnZlcjtcclxuXHJcbiAgICBkYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICBjb25zb2xlLmluZm8oJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlcl1PYnNlcnZlciAtIG9uQ2hhbmdlJywgZXZlbnQpO1xyXG5cclxuICAgICAgaWYgKGV2ZW50LmZpZWxkLmluY2x1ZGVzKCdwYXJ0aWNpcGFudHMnKSkge1xyXG4gICAgICAgIHN3aXRjaCAoZXZlbnQuY1R5cGUpIHtcclxuICAgICAgICAgIGNhc2UgJ2FkZCc6XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5fb25Vc2VyQWRkZWQpIF90aGlzLl9vblVzZXJBZGRlZChldmVudCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgIGNhc2UgJ3JlbW92ZSc6XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5fb25Vc2VyUmVtb3ZlZCkgX3RoaXMuX29uVXNlclJlbW92ZWQoZXZlbnQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChfdGhpcy5fb25DaGFuZ2UpIF90aGlzLl9vbkNoYW5nZShldmVudCk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgX3RoaXMuX3NldE9uQWRkQ2hpbGRMaXN0ZW5lcihkYXRhT2JqZWN0T2JzZXJ2ZXIpO1xyXG5cclxuICAgIC8vIGxldCBjaGlsZHJlbnMgPSBkYXRhT2JqZWN0T2JzZXJ2ZXIuY2hpbGRyZW5zO1xyXG4gICAgLy8gT2JqZWN0LmtleXMoY2hpbGRyZW5zKS5mb3JFYWNoKChjaGlsZCkgPT4ge1xyXG4gICAgLy8gICBpZiAoX3RoaXMuX29uTWVzc2FnZSkgX3RoaXMuX29uTWVzc2FnZSh7XHJcbiAgICAvLyAgICAgY2hpbGRJZDogY2hpbGQsXHJcbiAgICAvLyAgICAgaWRlbnRpdHk6IGNoaWxkcmVuc1tjaGlsZF0uaWRlbnRpdHksXHJcbiAgICAvLyAgICAgdmFsdWU6IGNoaWxkcmVuc1tjaGlsZF0uZGF0YVxyXG4gICAgLy8gICB9KTtcclxuICAgIC8vIH0pXHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0IGRhdGFPYmplY3RPYnNlcnZlcigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX2RhdGFPYmplY3RPYnNlcnZlcjtcclxuICB9XHJcblxyXG4gIF9zZXRPbkFkZENoaWxkTGlzdGVuZXIoZGF0YU9iamVjdCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgZGF0YU9iamVjdC5vbkFkZENoaWxkKGZ1bmN0aW9uKGNoaWxkKSB7XHJcbiAgICAgIF90aGlzLmNoaWxkX2NzZXEgKz0xO1xyXG4gICAgICBjb25zb2xlLmluZm8oJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5fc2V0T25BZGRDaGlsZExpc3RlbmVyXSBuZXcgQ2hpbGQgcmVjZWl2ZWQ6ICcsIGNoaWxkKTtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5fb25NZXNzYWdlKSBfdGhpcy5fb25NZXNzYWdlKGNoaWxkKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG5cclxuICBnZXQgZGF0YU9iamVjdCgpIHtcclxuICAgIHJldHVybiB0aGlzLmNvbnRyb2xsZXJNb2RlID09PSAncmVwb3J0ZXInID8gdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIgOiB0aGlzLmRhdGFPYmplY3RPYnNlcnZlcjtcclxuICB9XHJcblxyXG4gIHNldCBjbG9zZUV2ZW50KGV2ZW50KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX2Nsb3NlRXZlbnQgPSBldmVudDtcclxuXHJcbiAgICBpZiAoX3RoaXMuX29uQ2xvc2UpIF90aGlzLl9vbkNsb3NlKGV2ZW50KTtcclxuICB9XHJcblxyXG4gIGdldCBjbG9zZUV2ZW50KCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fY2xvc2VFdmVudDtcclxuICB9XHJcblxyXG5cclxuXHJcbiAgX29uU3Vic2NyaWJlKGV2ZW50KSB7XHJcblxyXG4gICAgbGV0IGRhdGFPYmplY3RSZXBvcnRlciA9IHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjtcclxuXHJcbiAgICBldmVudC5hY2NlcHQoKTtcclxuXHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5vblN1YnNjcmliZV0gZXZlbnQnLCBldmVudCwgZGF0YU9iamVjdFJlcG9ydGVyLnVybCk7XHJcbiAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLm9uU3Vic2NyaWJlXSBOZXcgdXNlciBoYXMgc3Vic2NyaWJlIHRoaXMgb2JqZWN0OiAnLCBkYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YSwgZXZlbnQuaWRlbnRpdHkpO1xyXG5cclxuICAgIGxldCBpZGVudGl0eSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZXZlbnQuaWRlbnRpdHkpKTtcclxuXHJcbiAgICBpZiAoaWRlbnRpdHkuaGFzT3duUHJvcGVydHkoJ2Fzc2VydGlvbicpKSB7XHJcbiAgICAgIGRlbGV0ZSBpZGVudGl0eS5hc3NlcnRpb25cclxuICAgIH1cclxuXHJcbiAgICBsZXQgdXNlckluZm8gPSB7XHJcbiAgICAgIGh5cGVydHlVUkw6IGV2ZW50LnVybCxcclxuICAgICAgZG9tYWluOiBldmVudC5kb21haW4sXHJcbiAgICAgIGlkZW50aXR5OiBpZGVudGl0eVxyXG4gICAgfVxyXG4gICAgbGV0IHVzZXJVUkwgPSBldmVudC5pZGVudGl0eS51c2VyUHJvZmlsZS5ndWlkO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25TdWJzY3JpYmVdICBuZXcgcGFydGljaXBhbnQnLCB1c2VySW5mbyk7XHJcbiAgICBpZiAoZXZlbnQuaWRlbnRpdHkubGVnYWN5KSB7XHJcbiAgICAgdXNlckluZm8ubGVnYWN5ID0gZXZlbnQuaWRlbnRpdHkubGVnYWN5O1xyXG4gICAgfVxyXG5cclxuICAgIGRhdGFPYmplY3RSZXBvcnRlci5kYXRhLnBhcnRpY2lwYW50c1t1c2VyVVJMXSA9IHVzZXJJbmZvO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25TdWJzY3JpYmVdIGNvbW11bmljYXRpb25PYmplY3QgT0JKIGNoYXRjb250cm9sbGVyJywgZGF0YU9iamVjdFJlcG9ydGVyLmRhdGEucGFydGljaXBhbnRzKTtcclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25TdWJzY3JpYmUgLSBvblN1YnNjcmlwdGlvbl0gJywgdXNlckluZm8pO1xyXG4gICAgLy8gY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5vblN1YnNjcmliZSAtIHRoaXMuX29uVXNlckFkZGVkXSAnLCB0aGlzLl9vblVzZXJBZGRlZCk7XHJcblxyXG4gICAgaWYgKHRoaXMuX29uVXNlckFkZGVkKSB0aGlzLl9vblVzZXJBZGRlZCh1c2VySW5mbyk7XHJcbiAgfVxyXG5cclxuICBfb25VbnN1YnNjcmliZShldmVudCkge1xyXG4gICAgbGV0IGRhdGFPYmplY3RSZXBvcnRlciA9IHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLm9uVW5zdWJzY3JpYmVdIGV2ZW50JywgZXZlbnQsIGRhdGFPYmplY3RSZXBvcnRlci51cmwpO1xyXG5cclxuICAgIGxldCBwYXJ0aWNpcGFudCA9IGV2ZW50LmlkZW50aXR5LnVzZXJQcm9maWxlO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25VbnN1YnNjcmliZV0gIHBhcnRpY2lwYW50IGxlZnQnLCBwYXJ0aWNpcGFudCk7XHJcbiAgICBpZiAoZXZlbnQuaWRlbnRpdHkubGVnYWN5KSB7XHJcbiAgICAgIHBhcnRpY2lwYW50LmxlZ2FjeSA9IGV2ZW50LmlkZW50aXR5LmxlZ2FjeTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGUgZGF0YU9iamVjdFJlcG9ydGVyLmRhdGEucGFydGljaXBhbnRzW3BhcnRpY2lwYW50LnVzZXJVUkxdO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIub25VbnN1YnNjcmliZSAtIHRoaXMuX29uVXNlclJlbW92ZWRdICcsIHRoaXMub25Vc2VyUmVtb3ZlZCk7XHJcbiAgICBpZiAodGhpcy5fb25Vc2VyUmVtb3ZlZCkgdGhpcy5fb25Vc2VyUmVtb3ZlZChwYXJ0aWNpcGFudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gc2VuZCBhIGZpbGUuXHJcbiAgICogQHBhcmFtICB7c3RyaW5nfSAgICAgZmlsZSAgICAgICAgICAgICAgICAgICAgICAgIElzIHRoZSBmaWxlIHRvIGJlIHNlbnQuXHJcbiAgICogQHJldHVybiB7UHJvbWlzZTxDb21tdW5pY2F0aW9uLkNoYXRNZXNzYWdlPn0gICAgICAgIEl0IHJldHVybnMgdGhlIENoYXRNZXNzYWdlIGNoaWxkIG9iamVjdCBjcmVhdGVkIGJ5IHRoZSBTeW5jaGVyIGFzIGEgUHJvbWlzZS5cclxuICAgKi9cclxuICBzZW5kRmlsZShmaWxlKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBtb2RlID0gX3RoaXMuY29udHJvbGxlck1vZGU7XHJcbiAgICBsZXQgZGF0YU9iamVjdCA9IG1vZGUgPT09ICdyZXBvcnRlcicgPyBfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIgOiBfdGhpcy5kYXRhT2JqZWN0T2JzZXJ2ZXI7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IGlkZW50aXR5ID0ge1xyXG4gICAgICAgIHVzZXJQcm9maWxlOiBfdGhpcy5teUlkZW50aXR5XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBkYXRhT2JqZWN0LmFkZEh5cGVydHlSZXNvdXJjZSgncmVzb3VyY2VzJywgJ2ZpbGUnLCAgZmlsZSwgaWRlbnRpdHkpLnRoZW4oZnVuY3Rpb24ocmVzb3VyY2VGaWxlKSB7XHJcblxyXG4gICAgICAgICAgbGV0IGlkZW50aXR5ID0ge1xyXG4gICAgICAgICAgICAgIHVzZXJQcm9maWxlOiBfdGhpcy5teUlkZW50aXR5XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgbGV0IGZpbGVTZW50RXZ0ID0geyB2YWx1ZSA6IHJlc291cmNlRmlsZSwgaWRlbnRpdHk6IGlkZW50aXR5LCByZXNvdXJjZTogcmVzb3VyY2VGaWxlfTtcclxuXHJcbi8qICAgICAgICAgIGxldCByZXBvcnRlclN0YXR1cyA9IG5ldyBSZWdpc3RyYXRpb25TdGF0dXMoZGF0YU9iamVjdC51cmwsIF90aGlzLl9tYW5hZ2VyLl9ydW50aW1lVVJMLCBfdGhpcy5fbWFuYWdlci5faHlwZXJ0eVVSTCwgX3RoaXMuX21hbmFnZXIuX2J1cyApO1xyXG5cclxuICAgICAgICAgIC8vIHJlY3Vyc2l2ZSBmdW5jdGlvbiB0byBzeW5jIHdpdGggY2hhdCByZXBvcnRlclxyXG5cclxuICAgICAgICAgICAgbGV0IHNoYXJlMlJlcG9ydGVyID0gZnVuY3Rpb24oZmlsZSwgc3Vic2NyaWJlciwgZXZ0LCBzdGF0dXMpIHtcclxuICAgICAgICAgICAgICBsZXQgc3RhdHVzT2ZSZXBvcnRlciA9IHN0YXR1cztcclxuICAgICAgICAgICAgICBmaWxlLnNoYXJpbmdTdGF0dXMudGhlbihyZXNvbHZlKGV2dCkpLmNhdGNoKChyZXN1bHQpPT57XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLnNlbmRGaWxlXSBzaGFyZSBmYWlsZWQ6ICcsIHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgc3RhdHVzT2ZSZXBvcnRlci5vbkxpdmUoIHN1YnNjcmliZXIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHN0YXR1c09mUmVwb3J0ZXIudW5zdWJzY3JpYmVMaXZlKHN1YnNjcmliZXIpO1xyXG4gICAgICAgICAgICAgICAgZmlsZS5zaGFyZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgIHNoYXJlMlJlcG9ydGVyKGZpbGUsIHN1YnNjcmliZXIsIGV2dCwgc3RhdHVzT2ZSZXBvcnRlcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgLy9UT0RPOiBzdWJzY3JpYmUgdG8gc3luYyB3aGVuIHJlcG9ydGVyIGlzIGxpdmUuIE5ldyBzeW5jaGVkIG1lc3NhZ2VzIHNob3VsZCB0cmlnZ2VyIG9uTWVzc2FnZSBpZSBvbkNoaWxkXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0qL1xyXG5cclxuLy8gICAgICAgICAgICByZXNvdXJjZUZpbGUuc2hhcmUodHJ1ZSkudGhlbigoKT0+e1xyXG4gICAgICAgICAgICAgIHJlc29sdmUoZmlsZVNlbnRFdnQpO1xyXG4vLyAgICAgICAgICAgIH0pO1xyXG4vLyAgICAgICAgICAgIHNoYXJlMlJlcG9ydGVyKHJlc291cmNlRmlsZSwgX3RoaXMuX21hbmFnZXIuX2h5cGVydHlVUkwsIGZpbGVTZW50RXZ0LCByZXBvcnRlclN0YXR1cyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgY29uc29sZS5lcnJvcignUmVhc29uOicsIHJlYXNvbik7XHJcbiAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHNlbmQgYSBjaGF0IG1lc3NhZ2UuXHJcbiAgICogQHBhcmFtICB7c3RyaW5nfSAgICAgbWVzc2FnZSAgICAgICAgICAgICAgICAgICAgICAgIElzIHRoZSBDaGF0TWVzc2FnZSB0byBiZSBzZW50LlxyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8Q29tbXVuaWNhdGlvbi5DaGF0TWVzc2FnZT59ICAgICAgICBJdCByZXR1cm5zIHRoZSBDaGF0TWVzc2FnZSBjaGlsZCBvYmplY3QgY3JlYXRlZCBieSB0aGUgU3luY2hlciBhcyBhIFByb21pc2UuXHJcbiAgICovXHJcbiAgc2VuZChtZXNzYWdlLCBpZGVudGl0eSkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgbW9kZSA9IF90aGlzLmNvbnRyb2xsZXJNb2RlO1xyXG4gICAgbGV0IGRhdGFPYmplY3QgPSBtb2RlID09PSAncmVwb3J0ZXInID8gX3RoaXMuZGF0YU9iamVjdFJlcG9ydGVyIDogX3RoaXMuZGF0YU9iamVjdE9ic2VydmVyO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbi8vICAgICAgbGV0IF9kYXRhT2JqZWN0Q2hpbGQ7XHJcbiAgICAgIF90aGlzLmNoaWxkX2NzZXEgKz0gMTtcclxuICAgICAgbGV0IG1zZyA9IHtcclxuXHJcbi8qICAgICAgICB1cmw6IGRhdGFPYmplY3QuZGF0YS51cmwsXHJcbiAgICAgICAgY3NlcTogX3RoaXMuY2hpbGRfY3NlcSxcclxuICAgICAgICByZXBvcnRlcjogZGF0YU9iamVjdC5kYXRhLnJlcG9ydGVyLFxyXG4gICAgICAgIHNjaGVtYTogZGF0YU9iamVjdC5kYXRhLnNjaGVtYSxcclxuICAgICAgICBuYW1lOiBkYXRhT2JqZWN0LmRhdGEubmFtZSxcclxuICAgICAgICBjcmVhdGVkIDogbmV3IERhdGUoKS50b0pTT04oKSwqL1xyXG5cclxuICAgICAgICB0eXBlOiAnY2hhdCcsXHJcbiAgICAgICAgY29udGVudDogbWVzc2FnZVxyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgc2VuZGVyID0gaWRlbnRpdHkgPyBpZGVudGl0eSA6IHtcclxuICAgICAgICB1c2VyUHJvZmlsZTogX3RoaXMubXlJZGVudGl0eVxyXG4gICAgICB9O1xyXG5cclxuXHJcbiAgICAgIC8vIFRPRE86IGNoYW5nZSBjaGF0bWVzc2FnZXMgdG8gcmVzb3VyY2UgLSBjaGF0LCBmaWxlXHJcbiAgICAgIC8vIFRPRE86IGNoYW5nZSBtZXNzYWdlIHRvIGh5cGVydHlSZXNvdXJjZSAtIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvZGV2LXNlcnZpY2UtZnJhbWV3b3JrL3RyZWUvZGV2ZWxvcC9kb2NzL2RhdGFtb2RlbC9kYXRhLW9iamVjdHMvaHlwZXJ0eS1yZXNvdXJjZVxyXG4gICAgICAvLyBUT0RPOiBoYW5kbGUgd2l0aCBtdWx0aXBsZSByZXNvdXJjZXMgLSBpZiB0aGUgXCJtZXNzYWdlXCIgd2lsbCBiZSBkaWZmZXJlbnQgZm9yIGVhY2ggdHlwZSBvZiByZXNvdXJjZXNcclxuICAgICAgZGF0YU9iamVjdC5hZGRDaGlsZChtc2csIHNlbmRlcikudGhlbihmdW5jdGlvbihkYXRhT2JqZWN0Q2hpbGQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyXVthZGRDaGlsZCAtIENoYXQgTWVzc2FnZV06ICcsIGRhdGFPYmplY3RDaGlsZCk7XHJcbiAgICAgICAgLy9yZXNvbHZlKGRhdGFPYmplY3RDaGlsZCk7XHJcblxyXG4gICAgICAgIC8vVE9ETzogbW92ZSB0byBzZXBhcmF0ZSBmdW5jdGlvblxyXG5cclxuXHJcbiAgICAgICAgbGV0IG1zZyA9IHtcclxuICAgICAgICAgIGNoaWxkSWQ6IGRhdGFPYmplY3RDaGlsZC5fY2hpbGRJZCxcclxuICAgICAgICAgIGZyb206IGRhdGFPYmplY3RDaGlsZC5fb3duZXIsXHJcbiAgICAgICAgICB2YWx1ZTogZGF0YU9iamVjdENoaWxkLmRhdGEsXHJcbiAgICAgICAgICB0eXBlOiAnY3JlYXRlJyxcclxuICAgICAgICAgIGlkZW50aXR5OiBzZW5kZXJcclxuICAgICAgICB9O1xyXG5cclxuLyogICAgICAgIGxldCByZXBvcnRlclN0YXR1cyA9IG5ldyBSZWdpc3RyYXRpb25TdGF0dXMoZGF0YU9iamVjdC51cmwsIF90aGlzLl9tYW5hZ2VyLl9ydW50aW1lVVJMLCBfdGhpcy5fbWFuYWdlci5faHlwZXJ0eVVSTCwgX3RoaXMuX21hbmFnZXIuX2J1cyApO1xyXG5cclxuICAgICAgICAvLyByZWN1cnNpdmUgZnVuY3Rpb24gdG8gc3luYyB3aXRoIGNoYXQgcmVwb3J0ZXJcclxuXHJcbiAgICAgICAgICBsZXQgc2hhcmUyUmVwb3J0ZXIgPSBmdW5jdGlvbihjaGlsZCwgc3Vic2NyaWJlciwgbXNnLCBzdGF0dXMpIHtcclxuICAgICAgICAgICAgbGV0IHN0YXR1c09mUmVwb3J0ZXIgPSBzdGF0dXM7XHJcbiAgICAgICAgICAgIGNoaWxkLnNoYXJpbmdTdGF0dXMudGhlbihyZXNvbHZlKG1zZykpLmNhdGNoKChyZXN1bHQpPT57XHJcblxyXG4gICAgICAgICAgICAgICAgc3RhdHVzT2ZSZXBvcnRlci5vbkxpdmUoIHN1YnNjcmliZXIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgc3RhdHVzT2ZSZXBvcnRlci51bnN1YnNjcmliZUxpdmUoc3Vic2NyaWJlcik7XHJcbiAgICAgICAgICAgICAgICAgIGNoaWxkLnNoYXJlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICBzaGFyZTJSZXBvcnRlcihjaGlsZCwgc3Vic2NyaWJlciwgbXNnLCBzdGF0dXNPZlJlcG9ydGVyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgLy9UT0RPOiBzdWJzY3JpYmUgdG8gc3luYyB3aGVuIHJlcG9ydGVyIGlzIGxpdmUuIE5ldyBzeW5jaGVkIG1lc3NhZ2VzIHNob3VsZCB0cmlnZ2VyIG9uTWVzc2FnZSBpZSBvbkNoaWxkXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSovXHJcblxyXG4vLyAgICAgICAgICBzaGFyZTJSZXBvcnRlcihkYXRhT2JqZWN0Q2hpbGQsIF90aGlzLl9tYW5hZ2VyLl9oeXBlcnR5VVJMLCBtc2csIHJlcG9ydGVyU3RhdHVzKTtcclxuLy8gICAgICAgIGRhdGFPYmplY3RDaGlsZC5zaGFyZSh0cnVlKTtcclxuICAgICAgICAgIHJlc29sdmUobXNnKTtcclxuXHJcblxyXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlYXNvbjonLCByZWFzb24pO1xyXG4gICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBbb25DaGFuZ2UgZGVzY3JpcHRpb25dXHJcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIFtkZXNjcmlwdGlvbl1cclxuICAgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG4gICAqL1xyXG4gIG9uQ2hhbmdlKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX29uQ2hhbmdlID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVjZWl2ZSBuZXcgbWVzc2FnZXMuXHJcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIEZ1bmN0aW9uIHRvIGhhbmRsZSB3aXRoIG5ldyBtZXNzYWdlc1xyXG4gICAqIEByZXR1cm4ge0NvbW11bmljYXRpb24uQ2hhdE1lc3NhZ2V9IG1cclxuICAgKi9cclxuICBvbk1lc3NhZ2UoY2FsbGJhY2spIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fb25NZXNzYWdlID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBbb25Vc2VyQWRkZWQgZGVzY3JpcHRpb25dXHJcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIFtkZXNjcmlwdGlvbl1cclxuICAgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG4gICAqL1xyXG4gIG9uVXNlckFkZGVkKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX29uVXNlckFkZGVkID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHRoZSBhbiB1c2VyIHdhcyByZW1vdmVkXHJcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIEZ1bmN0aW9uIGhhbmRsZSB3aXRoIHRoZSByZW1vdmVkIHVzZXJcclxuICAgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgICAgW2Rlc2NyaXB0aW9uXVxyXG4gICAqL1xyXG4gIG9uVXNlclJlbW92ZWQoY2FsbGJhY2spIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fb25Vc2VyUmVtb3ZlZCA9IGNhbGxiYWNrO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlY2VpdmUgcmVxdWVzdHMgdG8gY2xvc2UgdGhlIEdyb3VwIENoYXQgaW5zdGFuY2UuXHJcbiAgICogQHJldHVybiB7RGVsZXRlRXZlbnR9IFRoZSBEZWxldGVFdmVudCBmaXJlZCBieSB0aGUgU3luY2hlciB3aGVuIHRoZSBDaGF0IGlzIGNsb3NlZC5cclxuICAgKi9cclxuICBvbkNsb3NlKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX29uQ2xvc2UgPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIG9uUmVzcG9uc2UoY2FsbGJhY2spIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fb25SZXNwb25zZSA9IGNhbGxiYWNrO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGFkZCAvIGludml0ZSBuZXcgdXNlciBvbiBhbiBleGlzdGluZyBHcm91cCBDaGF0IGluc3RhbmNlLlxyXG4gICAqIE9ubHkgdGhlIFJlcG9ydGVyLCBpLmUuIHRoZSBIeXBlcnR5IHRoYXQgaGFzIGNyZWF0ZWQgdGhlIEdyb3VwIENoYXQsIGlzIGFsbG93ZWQgdG8gdXNlIHRoaXMgZnVuY3Rpb24uXHJcbiAgICogQHBhcmFtIHtVUkwuVXNlclVSTH0gIHVzZXJzICBVc2VyIHRvIGJlIGludml0ZWQgdG8gam9pbiB0aGUgR3JvdXAgQ2hhdCB0aGF0IGlzIGlkZW50aWZpZWQgd2l0aCByZVRISU5LIFVzZXIgVVJMLlxyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8Ym9vbGVhbj59ICAgSXQgcmV0dXJucyBhcyBhIFByb21pc2UgdHJ1ZSBpZiBzdWNjZXNzZnVsbHkgaW52aXRlZCBvciBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICovXHJcbi8qICBhZGRVc2VyKHVzZXJzKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgaGF2ZUVtcHR5RWxlbWVudHMgPSAoZWxlbWVudCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZygnRWxlbWVudDonLCBlbGVtZW50Lmxlbmd0aCk7XHJcbiAgICAgIHJldHVybiBlbGVtZW50Lmxlbmd0aCAhPT0gMDtcclxuICAgIH07XHJcblxyXG4gICAgbGV0IG5vdEZvdW5kRWxlbWVudHMgPSAoZWxlbWVudCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZygndXNlciBub3QgZm91bmQ6ICcsIGVsZW1lbnQpO1xyXG4gICAgICByZXR1cm4gIShlbGVtZW50IGluc3RhbmNlb2YgU3RyaW5nKTtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgaWYgKHVzZXJzLmZpbHRlcihoYXZlRW1wdHlFbGVtZW50cykubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdCgnRG9uXFwndCBoYXZlIHVzZXJzIHRvIGludml0ZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmluZm8oJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5hZGRVc2VycyBdOiAnLCB1c2Vycyk7XHJcblxyXG4gICAgICAvKl90aGlzLnNlYXJjaC51c2Vycyh1c2VycywgZG9tYWlucywgWydjb21tJ10sIFsnY2hhdCddKVxyXG5cclxuICAgIC50aGVuKChoeXBlcnRpZXNJRHMpID0+IHtcclxuXHJcbiAgICAgIGlmIChoeXBlcnRpZXNJRHMuZmlsdGVyKG5vdEZvdW5kRWxlbWVudHMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHRocm93ICdVc2VyKHMpIG5vdCBmb3VuZCc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBzZWxlY3RlZEh5cGVydGllcyA9IGh5cGVydGllc0lEcy5tYXAoKGh5cGVydHkpID0+IHtcclxuICAgICAgICByZXR1cm4gaHlwZXJ0eS5oeXBlcnR5SUQ7XHJcbiAgICAgIH0pOyovXHJcblxyXG4vKiAgICAgIGxldCB1c2Vyc0Rpc2NvdmVyeSA9IFtdO1xyXG4gICAgICBsZXQgZGlzY29ubmVjdGVkID0gW107XHJcbiAgICAgIGxldCBsaXZlID0ge307XHJcblxyXG4gICAgICB1c2Vycy5mb3JFYWNoKCh1c2VyKSA9PiB7XHJcbiAgICAgICAgbGV0IHVzZXJEaXNjb3ZlcnlQcm9taXNlID0gX3RoaXMuZGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0aWVzRE8odXNlci51c2VyLCBbJ2NvbW0nXSwgWydjaGF0J10sIHVzZXIuZG9tYWluKTtcclxuICAgICAgICAgIHVzZXJzRGlzY292ZXJ5LnB1c2godXNlckRpc2NvdmVyeVByb21pc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgUHJvbWlzZS5hbGwodXNlcnNEaXNjb3ZlcnkpLnRoZW4oKHVzZXJEaXNjb3ZlcnlSZXN1bHRzKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlci5hZGRVc2Vyc10gVXNlcnMgRGlzY292ZXJ5IFJlc3VsdHMtPicsIHVzZXJEaXNjb3ZlcnlSZXN1bHRzKTtcclxuXHJcbiAgICAgICAgbGV0IHNlbGVjdGVkSHlwZXJ0aWVzID0gW107XHJcblxyXG4gICAgICAgICB1c2VyRGlzY292ZXJ5UmVzdWx0cy5mb3JFYWNoKCh1c2VyRGlzY292ZXJ5UmVzdWx0KSA9PiB7XHJcblxyXG4gICAgICAgICAgIHVzZXJEaXNjb3ZlcnlSZXN1bHQuZm9yRWFjaCgoZGlzY292ZXJlZCk9PntcclxuICAgICAgICAgICAgIGlmIChkaXNjb3ZlcmVkLmRhdGEuc3RhdHVzID09PSAnbGl2ZScpe1xyXG4gICAgICAgICAgICAgICBzZWxlY3RlZEh5cGVydGllcy5wdXNoKGRpc2NvdmVyZWQuZGF0YS5oeXBlcnR5SUQpO1xyXG4gICAgICAgICAgICAgICBsaXZlW2Rpc2NvdmVyZWQuZGF0YS5oeXBlcnR5SURdID0gZGlzY292ZXJlZDtcclxuICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIGVsc2UgaWYgKGRpc2Nvbm5lY3RlZC5sZW5ndGggPCA1KSBkaXNjb25uZWN0ZWQucHVzaChkaXNjb3ZlcmVkKTtcclxuICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyXS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBTeW5jaGVyIENyZWF0ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFxcbicpO1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbygnW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyXVNlbGVjdGVkIEh5cGVydGllczogISEhICcsIHNlbGVjdGVkSHlwZXJ0aWVzKTtcclxuICAgICAgICBjb25zb2xlLmluZm8oYEhhdmUgJHtzZWxlY3RlZEh5cGVydGllcy5sZW5ndGh9IHVzZXJzO2ApO1xyXG4vLyAgICAgICAgY29uc29sZS5pbmZvKCdbQ2hhdE1hbmFnZXJdIEh5cGVydGllc0lEcyAnLCBoeXBlcnRpZXNJRHMpO1xyXG5cclxuICAgICAgICBsZXQgZGF0YU9iamVjdCA9IF90aGlzLmNvbnRyb2xsZXJNb2RlID09PSAncmVwb3J0ZXInID8gX3RoaXMuZGF0YU9iamVjdFJlcG9ydGVyIDogX3RoaXMuZGF0YU9iamVjdE9ic2VydmVyO1xyXG5cclxuICAgICAgICBpZiAoZGlzY29ubmVjdGVkLmxlbmd0aCA+IDApIF90aGlzLl9pbnZpdGF0aW9uc0hhbmRsZXIuaW52aXRlRGlzY29ubmVjdGVkSHlwZXJ0aWVzKGRpc2Nvbm5lY3RlZCwgZGF0YU9iamVjdCk7XHJcblxyXG4gICAgICAgIGRhdGFPYmplY3QuaW52aXRlT2JzZXJ2ZXJzKHNlbGVjdGVkSHlwZXJ0aWVzKTtcclxuXHJcbiAgICAgICAgaWYgKGRhdGFPYmplY3QuaW52aXRhdGlvbnMubGVuZ3RoID4gMCkgX3RoaXMuX2ludml0YXRpb25zSGFuZGxlci5wcm9jZXNzSW52aXRhdGlvbnMobGl2ZSwgZGF0YU9iamVjdCk7XHJcblxyXG4gICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmluZm8oJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlcl1BcmUgaW52aXRlZCB3aXRoIHN1Y2Nlc3MgJyArIHVzZXJzLmxlbmd0aCArICcgdXNlcnM7Jyk7XHJcbiAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdHJ5aW5nIHRvIGludml0ZSB1c2VycztcXG4nLCByZWFzb24pO1xyXG4gICAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH0qL1xyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVxdWVzdCB0aGUgUmVwb3J0ZXIgdG8gYWRkIC8gaW52aXRlIG5ldyB1c2VyIG9uIGFuIGV4aXN0aW5nIEdyb3VwIENoYXQgaW5zdGFuY2UuXHJcbiAgICogT25seSBPYnNlcnZlcnMgYXJlIGFsbG93ZWQgdG8gdXNlIHRoaXMgZnVuY3Rpb24uXHJcbiAgICogQHBhcmFtIHtVUkwuVXNlclVSTH0gIHVzZXJzICBVc2VyIHRvIGJlIGludml0ZWQgdG8gam9pbiB0aGUgR3JvdXAgQ2hhdCB0aGF0IGlzIGlkZW50aWZpZWQgd2l0aCByZVRISU5LIFVzZXIgVVJMLlxyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8Ym9vbGVhbj59ICAgSXQgcmV0dXJucyBhcyBhIFByb21pc2UgdHJ1ZSBpZiBzdWNjZXNzZnVsbHkgaW52aXRlZCBvciBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICovXHJcbi8qICBhZGRVc2VyUmVxKHVzZXJzKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAvL2NoZWNrIGlzIE9ic2VydmVyIGFuZCBpbnZva2Ugb2JzZXJ2ZXIuZXhlY3V0ZSgpIHdpdGggbmV3IHByb21pc2VcclxuICAgIGxldCBoYXZlRW1wdHlFbGVtZW50cyA9IChlbGVtZW50KSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdFbGVtZW50OicsIGVsZW1lbnQubGVuZ3RoKTtcclxuICAgICAgcmV0dXJuIGVsZW1lbnQubGVuZ3RoICE9PSAwO1xyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBpZiAodXNlcnMuZmlsdGVyKGhhdmVFbXB0eUVsZW1lbnRzKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gcmVqZWN0KCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIuYWRkVXNlclJlcV0gRG9uXFwndCBoYXZlIHVzZXJzIHRvIGFkZCcpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghX3RoaXMuY29udHJvbGxlck1vZGUgPT09ICdvYnNlcnZlcicpIHtcclxuICAgICAgICByZXR1cm4gcmVqZWN0KCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIuYWRkVXNlclJlcV0gb25seSBhbGxvd2VkIHRvIENoYXQgT2JzZXJ2ZXInKTtcclxuXHJcbiAgICAgIGxldCBhZGRVc2VyID0gX3RoaXMuYWRkVXNlcih1c2Vycyk7XHJcblxyXG4gICAgICBpZiAoX3RoaXMuX2RhdGFPYmplY3RPYnNlcnZlcikge1xyXG4gICAgICAgIGFkZFVzZXIgPSBfdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyLmV4ZWN1dGUoJ2FkZFVzZXInLCB1c2Vycyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFkZFVzZXIudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdbQ2hhdE1hbmFnZXIuQ2hhdENvbnRyb2xsZXIuYWRkVXNlclJlcV0gUmVxdWVzdCBhY2NlcHRlZCBieSBSZXBvcnRlciAnKTtcclxuICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignW0NoYXRNYW5hZ2VyLkNoYXRDb250cm9sbGVyLmFkZFVzZXJSZXFdIFJlcXVlc3QgcmVqZWN0ZWQgYnkgUmVwb3J0ZXI7XFxuJywgcmVhc29uKTtcclxuICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxufSovXHJcblxyXG4gIG9uSW52aXRhdGlvblJlc3BvbnNlKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX29uSW52aXRhdGlvblJlc3BvbnNlID0gY2FsbGJhY2s7XHJcbi8vICAgIF90aGlzLl9pbnZpdGF0aW9uc0hhbmRsZXIuaW52aXRhdGlvblJlc3BvbnNlID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlbW92ZSBhIHVzZXIgZnJvbSBhbiBleGlzdGluZyBHcm91cCBDaGF0IGluc3RhbmNlLlxyXG4gICAqIE9ubHkgdGhlIFJlcG9ydGVyLCBpLmUuIHRoZSBIeXBlcnR5IHRoYXQgaGFzIGNyZWF0ZWQgdGhlIEdyb3VwIENoYXQsIGlzIGFsbG93ZWQgdG8gdXNlIHRoaXMgZnVuY3Rpb24uXHJcbiAgICogQHJldHVybiB7PFByb21pc2U+IGJvb2xlYW59IFByb21pc2Ugd2l0aCB0aGUgc3RhdHVzXHJcbiAgICovXHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byByZW1vdmUgYSB1c2VyIGZyb20gYW4gZXhpc3RpbmcgR3JvdXAgQ2hhdCBpbnN0YW5jZS5cclxuICAgKiBPbmx5IHRoZSBSZXBvcnRlciwgaS5lLiB0aGUgSHlwZXJ0eSB0aGF0IGhhcyBjcmVhdGVkIHRoZSBHcm91cCBDaGF0LCBpcyBhbGxvd2VkIHRvIHVzZSB0aGlzIGZ1bmN0aW9uLlxyXG4gICAqIEBwYXJhbSAge1VSTC5Vc2VyVVJMfSB1c2VyICAgICAgIFVzZXIgdG8gYmUgcmVtb3ZlZCBmcm9tIHRoZSBHcm91cCBDaGF0IHRoYXQgaXMgaWRlbnRpZmllZCB3aXRoIHJlVEhJTksgVXNlciBVUkwuXHJcbiAgICogQHJldHVybiB7PFByb21pc2U+IGJvb2xlYW59ICAgICAgSXQgcmV0dXJucyBhcyBhIFByb21pc2UgdHJ1ZSBpZiBzdWNjZXNzZnVsbHkgcmVtb3ZlZCBvciBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICovXHJcbiAgcmVtb3ZlVXNlcih1c2VyKSB7XHJcblxyXG4gICAgLy8gVE9ETzogaW1wbGVtZW50IHRoZSByZW1vdmVVc2VyO1xyXG4gICAgY29uc29sZS5sb2coJ1tDaGF0TWFuYWdlci5DaGF0Q29udHJvbGxlcl1Ob3QgeWV0IGltcGxlbWVudGVkOiAnLCB1c2VyKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY2xvc2UgYW4gZXhpc3RpbmcgR3JvdXAgQ2hhdCBpbnN0YW5jZS5cclxuICAgKiBPbmx5IGF2YWlsYWJsZSB0byBDaGF0IEdyb3VwIFJlcG9ydGVycyBpLmUuIHRoZSBIeXBlcnR5IGluc3RhbmNlIHRoYXQgY3JlYXRlZCB0aGUgR3JvdXAgQ2hhdC5cclxuICAgKiBAcmV0dXJuIHs8UHJvbWlzZT5Cb29sZWFufSBJdCByZXR1cm5zIGFzIGEgUHJvbWlzZSB0cnVlIGlmIHN1Y2Nlc3NmdWxseSBjbG9zZWQgb3IgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAqL1xyXG4gIGNsb3NlKGRlbCA9IHRydWUpIHtcclxuICAgIC8vIFRPRE86IHRoZSBkYXRhT2JqZWN0UmVwb3J0ZXIuZGVsZXRlIHNob3VsZCBiZSBhIFByb21pc2U7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIFxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBcclxuICAgICAgaWYgKF90aGlzLmNvbnRyb2xsZXJNb2RlID09PSAncmVwb3J0ZXInKSB7XHJcbiAgICAgICAgLy8gcmVwb3J0ZXJcclxuLy8gICAgICAgIF90aGlzLl9pbnZpdGF0aW9uc0hhbmRsZXIuY2xlYW5JbnZpdGF0aW9ucyhfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgaWYgKCFkZWwpIHtcclxuICAgICAgICAgICAgX3RoaXMuX21hbmFnZXIuY29tbXVuaWNhdGlvbk9iamVjdC5zdGF0dXMgPSAnY2xvc2VkJztcclxuICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcblxyXG4gICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fbWFuYWdlci5fcmVwb3J0ZXJzQ29udHJvbGxlcnNbX3RoaXMuZGF0YU9iamVjdFJlcG9ydGVyLnVybF07XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5kYXRhT2JqZWN0UmVwb3J0ZXIuZGVsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLl9vbkNsb3NlKSBfdGhpcy5fb25DbG9zZSh7XHJcbiAgICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcclxuICAgICAgICAgICAgICAgICAgZGVzYzogJ2RlbGV0ZWQnLFxyXG4gICAgICAgICAgICAgICAgICB1cmw6IF90aGlzLmRhdGFPYmplY3RSZXBvcnRlci51cmxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICAgICAgICAgIHJlamVjdChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gb2JzZXJ2ZXJcclxuICAgICAgICBpZihkZWwpe1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZGVsZXRlIF90aGlzLl9tYW5hZ2VyLl9vYnNlcnZlcnNDb250cm9sbGVyc1tfdGhpcy5kYXRhT2JqZWN0T2JzZXJ2ZXIudXJsXTtcclxuICAgICAgICAgICAgX3RoaXMuZGF0YU9iamVjdE9ic2VydmVyLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgIHJlamVjdChmYWxzZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAvLyBUT0RPOiBzZW5kIG1lc3NhZ2UgXHJcbiAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIH0gXHJcbiAgICAgICAgXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDaGF0O1xyXG4iLCJcclxuLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5cclxuLy8gU2VydmljZSBGcmFtZXdvcmtcclxuLy9pbXBvcnQgSWRlbnRpdHlNYW5hZ2VyIGZyb20gJy4uL2lkZW50aXR5TWFuYWdlci9JZGVudGl0eU1hbmFnZXInO1xyXG4vL2ltcG9ydCBSZWdpc3RyYXRpb25TdGF0dXMgZnJvbSAnLi4vZGlzY292ZXJ5L1JlZ2lzdHJhdGlvblN0YXR1cyc7XHJcbi8vaW1wb3J0IERpc2NvdmVyeSBmcm9tICcuLi9kaXNjb3ZlcnkvRGlzY292ZXJ5JztcclxuLy9pbXBvcnQgU3luY2hlciBmcm9tICcuLi9zeW5jaGVyL1N5bmNoZXInO1xyXG5cclxuLy8gVXRpbHNcclxuLy9pbXBvcnQge2RpdmlkZVVSTH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG4vL2ltcG9ydCBTZWFyY2ggZnJvbSAnLi4vdXRpbHMvU2VhcmNoJztcclxuXHJcbi8vIEludGVybmFsc1xyXG5pbXBvcnQgeyBjb21tdW5pY2F0aW9uT2JqZWN0LCBDb21tdW5pY2F0aW9uU3RhdHVzLCBjb21tdW5pY2F0aW9uQ2hpbGRyZW4gfSBmcm9tICcuL2NvbW11bmljYXRpb24nO1xyXG5pbXBvcnQgQ2hhdCBmcm9tICcuL0NoYXQnO1xyXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gJy4vVXNlckluZm8nO1xyXG5cclxuLyoqXHJcbiogSHlwZXJ0eSBTaW1wbGUgR3JvdXAgQ2hhdCBNYW5hZ2VyIEFQSSBcclxuKiBAYXV0aG9yIFZpdG9yIFNpbHZhIFt2aXRvci10LXNpbHZhQHRlbGVjb20ucHRdXHJcbiogQHZlcnNpb24gMC4xLjBcclxuKi9cclxuY2xhc3MgU2ltcGxlU2ltcGxlQ2hhdE1hbmFnZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcihteVVybCwgYnVzLCBjb25maWd1cmF0aW9uLCBzeW5jaGVyLCBmYWN0b3J5KSB7XHJcbiAgICBpZiAoIW15VXJsKSB0aHJvdyBuZXcgRXJyb3IoJ1tTaW1wbGVDaGF0TWFuYWdlci5jb25zdHJ1Y3Rvcl0gVGhlIG15VXJsIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO1xyXG4gICAgaWYgKCFidXMpIHRocm93IG5ldyBFcnJvcignW1NpbXBsZUNoYXRNYW5hZ2VyLmNvbnN0cnVjdG9yXSBUaGUgTWluaUJ1cyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTtcclxuICAgIGlmICghY29uZmlndXJhdGlvbikgdGhyb3cgbmV3IEVycm9yKCdbU2ltcGxlQ2hhdE1hbmFnZXIuY29uc3RydWN0b3JdIFRoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBpZiAoIXN5bmNoZXIpIHtcclxuICAgICAgc3luY2hlciA9IGZhY3RvcnkuY3JlYXRlU3luY2hlcihteVVybCwgYnVzLCBjb25maWd1cmF0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICBfdGhpcy5fcnVudGltZVVSTCA9IGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTDtcclxuXHJcbiAgICBsZXQgZG9tYWluID0gZmFjdG9yeS5kaXZpZGVVUkwoX3RoaXMuX3J1bnRpbWVVUkwpLmRvbWFpbjtcclxuLy8gICAgbGV0IGRpc2NvdmVyeSA9IGZhY3RvcnkuY3JlYXRlRGlzY292ZXJ5KG15VXJsLCBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkwsIGJ1cyk7XHJcbiAgICBsZXQgaWRlbnRpdHlNYW5hZ2VyID0gZmFjdG9yeS5jcmVhdGVJZGVudGl0eU1hbmFnZXIobXlVcmwsIGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTCwgYnVzKTtcclxuXHJcbiAgICBfdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nICsgZG9tYWluICsgJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hL0NvbW11bmljYXRpb24nO1xyXG5cclxuICAgIF90aGlzLl9yZXBvcnRlcnNDb250cm9sbGVycyA9IHt9O1xyXG4gICAgX3RoaXMuX29ic2VydmVyc0NvbnRyb2xsZXJzID0ge307XHJcblxyXG4gICAgX3RoaXMuX215VXJsID0gbXlVcmw7XHJcbiAgICBfdGhpcy5fYnVzID0gYnVzO1xyXG4gICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyO1xyXG4gICAgX3RoaXMuX2RvbWFpbiA9IGRvbWFpbjtcclxuXHJcbi8vICAgIF90aGlzLmRpc2NvdmVyeSA9IGRpc2NvdmVyeTtcclxuICAgIF90aGlzLmlkZW50aXR5TWFuYWdlciA9IGlkZW50aXR5TWFuYWdlcjtcclxuICAgIF90aGlzLmN1cnJlbnRJZGVudGl0eTtcclxuXHJcbi8vICAgIF90aGlzLnNlYXJjaCA9IGZhY3RvcnkuY3JlYXRlU2VhcmNoKGRpc2NvdmVyeSwgaWRlbnRpdHlNYW5hZ2VyKTtcclxuXHJcbiAgICBfdGhpcy5jb21tdW5pY2F0aW9uT2JqZWN0ID0gY29tbXVuaWNhdGlvbk9iamVjdDtcclxuXHJcbiAgICBfdGhpcy5jb21tdW5pY2F0aW9uQ2hpbGRyZW4gPSBjb21tdW5pY2F0aW9uQ2hpbGRyZW47XHJcblxyXG4vLyAgICBjb25zb2xlLmxvZygnW1NpbXBsZUNoYXRNYW5hZ2VyXSBEaXNjb3ZlciAnLCBkaXNjb3ZlcnkpO1xyXG4gICAgY29uc29sZS5sb2coJ1tTaW1wbGVDaGF0TWFuYWdlcl0gSWRlbnRpdHkgTWFuYWdlciAnLCBpZGVudGl0eU1hbmFnZXIpO1xyXG5cclxuXHJcbiAgfVxyXG5cclxuICBzZXQgb2ZmbGluZShvZmZsaW5lKSB7XHJcbiAgICB0aGlzLl9vZmZsaW5lID0gb2ZmbGluZTtcclxuICB9XHJcblxyXG4gIGdldCBvZmZsaW5lKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX29mZmxpbmUgPyB0aGlzLl9vZmZsaW5lIDogZmFsc2U7XHJcbiAgfVxyXG5cclxuICBzZXQgYmFja3VwKGJhY2t1cCkge1xyXG4gICAgdGhpcy5fYmFja3VwID0gYmFja3VwO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGJhY2t1cCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9iYWNrdXAgPyB0aGlzLl9iYWNrdXAgOiBmYWxzZTtcclxuICB9XHJcblxyXG4gIHByb2Nlc3NOb3RpZmljYXRpb24oZXZlbnQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZygnW1NpbXBsZUNoYXRNYW5hZ2VyLnByb2Nlc3NOb3RpZmljYXRpb246ICcsIGV2ZW50KTtcclxuXHJcbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2NyZWF0ZScpIHtcclxuXHJcbiAgICAgIC8vIFRPRE86IHJlcGxhY2UgdGhlIDEwMCBmb3IgTWVzc2FnZS5SZXNwb25zZVxyXG4gICAgICAvLyBldmVudC5hY2soMjAwKTtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5fb25JbnZpdGF0aW9uKSB7IF90aGlzLl9vbkludml0YXRpb24oZXZlbnQpOyB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGV2ZW50LnR5cGUgPT09ICdkZWxldGUnKSB7XHJcbiAgICAgIC8vIFRPRE86IHJlcGxhY2UgdGhlIDIwMCBmb3IgTWVzc2FnZS5SZXNwb25zZVxyXG4gICAgICBldmVudC5hY2soMjAwKTtcclxuXHJcbiAgICAgIF90aGlzLl9vYnNlcnZlcnNDb250cm9sbGVyc1tldmVudC51cmxdLmNsb3NlRXZlbnQgPSBldmVudDtcclxuXHJcbiAgICAgIGRlbGV0ZSBfdGhpcy5fb2JzZXJ2ZXJzQ29udHJvbGxlcnNbZXZlbnQudXJsXTtcclxuXHJcbiAgICAgIF90aGlzLl9vYnNlcnZlcnNDb250cm9sbGVycy5jbG9zZUV2ZW50ID0gZXZlbnQ7XHJcblxyXG4gICAgICBfdGhpcy5jb21tdW5pY2F0aW9uT2JqZWN0ID0gY29tbXVuaWNhdGlvbk9iamVjdDtcclxuXHJcblxyXG4gICAgICBmb3IgKGxldCB1cmwgaW4gdGhpcy5fcmVwb3J0ZXJzQ29udHJvbGxlcnMpIHtcclxuICAgICAgICB0aGlzLl9yZXBvcnRlcnNDb250cm9sbGVyc1t1cmxdLmNsb3NlKGV2ZW50KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZm9yIChsZXQgdXJsIGluIHRoaXMuX29ic2VydmVyc0NvbnRyb2xsZXJzKSB7XHJcbiAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzQ29udHJvbGxlcnNbdXJsXS5jbG9zZShldmVudCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBteUlkZW50aXR5KGlkZW50aXR5KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuaW5mbygnW1NpbXBsZUNoYXRNYW5hZ2VyLm15SWRlbnRpdHldJyk7XHJcbiAgICAgIGlmIChpZGVudGl0eSkgcmV0dXJuIHJlc29sdmUoaWRlbnRpdHkpO1xyXG5cclxuICAgICAgaWYgKF90aGlzLl9teVVybC5pbmNsdWRlcygnaHlwZXJ0eTovLycpKSB7XHJcbiAgICAgICAgX3RoaXMuaWRlbnRpdHlNYW5hZ2VyLmRpc2NvdmVyVXNlclJlZ2lzdGVyZWQoKS50aGVuKChpZGVudGl0eSkgPT4ge1xyXG4gICAgICAgICAgX3RoaXMuY3VycmVudElkZW50aXR5ID0gaWRlbnRpdHk7XHJcbiAgICAgICAgICByZXNvbHZlKGlkZW50aXR5KTtcclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIF90aGlzLmlkZW50aXR5TWFuYWdlci5kaXNjb3ZlcklkZW50aXR5UGVySWRQKCkudGhlbigoaWRlbnRpdHkpID0+IHtcclxuICAgICAgICAgIF90aGlzLmN1cnJlbnRJZGVudGl0eSA9IGlkZW50aXR5O1xyXG4gICAgICAgICAgcmVzb2x2ZShpZGVudGl0eSk7XHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIGEgbmV3IEdyb3VwIENoYXQgcHJvdmlkaW5nIHRoZSBuYW1lIGFuZCB0aGUgaWRlbnRpZmllcnMgb2YgdXNlcnMgdG8gYmUgaW52aXRlZC5cclxuICAgKiBAcGFyYW0gIHtzdHJpbmd9ICAgICAgICAgICAgICAgICAgICAgbmFtZSAgSXMgYSBzdHJpbmcgdG8gaWRlbnRpZnkgdGhlIEdyb3VwIENoYXRcclxuICAgKiBAcGFyYW0gIHthcnJheTxVUkwuSHlwZXJ0eVVSTD59ICAgICAgICAgaHlwZXJ0aWVzIEFycmF5IG9mIGh5cGVydGllcyB0byBiZSBpbnZpdGVkIHRvIGpvaW4gdGhlIEdyb3VwIENoYXQuIFVzZXJzIGFyZSBpZGVudGlmaWVkIHdpdGggcmVUSElOSyBVc2VyIFVSTCwgbGlrZSB0aGlzIGZvcm1hdCB1c2VyOi8vPGlwZGRvbWFpbj4vPHVzZXItaWRlbnRpZmllcj5cclxuICAgKiBAcmV0dXJuIHs8UHJvbWlzZT5DaGF0Q29udHJvbGxlcn0gICAgQSBDaGF0Q29udHJvbGxlciBvYmplY3QgYXMgYSBQcm9taXNlLlxyXG4gICAqL1xyXG4gIGNyZWF0ZShuYW1lLCBoeXBlcnRpZXMsIGV4dHJhID0ge30pIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IHN5bmNoZXIgPSBfdGhpcy5fc3luY2hlcjtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgX3RoaXMuY29tbXVuaWNhdGlvbk9iamVjdCA9IGNvbW11bmljYXRpb25PYmplY3Q7XHJcbiAgICAgIF90aGlzLmNvbW11bmljYXRpb25PYmplY3QuY3NlcSA9IDE7XHJcbiAgICAgIF90aGlzLmNvbW11bmljYXRpb25PYmplY3Quc3RhcnRpbmdUaW1lID0gbmV3IERhdGUoKS50b0pTT04oKTtcclxuICAgICAgX3RoaXMuY29tbXVuaWNhdGlvbk9iamVjdC5zdGF0dXMgPSAgQ29tbXVuaWNhdGlvblN0YXR1cy5PUEVOO1xyXG5cclxuICAgICAgbGV0IG15SWRlbnRpdHk7XHJcblxyXG4gICAgICBfdGhpcy5teUlkZW50aXR5KCkudGhlbigoaWRlbnRpdHkpID0+IHtcclxuICAgICAgICBteUlkZW50aXR5ID0gaWRlbnRpdHk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tTaW1wbGVDaGF0TWFuYWdlci5jcmVhdGUgXSBNeSBJZGVudGl0eScsIGlkZW50aXR5KTtcclxuXHJcbiAgICAgICAgLy8gbGV0IHVybCA9IF90aGlzLmNvbW11bmljYXRpb25PYmplY3QucmVwb3J0ZXI7XHJcblxyXG4gICAgICAgIGxldCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhfdGhpcy5fbXlVcmwsIF90aGlzLl9kb21haW4sIGlkZW50aXR5KTtcclxuXHJcbiAgICAgICAgLy8gQWRkIG15IGlkZW50aXR5XHJcbiAgICAgICAgX3RoaXMuY29tbXVuaWNhdGlvbk9iamVjdC5wYXJ0aWNpcGFudHNbaWRlbnRpdHkuZ3VpZF0gPSB1c2VySW5mbztcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tTaW1wbGVDaGF0TWFuYWdlci5jcmVhdGUgXSBwYXJ0aWNpcGFudHM6ICcsIF90aGlzLmNvbW11bmljYXRpb25PYmplY3QucGFydGljaXBhbnRzKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnW1NpbXBsZUNoYXRNYW5hZ2VyLmNyZWF0ZSBdIGNvbW11bmljYXRpb25PYmplY3QnLCBfdGhpcy5jb21tdW5pY2F0aW9uT2JqZWN0KTtcclxuXHJcblxyXG4gICAgICAgICAgY29uc29sZS5pbmZvKCdbU2ltcGxlQ2hhdE1hbmFnZXJdIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gU3luY2hlciBDcmVhdGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBcXG4nKTtcclxuICAgICAgICAgIGNvbnNvbGUuaW5mbygnW1NpbXBsZUNoYXRNYW5hZ2VyXSBTZWxlY3RlZCBIeXBlcnRpZXM6ICEhISAnLCBoeXBlcnRpZXMpO1xyXG4vLyAgICAgICAgICBjb25zb2xlLmluZm8oYEhhdmUgJHtoeXBlcnRpZXMubGVuZ3RofSB1c2VycztgKTtcclxuICAgICAgICAgIGxldCBtdXR1YWwgPSBleHRyYS5tdXR1YWwgPyBleHRyYS5tdXR1YWwgOiB0cnVlO1xyXG5cclxuICAgICAgICAgIGxldCBpbnB1dCA9IE9iamVjdC5hc3NpZ24oe3Jlc291cmNlczogWydjaGF0J10sIG11dHVhbDogbXV0dWFsfSwgZXh0cmEpO1xyXG4gICAgICAgICAgZGVsZXRlIGlucHV0Lm5hbWU7XHJcblxyXG4gICAgICAgICAgaWYgKF90aGlzLm9mZmxpbmUpIGlucHV0Lm9mZmxpbmUgPSBfdGhpcy5vZmZsaW5lO1xyXG4gICAgICAgICAgaWYgKF90aGlzLmJhY2t1cCkgaW5wdXQuYmFja3VwID0gX3RoaXMuYmFja3VwO1xyXG5cclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2ltcGxlQ2hhdE1hbmFnZXJdIGlucHV0IGRhdGE6JywgaW5wdXQpO1xyXG4gICAgICAgICAgcmV0dXJuIHN5bmNoZXIuY3JlYXRlKF90aGlzLl9vYmplY3REZXNjVVJMLCBoeXBlcnRpZXMsIF90aGlzLmNvbW11bmljYXRpb25PYmplY3QsIHRydWUsIGZhbHNlLCBuYW1lLCB7fSwgaW5wdXQpO1xyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oZGF0YU9iamVjdFJlcG9ydGVyKSB7XHJcblxyXG4gICAgICAgICAgY29uc29sZS5pbmZvKCdbU2ltcGxlQ2hhdE1hbmFnZXJdIDMuIFJldHVybiBDcmVhdGUgRGF0YSBPYmplY3QgUmVwb3J0ZXInLCBkYXRhT2JqZWN0UmVwb3J0ZXIpO1xyXG5cclxuICAgICAgICAgIGxldCBjaGF0ID0gbmV3IENoYXQoc3luY2hlciwgX3RoaXMuX2RvbWFpbiwgbXlJZGVudGl0eSwgX3RoaXMpO1xyXG4gICAgICAgICAgY2hhdC5kYXRhT2JqZWN0UmVwb3J0ZXIgPSBkYXRhT2JqZWN0UmVwb3J0ZXI7XHJcblxyXG4gICAgICAgICAgX3RoaXMuX3JlcG9ydGVyc0NvbnRyb2xsZXJzW2RhdGFPYmplY3RSZXBvcnRlci51cmxdID0gY2hhdDtcclxuXHJcbi8vICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2ltcGxlQ2hhdE1hbmFnZXJdIGNoYXQgaW52aXRhdGlvbnNIYW5kbGVyOiAnLCAgIGNoYXQuaW52aXRhdGlvbnNIYW5kbGVyKTtcclxuXHJcbiAgICAgICAgICAvLyBwcm9jZXNzIGludml0YXRpb25zIHRvIGhhbmRsZSBub3QgcmVjZWl2ZWQgaW52aXRhdGlvbnNcclxuLyogICAgICAgICAgaWYgKGRhdGFPYmplY3RSZXBvcnRlci5pbnZpdGF0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNoYXQuaW52aXRhdGlvbnNIYW5kbGVyLnByb2Nlc3NJbnZpdGF0aW9ucyhsaXZlLCBkYXRhT2JqZWN0UmVwb3J0ZXIpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIElmIGFueSBpbnZpdGVkIFVzZXIgaXMgZGlzY29ubmVjdGVkIGxldCdzIHdhaXQgdW50aWwgaXQgaXMgY29ubmVjdGVkIGFnYWluXHJcbiAgICAgICAgICBpZiAoZGlzY29ubmVjdGVkLmxlbmd0aCA+IDApIGNoYXQuaW52aXRhdGlvbnNIYW5kbGVyLmludml0ZURpc2Nvbm5lY3RlZEh5cGVydGllcyhkaXNjb25uZWN0ZWQsIGRhdGFPYmplY3RSZXBvcnRlcik7XHJcbiovXHJcbiAgICAgICAgICByZXNvbHZlKGNoYXQpO1xyXG5cclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbU2ltcGxlQ2hhdE1hbmFnZXIuY3JlYXRlXSBNeUlkZW50aXR5IEVycm9yOicsIHJlYXNvbik7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdChyZWFzb24pO1xyXG4gICAgICB9KTtcclxuLy8gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBoYW5kbGUgbm90aWZpY2F0aW9ucyBhYm91dCBpbmNvbWluZyBpbnZpdGF0aW9ucyB0byBqb2luIGEgR3JvdXAgQ2hhdC5cclxuICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gQ3JlYXRlRXZlbnQgVGhlIENyZWF0ZUV2ZW50IGZpcmVkIGJ5IHRoZSBTeW5jaGVyIHdoZW4gYW4gaW52aXRhaW9uIGlzIHJlY2VpdmVkXHJcbiAgICovXHJcbiAgb25JbnZpdGF0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX29uSW52aXRhdGlvbiA9IGNhbGxiYWNrO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGpvaW4gYSBHcm91cCBDaGF0LlxyXG4gICAqIEBwYXJhbSAge1VSTC5Db21tdW5pY2F0aW9uVVJMfSBpbnZpdGF0aW9uVVJMICBUaGUgQ29tbXVuaWNhdGlvbiBVUkwgb2YgdGhlIEdyb3VwIENoYXQgdG8gam9pbiB0aGF0IGlzIHByb3ZpZGVkIGluIHRoZSBpbnZpdGF0aW9uIGV2ZW50XHJcbiAgICogQHJldHVybiB7PFByb21pc2U+Q2hhdENvbnRyb2xsZXJ9ICAgICAgICAgICAgIEl0IHJldHVybnMgdGhlIENoYXRDb250cm9sbGVyIG9iamVjdCBhcyBhIFByb21pc2VcclxuICAgKi9cclxuICBqb2luKGludml0YXRpb25VUkwsIG11dHVhbCA9IGZhbHNlLCBpZGVudGl0eSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIGxldCBzeW5jaGVyID0gX3RoaXMuX3N5bmNoZXI7XHJcbiAgICAgIGxldCBteUlkZW50aXR5O1xyXG5cclxuICAgICAgY29uc29sZS5pbmZvKCdbU2ltcGxlQ2hhdE1hbmFnZXJdIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBTeW5jaGVyIHN1YnNjcmliZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFxcbicpO1xyXG4gICAgICBjb25zb2xlLmluZm8oJ2ludml0YXRpb25VUkwnLCBpbnZpdGF0aW9uVVJMKTtcclxuICAgICAgX3RoaXMubXlJZGVudGl0eShpZGVudGl0eSkudGhlbigoaWRlbnRpdHkpID0+IHtcclxuICAgICAgICBteUlkZW50aXR5ID0gaWRlbnRpdHk7XHJcbiAgICAgICAgbGV0IGlucHV0ID0ge1xyXG4gICAgICAgICAgc2NoZW1hOiBfdGhpcy5fb2JqZWN0RGVzY1VSTCxcclxuICAgICAgICAgIHJlc291cmNlOiBpbnZpdGF0aW9uVVJMLFxyXG4gICAgICAgICAgc3RvcmU6IHRydWUsXHJcbiAgICAgICAgICBwMnA6IGZhbHNlLFxyXG4gICAgICAgICAgbXV0dWFsOiBtdXR1YWwsXHJcbiAgICAgICAgICBkb21haW5fc3Vic2NyaXB0aW9uOiB0cnVlLFxyXG4gICAgICAgICAgaWRlbnRpdHk6IGlkZW50aXR5XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKF90aGlzLm9mZmxpbmUpIGlucHV0Lm9mZmxpbmUgPSBfdGhpcy5vZmZsaW5lO1xyXG5cclxuICAgICAgICByZXR1cm4gc3luY2hlci5zdWJzY3JpYmUoaW5wdXQpO1xyXG5cclxuICAgICAgfSkudGhlbihmdW5jdGlvbihkYXRhT2JqZWN0T2JzZXJ2ZXIpIHtcclxuICAgICAgICBjb25zb2xlLmluZm8oJ0RhdGEgT2JqZWN0IE9ic2VydmVyOiAnLCBkYXRhT2JqZWN0T2JzZXJ2ZXIpO1xyXG5cclxuICAgICAgICBsZXQgY2hhdCA9IG5ldyBDaGF0KHN5bmNoZXIsIF90aGlzLl9kb21haW4sIG15SWRlbnRpdHksIF90aGlzKTtcclxuICAgICAgICByZXNvbHZlKGNoYXQpO1xyXG5cclxuICAgICAgICBjaGF0LmRhdGFPYmplY3RPYnNlcnZlciA9IGRhdGFPYmplY3RPYnNlcnZlcjtcclxuXHJcbiAgICAgICAgX3RoaXMuX29ic2VydmVyc0NvbnRyb2xsZXJzW2RhdGFPYmplY3RPYnNlcnZlci51cmxdID0gY2hhdDtcclxuXHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbikge1xyXG4gICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTaW1wbGVTaW1wbGVDaGF0TWFuYWdlcjtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5pbXBvcnQgU3luY2hlciBmcm9tICcuLi9zeW5jaGVyL1N5bmNoZXInO1xyXG5pbXBvcnQgTm90aWZpY2F0aW9uSGFuZGxlciBmcm9tICcuLi9zeW5jaGVyL05vdGlmaWNhdGlvbkhhbmRsZXInO1xyXG5pbXBvcnQge2RpdmlkZVVSTH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgSWRlbnRpdHlNYW5hZ2VyIGZyb20gJy4uL2lkZW50aXR5L0lkZW50aXR5TWFuYWdlcic7XHJcbmltcG9ydCBEaXNjb3ZlcnkgZnJvbSAnLi4vZGlzY292ZXJ5L0Rpc2NvdmVyeSc7XHJcbmltcG9ydCBSZWdpc3RyYXRpb25TdGF0dXMgZnJvbSAnLi4vZGlzY292ZXJ5L1JlZ2lzdHJhdGlvblN0YXR1cyc7XHJcbmltcG9ydCBTZWFyY2ggZnJvbSAnLi4vdXRpbHMvU2VhcmNoJztcclxuaW1wb3J0IENvbnRleHRPYnNlcnZlciBmcm9tICcuLi9jb250ZXh0TWFuYWdlci9Db250ZXh0T2JzZXJ2ZXInO1xyXG5pbXBvcnQgQ29udGV4dFJlcG9ydGVyIGZyb20gJy4uL2NvbnRleHRNYW5hZ2VyL0NvbnRleHRSZXBvcnRlcic7XHJcbmltcG9ydCBNZXNzYWdlQm9keUlkZW50aXR5IGZyb20gJy4uL2lkZW50aXR5L01lc3NhZ2VCb2R5SWRlbnRpdHknO1xyXG5pbXBvcnQgQ2hhdE1hbmFnZXIgZnJvbSAnLi4vY2hhdE1hbmFnZXIvQ2hhdE1hbmFnZXInO1xyXG5pbXBvcnQgQ2hhdENvbnRyb2xsZXIgZnJvbSAnLi4vY2hhdE1hbmFnZXIvQ2hhdENvbnRyb2xsZXInO1xyXG5pbXBvcnQgU2ltcGxlQ2hhdE1hbmFnZXIgZnJvbSAnLi4vY2hhdE1hbmFnZXIvU2ltcGxlQ2hhdE1hbmFnZXInO1xyXG5pbXBvcnQgQ2hhdCBmcm9tICcuLi9jaGF0TWFuYWdlci9DaGF0JztcclxuXHJcbi8qKlxyXG4gKiBJbnRlcm5hbCBjb21wb25lbnQgdG8gaW5zdGFudGlhdGUgZnJhbWV3b3JrIGZ1bmN0aW9uYWxpdGllcy5cclxuICovXHJcbmNsYXNzIFNhbmRib3hGYWN0b3J5IHtcclxuICAvKiBwcml2YXRlXHJcbiAgX2NvbXBvbmVudHM6IDx1cmw6IGluc3RhbmNlPlxyXG4gICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKGJ1cykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9idXMgPSBidXM7XHJcbiAgICBfdGhpcy5fZGl2aWRlVVJMID0gZGl2aWRlVVJMO1xyXG5cclxuICB9XHJcblxyXG4gIGNyZWF0ZVN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7IFxyXG4gICAgcmV0dXJuIG5ldyBTeW5jaGVyKG93bmVyLCBidXMsIGNvbmZpZyk7XHJcbiAgIH1cclxuXHJcbiAgIGNyZWF0ZUlkZW50aXR5TWFuYWdlcihoeXBlcnR5VVJMLCBydW50aW1lVVJMLCBidXMpIHsgXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIG5ldyBJZGVudGl0eU1hbmFnZXIoaHlwZXJ0eVVSTCwgcnVudGltZVVSTCwgYnVzKTtcclxuICAgfVxyXG5cclxuICAgY3JlYXRlRGlzY292ZXJ5KGh5cGVydHlVUkwsIHJ1bnRpbWVVUkwsIGJ1cykgeyBcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gbmV3IERpc2NvdmVyeShoeXBlcnR5VVJMLCBydW50aW1lVVJMLCBidXMpO1xyXG4gICB9XHJcblxyXG4gICBjcmVhdGVTZWFyY2goZGlzY292ZXJ5LCBpZGVudGl0eU1hbmFnZXIpIHsgXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIG5ldyBTZWFyY2goZGlzY292ZXJ5LCBpZGVudGl0eU1hbmFnZXIpO1xyXG4gICB9XHJcblxyXG4gICBjcmVhdGVDb250ZXh0T2JzZXJ2ZXIoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWcsIHNjaGVtZXMpIHsgXHJcbiAgICByZXR1cm4gbmV3IENvbnRleHRPYnNlcnZlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZywgc2NoZW1lcywgdGhpcyk7XHJcbiAgIH1cclxuXHJcbiAgIGNyZWF0ZUNvbnRleHRSZXBvcnRlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZykgeyBcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gbmV3IENvbnRleHRSZXBvcnRlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZywgdGhpcyk7XHJcbiAgIH1cclxuXHJcbiAgIGNyZWF0ZU5vdGlmaWNhdGlvbkhhbmRsZXIoYnVzKSB7IFxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgTm90aWZpY2F0aW9uSGFuZGxlcihidXMpO1xyXG4gICB9XHJcblxyXG4gICBjcmVhdGVNZXNzYWdlQm9keUlkZW50aXR5KHVzZXJuYW1lLCB1c2VyVVJMLCBwaWN0dXJlLCBuYW1lLCBsb2NhbGUsIGlkcCwgYXNzZXJ0aW9uLCBwcm9maWxlKSB7IFxyXG4gICAgcmV0dXJuIG5ldyBNZXNzYWdlQm9keUlkZW50aXR5KHVzZXJuYW1lLCB1c2VyVVJMLCBwaWN0dXJlLCBuYW1lLCBsb2NhbGUsIGlkcCwgYXNzZXJ0aW9uLCBwcm9maWxlKTtcclxuICAgfVxyXG5cclxuICAgY3JlYXRlQ2hhdE1hbmFnZXIoaHlwZXJ0eVVSTCwgYnVzLCBjb25maWd1cmF0aW9uLCBzeW5jaGVyKSB7IFxyXG4gICAgcmV0dXJuIG5ldyBDaGF0TWFuYWdlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24sIHN5bmNoZXIsIHRoaXMpO1xyXG4gICB9XHJcblxyXG4gICBjcmVhdGVDaGF0Q29udHJvbGxlcihzeW5jaGVyLCBkaXNjb3ZlcnksIGRvbWFpbiwgc2VhcmNoLCBpZGVudGl0eSwgbWFuYWdlcikgeyBcclxuICAgIHJldHVybiBuZXcgQ2hhdENvbnRyb2xsZXIoc3luY2hlciwgZGlzY292ZXJ5LCBkb21haW4sIHNlYXJjaCwgaWRlbnRpdHksIG1hbmFnZXIpO1xyXG4gICB9XHJcblxyXG4gICBjcmVhdGVTaW1wbGVDaGF0TWFuYWdlcihoeXBlcnR5VVJMLCBidXMsIGNvbmZpZ3VyYXRpb24sIHN5bmNoZXIpIHsgXHJcbiAgICByZXR1cm4gbmV3IFNpbXBsZUNoYXRNYW5hZ2VyKGh5cGVydHlVUkwsIGJ1cywgY29uZmlndXJhdGlvbiwgc3luY2hlciwgdGhpcyk7XHJcbiAgIH1cclxuXHJcbiAgIGNyZWF0ZUNoYXQoc3luY2hlciwgZG9tYWluLCBpZGVudGl0eSwgbWFuYWdlcikgeyBcclxuICAgIHJldHVybiBuZXcgQ2hhdChzeW5jaGVyLCBkb21haW4sIGlkZW50aXR5LCBtYW5hZ2VyKTtcclxuICAgfVxyXG4gICBnZXQgZGl2aWRlVVJMKCl7XHJcbiAgICAgcmV0dXJuIHRoaXMuX2RpdmlkZVVSTDtcclxuICAgfVxyXG5cclxuICAgY3JlYXRlUmVnaXN0cmF0aW9uU3RhdHVzKG9ic2VydmVyLCBydW50aW1lVVJMLCBjaGF0VXJsLCBidXMpIHtcclxuICAgIHJldHVybiBuZXcgUmVnaXN0cmF0aW9uU3RhdHVzKG9ic2VydmVyLCBydW50aW1lVVJMLCBjaGF0VXJsLCBidXMpO1xyXG5cclxuICB9XHJcblxyXG5cclxuXHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBTYW5kYm94RmFjdG9yeTtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG4vKipcclxuICogQGF1dGhvciBtaWNhZWxwZWRyb3NhQGdtYWlsLmNvbVxyXG4gKiBCYXNlIGNsYXNzIHRvIGltcGxlbWVudCBpbnRlcm5hbCBkZXBsb3kgbWFuYWdlciBvZiBjb21wb25lbnRzLlxyXG4gKi9cclxuaW1wb3J0IFNhbmRib3hGYWN0b3J5IGZyb20gJy4vU2FuZGJveEZhY3RvcnknO1xyXG5cclxuLyoqXHJcbiAqIEBhdXRob3IgbWljYWVscGVkcm9zYUBnbWFpbC5jb21cclxuICogSW50ZXJuYWwgY29tcG9uZW50IHJlZ2lzdHJ5IG9mIGFsbCBzYW5kYm94ZXMuXHJcbiAqIFByb2Nlc3MgaW50ZXJuYWwgcmVxdWVzdCdzIGZvciBjb21wb25lbnQgZGVwbG95LlxyXG4gKi9cclxuY2xhc3MgU2FuZGJveFJlZ2lzdHJ5IHtcclxuICAvKiBwcml2YXRlXHJcbiAgX2NvbXBvbmVudHM6IDx1cmw6IGluc3RhbmNlPlxyXG4gICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKGJ1cykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fYnVzID0gYnVzO1xyXG4gICAgX3RoaXMuX2ZhY3RvcnkgPSBuZXcgU2FuZGJveEZhY3RvcnkoYnVzKTtcclxuICAgIF90aGlzLl9jb21wb25lbnRzID0ge307XHJcblxyXG4gICAgYnVzLmFkZExpc3RlbmVyKFNhbmRib3hSZWdpc3RyeS5JbnRlcm5hbERlcGxveUFkZHJlc3MsIChtc2cpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ1NhbmRib3hSZWdpc3RyeS1SQ1Y6ICcsIG1zZyk7XHJcbiAgICAgIC8vIGxldCByZXNwb25zZU1zZyA9IHtcclxuICAgICAgLy8gICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBTYW5kYm94UmVnaXN0cnkuSW50ZXJuYWxEZXBsb3lBZGRyZXNzLCB0bzogU2FuZGJveFJlZ2lzdHJ5LkV4dGVybmFsRGVwbG95QWRkcmVzc1xyXG4gICAgICAvLyB9O1xyXG5cclxuICAgICAgc3dpdGNoIChtc2cudHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ2NyZWF0ZSc6IF90aGlzLl9vbkRlcGxveShtc2cpOyBicmVhaztcclxuICAgICAgICBjYXNlICdkZWxldGUnOiBfdGhpcy5fb25SZW1vdmUobXNnKTsgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNvbXBvbmVudHMoKSB7IHJldHVybiB0aGlzLl9jb21wb25lbnRzOyB9XHJcblxyXG4gIF9yZXNwb25zZU1zZyhtc2csIGNvZGUsIHZhbHVlKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAvLyBsZXQgbWVzc2FnZUZhY3RvcnkgPSBfdGhpcy5tZXNzYWdlRmFjdG9yeTtcclxuXHJcbiAgICAvL0ZMT1ctT1VUOiBnZW5lcmljIHJlc3BvbnNlIG1lc3NhZ2UgdG8gZXh0ZXJuYWwgU2FuZGJveCAoZGVwbG95IGFuZCB1bi1kZXBsb3kgcmVzcG9uc2VzKVxyXG4gICAgbGV0IHJlc3BvbnNlTXNnID0ge1xyXG4gICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBTYW5kYm94UmVnaXN0cnkuSW50ZXJuYWxEZXBsb3lBZGRyZXNzLCB0bzogU2FuZGJveFJlZ2lzdHJ5LkV4dGVybmFsRGVwbG95QWRkcmVzc1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBDaGFuZWdlIHRoZSBvcmlnaW4gbWVzc2FnZSwgYmVjYXVzZSB0aGUgcmVzcG9uc2U7XHJcbiAgICAvLyBtc2cuZnJvbSA9IFNhbmRib3hSZWdpc3RyeS5JbnRlcm5hbERlcGxveUFkZHJlc3M7XHJcbiAgICAvLyBtc2cudG8gPSBTYW5kYm94UmVnaXN0cnkuRXh0ZXJuYWxEZXBsb3lBZGRyZXNzO1xyXG5cclxuICAgIGxldCBib2R5ID0ge307XHJcbiAgICBpZiAoY29kZSkgYm9keS5jb2RlID0gY29kZTtcclxuICAgIGlmICh2YWx1ZSkgYm9keS5kZXNjID0gdmFsdWU7XHJcblxyXG4gICAgcmVzcG9uc2VNc2cuYm9keSA9IGJvZHk7XHJcblxyXG4gICAgLy8gcmV0dXJuIG1lc3NhZ2VGYWN0b3J5LmNyZWF0ZVJlc3BvbnNlKG1zZywgY29kZSwgdmFsdWUpO1xyXG4gICAgcmV0dXJuIHJlc3BvbnNlTXNnO1xyXG4gIH1cclxuXHJcbiAgLy9GTE9XLUlOOiBtZXNzYWdlIGZyb20gdGhlIHJ1bnRpbWUgY29yZSBTYW5kYm94IC0+IGRlcGxveUNvbXBvbmVudFxyXG4gIF9vbkRlcGxveShtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgY29uZmlnID0gbXNnLmJvZHkuY29uZmlnO1xyXG4gICAgbGV0IGNvbXBvbmVudFVSTCA9IG1zZy5ib2R5LnVybDtcclxuICAgIGxldCBzb3VyY2VDb2RlID0gbXNnLmJvZHkuc291cmNlQ29kZTtcclxuICAgIGxldCByZXNwb25zZUNvZGU7XHJcbiAgICBsZXQgcmVzcG9uc2VEZXNjO1xyXG5cclxuICAgIGlmICghX3RoaXMuX2NvbXBvbmVudHMuaGFzT3duUHJvcGVydHkoY29tcG9uZW50VVJMKSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZygnU2FuZGJveFJlZ2lzdHJ5LW9uRGVwbG95OiAnLCBtc2cpO1xyXG4gICAgICBfdGhpcy5fY29tcG9uZW50c1tjb21wb25lbnRVUkxdID0gX3RoaXMuX2NyZWF0ZShjb21wb25lbnRVUkwsIHNvdXJjZUNvZGUsIGNvbmZpZywgX3RoaXMuX2ZhY3RvcnkgKTtcclxuICAgICAgICByZXNwb25zZUNvZGUgPSAyMDA7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgcmVzcG9uc2VDb2RlID0gNTAwO1xyXG4gICAgICAgIHJlc3BvbnNlRGVzYyA9IGVycm9yO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXNwb25zZUNvZGUgPSA1MDA7XHJcbiAgICAgIHJlc3BvbnNlRGVzYyA9ICdJbnN0YW5jZSAnICsgY29tcG9uZW50VVJMICsgJyBhbHJlYWR5IGV4aXN0ISc7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHJlc3BvbnNlTXNnID0gX3RoaXMuX3Jlc3BvbnNlTXNnKG1zZywgcmVzcG9uc2VDb2RlLCByZXNwb25zZURlc2MpO1xyXG4gICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXNwb25zZU1zZyk7XHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgZnJvbSB0aGUgcnVudGltZSBjb3JlIFNhbmRib3ggLT4gcmVtb3ZlQ29tcG9uZW50XHJcbiAgX29uUmVtb3ZlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBjb21wb25lbnRVUkwgPSBtc2cuYm9keS51cmw7XHJcbiAgICBsZXQgcmVzcG9uc2VDb2RlO1xyXG4gICAgbGV0IHJlc3BvbnNlRGVzYztcclxuXHJcbiAgICBpZiAoX3RoaXMuX2NvbXBvbmVudHMuaGFzT3duUHJvcGVydHkoY29tcG9uZW50VVJMKSkge1xyXG4gICAgICAvL3JlbW92ZSBjb21wb25lbnQgZnJvbSB0aGUgcG9vbCBhbmQgYWxsIGxpc3RlbmVyc1xyXG4gICAgICBkZWxldGUgX3RoaXMuX2NvbXBvbmVudHNbY29tcG9uZW50VVJMXTtcclxuICAgICAgX3RoaXMuX2J1cy5yZW1vdmVBbGxMaXN0ZW5lcnNPZihjb21wb25lbnRVUkwpO1xyXG4gICAgICByZXNwb25zZUNvZGUgPSAyMDA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXNwb25zZUNvZGUgPSA1MDA7XHJcbiAgICAgIHJlc3BvbnNlRGVzYyA9ICdJbnN0YW5jZSAnICsgY29tcG9uZW50VVJMICsgJyBkb2VzblxcJ3QgZXhpc3QhJztcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcmVzcG9uc2VNc2cgPSBfdGhpcy5fcmVzcG9uc2VNc2cobXNnLCByZXNwb25zZUNvZGUsIHJlc3BvbnNlRGVzYyk7XHJcblxyXG4gICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXNwb25zZU1zZyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIG1ldGhvZCBzaG91bGQgYmUgaW1wbGVtZW50ZWQgYnkgdGhlIGludGVybmFsIHNhbmRib3ggY29kZS5cclxuICAgKiBAcGFyYW0gIHtDb21wb25lbnRVUkx9IHVybCBVUkwgdXNlZCBmb3IgdGhlIGluc3RhbmNlXHJcbiAgICogQHBhcmFtICB7c3RyaW5nfSBzb3VyY2VDb2RlIENvZGUgb2YgdGhlIGNvbXBvbmVudFxyXG4gICAqIEBwYXJhbSAge0NvbmZpZ30gY29uZmlnIENvbmZpZ3VyYXRpb24gcGFyYW1ldGVyc1xyXG4gICAqIEByZXR1cm4ge09iamVjdH0gUmV0dXJucyBpbnN0YW5jZSBvZiB0aGUgY29tcG9uZW50IG9yIHRocm93IGFuIGVycm9yIFwidGhyb3cgJ2Vycm9yIG1lc3NhZ2UnXCJcclxuICAgKi9cclxuICBfY3JlYXRlKHVybCwgc291cmNlQ29kZSwgY29uZmlnLCBmYWN0b3J5KSB7XHJcbiAgICAvL2ltcGxlbWVudGF0aW9uIHNwZWNpZmljXHJcbiAgICAvKiBleGFtcGxlIGNvZGU6XHJcbiAgICAgIGV2YWwoc291cmNlQ29kZSk7XHJcbiAgICAgIHJldHVybiBhY3RpdmF0ZSh1cmwsIF90aGlzLl9idXMsIGNvbmZpZyk7XHJcbiAgICAqL1xyXG4gIH1cclxufVxyXG5cclxuU2FuZGJveFJlZ2lzdHJ5LkV4dGVybmFsRGVwbG95QWRkcmVzcyA9ICdoeXBlcnR5LXJ1bnRpbWU6Ly9zYW5kYm94L2V4dGVybmFsJztcclxuU2FuZGJveFJlZ2lzdHJ5LkludGVybmFsRGVwbG95QWRkcmVzcyA9ICdoeXBlcnR5LXJ1bnRpbWU6Ly9zYW5kYm94L2ludGVybmFsJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNhbmRib3hSZWdpc3RyeTtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5cclxuLy8gTG9nIHN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignQnVzJyk7XHJcblxyXG4vKipcclxuKiBAYXV0aG9yIG1pY2FlbHBlZHJvc2FAZ21haWwuY29tXHJcbiogTWluaW1hbCBpbnRlcmZhY2UgYW5kIGltcGxlbWVudGF0aW9uIHRvIHNlbmQgYW5kIHJlY2VpdmUgbWVzc2FnZXMuIEl0IGNhbiBiZSByZXVzZWQgaW4gbWFueSB0eXBlIG9mIGNvbXBvbmVudHMuXHJcbiogQ29tcG9uZW50cyB0aGF0IG5lZWQgYSBtZXNzYWdlIHN5c3RlbSBzaG91bGQgcmVjZWl2ZSB0aGlzIGNsYXNzIGFzIGEgZGVwZW5kZW5jeSBvciBleHRlbmQgaXQuXHJcbiogRXh0ZW5zaW9ucyBzaG91bGQgaW1wbGVtZW50IHRoZSBmb2xsb3dpbmcgcHJpdmF0ZSBtZXRob2RzOiBfb25Qb3N0TWVzc2FnZSBhbmQgX3JlZ2lzdGVyRXh0ZXJuYWxMaXN0ZW5lclxyXG4qL1xyXG5jbGFzcyBCdXMge1xyXG4gIC8qIHByaXZhdGVcclxuICBfbXNnSWQ6IG51bWJlcjtcclxuICBfc3Vic2NyaXB0aW9uczogPHVybDogTXNnTGlzdGVuZXJbXT5cclxuXHJcbiAgX3Jlc3BvbnNlVGltZU91dDogbnVtYmVyXHJcbiAgX3Jlc3BvbnNlQ2FsbGJhY2tzOiA8dXJsK2lkOiAobXNnKSA9PiB2b2lkPlxyXG5cclxuICAqL1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fbXNnSWQgPSAwO1xyXG4gICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTtcclxuXHJcbiAgICBfdGhpcy5fcmVzcG9uc2VUaW1lT3V0ID0gMTUwMDA7IC8vZGVmYXVsdCB0byAzc1xyXG4gICAgX3RoaXMuX3Jlc3BvbnNlQ2FsbGJhY2tzID0ge307XHJcblxyXG4gICAgX3RoaXMuX3JlZ2lzdGVyRXh0ZXJuYWxMaXN0ZW5lcigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBSZWdpc3RlciBsaXN0ZW5lciB0byByZWNlaXZlIG1lc3NhZ2Ugd2hlbiBcIm1zZy50byA9PT0gdXJsXCIuXHJcbiAgKiBTcGVjaWFsIHVybCBcIipcIiBmb3IgZGVmYXVsdCBsaXN0ZW5lciBpcyBhY2NlcHRlZCB0byBpbnRlcmNlcHQgYWxsIG1lc3NhZ2VzLlxyXG4gICogQHBhcmFtIHtVUkx9IHVybCBBZGRyZXNzIHRvIGludGVyY2VwdCwgdGhhIGlzIGluIHRoZSBtZXNzYWdlIFwidG9cIlxyXG4gICogQHBhcmFtIHtMaXN0ZW5lcn0gbGlzdGVuZXIgbGlzdGVuZXJcclxuICAqIEByZXR1cm4ge01zZ0xpc3RlbmVyfSBpbnN0YW5jZSBvZiBNc2dMaXN0ZW5lclxyXG4gICovXHJcbiAgYWRkTGlzdGVuZXIodXJsLCBsaXN0ZW5lcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgaXRlbSA9IG5ldyBNc2dMaXN0ZW5lcihfdGhpcy5fc3Vic2NyaXB0aW9ucywgdXJsLCBsaXN0ZW5lcik7XHJcbiAgICBsZXQgaXRlbUxpc3QgPSBfdGhpcy5fc3Vic2NyaXB0aW9uc1t1cmxdO1xyXG4gICAgaWYgKCFpdGVtTGlzdCkge1xyXG4gICAgICBpdGVtTGlzdCA9IFtdO1xyXG4gICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1t1cmxdID0gaXRlbUxpc3Q7XHJcbiAgICB9XHJcblxyXG4gICAgaXRlbUxpc3QucHVzaChpdGVtKTtcclxuICAgIHJldHVybiBpdGVtO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFudWFsbHkgYWRkIGEgcmVzcG9uc2UgbGlzdGVuZXIuIE9ubHkgb25lIGxpc3RlbmVyIHBlciBtZXNzYWdlIElEIHNob3VsZCBleGlzdC5cclxuICAgKiBBVEVOVElPTiwgdGhlcmUgaXMgbm8gdGltZW91dCBmb3IgdGhpcyBsaXN0ZW5lci5cclxuICAgKiBUaGUgbGlzdGVuZXIgc2hvdWxkIGJlIHJlbW92ZWQgd2l0aCBhIHJlbW92ZVJlc3BvbnNlTGlzdGVuZXIsIGZhaWxpbmcgdG8gZG8gdGhpcyB3aWxsIHJlc3VsdCBpbiBhIHVucmVsZWFzZWQgbWVtb3J5IHByb2JsZW0uXHJcbiAgICogQHBhcmFtIHtVUkx9IHVybCBPcmlnaW4gYWRkcmVzcyBvZiB0aGUgbWVzc2FnZSBzZW50LCBcIm1zZy5mcm9tXCIuXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG1zZ0lkIE1lc3NhZ2UgSUQgdGhhdCBpcyByZXR1cm5lZCBmcm9tIHRoZSBwb3N0TWVzc2FnZS5cclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSByZXNwb25zZUxpc3RlbmVyIENhbGxiYWNrIGZ1bmN0aW9uIGZvciB0aGUgcmVzcG9uc2VcclxuICAgKi9cclxuICBhZGRSZXNwb25zZUxpc3RlbmVyKHVybCwgbXNnSWQsIHJlc3BvbnNlTGlzdGVuZXIpIHtcclxuICAgIHRoaXMuX3Jlc3BvbnNlQ2FsbGJhY2tzW3VybCArIG1zZ0lkXSA9IHJlc3BvbnNlTGlzdGVuZXI7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZW1vdmUgdGhlIHJlc3BvbnNlIGxpc3RlbmVyLlxyXG4gICAqIEBwYXJhbSB7VVJMfSB1cmwgT3JpZ2luIGFkZHJlc3Mgb2YgdGhlIG1lc3NhZ2Ugc2VudCwgXCJtc2cuZnJvbVwiLlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtc2dJZCAgTWVzc2FnZSBJRCB0aGF0IGlzIHJldHVybmVkIGZyb20gdGhlIHBvc3RNZXNzYWdlXHJcbiAgICovXHJcbiAgcmVtb3ZlUmVzcG9uc2VMaXN0ZW5lcih1cmwsIG1zZ0lkKSB7XHJcbiAgICBkZWxldGUgdGhpcy5fcmVzcG9uc2VDYWxsYmFja3NbdXJsICsgbXNnSWRdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb3ZlIGFsbCBleGlzdGVudCBsaXN0ZW5lcnMgZm9yIHRoZSBVUkxcclxuICAgKiBAcGFyYW0gIHtVUkx9IHVybCBBZGRyZXNzIHJlZ2lzdGVyZWRcclxuICAgKi9cclxuICByZW1vdmVBbGxMaXN0ZW5lcnNPZih1cmwpIHtcclxuICAgIGRlbGV0ZSB0aGlzLl9zdWJzY3JpcHRpb25zW3VybF07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIZWxwZXIgbWV0aG9kIHRvIGJpbmQgbGlzdGVuZXJzIChpbiBib3RoIGRpcmVjdGlvbnMpIGludG8gb3RoZXIgTWluaUJ1cyB0YXJnZXQuXHJcbiAgICogQHBhcmFtICB7VVJMfSBvdXRVcmwgT3V0Ym91bmQgVVJMLCByZWdpc3RlciBsaXN0ZW5lciBmb3IgdXJsIGluIGRpcmVjdGlvbiBcInRoaXMgLT4gdGFyZ2V0XCJcclxuICAgKiBAcGFyYW0gIHtVUkx9IGluVXJsIEluYm91bmQgVVJMLCByZWdpc3RlciBsaXN0ZW5lciBmb3IgdXJsIGluIGRpcmVjdGlvbiBcInRhcmdldCAtPiB0aGlzXCJcclxuICAgKiBAcGFyYW0gIHtNaW5pQnVzfSB0YXJnZXQgVGhlIG90aGVyIHRhcmdldCBNaW5pQnVzXHJcbiAgICogQHJldHVybiB7Qm91bmR9IGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBwcm9wZXJ0aWVzIFt0aGlzTGlzdGVuZXIsIHRhcmdldExpc3RlbmVyXSBhbmQgdGhlIHVuYmluZCBtZXRob2QuXHJcbiAgICovXHJcbiAgYmluZChvdXRVcmwsIGluVXJsLCB0YXJnZXQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IHRoaXNMaXN0biA9IF90aGlzLmFkZExpc3RlbmVyKG91dFVybCwgKG1zZykgPT4ge1xyXG4gICAgICB0YXJnZXQucG9zdE1lc3NhZ2UobXNnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCB0YXJnZXRMaXN0biA9IHRhcmdldC5hZGRMaXN0ZW5lcihpblVybCwgKG1zZykgPT4ge1xyXG4gICAgICBfdGhpcy5wb3N0TWVzc2FnZShtc2cpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGhpc0xpc3RlbmVyOiB0aGlzTGlzdG4sXHJcbiAgICAgIHRhcmdldExpc3RlbmVyOiB0YXJnZXRMaXN0bixcclxuICAgICAgdW5iaW5kOiAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy50aGlzTGlzdGVuZXIucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRMaXN0ZW5lci5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vcHVibGlzaCBvbiBkZWZhdWx0IGxpc3RlbmVyc1xyXG4gIF9wdWJsaXNoT25EZWZhdWx0KG1zZykge1xyXG4gICAgLy9pcyB0aGVyZSBhbnkgXCIqXCIgKGRlZmF1bHQpIGxpc3RlbmVycz9cclxuICAgIGxldCBpdGVtTGlzdCA9IHRoaXMuX3N1YnNjcmlwdGlvbnNbJyonXTtcclxuICAgIGlmIChpdGVtTGlzdCkge1xyXG4gICAgICB0aGlzLl9wdWJsaXNoT24oaXRlbUxpc3QsIG1zZyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvL3B1Ymxpc2ggb24gYSBzdWJzY3JpcHRpb24gbGlzdC5cclxuICBfcHVibGlzaE9uKGl0ZW1MaXN0LCBtc2cpIHtcclxuICAgIGl0ZW1MaXN0LmZvckVhY2goKHN1YikgPT4ge1xyXG4gICAgICBzdWIuX2NhbGxiYWNrKG1zZyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9yZXNwb25zZUNhbGxiYWNrKGluTXNnLCByZXNwb25zZUNhbGxiYWNrLCB0aW1lb3V0ID0gdHJ1ZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAvL2F1dG9tYXRpYyBtYW5hZ2VtZW50IG9mIHJlc3BvbnNlIGhhbmRsZXJzXHJcbiAgICBpZiAocmVzcG9uc2VDYWxsYmFjaykge1xyXG4gICAgICBsZXQgcmVzcG9uc2VJZCA9IGluTXNnLmZyb20gKyBpbk1zZy5pZDtcclxuICAgICAgX3RoaXMuX3Jlc3BvbnNlQ2FsbGJhY2tzW3Jlc3BvbnNlSWRdID0gcmVzcG9uc2VDYWxsYmFjaztcclxuXHJcbiAgICAgIGlmICh0aW1lb3V0KSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICBsZXQgcmVzcG9uc2VGdW4gPSBfdGhpcy5fcmVzcG9uc2VDYWxsYmFja3NbcmVzcG9uc2VJZF07XHJcbiAgICAgICAgICBkZWxldGUgX3RoaXMuX3Jlc3BvbnNlQ2FsbGJhY2tzW3Jlc3BvbnNlSWRdO1xyXG5cclxuICAgICAgICAgIGlmIChyZXNwb25zZUZ1bikge1xyXG4gICAgICAgICAgICBsZXQgZXJyb3JNc2cgPSB7XHJcbiAgICAgICAgICAgICAgaWQ6IGluTXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLFxyXG4gICAgICAgICAgICAgIGJvZHk6IHsgY29kZTogNDA4LCBkZXNjOiAnUmVzcG9uc2UgdGltZW91dCEnLCB2YWx1ZTogaW5Nc2cgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmVzcG9uc2VGdW4oZXJyb3JNc2cpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIF90aGlzLl9yZXNwb25zZVRpbWVPdXQpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gIH1cclxuXHJcbi8vVE9ETzogcHJvdmlzaW9uYWwgcmVzcG9uc2VzIHNob3VsZCByZXNldCB0aW1lb3V0XHJcbiAgX29uUmVzcG9uc2UobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJykge1xyXG4gICAgICBsZXQgcmVzcG9uc2VJZCA9IG1zZy50byArIG1zZy5pZDtcclxuICAgICAgbGV0IHJlc3BvbnNlRnVuID0gX3RoaXMuX3Jlc3BvbnNlQ2FsbGJhY2tzW3Jlc3BvbnNlSWRdO1xyXG5cclxuICAgICAgaWYgKG1zZy5ib2R5LmNvZGUgPj0gMjAwKSB7IC8vaWYgaXQncyBhIHByb3Zpc2lvbmFsIHJlc3BvbnNlLCBkb24ndCBkZWxldGUgcmVzcG9uc2UgbGlzdGVuZXJcclxuICAgICAgICBkZWxldGUgX3RoaXMuX3Jlc3BvbnNlQ2FsbGJhY2tzW3Jlc3BvbnNlSWRdO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAocmVzcG9uc2VGdW4pIHtcclxuICAgICAgICByZXNwb25zZUZ1bihtc2cpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvL3JlY2VpdmUgbWVzc2FnZXMgZnJvbSBleHRlcm5hbCBpbnRlcmZhY2VcclxuICBfb25NZXNzYWdlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoIV90aGlzLl9vblJlc3BvbnNlKG1zZykpIHtcclxuICAgICAgbGV0IGl0ZW1MaXN0ID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbbXNnLnRvXTtcclxuICAgICAgaWYgKGl0ZW1MaXN0KSB7XHJcbiAgICAgICAgX3RoaXMuX3B1Ymxpc2hPbihpdGVtTGlzdCwgbXNnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBfdGhpcy5fcHVibGlzaE9uRGVmYXVsdChtc2cpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZ2VuSWQoaW5Nc2cpIHtcclxuICAgIC8vVE9ETzogaG93IGRvIHdlIG1hbmFnZSBtZXNzYWdlIElEJ3M/IFNob3VsZCBpdCBiZSBhIGdsb2JhbCBydW50aW1lIGNvdW50ZXIsIG9yIHBlciBVUkwgYWRkcmVzcz9cclxuICAgIC8vR2xvYmFsIGNvdW50ZXIgd2lsbCBub3Qgd29yaywgYmVjYXVzZSB0aGVyZSB3aWxsIGJlIG11bHRpcGxlIE1pbmlCdXMgaW5zdGFuY2VzIVxyXG4gICAgLy9QZXIgVVJMLCBjYW4gYmUgYSBsb3Qgb2YgZGF0YSB0byBtYWludGFpbiFcclxuICAgIC8vTWF5YmUgYSBjb3VudGVyIHBlciBNaW5pQnVzIGluc3RhbmNlLiBUaGlzIGlzIHRoZSBhc3N1bWVkIHNvbHV0aW9uIGZvciBub3cuXHJcbiAgICBpZiAoIWluTXNnLmlkIHx8IGluTXNnLmlkID09PSAwKSB7XHJcbiAgICAgIHRoaXMuX21zZ0lkKys7XHJcbiAgICAgIGluTXNnLmlkID0gdGhpcy5fbXNnSWQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFNlbmQgbWVzc2FnZXMgdG8gbG9jYWwgbGlzdGVuZXJzLCBvciBpZiBub3QgZXhpc3RzIHRvIGV4dGVybmFsIGxpc3RlbmVycy5cclxuICAqIEl0J3MgaGFzIGFuIG9wdGlvbmFsIG1lY2hhbmlzbSBmb3IgYXV0b21hdGljIG1hbmFnZW1lbnQgb2YgcmVzcG9uc2UgaGFuZGxlcnMuXHJcbiAgKiBUaGUgcmVzcG9uc2UgaGFuZGxlciB3aWxsIGJlIHVucmVnaXN0ZXJlZCBhZnRlciByZWNlaXZpbmcgdGhlIHJlc3BvbnNlLCBvciBhZnRlciByZXNwb25zZSB0aW1lb3V0IChkZWZhdWx0IHRvIDNzKS5cclxuICAqIEBwYXJhbSAge01lc3NhZ2V9IG1zZyBNZXNzYWdlIHRvIHNlbmQuIE1lc3NhZ2UgSUQgaXMgYXV0b21hdGljYWxseSBhZGRlZCB0byB0aGUgbWVzc2FnZS5cclxuICAqIEBwYXJhbSAge0Z1bmN0aW9ufSByZXNwb25zZUNhbGxiYWNrIE9wdGlvbmFsIHBhcmFtZXRlciwgaWYgdGhlIGRldmVsb3BlciB3aGF0J3MgYXV0b21hdGljIHJlc3BvbnNlIG1hbmFnZW1lbnQuXHJcbiAgKiBAcmV0dXJuIHtudW1iZXJ9IFJldHVybnMgdGhlIG1lc3NhZ2UgSUQsIGluIGNhc2UgaXQgc2hvdWxkIGJlIG5lZWRlZCBmb3IgbWFudWFsIG1hbmFnZW1lbnQgb2YgdGhlIHJlc3BvbnNlIGhhbmRsZXIuXHJcbiAgKi9cclxuICBwb3N0TWVzc2FnZShpbk1zZywgcmVzcG9uc2VDYWxsYmFjaykgeyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHBvc3QgbWVzc2FnZXMgd2l0aCBhIG51bWJlciBvZiByZXRyaWVzIGluIGNhc2UgdGltZW91dHMgb2NjdXIuXHJcbiAgICogQHBhcmFtICB7TWVzc2FnZX0gbXNnIE1lc3NhZ2UgdG8gc2VuZC4gTWVzc2FnZSBJRCBpcyBhdXRvbWF0aWNhbGx5IGFkZGVkIHRvIHRoZSBtZXNzYWdlLlxyXG4gICAqIEBwYXJhbSAge0Z1bmN0aW9ufSByZXNwb25zZUNhbGxiYWNrIE9wdGlvbmFsIHBhcmFtZXRlciwgaWYgdGhlIGRldmVsb3BlciB3aGF0J3MgYXV0b21hdGljIHJlc3BvbnNlIG1hbmFnZW1lbnQuXHJcbiAgICogQHBhcmFtICB7aW50ZWdlcn0gcmV0cmllcyBudW1iZXIgb2YgcmV0cmllcyB3aGVuIHRpbWVvdXRzIG9jY3VyXHJcbiAgICogQHJldHVybiB7Ym9vbGVhbn0gbWVzc2FnZSBkZWxpdmVyeSByZXN1bHQ7XHJcbiAgICovXHJcblxyXG5cclxuICBwb3N0TWVzc2FnZVdpdGhSZXRyaWVzKG1zZywgcmV0cmllcywgY2FsbGJhY2spIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCByZXRyeSA9IDA7XHJcbiAgICAvL2xldCB0aW1lb3V0ID0gdHJ1ZTtcclxuXHJcbiAgICBsZXQgc2VuZE1zZyA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBfdGhpcy5wb3N0TWVzc2FnZShtc2csIChyZXBseSkgPT4ge1xyXG4gICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gNDA4IHx8IHJlcGx5LmJvZHkuY29kZSA9PT0gNTAwKSByZWplY3QoKTtcclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsb2cuaW5mbygnW0J1cy5wb3N0TWVzc2FnZVdpdGhSZXRyaWVzXSBtc2cgZGVsaXZlcmVkOiAnLCBtc2cpO1xyXG4gICAgICAgICAgICBjYWxsYmFjayhyZXBseSk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxldCB0cnlBZ2FpbiA9ICgpID0+IHtcclxuICAgICAgc2VuZE1zZygpLnRoZW4oKCk9PntcclxuICAgICAgICAvL3RpbWVvdXQgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0sICgpPT57XHJcbiAgICAgICAgbG9nLndhcm4oYFtCdXMucG9zdE1lc3NhZ2VXaXRoUmV0cmllc10gTWVzc2FnZSBCb3VuY2VkIChyZXRyeSAke3JldHJ5fSk6ICdgLCBtc2cpO1xyXG4gICAgICAgIGlmIChyZXRyeSsrIDwgcmV0cmllcykge1xyXG4gICAgICAgICAgdHJ5QWdhaW4oKTtcclxuICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4geyB0cnlBZ2FpbigpOyB9LCAxMDAwKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc3QgZXJyb3IgPSBgW0Vycm9yXSBNZXNzYWdlIEJvdW5jZWQgKGRlbGl2ZXJ5IGF0dGVtcHRzICR7cmV0cmllc30pOiAnYDtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvciArIG1zZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgICB0cnlBZ2FpbigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTm90IHB1YmxpYyBhdmFpbGFibGUsIHVzZWQgYnkgdGhlIGNsYXNzIGV4dGVuc2lvbiBpbXBsZW1lbnRhdGlvbiwgdG8gcHJvY2VzcyBtZXNzYWdlcyBmcm9tIHRoZSBwdWJsaWMgXCJwb3N0TWVzc2FnZVwiIHdpdGhvdXQgYSByZWdpc3RlcmVkIGxpc3RlbmVyLlxyXG4gICAqIFVzZWQgdG8gc2VuZCB0aGUgbWVzc2FnZSB0byBhbiBleHRlcm5hbCBpbnRlcmZhY2UsIGxpa2UgYSBXZWJXb3JrZXIsIElGcmFtZSwgZXRjLlxyXG4gICAqIEBwYXJhbSAge01lc3NhZ2UuTWVzc2FnZX0gbXNnIE1lc3NhZ2VcclxuICAgKi9cclxuICBfb25Qb3N0TWVzc2FnZShtc2cpIHsgLyppbXBsZW1lbnRhdGlvbiB3aWxsIHNlbmQgbWVzc2FnZSB0byBleHRlcm5hbCBzeXN0ZW0qLyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE5vdCBwdWJsaWMgYXZhaWxhYmxlLCB1c2VkIGJ5IHRoZSBjbGFzcyBleHRlbnNpb24gaW1wbGVtZW50YXRpb24sIHRvIHByb2Nlc3MgYWxsIG1lc3NhZ2VzIHRoYXQgZW50ZXIgdGhlIE1pbmlCdXMgZnJvbSBhbiBleHRlcm5hbCBpbnRlcmZhY2UsIGxpa2UgYSBXZWJXb3JrZXIsIElGcmFtZSwgZXRjLlxyXG4gICAqIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCBvbmUgdGltZSBpbiB0aGUgY29uc3RydWN0b3IgdG8gcmVnaXN0ZXIgZXh0ZXJuYWwgbGlzdGVuZXJzLlxyXG4gICAqIFRoZSBpbXBsZW1lbnRhdGlvbiB3aWxsIHByb2JhYmx5IGNhbGwgdGhlIFwiX29uTWVzc2FnZVwiIG1ldGhvZCB0byBwdWJsaXNoIGluIHRoZSBsb2NhbCBsaXN0ZW5lcnMuXHJcbiAgICogRE8gTk9UIGNhbGwgXCJwb3N0TWVzc2FnZVwiLCB0aGVyZSBpcyBhIGRhbmdlciB0aGF0IHRoZSBtZXNzYWdlIGVudGVycyBpbiBhIGN5Y2xlIVxyXG4gICAqL1xyXG4gIF9yZWdpc3RlckV4dGVybmFsTGlzdGVuZXIoKSB7IC8qaW1wbGVtZW50YXRpb24gd2lsbCByZWdpc3RlciBleHRlcm5hbCBsaXN0ZW5lciBhbmQgY2FsbCBcInRoaXMuX29uTWVzc2FnZShtc2cpXCIgKi8gfVxyXG5cclxufVxyXG5cclxuY2xhc3MgTXNnTGlzdGVuZXIge1xyXG4gIC8qIHByaXZhdGVcclxuICBfc3Vic2NyaXB0aW9uczogPHN0cmluZzogTXNnTGlzdGVuZXJbXT47XHJcbiAgX3VybDogc3RyaW5nO1xyXG4gIF9jYWxsYmFjazogKG1zZykgPT4gdm9pZDtcclxuICAqL1xyXG5cclxuICBjb25zdHJ1Y3RvcihzdWJzY3JpcHRpb25zLCB1cmwsIGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0gc3Vic2NyaXB0aW9ucztcclxuICAgIF90aGlzLl91cmwgPSB1cmw7XHJcbiAgICBfdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIGdldCB1cmwoKSB7IHJldHVybiB0aGlzLl91cmw7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb3ZlIHRoaXMgbGlzdGVuZXIgZnJvbSB0aGUgQnVzXHJcbiAgICovXHJcbiAgcmVtb3ZlKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgc3VicyA9IF90aGlzLl9zdWJzY3JpcHRpb25zW190aGlzLl91cmxdO1xyXG4gICAgaWYgKHN1YnMpIHtcclxuICAgICAgbGV0IGluZGV4ID0gc3Vicy5pbmRleE9mKF90aGlzKTtcclxuICAgICAgc3Vicy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuICAgICAgLy9pZiB0aGVyZSBhcmUgbm8gbGlzdGVuZXJzLCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBlbnRpcmVseS5cclxuICAgICAgaWYgKHN1YnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgZGVsZXRlIF90aGlzLl9zdWJzY3JpcHRpb25zW190aGlzLl91cmxdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBCdXM7XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuaW1wb3J0IEJ1cyBmcm9tICcuL0J1cyc7XHJcblxyXG4vKipcclxuKiBAYXV0aG9yIG1pY2FlbHBlZHJvc2FAZ21haWwuY29tXHJcbiogTWVzc2FnZSBCVVMgSW50ZXJmYWNlIGlzIGFuIGV4dGVuc2lvbiBvZiB0aGUgQnVzXHJcbiogSXQgaXMgdXNlZCBtYWlubHkgaW4gdGhlIGludGVybmFsIHNhbmRib3ggcm91dGluZy5cclxuKi9cclxuY2xhc3MgTWluaUJ1cyBleHRlbmRzIEJ1cyB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBvc3QgYSBtZXNzYWdlIGZvciByb3V0aW5nLiBNZXNzYWdlIGlzIHJvdXRlZCBkaXJlY3RseSB0byB0aGUgZXh0ZXJuYWwgcm91dGluZyBfb25Qb3N0TWVzc2FnZS5cclxuICAgKiBAcGFyYW0gIHtNZXNzYWdlfSBpbk1zZyAgICAgICAgICAgIEpTT04gd2l0aCBtYW5kYXRvcnkgTWVzc2FnZSBzdHJ1Y3R1cmUge2lkLCB0eXBlLCBmcm9tLCB0b31cclxuICAgKiBAcGFyYW0gIHtDYWxsYmFja30gcmVzcG9uc2VDYWxsYmFjayBPcHRpb25hbCBjYWxsYmFjayBpZiBhIHJlc3BvbnNlIGlzIGV4cGVjdGVkIGZyb20gdGhlIHJlcXVlc3QuIEEgcmVzcG9uc2Ugd2lsbCBiZSBhbHdheXMgc2VudCwgZXZlbiBpZiBpdCBpcyBhIFwiVGltZW91dFwiLlxyXG4gICAqIEByZXR1cm4ge251bWJlcn0gICAgICAgICAgICAgICAgICB0aGUgTWVzc2FnZSBpZFxyXG4gICAqL1xyXG4gIHBvc3RNZXNzYWdlKGluTXNnLCByZXNwb25zZUNhbGxiYWNrLCB0aW1lb3V0KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9nZW5JZChpbk1zZyk7XHJcbiAgICBfdGhpcy5fcmVzcG9uc2VDYWxsYmFjayhpbk1zZywgcmVzcG9uc2VDYWxsYmFjaywgdGltZW91dCk7XHJcblxyXG4gICAgLy9hbHdheXMgc2VuZCB0byBleHRlcm5hbCAodG8gY29yZSBNZXNzYWdlQnVzKVxyXG4gICAgX3RoaXMuX29uUG9zdE1lc3NhZ2UoaW5Nc2cpO1xyXG5cclxuICAgIHJldHVybiBpbk1zZy5pZDtcclxuICB9XHJcblxyXG4gIC8vaW50ZXJuYWwgbWV0aG9kIHVzZWQgd2hlbiBhIG1lc3NhZ2UgaXMgcmVjZWl2ZWQgYnkgYW4gZXh0ZXJuYWwgcm91dGluZyBzeXN0ZW1cclxuICBfb25NZXNzYWdlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoIV90aGlzLl9vblJlc3BvbnNlKG1zZykpIHtcclxuICAgICAgbGV0IGl0ZW1MaXN0ID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbbXNnLnRvXTtcclxuICAgICAgaWYgKGl0ZW1MaXN0KSB7XHJcbiAgICAgICAgX3RoaXMuX3B1Ymxpc2hPbihpdGVtTGlzdCwgbXNnKTtcclxuICAgICAgICBpZiAoIW1zZy50by5zdGFydHNXaXRoKCdoeXBlcnR5JykpIHtcclxuICAgICAgICAgIF90aGlzLl9wdWJsaXNoT25EZWZhdWx0KG1zZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIF90aGlzLl9wdWJsaXNoT25EZWZhdWx0KG1zZyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBNaW5pQnVzO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcbmltcG9ydCBTYW5kYm94UmVnaXN0cnkgZnJvbSAnLi9TYW5kYm94UmVnaXN0cnknO1xyXG5pbXBvcnQgTWluaUJ1cyBmcm9tICcuLi9idXMvTWluaUJ1cyc7XHJcblxyXG5cclxuZXhwb3J0IGxldCBTYW5kYm94VHlwZSA9IHtBUFA6ICdhcHAnLCBOT1JNQUw6ICdub3JtYWwnLCBXSU5ET1c6ICd3aW5kb3cnfTtcclxuXHJcbi8qKlxyXG4gKiBAYXV0aG9yIG1pY2FlbHBlZHJvc2FAZ21haWwuY29tXHJcbiAqIEJhc2UgY2xhc3MgdG8gaW1wbGVtZW50IGV4dGVybmFsIHNhbmRib3ggY29tcG9uZW50XHJcbiAqL1xyXG5jbGFzcyBTYW5kYm94IGV4dGVuZHMgTWluaUJ1cyB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNhcGFiaWxpdGllcykge1xyXG5cclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoY2FwYWJpbGl0aWVzKSAgICAgIHsgX3RoaXMuY2FwYWJpbGl0aWVzID0gY2FwYWJpbGl0aWVzOyB9XHJcblxyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERlcGxveSBhbiBpbnN0YW5jZSBvZiB0aGUgY29tcG9uZW50IGludG8gdGhlIHNhbmRib3guXHJcbiAgICogQHBhcmFtICB7c3RyaW5nfSBjb21wb25lbnRTb3VyY2VDb2RlIENvbXBvbmVudCBzb3VyY2UgY29kZSAoSHlwZXJ0eSwgUHJvdG9TdHViLCBldGMpXHJcbiAgICogQHBhcmFtICB7VVJMfSBjb21wb25lbnRVUkwgSHlwZXJ0eSwgUHJvdG9TdHViLCBvciBhbnkgb3RoZXIgY29tcG9uZW50IGFkZHJlc3MuXHJcbiAgICogQHBhcmFtICB7Q29uZmlnfSBjb25maWd1cmF0aW9uIENvbmZpZyBwYXJhbWV0ZXJzIG9mIHRoZSBjb21wb25lbnRcclxuICAgKiBAcmV0dXJuIHtQcm9taXNlPHN0cmluZz59IHJldHVybiBkZXBsb3llZCBpZiBzdWNjZXNzZnVsLCBvciBhbnkgb3RoZXIgc3RyaW5nIHdpdGggYW4gZXJyb3JcclxuICAgKi9cclxuICBkZXBsb3lDb21wb25lbnQoY29tcG9uZW50U291cmNlQ29kZSwgY29tcG9uZW50VVJMLCBjb25maWd1cmF0aW9uKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAvLyBsZXQgbWVzc2FnZUZhY3RvcnkgPSBfdGhpcy5tZXNzYWdlRmFjdG9yeTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAvL0ZMT1ctT1VUOiBkZXBsb3kgbWVzc2FnZSBmb3IgdGhlIGludGVybmFsIFNhbmRib3hSZWdpc3RyeSAtPiBfb25EZXBsb3lcclxuICAgICAgbGV0IGRlcGxveU1lc3NhZ2UgPSB7XHJcbiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IFNhbmRib3hSZWdpc3RyeS5FeHRlcm5hbERlcGxveUFkZHJlc3MsIHRvOiBTYW5kYm94UmVnaXN0cnkuSW50ZXJuYWxEZXBsb3lBZGRyZXNzLFxyXG4gICAgICAgIGJvZHk6IHsgdXJsOiBjb21wb25lbnRVUkwsIHNvdXJjZUNvZGU6IGNvbXBvbmVudFNvdXJjZUNvZGUsIGNvbmZpZzogY29uZmlndXJhdGlvbiB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvL3NlbmQgbWVzc2FnZSBpbnRvIHRoZSBzYW5kYm94IGludGVybmFscyBhbmQgd2FpdCBmb3IgcmVwbHlcclxuICAgICAgX3RoaXMucG9zdE1lc3NhZ2UoZGVwbG95TWVzc2FnZSwgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAvL2lzIHRoaXMgcmVzcG9uc2UgY29tcGxhaW50IHdpdGggdGhlIHNwZWM/XHJcbiAgICAgICAgICByZXNvbHZlKCdkZXBsb3llZCcpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZW1vdmUgdGhlIGluc3RhbmNlIG9mIGEgcHJldmlvdXNseSBkZXBsb3llZCBjb21wb25lbnQuXHJcbiAgICogQHBhcmFtICB7VVJMfSBjb21wb25lbnRVUkwgSHlwZXJ0eSwgUHJvdG9TdHViLCBvciBhbnkgb3RoZXIgY29tcG9uZW50IGFkZHJlc3MuXHJcbiAgICogQHJldHVybiB7UHJvbWlzZTxzdHJpbmc+fSByZXR1cm4gdW5kZXBsb3llZCBpZiBzdWNjZXNzZnVsLCBvciBhbnkgb3RoZXIgc3RyaW5nIHdpdGggYW4gZXJyb3JcclxuICAgKi9cclxuICByZW1vdmVDb21wb25lbnQoY29tcG9uZW50VVJMKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIC8vRkxPVy1PVVQ6IHVuLWRlcGxveSBtZXNzYWdlIGZvciB0aGUgaW50ZXJuYWwgU2FuZGJveFJlZ2lzdHJ5IC0+IF9vblJlbW92ZVxyXG4gICAgICBsZXQgcmVtb3ZlTWVzc2FnZSA9IHtcclxuICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogU2FuZGJveFJlZ2lzdHJ5LkV4dGVybmFsRGVwbG95QWRkcmVzcywgdG86IFNhbmRib3hSZWdpc3RyeS5JbnRlcm5hbERlcGxveUFkZHJlc3MsXHJcbiAgICAgICAgYm9keTogeyB1cmw6IGNvbXBvbmVudFVSTCB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvL3NlbmQgbWVzc2FnZSBpbnRvIHRoZSBzYW5kYm94IGludGVybmFscyBhbmQgd2FpdCBmb3IgcmVwbHlcclxuICAgICAgX3RoaXMucG9zdE1lc3NhZ2UocmVtb3ZlTWVzc2FnZSwgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAvL2lzIHRoaXMgcmVzcG9uc2UgY29tcGxhaW50IHdpdGggdGhlIHNwZWM/XHJcbiAgICAgICAgICByZXNvbHZlKCd1bmRlcGxveWVkJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogTWF0Y2hlcyBTYW5kYm94IGNhcGFiaWxpdGllcyBhZ2FpbnN0IHByb3ZpZGVkIGNhcGFiaWxpdGllcy4gVXNlZCB0byBjaGVjayBpZiBzYW5kYm94IHByb3ZpZGVzIGFsbCByZXF1aXJlZCBjYXBhYmlsaXRpZXNcclxuICAqIEBwYXJhbSAge1J1bnRpbWVDYXBhYmlsaXRpZXN9IGNvbnN0cmFpbnRzIHNldCBvZiBSdW50aW1lQ2FwYWJpbGl0aWVzIHRvIG1hdGNoIHdpdGguXHJcbiAgKiBAcmV0dXJuIHtib29sZWFufSByZXR1cm4gdHJ1ZSBpZiBjb25zdHJhaW50cyBhcmUgbWF0Y2hlZCBmYWxzZSBvdGhlcndpc2VcclxuICAgKi9cclxuXHJcbiAgbWF0Y2hlcyhjb25zdHJhaW50cykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgZmlsdGVyZWQgPSBPYmplY3Qua2V5cyhjb25zdHJhaW50cykuZmlsdGVyKChrZXkpID0+IHtcclxuICAgICAgcmV0dXJuICEoX3RoaXMuY2FwYWJpbGl0aWVzW2tleV0gJiYgX3RoaXMuY2FwYWJpbGl0aWVzW2tleV0gPT09IGNvbnN0cmFpbnRzW2tleV0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGZpbHRlcmVkLmxlbmd0aCA9PT0gMCkgICAgICB7IHJldHVybiB0cnVlOyB9ICAgIGVsc2UgICAgICB7IHJldHVybiAhKGNvbnN0cmFpbnRzW2ZpbHRlcmVkXSk7IH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTYW5kYm94O1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vLyBMb2cgc3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdhZGRyZXNzLWFsbG9jYXRpb24nKTtcclxuXHJcblxyXG5pbXBvcnQge2lzVVJMLCBnZW5lcmF0ZUdVSUR9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuXHJcbi8vIFRPRE86IHRoaXMgY291bGQgbm90IGJlIHRoZSBiZXN0IHdheSB0byBkbyBhIFNpbmdsZXRvbiBidXQgYXQgdGhpcyBtb21lbnQgaXQgd29ya3M7XHJcblxyXG5sZXQgaW5zdGFuY2U7XHJcblxyXG4vKipcclxuICogQ2xhc3Mgd2lsbCBhc2sgdG8gdGhlIG1lc3NhZ2Ugbm9kZSBmb3IgYWRkcmVzc2VzXHJcbiAqL1xyXG5jbGFzcyBBZGRyZXNzQWxsb2NhdGlvbiB7XHJcbiAgLyogcHJpdmF0ZVxyXG4gIF91cmw6IFVSTFxyXG4gIF9idXM6IE1pbmlCdXNcclxuICAqL1xyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgYW4gQWRkcmVzcyBBbGxvY2F0aW9uXHJcbiAgICogQHBhcmFtICB7VVJMLlVSTH0gICAgICB1cmwgLSB1cmwgZnJvbSB3aG8gaXMgc2VuZGluZyB0aGUgbWVzc2FnZVxyXG4gICAqIEBwYXJhbSAge01pbmlCdXN9ICAgICAgYnVzIC0gTWluaUJ1cyB1c2VkIGZvciBhZGRyZXNzIGFsbG9jYXRpb25cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcih1cmwsIGJ1cywgcmVnaXN0cnksIHN1YnNjcmlwdGlvbk1hbmFnZXIpIHtcclxuXHJcbiAgICBpZiAoIWluc3RhbmNlKSB7XHJcbiAgICAgIHRoaXMuX3VybCA9IHVybCArICcvYWRkcmVzcy1hbGxvY2F0aW9uJztcclxuICAgICAgdGhpcy5fYnVzID0gYnVzO1xyXG4gICAgICB0aGlzLl9yZWdpc3RyeSA9IHJlZ2lzdHJ5O1xyXG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25NYW5hZ2VyID0gc3Vic2NyaXB0aW9uTWFuYWdlcjtcclxuICAgICAgaW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGluc3RhbmNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldCBpbnN0YW5jZSgpIHtcclxuICAgIGlmICghaW5zdGFuY2UpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgYWRkcmVzcyBhbGxvY2F0aW9uIHdhcyBub3QgaW5zdGFudGlhdGVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGluc3RhbmNlXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBnZXQgdGhlIFVSTCB2YWx1ZVxyXG4gICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHVybCB2YWx1ZTtcclxuICAgKi9cclxuICBnZXQgdXJsKCkgeyByZXR1cm4gdGhpcy5fdXJsOyB9XHJcblxyXG5cclxuICAvKipcclxuICAgKlxyXG4gICAqIEFzayBmb3IgY3JlYXRpb24gb2YgYSBudW1iZXIgb2YgSHlwZXJ0eSBhZGRyZXNzZXMsIHRvIHRoZSBkb21haW4gbWVzc2FnZSBub2RlLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtEb21haW59IGRvbWFpbiAtIGRvbWFpbiBvZiB0aGUgbWVzc2FnZSBub2RlXHJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG51bWJlciAtIG51bWJlciBvZiBhZGRyZXNzIHRvIGJlIGFsbG9jYXRlZFxyXG4gICAqIEBwYXJhbSB7RGVzY3JpcHRvcn0gaW5mbyAtIGRlc2NyaXB0b3IgdG8gc2VhcmNoIGZvciB0aGUgaHlwZXJ0eSAoVE9ETzovLyB0aGlzIHNob3VsZCBiZSBjb25maXJtZWQpXHJcbiAgICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL2RhdGFtb2RlbC9jb3JlL2h5cGVydHktY2F0YWxvZ3VlL3JlYWRtZS5tZCNjYXRhbG9ndWUtZGF0YS1tb2RlbFxyXG4gICAqIEBwYXJhbSB7c2NoZW1lfSBzY2hlbWUgLSBzY2hlbWUgb2YgYWRkcmVzcyB0byBiZSBjcmVhdGVkIG9yIHJldXNlZCwgbGlrZTogaHlwZXJ0eSwgY29tbSwgY29udGV4dCwgZXRjO1xyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbnxVUkwuSHlwZXJ0eVVSTH0gcmV1c2VVUkwgLSByZXVzZVVSTCBpcyB1c2VkIHRvIHJldXNlIHRoZSBoeXBlcnR5VVJMIHByZXZpb3VzbHkgcmVnaXN0cmVkO1xyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdCwgRXJyb3I+fSB0aGlzIGlzIFByb21pc2UgYW5kIHJldHVybnMgYW4gb2JqZWN0IHdpdGggdGhlIGFkZHJlc3MgaW5mb3JtYXRpb25cclxuICAgKlxyXG4gICAqIEBtZW1iZXJPZiBBZGRyZXNzQWxsb2NhdGlvblxyXG4gICAqL1xyXG4gIGNyZWF0ZShkb21haW4sIG51bWJlciwgaW5mbywgc2NoZW1lLCByZXVzZVVSTCkge1xyXG5cclxuICAgIGxvZy5sb2coJ1tBZGRyZXNzQWxsb2NhdGlvbi5jcmVhdGVdIGluZm8gJywgaW5mbyk7XHJcbiAgICAvL2RlYnVnZ2VyO1xyXG4gICAgaWYgKHJldXNlVVJMKSB7XHJcblxyXG4gICAgICBpZiAodHlwZW9mKHJldXNlVVJMKSA9PT0gJ2Jvb2xlYW4nKSB7XHJcblxyXG4gICAgICAgIGlmIChyZXVzZVVSTCkge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3JldXNlQWxsb2NhdGVkQWRkcmVzcyhkb21haW4sIG51bWJlciwgaW5mbywgc2NoZW1lLCByZXVzZVVSTCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLl9hbGxvY2F0ZU5ld0FkZHJlc3MoZG9tYWluLCBzY2hlbWUsIG51bWJlciwgaW5mbyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHR5cGVvZihyZXVzZVVSTCkgPT09ICdzdHJpbmcnICYmIGlzVVJMKHJldXNlVVJMKSkge1xyXG4gICAgICAgIC8vcmV0dXJuIHRoaXMuX3JldXNlQWxsb2NhdGVkQWRkcmVzcyhkb21haW4sIG51bWJlciwgaW5mbywgc2NoZW1lLCByZXVzZVVSTCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgIGxldCB2YWx1ZSA9IHsgbmV3QWRkcmVzczogZmFsc2UsIGFkZHJlc3M6IFtyZXVzZVVSTF0gfTtcclxuICAgICAgICAgIHJldHVybiByZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxvZy5sb2coJ1tBZGRyZXNzQWxsb2NhdGlvbl0gLSBuZXcgYWRkcmVzcyB3aWxsIGJlIGFsbG9jYXRlZCcpO1xyXG5cclxuICAgICAgLy8gaWYgdGhlcmUgaXMgbm8gVVJMIHNhdmVkIHJlcXVlc3QgYSBuZXcgVVJMXHJcbiAgICAgIHJldHVybiB0aGlzLl9hbGxvY2F0ZU5ld0FkZHJlc3MoZG9tYWluLCBzY2hlbWUsIG51bWJlciwgaW5mbyk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgX3JldXNlQWxsb2NhdGVkQWRkcmVzcyhkb21haW4sIG51bWJlciwgaW5mbywgc2NoZW1lLCByZXVzZVVSTCkge1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZygnUkVVU0VURVNUIC0gIF9yZXVzZUFsbG9jYXRlZEFkZHJlc3MnLCBkb21haW4sIG51bWJlciwgaW5mbywgc2NoZW1lLCByZXVzZVVSTCk7XHJcbiAgICAgIHRoaXMuX3JlZ2lzdHJ5LmNoZWNrUmVnaXN0ZXJlZFVSTHMoaW5mbywgcmV1c2VVUkwpLnRoZW4oKHVybHMpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnUkVVU0VURVNUIC0gIHJlZ2lzdGVyZWR1cmxzJywgdXJscyk7XHJcbiAgICAgICAgaWYgKHVybHMpIHtcclxuICAgICAgICAgIGxvZy5pbmZvKCdbQWRkcmVzc0FsbG9jYXRpb24gLSAnICsgc2NoZW1lICsgJ10gLSBSZXVzZSBVUkwnKTtcclxuICAgICAgICAgIGxldCB2YWx1ZSA9IHtuZXdBZGRyZXNzOiBmYWxzZSwgYWRkcmVzczogdXJsc307XHJcbiAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgIGlmICh0eXBlb2YocmV1c2VVUkwpID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBsb2cuaW5mbygnW0FkZHJlc3NBbGxvY2F0aW9uIC0gcmV1c2VVUkxdIC0gT2JqZWN0ICcgKyByZXVzZVVSTCArICcgbm90IGZvdW5kJyk7XHJcbiAgICAgICAgICAgIHJlamVjdCgnVVJMIE5vdCBGb3VuZCcpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YocmV1c2VVUkwpID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgdGhpcy5fYWxsb2NhdGVOZXdBZGRyZXNzKGRvbWFpbiwgc2NoZW1lLCBudW1iZXIsIGluZm8pLnRoZW4ocmVzb2x2ZSkuY2F0Y2gocmVqZWN0KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCgnVVJMIE5vdCBGb3VuZCcpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9hbGxvY2F0ZU5ld0FkZHJlc3MoZG9tYWluLCBzY2hlbWUsIG51bWJlciwgaW5mbykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IGFkZHJlc3NlcyA9IFtdO1xyXG4gICAgICB2YXIgaTtcclxuXHJcbiAgICAgIGZvciAoaT0wOyBpPCBudW1iZXI7IGkrKykge1xyXG4gICAgICAgIGFkZHJlc3Nlcy5wdXNoKHNjaGVtZSsnOi8vJyArIGRvbWFpbiArICcvJyArIGdlbmVyYXRlR1VJRCgpKVxyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgcmVzdWx0ID0ge25ld0FkZHJlc3M6IHRydWUsIGFkZHJlc3M6IGFkZHJlc3Nlc307XHJcblxyXG4gICAgICBpZiAoc2NoZW1lID09PSAnaHlwZXJ0eScgKSB7XHJcbiAgICAgICAgaWYgKGluZm8uaGFzT3duUHJvcGVydHkoJ2NvbmZpZ3VyYXRpb24nKSAmJiBpbmZvLmNvbmZpZ3VyYXRpb24uaGFzT3duUHJvcGVydHkoJ2RvbWFpbl9yb3V0aW5nJykgJiYgIWluZm8uY29uZmlndXJhdGlvbi5kb21haW5fcm91dGluZykgXHJcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uTWFuYWdlci5jcmVhdGVTdWJzY3JpcHRpb24oZG9tYWluLGFkZHJlc3NlcywgX3RoaXMuX3VybCkudGhlbigoKT0+e1xyXG4gICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgcmVzb2x2ZShyZXN1bHQpO1xyXG5cclxuXHJcbi8qICAgICAgbGV0IG1zZyA9IHtcclxuICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogdGhpcy5fdXJsLCB0bzogJ2RvbWFpbjovL21zZy1ub2RlLicgKyBkb21haW4gKyAnL2FkZHJlc3MtYWxsb2NhdGlvbicsXHJcbiAgICAgICAgYm9keToge3ZhbHVlOiB7IG51bWJlcjogbnVtYmVyIH0gfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWYgKHNjaGVtZSAhPT0gJ2h5cGVydHknKSBtc2cuYm9keS5zY2hlbWUgPSBzY2hlbWU7XHJcblxyXG4gICAgICBsb2cuaW5mbygnW0FkZHJlc3NBbGxvY2F0aW9uIC0gJyArIHNjaGVtZSArICddIC0gUmVxdWVzdCBuZXcgVVJMJyk7XHJcblxyXG4gICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHtcclxuICAgICAgICAgIGxldCByZXN1bHQgPSB7bmV3QWRkcmVzczogdHJ1ZSwgYWRkcmVzczogcmVwbHkuYm9keS52YWx1ZS5hbGxvY2F0ZWR9O1xyXG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pOyovXHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFNlbmQgYSByZXF1ZXN0IHRvIHRoZSBkb21haW4gbWVzc2FnZSBub2RlLCB0byBkZWFsbG9jYXRlIG9uZSBvciBtb3JlIGFkZHJlc3Nlc1xyXG4gICogQHBhcmFtICB7RG9tYWlufSBkb21haW4gLSBEb21haW4gb2YgdGhlIG1lc3NhZ2Ugbm9kZS5cclxuICAqIEBwYXJhbSAge2FkZHJlc3Nlc30gYWRkcmVzc2VzIHRvIHJlcXVlc3QgdGhlIGRlYWxsb2NhdGlvblxyXG4gICogQHJldHVybnMge1Byb21pc2V9ICB0aGUgcmVzcG9uc2UgYnkgdGhlIG1lc3NhZ2Ugbm9kZVxyXG4gICovXHJcbiAgZGVsZXRlKGRvbWFpbiwgYWRkcmVzc2VzKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICByZXNvbHZlKDIwMCk7XHJcblxyXG4vKiAgICAgIGxldCBtZXNzYWdlID0ge1xyXG4gICAgICAgIHR5cGU6ICdkZWxldGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogJ2RvbWFpbjovL21zZy1ub2RlLicgKyBkb21haW4gKyAnL2FkZHJlc3MtYWxsb2NhdGlvbicsXHJcbiAgICAgICAgYm9keToge2NoaWxkcmVuUmVzb3VyY2VzOiBhZGRyZXNzZXN9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIChyZXBseSkgPT4ge1xyXG4gICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkge1xyXG4gICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LmNvZGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pOyovXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBZGRyZXNzQWxsb2NhdGlvbjtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG4vKipcclxuKiAgIEBhdXRob3I6IEdpbCBEaWFzIChnaWwuZGlhc0B0ZWNuaWNvLnVsaXNib2EucHQpXHJcbiogICBSZWdpc3RyeSBEYXRhIE1vZGVsIGluY2x1ZGVzIGFsbCBPYmplY3RzIHRvIGJlIGhhbmRsZWQgYnkgdGhlIFJlZ2lzdHJ5IGZ1bmN0aW9uYWxpdHkgaW5jbHVkaW5nXHJcbiovXHJcbmNsYXNzIFJlZ2lzdHJ5RGF0YU1vZGVsIHtcclxuXHJcbiAgY29uc3RydWN0b3IoaWQsIHVybCwgZGVzY3JpcHRvclVSTCwgcDJwUmVxdWVzdGVyLCBzdGFydGluZ1RpbWUsIGxhc3RNb2RpZmllZCwgc3RhdHVzLCBzdHVicywgc3R1YnNDb25maWd1cmF0aW9uKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9pZCA9IGlkO1xyXG4gICAgX3RoaXMuX3VybCA9IHVybDtcclxuICAgIF90aGlzLl9kZXNjcmlwdG9yVVJMID0gZGVzY3JpcHRvclVSTDtcclxuICAgIF90aGlzLl9zdGFydGluZ1RpbWUgPSBzdGFydGluZ1RpbWU7XHJcbiAgICBfdGhpcy5fbGFzdE1vZGlmaWVkID0gbGFzdE1vZGlmaWVkO1xyXG4gICAgX3RoaXMuX3N0YXR1cyA9IHN0YXR1cztcclxuICAgIF90aGlzLl9zdHVicyA9IHN0dWJzO1xyXG4gICAgX3RoaXMuX3N0dWJzQ29uZmlndXJhdGlvbiA9IHN0dWJzQ29uZmlndXJhdGlvbjtcclxuICAgIF90aGlzLl9wMnBSZXF1ZXN0ZXIgPSBwMnBSZXF1ZXN0ZXI7XHJcbiAgfVxyXG5cclxuICBnZXQgaWQoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIGdldCB1cmwoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl91cmw7XHJcbiAgfVxyXG5cclxuICBnZXQgZGVzY3JpcHRvclVSTCgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX2Rlc2NyaXB0b3JVUkw7XHJcbiAgfVxyXG5cclxuICBnZXQgcDJwUmVxdWVzdGVyKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fcDJwUmVxdWVzdGVyO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGxhc3RNb2RpZmllZCgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX2xhc3RNb2RpZmllZDtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBSZWdpc3RyeURhdGFNb2RlbDtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5pbXBvcnQgUmVnaXN0cnlEYXRhTW9kZWwgZnJvbSAnLi9SZWdpc3RyeURhdGFNb2RlbCc7XHJcblxyXG4vKipcclxuKiAgIEBhdXRob3I6IEdpbCBEaWFzIChnaWwuZGlhc0B0ZWNuaWNvLnVsaXNib2EucHQpXHJcbiogICBIeXBlcnR5SW5zdGFuY2UgRGF0YSBNb2RlbCB1c2VkIHRvIG1vZGVsIGluc3RhbmNlcyBvZiBIeXBlcnRpZXMgcnVubmluZyBpbiBkZXZpY2VzIGFuZCBzZXJ2ZXJzLlxyXG4qL1xyXG5jbGFzcyBIeXBlcnR5SW5zdGFuY2UgZXh0ZW5kcyBSZWdpc3RyeURhdGFNb2RlbCB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGlkLCB1cmwsIGRlc2NyaXB0b3JVUkwsIGRlc2NyaXB0b3IsIGh5cGVydHlVUkwsIHVzZXIsIGd1aWQsIHJ1bnRpbWUsIGNvbnRleHQsIHAycEhhbmRsZXIsIHAycFJlcXVlc3RlciwgZGF0YVNjaGVtZXMsIHJlc291cmNlcywgc3RhcnRpbmdUaW1lLCBsYXN0TW9kaWZpZWQpIHtcclxuICAgIHN1cGVyKGlkLCB1cmwsIGRlc2NyaXB0b3JVUkwsIHAycFJlcXVlc3Rlciwgc3RhcnRpbmdUaW1lLCBsYXN0TW9kaWZpZWQpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9kZXNjcmlwdG9yID0gZGVzY3JpcHRvcjtcclxuICAgIF90aGlzLl9oeXBlcnR5VVJMID0gaHlwZXJ0eVVSTDtcclxuICAgIF90aGlzLl91c2VyID0gdXNlcjtcclxuICAgIF90aGlzLl9ndWlkID0gZ3VpZDtcclxuICAgIF90aGlzLl9ydW50aW1lID0gcnVudGltZTtcclxuICAgIF90aGlzLl9jb250ZXh0ID0gY29udGV4dDtcclxuICAgIF90aGlzLl9wMnBIYW5kbGVyID0gcDJwSGFuZGxlcjtcclxuICAgIF90aGlzLl9kYXRhU2NoZW1lcyA9IGRhdGFTY2hlbWVzO1xyXG4gICAgX3RoaXMuX3Jlc291cmNlcyA9IHJlc291cmNlcztcclxuICB9XHJcblxyXG4gIHNldCB1c2VyKGlkZW50aXR5KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMudXNlciA9IGlkZW50aXR5O1xyXG4gIH1cclxuXHJcbiAgZ2V0IHVzZXIoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl91c2VyO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGh5cGVydHlVUkwoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9oeXBlcnR5VVJMO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGRlc2NyaXB0b3IoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9kZXNjcmlwdG9yO1xyXG4gIH1cclxuXHJcbiAgZ2V0IG9iamVjdE5hbWUoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9kZXNjcmlwdG9yLl9vYmplY3ROYW1lO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHAycEhhbmRsZXIoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9wMnBIYW5kbGVyO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGRhdGFTY2hlbWVzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fZGF0YVNjaGVtZXM7XHJcbiAgfVxyXG5cclxuICBnZXQgcmVzb3VyY2VzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fcmVzb3VyY2VzO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHJ1bnRpbWVVUkwoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9ydW50aW1lO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgSHlwZXJ0eUluc3RhbmNlO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdSZWdpc3RyeScpO1xyXG5cclxuaW1wb3J0IHsgcnVudGltZVV0aWxzICB9IGZyb20gJy4uL3J1bnRpbWUvcnVudGltZVV0aWxzJztcclxuXHJcbmltcG9ydCBIeXBlcnR5SW5zdGFuY2UgZnJvbSAnLi9IeXBlcnR5SW5zdGFuY2UnO1xyXG5cclxuXHJcbi8qKlxyXG4qIFJ1bnRpbWUgRG9tYWluUmVnaXN0cmF0aW9uIEludGVyZmFjZVxyXG4qL1xyXG5jbGFzcyBEb21haW5SZWdpc3RyYXRpb24ge1xyXG5cclxuICAvKipcclxuICAqIFRvIGluaXRpYWxpc2UgdGhlIFJ1bnRpbWUgUmVnaXN0cnkgd2l0aCB0aGUgUnVudGltZVVSTCB0aGF0IHdpbGwgYmUgdGhlIGJhc2lzIHRvIGRlcml2ZSB0aGUgaW50ZXJuYWwgcnVudGltZSBhZGRyZXNzZXMgd2hlbiBhbGxvY2F0aW5nIGFkZHJlc3NlcyB0byBpbnRlcm5hbCBydW50aW1lIGNvbXBvbmVudC4gSW4gYWRkaXRpb24sIHRoZSBSZWdpc3RyeSBkb21haW4gYmFjay1lbmQgdG8gYmUgdXNlZCB0byByZW1vdGVseSByZWdpc3RlciBSdW50aW1lIGNvbXBvbmVudHMsIGlzIGFsc28gcGFzc2VkIGFzIGlucHV0IHBhcmFtZXRlci5cclxuICAqIEBwYXJhbSAge01lc3NhZ2VCdXN9ICAgICAgICAgIG1lc3NhZ2VCdXMgICAgICAgICAgICAgICAgbXNnYnVzXHJcbiAgKiBAcGFyYW0gIHtIeXBlcnR5UnVudGltZVVSTH0gICBydW50aW1lVVJMICAgICAgICAgICAgcnVudGltZVVSTFxyXG4gICogQHBhcmFtICB7RG9tYWluVVJMfSAgICAgICAgICAgZG9tYWluICAgICAgICByZW1vdGVSZWdpc3RyeVxyXG4gICovXHJcbiAgY29uc3RydWN0b3IocnVudGltZVVSTCwgcmVnaXN0cnlVUkwsIGRvbWFpbiwgbWVzc2FnZUJ1cykge1xyXG5cclxuICAgIGlmICghcnVudGltZVVSTCkgdGhyb3cgbmV3IEVycm9yKCdydW50aW1lVVJMIGlzIG1pc3NpbmcuJyk7XHJcbiAgICBpZiAoIXJlZ2lzdHJ5VVJMKSB0aHJvdyBuZXcgRXJyb3IoJ3JlZ2lzdHJ5VVJMIGlzIG1pc3NpbmcuJyk7XHJcbiAgICBpZiAoIWRvbWFpbikgdGhyb3cgbmV3IEVycm9yKCdkb21haW4gaXMgbWlzc2luZy4nKTtcclxuICAgIGlmICghbWVzc2FnZUJ1cykgdGhyb3cgbmV3IEVycm9yKCdtZXNzYWdlQnVzIGlzIG1pc3NpbmcuJyk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5yZWdpc3RyeVVSTCA9IHJlZ2lzdHJ5VVJMO1xyXG4gICAgX3RoaXMucnVudGltZVVSTCA9IHJ1bnRpbWVVUkw7XHJcbiAgICBfdGhpcy5fcmVnaXN0cmF0aW9uUmV0cmllcyA9IDU7Ly8gbnVtYmVyIG9mIGF0dGVtcHRzIHRvIHJlZ2lzdGVyIEh5cGVydGllcyBhbmQgRGF0YU9iamVjdHMgd2hlbiBlcnJvcnMgb2NjdXJzXHJcblxyXG4gICAgLy8gdGhlIGV4cGlyZXMgaW4gMzYwMCwgcmVwcmVzZW50cyAxIGhvdXJcclxuICAgIC8vdGhlIGV4cGlyZXMgaXMgaW4gc2Vjb25kcywgdW5pdCBvZiBtZWFzdXJlIHJlY2VpdmVkIGJ5IHRoZSBkb21haW4gcmVnaXN0cnlcclxuICAgIF90aGlzLmV4cGlyZXNUaW1lID0gMzYwMDtcclxuXHJcbiAgICBfdGhpcy5fZG9tYWluID0gZG9tYWluO1xyXG4gICAgX3RoaXMuX21lc3NhZ2VCdXMgPSBtZXNzYWdlQnVzO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICogIGZ1bmN0aW9uIHRvIHVucmVnaXN0ZXIgYW4gaHlwZXJ0eUluc3RhbmNlIGluIHRoZSBEb21haW4gUmVnaXN0cnlcclxuICAqICBAcGFyYW0gICB7U3RyaW5nfSAgICAgIGh5cGVydHlJbnN0YW5jZSAgIEh5cGVydHlJbnNudGFuY2UgdXJsXHJcbiAgKlxyXG4gICovXHJcbiAgdW5yZWdpc3Rlckh5cGVydHkoaHlwZXJ0eUluc3RhbmNlKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgICAgbGV0IG1lc3NhZ2UgPSB7IHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCxcclxuICAgICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5fZG9tYWluLFxyXG4gICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6ICcvaHlwZXJ0eS8nICsgaHlwZXJ0eUluc3RhbmNlLCB2YWx1ZTogJ2Rpc2Nvbm5lY3RlZCcsIGF0dHJpYnV0ZTogJ3N0YXR1cycgfX07XHJcblxyXG4gICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCAocmVwbHkpID0+IHtcclxuICAgICAgICBsb2cubG9nKCdbRG9tYWluUmVnaXN0cmF0aW9uXSB1bnJlZ2lzdGVyIGh5cGVydHkgUmVwbHknLCByZXBseSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqICBmdW5jdGlvbiB0byB1bnJlZ2lzdGVyIGEgRGF0YSBPYmplY3QgaW4gdGhlIERvbWFpbiBSZWdpc3RyeVxyXG4gICogIEBwYXJhbSAgIHtTdHJpbmd9ICAgICAgaHlwZXJ0eUluc3RhbmNlICAgSHlwZXJ0eUluc250YW5jZSB1cmxcclxuICAqXHJcbiAgKi9cclxuICB1bnJlZ2lzdGVyRGF0YU9iamVjdCh1cmwpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IG1lc3NhZ2UgPSB7IHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCxcclxuICAgICAgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgX3RoaXMuX2RvbWFpbixcclxuICAgICAgYm9keToge1xyXG4gICAgICAgIHJlc291cmNlOiB1cmwsXHJcbiAgICAgICAgdmFsdWU6IHtcclxuICAgICAgICAgIHN0YXR1czogJ2Rpc2Nvbm5lY3RlZCdcclxuICAgICAgICB9XHJcbiAgICAgIH19O1xyXG5cclxuICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIChyZXBseSkgPT4ge1xyXG4gICAgICBsb2cubG9nKCdbRG9tYWluUmVnaXN0cmF0aW9uXSB1bnJlZ2lzdGVyIGRhdGFPYmplY3QgUmVwbHknLCByZXBseSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogIGZ1bmN0aW9uIHRvIGRlbGV0ZSBhbiBkYXRhT2JqZWN0SW5zdGFuY2UgaW4gdGhlIERvbWFpbiBSZWdpc3RyeVxyXG4gICogIEBwYXJhbSAgIHtTdHJpbmd9ICAgIG5hbWUgICAgICBEYXRhT2JqZWN0TmFtZVxyXG4gICovXHJcbiAgZGVsZXRlRGF0YU9iamVjdEluc3RhbmNlKG5hbWUpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IG1lc3NhZ2UgPSB7IHR5cGU6ICdkZWxldGUnLCBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCxcclxuICAgICAgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgX3RoaXMuX2RvbWFpbixcclxuICAgICAgYm9keTogeyB2YWx1ZToge25hbWU6IG5hbWV9fX07XHJcblxyXG4gICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgKHJlcGx5KSA9PiB7XHJcbiAgICAgIGxvZy5sb2coJ1tEb21haW5SZWdpc3RyYXRpb25dIHVucmVnaXN0ZXIgZGF0YU9iamVjdCBSZXBseScsIHJlcGx5KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBGdW5jdGlvbiB0byB1cGRhdGUgYW4gSHlwZXJ0eVxyXG4gICovXHJcbiAgdXBkYXRlSHlwZXJ0eUluc3RhbmNlKHJlc291cmNlLCB2YWx1ZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgbWVzc2FnZSA9IHsgdHlwZTogJ1VQREFURScsIGZyb206IF90aGlzLnJlZ2lzdHJ5VVJMLFxyXG4gICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5fZG9tYWluLFxyXG4gICAgICBib2R5OiB7IHJlc291cmNlOiByZXNvdXJjZSwgdmFsdWU6IHZhbHVlfX07XHJcblxyXG4gICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdC5wb3N0TWVzc2FnZShtZXNzYWdlLCAocmVwbHkpID0+IHtcclxuICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5XSBVcGRhdGVkIGh5cGVydHkgcmVwbHknLCByZXBseSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAqIFRvIHJlZ2lzdGVyIGEgbmV3IERhdGEgT2JqZWN0IGluIHRoZSBEb21haW4gUmVnaXN0cnkuXHJcbiAgKiBAcGFyYW0gIHtKU09OfSAgICAgcmVnaXN0cmF0aW9uICAgICAgICAgICAgICAgICAgIHJlZ2lzdHJhdGlvbiBkYXRhIHRvIGJlIHVzZWRcclxuICAqIEBwYXJhbSAge2Jvb2xlYW59ICAgICByZXN1bWUgICAgICAgICAgICAgICAgICAgICBpZiB0aGlzIGlzIGp1c3QgdG8gdXBkYXRlIHRoZSByZWdpc3RyYXRpb24gd2l0aCB0aGUgcmVzdW1lIG9mIGEgZGF0YSBvYmplY3RcclxuICAqL1xyXG5cclxuICByZWdpc3RlckRhdGFPYmplY3QocmVnaXN0cmF0aW9uLCByZXN1bWUsIHAycEhhbmRsZXJTdHViKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgcDJwSGFuZGxlcjtcclxuICAgIGxldCBwMnBSZXF1ZXN0ZXI7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IGRhdGFTY2hlbWUgPSBbXTtcclxuICAgICAgbGV0IGZpbHRlcmVkRGF0YVNjaGVtZSA9IHJlZ2lzdHJhdGlvbi51cmwuc3BsaXQoJzonKTtcclxuICAgICAgZGF0YVNjaGVtZS5wdXNoKGZpbHRlcmVkRGF0YVNjaGVtZVswXSk7XHJcblxyXG4gICAgICBpZiAoT2JqZWN0LmtleXMocDJwSGFuZGxlclN0dWIpLmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICBwMnBIYW5kbGVyID0gcDJwSGFuZGxlclN0dWJbX3RoaXMucnVudGltZVVSTF0udXJsO1xyXG4gICAgICBwMnBSZXF1ZXN0ZXIgPSBydW50aW1lVXRpbHMucnVudGltZURlc2NyaXB0b3IucDJwUmVxdWVzdGVyU3R1YjtcclxuICAgIH1cclxuXHJcbiAgICByZWdpc3RyYXRpb24uc3RhcnRpbmdUaW1lID0gcmVnaXN0cmF0aW9uLmNyZWF0ZWQ7XHJcblxyXG4gICAgZGVsZXRlIHJlZ2lzdHJhdGlvbi5hdXRob3Jpc2U7XHJcbiAgICBkZWxldGUgcmVnaXN0cmF0aW9uLmNyZWF0ZWQ7XHJcbiAgICBkZWxldGUgcmVnaXN0cmF0aW9uLm11dHVhbDtcclxuICAgIGRlbGV0ZSByZWdpc3RyYXRpb24ucmVzdW1lO1xyXG5cclxuICAgIGlmICghcmVnaXN0cmF0aW9uLmV4cGlyZXMpIHJlZ2lzdHJhdGlvbi5leHBpcmVzID0gX3RoaXMuZXhwaXJlc1RpbWU7XHJcblxyXG4gICAgcmVnaXN0cmF0aW9uLmRhdGFTY2hlbWVzID0gZGF0YVNjaGVtZTtcclxuXHJcbiAgICBpZiAocDJwSGFuZGxlcikge1xyXG4gICAgICByZWdpc3RyYXRpb24ucDJwSGFuZGxlciA9IHAycEhhbmRsZXI7XHJcbiAgICAgIHJlZ2lzdHJhdGlvbi5wMnBSZXF1ZXN0ZXIgPSBwMnBSZXF1ZXN0ZXI7XHJcbiAgICB9XHJcblxyXG4gICAgcmVnaXN0cmF0aW9uLnN0YXR1cyA9ICdsaXZlJztcclxuXHJcbiAgICBsZXQgbWVzc2FnZTtcclxuXHJcbiAgICBpZiAoIXJlc3VtZSkge1xyXG5cclxuICAgICAgbG9nLmxvZygnW1JlZ2lzdHJ5LnJlZ2lzdGVyRGF0YU9iamVjdF0gcmVnaXN0ZXJpbmcgbmV3IGRhdGEgb2JqZWN0IFVSTCcsIHJlZ2lzdHJhdGlvbik7XHJcblxyXG4gICAgICBtZXNzYWdlID0geyB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMucmVnaXN0cnlVUkwsIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIF90aGlzLl9kb21haW4sIGJvZHk6IHsgdmFsdWU6IHJlZ2lzdHJhdGlvbiwgcG9saWN5OiAncG9saWN5JyB9IH07XHJcblxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIGxvZy5sb2coJ1tSZWdpc3RyeS5yZWdpc3RlckRhdGFPYmplY3RdIHJlZ2lzdGVyaW5nIHByZXZpb3VzbHkgcmVnaXN0ZXJlZCBkYXRhIG9iamVjdCBVUkwnLCByZWdpc3RyYXRpb24pO1xyXG5cclxuICAgICAgbWVzc2FnZSA9IHtcclxuICAgICAgICB0eXBlOiAndXBkYXRlJyxcclxuICAgICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5fZG9tYWluLFxyXG4gICAgICAgIGZyb206IF90aGlzLnJlZ2lzdHJ5VVJMLFxyXG4gICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IHJlZ2lzdHJhdGlvbi51cmwsIHZhbHVlOiB7IHN0YXR1czogJ2xpdmUnIH0gfVxyXG4gICAgICB9O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZVdpdGhSZXRyaWVzKG1lc3NhZ2UsIF90aGlzLl9yZWdpc3RyYXRpb25SZXRyaWVzLCAocmVwbHkpID0+IHtcclxuICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkucmVnaXN0ZXJEYXRhT2JqZWN0XSA9PT0+IHJlZ2lzdGVyRGF0YU9iamVjdCBSZXBseTogJywgcmVwbHkpO1xyXG4gICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkge1xyXG4gICAgICAgICAgcmVzb2x2ZShyZWdpc3RyYXRpb24pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZWplY3QoJ2Vycm9yIG9uIHJlZ2lzdGVyIERhdGFPYmplY3QnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBsb2cuZXJyb3IoZSk7XHJcbiAgICAgIHJlamVjdChlKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy90aW1lciB0byBrZWVwIHRoZSByZWdpc3RyYXRpb24gYWxpdmVcclxuICAgIC8vIHRoZSB0aW1lIGlzIGRlZmluZWQgYnkgYSBsaXR0bGUgbGVzcyB0aGFuIGhhbGYgb2YgdGhlIGV4cGlyZXMgdGltZSBkZWZpbmVkXHJcbiAgICBsZXQga2VlcEFsaXZlVGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICBsZXQgbWVzc2FnZSA9IHtcclxuICAgICAgICB0eXBlOiAndXBkYXRlJyxcclxuICAgICAgICBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCxcclxuICAgICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5fZG9tYWluLFxyXG4gICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IHJlZ2lzdHJhdGlvbi51cmwsIHZhbHVlOiB7IHN0YXR1czogJ2xpdmUnIH0sIG1ldGhvZDogJ3JlZnJlc2gnIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIChyZXBseSkgPT4ge1xyXG4gICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeS5yZWdpc3RlckRhdGFPYmplY3RdIEtlZXBBbGl2ZSBSZXBseTogJywgcmVwbHkpO1xyXG4gICAgICB9KTtcclxuICAgIH0sICgoKHJlZ2lzdHJhdGlvbi5leHBpcmVzIC8gMS4xKSAvIDIpICogMTAwMCkpO1xyXG5cclxuICB9KTtcclxuXHJcblxyXG4gIH1cclxuXHJcblxyXG5cclxuXHJcbiAgLyoqXHJcbiAgKiBUbyByZWdpc3RlciBhIG5ldyBIeXBlcnR5IGluIHRoZSBEb21haW4gUmVnaXN0cnkuXHJcbiAgKiBAcGFyYW0gIHtIeXBlcnR5SW5zdGFuY2V9ICAgICBoeXBlcnR5ICAgICAgICAgICAgSHlwZXJ0eSB0byBiZSByZWdpc3RlcmVkXHJcbiAgKiBAcGFyYW0gIHtib29sZWFufSAgICAgcmVzdW1lICAgICAgICAgICAgICAgICAgICAgaWYgdGhpcyBpcyBqdXN0IHRvIHVwZGF0ZSB0aGUgcmVnaXN0cmF0aW9uIHdpdGggdGhlIHJlc3VtZSBvZiBhIGRhdGEgb2JqZWN0XHJcbiAgKi9cclxuXHJcblxyXG4gIHJlZ2lzdGVySHlwZXJ0eShoeXBlcnR5LCByZXN1bWUpe1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgIGxldCBydW50aW1lID0gX3RoaXMucnVudGltZVVSTDtcclxuICAgIGxldCBzdGF0dXMgPSAnbGl2ZSc7XHJcblxyXG4gICAgLy9tZXNzYWdlIHRvIHJlZ2lzdGVyIHRoZSBuZXcgaHlwZXJ0eSwgd2l0aGluIHRoZSBkb21haW4gcmVnaXN0cnlcclxuICAgIGxldCBtZXNzYWdlO1xyXG4gICAgbGV0IHJlZ2lzdHJhdGlvbkV4cGlyZXMgPSBfdGhpcy5leHBpcmVzVGltZTtcclxuXHJcbiAgICBsZXQgbWVzc2FnZVZhbHVlID0ge1xyXG4gICAgICB1c2VyOiBoeXBlcnR5LnVzZXIuZW1haWwsXHJcbiAgICAgIGRlc2NyaXB0b3I6IGh5cGVydHkuZGVzY3JpcHRvclVSTCxcclxuICAgICAgdXJsOiBoeXBlcnR5Lmh5cGVydHlVUkwsXHJcbiAgICAgIGV4cGlyZXM6IHJlZ2lzdHJhdGlvbkV4cGlyZXMsXHJcbiAgICAgIHJlc291cmNlczogaHlwZXJ0eS5yZXNvdXJjZXMsXHJcbiAgICAgIGRhdGFTY2hlbWVzOiBoeXBlcnR5LmRhdGFTY2hlbWVzLFxyXG4gICAgICBydW50aW1lOiBydW50aW1lLFxyXG4gICAgICBzdGF0dXM6IHN0YXR1c1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBzZXQgYSBkaWZmZXJlbnQgZXhwaXJlcyBpZiBkZWZpbmVkIGluIHRoZSBoeXBlcnR5IGNvbmZpZ3VyYXRpb25cclxuXHJcbiAgICBpZiAoaHlwZXJ0eS5wMnBIYW5kbGVyKSB7XHJcbiAgICAgIG1lc3NhZ2VWYWx1ZS5wMnBIYW5kbGVyID0gaHlwZXJ0eS5wMnBIYW5kbGVyO1xyXG4gICAgICBtZXNzYWdlVmFsdWUucDJwUmVxdWVzdGVyID0gaHlwZXJ0eS5wMnBSZXF1ZXN0ZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gc2V0IGEgZGlmZmVyZW50IGV4cGlyZXMgdmFsdWUgaWYgY29uZmlndXJlZCBpbiB0aGUgSHlwZXJ0eSBkZXNjcmlwdG9yXHJcblxyXG4gICAgaWYgKGh5cGVydHkuZGVzY3JpcHRvci5jb25maWd1cmF0aW9uICYmIGh5cGVydHkuZGVzY3JpcHRvci5jb25maWd1cmF0aW9uLmV4cGlyZXMpIHJlZ2lzdHJhdGlvbkV4cGlyZXMgPSBoeXBlcnR5LmRlc2NyaXB0b3IuY29uZmlndXJhdGlvbi5leHBpcmVzO1xyXG5cclxuICAgIGlmICghcmVzdW1lKSB7XHJcbiAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSByZWdpc3Rlckh5cGVydHldIHJlZ2lzdGVyaW5nIG5ldyBIeXBlcnR5IFVSTCcsIGFkZHJlc3NVUkwuYWRkcmVzc1swXSk7XHJcblxyXG5cclxuICAgICAgLy8gc2V0IGEgZGlmZmVyZW50IGV4cGlyZXMgaWYgZGVmaW5lZCBpbiB0aGUgaHlwZXJ0eSBjb25maWd1cmF0aW9uXHJcblxyXG5cclxuICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IHJlZ2lzdGVySHlwZXJ0eV0gcmVnaXN0ZXJpbmcgbmV3IEh5cGVydHkgYXQgZG9tYWluIHJlZ2lzdHJ5ICcsIG1lc3NhZ2VWYWx1ZSk7XHJcblxyXG4gICAgICBtZXNzYWdlID0ge3R5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgX3RoaXMuX2RvbWFpbiwgYm9keToge3ZhbHVlOiBtZXNzYWdlVmFsdWUsIHBvbGljeTogJ3BvbGljeSd9fTtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgcmVnaXN0ZXJIeXBlcnR5XSByZWdpc3RlcmluZyBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgSHlwZXJ0eSBVUkwnLCBhZGRyZXNzVVJMLmFkZHJlc3NbMF0pO1xyXG5cclxuICAgICAgbWVzc2FnZSA9IHtcclxuICAgICAgICB0eXBlOiAndXBkYXRlJyxcclxuICAgICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5fZG9tYWluLFxyXG4gICAgICAgIGZyb206IF90aGlzLnJlZ2lzdHJ5VVJMLFxyXG4gICAgICAgIGJvZHk6IHtyZXNvdXJjZTogaHlwZXJ0eS5oeXBlcnR5VVJMLCB2YWx1ZTogeyBzdGF0dXM6ICdsaXZlJywgdXNlcjogaHlwZXJ0eS51c2VyLmVtYWlsIH19XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBpZiAoaHlwZXJ0eS5wMnBIYW5kbGVyKSB7XHJcbiAgICAgICAgbWVzc2FnZS5ib2R5LnZhbHVlLnAycEhhbmRsZXIgPSBoeXBlcnR5LnAycEhhbmRsZXI7XHJcbiAgICAgICAgbWVzc2FnZS5ib2R5LnZhbHVlLnAycFJlcXVlc3RlciA9IGh5cGVydHkucDJwUmVxdWVzdGVyO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IHJlZ2lzdGVySHlwZXJ0eV0gSHlwZXJ0eSByZWdpc3RyYXRpb24gYXQgZG9tYWluIHJlZ2lzdHJ5ICAtICcsIG1lc3NhZ2UpO1xyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZVdpdGhSZXRyaWVzKG1lc3NhZ2UsIF90aGlzLl9yZWdpc3RyYXRpb25SZXRyaWVzLCAocmVwbHkpID0+IHtcclxuICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSByZWdpc3Rlckh5cGVydHldIEh5cGVydHkgcmVnaXN0cmF0aW9uIHJlc3BvbnNlOiAnLCByZXBseSk7XHJcblxyXG4gICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSB7IHVybDogaHlwZXJ0eS5oeXBlcnR5VVJMfTtcclxuICAgICAgICAgICAgaWYgKGh5cGVydHkucDJwSGFuZGxlcikge1xyXG4gICAgICAgICAgICAgIHJlc3VsdC5wMnBIYW5kbGVyID0gaHlwZXJ0eS5wMnBIYW5kbGVyO1xyXG4gICAgICAgICAgICAgIHJlc3VsdC5wMnBSZXF1ZXN0ZXIgPSBoeXBlcnR5LnAycFJlcXVlc3RlcjtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gNDA0KSB7XHJcbiAgICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSByZWdpc3Rlckh5cGVydHldIFRoZSB1cGRhdGUgd2FzIG5vdCBwb3NzaWJsZS4gUmVnaXN0ZXJpbmcgbmV3IEh5cGVydHkgYXQgZG9tYWluIHJlZ2lzdHJ5Jyk7XHJcblxyXG4gICAgICAgICAgICBtZXNzYWdlID0ge3R5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgX3RoaXMuX2RvbWFpbiwgYm9keToge3ZhbHVlOiBtZXNzYWdlVmFsdWUsIHBvbGljeTogJ3BvbGljeSd9fTtcclxuXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2VXaXRoUmV0cmllcyhtZXNzYWdlLCBfdGhpcy5fcmVnaXN0cmF0aW9uUmV0cmllcywgKHJlcGx5KSA9PntcclxuICAgICAgICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSByZWdpc3Rlckh5cGVydHldIEh5cGVydHkgcmVnaXN0cmF0aW9uIHVwZGF0ZSByZXNwb25zZTogJywgcmVwbHkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0geyB1cmw6IGh5cGVydHkuaHlwZXJ0eVVSTH07XHJcbiAgICAgICAgICAgICAgICAgIGlmIChoeXBlcnR5LnAycEhhbmRsZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucDJwSGFuZGxlciA9IGh5cGVydHkucDJwSGFuZGxlcjtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucDJwUmVxdWVzdGVyID0gaHlwZXJ0eS5wMnBSZXF1ZXN0ZXI7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHJlZ2lzdGVyIGFuIEh5cGVydHk6ICcgKyByZXBseSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgbG9nLmVycm9yKGUpO1xyXG4gICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcmVnaXN0ZXIgYW4gSHlwZXJ0eSB0byBkb21haW46ICcsIHJlcGx5KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgbG9nLmVycm9yKGUpO1xyXG4gICAgICAgIHJlamVjdChlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy90aW1lciB0byBrZWVwIHRoZSByZWdpc3RyYXRpb24gYWxpdmVcclxuICAgICAgLy8gdGhlIHRpbWUgaXMgZGVmaW5lZCBieSBhIGxpdHRsZSBsZXNzIHRoYW4gaGFsZiBvZiB0aGUgZXhwaXJlcyB0aW1lIGRlZmluZWRcclxuICAgICAgbGV0IGtlZXBBbGl2ZVRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGxldCBtZXNzYWdlID0ge1xyXG4gICAgICAgICAgdHlwZTogJ3VwZGF0ZScsXHJcbiAgICAgICAgICBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCxcclxuICAgICAgICAgIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIF90aGlzLl9kb21haW4sXHJcbiAgICAgICAgICBib2R5OiB7IHJlc291cmNlOiBoeXBlcnR5Lmh5cGVydHlVUkwsIHZhbHVlOiB7c3RhdHVzOiAnbGl2ZSd9LCBtZXRob2Q6ICdyZWZyZXNoJyB9fTtcclxuXHJcbiAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgcmVnaXN0ZXJIeXBlcnR5XSBLZWVwQWxpdmUgUmVwbHk6ICcsIHJlcGx5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSwgKCgocmVnaXN0cmF0aW9uRXhwaXJlcyAvIDEuMSkgLyAyKSAqIDEwMDApKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBEb21haW5SZWdpc3RyYXRpb247XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbi8vIExvZyBTeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ1AyUENvbm5lY3Rpb25SZXNvbHZlJyk7XHJcblxyXG4vKipcclxuKiAgIFRvIHByb2Nlc3MgYWRkcmVzcyByZXNvbHV0aW9uIGZvciBwMnAgY29ubmVjdGlvbnNcclxuKi9cclxuY2xhc3MgUDJQQ29ubmVjdGlvblJlc29sdmUgIHtcclxuXHJcbiAgY29uc3RydWN0b3IocmVnaXN0cnkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fcmVnaXN0cnkgPSByZWdpc3RyeTtcclxuICAgIF90aGlzLl9yZW1vdGVQMlBFbnRpdGllcyA9IHt9OyAvLyBBbGwgcmVtb3RlIGVudGl0aWVzIGFuZCBhc3NvY2lhdGVkIHJ1bnRpbWUgdXJsIHRoYXQgYXJlIHJlYWNoYWJsZSB3aXRoIGV4aXN0aW5nIHAycCBjb25uZWN0aW9uc1xyXG5cclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAqIFZlcmlmaWVzIGlmIHJlbW90ZSBFbnRpdHkgY2FuIGJlIHJlYWNoZWQgd2l0aCBhIFAyUCBDb25uZWN0aW9uLlxyXG4gICogQHBhcmFtICB7VVJMLlVSTH0gICAgICAgIGluZm8gICAgICAgICAgIG9iamVjdCBVUkxcclxuICAqIEByZXR1cm4ge0h5cGVydHlEYXRhT2JqZWN0SW5zdGFuY2V9ICBhZGRyZXNzVVJMICAgICByZXR1cm4gdGhlIERhdGEgT2JqZWN0IGluc3RhbmNlIHJlZ2lzdGVyZWQgVVJMLCByZXR1cm4gdW5kZWZpbmVkIG90aGVyd2lzZVxyXG4gICovXHJcblxyXG4gIGNoZWNrUDJQKG1zZykge1xyXG5cclxuICAgIGlmICghbXNnLmhhc093blByb3BlcnR5KCd0bycpKSB7XHJcbiAgICAgIC8vIHRocm93IEVycm9yKCdUaGUgcDJwIHZlcmlmaWNhdGlvbiB3YXMgZmFpbGVkJyk7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnVGhlIHAycCB2ZXJpZmljYXRpb24gd2FzIGZhaWxlZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBzY2hlbWUgPSBtc2cudG8uc3BsaXQoJzovLycpWzBdO1xyXG5cclxuICAgIGxldCBjb21wID0gbXNnLnRvLnNwbGl0KCc6Ly8nKVsxXS5zcGxpdCgnLycpWzJdO1xyXG5cclxuICAgIGxldCB1cmw7XHJcblxyXG4gICAgaWYgKGNvbXApIHVybCA9IG1zZy50by5zdWJzdHJpbmcoMCwgbXNnLnRvLmluZGV4T2YoJy8nICsgY29tcCkpO1xyXG4gICAgZWxzZSB1cmwgPSBtc2cudG87XHJcblxyXG4gICAgbGV0IHAycCA9IHt9O1xyXG5cclxuICAgIGlmIChtc2cuYm9keSAmJiBtc2cuYm9keS5wMnApIHAycC5wMnAgPSBtc2cuYm9keS5wMnA7XHJcblxyXG4gICAgaWYgKG1zZy5ib2R5ICYmIG1zZy5ib2R5LnAycEhhbmRsZXIgJiYgbXNnLmJvZHkucDJwUmVxdWVzdGVyKSB7XHJcbiAgICAgIHAycC5wMnBIYW5kbGVyID0gbXNnLmJvZHkucDJwSGFuZGxlcjtcclxuICAgICAgcDJwLnAycFJlcXVlc3RlciA9IG1zZy5ib2R5LnAycFJlcXVlc3RlcjtcclxuICAgICAgcDJwLnJ1bnRpbWUgPSBtc2cuYm9keS5wMnBIYW5kbGVyLnNwbGl0KCcvcDJwaGFuZGxlci8nKVswXTtcclxuICAgIH1cclxuXHJcbiAgICBzd2l0Y2ggKHNjaGVtZSkge1xyXG4gICAgICBjYXNlICdydW50aW1lJzpcclxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja1AyUFJ1bnRpbWUodXJsLCBwMnApO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrUDJQRW50aXR5KHVybCwgcDJwKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFZlcmlmaWVzIGlmIHJlbW90ZSBFbnRpdHkgKEh5cGVydHkgb3IgRGF0YSBPYmplY3QpIGNhbiBiZSByZWFjaGVkIHdpdGggYSBQMlAgQ29ubmVjdGlvbi5cclxuICAqIEBwYXJhbSAge3N0cmluZ30gICAgICAgIHVybCAgICAgICAgICAgUmVtb3RlIEVudGl0eSBVUkwgdG8gYmUgY2hlY2tlZFxyXG4gICogQHBhcmFtICB7b2JqZWN0fSAgICAgICAgcDJwICAgICAgICAgICBwMnAgaW5mb3JtYXRpb24gdG8gYmUgdXNlZCBpbmNsdWRpbmcgwrRydW50aW1lwrQgd2l0aCByZW1vdGUgUnVudGltZSBVUkwsICdwMnBIYW5kbGVyJyByZW1vdGUgUDJQIEhhbmRsZXIgU3R1YiBVUkwgYW5kIHAycFJlcXVlc3RlciB3aXRoIENhdGFsb2d1ZSBVUkwgb2YgUDJQIFJlcXVlc3RlciB0byBiZSB1c2VkXHJcbiAgKiBAcmV0dXJuIHtwcm9taXNlfSByZWdpc3RlcmVkRW50aXR5ICAgICBpZiBwMnAgY29ubmVjdGlvbiBpcyBwb3NzaWJsZSBpdCByZXR1cm5zIHAycCBpbmZvcm1hdGlvbiB0byBiZSB1c2VkIGluIHRoZSBjb25uZWN0aW9uLCBvdGhlcndpc2UgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWRcclxuICAqL1xyXG5cclxuICBjaGVja1AyUEVudGl0eSh1cmwsIHAycCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBsZXQgcmVtb3RlRW50aXR5ID0gX3RoaXMuX3JlbW90ZVAyUEVudGl0aWVzW3VybF07XHJcblxyXG4gICAgICBpZiAocmVtb3RlRW50aXR5KSByZXNvbHZlKHJlbW90ZUVudGl0eSk7XHJcbiAgICAgIGVsc2UgaWYgKHAycC5ydW50aW1lKSByZXNvbHZlKHAycCk7IC8vIHVzZSBwcm92aWRlZCBwMnAgaWYgYXZhaWxhYmxlIGluIHRoZSBtZXNzYWdlIGJvZHlcclxuICAgICAgZWxzZSBpZiAocDJwLnAycCkgeyAvLyBvdGhlcndpc2UgbG9vayBvbiBEb21haW4gUmVnaXN0cnlcclxuXHJcbiAgICAgICAgbG9nLmxvZygnW1JlZ2lzdHJ5IC0gY2hlY2tQMlBFbnRpdHldIC0gc2VhcmNoIGluIERvbWFpbiBSZWdpc3RyeTogJywgdXJsKTtcclxuXHJcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgICAgICBmcm9tOiBfdGhpcy5fcmVnaXN0cnkucmVnaXN0cnlVUkwsXHJcbiAgICAgICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5fcmVnaXN0cnkuX2RvbWFpbixcclxuICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgcmVzb3VyY2U6IHVybFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIF90aGlzLl9yZWdpc3RyeS5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCAocmVwbHkpID0+IHtcclxuICAgICAgICAgIGxvZy5sb2coJ1tSZWdpc3RyeSAtIGNoZWNrUDJQRW50aXR5XSBEb21haW4gUmVnaXN0cnkgcmVwbHknLCByZXBseSk7XHJcbiAgICAgICAgICBpZiAoJ3ZhbHVlJyBpbiByZXBseS5ib2R5KSB7XHJcblxyXG4gICAgICAgICAgICAvL3RvZG86IHN0b3JlIHJldHJpZXZlZCBlbnRpdHlcclxuICAgICAgICAgICAgbGV0IHJlc29sdmVkRW50aXR5ID0gcmVwbHkuYm9keS52YWx1ZTtcclxuXHJcbiAgICAgICAgICAgIGlmIChyZXNvbHZlZEVudGl0eS5oYXNPd25Qcm9wZXJ0eSgncDJwSGFuZGxlcicpKSB7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShyZXNvbHZlZEVudGl0eSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KCdbUmVnaXN0cnkgY2hlY2tQMlBFbnRpdHldIEh5cGVydHkgZm91bmQgZG9lcyBub3Qgc3VwcG9ydCBQMlAnLCByZXBseS5ib2R5LnZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCgnW1JlZ2lzdHJ5IGNoZWNrUDJQRW50aXR5XSBIeXBlcnR5IHdpdGggUDJQSGFuZGxlciBub3QgZm91bmQnLCByZXBseS5ib2R5LmNvZGUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2UgcmVqZWN0KCdbUmVnaXN0cnkgY2hlY2tQMlBFbnRpdHldIE5vIFAyUCBDb25uZWN0aW9uIGF2YWlsYWJsZSBmb3IgJywgdXJsKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBWZXJpZmllcyBpZiByZW1vdGUgUnVudGltZSBjYW4gYmUgcmVhY2hlZCB3aXRoIGEgUDJQIENvbm5lY3Rpb24uXHJcbiAgKiBAcGFyYW0gIHtVUkwuVVJMfSAgICAgICAgcnVudGltZVVSTCAgICAgICAgICAgUnVudGltZSBVUkxcclxuICAqIEByZXR1cm4ge09iamVjdH0gIHAycENvbm5lY3Rpb24gICAgcmV0dXJuIHRoZSBQMlBDb25uZWN0aW9uIGluc3RhbmNlIHJlZ2lzdGVyZWQgVVJMLCByZXR1cm4gdW5kZWZpbmVkIG90aGVyd2lzZVxyXG4gICovXHJcblxyXG4gIGNoZWNrUDJQUnVudGltZShydW50aW1lVVJMLCBwMnApIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IHJlZ2lzdGVyZWRSdW50aW1lID0ge307XHJcblxyXG4gICAgLy8gbG9vayBvbiBsb2NhbGx5IHN0b3JlZCBwMnAgY29ubmVjdGlvbnNcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGlmIChfdGhpcy5fcmVnaXN0cnkucDJwQ29ubmVjdGlvbkxpc3RbcnVudGltZVVSTF0pIHtcclxuICAgICAgICByZXNvbHZlKHtydW50aW1lOiBydW50aW1lVVJMfSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoIHAycC5ydW50aW1lKSB7XHJcbiAgICAgICAgcmVnaXN0ZXJlZFJ1bnRpbWUgPSBwMnA7XHJcbiAgICAgICAgcmVzb2x2ZShyZWdpc3RlcmVkUnVudGltZSk7XHJcbiAgICAgIH0gZWxzZSByZWplY3QoJ1tSZWdpc3RyeS5QMlBDb25uZWN0aW9uUmVzb2x2ZS5jaGVja1AyUFJ1bnRpbWVdIE5vIFAyUCBDb25uZWN0aW9uIGZvdW5kIHRvICcsIHJ1bnRpbWVVUkwpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVmVyaWZpZXMgaWYgcmVtb3RlIEh5cGVydHkgY2FuIGJlIHJlYWNoZWQgd2l0aCBhIFAyUCBDb25uZWN0aW9uLlxyXG4gICogQHBhcmFtICB7SlNPTn0gICAgICAgIGluZm8gICAgICAgICAgIG9iamVjdCBvciBlbnRpdHkgY2hhcmF0ZXJpc3RpY3MgaW5mb1xyXG4gICogQHJldHVybiB7YWRkcmVzc1VSTH0gIGFkZHJlc3NVUkwgICAgIHJldHVybiB0aGUgVVJMIGlmIHRoZXJlIGlzIGFueSBwcmV2aW91c3kgcmVnaXN0ZXJlZCBVUkwsIHJldHVybiB1bmRlZmluZWQgb3RoZXJ3aXNlXHJcbiAgKi9cclxuXHJcbiAgY2hlY2tQMlBIeXBlcnR5KGh5cGVydHlVUkwsIHAycCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBsZXQgaHlwZXJ0eTtcclxuXHJcblxyXG4gICAgICAvLyBsb29rIG9uIGxvY2FsbHkgc3RvcmVkIGh5cGVydGllc1xyXG5cclxuICAgICAgZm9yIChsZXQgaSBpbiBfdGhpcy5fcmVnaXN0cnkucmVtb3RlSHlwZXJ0eUxpc3QpIHtcclxuICAgICAgICBoeXBlcnR5ID0gX3RoaXMuX3JlZ2lzdHJ5LnJlbW90ZUh5cGVydHlMaXN0W2ldO1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbUmVnaXN0cnkgLSBjaGVja1AyUEh5cGVydHldIC0gZm9yIGVhY2ggSHlwZXJ0eTogJywgaHlwZXJ0eSk7XHJcblxyXG4gICAgICAgIC8vIHRvZG86IGNoYW5nZSB0byBcImh5cGVydHkudXJsXCIgdG8gYmUgYWxpZ25lZCB3aXRoIGh5cGVydHkgaW5zdGFuY2UgZGF0YSBtb2RlbCBzcGVjXHJcblxyXG4gICAgICAgIGlmIChoeXBlcnR5Lmh5cGVydHlJRCA9PT0gaHlwZXJ0eVVSTCkge1xyXG5cclxuICAgICAgICAgIGlmIChoeXBlcnR5Lmhhc093blByb3BlcnR5KCdwMnBIYW5kbGVyJykpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZShoeXBlcnR5KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCgnW1JlZ2lzdHJ5IGNoZWNrUDJQSHlwZXJ0eV0gSHlwZXJ0eSBmb3VuZCBkb2VzIG5vdCBzdXBwb3J0IFAyUCcsIGh5cGVydHkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFoeXBlcnR5ICYmIHAycC5ydW50aW1lKSByZXNvbHZlKHAycCk7IC8vIHVzZSBwcm92aWRlZCBwMnAgaWYgYXZhaWxhYmxlIGluIHRoZSBtZXNzYWdlIGJvZHlcclxuICAgICAgZWxzZSBpZiAoIWh5cGVydHkgJiYgcDJwLnAycCkgeyAvLyBvdGhlcndpc2UgbG9vayBvbiBEb21haW4gUmVnaXN0cnlcclxuXHJcbiAgICAgICAgbG9nLmxvZygnW1JlZ2lzdHJ5IC0gY2hlY2tQMlBIeXBlcnR5XSAtIHNlYXJjaCBpbiBEb21haW4gUmVnaXN0cnk6ICcsIGh5cGVydHkpO1xyXG5cclxuICAgICAgICBsZXQgbWVzc2FnZSA9IHtcclxuICAgICAgICAgIHR5cGU6ICdyZWFkJyxcclxuICAgICAgICAgIGZyb206IF90aGlzLl9yZWdpc3RyeS5yZWdpc3RyeVVSTCxcclxuICAgICAgICAgIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIF90aGlzLl9yZWdpc3RyeS5fZG9tYWluLFxyXG4gICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICByZXNvdXJjZTogaHlwZXJ0eVVSTFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIF90aGlzLl9yZWdpc3RyeS5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCAocmVwbHkpID0+IHtcclxuICAgICAgICAgIGxvZy5sb2coJ1tSZWdpc3RyeSAtIGNoZWNrUDJQSHlwZXJ0eV0gRG9tYWluIFJlZ2lzdHJ5IHJlcGx5JywgcmVwbHkpO1xyXG4gICAgICAgICAgaWYgKCd2YWx1ZScgaW4gcmVwbHkuYm9keSkge1xyXG5cclxuICAgICAgICAgICAgLy90b2RvOiBzdG9yZSByZXRyaWV2ZWQgaHlwZXJ0eVxyXG4gICAgICAgICAgICBsZXQgcmVzb2x2ZWRIeXBlcnR5ID0gcmVwbHkuYm9keS52YWx1ZTtcclxuXHJcbiAgICAgICAgICAgIF90aGlzLl9yZWdpc3RyeS5yZW1vdGVIeXBlcnR5TGlzdC5wdXNoKHJlc29sdmVkSHlwZXJ0eSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocmVzb2x2ZWRIeXBlcnR5Lmhhc093blByb3BlcnR5KCdwMnBIYW5kbGVyJykpIHtcclxuICAgICAgICAgICAgICByZXNvbHZlKHJlc29sdmVkSHlwZXJ0eSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KCdbUmVnaXN0cnkgY2hlY2tQMlBIeXBlcnR5XSBIeXBlcnR5IGZvdW5kIGRvZXMgbm90IHN1cHBvcnQgUDJQJywgcmVwbHkuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoJ1tSZWdpc3RyeSBjaGVja1AyUEh5cGVydHldIEh5cGVydHkgd2l0aCBQMlBIYW5kbGVyIG5vdCBmb3VuZCcsIHJlcGx5LmJvZHkuY29kZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSByZWplY3QoJ1tSZWdpc3RyeSBjaGVja1AyUEh5cGVydHldIE5vIFAyUCBDb25uZWN0aW9uIGF2YWlsYWJsZSBmb3IgJywgaHlwZXJ0eVVSTCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVmVyaWZpZXMgaWYgcmVtb3RlIERhdGEgT2JqZWN0IGNhbiBiZSByZWFjaGVkIHdpdGggYSBQMlAgQ29ubmVjdGlvbi5cclxuICAqIEBwYXJhbSAge1VSTC5VUkx9ICAgICAgICBEYXRhT2JqZWN0VVJMICAgICAgICAgICBvYmplY3QgVVJMXHJcbiAgKiBAcmV0dXJuIHtIeXBlcnR5RGF0YU9iamVjdEluc3RhbmNlfSAgYWRkcmVzc1VSTCAgICAgcmV0dXJuIHRoZSBEYXRhIE9iamVjdCBpbnN0YW5jZSByZWdpc3RlcmVkIFVSTCwgcmV0dXJuIHVuZGVmaW5lZCBvdGhlcndpc2VcclxuICAqL1xyXG5cclxuICBjaGVja1AyUERhdGFPYmplY3QodXJsLCBwMnApIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIC8vIGxvb2sgb24gbG9jYWxseSBzdG9yZWQgUmVtb3RlIERhdGEgT2JqZWN0c1xyXG5cclxuICAgICAgbGV0IGRhdGFvYmplY3QgPSBfdGhpcy5fcmVnaXN0cnkucmVtb3RlRGF0YU9iamVjdExpc3QuZmlsdGVyKChpKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIChfdGhpcy5fcmVnaXN0cnkucmVtb3RlRGF0YU9iamVjdExpc3RbaV0udXJsID09PSB1cmwpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChkYXRhb2JqZWN0Lmxlbmd0aCAhPT0gMCAmJiBkYXRhb2JqZWN0WzBdLnAycFJlcXVlc3Rlcikge1xyXG4gICAgICAgIHJlc29sdmUoZGF0YW9iamVjdFswXSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZGF0YW9iamVjdC5sZW5ndGggIT09IDApIHtcclxuICAgICAgICByZWplY3QoJ1tSZWdpc3RyeSBjaGVja1AyUERhdGFPYmplY3RdIERhdGEgT2JqZWN0IGZvdW5kIGRvZXMgbm90IHN1cHBvcnQgUDJQJywgZGF0YW9iamVjdFswXSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZGF0YW9iamVjdC5sZW5ndGggPT09IDAgJiYgcDJwLnJ1bnRpbWUpIHJlc29sdmUocDJwKTsgLy8gdXNlIHByb3ZpZGVkIHAycCBpbmZvIGlmIGF2YWlsYWJsZSBpbiB0aGUgbWVzc2FnZSBib2R5XHJcbiAgICAgIGVsc2UgaWYgKGRhdGFvYmplY3QubGVuZ3RoICYmIHAycC5wMnApIHsgLy8gb3RoZXJ3aXNlIGxvb2sgb24gRG9tYWluIFJlZ2lzdHJ5XHJcblxyXG4gICAgICAvLyBsb29rIG9uIERvbWFpbiBSZWdpc3RyeVxyXG5cclxuICAgICAgICBsZXQgbWVzc2FnZSA9IHtcclxuICAgICAgICAgIHR5cGU6ICdyZWFkJyxcclxuICAgICAgICAgIGZyb206IF90aGlzLl9yZWdpc3RyeS5yZWdpc3RyeVVSTCxcclxuICAgICAgICAgIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIF90aGlzLl9yZWdpc3RyeS5fZG9tYWluLFxyXG4gICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICByZXNvdXJjZTogdXJsXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgX3RoaXMuX3JlZ2lzdHJ5Ll9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIChyZXBseSkgPT4ge1xyXG4gICAgICAgICAgbG9nLmxvZygnZGlzY292ZXIgZGF0YSBvYmplY3QgcGVyIHVybCByZXBseScsIHJlcGx5KTtcclxuICAgICAgICAgIGlmICgndmFsdWUnIGluIHJlcGx5LmJvZHkpIHtcclxuXHJcbiAgICAgICAgICAgIC8vdG9kbzogc3RvcmUgcmV0cmlldmVkIGh5cGVydHlcclxuICAgICAgICAgICAgbGV0IHJlc29sdmVkRGF0YU9iamVjdCA9IHJlcGx5LmJvZHkudmFsdWU7XHJcblxyXG4gICAgICAgICAgICBfdGhpcy5fcmVnaXN0cnkucmVtb3RlRGF0YU9iamVjdExpc3QucHVzaChyZXNvbHZlZERhdGFPYmplY3QpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHJlc29sdmVkRGF0YU9iamVjdC5wMnBSZXF1ZXN0ZXIpIHtcclxuICAgICAgICAgICAgICByZXNvbHZlKHJlc29sdmVkRGF0YU9iamVjdCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KCdbUmVnaXN0cnkgY2hlY2tQMlBEYXRhT2JqZWN0XSBEYXRhIE9iamVjdCBmb3VuZCBkb2VzIG5vdCBzdXBwb3J0IFAyUCcsIHJlcGx5LmJvZHkudmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KCdbUmVnaXN0cnkgY2hlY2tQMlBEYXRhT2JqZWN0XSBub3QgZm91bmQnLCByZXBseS5ib2R5LmNvZGUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2UgcmVqZWN0KCdbUmVnaXN0cnkgY2hlY2tQMlBEYXRhT2JqZWN0XSBubyBQMlAgQ29ubmVjdGlvbiBmb3VuZCcpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRSZW1vdGVQMlBFbnRpdHkodXJsLCBydW50aW1lKSB7XHJcbiAgICB0aGlzLl9yZW1vdGVQMlBFbnRpdGllc1t1cmxdID0gcnVudGltZTtcclxuICB9XHJcblxyXG4gIHJlbW92ZVJlbW90ZVAyUEVudGl0eSh1cmwpIHtcclxuICAgIGRlbGV0ZSB0aGlzLl9yZW1vdGVQMlBFbnRpdGllc1t1cmxdO1xyXG4gIH1cclxuXHJcbiAgcmVjb25uZWN0UDJQUmVxdWVzdGVyKHAycFJlcXVlc3Rlcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsb2cubG9nKCdbUDJQQ29uZW5jdGlvblJlc29sdmUucmVjb25uZWN0UDJQUmVxdWVzdGVyXSBsZXRzIHRyeSB0byByZWNvbm5lY3QgUDJQIFJlcXVlc3RlciBTdHViOiAnLCBwMnBSZXF1ZXN0ZXIpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgcmVtb3RlUnVudGltZSA9IHAycFJlcXVlc3Rlci5ydW50aW1lO1xyXG5cclxuICAgICAgbGV0IG1lc3NhZ2UgPSB7XHJcbiAgICAgICAgdHlwZTogJ2V4ZWN1dGUnLFxyXG4gICAgICAgIGZyb206IF90aGlzLl9yZWdpc3RyeS5yZWdpc3RyeVVSTCxcclxuICAgICAgICB0bzogcDJwUmVxdWVzdGVyLnVybCxcclxuICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICBtZXRob2Q6ICdjb25uZWN0JyxcclxuICAgICAgICAgIHBhcmFtczogW3AycFJlcXVlc3Rlci5wMnBIYW5kbGVyXVxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIGxldHMgcHJlcGFyZSB0aGUgcDJwUmVxdWVzdGVyU1R1YiByZWNvbm5lY3QgYnkgc2V0dGluZyBhbiBvYnNlcnZlciB0byBpdHMgc3RhdHVzIGNoYW5nZXNcclxuXHJcbiAgICAgIF90aGlzLl9yZWdpc3RyeS53YXRjaGluZ1lvdS5vYnNlcnZlKCdwMnBSZXF1ZXN0ZXJTdHViJywgKGNoYW5nZSkgPT4ge1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbUDJQQ29uZW5jdGlvblJlc29sdmUucmVjb25uZWN0UDJQUmVxdWVzdGVyXSBwMnBSZXF1ZXN0ZXJTdHVicyBjaGFuZ2VkICcgKyBfdGhpcy5fcmVnaXN0cnkucDJwUmVxdWVzdGVyU3R1Yik7XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2Uua2V5cGF0aC5zcGxpdCgnLicpWzBdID09PSByZW1vdGVSdW50aW1lICYmIGNoYW5nZS5uYW1lID09PSAnc3RhdHVzJykge1xyXG4gICAgICAgICAgc3dpdGNoIChjaGFuZ2UubmV3VmFsdWUpIHtcclxuICAgICAgICAgICAgY2FzZSAnbGl2ZSc6XHJcbiAgICAgICAgICAgICAgbG9nLmxvZygnW1AyUENvbmVuY3Rpb25SZXNvbHZlLnJlY29ubmVjdFAyUFJlcXVlc3Rlcl0gcDJwUmVxdWVzdGVyIGlzIGxpdmUgJyArIF90aGlzLl9yZWdpc3RyeS5wMnBSZXF1ZXN0ZXJTdHViW3JlbW90ZVJ1bnRpbWVdKTtcclxuICAgICAgICAgICAgICByZXNvbHZlKF90aGlzLl9yZWdpc3RyeS5wMnBSZXF1ZXN0ZXJTdHViW3JlbW90ZVJ1bnRpbWVdLnVybCk7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2ZhaWxlZCc6XHJcbiAgICAgICAgICAgICAgbG9nLmxvZygnW1AyUENvbmVuY3Rpb25SZXNvbHZlLnJlY29ubmVjdFAyUFJlcXVlc3Rlcl0gcDJwUmVxdWVzdGVyIHJlY29ubmVjdCBmYWlsZWQgJyArIF90aGlzLl9yZWdpc3RyeS5wMnBSZXF1ZXN0ZXJTdHViW3JlbW90ZVJ1bnRpbWVdKTtcclxuICAgICAgICAgICAgICByZWplY3QoJ1AyUCBSZXF1ZXN0ZXIgcmVjb25uZWN0IGZhaWxlZCcpO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyAgc3R1YiBsb2FkXHJcbiAgICAgIF90aGlzLl9yZWdpc3RyeS5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCAocmVwbHkpID0+IHtcclxuICAgICAgICBsb2cubG9nKCdbUDJQQ29uZW5jdGlvblJlc29sdmUucmVjb25uZWN0UDJQUmVxdWVzdGVyXSByZWNvbm5lY3QgcmVxdWVzdCByZXBseScsIHJlcGx5KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQMlBDb25uZWN0aW9uUmVzb2x2ZTtcclxuIiwiaW1wb3J0ICdwcm94eS1vYnNlcnZlJztcclxuXHJcbmNsYXNzIFdhdGNoaW5nWW91IHtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLl93YXRjaGluZyA9IHt9O1xyXG4gICAgdGhpcy5fb2JzZXJ2ZXJzID0gW107XHJcbiAgfVxyXG5cclxuICB3YXRjaChrZXksIG9iamVjdCwgZGVlcCA9IGZhbHNlKSB7XHJcbiAgICBpZiAoZGVlcCkge1xyXG4gICAgICB0aGlzLl93YXRjaGluZ1trZXldID0gT2JqZWN0LmRlZXBPYnNlcnZlKG9iamVjdCwgKGNoYW5nZXMpID0+IHtcclxuICAgICAgICBjaGFuZ2VzLmV2ZXJ5KChjaGFuZ2UpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2ZpcmVFdmVudChrZXksIGNoYW5nZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fd2F0Y2hpbmdba2V5XSA9IE9iamVjdC5vYnNlcnZlKG9iamVjdCwgKGNoYW5nZXMpID0+IHtcclxuICAgICAgICBjaGFuZ2VzLmV2ZXJ5KChjaGFuZ2UpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2ZpcmVFdmVudChrZXksIGNoYW5nZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuX3dhdGNoaW5nW2tleV07XHJcbiAgfVxyXG5cclxuICBvYnNlcnZlKGtleSwgY2FsbGJhY2spIHtcclxuICAgIHRoaXMuX29ic2VydmVycy5wdXNoKHtrZXk6IGtleSwgY2FsbGJhY2s6IGNhbGxiYWNrfSk7XHJcbiAgfVxyXG5cclxuICBfZmlyZUV2ZW50KGtleSwgY2hhbmdlKSB7XHJcblxyXG4gICAgdGhpcy5fb2JzZXJ2ZXJzLmZpbHRlcigob2JzZXJ2ZSkgPT4ge1xyXG4gICAgICByZXR1cm4gb2JzZXJ2ZS5rZXkgPT09IGtleTtcclxuICAgIH0pLmZvckVhY2goKG9ic2VydmUpID0+IHtcclxuICAgICAgb2JzZXJ2ZS5jYWxsYmFjayhjaGFuZ2UpO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFdhdGNoaW5nWW91O1xyXG5cclxuLypsZXQgd2F0Y2hDaGFuZ2VzID0gbmV3IFdhdGNoQ2hhbmdlcygpO1xyXG5sZXQgcDJwUmVxdWVzdGVyU3R1YiA9IHdhdGNoQ2hhbmdlcy53YXRjaCgncDJwJywge30sIHRydWUpO1xyXG5sZXQgc3R1YiA9IHdhdGNoQ2hhbmdlcy53YXRjaCgnc3R1YicsIHt9KTtcclxuXHJcbndhdGNoQ2hhbmdlcy5vYnNlcnZlKCdwMnAnLCAoY2hhbmdlKSA9PiB7XHJcbiAgY29uc29sZS5sb2coJ3AycFJlcXVlc3RlclN0dWI6ICcgKyBjaGFuZ2UubmFtZSArICcgLSAnICsgSlNPTi5zdHJpbmdpZnkoY2hhbmdlLm5ld1ZhbHVlKSk7XHJcbn0pO1xyXG5cclxud2F0Y2hDaGFuZ2VzLm9ic2VydmUoJ3AycCcsIChjaGFuZ2UpID0+IHtcclxuICBjb25zb2xlLmxvZygncDJwUmVxdWVzdGVyU3R1YjogJyArIGNoYW5nZS5uYW1lICsgJyAtICcgKyBKU09OLnN0cmluZ2lmeShjaGFuZ2UubmV3VmFsdWUpKTtcclxufSk7XHJcblxyXG53YXRjaENoYW5nZXMub2JzZXJ2ZSgnc3R1YicsIChjaGFuZ2UpID0+IHtcclxuICBjb25zb2xlLmxvZygnc3R1YiAnICsgY2hhbmdlLm5hbWUpO1xyXG59KTtcclxuXHJcbnAycFJlcXVlc3RlclN0dWIuYSA9IHt9O1xyXG5zdHViLmIgPSB7bmFtZTogJ3ZpdG9yJ307XHJcbnAycFJlcXVlc3RlclN0dWIuYS5uYW1lID0gJ0hlbGxvJztcclxuc3R1Yi5iID0ge25hbWU6ICd2aXRvcid9O1xyXG5wMnBSZXF1ZXN0ZXJTdHViLmEuYWdlID0gJzMyJztcclxucDJwUmVxdWVzdGVyU3R1Yi5hLm5hbWUgPSAnV29ybGQnOyovXHJcbiIsImltcG9ydCBXYXRjaGluZ1lvdSBmcm9tICcuL3V0aWxzL1dhdGNoaW5nWW91JztcclxuXHJcbmV4cG9ydCB7IFdhdGNoaW5nWW91IH07XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbi8vIExvZyBTeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ1JlZ2lzdHJ5Jyk7XHJcblxyXG5pbXBvcnQgeyBydW50aW1lVXRpbHMgfSBmcm9tICcuLi9ydW50aW1lL3J1bnRpbWVVdGlscyc7XHJcbmltcG9ydCB7IFNhbmRib3hUeXBlfSBmcm9tICcuLi9zYW5kYm94L1NhbmRib3gnO1xyXG5cclxuaW1wb3J0IEFkZHJlc3NBbGxvY2F0aW9uIGZyb20gJy4uL2FsbG9jYXRpb24vQWRkcmVzc0FsbG9jYXRpb24nO1xyXG5pbXBvcnQgSHlwZXJ0eUluc3RhbmNlIGZyb20gJy4vSHlwZXJ0eUluc3RhbmNlJztcclxuaW1wb3J0IERvbWFpblJlZ2lzdHJhdGlvbiBmcm9tICcuL0RvbWFpblJlZ2lzdHJhdGlvbic7XHJcbmltcG9ydCBQMlBDb25uZWN0aW9uUmVzb2x2ZSBmcm9tICcuL1AyUENvbm5lY3Rpb25SZXNvbHZlJztcclxuXHJcbmltcG9ydCB7IGRpdmlkZVVSTCwgaXNIeXBlcnR5VVJMLCBpc1VSTCwgaXNVc2VyVVJMLCBnZW5lcmF0ZUdVSUQsIGdldFVzZXJJZGVudGl0eURvbWFpbiwgaXNCYWNrZW5kU2VydmljZVVSTCwgZGVlcENsb25lLCByZW1vdmVQYXRoRnJvbVVSTCB9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcclxuXHJcbmltcG9ydCAncHJveHktb2JzZXJ2ZSc7XHJcbmltcG9ydCB7IFdhdGNoaW5nWW91IH0gZnJvbSAnLi4vVXRpbHMnO1xyXG5cclxuLy8gaW1wb3J0IERpc2NvdmVyeVNlcnZpY2VGcmFtZXdvcmsgZnJvbSAnLi9EaXNjb3ZlcnlTZXJ2aWNlRnJhbWV3b3JrJztcclxuXHJcbmNvbnN0IFNUQVRVUyA9IHsgQ1JFQVRFRDogJ2NyZWF0ZWQnLCBMSVZFOiAnbGl2ZScsIERFUExPWUlORzogJ2RlcGxveWluZycsIERFUExPWUVEOiAnZGVwbG95ZWQnLCBQUk9HUkVTUzogJ2luLXByb2dyZXNzJywgRElTQ09OTkVDVEVEOiAnZGlzY29ubmVjdGVkJywgRkFJTEVEOiAnZGVwbG95bWVudC1mYWlsZWQnLCBERUFEOiAnZGVhZCcgfTtcclxuXHJcbi8qaW1wb3J0IElkZW50aXR5TWFuYWdlciBmcm9tICcuL0lkZW50aXR5TWFuYWdlcic7XHJcbmltcG9ydCBEaXNjb3ZlcnkgZnJvbSAnLi9EaXNjb3ZlcnknOyovXHJcblxyXG4vKipcclxuKiBSdW50aW1lIFJlZ2lzdHJ5IEludGVyZmFjZVxyXG4qL1xyXG5jbGFzcyBSZWdpc3RyeSB7XHJcblxyXG4gIC8qKlxyXG4gICogVG8gaW5pdGlhbGlzZSB0aGUgUnVudGltZSBSZWdpc3RyeSB3aXRoIHRoZSBSdW50aW1lVVJMIHRoYXQgd2lsbCBiZSB0aGUgYmFzaXMgdG8gZGVyaXZlIHRoZSBpbnRlcm5hbCBydW50aW1lIGFkZHJlc3NlcyB3aGVuIGFsbG9jYXRpbmcgYWRkcmVzc2VzIHRvIGludGVybmFsIHJ1bnRpbWUgY29tcG9uZW50LiBJbiBhZGRpdGlvbiwgdGhlIFJlZ2lzdHJ5IGRvbWFpbiBiYWNrLWVuZCB0byBiZSB1c2VkIHRvIHJlbW90ZWx5IHJlZ2lzdGVyIFJ1bnRpbWUgY29tcG9uZW50cywgaXMgYWxzbyBwYXNzZWQgYXMgaW5wdXQgcGFyYW1ldGVyLlxyXG4gICogQHBhcmFtICB7TWVzc2FnZUJ1c30gICAgICAgICAgbXNnYnVzICAgICAgICAgICAgICAgIG1zZ2J1c1xyXG4gICogQHBhcmFtICB7SHlwZXJ0eVJ1bnRpbWVVUkx9ICAgcnVudGltZVVSTCAgICAgICAgICAgIHJ1bnRpbWVVUkxcclxuICAqIEBwYXJhbSAge0FwcFNhbmRib3h9ICAgICAgICAgIGFwcFNhbmRib3ggICAgICAgICAgICBhcHBTYW5kYm94XHJcbiAgKiBAcGFyYW0gIHtydW50aW1lQ2F0YWxvZ3VlfSAgICBydW50aW1lQ2F0YWxvZ3VlICAgICAgcnVudGltZUNhdGFsb2d1ZVxyXG4gICogQHBhcmFtICB7RG9tYWluVVJMfSAgICAgICAgICAgcmVtb3RlUmVnaXN0cnkgICAgICAgIHJlbW90ZVJlZ2lzdHJ5XHJcbiAgKiBAcGFyYW0gIHtzdG9yYWdlTWFuYWdlcn0gICAgICBzdG9yYWdlTWFuYWdlclxyXG4gICovXHJcbiAgY29uc3RydWN0b3IocnVudGltZVVSTCwgYXBwU2FuZGJveCwgaWRlbnRpdHlNb2R1bGUsIHJ1bnRpbWVDYXRhbG9ndWUsIHJ1bnRpbWVDYXBhYmlsaXRpZXMsIHN0b3JhZ2VNYW5hZ2VyLCBwMnBIYW5kbGVyVVJMLCByZW1vdGVSZWdpc3RyeSkge1xyXG5cclxuICAgIC8vIGhvdyBzb21lIGZ1bmN0aW9ucyByZWNlaXZlIHRoZSBwYXJhbWV0ZXJzIGZvciBleGFtcGxlOlxyXG4gICAgLy8gbmV3IFJlZ2lzdHJ5KCdoeXBlcnR5LXJ1bnRpbWU6Ly9zcDEvMTIzJywgYXBwU2FuZGJveCwgaWRNb2R1bGUsIHJlbW90ZVJlZ2lzdHJ5KTtcclxuICAgIC8vIHJlZ2lzdHJ5LnJlZ2lzdGVyU3R1YihzYW5kYm94LCAnc3AxJyk7XHJcbiAgICAvLyByZWdpc3RyeS5yZWdpc3Rlckh5cGVydHkoc2FuZEJveCwgJ2h5cGVydHktcnVudGltZTovL3NwMS8xMjMnKTtcclxuICAgIC8vIHJlZ2lzdHJ5LnJlc29sdmUoJ2h5cGVydHktcnVudGltZTovL3NwMS8xMjMnKTtcclxuXHJcbiAgICBpZiAoIXJ1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcigncnVudGltZVVSTCBpcyBtaXNzaW5nLicpO1xyXG4gICAgaWYgKCFzdG9yYWdlTWFuYWdlcikgdGhyb3cgbmV3IEVycm9yKCdzdG9yYWdlTWFuYWdlciBpcyBtaXNzaW5nLicpO1xyXG5cclxuICAgIC8qaWYgKCFyZW1vdGVSZWdpc3RyeSkgdGhyb3cgbmV3IEVycm9yKCdyZW1vdGVSZWdpc3RyeSBpcyBtaXNzaW5nJyk7Ki9cclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLnJlZ2lzdHJ5VVJMID0gcnVudGltZVVSTCArICcvcmVnaXN0cnkvJztcclxuICAgIF90aGlzLmFwcFNhbmRib3ggPSBhcHBTYW5kYm94O1xyXG4gICAgX3RoaXMucnVudGltZVVSTCA9IHJ1bnRpbWVVUkw7XHJcbiAgICBfdGhpcy5wMnBIYW5kbGVyVVJMID0gcDJwSGFuZGxlclVSTDtcclxuICAgIF90aGlzLnJ1bnRpbWVDYXRhbG9ndWUgPSBydW50aW1lQ2F0YWxvZ3VlO1xyXG4gICAgX3RoaXMucmVtb3RlUmVnaXN0cnkgPSByZW1vdGVSZWdpc3RyeTtcclxuICAgIF90aGlzLmlkTW9kdWxlID0gaWRlbnRpdHlNb2R1bGU7XHJcbiAgICBfdGhpcy5zdG9yYWdlTWFuYWdlciA9IHN0b3JhZ2VNYW5hZ2VyO1xyXG4gICAgX3RoaXMucnVudGltZUNhcGFiaWxpdGllcyA9IHJ1bnRpbWVDYXBhYmlsaXRpZXM7XHJcbiAgICBfdGhpcy5pZGVudGlmaWVyID0gZ2VuZXJhdGVHVUlEKCk7XHJcblxyXG4gICAgX3RoaXMuaHlwZXJ0aWVzTGlzdFRvUmVtb3ZlID0ge307XHJcbiAgICBfdGhpcy5oeXBlcnRpZXNMaXN0ID0gW107XHJcbiAgICBfdGhpcy5yZW1vdGVIeXBlcnR5TGlzdCA9IFtdO1xyXG4gICAgX3RoaXMucmVtb3RlRGF0YU9iamVjdExpc3QgPSBbXTtcclxuICAgIF90aGlzLmlkcExlZ2FjeVByb3h5TGlzdCA9IHt9O1xyXG5cclxuICAgIF90aGlzLndhdGNoaW5nWW91ID0gbmV3IFdhdGNoaW5nWW91KCk7XHJcbiAgICBfdGhpcy5wMnBIYW5kbGVyU3R1YiA9IHt9O1xyXG4gICAgX3RoaXMucDJwUmVxdWVzdGVyU3R1YiA9IF90aGlzLndhdGNoaW5nWW91LndhdGNoKCdwMnBSZXF1ZXN0ZXJTdHViJywge30sIHRydWUpO1xyXG4gICAgX3RoaXMucDJwQ29ubmVjdGlvbkxpc3QgPSBfdGhpcy53YXRjaGluZ1lvdS53YXRjaCgncDJwQ29ubmVjdGlvbkxpc3QnLCB7fSwgdHJ1ZSk7XHJcbiAgICBfdGhpcy5wMnBIYW5kbGVyQXNzb2NpYXRpb24gPSB7fTtcclxuXHJcbiAgICBfdGhpcy5wcm90b3N0dWJzTGlzdCA9IF90aGlzLndhdGNoaW5nWW91LndhdGNoKCdwcm90b3N0dWJzTGlzdCcsIHt9LCB0cnVlKTtcclxuICAgIF90aGlzLmlkcFByb3h5TGlzdCA9IF90aGlzLndhdGNoaW5nWW91LndhdGNoKCdpZHBQcm94eUxpc3QnLCB7fSwgdHJ1ZSk7XHJcbiAgICBfdGhpcy5kYXRhT2JqZWN0TGlzdCA9IHt9O1xyXG4gICAgX3RoaXMuc3Vic2NyaWJlZERhdGFPYmplY3RMaXN0ID0ge307XHJcbiAgICBfdGhpcy5zYW5kYm94ZXNMaXN0ID0ge3NhbmRib3g6IHt9LCBhcHBTYW5kYm94OiB7fSB9O1xyXG4gICAgX3RoaXMucGVwTGlzdCA9IHt9O1xyXG4gICAgX3RoaXMucmVnaXN0cmllcyA9IHt9O1xyXG5cclxuICAgIF90aGlzLl9kb21haW4gPSBkaXZpZGVVUkwoX3RoaXMucmVnaXN0cnlVUkwpLmRvbWFpbjtcclxuICAgIF90aGlzLnNhbmRib3hlc0xpc3QuYXBwU2FuZGJveFtydW50aW1lVVJMXSA9IGFwcFNhbmRib3g7XHJcbiAgICBsZXQgcDJwQ29ubmVjdGlvblJlc29sdmUgPSBuZXcgUDJQQ29ubmVjdGlvblJlc29sdmUoX3RoaXMpO1xyXG5cclxuICAgIF90aGlzLl9wMnBDb25uZWN0aW9uUmVzb2x2ZSA9IHAycENvbm5lY3Rpb25SZXNvbHZlO1xyXG5cclxuICAgIF90aGlzLl9oeXBlcnR5VXJscyA9IHt9O1xyXG4gICAgX3RoaXMuX2RhdGFPYmplY3RVcmxzID0ge307XHJcbiAgfVxyXG5cclxuICBsb2FkUmVnaXN0cnkoKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIuZ2V0KCdyZWdpc3RyeTpIeXBlcnR5VVJMcycpLnRoZW4oKHVybHNMaXN0KSA9PiB7XHJcbiAgICAgICAgaWYgKHVybHNMaXN0KSBfdGhpcy5faHlwZXJ0eVVybHMgPSB1cmxzTGlzdDtcclxuICAgICAgICBfdGhpcy5zdG9yYWdlTWFuYWdlci5nZXQoJ3JlZ2lzdHJ5OkRhdGFPYmplY3RVUkxzJykudGhlbigodXJsc0xpc3QpID0+IHtcclxuICAgICAgICAgIGlmICh1cmxzTGlzdCkgX3RoaXMuX2RhdGFPYmplY3RVcmxzID0gdXJsc0xpc3Q7XHJcbiAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXQgbG9hZGVyKGxvYWRlcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9sb2FkZXIgPSBsb2FkZXI7XHJcbiAgfVxyXG5cclxuICBnZXQgbG9hZGVyKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fbG9hZGVyO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiByZXR1cm4gdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeVxyXG4gICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1c1xyXG4gICovXHJcbiAgZ2V0IG1lc3NhZ2VCdXMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9tZXNzYWdlQnVzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBTZXQgdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeVxyXG4gICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1c1xyXG4gICovXHJcbiAgc2V0IG1lc3NhZ2VCdXMobWVzc2FnZUJ1cykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9tZXNzYWdlQnVzID0gbWVzc2FnZUJ1cztcclxuXHJcbiAgICBfdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihfdGhpcy5yZWdpc3RyeVVSTCwgZnVuY3Rpb24obXNnKSB7XHJcblxyXG4gICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgbGlzdGVuZXJdICcsIG1zZyk7XHJcblxyXG4gICAgICBsZXQgaXNIeXBlcnR5ID0gaXNIeXBlcnR5VVJMKG1zZy5mcm9tKTtcclxuICAgICAgbGV0IGhhc0NyaXRlcmlhID0gbXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ2NyaXRlcmlhJyk7XHJcbiAgICAgIGxldCBpc1VSTFJlc291cmNlO1xyXG4gICAgICBsZXQgaXNVc2VyUmVzb3VyY2U7XHJcbiAgICAgIGxldCBpc0h5cGVydHlSZXNvdXJjZTtcclxuXHJcbiAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgncmVzb3VyY2UnKSAmJiBtc2cuYm9keS5yZXNvdXJjZSAhPT0gJy4nKSB7XHJcbiAgICAgICAgaXNVUkxSZXNvdXJjZSA9IGlzVVJMKG1zZy5ib2R5LnJlc291cmNlKTtcclxuICAgICAgICBpc1VzZXJSZXNvdXJjZSA9IGlzVXNlclVSTChtc2cuYm9keS5yZXNvdXJjZSk7XHJcbiAgICAgICAgaXNIeXBlcnR5UmVzb3VyY2UgPSBpc0h5cGVydHlVUkwobXNnLmJvZHkucmVzb3VyY2UpO1xyXG4gICAgICB9XHJcbiAgICAgIGxldCBpc0RlbGV0ZSA9IG1zZy50eXBlID09PSAnZGVsZXRlJztcclxuICAgICAgbGV0IGhhc05hbWU7XHJcbiAgICAgIGxldCBoYXNVc2VyO1xyXG5cclxuICAgICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCd2YWx1ZScpKSB7XHJcbiAgICAgICAgaGFzTmFtZSA9IG1zZy5ib2R5LnZhbHVlLmhhc093blByb3BlcnR5KCduYW1lJyk7XHJcbiAgICAgICAgaGFzVXNlciA9IG1zZy5ib2R5LnZhbHVlLmhhc093blByb3BlcnR5KCd1c2VyJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJykge1xyXG4gICAgICAgIGxvZy5lcnJvcignW1JlZ2lzdGVyIGxpc3RlbmVyXSBza2lwcGluZyAnLCBtc2cpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gbXNnIHNlbnQgYnkgaWRlbnRpdHkgbWFuYWdlciBsaWJyYXJ5XHJcbiAgICAgIGxldCB1c2VyVXJsID0gX3RoaXMuX2dldElkZW50aXR5QXNzb2NpYXRlZChtc2cuYm9keS5yZXNvdXJjZSwgbXNnLmJvZHkuY3JpdGVyaWEpO1xyXG5cclxuICAgICAgbGV0IHJlcGx5ID0ge2lkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIHRvOiBtc2cuZnJvbSwgZnJvbTogbXNnLnRvLCBib2R5OiB7cmVzb3VyY2U6IHVzZXJVcmx9fTtcclxuICAgICAgcmVwbHkuYm9keS5jb2RlID0gKHVzZXJVcmwpID8gMjAwIDogNDA0O1xyXG5cclxuICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHkpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEluc3RhbGwgQWRkcmVzc0FsbG9jYXRpb25cclxuICAgIGxldCBhZGRyZXNzQWxsb2NhdGlvbiA9IEFkZHJlc3NBbGxvY2F0aW9uLmluc3RhbmNlO1xyXG4gICAgX3RoaXMuYWRkcmVzc0FsbG9jYXRpb24gPSBhZGRyZXNzQWxsb2NhdGlvbjtcclxuXHJcbiAgICBfdGhpcy5fZG9tYWluUmVnaXN0cmF0aW9uID0gbmV3IERvbWFpblJlZ2lzdHJhdGlvbihfdGhpcy5ydW50aW1lVVJMLF90aGlzLnJlZ2lzdHJ5VVJMLCBfdGhpcy5fZG9tYWluLCBtZXNzYWdlQnVzKTtcclxuXHJcbiAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgLSBBZGRyZXNzQWxsb2NhdGlvbl0gLSAnLCBhZGRyZXNzQWxsb2NhdGlvbik7XHJcbiAgfVxyXG5cclxuXHJcbiAgX2dldElkZW50aXR5QXNzb2NpYXRlZCh0eXBlLCBoeXBlcnR5VVJMKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGZvciAobGV0IGh5cGVydHkgaW4gX3RoaXMuaHlwZXJ0aWVzTGlzdCkge1xyXG4gICAgICBsZXQgdmFsdWUgPSBfdGhpcy5oeXBlcnRpZXNMaXN0W2h5cGVydHldO1xyXG5cclxuICAgICAgaWYgKHZhbHVlLl9oeXBlcnR5VVJMID09PSBoeXBlcnR5VVJMKSB7XHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICBjYXNlICd1c2VybmFtZSc6XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5fdXNlci51c2VybmFtZTtcclxuICAgICAgICAgIGNhc2UgJ2NuJzpcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLl91c2VyLmNuO1xyXG4gICAgICAgICAgY2FzZSAnbG9jYWxlJzpcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLl91c2VyLmxvY2FsZTtcclxuICAgICAgICAgIGNhc2UgJ2F2YXRhcic6XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5fdXNlci5hdmF0YXI7XHJcbiAgICAgICAgICBjYXNlICd1c2VyVVJMJzpcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLl91c2VyLnVzZXJVUkw7XHJcbiAgICAgICAgICBjYXNlICcuJzpcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLl91c2VyO1xyXG4gICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmV0dXJuIHRoZSBzYW5kYm94IGluc3RhbmNlIHdoZXJlIHRoZSBBcHBsaWNhdGlvbiBpcyBleGVjdXRpbmcuIEl0IGlzIGFzc3VtZWQgdGhlcmUgaXMganVzdCBvbmUgQXBwIHBlciBSdW50aW1lIGluc3RhbmNlLlxyXG4gICovXHJcbiAgZ2V0QXBwU2FuZGJveCgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuYXBwU2FuZGJveDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVGhpcyBmdW5jdGlvbiByZXR1cm5zIHRoZSB1c2VyIGFzc29jaWF0ZWQgdG8gdGhlIGh5cGVydHkgVVJMXHJcbiAgKiBAcGFyYW0gICAge1N0cmluZ30gICAgaHlwZXJ0eVVSTCAgICAgIGh5cGVydHkgVVJMXHJcbiAgKiBAcmV0dXJuICAge1N0cmluZ30gICAgdXNlclVSTCAgICAgICAgIHVzZXIgVVJMXHJcbiAgKi9cclxuICBnZXRIeXBlcnR5T3duZXIoaHlwZXJ0eVVSTCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgdXNlclVSTDtcclxuXHJcbiAgICBmb3IgKGxldCBpbmRleCBpbiBfdGhpcy5oeXBlcnRpZXNMaXN0KSB7XHJcbiAgICAgIGxldCBoeXBlcnR5ID0gX3RoaXMuaHlwZXJ0aWVzTGlzdFtpbmRleF07XHJcblxyXG4gICAgICBpZiAoaHlwZXJ0eS5oeXBlcnR5VVJMID09PSBoeXBlcnR5VVJMKSB7XHJcbiAgICAgICAgcmV0dXJuIGh5cGVydHkudXNlci51c2VyVVJMO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdXNlclVSTDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVGhpcyBmdW5jdGlvbiByZXR1cm5zIHRoZSB1c2VyIGFzc29jaWF0ZWQgdG8gdGhlIGh5cGVydHkgVVJMXHJcbiAgKiBAcGFyYW0gICAge1N0cmluZ30gICAgZGF0YU9iamVjdFVSTCAgICAgIGRhdGFPYmplY3RVUkwgVVJMXHJcbiAgKiBAcmV0dXJuICAge1N0cmluZ30gICAgdXNlclVSTCAgICAgICAgIHVzZXIgVVJMXHJcbiAgKi9cclxuICBnZXREYXRhT2JqZWN0UmVwb3J0ZXIoZGF0YU9iamVjdFVSTCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgRE91cmwgPSByZW1vdmVQYXRoRnJvbVVSTChkYXRhT2JqZWN0VVJMKTtcclxuICAgIGZvciAobGV0IGluZGV4IGluIF90aGlzLmRhdGFPYmplY3RMaXN0KSB7XHJcbiAgICAgIGxldCBkYXRhT2JqZWN0ID0gX3RoaXMuZGF0YU9iamVjdExpc3RbaW5kZXhdO1xyXG5cclxuICAgICAgaWYgKGRhdGFPYmplY3QudXJsID09PSBET3VybCkge1xyXG4gICAgICAgIHJldHVybiBkYXRhT2JqZWN0LnJlcG9ydGVyO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogcmV0dXJucyB0aGUgaHlwZXJ0eSBOYW1lIGZyb20gYSBnaXZlbiB1cmwuIFRoaXMgdXJsIGNvdWxkIGJlIGZyb20gYSBkYXRhT2JqZWN0IG9yIGh5cGVydHlcclxuICAqIEBwYXJhbSAgICB7U3RyaW5nfSAgICB1cmwgICAgICBoeXBlcnR5IG9yIGRhdGFPYmplY3QgVVJMXHJcbiAgKiBAcmV0dXJuICAge1N0cmluZ30gICAgaHlwZXJ0eU5hbWUgICAgIGh5cGVydHkgTmFtZVxyXG4gICovXHJcbiAgZ2V0SHlwZXJ0eU5hbWUodXJsKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBpc0h5cGVydHlVUkwgPSBkaXZpZGVVUkwodXJsKS50eXBlID09PSAnaHlwZXJ0eSc7XHJcblxyXG4gICAgLy92YWx1ZSB0byBiZSByZXR1cm5lZCBpbiB0aGUgZW5kXHJcbiAgICBsZXQgaHlwZXJ0eU5hbWU7XHJcblxyXG4gICAgLy9pZiBpcyBub3QgYW4gaHlwZXJ0eSwgY2hlY2sgaWYgaXMgYSBkYXRhT2JqZWN0IGFuZCBvYnRhaW4gaGlzIHJlcG9ydGVyXHJcbiAgICBsZXQgaHlwZXJ0eVVSTCA9IGlzSHlwZXJ0eVVSTCA/IHVybCA6IF90aGlzLmdldFJlcG9ydGVyVVJMU3luY2hvbm91cyh1cmwpO1xyXG5cclxuICAgIGZvciAobGV0IGluZGV4IGluIF90aGlzLmh5cGVydGllc0xpc3QpIHtcclxuICAgICAgbGV0IGh5cGVydHkgPSBfdGhpcy5oeXBlcnRpZXNMaXN0W2luZGV4XTtcclxuICAgICAgaWYgKGh5cGVydHkuaHlwZXJ0eVVSTCA9PT0gaHlwZXJ0eVVSTCkge1xyXG4gICAgICAgIGh5cGVydHlOYW1lID0gaHlwZXJ0eS5vYmplY3ROYW1lO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaHlwZXJ0eU5hbWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJldHVybiB0aGUgcmVwb3J0ZXJVUkwgYXNzb2NpYXRlZCB3aXRoIHRoZSBkYXRhb2JqZWN0IFVSTFxyXG4gICogQHBhcmFtICAgIHtTdHJpbmd9ICAgICBkYXRhT2JqZWN0VVJMICAgIGRhdGFPYmplY3RVUkxcclxuICAqIEByZXR1cm4gICB7U3RyaW5nfSAgICAgcmVwb3J0ZXJVUkwgICAgICByZXBvcnRlclVSTFxyXG4gICovXHJcbiAgZ2V0UmVwb3J0ZXJVUkwoZGF0YU9iamVjdFVSTCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBsZXQgZGF0YU9iamVjdCA9IF90aGlzLmRhdGFPYmplY3RMaXN0W2RhdGFPYmplY3RVUkxdO1xyXG5cclxuICAgICAgaWYgKGRhdGFPYmplY3QpIHtcclxuICAgICAgICByZXNvbHZlKGRhdGFPYmplY3QucmVwb3J0ZXIpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlamVjdCgnTm8gcmVwb3J0ZXIgd2FzIGZvdW5kJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBmdW5jdGlvbiB0byByZXR1cm4gdGhlIHJlcG9ydGVyVVJMIGFzc29jaWF0ZWQgd2l0aCB0aGUgZGF0YW9iamVjdCBVUkwuIG5vIHByb21pc2UgcmV0dXJuZWRcclxuICAqIEBwYXJhbSAgICB7U3RyaW5nfSAgICAgZGF0YU9iamVjdFVSTCAgICBkYXRhT2JqZWN0VVJMXHJcbiAgKiBAcmV0dXJuICAge1N0cmluZ30gICAgIHJlcG9ydGVyVVJMICAgICAgcmVwb3J0ZXJVUkxcclxuICAqL1xyXG4gIGdldFJlcG9ydGVyVVJMU3luY2hvbm91cyhkYXRhT2JqZWN0VVJMKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBkYXRhT2JqZWN0ID0gX3RoaXMuZGF0YU9iamVjdExpc3RbZGF0YU9iamVjdFVSTF07XHJcblxyXG4gICAgcmV0dXJuIChkYXRhT2JqZWN0KSA/IGRhdGFPYmplY3QucmVwb3J0ZXIgOiB1bmRlZmluZWQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIHJldHVybnMgdGhlIGh5cGVydHkgVVJMIHRoYXQgc3Vic2NyaWJlZCB0aGUgZGF0YU9iamVjdFxyXG4gICogQHBhcmFtICAgIHtTdHJpbmd9ICAgICB1cmwgICAgICAgICAgICB1cmwgZm9ybWF0XHJcbiAgKiBAcmV0dXJuICAge1N0cmluZ30gICAgSHlwZXJ0eSBVUkwgc3Vic2NyaWJlZCB0byB0aGUgVVJMXHJcbiAgKi9cclxuICBnZXREYXRhT2JqZWN0U3Vic2NyaWJlckh5cGVydHkodXJsKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBfdGhpcy5zdWJzY3JpYmVkRGF0YU9iamVjdExpc3RbdXJsXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogcmVnaXN0ZXIgYSBkZXNpcmVkIGRhdGFPYmplY3QgdG8gc3Vic2NyaWJlXHJcbiAgKiBAcGFyYW0gICAge1N0cmluZ30gICAgZGF0YU9iamVjdFVSTCAgICAgIGRhdGFPYmplY3QgVVJMXHJcbiAgKi9cclxuICByZWdpc3RlclN1YnNjcmliZWREYXRhT2JqZWN0KGRhdGFPYmplY3RVUkwsIGh5cGVydHlVUkwpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBpZiAoX3RoaXMuc3Vic2NyaWJlZERhdGFPYmplY3RMaXN0W2RhdGFPYmplY3RVUkxdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgX3RoaXMuc3Vic2NyaWJlZERhdGFPYmplY3RMaXN0W2RhdGFPYmplY3RVUkxdID0gaHlwZXJ0eVVSTDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogRnVuY3Rpb24gdG8gcmV0dXJuIHRoZSBsaXN0IG9mIHByZSBhdXRob3Jpc2VkIHVzZXJzIHJlY2VpdmVkIGluIHRoZSBjcmVhdGlvbiBvZiBhIGRhdGEgb2JqZWN0XHJcbiAgKiBAcGFyYW0gICAge1N0cmluZ30gICAgICAgICAgICBkYXRhT2JqZWN0VVJMICAgIGRhdGFPYmplY3RVUkxcclxuICAqIEByZXR1cm4gICB7QXJyYXk8U3RyaW5nPn0gICAgIHByZUF1dGggICAgICAgICBMaXN0IG9mIHByZSBhdXRob3Jpc2VkIHVzZXJzXHJcbiAgKi9cclxuICBnZXRQcmVBdXRoU3Vic2NyaWJlcnMoZGF0YU9iamVjdFVSTCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBkYXRhT2JqZWN0ID0gX3RoaXMuZGF0YU9iamVjdExpc3RbZGF0YU9iamVjdFVSTF07XHJcbiAgICBsZXQgcHJlQXV0aCA9IFtdO1xyXG5cclxuICAgIGlmIChkYXRhT2JqZWN0KSB7XHJcbiAgICAgIHByZUF1dGggPSBkYXRhT2JqZWN0LmF1dGhvcmlzZTtcclxuICAgIH1cclxuICAgIHJldHVybiBwcmVBdXRoO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBzZW5kIHJlcXVlc3RzIHRvIHVucmVnaXN0ZXIgYWxsIGh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeVxyXG4gICogQHJldHVybiAgIHtQcm9taXNlfSAgICAgcmV0dXJuIGEgcHJvbWlzZSBpZiB0aGUgcmVzdWx0IG9mIHVucmVnaXN0cmF0aW9uIGFsbCBoeXBlcnRpZXNcclxuICAqL1xyXG4gIHVucmVnaXN0ZXJBbGxIeXBlcnRpZXMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCB1bnJlZ2lzdGVyUmVzdWx0cyA9IFtdO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGZvciAobGV0IGluZGV4IGluIF90aGlzLmh5cGVydGllc0xpc3QpIHtcclxuICAgICAgICBsZXQgaHlwZXJ0eSA9IF90aGlzLmh5cGVydGllc0xpc3RbaW5kZXhdO1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBfdGhpcy51bnJlZ2lzdGVySHlwZXJ0eUluc3RhbmNlKGh5cGVydHkuaHlwZXJ0eVVSTCk7XHJcbiAgICAgICAgdW5yZWdpc3RlclJlc3VsdHMucHVzaChyZXN1bHQpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBQcm9taXNlLmFsbCh1bnJlZ2lzdGVyUmVzdWx0cykudGhlbigoKSA9PiB7XHJcblxyXG4gICAgICAgIHJlc29sdmUoJ3N1Y2Nlc3NmdWxseSB1bnJlZ2lzdGVyZWQgYWxsIGh5cGVydGllcycpO1xyXG4gICAgICB9LCBlcnJvciA9PiB7IHJlamVjdChlcnJvcik7IH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqICBmdW5jdGlvbiB0byB1bnJlZ2lzdGVyIGFuIGh5cGVydHlJbnN0YW5jZSBpbiB0aGUgRG9tYWluIFJlZ2lzdHJ5XHJcbiAgKiAgQHBhcmFtICAge1N0cmluZ30gICAgICBoeXBlcnR5SW5zdGFuY2UgICBIeXBlcnR5SW5zbnRhbmNlIHVybFxyXG4gICpcclxuICAqL1xyXG4gIHVucmVnaXN0ZXJIeXBlcnR5SW5zdGFuY2UoaHlwZXJ0eUluc3RhbmNlKSB7XHJcbiAgICAvL1RPRE8gd29ya2luZyBidXQgdGhlIHVzZXJcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IGNsb3NlTXNnID0geyB0eXBlOiAnZXhlY3V0ZScsIGZyb206IF90aGlzLnJlZ2lzdHJ5VVJMLFxyXG4gICAgICB0bzogaHlwZXJ0eUluc3RhbmNlLFxyXG4gICAgICBib2R5OiB7IG1ldGhvZDogJ2Nsb3NlJyB9fTtcclxuXHJcbiAgICAvLyBTZW5kIG1lc3NhZ2UgdG8gaHlwZXJ0eSB0byBjbG9zZVxyXG4gICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UoY2xvc2VNc2csIChyZXBseSkgPT4ge1xyXG4gICAgICBsb2cubG9nKCdbUmVnaXN0cnkudW5yZWdpc3Rlckh5cGVydHlJbnN0YW5jZV0gQ2xvc2UgUmVwbHknLCByZXBseSk7XHJcblxyXG4gICAgICBfdGhpcy5fZG9tYWluUmVnaXN0cmF0aW9uLnVucmVnaXN0ZXJIeXBlcnR5KGh5cGVydHlJbnN0YW5jZSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqICBmdW5jdGlvbiB0byB1bnJlZ2lzdGVyIGEgRGF0YSBPYmplY3QgaW4gdGhlIERvbWFpbiBSZWdpc3RyeVxyXG4gICogIEBwYXJhbSAgIHtTdHJpbmd9ICAgICAgaHlwZXJ0eUluc3RhbmNlICAgSHlwZXJ0eUluc250YW5jZSB1cmxcclxuICAqXHJcbiAgKi9cclxuICB1bnJlZ2lzdGVyRGF0YU9iamVjdCh1cmwpIHtcclxuICAgIHRoaXMuX2RvbWFpblJlZ2lzdHJhdGlvbi51bnJlZ2lzdGVyRGF0YU9iamVjdCh1cmwpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICogcmVnaXN0ZXIgYSBuZXcgc3Vic2NyaWJlciBpbiB0aGUgZGF0YU9iamVjdCByZWdpc3RlcmVkXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgZGF0YU9iamVjdFVSTCAgICBkYXRhT2JqZWN0IFVSTFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgIHN1YnNjcmliZXJVUkwgICAgc3Vic2NyaWJlciBVUkxcclxuICAqL1xyXG4gIHJlZ2lzdGVyU3Vic2NyaWJlcihkYXRhT2JqZWN0VVJMLCBzdWJzY3JpYmVyVVJMKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGRhdGFPYmplY3QgPSBfdGhpcy5kYXRhT2JqZWN0TGlzdFtkYXRhT2JqZWN0VVJMXTtcclxuXHJcbiAgICBpZiAoZGF0YU9iamVjdCkge1xyXG5cclxuICAgICAgaWYgKCFkYXRhT2JqZWN0LnN1YnNjcmliZXJzKSBkYXRhT2JqZWN0LnN1YnNjcmliZXJzID0gW107XHJcblxyXG4gICAgICBkYXRhT2JqZWN0LnN1YnNjcmliZXJzLnB1c2goc3Vic2NyaWJlclVSTCk7XHJcbiAgICAgIF90aGlzLmRhdGFPYmplY3RMaXN0W2RhdGFPYmplY3RVUkxdID0gZGF0YU9iamVjdDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZ2V0IHRoZSBzdWJzY3JpYmVycyByZWdpc3RlcmVkIHdpdGhpbiBhIGRhdGFPYmplY3RcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgZGF0YU9iamVjdFVSTCAgICBkYXRhT2JqZWN0IFVSTFxyXG4gICogQHBhcmFtICB7QXJyYXk8U3RyaW5nPn0gICBTdWJzdHJpYmVycyBMaXN0XHJcbiAgKi9cclxuICBnZXREYXRhT2JqZWN0U3Vic2NyaWJlcnMoZGF0YU9iamVjdFVSTCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBkYXRhT2JqZWN0ID0gX3RoaXMuZGF0YU9iamVjdExpc3RbZGF0YU9iamVjdFVSTF07XHJcblxyXG4gICAgaWYgKGRhdGFPYmplY3QpIHtcclxuICAgICAgcmV0dXJuIGRhdGFPYmplY3Quc3Vic2NyaWJlcnM7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aHJvdyAnTm8gZGF0YU9iamVjdCB3YXMgZm91bmQnO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVG8gcmVnaXN0ZXIgYSBuZXcgRGF0YSBPYmplY3QgaW4gdGhlIHJ1bnRpbWUgd2hpY2ggcmV0dXJucyB0aGUgZGF0YU9iamVjdFVSTCBhbGxvY2F0ZWQgdG8gdGhlIG5ldyBEYXRhIE9iamVjdC5cclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICBpZGVudGlmaWVyICAgICAgICAgICAgICAgICAgaWRlbnRpZmllclxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgIGRhdGFPYmplY3RzY2hlbWEgICAgICAgICAgICBkYXRhT2JqZWN0c2NoZW1hXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgZGF0YU9iamVjdFVybCAgICAgICAgICAgICAgIGRhdGFPYmplY3RVcmxcclxuICAqIEBwYXJhbSB7U3RyaW5nfSAgICAgIGRhdGFPYmplY3RSZXBvcnRlciAgICAgICAgICAgZGF0YU9iamVjdFJlcG9ydGVyXHJcbiAgKiBAcGFyYW0gIHtBcnJheX0gICAgIHJlc291cmNlcyAgICAgICAgICAgICAgICAgICAgIGRhdGFPYmplY3QgcmVzb3VyY2VzXHJcbiAgKiBAcGFyYW0gIHtBcnJheX0gICAgIGF1dGhvcmlzZSAgICAgICAgICAgICAgICAgICAgIGxpc3Qgb2YgcHJlIGF1dGhvcmlzZWQgYXV0aG9yaXNlZCBJRHNcclxuICAqL1xyXG4gIC8vcmVnaXN0ZXJEYXRhT2JqZWN0KGlkZW50aWZpZXIsIGRhdGFPYmplY3RzY2hlbWEsIGRhdGFPYmplY3RVcmwsIGRhdGFPYmplY3RSZXBvcnRlciwgcmVzb3VyY2VzLCBhZGRyZXNzVVJMLCBhdXRob3Jpc2UpIHtcclxuICByZWdpc3RlckRhdGFPYmplY3Qob2JqZWN0UmVnaXN0cmF0aW9uKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCByZWdpc3RyYXRpb24gPSBkZWVwQ2xvbmUob2JqZWN0UmVnaXN0cmF0aW9uKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG5cclxuICAgICAgX3RoaXMuZGF0YU9iamVjdExpc3Rbb2JqZWN0UmVnaXN0cmF0aW9uLnVybF0gPSBvYmplY3RSZWdpc3RyYXRpb247XHJcblxyXG4vLyAgICAgIF90aGlzLnN0b3JhZ2VNYW5hZ2VyLmdldCgncmVnaXN0cnk6RGF0YU9iamVjdFVSTHMnKS50aGVuKCh1cmxzTGlzdCkgPT4ge1xyXG5cclxuLyogICAgICAgIGlmICghdXJsc0xpc3QpIHtcclxuICAgICAgICAgIHVybHNMaXN0ID0ge307XHJcbiAgICAgICAgfSovXHJcblxyXG4gICAgICAgIC8vdXBkYXRlIHRoZSBsaXN0IHdpdGggdGhlIG5ldyBlbGVtZW50c1xyXG4gICAgICAgIF90aGlzLl9kYXRhT2JqZWN0VXJsc1tvYmplY3RSZWdpc3RyYXRpb24ubmFtZSArIG9iamVjdFJlZ2lzdHJhdGlvbi5zY2hlbWEgKyBvYmplY3RSZWdpc3RyYXRpb24ucmVzb3VyY2VzICsgb2JqZWN0UmVnaXN0cmF0aW9uLnJlcG9ydGVyXSA9IG9iamVjdFJlZ2lzdHJhdGlvbi51cmw7XHJcblxyXG4gICAgICAgIC8vIHN0ZXAgdG8gb2J0YWluIHRoZSBsaXN0IG9mIGFsbCBVUkwgcmVnaXN0ZXJlZCB0byB1cGRhdGVkIHdpdGggdGhlIG5ldyBvbmUuXHJcbiAgICAgICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIuc2V0KCdyZWdpc3RyeTpEYXRhT2JqZWN0VVJMcycsIDAsIF90aGlzLl9kYXRhT2JqZWN0VXJscykudGhlbigoKSA9PiB7XHJcblxyXG4gICAgICAgICAgaWYgKF90aGlzLmlzSW50ZXJ3b3JraW5nUHJvdG9TdHViKHJlZ2lzdHJhdGlvbi5yZXBvcnRlcikpIHtcclxuICAgICAgICAgICAgcmVnaXN0cmF0aW9uLmludGVyd29ya2luZyA9IHRydWU7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgbGV0IGRvbWFpblJlZ2lzdHJhdGlvbiA9IHRydWU7XHJcblxyXG4gICAgICAgICAgaWYgKHJlZ2lzdHJhdGlvbi5oYXNPd25Qcm9wZXJ0eShcImRvbWFpbl9yZWdpc3RyYXRpb25cIikpXHJcbiAgICAgICAgICBkb21haW5SZWdpc3RyYXRpb24gPSByZWdpc3RyYXRpb24uZG9tYWluX3JlZ2lzdHJhdGlvbjtcclxuXHJcbiAgICAgICAgICBpZiAoZG9tYWluUmVnaXN0cmF0aW9uKVxyXG4gICAgICAgICAgICBfdGhpcy5fZG9tYWluUmVnaXN0cmF0aW9uLnJlZ2lzdGVyRGF0YU9iamVjdChyZWdpc3RyYXRpb24sb2JqZWN0UmVnaXN0cmF0aW9uLnJlc3VtZSwgX3RoaXMucDJwSGFuZGxlclN0dWIpLnRoZW4oKCByZWdpc3RlcmVkICkgPT57IHJlc29sdmUocmVnaXN0ZXJlZCkgfSk7XHJcbiAgICAgICAgICBlbHNlIHJlc29sdmUocmVnaXN0cmF0aW9uKTtcclxuXHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgICAgICBsb2cuZXJyb3IoJ1tSZWdpc3RyeSByZWdpc3RlckRhdGFPYmplY3RdIEVycm9yOiAnLCByZWFzb24pO1xyXG4gICAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4vLyAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBfZ2V0UmVzb3VyY2VzQW5kU2NoZW1lcyhkZXNjcmlwdG9yKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSk9PiB7XHJcblxyXG4gICAgICBsZXQgcmVzb3VyY2VzO1xyXG5cclxuICAgICAgLy8gY2hlY2sgaWYgdGhlIGh5cGVydHkgcmVzb3VyY2VzIGlzIGEgdmVjdG9yIG9yIGEgc3RyaW5nXHJcbiAgICAgIC8vIFRPRE8gZGVsZXRlIGxhdGVyIHdoZW4gY2F0YWxvZ3VlIGlzIGZpeGVkXHJcbiAgICAgIGlmICh0eXBlb2YgKGRlc2NyaXB0b3IuaHlwZXJ0eVR5cGUpID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJlc291cmNlcyA9IFtdO1xyXG4gICAgICAgIHJlc291cmNlcy5wdXNoKGRlc2NyaXB0b3IuaHlwZXJ0eVR5cGUpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlc291cmNlcyA9IGRlc2NyaXB0b3IuaHlwZXJ0eVR5cGU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBvYmpOYW1lID0gZGVzY3JpcHRvci5vYmplY3ROYW1lO1xyXG5cclxuICAgICAgbGV0IGRlc2NyaXB0b3JEYXRhU2NoZW1hID0gZGVzY3JpcHRvci5kYXRhT2JqZWN0cztcclxuICAgICAgbGV0IGRhdGFTY2hlbWFzQXJyYXkgPSBbXTtcclxuXHJcbiAgICAgIC8vdGhpcyB3aWxsIGNyZWF0ZSBhIGFycmF5IHdpdGggYSBQcm9taXNlIGluIGVhY2ggcG9zaXRpb25cclxuICAgICAgZm9yIChsZXQgaW5kZXggaW4gZGVzY3JpcHRvckRhdGFTY2hlbWEpIHtcclxuICAgICAgICBkYXRhU2NoZW1hc0FycmF5LnB1c2goX3RoaXMucnVudGltZUNhdGFsb2d1ZS5nZXREYXRhU2NoZW1hRGVzY3JpcHRvcihkZXNjcmlwdG9yRGF0YVNjaGVtYVtpbmRleF0pKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gYXMgc29vbiBhcyB0aGUgcHJldmlvdXMgYXJyYXkgaXMgY29tcGxldGVkLCB0aGlzIHdpbGwgd2FpdCBmb3IgdGhlIHJlc29sdmUgb2YgYWxsIHByb21pc2VzIGluIHRoZSBhcnJheVxyXG4gICAgICBQcm9taXNlLmFsbChkYXRhU2NoZW1hc0FycmF5KS50aGVuKGZ1bmN0aW9uKGRhdGFTY2hlbWFzKSB7XHJcblxyXG4gICAgICAgIGxldCBmaWx0ZXJlZERhdGFTY2hlbWFzID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaW5kZXggaW4gZGF0YVNjaGVtYXMpIHtcclxuICAgICAgICAgIGxldCBkYXRhU2NoZW1hID0gZGF0YVNjaGVtYXNbaW5kZXhdO1xyXG4gICAgICAgICAgZmlsdGVyZWREYXRhU2NoZW1hcy5wdXNoKGRhdGFTY2hlbWEuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlLnByb3BlcnRpZXMuc2NoZW1lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeV0gSHlwZXJ0eSBTY2hlbWFzJywgZmlsdGVyZWREYXRhU2NoZW1hcyk7XHJcbiAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5XSBIeXBlcnR5IHJlc291cmNlcycsIHJlc291cmNlcyk7XHJcblxyXG4gICAgICAgIHJlc29sdmUoe3Jlc291cmNlczogcmVzb3VyY2VzLCBkYXRhU2NoZW1hOiBmaWx0ZXJlZERhdGFTY2hlbWFzLCBuYW1lOiBvYmpOYW1lfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIG1ldGhvZCB0aGF0IHJldHVybnMgcHJldmlvdXNseSByZWdpc3RlcmVkIEh5cGVydHkgb3IgRGF0YU9iamVjdHMgVVJMUywgZm9yIGdpdmVuIGNoYXJhY3RlcmlzdGljc1xyXG4gICogQHBhcmFtICB7SlNPTn0gICAgICAgIGluZm8gICAgICAgICAgIG9iamVjdCBvciBoeXBlcnR5IGNoYXJhdGVyaXN0aWNzIGluZm9cclxuICAqIEByZXR1cm4ge2FkZHJlc3NVUkx9ICBhZGRyZXNzVVJMICAgICByZXR1cm4gdGhlIFVSTCBpZiB0aGVyZSBpcyBhbnkgcHJldmlvdXN5IHJlZ2lzdGVyZWQgVVJMLCByZXR1cm4gdW5kZWZpbmVkIG90aGVyd2lzZVxyXG4gICovXHJcbiAgY2hlY2tSZWdpc3RlcmVkVVJMcyhpbmZvLCByZXVzZVVSTCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHJcbiAgICAgIGxldCBvYmplY3RUeXBlID0gKGluZm8ucmVwb3J0ZXIpID8gJ3JlZ2lzdHJ5OkRhdGFPYmplY3RVUkxzJyA6ICdyZWdpc3RyeTpIeXBlcnR5VVJMcyc7XHJcblxyXG4gICAgICBpZiAodHlwZW9mKHJldXNlVVJMKSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBvYmplY3RUeXBlID0gcmV1c2VVUkwgJiYgZGl2aWRlVVJMKHJldXNlVVJMKS50eXBlICE9PSAnaHlwZXJ0eScgPyAncmVnaXN0cnk6RGF0YU9iamVjdFVSTHMnIDogJ3JlZ2lzdHJ5Okh5cGVydHlVUkxzJztcclxuICAgICAgfVxyXG4gICAgICAvL2RlYnVnZ2VyO1xyXG4gICAgICBfdGhpcy5zdG9yYWdlTWFuYWdlci5nZXQob2JqZWN0VHlwZSkudGhlbigodXJsc0xpc3QpID0+IHtcclxuXHJcbiAgICAgICAgaWYgKCF1cmxzTGlzdCkge1xyXG4gICAgICAgICAgdXJsc0xpc3QgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YocmV1c2VVUkwpID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1tSZWdpc3RyeSAtIGNoZWNrUmVnaXN0ZXJlZFVSTHNdIC0gbG9vayBmb3IgJyArIHJldXNlVVJMICsgJyBvbiAnLCB1cmxzTGlzdCk7XHJcblxyXG4gICAgICAgICAgbGV0IHNlYXJjaFJlc3VsdCA9IE9iamVjdC5rZXlzKHVybHNMaXN0KS5tYXAoKGtleSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgaW5kZXhPZiA9IHVybHNMaXN0W2tleV0uaW5kZXhPZihyZXVzZVVSTCk7XHJcbiAgICAgICAgICAgIHJldHVybiB1cmxzTGlzdFtrZXldW2luZGV4T2ZdO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgbG9nLmluZm8oJ1tSZWdpc3RyeSAtIGNoZWNrUmVnaXN0ZXJlZFVSTHNdIC0gZm91bmQgJyArIHNlYXJjaFJlc3VsdC5sZW5ndGggKyAnIHJlc3VsdHMgb24gJywgc2VhcmNoUmVzdWx0KTtcclxuICAgICAgICAgIGlmIChzZWFyY2hSZXN1bHQubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHNlYXJjaFJlc3VsdCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG9iamVjdFR5cGUgPT09ICdyZWdpc3RyeTpIeXBlcnR5VVJMcycpIHtcclxuICAgICAgICAgIF90aGlzLl9nZXRSZXNvdXJjZXNBbmRTY2hlbWVzKGluZm8pLnRoZW4oKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh1cmxzTGlzdFt2YWx1ZS5yZXNvdXJjZXMgKyB2YWx1ZS5kYXRhU2NoZW1hICsgdmFsdWUubmFtZV0pIHtcclxuICAgICAgICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnldIHJldXNhZ2Ugb2YgaHlwZXJ0eSBVUkwnKTtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh1cmxzTGlzdFt2YWx1ZS5yZXNvdXJjZXMgKyB2YWx1ZS5kYXRhU2NoZW1hICsgdmFsdWUubmFtZV0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeV0gbm8gaHlwZXJ0eSBVUkwgd2FzIHByZXZpb3VzbHkgcmVnaXN0ZXJlZCAnKTtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgIGxldCBjaGFyYWN0ZXJpc3RpY3MgPSBpbmZvLm5hbWUgKyBpbmZvLnNjaGVtYSArIGluZm8ucmVzb3VyY2VzICsgaW5mby5yZXBvcnRlcjtcclxuXHJcbiAgICAgICAgICBpZiAodXJsc0xpc3RbY2hhcmFjdGVyaXN0aWNzXSkge1xyXG4gICAgICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnldIHJldXNhZ2Ugb2YgZGF0YU9iamVjdCBVUkwnKTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZih1cmxzTGlzdFtjaGFyYWN0ZXJpc3RpY3NdKSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICBsZXQgYXJyYXlUb1Jlc29sdmUgPSBbXTtcclxuICAgICAgICAgICAgICBhcnJheVRvUmVzb2x2ZS5wdXNoKHVybHNMaXN0W2NoYXJhY3RlcmlzdGljc10pO1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGFycmF5VG9SZXNvbHZlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh1cmxzTGlzdFtjaGFyYWN0ZXJpc3RpY3NdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5XSBubyBkYXRhT2JqZWN0IFVSTCB3YXMgcHJldmlvdXNseSByZWdpc3RlcmVkJyk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgKiBUbyByZWdpc3RlciBhIG5ldyBIeXBlcnR5IGluIHRoZSBydW50aW1lIHdoaWNoIHJldHVybnMgdGhlIEh5cGVydHlVUkwgYWxsb2NhdGVkIHRvIHRoZSBuZXcgSHlwZXJ0eS5cclxuICAqIEBwYXJhbSAge1NhbmRib3h9ICAgICAgICAgICAgIHNhbmRib3ggICAgICAgICAgICAgICBzYW5kYm94XHJcbiAgKiBAcGFyYW0gIHtIeXBlcnR5Q2F0YWxvZ3VlVVJMfSBIeXBlcnR5Q2F0YWxvZ3VlVVJMICAgZGVzY3JpcHRvclxyXG4gICogQHBhcmFtIHtvYmplY3R9IElkcENvbnN0cmFpbnQgLSBjb25zdHJhaW50cyB0byBiZSB1c2VkIHdoZW4gc2VsZWN0aW5nIHRoZSBpZGVudGl0eSB0byBiZSBhc3NvY2lhdGVkIHdpdGggdGhlIEh5cGVydHkgaW5jbHVkaW5nIG9yaWdpbiwgaWRwLCBhbmQgaWRIaW50LlxyXG4gICogQHJldHVybiB7SHlwZXJ0eVVSTH0gICAgICAgICAgSHlwZXJ0eVVSTFxyXG4gICovXHJcbiAgcmVnaXN0ZXJIeXBlcnR5KHNhbmRib3gsIGltcG9ydFBhdGgsIGRlc2NyaXB0b3IsIGFkZHJlc3NVUkwsIElkcENvbnN0cmFpbnQpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IGh5cGVydHlDYXBhYmlsaXRpZXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuXHJcbiAgICAgIF90aGlzLmlkTW9kdWxlLmdldElkZW50aXR5QXNzZXJ0aW9uKElkcENvbnN0cmFpbnQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XHJcblxyXG4gICAgICAgIGxldCB1c2VyUHJvZmlsZSA9IHJlc3VsdC51c2VyUHJvZmlsZTtcclxuXHJcbiAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IHJlZ2lzdGVySHlwZXJ0eV0gdXNlclByb2ZpbGUnLCB1c2VyUHJvZmlsZSk7XHJcblxyXG4gICAgICAgIGlmIChfdGhpcy5fbWVzc2FnZUJ1cyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICByZWplY3QoJ1tSZWdpc3RyeSByZWdpc3Rlckh5cGVydHldIE1lc3NhZ2VCdXMgaXMgdW5kZWZpbmVkJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vY2FsbCBjaGVjayBpZiB0aGUgcHJvdG9zdHViIGV4aXN0OiB0byBiZSByZW1vdmVkXHJcbiAgICAgICAgICAvKiAgX3RoaXMucmVzb2x2ZShkb21haW5VcmwpLnRoZW4oZnVuY3Rpb24oYSkge1xyXG4gICAgICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgcmVnaXN0ZXJIeXBlcnR5XSBzdHViIHRvIGRvbWFpbiByZWdpc3RyeS0gJywgYSk7Ki9cclxuXHJcbi8vICAgICAgICAgIF90aGlzLnN0b3JhZ2VNYW5hZ2VyLmdldCgncmVnaXN0cnk6SHlwZXJ0eVVSTHMnKS50aGVuKCh1cmxzTGlzdCkgPT4ge1xyXG5cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSByZWdpc3Rlckh5cGVydHldIHN0b3JhZ2VNYW5hZ2VyXSAtICcsIHVybHNMaXN0KTtcclxuXHJcbiAgICAgICAgICAgIF90aGlzLl9nZXRSZXNvdXJjZXNBbmRTY2hlbWVzKGRlc2NyaXB0b3IpLnRoZW4oKHZhbHVlKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgIGh5cGVydHlDYXBhYmlsaXRpZXMgPSB2YWx1ZTtcclxuXHJcbi8qICAgICAgICAgICAgICBpZiAoIXVybHNMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICB1cmxzTGlzdCA9IHt9O1xyXG4gICAgICAgICAgICAgIH0qL1xyXG5cclxuICAgICAgICAgICAgICBfdGhpcy5faHlwZXJ0eVVybHNbaHlwZXJ0eUNhcGFiaWxpdGllcy5yZXNvdXJjZXMgKyBoeXBlcnR5Q2FwYWJpbGl0aWVzLmRhdGFTY2hlbWEgKyBoeXBlcnR5Q2FwYWJpbGl0aWVzLm5hbWVdID0gYWRkcmVzc1VSTC5hZGRyZXNzO1xyXG4gICAgICAgICAgICAgIF90aGlzLnN0b3JhZ2VNYW5hZ2VyLnNldCgncmVnaXN0cnk6SHlwZXJ0eVVSTHMnLCAwLCBfdGhpcy5faHlwZXJ0eVVybHMpLnRoZW4oKCkgPT4ge1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvL2NoZWNrIHdoZXRoZXIgdGhlIHJlY2VpdmVkIHNhbmJveCBlIEFwcGxpY2F0aW9uU2FuZGJveCBvciBhIG5vcm1hbCBzYW5kYm94XHJcbiAgICAgICAgICAgICAgICBpZiAoc2FuZGJveC50eXBlID09PSAnYXBwJykge1xyXG4gICAgICAgICAgICAgICAgICBfdGhpcy5zYW5kYm94ZXNMaXN0LmFwcFNhbmRib3hbYWRkcmVzc1VSTC5hZGRyZXNzWzBdXSA9IHNhbmRib3g7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNhbmRib3gudHlwZSA9PT0gJ25vcm1hbCcpIHtcclxuICAgICAgICAgICAgICAgICAgX3RoaXMuc2FuZGJveGVzTGlzdC5zYW5kYm94W2FkZHJlc3NVUkwuYWRkcmVzc1swXV0gPSBzYW5kYm94O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgcmVqZWN0KCdXcm9uZyBTYW5kYm94VHlwZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGxldCBwMnBIYW5kbGVyO1xyXG4gICAgICAgICAgICAgICAgbGV0IHAycFJlcXVlc3RlcjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoX3RoaXMucDJwSGFuZGxlclN0dWIpLmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICBwMnBIYW5kbGVyID0gX3RoaXMucDJwSGFuZGxlclN0dWJbX3RoaXMucnVudGltZVVSTF0udXJsO1xyXG4gICAgICAgICAgICAgICAgICBwMnBSZXF1ZXN0ZXIgPSBydW50aW1lVXRpbHMucnVudGltZURlc2NyaXB0b3IucDJwUmVxdWVzdGVyU3R1YjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgaHlwZXJ0eSA9IG5ldyBIeXBlcnR5SW5zdGFuY2UoX3RoaXMuaWRlbnRpZmllciwgX3RoaXMucmVnaXN0cnlVUkwsIGltcG9ydFBhdGgsIGRlc2NyaXB0b3IsXHJcbiAgICAgICAgICAgICAgICAgIGFkZHJlc3NVUkwuYWRkcmVzc1swXSwgdXNlclByb2ZpbGUsICdndWlkJywgX3RoaXMucnVudGltZVVSTCwgJ2N0eCcsIHAycEhhbmRsZXIsXHJcbiAgICAgICAgICAgICAgICAgcDJwUmVxdWVzdGVyLCBoeXBlcnR5Q2FwYWJpbGl0aWVzLmRhdGFTY2hlbWEsIGh5cGVydHlDYXBhYmlsaXRpZXMucmVzb3VyY2VzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5oeXBlcnRpZXNMaXN0LnB1c2goaHlwZXJ0eSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLyotLS0gc3RhcnQgaGVyZSBtb3ZlIHAycCBhbmQgZG9tYWluIHJlZ2lzdHJ5IHJlbGF0ZWQgZmVhdHVyZXMgdG8gYSBzZXBhcmF0ZWQgZnVuY3Rpb24uLS0tLS0tLS4uKi9cclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgcmVnaXN0cmF0aW9uQXRkb21haW4gPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICggZGVzY3JpcHRvci5oYXNPd25Qcm9wZXJ0eShcIl9jb25maWd1cmF0aW9uXCIpICYmIGRlc2NyaXB0b3IuY29uZmlndXJhdGlvbi5oYXNPd25Qcm9wZXJ0eShcImRvbWFpbl9yZWdpc3RyYXRpb25cIikpIHtcclxuICAgICAgICAgICAgICAgICAgcmVnaXN0cmF0aW9uQXRkb21haW4gPSBkZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb24uZG9tYWluX3JlZ2lzdHJhdGlvbjtcclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgaWYgKHJlZ2lzdHJhdGlvbkF0ZG9tYWluKSBfdGhpcy5fZG9tYWluUmVnaXN0cmF0aW9uLnJlZ2lzdGVySHlwZXJ0eShoeXBlcnR5LCBhZGRyZXNzVVJMLm5ld0FkZHJlc3MpLnRoZW4oKHJlZ2lzdGVyZWQpPT4ge3Jlc29sdmUocmVnaXN0ZXJlZCl9KTtcclxuICAgICAgICAgICAgICAgICAgZWxzZSByZXNvbHZlKHsgdXJsOiBoeXBlcnR5Lmh5cGVydHlVUkx9KTtcclxuXHJcbiAgICAgICAgICAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0gRU5EIEhFUkUgTU9WRSBET01BSU4gUkVHSVNUUlkgLS0tLS0tLS0tLS0tLS0tLS0tKi9cclxuICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSByZWdpc3Rlckh5cGVydHldIEVycm9yOiAnLCByZWFzb24pO1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4vLyAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIHJlamVjdCgnW1JlZ2lzdHJ5IHJlZ2lzdGVySHlwZXJ0eV0gJywgZXJyKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuXHJcbiAgLyoqXHJcbiAgKiBUbyB1bnJlZ2lzdGVyIGEgcHJldmlvdXNseSByZWdpc3RlcmVkIEh5cGVydHlcclxuICAqIEBwYXJhbSAge0h5cGVydHlVUkx9ICAgICAgICAgIEh5cGVydHlVUkwgdXJsICAgICAgICB1cmxcclxuICAqL1xyXG4gIHVucmVnaXN0ZXJIeXBlcnR5KHVybCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBsZXQgZm91bmQgPSBmYWxzZTtcclxuICAgICAgbGV0IGluZGV4ID0gMDtcclxuXHJcbiAgICAgIGZvclx0KGluZGV4ID0gMDsgaW5kZXggPCBfdGhpcy5oeXBlcnRpZXNMaXN0Lmxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgIGxldCBoeXBlcnR5ID0gX3RoaXMuaHlwZXJ0aWVzTGlzdFtpbmRleF07XHJcbiAgICAgICAgaWYgKGh5cGVydHkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgaWYgKGh5cGVydHkuaHlwZXJ0eVVSTCA9PT0gdXJsKSB7XHJcbiAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoZm91bmQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgcmVqZWN0KCdIeXBlcnR5IG5vdCBmb3VuZCcpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRlbGV0ZSBfdGhpcy5oeXBlcnRpZXNMaXN0W2luZGV4XTtcclxuICAgICAgICByZXNvbHZlKCdIeXBlcnR5IHN1Y2Nlc3NmdWxseSBkZWxldGVkJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVG8gZGlzY292ZXIgcHJvdG9jb2wgc3R1YnMgYXZhaWxhYmxlIGluIHRoZSBydW50aW1lIGZvciBhIGNlcnRhaW4gZG9tYWluLiBJZiBhdmFpbGFibGUsIGl0IHJldHVybnMgdGhlIHJ1bnRpbWUgdXJsIGZvciB0aGUgcHJvdG9jb2wgc3R1YiB0aGF0IGNvbm5lY3RzIHRvIHRoZSByZXF1ZXN0ZWQgZG9tYWluLiBSZXF1aXJlZCBieSB0aGUgcnVudGltZSBCVVMgdG8gcm91dGUgbWVzc2FnZXMgdG8gcmVtb3RlIHNlcnZlcnMgb3IgcGVlcnMgKGRvIHdlIG5lZWQgc29tZXRoaW5nIHNpbWlsYXIgZm9yIEh5cGVydGllcz8pLlxyXG4gICogQHBhcmFtICB7RG9tYWluVVJMfSAgICAgICAgICAgRG9tYWluVVJMICAgICAgICAgICAgdXJsXHJcbiAgKiBAcmV0dXJuIHtSdW50aW1lVVJMfSAgICAgICAgICAgUnVudGltZVVSTFxyXG4gICovXHJcbiAgZGlzY292ZXJQcm90b3N0dWIodXJsKSB7XHJcbiAgICBpZiAoIXVybCkgdGhyb3cgbmV3IEVycm9yKCdQYXJhbWV0ZXIgdXJsIG5lZWRlZCcpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTCh1cmwpO1xyXG4gICAgbGV0IGRvbWFpblVSTCA9IGRpdmlkZWRVUkwuZG9tYWluO1xyXG5cclxuICAgIGlmIChfdGhpcy5wcm90b3N0dWJzTGlzdC5oYXNPd25Qcm9wZXJ0eShkb21haW5VUkwpICYmIF90aGlzLnByb3Rvc3R1YnNMaXN0W2RvbWFpblVSTF0uc3RhdHVzID09PSBTVEFUVVMuTElWRSkge1xyXG4gICAgICByZXR1cm4gKF90aGlzLnByb3Rvc3R1YnNMaXN0W2RvbWFpblVSTF0pO1xyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIF90aGlzLnByb3Rvc3R1YnNMaXN0W2RvbWFpblVSTF0gPSB7XHJcbiAgICAgICAgc3RhdHVzOiBTVEFUVVMuREVQTE9ZSU5HXHJcbiAgICAgIH07XHJcblxyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tSZWdpc3RyeSAtIGRpc2NvdmVyUHJvdG9TdHViIF0gTWVzc2FnZSBOb2RlIFByb3Rvc3R1YiBOb3QgRm91bmQuIENyZWF0aW5nIG9uZScpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFRvIGRpc2NvdmVyIHByb3RvY29sIHN0dWJzIGF2YWlsYWJsZSBpbiB0aGUgcnVudGltZSBmb3IgYSBjZXJ0YWluIHJlbW90ZSBydW50aW1lIFVSTC4gSWYgYXZhaWxhYmxlLCBpdCByZXR1cm5zIHRoZSBydW50aW1lIHVybCBmb3IgdGhlIHByb3RvY29sIHN0dWIgdGhhdCBjb25uZWN0cyB0byB0aGUgcmVxdWVzdGVkIGRvbWFpbi5cclxuICAqIFJlcXVpcmVkIGJ5IHRoZSBydW50aW1lIEJVUyB0byByb3V0ZSBtZXNzYWdlcyB0byByZW1vdGUgc2VydmVycyBvciBwZWVycyAoZG8gd2UgbmVlZCBzb21ldGhpbmcgc2ltaWxhciBmb3IgSHlwZXJ0aWVzPykuXHJcbiAgKiBAcGFyYW0gIHtSdW50aW1lVVJMfSAgICAgICAgICAgUnVudGltZVVSTCAgICAgICAgICAgIHVybFxyXG4gICogQHJldHVybiB7cDJwUmVxdWVzdGVyfSAgICAgICAgICAgUnVudGltZVVSTFxyXG4gICovXHJcbiAgZGlzY292ZXJQMlBTdHViKHJ1bnRpbWVVUkwpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgaWYgKHJ1bnRpbWVVUkwpIHtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5wMnBSZXF1ZXN0ZXJTdHViLmhhc093blByb3BlcnR5KHJ1bnRpbWVVUkwpICYmIF90aGlzLnAycFJlcXVlc3RlclN0dWJbcnVudGltZVVSTF0uc3RhdHVzID09PSBTVEFUVVMuTElWRSkge1xyXG4gICAgICAgIHJldHVybiAoX3RoaXMucDJwUmVxdWVzdGVyU3R1YltydW50aW1lVVJMXSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgX3RoaXMucDJwUmVxdWVzdGVyU3R1YltydW50aW1lVVJMXSA9IHtcclxuICAgICAgICAgIHN0YXR1czogU1RBVFVTLkNSRUFURURcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tSZWdpc3RyeSAtIGRpc2NvdmVyUDJQU3R1YiBdIFAyUCBSZXF1ZXN0ZXIgU3R1YiBOb3QgRm91bmQuIENyZWF0aW5nIG9uZScpO1xyXG5cclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5wMnBIYW5kbGVyU3R1Yi5oYXNPd25Qcm9wZXJ0eShfdGhpcy5ydW50aW1lVVJMKSkge1xyXG4gICAgICAgIHJldHVybiAoX3RoaXMucDJwSGFuZGxlclN0dWJbX3RoaXMucnVudGltZVVSTF0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIF90aGlzLnAycEhhbmRsZXJTdHViW190aGlzLnJ1bnRpbWVVUkxdID0ge1xyXG4gICAgICAgICAgc3RhdHVzOiBTVEFUVVMuQ1JFQVRFRFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1JlZ2lzdHJ5IC0gZGlzY292ZXJQMlBTdHViIF0gUDJQIEhhbmRsZXIgU3R1YiBOb3QgRm91bmQuJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVG8gcmVnaXN0ZXIgYSBuZXcgUHJvdG9jb2wgU3R1YiBpbiB0aGUgcnVudGltZSBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyB0aGUgZnVuY3Rpb24gdG8gcG9zdE1lc3NhZ2UsIHRoZSBEb21haW5VUkwgdGhhdCBpcyBjb25uZWN0ZWQgd2l0aCB0aGUgc3R1Yiwgd2hpY2ggcmV0dXJucyB0aGUgUnVudGltZVVSTCBhbGxvY2F0ZWQgdG8gdGhlIG5ldyBQcm90b2NvbFN0dWIuXHJcbiAgICogQHBhcmFtICB7U2FuZGJveH0gICAgICAgU2FuZGJveFxyXG4gICAqIEBwYXJhbSAge3N0dWJJRH0gICAgICAgIERvbWFpbiBvciBoeXBlcnR5IHJ1bnRpbWUgdG8gcmVnaXN0ZXIgdGhlIHN0dWJcclxuICAgKiBAcGFyYW0gIHtkZXNjcmlwdG9yVVJMfSAgICAgQ2F0YWxvZ3VlIFVSTCBvZiB0aGUgUHJvdG9zdHViIGRlc2NyaXB0b3JcclxuICAgKiBAcGFyYW0gIHtkZXNjcmlwdG9yfSAgICAgUHJvdG9zdHViIGRlc2NyaXB0b3JcclxuICAgKiBAcmV0dXJuIHtSdW50aW1lUHJvdG9TdHViVVJMfVxyXG4gICAqL1xyXG4gIHJlZ2lzdGVyU3R1YihzYW5kYm94LCBzdHViSUQsIHAycENvbmZpZywgZGVzY3JpcHRvclVSTCwgZGVzY3JpcHRvcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgX3N0dWJEZXNjcmlwdG9yID0gZGVzY3JpcHRvcjtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBsZXQgcnVudGltZVByb3RvU3R1YlVSTDtcclxuXHJcbiAgICAgIC8vY2hlY2sgaWYgbWVzc2FnZUJ1cyBpcyByZWdpc3RlcmVkIGluIHJlZ2lzdHJ5IG9yIG5vdFxyXG4gICAgICBpZiAoX3RoaXMuX21lc3NhZ2VCdXMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJlamVjdCgnTWVzc2FnZUJ1cyBub3QgZm91bmQgb24gcmVnaXN0ZXJTdHViJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxvZy5pbmZvKCdbUmVnaXN0cnkgLSByZWdpc3RlclN0dWJdIC0gc3R1YklEICcsIHN0dWJJRCk7XHJcblxyXG4gICAgICAvKiBpZiAoIXN0dWJJRC5pbmRleE9mKCdtc2ctbm9kZS4nKSkge1xyXG4gICAgICAgIHN0dWJJRCA9IHN0dWJJRC5zdWJzdHJpbmcoc3R1YklELmluZGV4T2YoJy4nKSArIDEpO1xyXG4gICAgICB9Ki9cclxuXHJcbiAgICAgIGxldCBQMlBSZXF1ZXN0ZXJTdHViO1xyXG5cclxuICAgICAgaWYgKHAycENvbmZpZykge1xyXG5cclxuICAgICAgICBpZiAocDJwQ29uZmlnLmhhc093blByb3BlcnR5KCdpc0hhbmRsZXJTdHViJykgJiYgcDJwQ29uZmlnLmlzSGFuZGxlclN0dWIpIHtcclxuICAgICAgICAgIHJ1bnRpbWVQcm90b1N0dWJVUkwgPSBfdGhpcy5wMnBIYW5kbGVyVVJMO1xyXG5cclxuICAgICAgICAgIF90aGlzLnAycEhhbmRsZXJTdHViW3N0dWJJRF0gPSB7XHJcbiAgICAgICAgICAgIHVybDogcnVudGltZVByb3RvU3R1YlVSTCxcclxuICAgICAgICAgICAgc3RhdHVzOiBTVEFUVVMuQ1JFQVRFRFxyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICBfdGhpcy5wMnBIYW5kbGVyQXNzb2NpYXRpb25bX3RoaXMucnVudGltZVVSTF0gPSBbXTtcclxuXHJcbiAgICAgICAgICBfdGhpcy5zYW5kYm94ZXNMaXN0LnNhbmRib3hbcnVudGltZVByb3RvU3R1YlVSTF0gPSBzYW5kYm94O1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1tSZWdpc3RyeSAtIHJlZ2lzdGVyU3R1YiAtIFAyUEhhbmRsZXJTdHViXSAtICcsIHN0dWJJRCwgJyAtICcsIHJ1bnRpbWVQcm90b1N0dWJVUkwpO1xyXG4gICAgICAgICAgcmVzb2x2ZShfdGhpcy5wMnBIYW5kbGVyU3R1YltzdHViSURdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgUDJQUmVxdWVzdGVyU3R1YiA9IHAycENvbmZpZy5wMnBSZXF1ZXN0ZXJTdHViO1xyXG4gICAgICAgICAgcnVudGltZVByb3RvU3R1YlVSTCA9ICdydW50aW1lOi8vJyArIGRpdmlkZVVSTChwMnBDb25maWcucmVtb3RlUnVudGltZVVSTCkuZG9tYWluICsgJy9wMnByZXF1ZXN0ZXIvJyArIGdlbmVyYXRlR1VJRCgpO1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1tSZWdpc3RyeSAtIHJlZ2lzdGVyU3R1YiAtIFAyUFJlcXVlc3RlclN0dWJdIC0gJywgUDJQUmVxdWVzdGVyU3R1YiwgJyAtICcsIHJ1bnRpbWVQcm90b1N0dWJVUkwpO1xyXG5cclxuICAgICAgICAgIC8vIHRvIGJlIGNsYXJpZmllZCB3aGF0IGlzIHRoaXMgcDJwSGFuZGxlckFzc29jaWF0aW9uXHJcbiAgICAgICAgICBfdGhpcy5wMnBIYW5kbGVyQXNzb2NpYXRpb25bX3RoaXMucnVudGltZVVSTF0ucHVzaChydW50aW1lUHJvdG9TdHViVVJMKTtcclxuICAgICAgICAgIF90aGlzLnAycFJlcXVlc3RlclN0dWJbc3R1YklEXSA9IHtcclxuICAgICAgICAgICAgdXJsOiBydW50aW1lUHJvdG9TdHViVVJMLFxyXG4gICAgICAgICAgICBzdGF0dXM6IFNUQVRVUy5DUkVBVEVEXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIF90aGlzLnNhbmRib3hlc0xpc3Quc2FuZGJveFtydW50aW1lUHJvdG9TdHViVVJMXSA9IHNhbmRib3g7XHJcblxyXG4gICAgICAgICAgLy9TZXR1cCBQMlAgUmVxdWVzdGVyIHBhdGggaW50byBNTlxyXG5cclxuICAgICAgICAgIGxldCBtc2cgPSB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLFxyXG4gICAgICAgICAgICBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCxcclxuICAgICAgICAgICAgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgX3RoaXMuX2RvbWFpbiArICcvc20nLFxyXG4gICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgc3Vic2NyaWJlOiBbcnVudGltZVByb3RvU3R1YlVSTF0sXHJcbiAgICAgICAgICAgICAgc291cmNlOiBfdGhpcy5yZWdpc3RyeVVSTFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSAtIHJlZ2lzdGVyIFN0dWJdIHAycFJlcXVlc3RlciBwYXRoIHNldHVwOiAnLCByZXBseSk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICByZXNvbHZlKF90aGlzLnAycFJlcXVlc3RlclN0dWJbc3R1YklEXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbUmVnaXN0cnkgLSByZWdpc3RlclN0dWIgLSBOb3JtYWwgU3R1Yl0gZGVzY3JpcHRvcicsIGRlc2NyaXB0b3IpO1xyXG5cclxuICAgICAgICBpZiAoICF0eXBlb2YoZGVzY3JpcHRvcikgPT09ICdzdHJpbmcnICYmIGRlc2NyaXB0b3IuaGFzT3duUHJvcGVydHkoJ19pbnRlcndvcmtpbmcnKSAmJiBkZXNjcmlwdG9yLl9pbnRlcndvcmtpbmcpIHtcclxuICAgICAgICAgIHJ1bnRpbWVQcm90b1N0dWJVUkwgPSAncnVudGltZTovLycgKyBzdHViSUQgKyAnL3Byb3Rvc3R1Yi8nICsgJ3NjaGVtZTEnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBydW50aW1lUHJvdG9TdHViVVJMID0gJ3J1bnRpbWU6Ly8nICsgc3R1YklEICsgJy9wcm90b3N0dWIvJyArIGdlbmVyYXRlR1VJRCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9nLmluZm8oJ1tSZWdpc3RyeSAtIHJlZ2lzdGVyU3R1YiAtIE5vcm1hbCBTdHViXSAtICcsIHN0dWJJRCk7XHJcblxyXG4gICAgICAgIC8vIFRPRE86IE9wdGltaXplIHRoaXNcclxuICAgICAgICBfdGhpcy5wcm90b3N0dWJzTGlzdFtzdHViSURdID0ge1xyXG4gICAgICAgICAgdXJsOiBydW50aW1lUHJvdG9TdHViVVJMLFxyXG4gICAgICAgICAgc3RhdHVzOiBTVEFUVVMuREVQTE9ZSU5HXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKGRlc2NyaXB0b3JVUkwpIHtcclxuICAgICAgICAgIF90aGlzLnByb3Rvc3R1YnNMaXN0W3N0dWJJRF0uZGVzY3JpcHRvclVSTCA9IGRlc2NyaXB0b3JVUkw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoX3N0dWJEZXNjcmlwdG9yICYmIChfc3R1YkRlc2NyaXB0b3IuaW50ZXJ3b3JraW5nKSkge1xyXG4gICAgICAgICAgX3RoaXMucHJvdG9zdHVic0xpc3Rbc3R1YklEXS5pbnRlcndvcmtpbmcgPSBfc3R1YkRlc2NyaXB0b3IuaW50ZXJ3b3JraW5nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX3RoaXMuc2FuZGJveGVzTGlzdC5zYW5kYm94W3J1bnRpbWVQcm90b1N0dWJVUkxdID0gc2FuZGJveDtcclxuXHJcbiAgICAgICAgcmVzb2x2ZShfdGhpcy5wcm90b3N0dWJzTGlzdFtzdHViSURdKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gcmVzb2x2ZShydW50aW1lUHJvdG9TdHViVVJMKTtcclxuXHJcbiAgICAgIF90aGlzLl9tZXNzYWdlQnVzLmFkZExpc3RlbmVyKHJ1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsIChtc2cpID0+IHtcclxuICAgICAgICBfdGhpcy5fb25Qcm90b3N0dWJTdGF0dXNFdmVudChtc2cpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFRvIFByb2Nlc3Mgc3RhdHVzIGV2ZW50cyBmaXJlZCBieSBwcm90b3N0dWJzXHJcbiAgKiBAcGFyYW0gIHtNZXNzYWdlfSAgIG1lc3NhZ2UgICAgIEV2ZW50IE1lc3NhZ2VcclxuICAqL1xyXG5cclxuICBfb25Qcm90b3N0dWJTdGF0dXNFdmVudChtc2cpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSBvblByb3Rvc3R1YlN0YXR1c0V2ZW50XTogJywgbXNnKTtcclxuXHJcbiAgICBsZXQgcnVudGltZVByb3RvU3R1YlVSTCA9IG1zZy5mcm9tO1xyXG5cclxuICAgIGlmICghbXNnLnRvLmluY2x1ZGVzKCcvc3RhdHVzJykpIHtcclxuICAgICAgbG9nLmVycm9yKCdbUmVnaXN0cnkgb25Qcm90b3N0dWJTdGF0dXNFdmVudF0gTm90IFN0YXR1cyBFdmVudDogJywgbXNnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfSBlbHNlIHsvLyBicm9hZGNhc3QgUHJvdG9zdHViIHN0YXR1cyBldmVudCB0byBhbGwgSHlwZXJ0aWVzXHJcbiAgICAgIGxldCBmcm9tID0gIG1zZy5mcm9tO1xyXG4gICAgICBtc2cuZnJvbSA9IF90aGlzLnJ1bnRpbWVVUkw7XHJcbiAgICAgIG1zZy50byA9IF90aGlzLnJ1bnRpbWVVUkwrJy9zdGF0dXMnO1xyXG4gICAgICBtc2cuYm9keS5yZXNvdXJjZSA9IGZyb207XHJcbiAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcHJvY2VzcyBzdGF0dXMgZXZlbnRzIGZyb20gbWVzc2FnZSBub2RlIHByb3Rvc3R1YnNcclxuXHJcbiAgICBpZiAocnVudGltZVByb3RvU3R1YlVSTC5pbmNsdWRlcygnL3Byb3Rvc3R1Yi8nKSkge1xyXG5cclxuICAgIC8vIFRPRE86IHVuY29tbWVudCBiZWxvdyB3aGVuIHByb3Rvc3R1YnMgYXJlIHVwZGF0ZWQgd2l0aCBuZXcgc3RhdHVzIHZhbHVlIFwibGl2ZVwiXHJcbiAgICAgIE9iamVjdC5rZXlzKF90aGlzLnByb3Rvc3R1YnNMaXN0KS5maWx0ZXIoKGtleSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBfdGhpcy5wcm90b3N0dWJzTGlzdFtrZXldLnVybCA9PT0gcnVudGltZVByb3RvU3R1YlVSTDtcclxuICAgICAgfSkubWFwKChrZXkpID0+IHtcclxuICAgICAgICBfdGhpcy5wcm90b3N0dWJzTGlzdFtrZXldLnN0YXR1cyA9IG1zZy5ib2R5LnZhbHVlO1xyXG5cclxuICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgLSBvblByb3Rvc3R1YlN0YXR1c0V2ZW50XSAtIFByb3Rvc3R1YiBzdGF0dXM6ICcsIF90aGlzLnByb3Rvc3R1YnNMaXN0W2tleV0pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7IC8vIHByb2Nlc3Mgc3RhdHVzIGV2ZW50cyBmcm9tIHAycCBjb25uZWN0aW9uc1xyXG5cclxuICAgICAgaWYgKG1zZy5ib2R5LnJlc291cmNlKSB7XHJcbiAgICAgICAgbGV0IHJlbW90ZVJ1bnRpbWVVUkwgPSBtc2cuYm9keS5yZXNvdXJjZTtcclxuXHJcbiAgICAgICAgaWYgKF90aGlzLnAycENvbm5lY3Rpb25MaXN0W3JlbW90ZVJ1bnRpbWVVUkxdKSB7XHJcbiAgICAgICAgICBfdGhpcy5wMnBDb25uZWN0aW9uTGlzdFtyZW1vdGVSdW50aW1lVVJMXS5zdGF0dXMgPSAgbXNnLmJvZHkudmFsdWU7XHJcbiAgICAgICAgICBfdGhpcy5wMnBDb25uZWN0aW9uTGlzdFtyZW1vdGVSdW50aW1lVVJMXS51cmwgPSAgcnVudGltZVByb3RvU3R1YlVSTDtcclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgIGxldCAgcDJwQ29ubmVjdGlvbiA9IHtcclxuICAgICAgICAgICAgc3RhdHVzOiBtc2cuYm9keS52YWx1ZSxcclxuICAgICAgICAgICAgdXJsOiBydW50aW1lUHJvdG9TdHViVVJMXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIF90aGlzLnAycENvbm5lY3Rpb25MaXN0W3JlbW90ZVJ1bnRpbWVVUkxdID0gIHAycENvbm5lY3Rpb247XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgLSBvblByb3Rvc3R1YlN0YXR1c0V2ZW50XSAtIFAyUENvbm5lY3Rpb24gc3RhdHVzOiAnLCBfdGhpcy5wMnBDb25uZWN0aW9uTGlzdFtyZW1vdGVSdW50aW1lVVJMXSk7XHJcblxyXG4gICAgICAgIC8vIFVwZGF0ZSBQMlAgUmVxdWVzdGVyIHByb3Rvc3R1YiBpZiBpdCBpcyBjb21pbmcgZnJvbSB0aGVyZVxyXG4gICAgICAgIGlmIChydW50aW1lUHJvdG9TdHViVVJMLmluY2x1ZGVzKCcvcDJwcmVxdWVzdGVyLycpKSB7XHJcbiAgICAgICAgICBfdGhpcy5wMnBSZXF1ZXN0ZXJTdHViW3JlbW90ZVJ1bnRpbWVVUkxdLnN0YXR1cyA9IG1zZy5ib2R5LnZhbHVlO1xyXG5cclxuICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSAtIG9uUHJvdG9zdHViU3RhdHVzRXZlbnRdIC0gUDJQIFJlcXVlc3RlciBzdGF0dXM6ICcsIF90aGlzLnAycFJlcXVlc3RlclN0dWJbcmVtb3RlUnVudGltZVVSTF0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBpZiBmcm9tIFAyUEhhbmRsZXIgd2l0aCBzdGF0dXMgZGlzY29uZW5jdGVkLCBsZXRzIHJlbW92ZSBmcm9tIHAycENvbm5lY3Rpb25MaXN0XHJcbiAgICAgICAgICBpZiAobXNnLmJvZHkudmFsdWUgPT09ICdkaXNjb25uZWN0ZWQnKSBkZWxldGUgX3RoaXMucDJwQ29ubmVjdGlvbkxpc3RbcmVtb3RlUnVudGltZVVSTF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAocnVudGltZVByb3RvU3R1YlVSTC5pbmNsdWRlcygnL3AycHJlcXVlc3Rlci8nKSkge1xyXG4gICAgICAgICAgLy8gSXQgaXMgYW4gZXZlbnQgZnJvbSBQMlAgUmVxdWVzdGVyIHdpdGhvdXQgbWFuZGF0b3J5IFwicmVzb3VyY2VcIiBmaWVsZFxyXG4gICAgICAgICAgbG9nLmVycm9yKCdbUmVnaXN0cnkgb25Qcm90b3N0dWJTdGF0dXNFdmVudF0gcmVzb3VyY2UgbWlzc2luZzogJywgbXNnKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gSXQgaXMgYW4gZXZlbnQgZnJvbSBQMlAgSGFuZGxlclxyXG4gICAgICAgICAgX3RoaXMucDJwSGFuZGxlclN0dWJbX3RoaXMucnVudGltZVVSTF0uc3RhdHVzID0gbXNnLmJvZHkudmFsdWU7XHJcblxyXG4gICAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IC0gb25Qcm90b3N0dWJTdGF0dXNFdmVudF0gLSBQMlBIYW5kbGVyIFN0dWIgc3RhdHVzOiAnLCBfdGhpcy5wMnBIYW5kbGVyU3R1YltfdGhpcy5ydW50aW1lVVJMXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVG8gdW5yZWdpc3RlciBhIHByZXZpb3VzbHkgcmVnaXN0ZXJlZCBwcm90b2NvbCBzdHViXHJcbiAgKiBAcGFyYW0gIHtIeXBlcnR5UnVudGltZVVSTH0gICBIeXBlcnR5UnVudGltZVVSTCAgICAgaHlwZXJ0eVJ1bnRpbWVVUkxcclxuICAqL1xyXG4gIHVucmVnaXN0ZXJTdHViKGh5cGVydHlSdW50aW1lVVJMKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5wcm90b3N0dWJzTGlzdC5oYXNPd25Qcm9wZXJ0eShoeXBlcnR5UnVudGltZVVSTCkpIHtcclxuICAgICAgICBkZWxldGUgX3RoaXMucHJvdG9zdHVic0xpc3RbaHlwZXJ0eVJ1bnRpbWVVUkxdO1xyXG4gICAgICAgIHJlc29sdmUoJ1Byb3Rvc3R1YlVSTCByZW1vdmVkJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVqZWN0KCdFcnJvciBvbiB1bnJlZ2lzdGVyU3R1YjogSHlwZXJ0eSBub3QgZm91bmQnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUbyByZWdpc3RlciBhIG5ldyBJZGVudGl0eSBQcm92aWRlciBwcm94eSBpbiB0aGUgcnVudGltZSBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyB0aGUgZnVuY3Rpb24gdG8gcG9zdE1lc3NhZ2UsIHRoZSBEb21haW5VUkwgdGhhdCBpcyBjb25uZWN0ZWQgd2l0aCB0aGUgc3R1Yiwgd2hpY2ggcmV0dXJucyB0aGUgUnVudGltZVVSTCBhbGxvY2F0ZWQgdG8gdGhlIG5ldyBQcm90b2NvbFN0dWIuXHJcbiAgICogQHBhcmFtIHtTYW5kYm94fSAgICAgICAgU2FuZGJveFxyXG4gICAqIEBwYXJhbSAge0RvbWFpblVSTH0gICAgIERvbWFpblVSTCBzZXJ2aWNlIHByb3ZpZGVyIGRvbWFpblxyXG4gICAqIEByZXR1cm4ge1J1bnRpbWVJZHBQcm94eVVSTH1cclxuICAgKi9cclxuICByZWdpc3RlcklkcFByb3h5KHNhbmRib3gsIGRvbWFpblVSTCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBsZXQgaWRwUHJveHlTdHViVVJMO1xyXG5cclxuICAgICAgLy9jaGVjayBpZiBtZXNzYWdlQnVzIGlzIHJlZ2lzdGVyZWQgaW4gcmVnaXN0cnkgb3Igbm90XHJcbiAgICAgIGlmIChfdGhpcy5fbWVzc2FnZUJ1cyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmVqZWN0KCdNZXNzYWdlQnVzIG5vdCBmb3VuZCBvbiByZWdpc3RlclN0dWInKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWRwUHJveHlTdHViVVJMID0gJ2RvbWFpbi1pZHA6Ly8nICsgZG9tYWluVVJMICsgJy9zdHViLycgKyBnZW5lcmF0ZUdVSUQoKTtcclxuXHJcbiAgICAgIC8vIFRPRE86IE9wdGltaXplIHRoaXNcclxuICAgICAgX3RoaXMuaWRwUHJveHlMaXN0W2RvbWFpblVSTF0gPSB7XHJcbiAgICAgICAgdXJsOiBpZHBQcm94eVN0dWJVUkwsXHJcbiAgICAgICAgc3RhdHVzOiBTVEFUVVMuREVQTE9ZSU5HXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBfdGhpcy5zYW5kYm94ZXNMaXN0LnNhbmRib3hbaWRwUHJveHlTdHViVVJMXSA9IHNhbmRib3g7XHJcblxyXG4gICAgICAvLyBzYW5kYm94LmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24obXNnKSB7XHJcbiAgICAgIC8vICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnKTtcclxuICAgICAgLy8gfSk7XHJcblxyXG4gICAgICByZXNvbHZlKGlkcFByb3h5U3R1YlVSTCk7XHJcblxyXG4gICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihpZHBQcm94eVN0dWJVUkwgKyAnL3N0YXR1cycsIChtc2cpID0+IHtcclxuICAgICAgICBfdGhpcy5fb25JZHBQcm94eVN0YXR1c0V2ZW50KG1zZyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFRvIFByb2Nlc3Mgc3RhdHVzIGV2ZW50cyBmaXJlZCBieSBJZHAgUHJveGllc1xyXG4gICogQHBhcmFtICB7TWVzc2FnZX0gICBtZXNzYWdlICAgICBFdmVudCBNZXNzYWdlXHJcbiAgKi9cclxuXHJcbiAgX29uSWRwUHJveHlTdGF0dXNFdmVudChtc2cpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSBvbklkcFByb3h5U3RhdHVzRXZlbnRdOiAnLCBtc2cpO1xyXG5cclxuICAgIGxldCBpZHBQcm94eVVSTCA9IG1zZy5mcm9tO1xyXG5cclxuICAgIGlmICghbXNnLnRvLmluY2x1ZGVzKCcvc3RhdHVzJykpIHtcclxuICAgICAgbG9nLmVycm9yKCdbUmVnaXN0cnkgb25JZHBQcm94eVN0YXR1c0V2ZW50XSBOb3QgU3RhdHVzIEV2ZW50OiAnLCBtc2cpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgT2JqZWN0LmtleXMoX3RoaXMuaWRwUHJveHlMaXN0KS5maWx0ZXIoKGtleSkgPT4ge1xyXG4gICAgICByZXR1cm4gX3RoaXMuaWRwUHJveHlMaXN0W2tleV0udXJsID09PSBpZHBQcm94eVVSTDtcclxuICAgIH0pLm1hcCgoa2V5KSA9PiB7XHJcbiAgICAgIF90aGlzLmlkcFByb3h5TGlzdFtrZXldLnN0YXR1cyA9IG1zZy5ib2R5LnZhbHVlO1xyXG5cclxuICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IC0gb25JZHBQcm94eVN0YXR1c0V2ZW50XSAtIElkcCBQcm94eSBzdGF0dXM6ICcsIF90aGlzLmlkcFByb3h5TGlzdFtrZXldKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVG8gZGlzY292ZXIgaWRwUHJveHkgc3R1YnMgYXZhaWxhYmxlIGluIHRoZSBydW50aW1lIGZvciBhIGNlcnRhaW4gZG9tYWluLiBJZiBhdmFpbGFibGUsIGl0IHJldHVybnMgdGhlIHJ1bnRpbWUgdXJsIGZvciB0aGUgaWRwUHJveHkgc3R1YiB0aGF0IGNvbm5lY3RzIHRvIHRoZSByZXF1ZXN0ZWQgZG9tYWluLiBSZXF1aXJlZCBieSB0aGUgcnVudGltZSBCVVMgdG8gcm91dGUgbWVzc2FnZXMgdG8gcmVtb3RlIHNlcnZlcnMgb3IgcGVlcnNcclxuICAqIEBwYXJhbSAge0RvbWFpblVSTH0gICAgICAgICAgIERvbWFpblVSTCAgICAgICAgICAgIHVybFxyXG4gICogQHJldHVybiB7UnVudGltZVVSTH0gICAgICAgICAgIFJ1bnRpbWVVUkwgICAgICAgICBpZHBQcm94eVVybFxyXG4gICovXHJcbiAgZGlzY292ZXJJZHBQcm94eSh1cmwpIHtcclxuICAgIGlmICghdXJsKSB0aHJvdyBuZXcgRXJyb3IoJ1BhcmFtZXRlciB1cmwgbmVlZGVkJyk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKHVybCk7XHJcbiAgICBsZXQgZG9tYWluVVJMID0gZGl2aWRlZFVSTC5kb21haW47XHJcblxyXG4gICAgaWYgKF90aGlzLmlkcFByb3h5TGlzdC5oYXNPd25Qcm9wZXJ0eShkb21haW5VUkwpICYmIF90aGlzLmlkcFByb3h5TGlzdFtkb21haW5VUkxdLnN0YXR1cyA9PT0gU1RBVFVTLkxJVkUpIHtcclxuICAgICAgcmV0dXJuIChfdGhpcy5pZHBQcm94eUxpc3RbZG9tYWluVVJMXSk7XHJcbiAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgX3RoaXMuaWRwUHJveHlMaXN0W2RvbWFpblVSTF0gPSB7XHJcbiAgICAgICAgc3RhdHVzOiBTVEFUVVMuUFJPR1JFU1NcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1JlZ2lzdHJ5IC0gZGlzY292ZXJJZHBQcm94eSBdIElkcCBQcm94eSBOb3QgRm91bmQuIENyZWF0aW5nIG9uZScpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFRvIHJlZ2lzdGVyIGEgbmV3IFBvbGljeSBFbmZvcmNlciBpbiB0aGUgcnVudGltZSBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyB0aGUgZnVuY3Rpb24gdG8gcG9zdE1lc3NhZ2UsIHRoZSBIeXBlcnR5VVJMIGFzc29jaWF0ZWQgd2l0aCB0aGUgUEVQLCB3aGljaCByZXR1cm5zIHRoZSBSdW50aW1lVVJMIGFsbG9jYXRlZCB0byB0aGUgbmV3IFBvbGljeSBFbmZvcmNlciBjb21wb25lbnQuXHJcbiAgKiBAcGFyYW0gIHtNZXNzYWdlLk1lc3NhZ2V9IHBvc3RNZXNzYWdlIHBvc3RNZXNzYWdlXHJcbiAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMfSAgICAgICAgICBIeXBlcnR5VVJMICAgICAgICAgICAgaHlwZXJ0eVxyXG4gICogQHJldHVybiB7SHlwZXJ0eVJ1bnRpbWVVUkx9ICAgSHlwZXJ0eVJ1bnRpbWVVUkxcclxuICAqL1xyXG4gIHJlZ2lzdGVyUEVQKHBvc3RNZXNzYWdlLCBoeXBlcnR5KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XHJcbiAgICAgIC8vVE9ETyBjaGVjayB3aGF0IHBhcmFtZXRlciBpbiB0aGUgcG9zdE1lc3NhZ2UgdGhlIHBlcCBpcy5cclxuICAgICAgX3RoaXMucGVwTGlzdFtoeXBlcnR5XSA9IHBvc3RNZXNzYWdlO1xyXG4gICAgICByZXNvbHZlKCdQRVAgcmVnaXN0ZXJlZCB3aXRoIHN1Y2Nlc3MnKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVG8gdW5yZWdpc3RlciBhIHByZXZpb3VzbHkgcmVnaXN0ZXJlZCBwcm90b2NvbCBzdHViXHJcbiAgKiBAcGFyYW0gIHtIeXBlcnR5UnVudGltZVVSTH0gICBIeXBlcnR5UnVudGltZVVSTCAgICAgSHlwZXJ0eVJ1bnRpbWVVUkxcclxuICAqL1xyXG4gIHVucmVnaXN0ZXJQRVAoSHlwZXJ0eVJ1bnRpbWVVUkwpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IHJlc3VsdCA9IF90aGlzLnBlcExpc3RbSHlwZXJ0eVJ1bnRpbWVVUkxdO1xyXG5cclxuICAgICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmVqZWN0KCdQZXAgTm90IGZvdW5kLicpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlc29sdmUoJ1BFUCBzdWNjZXNzZnVsbHkgcmVtb3ZlZC4nKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBUbyBkaXNjb3ZlciBzYW5kYm94ZXMgYXZhaWxhYmxlIGluIHRoZSBydW50aW1lIGZvciBhIGNlcnRhaW4gZG9tYWluIGFuZCBhIGNlcnRhaW4gc2V0IG9mIGNhcGFiaWxpdGllcy4gUmVxdWlyZWQgYnkgdGhlIHJ1bnRpbWUgVUEgdG8gYXZvaWQgbW9yZSB0aGFuIG9uZSBzYW5kYm94IGZvciB0aGUgc2FtZSBkb21haW4uXHJcbiAgKiBAcGFyYW0gIHtEb21haW5VUkx9IERvbWFpblVSTCB1cmxcclxuICAqIEByZXR1cm4ge1J1bnRpbWVTYW5kYm94fSAgICAgICAgICAgUnVudGltZVNhbmRib3hcclxuICAqL1xyXG4gIGdldFNhbmRib3godXJsLCBjb25zdHJhaW50cykge1xyXG4gICAgaWYgKCF1cmwpIHRocm93IG5ldyBFcnJvcignUGFyYW1ldGVyIHVybCBuZWVkZWQnKTtcclxuXHJcbiAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgZ2V0U2FuZGJveF0gZ2V0U2FuZGJveCBmb3I6ICcsIHVybCwgJyBhbmQgY2FwYWJpbGl0aWVzOiAnLCBjb25zdHJhaW50cyk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGxldCByZXF1ZXN0O1xyXG5cclxuICAgICAgLy9maXJzdCB0cnkgdG8gZmluZCB0aGUgdXJsIGluIHRoZSBhcHBTYW5kYm94IGxpc3RcclxuICAgICAgcmVxdWVzdCA9IF90aGlzLnNhbmRib3hlc0xpc3QuYXBwU2FuZGJveFt1cmxdO1xyXG5cclxuICAgICAgLy9pZiBubyBhcHBTYW5kYm94IHdhcyBmb3VuZCwgdHJ5IHRvIHNlYXJjaCBpbiB0aGUgbm9ybWFsIHNhbmRib3hlcyBsaXN0XHJcbiAgICAgIGlmICghcmVxdWVzdCkge1xyXG4gICAgICAgIHJlcXVlc3QgPSBfdGhpcy5zYW5kYm94ZXNMaXN0LnNhbmRib3hbdXJsXTtcclxuXHJcbiAgICAgICAgaWYgKCFyZXF1ZXN0KSB7XHJcblxyXG4gICAgICAgICAgbGV0IGRvbWFpbjtcclxuXHJcbiAgICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCc6Ly8nKSkge1xyXG4gICAgICAgICAgICBkb21haW4gPSBkaXZpZGVVUkwodXJsKS5kb21haW47XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkb21haW4gPSB1cmw7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gc2VhcmNoIGluIHRoZSBzYW5kYm94ZXMgbGlzdCBmb3IgYSBlbnRyeSBjb250YWluaW5nIHRoZSBkb21haW4gZ2l2ZW5cclxuICAgICAgICAgIGZvciAobGV0IHNhbmRib3ggaW4gX3RoaXMuc2FuZGJveGVzTGlzdC5zYW5kYm94KSB7XHJcbiAgICAgICAgICAgIC8vdG9kbzogdW5jb21tZW50IHNhbmRib3ggY29uc3RyYWludHMgbWF0Y2ggY29uZGl0aW9uIHdpdGggcnVudGltZSBzaGFyaW5nXHJcbiAgICAgICAgICAgIGlmIChzYW5kYm94LmluY2x1ZGVzKGRvbWFpbikgJiYgX3RoaXMuc2FuZGJveGVzTGlzdC5zYW5kYm94W3NhbmRib3hdLm1hdGNoZXMoY29uc3RyYWludHMpKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IF90aGlzLnNhbmRib3hlc0xpc3Quc2FuZGJveFtzYW5kYm94XTtcclxuICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IE9iamVjdC5rZXlzKGNvbnN0cmFpbnRzKS5maWx0ZXIoY29uc3RyYWludCA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGNvbnN0cmFpbnQgPT09ICdicm93c2VyJyAmJiBjdXJyZW50LnR5cGUgPT09IFNhbmRib3hUeXBlLk5PUk1BTCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgIChjb25zdHJhaW50ID09PSAnd2luZG93U2FuYm94JyAmJiBjdXJyZW50LnR5cGUgPT09IFNhbmRib3hUeXBlLldJTkRPVyk7XHJcblxyXG4gICAgICAgICAgICAgIH0pLmxlbmd0aCA+IDAgPyB0cnVlIDogZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChtYXRjaCkgeyByZXF1ZXN0ID0gY3VycmVudDsgfVxyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXJlcXVlc3QpIHtcclxuICAgICAgICByZWplY3QoJ25vIHNhbmRib3ggZm91bmQgZm9yOiAnICsgdXJsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNvbHZlKHJlcXVlc3QpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNvbHZlTm9ybWFsU3R1Yih1cmwpIHtcclxuICAgIC8vIGxvZy5sb2coJ3Jlc29sdmVOb3JtYWxTdHViICcgKyB1cmwpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgLy9zcGxpdCB0aGUgdXJsIHRvIGZpbmQgdGhlIGRvbWFpblVSTC4gZGVhbHMgd2l0aCB0aGUgdXJsIGZvciBleGFtcGxlIGFzOlxyXG4gICAgICAvL1wiaHlwZXJ0eS1ydW50aW1lOi8vc3AxL3Byb3Rvc3R1Yi8xMjNcIixcclxuICAgICAgbGV0IGRpdmlkZWRVUkwgPSBkaXZpZGVVUkwodXJsKTtcclxuICAgICAgbGV0IGRvbWFpblVybCA9IGRpdmlkZWRVUkwuZG9tYWluO1xyXG4gICAgICBsZXQgdHlwZSA9IGRpdmlkZWRVUkwudHlwZTtcclxuXHJcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoX3RoaXMucnVudGltZVVSTCkgfHwgdXJsLmluY2x1ZGVzKCc6Ly9zYW5kYm94LycpKSB7XHJcbiAgICAgICAgbG9nLmVycm9yKCdbUmVnaXN0cnkgLSByZXNvbHZlXSBVUkwgdG8gYmUgcmVzb2x2ZWQgc2hvdWxkIGhhdmUgbGlzdGVuZXJzICcsIHVybCk7XHJcbiAgICAgICAgcmVqZWN0KCdbUmVnaXN0cnkgLSByZXNvbHZlXSBVUkwgdG8gYmUgcmVzb2x2ZWQgc2hvdWxkIGhhdmUgbGlzdGVuZXJzICcsIHVybCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIHJlc29sdmUgdGhlIGRvbWFpbiBwcm90b3N0dWIgaW4gY2FzZSBvZiBhIG1lc3NhZ2UgdG8gZ2xvYmFsIHJlZ2lzdHJ5XHJcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJ2dsb2JhbDovL3JlZ2lzdHJ5JykpIHtcclxuICAgICAgICBkb21haW5VcmwgPSBfdGhpcy5fZG9tYWluO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmICghZG9tYWluVXJsLmluZGV4T2YoJ21zZy1ub2RlLicpIHx8ICFkb21haW5VcmwuaW5kZXhPZigncmVnaXN0cnkuJykpIHtcclxuICAgICAgICAgIGRvbWFpblVybCA9IGRvbWFpblVybC5zdWJzdHJpbmcoZG9tYWluVXJsLmluZGV4T2YoJy4nKSArIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgX3RoaXMuaXNMZWdhY3kodXJsKS50aGVuKChpc0xlZ2FjeSkgPT4ge1xyXG5cclxuICAgICAgICAvLyBpZiBsZWdhY3kgaXQgc2hvdWxkIHJlc29sdmUgZm9yIDxwcm90b2NvbD4uPGRvbWFpbj5cclxuICAgICAgICBpZiAoaXNMZWdhY3kgJiYgdHlwZSAhPT0gJ2RvbWFpbi1pZHAnKSB7XHJcbiAgICAgICAgICBkb21haW5VcmwgPSB0eXBlICsgJy4nICsgZ2V0VXNlcklkZW50aXR5RG9tYWluKHVybCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsb2cuaW5mbygnW1JlZ2lzdHJ5LnJlc29sdmVdIGRvbWFpblVybDonLCBkb21haW5VcmwpO1xyXG5cclxuICAgICAgICBsZXQgcmVnaXN0cmVkQ29tcG9uZW50O1xyXG5cclxuICAgICAgICBpZiAodHlwZSA9PT0gJ2RvbWFpbi1pZHAnKSB7XHJcbiAgICAgICAgICByZWdpc3RyZWRDb21wb25lbnQgID0gX3RoaXMuaWRwUHJveHlMaXN0Lmhhc093blByb3BlcnR5KGRvbWFpblVybCkgPyBfdGhpcy5pZHBQcm94eUxpc3RbZG9tYWluVXJsXSA6IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZWdpc3RyZWRDb21wb25lbnQgID0gX3RoaXMucHJvdG9zdHVic0xpc3QuaGFzT3duUHJvcGVydHkoZG9tYWluVXJsKSA/IF90aGlzLnByb3Rvc3R1YnNMaXN0W2RvbWFpblVybF0gOiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxvZy5pbmZvKCdbUmVnaXN0cnkucmVzb2x2ZV0gcmVnaXN0cmVkOicsIHJlZ2lzdHJlZENvbXBvbmVudCk7XHJcblxyXG4gICAgICAgIC8vIFRPRE8gc2luY2UgdGhlIHByb3Rvc3R1YnMgaGF2ZSBvdGhlciBzdGF0ZXMgdGhpcyBzaG91bGQgYmUgcmV2aXNlZCwgYmVjYXVzZSB0aGUgc3RhdHVzIGNvdWxkIGNoYW5nZSBmcm9tIERFUExPWUVEIHRvIExJVkVcclxuICAgICAgICAvLyBUT0RPIGFuZCB0aGlzIHZhbGlkYXRpb24gd2lsbCB0cmlnZ2VyIGEgbmV3IGxvYWQgb2YgSURQUHJveHkgb3IgUHJvdG9zdHViO1xyXG4gICAgICAgIGlmIChyZWdpc3RyZWRDb21wb25lbnQgJiYgcmVnaXN0cmVkQ29tcG9uZW50Lmhhc093blByb3BlcnR5KCdzdGF0dXMnKSAmJlxyXG4gICAgICAgICAocmVnaXN0cmVkQ29tcG9uZW50LnN0YXR1cyA9PT0gU1RBVFVTLkRFUExPWUVEIHx8IHJlZ2lzdHJlZENvbXBvbmVudC5zdGF0dXMgPT09IFNUQVRVUy5DUkVBVEVEIHx8XHJcbiAgICAgICAgICByZWdpc3RyZWRDb21wb25lbnQuc3RhdHVzID09PSBTVEFUVVMuTElWRSB8fCByZWdpc3RyZWRDb21wb25lbnQuc3RhdHVzID09PSBTVEFUVVMuRElTQ09OTkVDVEVEKSkge1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1tSZWdpc3RyeS5yZXNvbHZlXSBSZXNvbHZlZDogJywgcmVnaXN0cmVkQ29tcG9uZW50LnVybCwgcmVnaXN0cmVkQ29tcG9uZW50LnN0YXR1cyk7XHJcbiAgICAgICAgICByZXNvbHZlKHJlZ2lzdHJlZENvbXBvbmVudC51cmwpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvL3RvZG86IHVzZSBzd2l0Y2gtY2FzZSB0byBzdXBwb3J0IG90aGVyIHR5cGVzIG9mIHN0dWJzXHJcbiAgICAgICAgICBpZiAodHlwZSA9PT0gJ2RvbWFpbi1pZHAnKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBUaGUgSWRQIFByb3h5IGRvZXMgbm90IGV4aXN0LCBsZXQncyBwcmVwYXJlIGl0cyBkZXBsb3ltZW50IGJ5IHdhdGNoaW5nIGl0cyBzdGF0dXNcclxuXHJcbiAgICAgICAgICAgIF90aGlzLndhdGNoaW5nWW91Lm9ic2VydmUoJ2lkcFByb3h5TGlzdCcsIChjaGFuZ2UpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IC0gcmVzb2x2ZU5vcm1hbFN0dWJdIGlkcFByb3h5TGlzdCBjaGFuZ2VkICcgKyBfdGhpcy5pZHBQcm94eUxpc3QpO1xyXG5cclxuICAgICAgICAgICAgICBsZXQga2V5cGF0aCA9IGNoYW5nZS5rZXlwYXRoO1xyXG5cclxuICAgICAgICAgICAgICBpZiAoa2V5cGF0aC5pbmNsdWRlcygnc3RhdHVzJykpXHJcbiAgICAgICAgICAgICAgICBrZXlwYXRoID0ga2V5cGF0aC5yZXBsYWNlKCcuc3RhdHVzJywgJycpO1xyXG5cclxuICAgICAgICAgICAgICBpZiAoa2V5cGF0aCA9PT0gZG9tYWluVXJsICYmIGNoYW5nZS5uYW1lID09PSAnc3RhdHVzJyAmJiBjaGFuZ2UubmV3VmFsdWUgPT09IFNUQVRVUy5DUkVBVEVEKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnkgLSByZXNvbHZlTm9ybWFsU3R1Yl0gaWRwUHJveHlMaXN0IGlzIGxpdmUgJyArIF90aGlzLmlkcFByb3h5TGlzdFtkb21haW5VcmxdKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuaWRwUHJveHlMaXN0W2RvbWFpblVybF0udXJsKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFyZWdpc3RyZWRDb21wb25lbnQgfHwgcmVnaXN0cmVkQ29tcG9uZW50LnN0YXR1cyA9PT0gU1RBVFVTLkZBSUxFRCApIHtcclxuICAgICAgICAgICAgICAvLyB0aGlzIHByb2Nlc3Mgd2lsbCBsb2FkIHRoZSBpZHAgcHJveHksIGJlY2F1c2UgaXMgbm90IHlldCByZWdpc3RlcmVkO1xyXG4gICAgICAgICAgICAgIGxvZy5pbmZvKCdbUmVnaXN0cnkucmVzb2x2ZU5vcm1hbFN0dWJdIGRlcGxveSBuZXcgSURQUHJveHk6ICcsIGRvbWFpblVybCk7XHJcbiAgICAgICAgICAgICAgX3RoaXMubG9hZGVyLmxvYWRJZHBQcm94eShkb21haW5VcmwpLnRoZW4oKCkgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxvZy5pbmZvKCdbUmVnaXN0cnkucmVzb2x2ZU5vcm1hbFN0dWJdIElkUCBQcm94eSBkZXBsb3llZDogJywgX3RoaXMuaWRwUHJveHlMaXN0W2RvbWFpblVybF0pO1xyXG5cclxuICAgICAgICAgICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoJ1tSZWdpc3RyeS5yZXNvbHZlXSBFcnJvciByZXNvbHZpbmcgTG9hZCBJRFBQcm94eTogJywgcmVhc29uKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmlkcFByb3h5TGlzdFtkb21haW5VcmxdLnN0YXR1cyA9ICdkZXBsb3ltZW50LWZhaWxlZCc7XHJcbiAgICAgICAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgLy8gVGhlIHByb3RvU3R1YiBkb2VzIG5vdCBleGlzdCwgbGV0J3MgcHJlcGFyZSBpdHMgZGVwbG95bWVudCBieSB3YXRjaGluZyBpdHMgc3RhdHVzXHJcblxyXG4gICAgICAgICAgICBfdGhpcy53YXRjaGluZ1lvdS5vYnNlcnZlKCdwcm90b3N0dWJzTGlzdCcsIChjaGFuZ2UpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IC0gcmVzb2x2ZU5vcm1hbFN0dWJdIHByb3Rvc3R1YnNMaXN0IGNoYW5nZWQgJyArIF90aGlzLnByb3Rvc3R1YnNMaXN0KTtcclxuXHJcbiAgICAgICAgICAgICAgbGV0IGtleXBhdGggPSBjaGFuZ2Uua2V5cGF0aDtcclxuXHJcbiAgICAgICAgICAgICAgaWYgKGtleXBhdGguaW5jbHVkZXMoJ3N0YXR1cycpKVxyXG4gICAgICAgICAgICAgICAga2V5cGF0aCA9IGtleXBhdGgucmVwbGFjZSgnLnN0YXR1cycsICcnKTtcclxuXHJcbiAgICAgICAgICAgICAgaWYgKGtleXBhdGggPT09IGRvbWFpblVybCAmJiBjaGFuZ2UubmFtZSA9PT0gJ3N0YXR1cycgJiYgY2hhbmdlLm5ld1ZhbHVlID09PSBTVEFUVVMuQ1JFQVRFRCkge1xyXG4gICAgICAgICAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IC0gcmVzb2x2ZV0gcHJvdG9zdHViIGlzIGxpdmUgJyArIF90aGlzLnByb3Rvc3R1YnNMaXN0W2RvbWFpblVybF0pO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5wcm90b3N0dWJzTGlzdFtkb21haW5VcmxdLnVybCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcmVnaXN0cmVkQ29tcG9uZW50IHx8IHJlZ2lzdHJlZENvbXBvbmVudC5zdGF0dXMgPT09IFNUQVRVUy5GQUlMRUQpIHtcclxuICAgICAgICAgICAgICAvLyBsZXRzIGRlcGxveSB0aGUgcHJvdG9zdHViXHJcbiAgICAgICAgICAgICAgbG9nLmluZm8oJ1tSZWdpc3RyeS5yZXNvbHZlXSB0cmlnZ2VyIG5ldyBQcm90b2NvbFN0dWI6ICcsIGRvbWFpblVybCk7XHJcbiAgICAgICAgICAgICAgX3RoaXMubG9hZGVyLmxvYWRTdHViKGRvbWFpblVybCkudGhlbigoKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IC0gcmVzb2x2ZU5vcm1hbFN0dWJdIFN0dWIgZGVwbG95ZWQ6ICcsIF90aGlzLnByb3Rvc3R1YnNMaXN0W2RvbWFpblVybF0pO1xyXG4gICAgICAgICAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICAgICAgICAgIGxvZy5lcnJvcignW1JlZ2lzdHJ5LnJlc29sdmVOb3JtYWxTdHViXSBFcnJvciByZXNvbHZpbmcgTG9hZCBQcm90b2NvbFN0dWI6ICcsIHJlYXNvbik7XHJcbiAgICAgICAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGxvZy5lcnJvcignW1JlZ2lzdHJ5LnJlc29sdmVdIEVycm9yIHJlc29sdmluZyBpc2xlZ2FjeTogJywgcmVhc29uKTtcclxuICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBUbyB2ZXJpZnkgaWYgc291cmNlIGlzIHZhbGlkIGFuZCB0byByZXNvbHZlIHRhcmdldCBydW50aW1lIHVybCBhZGRyZXNzIGlmIG5lZWRlZCAoZWcgcHJvdG9zdHViIHJ1bnRpbWUgdXJsIGluIGNhc2UgdGhlIG1lc3NhZ2UgaXMgdG8gYmUgZGlzcGF0Y2hlZCB0byBhIHJlbW90ZSBlbmRwb2ludCkuXHJcbiAgKiBAcGFyYW0gIHtVUkwuVVJMfSAgdXJsICAgICAgIHVybFxyXG4gICogQHJldHVybiB7UHJvbWlzZTxVUkwuVVJMPn0gICAgICAgICAgICAgICAgIFByb21pc2UgPFVSTC5VUkw+XHJcbiAgKi9cclxuICByZXNvbHZlKG1zZykge1xyXG4gICAgbG9nLmluZm8oJ1tSZWdpc3RyeSAtIFJlc29sdmVdIC0gICcsIG1zZyk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgdXJsID0gbXNnLnRvID8gbXNnLnRvIDogbXNnO1xyXG5cclxuICAgICAgbGV0IHAycCA9IChtc2cuYm9keSAmJiBtc2cuYm9keS5wMnApID8gbXNnLmJvZHkucDJwIDogZmFsc2U7XHJcblxyXG4gICAgICAvLyBsb2cubG9nKCdQMlA6ICcsIHAycCwgdXJsKTtcclxuICAgICAgLy8gbG9nLmxvZygnUDJQIC0gcDJwSGFuZGxlclN0dWI6ICcsICFfdGhpcy5wMnBIYW5kbGVyU3R1YltfdGhpcy5ydW50aW1lVVJMXSwgX3RoaXMucDJwSGFuZGxlclN0dWIsIF90aGlzLnJ1bnRpbWVVUkwpO1xyXG4gICAgICAvLyBsb2cubG9nKCdQMlAgLSBpc0JhY2tlbmRTZXJ2aWNlVVJMOiAnLCBpc0JhY2tlbmRTZXJ2aWNlVVJMKHVybCksIGlzQmFja2VuZFNlcnZpY2VVUkwsIHVybCk7XHJcbiAgICAgIC8vIGxvZy5sb2coJ1AyUCAtIGluY2x1ZGVzIHJ1bnRpbWVVUkw6ICcsIHVybC5pbmNsdWRlcyhfdGhpcy5ydW50aW1lVVJMKSk7XHJcbiAgICAgIC8vIGxvZy5sb2coJ1AyUCAtIGluY2x1ZGVzIHAycGhhbmRsZXI6ICcsIHVybC5pbmNsdWRlcygnL3AycGhhbmRsZXIvJykpO1xyXG4gICAgICAvLyBsb2cubG9nKCdQMlAgLSBpbmNsdWRlcyBwMnByZXF1ZXN0ZXI6ICcsIHVybC5pbmNsdWRlcygnL3AycHJlcXVlc3Rlci8nKSk7XHJcblxyXG4gICAgICAvLyBTa2lwIHAycCBwcm9jZWR1cmUgd2hlbiBub3Qgc3VwcG9ydGVkIGJ5IHRoZSBSdW50aW1lIG9yIGZvciBiYWNrZW5kIHNlcnZpY2VzXHJcblxyXG4gICAgICBpZiAoIV90aGlzLnAycEhhbmRsZXJTdHViW190aGlzLnJ1bnRpbWVVUkxdIHx8IGlzQmFja2VuZFNlcnZpY2VVUkwodXJsKSB8fCB1cmwuaW5jbHVkZXMoX3RoaXMucnVudGltZVVSTCkgfHwgdXJsLmluY2x1ZGVzKCcvcDJwaGFuZGxlci8nKSB8fCB1cmwuaW5jbHVkZXMoJy9wMnByZXF1ZXN0ZXIvJykpIHtcclxuXHJcbiAgICAgICAgbG9nLmluZm8oJ1tSZWdpc3RyeSAtIHJlc29sdmVdIC0gUmVzb2x2ZSBub3JtYWwgc3R1YjogJywgX3RoaXMucDJwSGFuZGxlclN0dWIsIF90aGlzLnJ1bnRpbWVVUkwsIGlzQmFja2VuZFNlcnZpY2VVUkwodXJsKSwgcDJwLCB1cmwpO1xyXG4gICAgICAgIF90aGlzLnJlc29sdmVOb3JtYWxTdHViKHVybCkudGhlbigocmV0dXJuVVJMKSA9PiB7XHJcbiAgICAgICAgICByZXNvbHZlKHJldHVyblVSTCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICBsb2cuaW5mbygnW1JlZ2lzdHJ5IC0gcmVzb2x2ZV0gLSBjaGVja1AyUDogJywgcDJwLCB1cmwsIF90aGlzLl9wMnBDb25uZWN0aW9uUmVzb2x2ZSk7XHJcbiAgICAgICAgX3RoaXMuX3AycENvbm5lY3Rpb25SZXNvbHZlLmNoZWNrUDJQKG1zZykudGhlbigocmVnaXN0ZXJlZFAyUCkgPT4ge1xyXG5cclxuICAgICAgICAgIC8vIGxvZy5sb2coJ1tSZWdpc3RyeSAtIHJlc29sdmVdIGZvdW5kIHJlZ2lzdGVyZWQgUDJQOiAnLCByZWdpc3RlcmVkUDJQKTtcclxuXHJcbiAgICAgICAgICBsZXQgcDJwQ29ubmVjdGlvbiA9IF90aGlzLnAycENvbm5lY3Rpb25MaXN0W3JlZ2lzdGVyZWRQMlAucnVudGltZV07XHJcblxyXG4gICAgICAgICAgaWYgKCFwMnBDb25uZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHAycENvbm5lY3Rpb24gPSByZWdpc3RlcmVkUDJQO1xyXG4gICAgICAgICAgICBfdGhpcy5wMnBDb25uZWN0aW9uTGlzdFtyZWdpc3RlcmVkUDJQLnJ1bnRpbWVdID0gcDJwQ29ubmVjdGlvbjtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBzd2l0Y2ggKHAycENvbm5lY3Rpb24uc3RhdHVzKSB7XHJcbiAgICAgICAgICAgIGNhc2UgU1RBVFVTLkxJVkU6XHJcbiAgICAgICAgICAgICAgbXNnLmJvZHkucGVlciA9IHJlZ2lzdGVyZWRQMlAucnVudGltZTtcclxuICAgICAgICAgICAgICByZXNvbHZlKHAycENvbm5lY3Rpb24udXJsLCBtc2cpO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFNUQVRVUy5DUkVBVEVEOiAvLyBwMnAgY29ubmVjdGlvbiBzZXR1cCBpcyBvbmdvaW5nLCB1c2UgTU4gU3R1YlxyXG4gICAgICAgICAgICBjYXNlIFNUQVRVUy5QUk9HUkVTUzpcclxuICAgICAgICAgICAgICBfdGhpcy5yZXNvbHZlTm9ybWFsU3R1Yih1cmwpLnRoZW4oKHJldHVyblVSTCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXR1cm5VUkwpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFNUQVRVUy5ESVNDT05ORUNURUQ6IC8vIHAycCBjb25uZWN0aW9uIHN0dWIgd2FzIGRpc2Nvbm5lY3RlZCwgbGV0J3MgYXNrIHRvIGNvbm5lY3QgYWdhaW5cclxuICAgICAgICAgICAgICBsb2cuaW5mbygnW1JlZ2lzdHJ5IC0gUmVzb2x2ZV0gLSBwMnBDb25uZWN0aW9uIGlzIGRpc2Nvbm5lY3RlZCBsZXRzIHRyeSB0byByZWNvbm5lY3QnKTtcclxuICAgICAgICAgICAgICBfdGhpcy5fcDJwQ29ubmVjdGlvblJlc29sdmUucmVjb25uZWN0UDJQUmVxdWVzdGVyKHAycENvbm5lY3Rpb24pLnRoZW4oKHJldHVyblVSTCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5IC0gUmVzb2x2ZV0gLSB3YXMgcmVjb25uZWN0ZWQgd2l0aCBwMnBSZXF1ZXN0ZXJTdHVidDogJywgcmV0dXJuVVJMKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUocmV0dXJuVVJMKTtcclxuICAgICAgICAgICAgICB9LCAocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2cuaW5mbygnW1JlZ2lzdHJ5IC0gUmVzb2x2ZV0gLSBSZWFzb246ICcsIHJlYXNvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVzb2x2ZU5vcm1hbFN0dWIodXJsKS50aGVuKChyZXR1cm5VUkwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXR1cm5VUkwpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcblxyXG4gICAgICAgICAgICAgIGxvZy5pbmZvKCdbUmVnaXN0cnkgLSByZXNvbHZlXSAtIFAyUDogJywgcDJwKTtcclxuICAgICAgICAgICAgICBpZiAoIXAycCkgeyAvLyBubyBwMnAgY29ubmVjdGlvbiBleGlzdHMgYW5kIHRoZSBtZXNzYWdlIHNlbmRlciBkb2VzIG5vdCBhc2sgb25lLiBMZXRzIHVzZSB0aGUgTU4gU3R1YlxyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVzb2x2ZU5vcm1hbFN0dWIodXJsKS50aGVuKChyZXR1cm5VUkwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXR1cm5VUkwpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fc2V0dXBQMlBSZXF1ZXN0ZXIocmVnaXN0ZXJlZFAyUCkudGhlbigocmV0dXJuVVJMKSA9PiB7IC8vIG5vIHAycCBjb25uZWN0aW9uIGV4aXN0cyBidXQgdGhlIG1lc3NhZ2Ugc2VuZGVyIGlzIGFza2luZyBvbmUuIExldHMgdHJ5IHRvIHNldHVwIG9uZVxyXG4gICAgICAgICAgICAgICAgICByZXNvbHZlKHJldHVyblVSTCk7XHJcbiAgICAgICAgICAgICAgICB9LCAocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGxvZy5pbmZvKCdbUmVnaXN0cnkgLSBSZXNvbHZlXSAtIFJlYXNvbjogJywgcmVhc29uKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmVOb3JtYWxTdHViKHVybCkudGhlbigocmV0dXJuVVJMKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXR1cm5VUkwpO1xyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LCAocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICBsb2cuaW5mbygnW1JlZ2lzdHJ5IC0gUmVzb2x2ZV0gLSBSZWFzb246ICcsIHJlYXNvbik7XHJcblxyXG4gICAgICAgICAgX3RoaXMucmVzb2x2ZU5vcm1hbFN0dWIodXJsKS50aGVuKChyZXR1cm5VUkwpID0+IHtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXR1cm5VUkwpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zZXR1cFAyUFJlcXVlc3RlcihpbnB1dCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsb2cubG9nKCdbUmVnaXN0cnkuX3NldHVwUDJQQ29ubmVjdGlvbl0gbG9hZFN0dWIgd2l0aCBwMnBSZXF1ZXN0ZXI6ICcsIGlucHV0KTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IHJlbW90ZVJ1bnRpbWUgPSBpbnB1dC5ydW50aW1lO1xyXG5cclxuICAgICAgbGV0IHAycENvbmZpZyA9IHsgcmVtb3RlUnVudGltZVVSTDogcmVtb3RlUnVudGltZSwgcDJwSGFuZGxlcjogaW5wdXQucDJwSGFuZGxlciwgcDJwUmVxdWVzdGVyU3R1YjogdHJ1ZSB9O1xyXG5cclxuICAgICAgLy8gbGV0cyBwcmVwYXJlIHRoZSBwMnBSZXF1ZXN0ZXJTVHViIGRlcGxveW1lbnQgYnkgc2V0dGluZyBhbiBvYnNlcnZlciB0byBpdHMgc3RhdHVzIGNoYW5nZXNcclxuXHJcbiAgICAgIF90aGlzLndhdGNoaW5nWW91Lm9ic2VydmUoJ3AycFJlcXVlc3RlclN0dWInLCAoY2hhbmdlKSA9PiB7XHJcblxyXG4gICAgICAgIGxvZy5sb2coJ1tSZWdpc3RyeS5fc2V0dXBQMlBDb25uZWN0aW9uXSBwMnBSZXF1ZXN0ZXJTdHVicyBjaGFuZ2VkICcgKyBfdGhpcy5wMnBSZXF1ZXN0ZXJTdHViKTtcclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZS5rZXlwYXRoLnNwbGl0KCcuJylbMF0gPT09IHJlbW90ZVJ1bnRpbWUgJiYgY2hhbmdlLm5hbWUgPT09ICdzdGF0dXMnICYmIGNoYW5nZS5uZXdWYWx1ZSA9PT0gU1RBVFVTLkxJVkUpIHtcclxuICAgICAgICAgIGxvZy5sb2coJ1tSZWdpc3RyeS5fc2V0dXBQMlBDb25uZWN0aW9uXSBwMnBSZXF1ZXN0ZXIgaXMgbGl2ZSAnICsgX3RoaXMucDJwUmVxdWVzdGVyU3R1YltyZW1vdGVSdW50aW1lXSk7XHJcbiAgICAgICAgICByZXNvbHZlKF90aGlzLnAycFJlcXVlc3RlclN0dWJbcmVtb3RlUnVudGltZV0udXJsKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gIHN0dWIgbG9hZFxyXG4gICAgICBfdGhpcy5sb2FkZXIubG9hZFN0dWIoaW5wdXQucDJwUmVxdWVzdGVyLCBwMnBDb25maWcpLnRoZW4oKCkgPT4ge1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbUmVnaXN0cnkuX3NldHVwUDJQQ29ubmVjdGlvbl0gcDJwUmVxdWVzdGVyIGRlcGxveWVkOiAnLCBfdGhpcy5wMnBSZXF1ZXN0ZXJTdHViW3JlbW90ZVJ1bnRpbWVdKTtcclxuXHJcblxyXG4gICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBUbyB2ZXJpZnkgaWYgdXJsIGlzIGZvciBhIGxlZ2FjeSBzZXJ2aWNlLlxyXG4gICogQHBhcmFtICB7VVJMLlVSTH0gIHVybCAgICAgIHVybFxyXG4gICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAqL1xyXG4gIGlzTGVnYWN5KHVybCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIGlmICh1cmwgPT09IF90aGlzLl9kb21haW4pIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxvZy5sb2coJ1tSZWdpc3RyeV0gW1JlZ2lzdHJ5LlJlZ2lzdHJ5LmlzTGVnYWN5XSAnLCB1cmwpO1xyXG5cclxuICAgICAgLy8gVE9ETzogdG8gYmUgZGVmaW5lZCBpbiB0aGUgcnVudGltZSBjb25maWd1cmF0aW9uXHJcbiAgICAgIGxldCBub25MZWdhY3kgPSBbJ2h5cGVydHktcnVudGltZScsICdkb21haW4nLCAnZ2xvYmFsJywgJ2h5cGVydHknXTtcclxuXHJcbiAgICAgIGxldCB1cmxEaXZpZGVkID0gZGl2aWRlVVJMKHVybCk7XHJcblxyXG4gICAgICBpZiAobm9uTGVnYWN5LmluZGV4T2YodXJsRGl2aWRlZC50eXBlKSAhPT0gLTEgfHwgdXJsRGl2aWRlZC5kb21haW4gPT09IF90aGlzLl9kb21haW4pIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIHByb2Nlc3MgVXNlciBVUkxzXHJcbiAgICAgIGlmICh1cmwuc3BsaXQoJ0AnKS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgbGV0IGRvbWFpbiA9IHVybERpdmlkZWQuZG9tYWluO1xyXG5cclxuICAgICAgICAvLyBsb2cubG9nKCdbUmVnaXN0cnldIFtSZWdpc3RyeS5SZWdpc3RyeS5pc0xlZ2FjeV0gZG9tYWluOiAnLCBkb21haW4pO1xyXG4gICAgICAgIGlmIChfdGhpcy5pZHBMZWdhY3lQcm94eUxpc3QuaGFzT3duUHJvcGVydHkoZG9tYWluKSkge1xyXG5cclxuICAgICAgICAgIGxldCByZXN1bHQgPSBfdGhpcy5pZHBMZWdhY3lQcm94eUxpc3RbZG9tYWluXTtcclxuXHJcbiAgICAgICAgICBpZiAocmVzdWx0LmludGVyd29ya2luZykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXN1bHQuaW50ZXJ3b3JraW5nKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF90aGlzLl9sb2FkZXIuZGVzY3JpcHRvcnMuZ2V0SWRwUHJveHlEZXNjcmlwdG9yKGRvbWFpbikudGhlbigocmVzdWx0KSA9PiB7XHJcblxyXG4gICAgICAgICAgLy8gbG9nLmxvZygnW1JlZ2lzdHJ5XSBbUmVnaXN0cnkuUmVnaXN0cnkuaXNMZWdhY3ldIExlZ2FjeSBzdHViIGRlc2NyaXB0b3I6ICcsIHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgaWYgKHJlc3VsdC5pbnRlcndvcmtpbmcpIHtcclxuICAgICAgICAgICAgX3RoaXMuaWRwTGVnYWN5UHJveHlMaXN0W2RvbWFpbl0gPSByZXN1bHQ7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmludGVyd29ya2luZyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgbG9nLndhcm4oJ3Byb2JsZW0gbG9hZGluZyBpZHAgcHJveHkgZGVzY3JpcHRvciBmb3IgZG9tYWluOicsIGRvbWFpbiwgJyBiZWNhdXNlICcsIHJlYXNvbik7XHJcbiAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHsgLy8gcHJvY2VzcyBwcm90b3N0dWIgVVJMc1xyXG4gICAgICAgIHJlc29sdmUoX3RoaXMuaXNJbnRlcndvcmtpbmdQcm90b1N0dWIodXJsKSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBUbyB2ZXJpZnkgaWYgVVJMIGlzIGxvY2FsbHkgcmVnaXN0ZXJlZCBvciBub3QuXHJcbiAgKiBAcGFyYW0gIHtVUkwuVVJMfSAgdXJsICAgICAgdXJsXHJcbiAgKiBAcmV0dXJuIHtib29sZWFufVxyXG4gICovXHJcblxyXG4gIGlzTG9jYWwodXJsKSB7XHJcblxyXG4gICAgbGV0IHJ1bnRpbWVTY2hlbWUgPSBbJ2h5cGVydHktcnVudGltZScsICdydW50aW1lJ107XHJcbiAgICBsZXQgaHlwZXJ0eVNjaGVtZSA9IFsnaHlwZXJ0eSddO1xyXG4gICAgbGV0IHVybFNjaGVtZSA9IHVybC5zcGxpdCgnOi8vJylbMF07XHJcblxyXG4gICAgLy8gUHJvY2VzcyBSdW50aW1lIENvcmUgVVJMcy5cclxuICAgIC8vIE1lc3NhZ2VzIG9yaWdpbmF0ZWQgZnJvbSBwcm90b3N0dWJzIHNob3VsZCBhbHNvIG5vdCBpbmNsdWRlIHRoZSBydW50aW1lVVJMIGluIGl0cyBVUkwuXHJcblxyXG4gICAgaWYgKHJ1bnRpbWVTY2hlbWUuaW5kZXhPZih1cmxTY2hlbWUpICE9PSAtMSkge1xyXG4gICAgICByZXR1cm4gdXJsLmluY2x1ZGVzKHRoaXMucnVudGltZVVSTCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUHJvY2VzcyBIeXBlcnR5IFVSTHNcclxuICAgIC8vIFRvZG86IGh5cGVydGllc0xpc3Qgc2hvdWxkIGJlIGFuIG9iamVjdCBub3QgYW4gYXJyYXlcclxuXHJcbiAgICBpZiAoaHlwZXJ0eVNjaGVtZS5pbmRleE9mKHVybFNjaGVtZSkgIT09IC0xKSB7XHJcblxyXG4gICAgICBmb3IgKGxldCBpbmRleCBpbiB0aGlzLmh5cGVydGllc0xpc3QpIHtcclxuICAgICAgICBsZXQgaHlwZXJ0eSA9IHRoaXMuaHlwZXJ0aWVzTGlzdFtpbmRleF07XHJcbiAgICAgICAgaWYgKGh5cGVydHkuaHlwZXJ0eVVSTCA9PT0gdXJsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBQcm9jZXNzIERhdGEgT2JqZWN0IFVSTHNcclxuXHJcbiAgICBpZiAodXJsLmluY2x1ZGVzKCcvc3Vic2NyaXB0aW9uJykpIHtcclxuICAgICAgdXJsID0gdXJsLnN1YnN0cmluZygwLCB1cmwuaW5kZXhPZignL3N1YnNjcmlwdGlvbicpKTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZGF0YU9iamVjdCA9IHRoaXMuZGF0YU9iamVjdExpc3RbdXJsXTtcclxuXHJcbiAgICBpZiAoZGF0YU9iamVjdCkge1xyXG4gICAgICBpZiAoZGF0YU9iamVjdC5pbnRlcndvcmtpbmcpIHtcclxuICAgICAgICByZXR1cm4gIWRhdGFPYmplY3QuaW50ZXJ3b3JraW5nO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogVG8gdmVyaWZ5IGlmIHByb3Rvc3R1YiBpcyB0byBpbnRlcndvcmsgd2l0aCBhIGxlZ2FjeSBkb21haW4uXHJcbiAgKiBAcGFyYW0gIHtVUkwuVVJMfSAgcnVudGltZVByb3Rvc3R1YlVSTCAgICAgIFRoZSBydW50aW1lIFVSTCBvZiB0aGUgUHJvdG9zdHViXHJcbiAgKiBAcmV0dXJuIHtib29sZWFufVxyXG4gICovXHJcblxyXG4gIGlzSW50ZXJ3b3JraW5nUHJvdG9TdHViKHJ1bnRpbWVQcm90b3N0dWJVUkwpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGlmICh0eXBlb2YgcnVudGltZVByb3Rvc3R1YlVSTCA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIShydW50aW1lUHJvdG9zdHViVVJMLmluY2x1ZGVzKCcvcHJvdG9zdHViLycpKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGZpbHRlcmVkID0gT2JqZWN0LmtleXMoX3RoaXMucHJvdG9zdHVic0xpc3QpLmZpbHRlcigoa2V5KSA9PiB7XHJcbiAgICAgIHJldHVybiBfdGhpcy5wcm90b3N0dWJzTGlzdFtrZXldLnVybCA9PT0gcnVudGltZVByb3Rvc3R1YlVSTDtcclxuICAgIH0pLm1hcCgoa2V5KSA9PiB7XHJcblxyXG4gICAgICBpZiAoX3RoaXMucHJvdG9zdHVic0xpc3Rba2V5XS5oYXNPd25Qcm9wZXJ0eSgnaW50ZXJ3b3JraW5nJykpIHtcclxuICAgICAgICByZXR1cm4gX3RoaXMucHJvdG9zdHVic0xpc3Rba2V5XS5pbnRlcndvcmtpbmc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9KVswXTtcclxuXHJcbiAgICByZXR1cm4gZmlsdGVyZWQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBSZWdpc3RyeTtcclxuIiwiZXhwb3J0IGNvbnN0IHJ1bnRpbWVDb25maWd1cmF0aW9uID0ge1xyXG5cclxuICAvLyBUT0RPIHRoaXMgc2hvdWxkIGJlIGNoYW5nZWQgd2l0aCB0aGUgZGVmaW5pdGlvbiB1c2VkIGZvciBpbmRleGVkZGJcclxuICAvLyBsb29rIGF0OiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSURCT2JqZWN0U3RvcmVcclxuICAvLyBOb3cgd2UgYXJlIHVzaW5nIHRoZSBkZWZpbml0aW9uIGZvciBEZXhpZTsgKGh0dHA6Ly9kZXhpZS5vcmcvZG9jcy9WZXJzaW9uL1ZlcnNpb24uc3RvcmVzKCkpXHJcbiAgc3RvcmFnZVNjaGVtYXM6IHtcclxuICAgIGNhcGFiaWxpdGllczoge1xyXG4gICAgICBjYXBhYmlsaXRpZXM6ICdrZXksdmVyc2lvbix2YWx1ZSdcclxuICAgIH0sXHJcbiAgICBzdWJzY3JpcHRpb25zOiB7XHJcbiAgICAgIHN1YnNjcmlwdGlvbnM6ICdrZXksdmVyc2lvbix2YWx1ZSdcclxuICAgIH0sXHJcbiAgICBydW50aW1lOiB7XHJcbiAgICAgICdydW50aW1lOlVSTCc6ICdrZXksdmVyc2lvbix2YWx1ZScsXHJcbiAgICAgICdwMnBIYW5kbGVyOlVSTCc6ICdrZXksdmVyc2lvbix2YWx1ZSdcclxuICAgIH0sXHJcbiAgICByZWdpc3RyeToge1xyXG4gICAgICAncmVnaXN0cnk6RGF0YU9iamVjdFVSTHMnOiAna2V5LHZlcnNpb24sdmFsdWUnLFxyXG4gICAgICAncmVnaXN0cnk6SHlwZXJ0eVVSTHMnOiAna2V5LHZlcnNpb24sdmFsdWUnXHJcbiAgICB9LFxyXG4gICAgY3J5cHRvTWFuYWdlcjoge1xyXG4gICAgICB1c2VyQXN5bW1ldHJpY0tleTogJ2tleSx2ZXJzaW9uLHZhbHVlJyxcclxuICAgICAgZGF0YU9iamVjdFNlc3Npb25LZXlzOiAna2V5LHZlcnNpb24sdmFsdWUnXHJcbiAgICB9LFxyXG4gICAgaWRlbnRpdHk6IHtcclxuICAgICAgYWNjZXNzVG9rZW5zOiAna2V5LHZlcnNpb24sdmFsdWUnLFxyXG4gICAgICBpZGVudGl0aWVzOiAndXNlclVSTCwgdXNlclByb2ZpbGUuZW1haWwsIHVzZXJQcm9maWxlLnVzZXJVUkwsIHVzZXJQcm9maWxlLm5hbWUnXHJcbiAgICB9LFxyXG4gICAgcnVudGltZUNhdGFsb2d1ZToge1xyXG4gICAgICBydW50aW1lQ2F0YWxvZ3VlOiAnJmNndWlkLCBhY2Nlc3NDb250cm9sUG9saWN5LCBjb25zdHJhaW50cywgZGF0YU9iamVjdHMsIGh5cGVydHlUeXBlLCBvYmplY3ROYW1lLCBzb3VyY2VQYWNrYWdlLCB2ZXJzaW9uJ1xyXG4gICAgfSxcclxuICAgIHBvbGljeToge1xyXG4gICAgICAncmV0aGluazphY3RpdmVQb2xpY3knOiAna2V5LHZlcnNpb24sdmFsdWUnLFxyXG4gICAgICAncmV0aGluazpncm91cHMnOiAna2V5LHZlcnNpb24sdmFsdWUnLFxyXG4gICAgICAncmV0aGluazp1c2VyUG9saWNpZXMnOiAna2V5LHZlcnNpb24sdmFsdWUnLFxyXG4gICAgICAncmV0aGluazpzcFBvbGljaWVzJzogJ2tleSx2ZXJzaW9uLHZhbHVlJ1xyXG4gICAgfSxcclxuICAgIHN5bmNoZXJNYW5hZ2VyOiB7XHJcbiAgICAgICdzeW5jaGVyTWFuYWdlcjpPYmplY3RVUkxzJzogJ2tleSx2ZXJzaW9uLHZhbHVlJyxcclxuICAgICAgJ3JlbW90ZXMnOiAna2V5LHZlcnNpb24sdmFsdWUnXHJcbiAgICB9LFxyXG4gICAgaHlwZXJ0eVJlc291cmNlczoge1xyXG4gICAgICBoeXBlcnR5UmVzb3VyY2VzOiAnJnJlc291cmNlVVJMLCBuYW1lLCBjb250ZW50VXJsLCBjb250ZW50LCBjcmVhdGVkLCByZXBvcnRlciwgcmVzb3VyY2VUeXBlJ1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIHJ1bnRpbWVVUkxTOiB7XHJcbiAgICByZWdpc3RyeToge1xyXG4gICAgICBwcmVmaXg6ICdoeXBlcnR5LXJ1bnRpbWU6Ly8nLFxyXG4gICAgICBzdWZmaXg6ICdyZWdpc3RyeSdcclxuICAgIH0sXHJcbiAgICBpZGVudGl0eU1vZHVsZToge1xyXG4gICAgICBwcmVmaXg6ICdoeXBlcnR5LXJ1bnRpbWU6Ly8nLFxyXG4gICAgICBzdWZmaXg6ICcvaWRtJ1xyXG4gICAgfSxcclxuICAgIHJ1bnRpbWVVQToge1xyXG4gICAgICBwcmVmaXg6ICdoeXBlcnR5LXJ1bnRpbWU6Ly8nLFxyXG4gICAgICBzdWZmaXg6ICcvdWEnXHJcbiAgICB9LFxyXG4gICAgY2F0YWxvZ3VlOiB7XHJcbiAgICAgIHByZWZpeDogJ2h5cGVydHktcnVudGltZTovLycsXHJcbiAgICAgIHN1ZmZpeDogJy9jYXRhbG9ndWUnXHJcbiAgICB9LFxyXG4gICAgZ3JhcGhDb25uZWN0b3I6IHtcclxuICAgICAgcHJlZml4OiAnaHlwZXJ0eS1ydW50aW1lOi8vJyxcclxuICAgICAgc3VmZml4OiAnL2dyYXBoJ1xyXG4gICAgfSxcclxuICAgIHN5bmNNYW5hZ2VyOiB7XHJcbiAgICAgIHByZWZpeDogJ2h5cGVydHktcnVudGltZTovLycsXHJcbiAgICAgIHN1ZmZpeDogJy9zbSdcclxuICAgIH1cclxuICB9LFxyXG4gIGNhdGFsb2d1ZVVSTHM6IHtcclxuICAgIHByb3RvY29sc3R1Yjoge1xyXG4gICAgICBwcmVmaXg6ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nLFxyXG4gICAgICBzdWZmaXg6ICcvLndlbGwta25vd24vcHJvdG9jb2xzdHViLycsXHJcbiAgICAgIGZhbGxiYWNrOiAnaHlwZXJ0eS1jYXRhbG9ndWU6Ly9jYXRhbG9ndWUuJWRvbWFpbiUvLndlbGwta25vd24vcHJvdG9jb2xzdHViLydcclxuICAgIH0sXHJcbiAgICBpZHBQcm94eToge1xyXG4gICAgICBwcmVmaXg6ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nLFxyXG4gICAgICBzdWZmaXg6ICcvLndlbGwta25vd24vaWRwLXByb3h5LycsXHJcbiAgICAgIGZhbGxiYWNrOiAnaHlwZXJ0eS1jYXRhbG9ndWU6Ly9jYXRhbG9ndWUuJWRvbWFpbiUvLndlbGwta25vd24vaWRwLXByb3h5LydcclxuICAgIH1cclxuICB9LFxyXG4gIG1zZ05vZGVVUkw6IHtcclxuICAgIHByZWZpeDogJ2RvbWFpbjovL21zZy1ub2RlLicsXHJcbiAgICBzdWZmaXg6ICcnLFxyXG4gICAgaHlwZXJ0eUFkZHJlc3NBbGxvY2F0aW9uOiAnL2h5cGVydHktYWRkcmVzcy1hbGxvY2F0aW9uJyxcclxuICAgIG9iamVjdEFkZHJlc3NBbGxvY2F0aW9uOiAnL29iamVjdC1hZGRyZXNzLWFsbG9jYXRpb24nLFxyXG4gICAgc3Vic2NyaXB0aW9uTWFuYWdlbWVudDogJy9zbSdcclxuICB9LFxyXG4gIGRvbWFpblJlZ2lzdHJ5VVJMOiB7XHJcbiAgICBwcmVmaXg6ICdkb21haW46Ly9yZWdpc3RyeS4nLFxyXG4gICAgc3VmZml4OiAnJ1xyXG4gIH0sXHJcbiAgZ2xvYmFsUmVnaXN0cnlVUkw6ICdnbG9iYWw6Ly9yZWdpc3RyeS4nLFxyXG4gIHJlbW90ZVN0b3JhZ2U6ICdodHRwczovL2h5c21hcnQucmV0aGluay5wdGlub3ZhY2FvLnB0L2JhY2t1cC8nXHJcbn07XHJcbiIsIi8vIExvZyBTeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ0lkZW50aXR5TW9kdWxlJyk7XHJcblxyXG5pbXBvcnQgeyBkZWNvZGUsIHNlY29uZHNTaW5jZUVwb2NoLCBkZWVwQ2xvbmUgfSBmcm9tICcuLi91dGlscy91dGlscy5qcyc7XHJcbmltcG9ydCB7IFdhdGNoaW5nWW91IH0gZnJvbSAnLi4vVXRpbHMnO1xyXG5cclxuXHJcbi8qKlxyXG4qIFRoZSBJZGVudGl0eSBEYXRhIE1vZGVsIGlzIHVzZWQgdG8gbW9kZWwgdGhlIHJlVEhJTksgVXNlciBlbnRpdHkuIFRoZSBJZGVudGl0eSBkYXRhIG1vZGVsIGlzIGhhbmRsZWQgYnkgSWRlbnRpdHkgTWFuYWdlbWVudCBmdW5jdGlvbmFsaXR5LlxyXG4qXHJcbiovXHJcbmNsYXNzIElkZW50aXRpZXMge1xyXG5cclxuICBjb25zdHJ1Y3Rvcih0eXBlLCBzdG9yYWdlTWFuYWdlcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fd2F0Y2hpbmdZb3UgPSBuZXcgV2F0Y2hpbmdZb3UoKTtcclxuXHJcbiAgICBfdGhpcy5fc3RvcmFnZU1hbmFnZXIgPSBzdG9yYWdlTWFuYWdlcjtcclxuICAgIF90aGlzLl9ndWlkO1xyXG4gICAgX3RoaXMuX3R5cGUgPSB0eXBlO1xyXG4gICAgX3RoaXMuX2lkZW50aXRpZXMgPSB7fTtcclxuICAgIF90aGlzLl9hY2Nlc3NUb2tlbnMgPSBfdGhpcy53YXRjaGluZ1lvdS53YXRjaCgnYWNjZXNzVG9rZW5zJywge30sIHRydWUpO1xyXG5cclxuICB9XHJcblxyXG4gIHJlc2V0KCkge1xyXG4gICAgdGhpcy5faWRlbnRpdGllcyA9IHt9O1xyXG4gICAgY29uc29sZS5sb2codGhpcyk7XHJcbiAgICB0aGlzLmN1cnJlbnRJZGVudGl0eSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuZGVmYXVsdElkZW50aXR5ID0gdW5kZWZpbmVkO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGlkZW50aXRpZXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWRlbnRpdGllcztcclxuICB9XHJcblxyXG4gIGdldCBhY2Nlc3NUb2tlbnMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fYWNjZXNzVG9rZW5zO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHdhdGNoaW5nWW91KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3dhdGNoaW5nWW91O1xyXG4gIH1cclxuXHJcbiAgc2V0IGd1aWQoZ3VpZCkge1xyXG4gICAgdGhpcy5fZ3VpZCA9IGd1aWQ7XHJcbiAgfVxyXG5cclxuICBnZXQgZ3VpZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9ndWlkO1xyXG4gIH1cclxuXHJcbiAgc2V0IGRlZmF1bHRJZGVudGl0eShpZGVudGlmaWVyKSB7XHJcbiAgICBpZiAodGhpcy5pZGVudGl0aWVzW2lkZW50aWZpZXJdKSB0aGlzLl9kZWZhdWx0SWRlbnRpdHkgPSBpZGVudGlmaWVyO1xyXG4gICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ1tJZGVudGl0aWVzLnNldCBkZWZhdWx0SWRlbnRpdHkgXSBFcnJvcjogaWRlbnRpdHkgZG9lcyBub3QgZXhpc3QgaGVyZTogJywgaWRlbnRpZmllcik7XHJcbiAgfVxyXG5cclxuICBzZXQgY3VycmVudElkZW50aXR5KGlkZW50aWZpZXIpIHtcclxuICAgIGlmICh0aGlzLmlkZW50aXRpZXNbaWRlbnRpZmllcl0pIHRoaXMuX2N1cnJlbnRJZGVudGl0eSA9IGlkZW50aWZpZXI7XHJcbiAgICBlbHNlIHRocm93ICdbSWRlbnRpdGllcy5zZXQgY3VycmVudElkZW50aXR5IF0gRXJyb3I6IGlkZW50aXR5IGRvZXMgbm90IGV4aXN0IGhlcmU6ICcsIGlkZW50aWZpZXI7XHJcbiAgfVxyXG5cclxuICBnZXQgZGVmYXVsdElkZW50aXR5KCkge1xyXG4gICAgaWYgKHRoaXMuX2RlZmF1bHRJZGVudGl0eSkgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRoaXMuaWRlbnRpdGllc1t0aGlzLl9kZWZhdWx0SWRlbnRpdHldKTtcclxuICAgIGVsc2UgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGN1cnJlbnRJZGVudGl0eSgpIHtcclxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmlkZW50aXRpZXNbdGhpcy5fY3VycmVudElkZW50aXR5XSk7XHJcbiAgfVxyXG5cclxuICBnZXQgaWRlbnRpZmllcnMoKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5faWRlbnRpdGllcyk7XHJcbiAgfVxyXG5cclxuICBnZXRJZGVudGl0eShpZGVudGlmaWVyKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5faWRlbnRpdGllc1tpZGVudGlmaWVyXSk7XHJcbiAgfVxyXG5cclxuICBsb2FkSWRlbnRpdGllcygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHJcbiAgICAgIF90aGlzLl9zdG9yYWdlTWFuYWdlci5nZXQobnVsbCwgbnVsbCwgJ2lkZW50aXRpZXMnKS50aGVuKChpZGVudGl0aWVzKSA9PiB7XHJcblxyXG4gICAgICAgIGxvZy5pbmZvKCdbSWRlbnRpdGllcy5Mb2FkIElkZW50aXRpZXNdIGlkZW50aXRpZXM6ICcsIGlkZW50aXRpZXMpO1xyXG5cclxuICAgICAgICBpZiAoaWRlbnRpdGllcykge1xyXG4gICAgICAgICAgX3RoaXMuX2lkZW50aXRpZXMgPSBpZGVudGl0aWVzO1xyXG5cclxuICAgICAgICAgIC8vIGxldCdzIHNldCBhcyBkZWZhdWx0IGlkZW50aXR5IHRoZSBvbmUgdGhhdCBleHBpcmVzIGxhdGVyXHJcblxyXG4gICAgICAgICAgX3RoaXMuaWRlbnRpZmllcnMuZm9yRWFjaCgoaWQpID0+IHtcclxuICAgICAgICAgICAgbGV0IHRpbWVOb3cgPSBzZWNvbmRzU2luY2VFcG9jaCgpO1xyXG4gICAgICAgICAgICBsZXQgaWRlbnRpdHkgPSBfdGhpcy5faWRlbnRpdGllc1tpZF07XHJcbiAgICAgICAgICAgIGxldCBleHBpcmVzID0gaWRlbnRpdHkuZXhwaXJlcztcclxuXHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgaWYgKCFpZGVudGl0eS5oYXNPd25Qcm9wZXJ0eSgnaW50ZXJ3b3JraW5nJylcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICB8fCAhaWRlbnRpdHkuaW50ZXJ3b3JraW5nKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmRlZmF1bHRJZGVudGl0eSA9IGlkO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBhcnNlSW50KGV4cGlyZXMpID4gdGltZU5vdykge1xyXG4gICAgICAgICAgICAgIF90aGlzLmRlZmF1bHRJZGVudGl0eS5leHBpcmVzID0gcGFyc2VJbnQoZXhwaXJlcyk7XHJcbiAgICAgICAgICAgICAgX3RoaXMuY3VycmVudElkZW50aXR5ID0gaWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGxvYWRBY2Nlc3NUb2tlbnMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblxyXG4gICAgICBfdGhpcy5fc3RvcmFnZU1hbmFnZXIuZ2V0KCdhY2Nlc3NUb2tlbnMnKS50aGVuKChhY2Nlc3NUb2tlbnMpID0+IHtcclxuXHJcbiAgICAgICAgaWYgKGFjY2Vzc1Rva2VucykgX3RoaXMuX2FjY2Vzc1Rva2VucyA9IGFjY2Vzc1Rva2VucztcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyB0byBjb25maXJtIGlmIHRoaXMgZnVuY3Rpb24gaXMgcmVxdWlyZWQgd2hlbiB0aGUgQXBwIGNvbnN0cmFpbnRzIHRoZSBpZGVudGl0eSBzZWxlY3Rpb25cclxuXHJcbiAgYWRkSWRlbnRpdHkoaWRlbnRpdHkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgaWYgKF90aGlzLl9pc1ZhbGlkKGlkZW50aXR5KSkge1xyXG4gICAgICAgIGxldCBpZCA9IGlkZW50aXR5LmlkZW50aWZpZXJzWzBdO1xyXG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5faWRlbnRpdGllc1tpZF0sIGlkZW50aXR5KTtcclxuICAgICAgICB0aGlzLl9zdG9yZUlkZW50aXR5KGlkZW50aXR5KS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2lkZW50aXRpZXNbaWRdLnN0YXR1cyA9ICdjcmVhdGVkJztcclxuICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHsgcmVqZWN0KCdbSWRlbnRpdGllcy5hZGRJZGVudGl0eV0gaW52YWxpZCBJZEFzc2VydGlvbicpOyB9XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBhZGRBc3NlcnRpb24oYXNzZXJ0aW9uKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGlmIChfdGhpcy5faXNWYWxpZChhc3NlcnRpb24pKSB7XHJcbiAgICAgICAgYXNzZXJ0aW9uLnVzZXJQcm9maWxlLmd1aWQgPSBfdGhpcy5fZ3VpZDtcclxuICAgICAgICBsZXQgdXNlclVybCA9IGFzc2VydGlvbi51c2VyUHJvZmlsZS51c2VyVVJMO1xyXG4gICAgICAgIGlmICghX3RoaXMuaWRlbnRpdGllc1t1c2VyVXJsXSkgX3RoaXMuX2lkZW50aXRpZXNbdXNlclVybF0gPSBhc3NlcnRpb247XHJcbiAgICAgICAgZWxzZSBfdGhpcy5pZGVudGl0aWVzW3VzZXJVcmxdID0gYXNzZXJ0aW9uO1xyXG5cclxuICAgICAgICBfdGhpcy5fc3RvcmUoKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2lkZW50aXRpZXNbdXNlclVybF0uc3RhdHVzID0gJ2NyZWF0ZWQnO1xyXG4gICAgICAgICAgaWYgKF90aGlzLmRlZmF1bHRJZGVudGl0eSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBfdGhpcy5kZWZhdWx0SWRlbnRpdHkgPSB1c2VyVXJsO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmVzb2x2ZShhc3NlcnRpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2UgeyByZWplY3QoJ1tJZGVudGl0aWVzLmFkZEFzc2VydGlvbl0gaW52YWxpZCBJZEFzc2VydGlvbjogJywgYXNzZXJ0aW9uKTsgfVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgcmVtb3ZlSWRlbnRpdHkodXNlclVybCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgZGVsZXRlIF90aGlzLmlkZW50aXRpZXNbdXNlclVybF07XHJcblxyXG4gICAgICBfdGhpcy5fc3RvcmUoKS50aGVuKCgpID0+IHtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGFkZEFjY2Vzc1Rva2VuKGFjY2Vzc1Rva2VuKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbG9nLmluZm8oJ1tJZGVudGl0aWVzLmFkZEFjY2Vzc1Rva2VuXSAnLCBhY2Nlc3NUb2tlbik7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5faXNWYWxpZEFjY2Vzc1Rva2VuKGFjY2Vzc1Rva2VuKSkge1xyXG5cclxuICAgICAgICAvLyAgICAgICAgbGV0IG5ld0FjY2Vzc1Rva2VuID0gZGVlcENsb25lKGFjY2Vzc1Rva2VuKTtcclxuXHJcbiAgICAgICAgX3RoaXMuX2FjY2Vzc1Rva2Vuc1thY2Nlc3NUb2tlbi5kb21haW5dID0gYWNjZXNzVG9rZW47XHJcblxyXG4gICAgICAgIF90aGlzLl9zdG9yZUFjY2Vzc1Rva2VucygpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgX3RoaXMuX2FjY2Vzc1Rva2Vuc1thY2Nlc3NUb2tlbi5kb21haW5dLnN0YXR1cyA9ICdjcmVhdGVkJztcclxuICAgICAgICAgIHJlc29sdmUoYWNjZXNzVG9rZW4pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2UgeyByZWplY3QoJ1tJZGVudGl0aWVzLmFkZElkZW50aXR5XSBpbnZhbGlkIEFjY2Vzc1Rva2VuOiAnLCBhY2Nlc3NUb2tlbik7IH1cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIHNldEFjY2Vzc1Rva2VuSW5Qcm9ncmVzcyhkb21haW4pIHtcclxuXHJcbiAgICBpZiAodGhpcy5fYWNjZXNzVG9rZW5zW2RvbWFpbl0pIHRoaXMuX2FjY2Vzc1Rva2Vuc1tkb21haW5dLnN0YXR1cyA9ICdpbi1wcm9ncmVzcyc7XHJcbiAgICBlbHNlIHRoaXMuX2FjY2Vzc1Rva2Vuc1tkb21haW5dID0geyBzdGF0dXM6ICdpbi1wcm9ncmVzcycgfTtcclxuICB9XHJcblxyXG4gIGdldEFjY2Vzc1Rva2VuKGRvbWFpbiwgcmVzb3VyY2VzKSB7XHJcbiAgICBsZXQgYWNjZXNzVG9rZW4gPSB0aGlzLl9hY2Nlc3NUb2tlbnNbZG9tYWluXTtcclxuXHJcbiAgICBpZiAoIWFjY2Vzc1Rva2VuKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSBpZiAoXHJcbiAgICAgIHJlc291cmNlcy5ldmVyeSgoaSkgPT4geyByZXR1cm4gYWNjZXNzVG9rZW4ucmVzb3VyY2VzLmluZGV4T2YoaSkgIT0gLTE7IH0pKSB7IHJldHVybiB0aGlzLl9hY2Nlc3NUb2tlbnNbZG9tYWluXTsgfSBlbHNlIHsgcmV0dXJuIG5ldyBFcnJvcignW0lkZW50aXRpZXMuZ2V0QWNjZXNzVG9rZW5dIE5vdCBmb3VuZCBmb3IgJywgZG9tYWluKTsgfVxyXG5cclxuICB9XHJcblxyXG4gIHVwZGF0ZUFzc2VydGlvbihhc3NlcnRpb24pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgIGxldCB1c2VyVXJsID0gYXNzZXJ0aW9uLnVzZXJQcm9maWxlLnVzZXJVUkw7XHJcblxyXG4gICAgICBpZiAoIV90aGlzLmlkZW50aXRpZXNbdXNlclVybF0pIHsgcmV0dXJuIHJlamVjdCgnW0lkZW50aXRpZXMudXBkYXRlQXNzZXJ0aW9uXSBJZGVudGl0eSBub3QgZm91bmQgZm9yICcsIHVzZXJVcmwpOyB9IGVsc2Uge1xyXG4gICAgICAgIF90aGlzLmlkZW50aXRpZXNbdXNlclVybF0gPSBhc3NlcnRpb247XHJcbiAgICAgICAgX3RoaXMuX3N0b3JlKCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICB1cGRhdGVBY2Nlc3NUb2tlbihhY2Nlc3NUb2tlbikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxvZy5pbmZvKCdbSWRlbnRpdGllcy51cGRhdGVBY2Nlc3NUb2tlbl0gJywgYWNjZXNzVG9rZW4pO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBpZiAoX3RoaXMuX2lzVmFsaWRBY2Nlc3NUb2tlbihhY2Nlc3NUb2tlbikpIHtcclxuXHJcbiAgICAgICAgX3RoaXMuX2FjY2Vzc1Rva2Vuc1thY2Nlc3NUb2tlbi5kb21haW5dLmV4cGlyZXMgPSBhY2Nlc3NUb2tlbi5leHBpcmVzO1xyXG4gICAgICAgIF90aGlzLl9hY2Nlc3NUb2tlbnNbYWNjZXNzVG9rZW4uZG9tYWluXS5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuLmFjY2Vzc1Rva2VuO1xyXG5cclxuICAgICAgICBfdGhpcy5fc3RvcmVBY2Nlc3NUb2tlbnMoKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIF90aGlzLl9hY2Nlc3NUb2tlbnNbYWNjZXNzVG9rZW4uZG9tYWluXS5zdGF0dXMgPSAnY3JlYXRlZCc7XHJcbiAgICAgICAgICByZXNvbHZlKGFjY2Vzc1Rva2VuKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHsgcmVqZWN0KCdbSWRlbnRpdGllcy51cGRhdGVBY2Nlc3NUb2tlbl0gaW52YWxpZCBBY2Nlc3NUb2tlbjogJywgYWNjZXNzVG9rZW4pOyB9XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBhZGRJZEFzc2VydGlvbihpZGVudGlmaWVyLCBhc3NlcnRpb24sIGlkcCwgc2NvcGUpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IG5ld0lkQXNzZXJ0aW9uID0gbmV3IElkQXNzZXJ0aW9uKGFzc2VydGlvbiwgaWRwLCBzY29wZSk7XHJcblxyXG4gICAgX3RoaXMuaWRBc3NlcnRpb25MaXN0LnB1c2gobmV3SWRBc3NlcnRpb24pO1xyXG4gIH1cclxuXHJcbiAgLy9UT0RPOiBjb21wbGV0ZSB3aXRoIG1vcmUgdmVyaWZpY2F0aW9ucy4gVG8gYmUgbW92ZWQgdG8gSWRlbnRpdHk/XHJcblxyXG4gIF9pc1ZhbGlkKGlkZW50aXR5KSB7XHJcbiAgICBpZiAoIWlkZW50aXR5Lmhhc093blByb3BlcnR5KCdhc3NlcnRpb24nKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHNwbGl0ZWRBc3NlcnRpb24gPSBpZGVudGl0eS5hc3NlcnRpb24uc3BsaXQoJy4nKTtcclxuICAgIGxldCBhc3NlcnRpb25QYXJzZWQ7XHJcblxyXG4gICAgLy92ZXJpZnkgaWYgdGhlIHRva2VuIGNvbnRhaW5zIHRoZSAzIGNvbXBvbmVudHMsIG9yIGp1c3QgdGhlIGFzc2VydGlvblxyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKHNwbGl0ZWRBc3NlcnRpb25bMV0pIHtcclxuICAgICAgICBhc3NlcnRpb25QYXJzZWQgPSBkZWNvZGUoc3BsaXRlZEFzc2VydGlvblsxXSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXNzZXJ0aW9uUGFyc2VkID0gZGVjb2RlKGlkZW50aXR5LmFzc2VydGlvbik7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG5cclxuICB9XHJcblxyXG4gIF9pc1ZhbGlkQWNjZXNzVG9rZW4oYWNjZXNzVG9rZW4pIHtcclxuXHJcbiAgICBpZiAoIWFjY2Vzc1Rva2VuLmhhc093blByb3BlcnR5KCdhY2Nlc3NUb2tlbicpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWFjY2Vzc1Rva2VuLmhhc093blByb3BlcnR5KCdkb21haW4nKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCEoYWNjZXNzVG9rZW4uaGFzT3duUHJvcGVydHkoJ3Jlc291cmNlcycpICYmIEFycmF5LmlzQXJyYXkoYWNjZXNzVG9rZW4ucmVzb3VyY2VzKSkpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBpZiAoIShhY2Nlc3NUb2tlbi5oYXNPd25Qcm9wZXJ0eSgnZXhwaXJlcycpICYmIE51bWJlci5pc0ludGVnZXIoYWNjZXNzVG9rZW4uZXhwaXJlcykpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWFjY2Vzc1Rva2VuLmhhc093blByb3BlcnR5KCdpbnB1dCcpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgfVxyXG5cclxuICAvL1RPRE86IGFkZCBmdW5jdGlvbiB0byBvbmx5IHNldCBvbmUgbmV3IGlkZW50aXR5IHVzaW5nIHRoZSBuZXcgaW5kZXhlZCBzdG9yYWdlIG1hbmFnZXJcclxuXHJcbiAgX3N0b3JlKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgY29uc3Qgc3RvcmUgPSBPYmplY3Qua2V5cyh0aGlzLl9pZGVudGl0aWVzKS5tYXAoKHVzZXJVUkwpID0+IHtcclxuICAgICAgICByZXR1cm4gX3RoaXMuX3N0b3JhZ2VNYW5hZ2VyLnNldCh1c2VyVVJMLCAwLCB0aGlzLl9pZGVudGl0aWVzW3VzZXJVUkxdLCAnaWRlbnRpdGllcycpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIFByb21pc2UuYWxsKHN0b3JlKS50aGVuKCgpID0+IHtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH0pLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgcmVqZWN0KCdPbiBfc2VuZFJlcG9ydGVyU2Vzc2lvbktleSBmcm9tIG1ldGhvZCBzdG9yZUlkZW50aXR5IGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIF9zdG9yZUFjY2Vzc1Rva2VucygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIGxldCBhY2Nlc3NUb2tlbnMgPSBkZWVwQ2xvbmUoX3RoaXMuX2FjY2Vzc1Rva2Vucyk7XHJcblxyXG4gICAgICBfdGhpcy5fc3RvcmFnZU1hbmFnZXIuc2V0KCdhY2Nlc3NUb2tlbnMnLCAwLCBhY2Nlc3NUb2tlbnMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgfSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICByZWplY3QoJ09uIF9zZW5kUmVwb3J0ZXJTZXNzaW9uS2V5IGZyb20gbWV0aG9kIHN0b3JlSWRlbnRpdHkgZXJyb3I6ICcgKyBlcnIpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59XHJcblxyXG4vLyBtb3ZlIHRvIElkZW50aXR5IHNlcnZpY2UgZnJhbWV3b3JrP1xyXG5cclxuY2xhc3MgSWRBc3NlcnRpb24ge1xyXG5cclxuICBjb25zdHJ1Y3Rvcihhc3NlcnRpb24sIGlkcCwgdXNlclByb2ZpbGUpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX2Fzc2VydGlvbiA9IGFzc2VydGlvbjtcclxuICAgIF90aGlzLl9pZHAgPSBpZHA7XHJcbiAgICBfdGhpcy5fdXNlclByb2ZpbGUgPSB1c2VyUHJvZmlsZTtcclxuICB9XHJcblxyXG4gIGdldCBhc3NlcnRpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fYXNzZXJ0aW9uO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGlkcCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZHA7XHJcbiAgfVxyXG5cclxuICBnZXQgdXNlclByb2ZpbGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdXNlclByb2ZpbGU7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuY2xhc3MgSWRWYWxpZGF0aW9uIHtcclxuXHJcbiAgY29uc3RydWN0b3IoaWRlbnRpdHksIGNvbnRlbnRzKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuaWRlbnRpdHkgPSBpZGVudGl0eTtcclxuICAgIF90aGlzLmNvbnRlbnRzID0gY29udGVudHM7XHJcbiAgfVxyXG5cclxuICB2YWxpZGF0ZXMoaWRlbnRpdHksIGNvbnRlbnRzKSB7XHJcbiAgICAvL1RPRE8gaW1wbGVtZW50IHRoZSBsb2dpY1xyXG5cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IElkZW50aXRpZXM7XHJcbiIsIi8vIExvZyBTeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ0lkZW50aXR5TW9kdWxlJyk7XHJcblxyXG4vKipcclxuKiBmYWtlIGNsYXNzIGZvciB0aGUgZ3VpIHRvIHNlbGVjdCB0aGUgaWRlbnRpdHksXHJcbiogVE9ETyByZXBsYWNlIHdpdGggdGhlIHByb3BlciBpZGVudGl0eSBHVUlcclxuKlxyXG4qL1xyXG5jbGFzcyBHdWlGYWtlIHtcclxuXHJcbiAgY29uc3RydWN0b3IodXJsLCBtZXNzYWdlQnVzKSB7XHJcbiAgICBsb2cubG9nKCdGYWtlR1VJX2RlcGxveWVkJyk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl91cmwgPSB1cmw7XHJcbiAgICBfdGhpcy5fd2FpdFRpbWUgPSAxMDAwMDtcclxuICAgIF90aGlzLl9tZXNzYWdlQnVzID0gbWVzc2FnZUJ1cztcclxuXHJcbiAgICBfdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsLCBtc2cgPT4ge1xyXG5cclxuICAgICAgaWYgKG1zZy5oYXNPd25Qcm9wZXJ0eSgndHlwZScpICYmXHJcbiAgICAgICAgICBtc2cudHlwZSA9PT0gJ2NyZWF0ZScgJiZcclxuICAgICAgICAgIG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCd2YWx1ZScpICYmXHJcbiAgICAgICAgICBtc2cuYm9keS52YWx1ZS5oYXNPd25Qcm9wZXJ0eSgnaWRlbnRpdGllcycpICYmXHJcbiAgICAgICAgICBtc2cuYm9keS52YWx1ZS5oYXNPd25Qcm9wZXJ0eSgnaWRwcycpKSB7XHJcblxyXG4gICAgICAgIGxldCBpZGVudGl0aWVzID0gbXNnLmJvZHkudmFsdWUuaWRlbnRpdGllcztcclxuICAgICAgICBsZXQgaWRwcyA9IG1zZy5ib2R5LnZhbHVlLmlkcHM7XHJcblxyXG4gICAgICAgIGxldCB2YWx1ZTtcclxuXHJcbiAgICAgICAgaWYgKGlkZW50aXRpZXNbMF0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgdmFsdWUgPSB7dHlwZTogJ2lkZW50aXR5JywgdmFsdWU6IGlkZW50aXRpZXNbMF0sIGNvZGU6IDIwMH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZhbHVlID0ge3R5cGU6ICdpZHAnLCB2YWx1ZTogaWRwc1syXS5kb21haW4sIGNvZGU6IDIwMH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgcmVwbHlNc2cgPSB7aWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8sIGJvZHk6IHZhbHVlfTtcclxuXHJcbiAgICAgICAgLy8gdG8gdGVzdCBvbiB0aGUgaWRlbnRpdHkgc2lkZSB0aGUgbGlzdGVuZXIgd2l0aG91dCB0aGUgdGltZW91dFxyXG4gICAgICAgIC8vIGNhbiByZXByZXNlbnQgdGhlIHRpbWUgdGhlIHVzZXIgdGFrZXMgdG8gY2hvb3NlIGFuZCBpZGVudGl0eVxyXG4gICAgICAgIGlmIChtc2cuYm9keS52YWx1ZSA9PT0gJ3dhaXQnKSB7XHJcblxyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcclxuICAgICAgICAgIH0sIF90aGlzLl93YWl0VGltZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbG9nLmxvZygnSWdub3JpbmcgbWVzc2FnZXMgbm90IGludGVuZGVkIHRvIEZha2VHVUkuJywgbXNnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgR3VpRmFrZTtcclxuIiwiLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignSWRlbnRpdHlNb2R1bGUnKTtcclxuXHJcbmltcG9ydCB7IHNlY29uZHNTaW5jZUVwb2NoLCBkaXZpZGVVUkwsIHBhcnNlTWVzc2FnZVVSTCwgc3RyaW5naWZ5LCBkZWVwQ2xvbmUgfSBmcm9tICcuLi91dGlscy91dGlscy5qcyc7XHJcbmltcG9ydCB7IHJ1bnRpbWVDb25maWd1cmF0aW9uIH0gZnJvbSAnLi4vcnVudGltZS9ydW50aW1lQ29uZmlndXJhdGlvbic7XHJcblxyXG5pbXBvcnQgSWRlbnRpdGllcyBmcm9tICcuL0lkZW50aXRpZXMnO1xyXG5pbXBvcnQgR3VpRmFrZSBmcm9tICcuL0d1aUZha2UnO1xyXG5cclxuLyoqXHJcbipcclxuKiBUaGUgSWRlbnRpdHkgTW9kdWxlIChJZCBNb2R1bGUpIGlzIHRoZSBjb21wb25lbnQgcmVzcG9uc2libGUgZm9yIGhhbmRsaW5nIHRoZVxyXG4qIHVzZXIgaWRlbnRpdHkgYW5kIHRoZSBhc3NvY2lhdGlvbiBvZiB0aGlzIGlkZW50aXR5IHdpdGggdGhlIEh5cGVydHkgaW5zdGFuY2VzLFxyXG4qIGluIG9yZGVyIHRvIG1ha2UgSHlwZXJ0eSBpbnN0YW5jZXMgaWRlbnRpZmlhYmxlLiBUaGUgaWRlbnRpdHkgaW4gdGhlIHJlVEhJTksgcHJvamVjdFxyXG4qIGlzIG5vdCBmaXhlZCB0byBhIHVuaXF1ZSBJZGVudGl0eSBTZXJ2aWNlIFByb3ZpZGVyLCBidXQgb2J0YWluZWQgdGhyb3VnaCBzZXZlcmFsXHJcbiogZGlmZmVyZW50IElkZW50aXR5IHNvdXJjZXMuIFdpdGggdGhpcyBhcHByb2FjaCwgdGhlIElkIE1vZHVsZSBwcm92aWRlcyB0byB0aGUgdXNlciB0aGVcclxuKiBvcHRpb24gdG8gY2hvb3NlIHRoZSBwcmVmZXJyZWQgbWV0aG9kIGZvciBhdXRoZW50aWNhdGlvbi5cclxuKiBUaGlzIG1vZHVsZSB3aWxsIHRodXMgYWJsZSB0byBzdXBwb3J0IG11bHRpcGxlIElkZW50aXR5IGFjcXVpc2l0aW9uIG1ldGhvZHMsXHJcbiogc3VjaCBhcyBPcGVuSUQgY29ubmVjdCAxLjAsIEtlcmJlcm9zIFN5c3RlbSwgb3IgYXV0aGVudGljYXRpb24gdGhyb3VnaCBzbWFydCBjYXJkcy5cclxuKiBGb3IgZXhhbXBsZSwgYSB1c2VyIHdpdGggYSBHb29nbGUgYWNjb3VudCBjYW4gdXNlIHRoZSBHb29nbGUgYXMgYW4gSWRlbnRpdHkgUHJvdmlkZXIgdG8gcHJvdmlkZSBJZGVudGl0eSBUb2tlbnMsXHJcbiogIHdoaWNoIGNhbiBiZSB1c2VkIGJ5IHRoZSBJZGVudGl0eSBNb2R1bGUgdG8gYXNzb2NpYXRlIGl0IHdpdGggYSBIeXBlcnR5IGluc3RhbmNlLlxyXG4qXHJcbiogVGhlIElkZW50aXR5IE1vZHVsZSB1c2VzIGEgbm9kZSBwYWNrYWdlLCB0aGUgSGVsbG9KUywgd2hpY2ggaXMgYSBjbGllbnQtc2lkZSBKYXZhU2NyaXB0IEFQSSBmb3IgYXV0aGVudGljYXRpb25cclxuKiB0aGF0IGZhY2lsaXRhdGVzIHRoZSByZXF1ZXN0cyBmb3IgdGhlIE9wZW5JRCBjb25uZWN0IHByb3RvY29sLiBUaGlzIG1ldGhvZCBhbGxvd3MgZm9yIHNvbWUgYWJzdHJhY3Rpb25cclxuKiB3aGVuIG1ha2luZyByZXF1ZXN0cyBmb3IgZGlmZmVyZW50IElkZW50aXR5IFByb3ZpZGVycywgc3VjaCBhcyBPcGVuSUQgY29ubmVjdCB1c2VkIGJ5IEdvb2dsZSwgRmFjZWJvb2ssIE1pY3Jvc29mdCwgZm9yIGV4YW1wbGUuXHJcbipcclxuKiBXaGVuIGEgcmVxdWVzdCBmb3IgYSB1c2VyIGlkZW50aXR5IGlzIG1hZGUgdXNpbmcgdGhlIG1ldGhvZCBsb2dpbldpdGhSUChpZGVudGlmaWVyLCBzY29wZSksXHJcbiogdGhpcyBtZXRob2Qgd2lsbCBhbmFseXNlIHRoZSBJZGVudGl0eSBQcm92aWRlciBjaG9zZW4gdG8gb2J0YWluIGFuIGlkZW50aXR5IGFuZCB3aWxsIHVzZSB0aGUgSGVsbG9KUyBub2RlIHBhY2thZ2VcclxuKiB3aXRoIHRoZSBzZWxlY3RlZCBJZGVudGl0eSBQcm92aWRlciBhbmQgaWRlbnRpdHkgc2NvcGUuIEFmdGVyIHRoZSBIZWxsb0pTIHJlcXVlc3QgZm9yIGFuIEFjY2VzcyBUb2tlblxyXG4qIHRvIHRoZSBJZGVudGl0eSBQcm92aWRlcnMsIHRoZSB1c2VyIHdpbGwgYmUgcHJvbXB0ZWQgdG8gYXV0aGVudGljYXRlIHRvd2FyZHMgdGhlIElkZW50aXR5IFByb3ZpZGVyLlxyXG4qIFVwb24gcmVjZWl2aW5nIHRoZSBBY2Nlc3MgVG9rZW4sIHRoaXMgdG9rZW4gaXMgdmFsaWRhdGVkIHdpdGggYSBSRVNUZnVsIHdlYiBzZXJ2aWNlIHJlcXVlc3QgdG8gYW4gZW5kcG9pbnRcclxuKiBvbiB0aGUgSWRlbnRpdHkgUHJvdmlkZXIgQXV0aG9yaXphdGlvbiBTZXJ2ZXIsIGFuZCBhZnRlciB0aGUgdmFsaWRhdGlvbiBpcyBkb25lLFxyXG4qIGFuIElEIHRva2VuIGlzIG9idGFpbmVkIHdpdGggdGhlIGluZm9ybWF0aW9uIGFjY29yZGluZyB0byB0aGUgc2NvcGUgcmVxdWlyZWQuXHJcbiogVGhpcyBJRCB0b2tlbiBpcyB0aGVuIHByZXNlcnZlZCBpbiB0aGlzIG1vZHVsZSB0aGF0IGNhbiBvYnRhaW5lZCB0aHJvdWdoIHRoZSBnZXRJZGVudGl0aWVzKClcclxuKiBhbmQgaXMgcGFzc2VkIGFzIHJldHVybiB2YWx1ZSBvZiB0aGUgbG9naW5XaXRoUlAgZnVuY3Rpb24uIFRoZSBtZXRob2RzIGdlbmVyYXRlQXNzZXJ0aW9uIGFuZCB2YWxpZGF0ZUFzc2VydGlvbiBoYXZlIG5vdCB5ZXQgYmVlbiBkZXZlbG9wZWQuXHJcbipcclxuKi9cclxuY2xhc3MgSWRlbnRpdHlNb2R1bGUge1xyXG5cclxuICAvKipcclxuICAqIFRoaXMgaXMgdGhlIGNvbnN0cnVjdG9yIHRvIGluaXRpYWxpc2UgdGhlIElkZW50aXR5IE1vZHVsZSBpdCBkb2VzIG5vdCByZXF1aXJlIGFueSBpbnB1dC5cclxuICAqL1xyXG4gIGNvbnN0cnVjdG9yKHJ1bnRpbWVVUkwsIHJ1bnRpbWVDYXBhYmlsaXRpZXMsIHN0b3JhZ2VNYW5hZ2VyLCBkYXRhT2JqZWN0c1N0b3JhZ2UsIGNyeXB0b01hbmFnZXIsIHJ1bnRpbWVDYXRhbG9ndWUpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgaWYgKCFydW50aW1lVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ3J1bnRpbWVVUkwgaXMgbWlzc2luZy4nKTtcclxuICAgIGlmICghc3RvcmFnZU1hbmFnZXIpIHRocm93IG5ldyBFcnJvcignc3RvcmFnZU1hbmFnZXIgaXMgbWlzc2luZycpO1xyXG4gICAgaWYgKCFjcnlwdG9NYW5hZ2VyKSB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0b01hbmFnZXIgaXMgbWlzc2luZycpO1xyXG4gICAgaWYgKCFydW50aW1lQ2F0YWxvZ3VlKSB0aHJvdyBuZXcgRXJyb3IoJ3J1bnRpbWVDYXRhbG9ndWUgaXMgbWlzc2luZycpO1xyXG5cclxuICAgIF90aGlzLl9ydW50aW1lVVJMID0gcnVudGltZVVSTDtcclxuXHJcbiAgICBfdGhpcy5fcnVudGltZUNhdGFsb2d1ZSA9IHJ1bnRpbWVDYXRhbG9ndWU7XHJcblxyXG4gICAgX3RoaXMuZGF0YU9iamVjdHNTdG9yYWdlID0gZGF0YU9iamVjdHNTdG9yYWdlO1xyXG4gICAgX3RoaXMuX2lkbVVSTCA9IF90aGlzLl9ydW50aW1lVVJMICsgJy9pZG0nO1xyXG4gICAgX3RoaXMuX2d1aVVSTCA9IF90aGlzLl9ydW50aW1lVVJMICsgJy9pZGVudGl0eS1ndWknO1xyXG4gICAgX3RoaXMucnVudGltZUNhcGFiaWxpdGllcyA9IHJ1bnRpbWVDYXBhYmlsaXRpZXM7XHJcblxyXG4gICAgX3RoaXMuX2RvbWFpbiA9IGRpdmlkZVVSTChfdGhpcy5fcnVudGltZVVSTCkuZG9tYWluO1xyXG5cclxuXHJcbiAgICAvL3RvIHN0b3JlIGl0ZW1zIHdpdGggdGhpcyBmb3JtYXQ6IHtpZGVudGl0eTogaWRlbnRpdHlVUkwsIHRva2VuOiB0b2tlbklEfVxyXG4gICAgX3RoaXMuX2lkZW50aXRpZXMgPSBuZXcgSWRlbnRpdGllcygnaHVtYW4nLCBzdG9yYWdlTWFuYWdlcik7XHJcblxyXG4gICAgLy8gdG8gYmUgcmV2aWV3ZWQ6IHdhdGNoaW5nWW91IGlkZW50aXRpZXNMaXN0IG9yIGlkZW50aXRpZXM/XHJcbiAgICAvLyAgICBfdGhpcy5pZGVudGl0aWVzTGlzdCA9IF90aGlzLndhdGNoaW5nWW91LndhdGNoKCdpZGVudGl0aWVzTGlzdCcsIHt9LCB0cnVlKTtcclxuICAgIF90aGlzLl9jcnlwdG8gPSBjcnlwdG9NYW5hZ2VyO1xyXG5cclxuICAgIC8qICAgIF90aGlzLmVtYWlsc0xpc3QgPSBbXTtcclxuICAgIGxldCBuZXdJZGVudGl0eSA9IG5ldyBJZGVudGl0eSgnZ3VpZCcsICdIVU1BTicpO1xyXG4gICAgX3RoaXMuaWRlbnRpdHkgPSBuZXdJZGVudGl0eTtcclxuICAgIF90aGlzLmN1cnJlbnRJZGVudGl0eTtcclxuICAgIF90aGlzLmlkZW50aXRpZXMuZGVmYXVsdElkZW50aXR5OyovXHJcblxyXG4gICAgLy9zdG9yZXMgdGhlIGFzc29jaWF0aW9uIG9mIHRoZSBkYXRhT2JqZWN0IGFuZCB0aGUgSHlwZXJ0eSByZWdpc3RlcmVkIHdpdGhpblxyXG4gICAgX3RoaXMuZGF0YU9iamVjdHNJZGVudGl0eSA9IHt9OyAvLyBpcyB0aGlzIG5lZWRlZD9cclxuXHJcbiAgICBfdGhpcy5fbGlzdE9mSWRwcyA9IFtdO1xyXG5cclxuICAgIC8vIHZhcmlhYmxlIHRvIGtub3cgaWYgdGhlIEdVSSBpcyBkZXBsb3llZCB0byBjaG9vc2UgdGhlIGlkZW50aXR5LiBpZiB0aGUgcmVhbCBHVUkgaXMgbm90IGRlcGxveWVkLCBhIGZha2UgZ3VpIGlzIGRlcGxveWVkIGluc3RlYWQuXHJcbiAgICBfdGhpcy5ndWlEZXBsb3llZCA9IGZhbHNlO1xyXG5cclxuICB9XHJcblxyXG4gIC8vKioqKioqKioqKioqKioqKioqKiBHRVQgQU5EIFNFVCBNRVRIT0RTICoqKioqKioqKioqKioqKioqKipcclxuXHJcbiAgLyoqXHJcbiAgKiByZXR1cm4gdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeVxyXG4gICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1c1xyXG4gICovXHJcbiAgZ2V0IG1lc3NhZ2VCdXMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9tZXNzYWdlQnVzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBTZXQgdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeVxyXG4gICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1c1xyXG4gICovXHJcbiAgc2V0IG1lc3NhZ2VCdXMobWVzc2FnZUJ1cykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9tZXNzYWdlQnVzID0gbWVzc2FnZUJ1cztcclxuICAgIF90aGlzLmFkZEdVSUxpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiByZXR1cm4gdGhlIGNvcmVEaXNjb3ZlcnkgY29tcG9uZW50XHJcbiAgKiBkbyB3ZSBuZWVkIHRoaXM/P1xyXG4gICovXHJcbiAgZ2V0IGNvcmVEaXNjb3ZlcnkoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9jb3JlRGlzY292ZXJ5O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBTZXQgdGhlIGNvcmVEaXNjb3ZlcnkgY29tcG9uZW50XHJcbiAgKiBAcGFyYW0ge2NvcmVEaXNjb3Zlcnl9IGNvcmVEaXNjb3ZlcnlcclxuICAqL1xyXG4gIHNldCBjb3JlRGlzY292ZXJ5KGNvcmVEaXNjb3ZlcnkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fY29yZURpc2NvdmVyeSA9IGNvcmVEaXNjb3Zlcnk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIHJldHVybiB0aGUgcmVnaXN0cnkgaW4gdGhpcyBpZE1vZHVsZVxyXG4gICogQHBhcmFtIHtyZWdpc3RyeX0gICAgICAgICAgIHJlZ2lzdHJ5XHJcbiAgKi9cclxuICBnZXQgcmVnaXN0cnkoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9yZWdpc3RyeTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogU2V0IHRoZSByZWdpc3RyeSBpbiB0aGlzIGlkTW9kdWxlXHJcbiAgKiBAcGFyYW0ge3JlZ2lzdHJ5fSAgICAgcmVnXHJcbiAgKi9cclxuICBzZXQgcmVnaXN0cnkocmVnaXN0cnkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fcmVnaXN0cnkgPSByZWdpc3RyeTtcclxuICB9XHJcblxyXG5cclxuICAvLyoqKioqKioqKioqKioqKioqKiogSURFTlRJVFkgUkVMRUFURUQgTUVUSE9EUyAqKioqKioqKioqKioqKioqKioqXHJcbiAgLyoqXHJcbiAgKiBnZXRzIGFsbCB0aGUgaW5mb3JtYXRpb24gZnJvbSBhIGdpdmVuIHVzZXJVUkxcclxuICAqIEBwYXJhbSAge1N0cmluZ30gIHVzZXJVUkwgICAgIHVzZXIgdXJsXHJcbiAgKiBAcmV0dXJuIHtKU09OfSAgICBpZGVudGl0eSAgICBpZGVudGl0eSBidW5kbGUgZnJvbSB0aGUgdXNlclVSTFxyXG4gICovXHJcbiAgZ2V0SWRlbnRpdHkodXNlclVSTCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaWRlbnRpdGllcy5nZXRJZGVudGl0eSh1c2VyVVJMKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogRnVuY3Rpb24gdG8gc2V0IHRoZSBjdXJyZW50IElkZW50aXR5IHdpdGggYSBnaXZlbiBJZGVudGl0eVxyXG4gICogQHBhcmFtIHtJZGVudGl0eX0gICAgICAgIGlkZW50aXR5ICAgICAgICAgaWRlbnRpdHlcclxuICAqL1xyXG5cclxuICAvKiAgc2V0Q3VycmVudElkZW50aXR5KGlkZW50aXR5KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuY3VycmVudElkZW50aXR5ID0gaWRlbnRpdHk7XHJcbiAgfSovXHJcblxyXG4gIC8qKlxyXG4gICogRnVuY3Rpb24gdG8gcmV0dXJuIGFsbCB0aGUgaWRlbnRpdGllcyByZWdpc3RlcmVkIHdpdGhpbiBhIHNlc3Npb24gYnkgYSB1c2VyLlxyXG4gICogVGhlc2UgaWRlbnRpdGllcyBhcmUgcmV0dXJuZWQgaW4gYW4gYXJyYXkgY29udGFpbmluZyBhIEpTT04gcGFja2FnZSBmb3IgZWFjaCB1c2VyIGlkZW50aXR5LlxyXG4gICogQHJldHVybiB7QXJyYXk8SWRlbnRpdGllcz59ICAgICAgICAgSWRlbnRpdGllc1xyXG4gICovXHJcbiAgZ2V0IGlkZW50aXRpZXMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9pZGVudGl0aWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0IGlkZW50aXRpZXMoaWRlbnRpdGllcykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9pZGVudGl0aWVzID0gaWRlbnRpdGllcztcclxuICB9XHJcblxyXG4gIGdldCBpZHBzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpc3RPZklkcHM7XHJcbiAgfVxyXG5cclxuICBnZXRJZGVudGl0aWVzVG9DaG9vc2UoKSB7XHJcbiAgICAvLyAgICBsZXQgaWRlbnRpdGllcyA9IF90aGlzLmlkZW50aXRpZXMuaWRlbnRpZmllcnM7XHJcblxyXG4gICAgLy8gbGV0IGlkcHMgPSBbXHJcbiAgICAvLyAgIHsgZG9tYWluOiAnZ29vZ2xlLmNvbScsIHR5cGU6ICdpZFRva2VuJ30sXHJcbiAgICAvLyAgIHsgZG9tYWluOiAnbWljcm9zb2Z0LmNvbScsIHR5cGU6ICdpZFRva2VuJ30sXHJcbiAgICAvLyAgIHsgZG9tYWluOiAnb3JhbmdlLmZyJywgdHlwZTogJ2lkVG9rZW4nfSxcclxuICAgIC8vICAgeyBkb21haW46ICdzbGFjay5jb20nLCB0eXBlOiAnTGVnYWN5J31cclxuICAgIC8vIF07XHJcblxyXG4gICAgLy8gdG9kbzogcmV0cmlldmUgYXZhaWxhYmxlIGlkcHMgZnJvbSBydW50aW1lIGNhdGFsb2d1ZVxyXG4gICAgLy8gdG9kbzogZW5hYmxlIG9hdXRoIGlkcHNcclxuICAgIC8vIGxldCBpZHBzID0gW1xyXG4gICAgLy8gICB7IGRvbWFpbjogJ2dvb2dsZS5jb20nLCB0eXBlOiAnaWRUb2tlbicgfSxcclxuICAgIC8vICAgeyBkb21haW46ICdtaWNyb3NvZnQuY29tJywgdHlwZTogJ2lkVG9rZW4nIH0sXHJcbiAgICAvLyAgIHsgZG9tYWluOiAnZmFjZWJvb2suY29tJywgdHlwZTogJ2lkVG9rZW4nIH0sXHJcbiAgICAvLyAgIHsgZG9tYWluOiAnc2xhY2suY29tJywgdHlwZTogJ2lkVG9rZW4nIH1cclxuICAgIC8vIF07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblxyXG4gICAgICBjb25zdCB1cmwgPSBydW50aW1lQ29uZmlndXJhdGlvbi5jYXRhbG9ndWVVUkxzLmlkcFByb3h5LnByZWZpeCArIHRoaXMuX2RvbWFpbiArIHJ1bnRpbWVDb25maWd1cmF0aW9uLmNhdGFsb2d1ZVVSTHMuaWRwUHJveHkuc3VmZml4O1xyXG5cclxuICAgICAgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgIHRoaXMucnVudGltZUNhcGFiaWxpdGllcy5pc0F2YWlsYWJsZSgnYnJvd3NlcicpLFxyXG4gICAgICAgIHRoaXMucnVudGltZUNhcGFiaWxpdGllcy5pc0F2YWlsYWJsZSgnbm9kZScpXSlcclxuICAgICAgICAudGhlbigocmVzdWx0KSA9PiB7XHJcblxyXG4gICAgICAgICAgY29uc3QgaXNCcm93c2VyID0gcmVzdWx0WzBdO1xyXG4gICAgICAgICAgY29uc3QgaXNOb2RlID0gcmVzdWx0WzFdO1xyXG5cclxuICAgICAgICAgIGNvbnN0IGNvbnN0cmFpbnRzID0geyBjb25zdHJhaW50czoge30gfTtcclxuICAgICAgICAgIGNvbnN0cmFpbnRzLmNvbnN0cmFpbnRzLm5vZGUgPSBpc05vZGU7XHJcbiAgICAgICAgICBjb25zdHJhaW50cy5jb25zdHJhaW50cy5icm93c2VyID0gaXNCcm93c2VyO1xyXG5cclxuICAgICAgICAgIHRoaXMuX3J1bnRpbWVDYXRhbG9ndWUuZ2V0VHlwZUxpc3QodXJsLCBjb25zdHJhaW50cykudGhlbigoaWRwcykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBsaXN0T2ZJZHBzID0gaWRwcy5tYXAoa2V5ID0+IHsgcmV0dXJuIHtkb21haW46IGtleSwgdHlwZTogJ2lkVG9rZW4nfTsgfSk7XHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbSWRlbnRpdHlNb2R1bGUuZ2V0SWRlbnRpdHlBc3NlcnRpb246Z2V0SWRlbnRpdGllc1RvQ2hvb3NlXScsIGlkcHMsIGxpc3RPZklkcHMpO1xyXG4gICAgICAgICAgICB0aGlzLl9saXN0T2ZJZHBzID0gbGlzdE9mSWRwcztcclxuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoeyBkZWZhdWx0SWRlbnRpdHk6IHRoaXMuaWRlbnRpdGllcy5kZWZhdWx0SWRlbnRpdHksIGlkZW50aXRpZXM6IHRoaXMuaWRlbnRpdGllcy5pZGVudGl0aWVzLCBpZHBzOiBsaXN0T2ZJZHBzIH0pO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogRnVuY3Rpb24gdG8gcmV0dXJuIHRoZSBzZWxlY3RlZCBJZGVudGl0eSB3aXRoaW4gYSBzZXNzaW9uXHJcbiAgKiBAcmV0dXJuIHtJZGVudGl0eX0gICAgICAgIGlkZW50aXR5ICAgICAgICAgaWRlbnRpdHlcclxuICAqL1xyXG4gIC8qICBnZXRDdXJyZW50SWRlbnRpdHkoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLmN1cnJlbnRJZGVudGl0eTtcclxuICB9Ki9cclxuXHJcbiAgaW5pdChndWlkKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgIF90aGlzLl9pZGVudGl0aWVzLmxvYWRJZGVudGl0aWVzKCkudGhlbigoKSA9PiB7XHJcblxyXG4gICAgICAgIGlmICghZ3VpZCkge1xyXG4gICAgICAgICAgX3RoaXMuX2NyeXB0by5nZXRNeVB1YmxpY0tleSgpLnRoZW4oKGtleSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgaGFzaCA9IF90aGlzLl9jcnlwdG8uY3J5cHRvLl9zaGEyNTYoc3RyaW5naWZ5KGtleSkpLnRoZW4oKGhhc2gpID0+IHtcclxuICBcclxuICAgICAgICAgICAgICBndWlkID0gJ3VzZXItZ3VpZDovLycgKyBoYXNoO1xyXG4gICAgICAgICAgICAgIF90aGlzLmlkZW50aXRpZXMuZ3VpZCA9IGd1aWQ7XHJcbiAgICAgICAgICAgICAgX3RoaXMuX2lkZW50aXRpZXMubG9hZEFjY2Vzc1Rva2VucygpLnRoZW4oKCkgPT4ge1xyXG4gIFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+ICB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0eU1vZHVsZV0gZXJyb3InLCBlcnJvcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gIFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF90aGlzLmlkZW50aXRpZXMuZ3VpZCA9IGd1aWQ7XHJcbiAgICAgICAgICBfdGhpcy5faWRlbnRpdGllcy5sb2FkQWNjZXNzVG9rZW5zKCkudGhlbigoKSA9PiB7XHJcblxyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICB9KTsgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBGdW5jdGlvbiB0aGF0IGZldGNoIGFuIGlkZW50aXR5QXNzZXJ0aW9uIGZyb20gYSB1c2VyLlxyXG4gICpcclxuICAqIEByZXR1cm4ge0lkQXNzZXJ0aW9ufSAgICAgICAgICAgICAgSWRBc3NlcnRpb25cclxuICAqL1xyXG4gIGdldElkZW50aXR5QXNzZXJ0aW9uKGlkZW50aXR5QnVuZGxlKSB7XHJcbiAgICBsb2cubG9nKCdbSWRlbnRpdHlNb2R1bGUuZ2V0SWRlbnRpdHlBc3NlcnRpb246aWRlbnRpdHlCdW5kbGVdJywgaWRlbnRpdHlCdW5kbGUpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICAvL0NIRUNLIHdoZXRoZXIgaXMgYnJvd3NlciBlbnZpcm9ubWVudCBvciBub2RlanNcclxuICAgICAgLy9pZiBpdCBpcyBicm93c2VyLCB0aGVuIGNyZWF0ZSBhIGZha2UgaWRlbnRpdHlcclxuXHJcbiAgICAgIF90aGlzLnJ1bnRpbWVDYXBhYmlsaXRpZXMuaXNBdmFpbGFibGUoJ2Jyb3dzZXInKS50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgICBsb2cubG9nKCdydW50aW1lIGJyb3dzZXIgaWRlbnRpdHkgYWNxdWlzaXRpb24nLCByZXN1bHQpO1xyXG5cclxuICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAvL3RvZG86IG9ubHkgaWRwIHNob3VsZCBiZSBtYW5kYXRvcnkgd2hlbiBpZGVudGl0eUJ1bmRsZSBleGlzdHNcclxuXHJcbiAgICAgICAgaWYgKGlkZW50aXR5QnVuZGxlICYmXHJcbiAgICAgICAgICBpZGVudGl0eUJ1bmRsZS5oYXNPd25Qcm9wZXJ0eSgnaWRwJykpIHtcclxuXHJcbiAgICAgICAgICBsZXQgaWRwID0gaWRlbnRpdHlCdW5kbGUuaWRwO1xyXG4gICAgICAgICAgbGV0IG9yaWdpbiA9IGlkZW50aXR5QnVuZGxlLmhhc093blByb3BlcnR5KCdvcmlnaW4nKSA/IGlkZW50aXR5QnVuZGxlLm9yaWdpbiA6ICdvcmlnaW4nO1xyXG4gICAgICAgICAgbGV0IGlkSGludCA9IGlkZW50aXR5QnVuZGxlLmhhc093blByb3BlcnR5KCdpZEhpbnQnKSA/IGlkZW50aXR5QnVuZGxlLmlkSGludCA6ICcnO1xyXG5cclxuICAgICAgICAgIGlmIChfdGhpcy5pZGVudGl0aWVzLmRlZmF1bHRJZGVudGl0eSkge1xyXG4gICAgICAgICAgICBsZXQgYXNzZXJ0aW9uID0gX3RoaXMuaWRlbnRpdGllcy5kZWZhdWx0SWRlbnRpdHk7XHJcblxyXG4gICAgICAgICAgICBpZiAoYXNzZXJ0aW9uLmV4cGlyZXMgPiBzZWNvbmRzU2luY2VFcG9jaCgpKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoYXNzZXJ0aW9uKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhc3NlcnRpb24uaGFzT3duUHJvcGVydHkoJ3JlZnJlc2gnKSkge1xyXG4gICAgICAgICAgICAgIGxvZy5sb2coJ1tJZGVudGl0eS5JZGVudGl0eU1vZHVsZS5nZXRJZGVudGl0eUFzc2VydGlvbl0gcmVmcmVzaGluZyBhc3NlcnRpb246ICcsIGFzc2VydGlvbik7XHJcblxyXG4gICAgICAgICAgICAgIF90aGlzLl9yZWZyZXNoSWRBc3NlcnRpb24oKS50aGVuKChuZXdBc3NlcnRpb24pPT57XHJcbiAgICAgICAgICAgICAgICBsb2cubG9nKCdbSWRlbnRpdHlNb2R1bGUuZ2V0SWRlbnRpdHlBc3NlcnRpb25dIHJlZnJlc2hlZCBhc3NlcnRpb24uJywgbmV3QXNzZXJ0aW9uKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKG5ld0Fzc2VydGlvbik7XHJcbiAgICAgICAgICAgICAgfSwgKGVycm9yKT0+IHtcclxuICAgICAgICAgICAgICAgIGxvZy5lcnJvcignW0lkZW50aXR5TW9kdWxlLmdldElkZW50aXR5QXNzZXJ0aW9uXSBlcnJvciBvbiByZWZyZXNJZEFzc2VydGlvbjogJywgZXJyb3IsICcgQXNraW5nIGZvciBhIG5ldyBJZEFzc2VydGlvbi4nKVxyXG4gICAgICAgICAgICAgICAgX3RoaXMuX2dldElkQXNzZXJ0aW9uRm9yRG9tYWluKG9yaWdpbiwgaWRwLCBpZEhpbnQpLnRoZW4oKGFzc2VydGlvbik9PiB7XHJcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoYXNzZXJ0aW9uKTtcclxuICAgICAgICAgICAgICAgIH0sIChlcnJvcik9PntcclxuICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pOyAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBfdGhpcy5fZ2V0SWRBc3NlcnRpb25Gb3JEb21haW4ob3JpZ2luLCBpZHAsIGlkSGludCkudGhlbigoYXNzZXJ0aW9uKT0+IHtcclxuICAgICAgICAgICAgICByZXNvbHZlKGFzc2VydGlvbik7XHJcbiAgICAgICAgICAgIH0sIChlcnJvcik9PntcclxuICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF90aGlzLl9nZXRJZEFzc2VydGlvbkZvckRvbWFpbihvcmlnaW4sIGlkcCwgaWRIaW50KS50aGVuKChhc3NlcnRpb24pPT4ge1xyXG4gICAgICAgICAgICByZXNvbHZlKGFzc2VydGlvbik7XHJcbiAgICAgICAgICB9LCAoZXJyb3IpPT57XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoX3RoaXMuaWRlbnRpdGllcy5kZWZhdWx0SWRlbnRpdHkpIHtcclxuICAgICAgICAgIGxldCBhc3NlcnRpb24gPSBfdGhpcy5pZGVudGl0aWVzLmRlZmF1bHRJZGVudGl0eTtcclxuXHJcbiAgICAgICAgICBpZiAoYXNzZXJ0aW9uLmV4cGlyZXMgPiBzZWNvbmRzU2luY2VFcG9jaCgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGFzc2VydGlvbik7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGFzc2VydGlvbi5oYXNPd25Qcm9wZXJ0eSgncmVmcmVzaCcpKSB7XHJcbiAgICAgICAgICAgIGxvZy5sb2coJ1tJZGVudGl0eS5JZGVudGl0eU1vZHVsZS5nZXRWYWxpZFRva2VuXSByZWZyZXNoaW5nIGFzc2VydGlvbjogJywgYXNzZXJ0aW9uKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgICBfdGhpcy5fcmVmcmVzaElkQXNzZXJ0aW9uKGFzc2VydGlvbikudGhlbigobmV3QXNzZXJ0aW9uKT0+e1xyXG4gICAgICAgICAgICAgIGxvZy5sb2coJ1tJZGVudGl0eU1vZHVsZS5nZXRJZGVudGl0eUFzc2VydGlvbl0gcmVmcmVzaGVkIGFzc2VydGlvbi4nLCBuZXdBc3NlcnRpb24pO1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKG5ld0Fzc2VydGlvbik7XHJcblxyXG4gICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcclxuICAgICAgICAgICAgICBsb2cuZXJyb3IoJ1tJZGVudGl0eU1vZHVsZS5nZXRJZGVudGl0eUFzc2VydGlvbl0gZXJyb3Igb24gcmVmcmVzSWRBc3NlcnRpb246ICcsIGVycm9yLCAnIEFza2luZyBmb3IgYSBuZXcgSWRBc3NlcnRpb24uJylcclxuXHJcbiAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0SWRlbnRpdHlGcm9tR1VJKCkudGhlbigoYXNzZXJ0aW9uKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlXSBJZGVudGl0eSBzZWxlY3RlZCBmcm9tIEdVSS4nKTtcclxuICBcclxuICAgICAgICAgICAgICAgIF90aGlzLmlkZW50aXRpZXMuZGVmYXVsdElkZW50aXR5ID0gYXNzZXJ0aW9uLnVzZXJQcm9maWxlLnVzZXJVUkw7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShhc3NlcnRpb24pO1xyXG4gIFxyXG4gICAgICAgICAgICAgIH0sIChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICBcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0gZWxzZSAge1xyXG4gICAgICAgICAgICBfdGhpcy5zZWxlY3RJZGVudGl0eUZyb21HVUkoKS50aGVuKChhc3NlcnRpb24pID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlXSBJZGVudGl0eSBzZWxlY3RlZCBmcm9tIEdVSS4nKTtcclxuXHJcbiAgICAgICAgICAgICAgX3RoaXMuaWRlbnRpdGllcy5kZWZhdWx0SWRlbnRpdHkgPSBhc3NlcnRpb24udXNlclByb2ZpbGUudXNlclVSTDtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShhc3NlcnRpb24pO1xyXG5cclxuICAgICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF90aGlzLnNlbGVjdElkZW50aXR5RnJvbUdVSSgpLnRoZW4oKGFzc2VydGlvbikgPT4ge1xyXG5cclxuICAgICAgICAgICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlXSBJZGVudGl0eSBzZWxlY3RlZCBmcm9tIEdVSS4nKTtcclxuXHJcbiAgICAgICAgICAgIF90aGlzLmlkZW50aXRpZXMuZGVmYXVsdElkZW50aXR5ID0gYXNzZXJ0aW9uLnVzZXJQcm9maWxlLnVzZXJVUkw7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGFzc2VydGlvbik7XHJcblxyXG4gICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgbG9nLmVycm9yKCdFcnJvciBvbiBpZGVudGl0eSBhY3F1aXNpdGlvbiAnLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdChlcnJvcik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgX3RoaXMucnVudGltZUNhcGFiaWxpdGllcy5pc0F2YWlsYWJsZSgnbm9kZScpLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgIGxvZy5sb2coJ25vZGUgaWRlbnRpdHkgYWNxdWlzaXRpb24nLCByZXN1bHQpO1xyXG5cclxuICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoX3RoaXMuaWRlbnRpdGllcy5jdXJyZW50SWRlbnRpdHkpIHtcclxuICAgICAgICAgIC8vVE9ETyB2ZXJpZnkgd2hldGhlciB0aGUgdG9rZW4gaXMgc3RpbGwgdmFsaWQgb3Igbm90LlxyXG4gICAgICAgICAgLy8gc2hvdWxkIGJlIG5lZWRlZCB0byBtYWtlIGZ1cnRoZXIgcmVxdWVzdHMsIHRvIG9idGFpbiBhIHZhbGlkIHRva2VuXHJcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZShfdGhpcy5pZGVudGl0aWVzLmN1cnJlbnRJZGVudGl0eSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5sb2coJ2dldElkZW50aXR5QXNzZXJ0aW9uIGZvciBub2RlanMnKTtcclxuXHJcbiAgICAgICAgICBsZXQgaWRwID0geyB0eXBlOiAnaWRwJywgdmFsdWU6ICdub2RlanMtaWRwJywgY29kZTogMjAwLCBhdXRoOiBmYWxzZSB9O1xyXG4gICAgICAgICAgX3RoaXMuY2FsbE5vZGVKc0dlbmVyYXRlTWV0aG9kcyhpZHAudmFsdWUsICdvcmlnaW4nKS50aGVuKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICAgIH0sIChlcnIpID0+IHtcclxuICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9KS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgbG9nLmVycm9yKCdFcnJvciBvbiBpZGVudGl0eSBhY3F1aXNpdGlvbiAnLCBlcnJvcik7XHJcbiAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9nZXRJZEFzc2VydGlvbkZvckRvbWFpbihvcmlnaW4sIGlkcCwgaWRIaW50KSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PiB7XHJcbiAgICAgIF90aGlzLnNlbGVjdElkZW50aXR5Rm9ySHlwZXJ0eShvcmlnaW4sIGlkcCwgaWRIaW50KS50aGVuKChhc3NlcnRpb24pID0+IHtcclxuICAgICAgICBsb2cubG9nKCdbSWRlbnRpdHlNb2R1bGUuX2dldElkQXNzZXJ0aW9uRm9yRG9tYWluXSBJZGVudGl0eSBzZWxlY3RlZCBieSBoeXBlcnR5LicpO1xyXG4gICAgICAgIHJldHVybiByZXNvbHZlKGFzc2VydGlvbik7XHJcbiAgICAgIH0sIChlcnIpID0+IHsgLy8gaWYgaXQgZ290IGFuIGVycm9yIHRoZW4ganVzdCBzZWxlY3QgaWRlbnRpdHkgZnJvbSBHVUlcclxuICAgICAgICAvLyBsb2cuZXJyb3IoJ1tJZGVudGl0eU1vZHVsZV0gQ291bGQgbm90IHNlbGVjdCBpZGVudGl0eSBmcm9tIGh5cGVydHkuJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgX3RoaXMuc2VsZWN0SWRlbnRpdHlGcm9tR1VJKCkudGhlbigobmV3QXNzZXJ0aW9uKSA9PiB7XHJcbiAgICAgICAgICBsb2cubG9nKCdbSWRlbnRpdHlNb2R1bGUuX2dldElkQXNzZXJ0aW9uRm9yRG9tYWluXSBJZGVudGl0eSBzZWxlY3RlZCBieSBoeXBlcnR5LicpO1xyXG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUobmV3QXNzZXJ0aW9uKTtcclxuICAgICAgICB9LCAoZXJyKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIFxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgX3JlZnJlc2hJZEFzc2VydGlvbihhc3NlcnRpb24pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XHJcbiAgICAgIF90aGlzLnNlbmRSZWZyZXNoTWVzc2FnZShhc3NlcnRpb24pLnRoZW4oKG5ld0Fzc2VydGlvbikgPT4ge1xyXG4gICAgICAgIGxvZy5sb2coJ1tJZGVudGl0eS5JZGVudGl0eU1vZHVsZS5nZXRWYWxpZFRva2VuXSByZWZyZXNoZWQgYXNzZXJ0aW9uOiAnLCBuZXdBc3NlcnRpb24pO1xyXG4gICAgICBfdGhpcy5pZGVudGl0aWVzLnVwZGF0ZUFzc2VydGlvbihuZXdBc3NlcnRpb24pLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIHJlc29sdmUobmV3QXNzZXJ0aW9uKTtcclxuICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgIGxvZy5lcnJvcignW0lkZW50aXR5TW9kdWxlLmdldFZhbGlkVG9rZW5dIGVycm9yIHVwZGF0aW5nIHRoZSBhc3NlcnRpb24gJywgZXJyKTtcclxuICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgICB9LCAoZXJyKSA9PiB7XHJcbiAgICAgIGxvZy5lcnJvcignW0lkZW50aXR5TW9kdWxlLmdldFZhbGlkVG9rZW5dIGVycm9yIHJlZnJlc2hpbmcgdGhlIGFzc2VydGlvbiAnLCBlcnIpO1xyXG4gICAgICByZWplY3QoZXJyKTtcclxuICAgIH0pOyAgICBcclxuICBcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuXHJcbiAgLyoqXHJcbiAgKiBGdW5jdGlvbiB0byByZXR1cm4gYWxsIHRoZSB1c2VycyBVUkxzIHJlZ2lzdGVyZWQgd2l0aGluIGEgc2Vzc2lvblxyXG4gICogVGhlc2UgdXNlcnMgVVJMcyBhcmUgcmV0dXJuZWQgaW4gYW4gYXJyYXkgb2Ygc3RyaW5ncy5cclxuICAqIEByZXR1cm4ge0FycmF5PFN0cmluZz59ICAgICAgICAgdXNlcnNcclxuICAqL1xyXG4gIGdldFVzZXJzSURzKCkge1xyXG4gICAgLyogIGxvZy5sb2coJ1tnZXRVc2Vyc0lEczplbWFpbEZvcm1hdF0nLCBlbWFpbEZvcm1hdCk7XHJcbiAgICAgIGxvZy5sb2coJ2dldFVzZXJzSURzOmVtYWlsRm9ybWF0JywgZW1haWxGb3JtYXQpO1xyXG4gICAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgICBsZXQgdXNlcnMgPSBbXTsqL1xyXG5cclxuICAgIC8vaWYgcmVxdWVzdCBjb21lcyB3aXRoIHRoZSBlbWFpbEZvcm1hdCBvcHRpb24sIHRoZW4gY29udmVydCB1cmwgdG8gZW1haWwgZm9ybWF0XHJcbiAgICAvKiAgICBsZXQgY29udmVydGVyID0gKGVtYWlsRm9ybWF0KSA/IGdldFVzZXJFbWFpbEZyb21VUkwgOiAodmFsdWUpID0+IHsgcmV0dXJuIHZhbHVlOyB9O1xyXG5cclxuICAgIGZvciAobGV0IGluZGV4IGluIF90aGlzLmlkZW50aXRpZXMpIHtcclxuICAgICAgbGV0IGlkZW50aXR5ID0gX3RoaXMuaWRlbnRpdGllc1tpbmRleF07XHJcbiAgICAgIHVzZXJzLnB1c2goY29udmVydGVyKGlkZW50aXR5LmlkZW50aXR5KSk7XHJcbiAgICB9Ki9cclxuXHJcbiAgICByZXR1cm4gdGhpcy5pZGVudGl0aWVzLmlkZW50aWZpZXJzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBGdW5jdGlvbiB0byByZW1vdmUgYW4gaWRlbnRpdHlcclxuICAqIEBwYXJhbSB7U3RyaW5nfSAgICB1c2VyVVJMICAgICAgdXNlclVSTFxyXG4gICogQHJldHVybiB7UHJvbWlzZX1cclxuICAqL1xyXG5cclxuICBkZWxldGVJZGVudGl0eSh1c2VyVVJMKSB7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaWRlbnRpdGllcy5yZW1vdmVJZGVudGl0eSh1c2VyVVJMKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIEZ1bmN0aW9uIHRvIHVucmVnaXN0ZXIgYW4gaWRlbnRpdHkgZnJvbSB0aGUgZW1haWxzTGlzdCBhcnJheSBhbmQgbm90IHNob3cgaW4gdG8gdGhlIEdVSVxyXG4gICogQHBhcmFtIHtTdHJpbmd9ICAgIGVtYWlsICAgICAgZW1haWxcclxuICAqL1xyXG4gIC8qICB1bnJlZ2lzdGVySWRlbnRpdHkoZW1haWwpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgZm9yIChsZXQgZSBpbiBfdGhpcy5lbWFpbHNMaXN0KSB7XHJcbiAgICAgIGlmIChfdGhpcy5lbWFpbHNMaXN0W2VdID09PSBlbWFpbCkge1xyXG4gICAgICAgIF90aGlzLmVtYWlsc0xpc3Quc3BsaWNlKGUsIDEpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSovXHJcblxyXG4gIC8vIHRvIGJlIHVzZWQgd2hlbiBydW50aW1lIGlzIG5vdCBleGVjdXRlZCBpbiBhIHNhbmRib3hcclxuXHJcbiAgbGlzdGVuU2hvd0FkbWluKGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9zaG93QWRtaW4gPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogRnVuY3Rpb24gdGhhdCBzZW5kcyBhIHJlcXVlc3QgdG8gdGhlIEdVSSB1c2luZyBtZXNzYWdlcy4gU2VuZHMgYWxsIGlkZW50aXRpZXMgcmVnaXN0ZXJlZCBhbmRcclxuICAqIHRoZSBJZHBzIHN1cHBvcnRlZCwgYW5kIHJldHVybiB0aGUgaWRlbnRpdHkvaWRwIHJlY2VpdmVkIGJ5IHRoZSBHVUlcclxuICAqIEBwYXJhbSB7QXJyYXk8aWRlbnRpdHk+fSAgaWRlbnRpdGllcyAgICAgIGxpc3Qgb2YgaWRlbnRpdGlpZXNcclxuICAqIEBwYXJhbSB7QXJyYXk8U3RyaW5nPn0gICAgaWRwcyAgICAgICAgICAgIGxpc3Qgb2YgaWRwcyB0byBhdXRoZW50aWNhdGVcclxuICAqIEByZXR1cm4ge1Byb21pc2V9ICAgICAgICAgcmV0dXJucyBhIGNob3NlbiBpZGVudGl0eSBvciBpZHBcclxuICAqL1xyXG4gIHJlcXVlc3RJZGVudGl0eVRvR1VJKGlkZW50aXRpZXMsIGlkcHMpIHtcclxuICAgIGxvZy5sb2coJ1tJZGVudGl0eU1vZHVsZS5yZXF1ZXN0SWRlbnRpdHlUb0dVSTppZGVudGl0aWVzXScsIGlkZW50aXRpZXMpO1xyXG4gICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlLnJlcXVlc3RJZGVudGl0eVRvR1VJOmlkcHNdJywgaWRwcyk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIC8vY29uZGl0aW9uIHRvIGNoZWNrIGlmIHRoZSByZWFsIEdVSSBpcyBkZXBsb3llZC4gSWYgbm90LCBkZXBsb3lzIGEgZmFrZSBndWlcclxuICAgICAgaWYgKF90aGlzLmd1aURlcGxveWVkID09PSBmYWxzZSkge1xyXG4gICAgICAgIGxldCBndWlGYWtlVVJMID0gX3RoaXMuX2d1aVVSTDtcclxuICAgICAgICBsZXQgZ3VpRmFrZSA9IG5ldyBHdWlGYWtlKGd1aUZha2VVUkwsIF90aGlzLl9tZXNzYWdlQnVzKTtcclxuICAgICAgICBfdGhpcy5ndWlGYWtlID0gZ3VpRmFrZTtcclxuICAgICAgICBfdGhpcy5ndWlEZXBsb3llZCA9IHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBtZXNzYWdlID0ge1xyXG4gICAgICAgIHR5cGU6ICdjcmVhdGUnLCB0bzogX3RoaXMuX2d1aVVSTCwgZnJvbTogX3RoaXMuX2lkbVVSTCxcclxuICAgICAgICBib2R5OiB7IHZhbHVlOiB7IGlkZW50aXRpZXM6IGlkZW50aXRpZXMsIGlkcHM6IGlkcHMgfSB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBsZXQgY2FsbGJhY2sgPSBtc2cgPT4ge1xyXG4gICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnJlbW92ZVJlc3BvbnNlTGlzdGVuZXIoX3RoaXMuX2lkbVVSTCwgbXNnLmlkKTtcclxuXHJcblxyXG4gICAgICAgIC8vIHRvZG86IHRvIHJldHVybiB0aGUgdXNlciBVUkwgYW5kIG5vdCB0aGUgZW1haWwgb3IgaWRlbnRpZmllclxyXG5cclxuICAgICAgICBpZiAobXNnLmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICBsZXQgc2VsZWN0ZWRJZGVudGl0eSA9IG1zZy5ib2R5O1xyXG5cclxuICAgICAgICAgIGxvZy5sb2coJ3NlbGVjdGVkSWRlbnRpdHk6ICcsIHNlbGVjdGVkSWRlbnRpdHkudmFsdWUpO1xyXG4gICAgICAgICAgcmVzb2x2ZShzZWxlY3RlZElkZW50aXR5KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVqZWN0KCdlcnJvciBvbiByZXF1ZXN0aW5nIGFuIGlkZW50aXR5IHRvIHRoZSBHVUknKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvL3Bvc3RNZXNzYWdlIHdpdGggY2FsbGJhY2sgYnV0IHdpdGhvdXQgdGltZW91dFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIGNhbGxiYWNrLCBmYWxzZSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIHJlamVjdCgnSW4gbWV0aG9kIGNhbGxJZGVudGl0eU1vZHVsZUZ1bmMgZXJyb3I6ICcgKyBlcnIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNhbGxOb2RlSnNHZW5lcmF0ZU1ldGhvZHMoaWRwLCBvcmlnaW4pIHtcclxuICAgIGxvZy5sb2coJ1tjYWxsTm9kZUpzR2VuZXJhdGVNZXRob2RzOmlkcF0nLCBpZHApO1xyXG4gICAgbG9nLmxvZygnW2NhbGxOb2RlSnNHZW5lcmF0ZU1ldGhvZHM6b3JpZ2luXScsIG9yaWdpbik7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIC8vZGVidWdnZXI7XHJcbiAgICAgIGxldCBwdWJsaWNLZXk7XHJcblxyXG4gICAgICAvL2xldCBrZXlQYWlyID0gbm9kZUpTS2V5UGFpclBvcHVsYXRlO1xyXG5cclxuICAgICAgLy9nZW5lcmF0ZXMgdGhlIFJTQSBrZXkgcGFpclxyXG4gICAgICBfdGhpcy5fY3J5cHRvLmdldE15UHVibGljS2V5KCkudGhlbihmdW5jdGlvbihrZXkpIHtcclxuXHJcbiAgICAgICAgbG9nLmxvZygnW2NhbGxOb2RlSnNHZW5lcmF0ZU1ldGhvZHM6a2V5XScsIGtleSk7XHJcblxyXG4gICAgICAgIHB1YmxpY0tleSA9IHN0cmluZ2lmeShrZXkpO1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbY2FsbE5vZGVKc0dlbmVyYXRlTWV0aG9kc10gTk9fVVJMJyk7XHJcblxyXG4gICAgICAgIHJldHVybiBfdGhpcy5nZW5lcmF0ZUFzc2VydGlvbihwdWJsaWNLZXksIG9yaWdpbiwgJ3VybCcsIGlkcCk7XHJcblxyXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVqZWN0KCdFcnJvciBvbiBvYnRhaW5pbmcgSWRlbnRpdHknKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIGxvZy5sb2coZXJyKTtcclxuICAgICAgICByZWplY3QoZXJyKTtcclxuXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjYWxsR2VuZXJhdGVNZXRob2RzKGlkcCwgb3JpZ2luKSB7XHJcbiAgICBsb2cubG9nKCdbY2FsbEdlbmVyYXRlTWV0aG9kczppZHBdJywgaWRwKTtcclxuICAgIGxvZy5sb2coJ1tjYWxsR2VuZXJhdGVNZXRob2RzOm9yaWdpbl0nLCBvcmlnaW4pO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IHB1YmxpY0tleTtcclxuXHJcbiAgICAgIC8vZ2VuZXJhdGVzIHRoZSBSU0Ega2V5IHBhaXJcclxuICAgICAgX3RoaXMuX2NyeXB0by5nZXRNeVB1YmxpY0tleSgpLnRoZW4oZnVuY3Rpb24oa2V5KSB7XHJcblxyXG4gICAgICAgIGxvZy5sb2coJ1tjYWxsR2VuZXJhdGVNZXRob2RzOmtleV0nLCBrZXkpO1xyXG5cclxuICAgICAgICBwdWJsaWNLZXkgPSBzdHJpbmdpZnkoa2V5KTtcclxuXHJcbiAgICAgICAgLy8gICAgICAgIHVzZXJrZXlQYWlyID0ga2V5UGFpcjtcclxuICAgICAgICBsb2cubG9nKCdnZW5lcmF0ZUFzc2VydGlvbjpub19oaW50Jyk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzLmdlbmVyYXRlQXNzZXJ0aW9uKHB1YmxpY0tleSwgb3JpZ2luLCAnJywgaWRwKTtcclxuXHJcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgX3RoaXMubXlIaW50ID0gdXJsO1xyXG4gICAgICAgIGxvZy5sb2coJ2dlbmVyYXRlQXNzZXJ0aW9uOmhpbnQnKTtcclxuICAgICAgICByZXR1cm4gX3RoaXMuZ2VuZXJhdGVBc3NlcnRpb24ocHVibGljS2V5LCBvcmlnaW4sIHVybCwgaWRwKTtcclxuXHJcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZWplY3QoJ0Vycm9yIG9uIG9idGFpbmluZyBJZGVudGl0eScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgbG9nLmVycm9yKGVycik7XHJcbiAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcblxyXG4gIGxvZ2luU2VsZWN0ZWRJZGVudGl0eShwdWJsaWNLZXksIG9yaWdpbiwgaWRwLCBsb2dpblVybCkge1xyXG4gICAgbG9nLmxvZygnW2xvZ2luU2VsZWN0ZWRJZGVudGl0eTpwdWJsaWNLZXldJywgcHVibGljS2V5KTtcclxuICAgIGxvZy5sb2coJ1tsb2dpblNlbGVjdGVkSWRlbnRpdHk6b3JpZ2luXScsIG9yaWdpbik7XHJcbiAgICBsb2cubG9nKCdbbG9naW5TZWxlY3RlZElkZW50aXR5OmlkcF0nLCBpZHApO1xyXG5cclxuICAgIC8vICAgIGxvZy5sb2coJ1tsb2dpblNlbGVjdGVkSWRlbnRpdHk6a2V5UGFpcl0nLCBrZXlQYWlyKTtcclxuICAgIGxvZy5sb2coJ1tsb2dpblNlbGVjdGVkSWRlbnRpdHk6bG9naW5VcmxdJywgbG9naW5VcmwpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBsb2cubG9nKCdbSWRlbnRpdHlNb2R1bGVdIG9wZW5Qb3B1cCcpO1xyXG4gICAgICBfdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdvcGVuUG9wdXAnLCB7IHVybHJlY2VpdmVkOiBsb2dpblVybCB9KS50aGVuKChpZENvZGUpID0+IHtcclxuICAgICAgICByZXR1cm4gaWRDb2RlO1xyXG4gICAgICB9LCAoZXJyKSA9PiB7XHJcbiAgICAgICAgbG9nLmVycm9yKCdFcnJvciB3aGlsZSBsb2dnaW5nIGluIGZvciB0aGUgc2VsZWN0ZWQgaWRlbnRpdHkuJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xyXG4gICAgICB9KS50aGVuKChpZENvZGUpID0+IHtcclxuICAgICAgICBfdGhpcy5zZW5kR2VuZXJhdGVNZXNzYWdlKHB1YmxpY0tleSwgb3JpZ2luLCBpZENvZGUsIGlkcCkudGhlbigobmV3UmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgIGlmIChuZXdSZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgnYXNzZXJ0aW9uJykpIHtcclxuICAgICAgICAgICAgX3RoaXMuaWRlbnRpdGllcy5hZGRBc3NlcnRpb24obmV3UmVzcG9uc2UpLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICByZXNvbHZlKCdMb2dpbiB3YXMgc3VjY2Vzc2Z1bGwnKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsgcmVqZWN0KCdMb2dpbiBoYXMgZmFpbGVkOicgKyBlcnIpOyB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxvZy5lcnJvcignRXJyb3Igd2hpbGUgbG9nZ2luZyBpbiBmb3IgdGhlIHNlbGVjdGVkIGlkZW50aXR5LicpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVqZWN0KCdDb3VsZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBhc3NlcnRpb24gZm9yIHNlbGVjdGVkIGlkZW50aXR5LicpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKGVyciA9PiB7IHJlamVjdCgnT24gbG9naW5TZWxlY3RlZElkZW50aXR5IGZyb20gbWV0aG9kIHNlbmRHZW5lcmF0ZU1lc3NhZ2UgZXJyb3I6ICAnICsgZXJyKTsgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgc2VsZWN0SWRlbnRpdHlGb3JIeXBlcnR5KG9yaWdpbiwgaWRwLCBpZEhpbnQpIHtcclxuICAgIGxvZy5sb2coJ1tzZWxlY3RJZGVudGl0eUZvckh5cGVydHk6b3JpZ2luXScsIG9yaWdpbik7XHJcbiAgICBsb2cubG9nKCdbc2VsZWN0SWRlbnRpdHlGb3JIeXBlcnR5OmlkcF0nLCBpZHApO1xyXG4gICAgbG9nLmxvZygnW3NlbGVjdElkZW50aXR5Rm9ySHlwZXJ0eTppZEhpbnRdJywgaWRIaW50KTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIC8vZ2VuZXJhdGVzIHRoZSBSU0Ega2V5IHBhaXJcclxuICAgICAgX3RoaXMuX2NyeXB0by5nZXRNeVB1YmxpY0tleSgpLnRoZW4oZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgbGV0IHB1YmxpY0tleSA9IHN0cmluZ2lmeShrZXkpO1xyXG5cclxuICAgICAgICBfdGhpcy5zZW5kR2VuZXJhdGVNZXNzYWdlKHB1YmxpY0tleSwgb3JpZ2luLCBpZEhpbnQsIGlkcCkudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgnYXNzZXJ0aW9uJykpIHsgLy8gaWRlbnRpdHkgd2FzIGxvZ2dlZCBpbiwganVzdCBzYXZlIGl0XHJcbiAgICAgICAgICAgIF90aGlzLmlkZW50aXRpZXMuYWRkQXNzZXJ0aW9uKHJlc3BvbnNlKS50aGVuKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdsb2dpblVybCcpKSB7IC8vIGlkZW50aXR5IHdhcyBub3QgbG9nZ2VkIGluXHJcbiAgICAgICAgICAgIF90aGlzLmxvZ2luU2VsZWN0ZWRJZGVudGl0eShwdWJsaWNLZXksIG9yaWdpbiwgaWRwLCByZXNwb25zZS5sb2dpblVybCkudGhlbigodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0sIChlcnIpID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHsgLy8geW91IHNob3VsZCBuZXZlciBnZXQgaGVyZSwgaWYgeW91IGRvIHRoZW4gdGhlIElkUCBQcm94eSBpcyBub3Qgd2VsbCBpbXBsZW1lbnRlZFxyXG4gICAgICAgICAgICAvLyBsb2cuZXJyb3IoJ0dlbmVyYXRlQXNzZXJ0aW9uIHJldHVybmVkIGludmFsaWQgcmVzcG9uc2UuJyk7XHJcbiAgICAgICAgICAgIGxvZy5sb2coJ1Byb2NlZWRpbmcgYnkgbG9nZ2luZyBpbi4nKTtcclxuICAgICAgICAgICAgX3RoaXMuY2FsbEdlbmVyYXRlTWV0aG9kcyhpZHAsIG9yaWdpbikudGhlbigodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0sIChlcnIpID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKGVyciA9PiB7IHJlamVjdCgnT24gc2VsZWN0SWRlbnRpdHlGb3JIeXBlcnR5IGZyb20gbWV0aG9kIHNlbmRHZW5lcmF0ZU1lc3NhZ2UgZXJyb3I6ICAnICsgZXJyKTsgfSk7XHJcbiAgICAgIH0pLmNhdGNoKGVyciA9PiB7IHJlamVjdCgnT24gc2VsZWN0SWRlbnRpdHlGb3JIeXBlcnR5IGZyb20gbWV0aG9kIGdlbmVyYXRlUlNBS2V5UGFpciBlcnJvcjogICcgKyBlcnIpOyB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2VsZWN0SWRlbnRpdHlGcm9tR1VJKG9yaWdpbikge1xyXG4gICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlLnNlbGVjdElkZW50aXR5RnJvbUdVSTpvcmlnaW5dJywgb3JpZ2luKTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIHRoaXMuZ2V0SWRlbnRpdGllc1RvQ2hvb3NlKCkudGhlbigoaWRlbnRpdGllc0luZm8pID0+IHtcclxuICAgICAgICByZXR1cm4gX3RoaXMucmVxdWVzdElkZW50aXR5VG9HVUkoaWRlbnRpdGllc0luZm8uaWRlbnRpdGllcywgaWRlbnRpdGllc0luZm8uaWRwcyk7XHJcbiAgICAgIH0pLnRoZW4odmFsdWUgPT4ge1xyXG5cclxuICAgICAgICBpZiAodmFsdWUudHlwZSA9PT0gJ2lkZW50aXR5Jykge1xyXG5cclxuICAgICAgICAgIC8vICBsZXQgY2hvc2VuSUQgPSBnZXRVc2VyVVJMRnJvbUVtYWlsKHZhbHVlLnZhbHVlKTtcclxuICAgICAgICAgIC8vIGhhY2sgd2hpbGUgdGhlIHVzZXIgdXJsIGlzIG5vdCByZXR1cm5lZCBmcm9tIHJlcXVlc3RJZGVudGl0eVRvR1VJO1xyXG5cclxuICAgICAgICAgIC8qICAgICAgICAgIGxldCBjaG9zZW5JRCA9ICd1c2VyOi8vJyArIF90aGlzLmlkZW50aXRpZXMuY3VycmVudElkZW50aXR5LmlkcC5kb21haW4gKyAnLycgKyB2YWx1ZS52YWx1ZTtcclxuXHJcbiAgICAgICAgICBfdGhpcy5pZGVudGl0aWVzLmRlZmF1bHRJZGVudGl0eSA9IF90aGlzLmlkZW50aXRpZXMuY3VycmVudElkZW50aXR5OyovXHJcblxyXG4gICAgICAgICAgLy8gcmV0dXJucyB0aGUgaWRlbnRpdHkgaW5mbyBmcm9tIHRoZSBjaG9zZW4gaWRcclxuICAgICAgICAgIC8vICAgICAgICAgIGlmIChfdGhpcy5pZGVudGl0aWVzLmN1cnJlbnRJZGVudGl0eSkgcmVzb2x2ZShfdGhpcy5pZGVudGl0aWVzLmN1cnJlbnRJZGVudGl0eS5hc3NlcnRpb24pO1xyXG4gICAgICAgICAgaWYgKF90aGlzLmlkZW50aXRpZXMuaWRlbnRpdGllc1t2YWx1ZS52YWx1ZV0pIHJlc29sdmUoX3RoaXMuaWRlbnRpdGllcy5pZGVudGl0aWVzW3ZhbHVlLnZhbHVlXSk7XHJcbiAgICAgICAgICBlbHNlIHJlamVjdCgnW0lkZW50aXR5TW9kdWxlLnNlbGVjdElkZW50aXR5RnJvbUdVSV0gaWRlbnRpdHkgbm90IGZvdW5kOiAnLCB2YWx1ZS52YWx1ZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZS50eXBlID09PSAnaWRwJykge1xyXG5cclxuICAgICAgICAgIF90aGlzLmNhbGxHZW5lcmF0ZU1ldGhvZHModmFsdWUudmFsdWUsIG9yaWdpbikudGhlbigodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiByZWplY3QoJ2Vycm9yIG9uIEdVSSByZWNlaXZlZCBtZXNzYWdlLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkuY2F0Y2goZXJyID0+IHsgcmVqZWN0KCdPbiBzZWxlY3RJZGVudGl0eUZyb21HVUkgZnJvbSBtZXRob2QgcmVxdWVzdElkZW50aXR5VG9HVUkgZXJyb3I6ICAnICsgZXJyKTsgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBjYWxsSWRlbnRpdHlNb2R1bGVGdW5jKG1ldGhvZE5hbWUsIHBhcmFtZXRlcnMpIHtcclxuICAgIGxvZy5sb2coJ1tjYWxsSWRlbnRpdHlNb2R1bGVGdW5jOm1ldGhvZE5hbWVdJywgbWV0aG9kTmFtZSk7XHJcbiAgICBsb2cubG9nKCdbY2FsbElkZW50aXR5TW9kdWxlRnVuYzpwYXJhbWV0ZXJzXScsIHBhcmFtZXRlcnMpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgaWYgKF90aGlzLl9zaG93QWRtaW4gJiYgIG1ldGhvZE5hbWUgPT09ICdnZXRBY2Nlc3NUb2tlbicpe1xyXG4gICAgICAgICBfdGhpcy5fc2hvd0FkbWluKG1ldGhvZE5hbWUsIHBhcmFtZXRlcnMpO1xyXG4gICAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICB0eXBlOiAnZXhlY3V0ZScsIHRvOiBfdGhpcy5fZ3VpVVJMLCBmcm9tOiBfdGhpcy5faWRtVVJMLFxyXG4gICAgICAgICAgYm9keTogeyByZXNvdXJjZTogJ2lkZW50aXR5JywgbWV0aG9kOiBtZXRob2ROYW1lLCBwYXJhbXM6IHBhcmFtZXRlcnMgfVxyXG4gICAgICAgIH07XHJcbiAgXHJcbiAgICAgICAgLy9wb3N0IG1zZyB3aXRoIGNhbGxiYWNrIGJ1dCB3aXRob3V0IHRpbW91dFxyXG4gICAgICAgIGxldCBjYWxsYmFjayA9IG1zZyA9PiB7XHJcbiAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5yZW1vdmVSZXNwb25zZUxpc3RlbmVyKF90aGlzLl9pZG1VUkwsIG1zZy5pZCk7XHJcbiAgICAgICAgICBsZXQgcmVzdWx0ID0gbXNnLmJvZHkudmFsdWU7XHJcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0cnkge1xyXG4gIFxyXG4gICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgY2FsbGJhY2ssIGZhbHNlKTtcclxuICBcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgIHJlamVjdCgnSW4gbWV0aG9kIGNhbGxJZGVudGl0eU1vZHVsZUZ1bmMgZXJyb3I6ICcgKyBlcnIpO1xyXG4gICAgICAgIH1cclxuICBcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyoqKioqKioqKioqKioqKioqKiogVE9LRU4gTUVUSE9EUyAqKioqKioqKioqKioqKioqKioqXHJcbiAgLyoqXHJcbiAgKiBnZXQgYSBUb2tlbiB0byBiZSBhZGRlZCB0byBhIG1lc3NhZ2VcclxuICAqIEBwYXJhbSAge1N0cmluZ30gIGZyb21VUkwgICAgIG9yaWdpbiBvZiB0aGUgbWVzc2FnZVxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgdG9VUkwgICAgIHRhcmdldCBvZiB0aGUgbWVzc2FnZW9rXHJcbiAgKiBAcmV0dXJuIHtKU09OfSAgICB0b2tlbiAgICB0b2tlbiB0byBiZSBhZGRlZCB0byB0aGUgbWVzc2FnZVxyXG4gICovXHJcbiAgZ2V0VG9rZW4obXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGZyb21VUkwgPSBtc2cuZnJvbTtcclxuICAgIGxldCB0b1VybCA9IG1zZy50bztcclxuICAgIGlmIChtc2cuaGFzT3duUHJvcGVydHkoJ2JvZHknKSAmJiBtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlJykpIHtcclxuICAgICAgZnJvbVVSTCA9IG1zZy5ib2R5LnNvdXJjZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobXNnLnR5cGUgPT09ICdmb3J3YXJkJykge1xyXG4gICAgICBmcm9tVVJMID0gbXNnLmJvZHkuZnJvbTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobXNnLmhhc093blByb3BlcnR5KCdib2R5JykgJiYgbXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ3N1YnNjcmliZXInKSkge1xyXG4gICAgICBmcm9tVVJMID0gbXNnLmJvZHkuc3Vic2NyaWJlcjtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIGxvZy5sb2coJ1tJZGVudGl0eU1vZHVsZS5nZXRUb2tlbl0gZm9yIG1zZyAnLCBtc2cpO1xyXG5cclxuICAgICAgLy9sb2cubG9nKCd0b1VybCcsIHRvVXJsKTtcclxuICAgICAgX3RoaXMucmVnaXN0cnkuaXNMZWdhY3kodG9VcmwpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICAgLy8gbG9nLmxvZygnW0lkZW50aXR5LklkZW50aXR5TW9kdWxlLmdldFRva2VuXSBpc0xFR0FDWTogJywgcmVzdWx0KTtcclxuICAgICAgICBpZiAocmVzdWx0KSB7XHJcblxyXG4gICAgICAgICAgX3RoaXMuX2dldEFjY2Vzc1Rva2VuKG1zZykudGhlbigodG9rZW4pID0+IHtcclxuICAgICAgICAgICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlLmdldFRva2VuXSBhY2Nlc3MgdG9rZW4gJywgdG9rZW4pO1xyXG4gICAgICAgICAgICByZXNvbHZlKGRlZXBDbG9uZSh0b2tlbikpO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsgcmVqZWN0KCdbSWRlbnRpdHlNb2R1bGUuZ2V0VG9rZW5dIEFjY2VzcyBUb2tlbiBlcnJvciAnICsgZXJyKTsgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF90aGlzLl9nZXRWYWxpZFRva2VuKGZyb21VUkwpLnRoZW4oKHRva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIHJlc29sdmUodG9rZW4pO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsgcmVqZWN0KCdPbiBnZXRUb2tlbiBmcm9tIG1ldGhvZCBfZ2V0VmFsaWRUb2tlbiBlcnJvcjogJyArIGVycik7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkuY2F0Y2goZXJyID0+IHsgcmVqZWN0KCdPbiBnZXRUb2tlbiBmcm9tIG1ldGhvZCBpc0xlZ2FjeSBlcnJvcjogJyArIGVycik7IH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgKiBnZXQgYW4gSWQgVG9rZW4gZm9yIGEgSHlwZXJ0eVVSTFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgaHlwZXJ0eVVSTCAgICAgdGhlIEh5cGVydHkgYWRkcmVzc1xyXG4gICogQHJldHVybiB7SlNPTn0gICAgdG9rZW4gICAgSWQgdG9rZW4gdG8gYmUgYWRkZWQgdG8gdGhlIG1lc3NhZ2VcclxuICAqL1xyXG4gIGdldElkVG9rZW4oaHlwZXJ0eVVSTCkge1xyXG4gICAgbG9nLmluZm8oJ2dldElkVG9rZW46aHlwZXJ0eVVSTCAnLCBoeXBlcnR5VVJMKTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIGxldCBzcGxpdFVSTCA9IGh5cGVydHlVUkwuc3BsaXQoJzovLycpO1xyXG4gICAgICBsZXQgdXNlclVSTDtcclxuICAgICAgaWYgKHNwbGl0VVJMWzBdICE9PSAnaHlwZXJ0eScpIHsgLy8gaXQgaXMgYSBEYXRhIE9iamVjdCBVUkxcclxuXHJcbiAgICAgICAgX3RoaXMuX2dldEh5cGVydHlGcm9tRGF0YU9iamVjdChoeXBlcnR5VVJMKS50aGVuKChyZXR1cm5lZEh5cGVydHlVUkwpID0+IHtcclxuXHJcbiAgICAgICAgICB1c2VyVVJMID0gX3RoaXMucmVnaXN0cnkuZ2V0SHlwZXJ0eU93bmVyKHJldHVybmVkSHlwZXJ0eVVSTCk7XHJcblxyXG4gICAgICAgICAgaWYgKHVzZXJVUkwpIHtcclxuICAgICAgICAgICAgbGV0IGlkZW50aXR5ID0gX3RoaXMuaWRlbnRpdGllcy5nZXRJZGVudGl0eSh1c2VyVVJMKTtcclxuICAgICAgICAgICAgaWYgKGlkZW50aXR5KSByZXR1cm4gcmVzb2x2ZShpZGVudGl0eSk7XHJcbiAgICAgICAgICAgIGVsc2UgcmV0dXJuIHJlamVjdCgnW0lkZW50aXR5TW9kdWxlLmdldElkVG9rZW5dIElkZW50aXR5IG5vdCBmb3VuZCBmb3I6ICcsIHVzZXJVUkwpO1xyXG4gICAgICAgICAgfSBlbHNlIHsgcmV0dXJuIHJlamVjdCgnW0lkZW50aXR5TW9kdWxlLmdldElkVG9rZW5dIFVzZXIgbm90IGZvdW5kIGZvciBoeXBlcnR5OiAnLCByZXR1cm5lZEh5cGVydHlVUkwpOyB9XHJcbiAgICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgbG9nLmVycm9yKCdbSWRlbnRpdHlNb2R1bGUuZ2V0SWRUb2tlbl0gRXJyb3I6ICcsIHJlYXNvbik7XHJcbiAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB1c2VyVVJMID0gX3RoaXMucmVnaXN0cnkuZ2V0SHlwZXJ0eU93bmVyKGh5cGVydHlVUkwpO1xyXG4gICAgICAgIGlmICh1c2VyVVJMKSB7XHJcblxyXG4gICAgICAgICAgbGV0IGlkZW50aXR5ID0gX3RoaXMuaWRlbnRpdGllcy5nZXRJZGVudGl0eSh1c2VyVVJMKTtcclxuICAgICAgICAgIGlmIChpZGVudGl0eSkgcmV0dXJuIHJlc29sdmUoaWRlbnRpdHkpO1xyXG4gICAgICAgICAgZWxzZSByZXR1cm4gcmVqZWN0KCdbSWRlbnRpdHlNb2R1bGUuZ2V0SWRUb2tlbl0gSWRlbnRpdHkgbm90IGZvdW5kIGZvcjogJywgdXNlclVSTCk7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7IHJldHVybiByZWplY3QoJ1tJZGVudGl0eU1vZHVsZS5nZXRJZFRva2VuXSBVc2VyIG5vdCBmb3VuZCBmb3IgaHlwZXJ0eTogJywgdXNlclVSTCk7IH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGdldCBhbiBBY2Nlc3MgVG9rZW4gZm9yIGFuIGV4dGVybmFsIEFQSVxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgdXJsICAgICB0aGUgZXh0ZXJuYWwgdXJsXHJcbiAgKiBAcmV0dXJuIHtKU09OfSAgICB0b2tlbiAgICBBY2Nlc3MgdG9rZW4gdG8gYmUgYWRkZWQgdG8gdGhlIG1lc3NhZ2VcclxuICAqL1xyXG4gICBfZ2V0QWNjZXNzVG9rZW4obXNnKSB7XHJcbiAgICBsZXQgdXJsID0gbXNnLnRvO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgIGlmICghbXNnLmhhc093blByb3BlcnR5KCdib2R5JykpIHtcclxuICAgICAgICByZXR1cm4gcmVqZWN0KCdbSWRlbnRpdHlNb2R1bGUuX2dldEFjY2Vzc1Rva2VuXSBtaXNzaW5nIG1hbmRhdG9yeSBtc2cgYm9keTogJywgbXNnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIW1zZy5ib2R5Lmhhc093blByb3BlcnR5KCd2YWx1ZScpKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdCgnW0lkZW50aXR5TW9kdWxlLl9nZXRBY2Nlc3NUb2tlbl0gbWlzc2luZyBtYW5kYXRvcnkgbXNnIGJvZHkgdmFsdWU6ICcsIG1zZyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCFtc2cuYm9keS52YWx1ZS5oYXNPd25Qcm9wZXJ0eSgncmVzb3VyY2VzJykpIHtcclxuICAgICAgICByZXR1cm4gcmVqZWN0KCdbSWRlbnRpdHlNb2R1bGUuX2dldEFjY2Vzc1Rva2VuXSBtaXNzaW5nIG1hbmRhdG9yeSBtc2cgYm9keSB2YWx1ZSByZXNvdXJjZXM6ICcsIG1zZyk7XHJcbiAgICAgIH1cclxuICAgICAgbGV0IGRvbWFpblRvQ2hlY2sgPSBkaXZpZGVVUkwodXJsKS5kb21haW47XHJcbiAgXHJcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJ3Byb3Rvc3R1YicpKSB7XHJcbiAgICAgICAgZG9tYWluVG9DaGVjayA9IGRvbWFpblRvQ2hlY2sucmVwbGFjZShkb21haW5Ub0NoZWNrLnNwbGl0KCcuJylbMF0gKyAnLicsICcnKTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICBsZXQgcmVzb3VyY2VzID0gbXNnLmJvZHkudmFsdWUucmVzb3VyY2VzO1xyXG4gIFxyXG4gICAgICBfdGhpcy5fZ2V0QWNjZXNzVG9rZW5Gb3JEb21haW4oZG9tYWluVG9DaGVjaywgcmVzb3VyY2VzKS50aGVuKCh0b2tlbik9PntcclxuICAgICAgICByZXNvbHZlKHRva2VuKTtcclxuICAgICAgfSk7XHJcbiAgXHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxuICAgfVxyXG5cclxuICBfZ2V0QWNjZXNzVG9rZW5Gb3JEb21haW4oZG9tYWluVG9DaGVjaywgcmVzb3VyY2VzKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IHRva2VuO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIHRva2VuID0gX3RoaXMuaWRlbnRpdGllcy5nZXRBY2Nlc3NUb2tlbihkb21haW5Ub0NoZWNrLCByZXNvdXJjZXMpO1xyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdCgnW0lkZW50aXR5TW9kdWxlLl9nZXRBY2Nlc3NUb2tlbkZvckRvbWFpbl0gQWNjZXNzIFRva2VuIGVycm9yICcgKyBlcnIpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgX3RoaXMuX2dldE5ld0FjY2Vzc1Rva2VuKGRvbWFpblRvQ2hlY2ssIHJlc291cmNlcykudGhlbigodG9rZW4pID0+IHtcclxuICAgICAgICAgIGxvZy5sb2coJ1tJZGVudGl0eS5JZGVudGl0eU1vZHVsZS5fZ2V0QWNjZXNzVG9rZW5Gb3JEb21haW5dIG5ldyBBY2Nlc3MgVG9rZW4gJywgdG9rZW4pO1xyXG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUodG9rZW4pO1xyXG4gICAgICAgIH0pLmNhdGNoKGVyciA9PiB7IHJlamVjdCgnW0lkZW50aXR5TW9kdWxlLl9nZXRBY2Nlc3NUb2tlbkZvckRvbWFpbl0gb24gZ2V0TmV3QWNjZXNzVG9rZW4gJyArIGVycik7IH0pO1xyXG4gICAgICB9IGVsc2UgaWYgKHRva2VuLnN0YXR1cyA9PT0gJ2luLXByb2dyZXNzJykge1xyXG4gICAgICAgIHJldHVybiByZXNvbHZlKF90aGlzLl9pblByb2dyZXNzQWNjZXNzVG9rZW4oZG9tYWluVG9DaGVjaywgcmVzb3VyY2VzKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHRpbWVOb3cgPSBzZWNvbmRzU2luY2VFcG9jaCgpO1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbSWRlbnRpdHkuSWRlbnRpdHlNb2R1bGUuX2dldEFjY2Vzc1Rva2VuRm9yRG9tYWluXSBmb3VuZCAgQWNjZXNzIFRva2VuICcsIHRva2VuKTtcclxuXHJcbiAgICAgICAgaWYgKHRpbWVOb3cgPj0gdG9rZW4uZXhwaXJlcykge1xyXG4vLyAgICAgICAgaWYgKHRydWUpIHtcclxuICAgICAgICAgIGlmICh0b2tlbi5oYXNPd25Qcm9wZXJ0eShcInJlZnJlc2hcIikpIHtcclxuICAgICAgICAgICAgX3RoaXMuX3JlZnJlc2hBY2Nlc3NUb2tlbihkZWVwQ2xvbmUodG9rZW4pKS50aGVuKChuZXdUb2tlbik9PntcclxuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoX3RoaXMuaWRlbnRpdGllcy51cGRhdGVBY2Nlc3NUb2tlbihuZXdUb2tlbikpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHJldHVybiByZXNvbHZlKF90aGlzLl9nZXROZXdBY2Nlc3NUb2tlbihkb21haW5Ub0NoZWNrLCByZXNvdXJjZXMpKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHJldHVybiByZXNvbHZlKGRlZXBDbG9uZSh0b2tlbikpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaW5Qcm9ncmVzc0FjY2Vzc1Rva2VuKGRvbWFpbiwgcmVzb3VyY2VzKSB7XHJcbiAgICB0aGlzLmlkZW50aXRpZXMud2F0Y2hpbmdZb3Uub2JzZXJ2ZSgnYWNjZXNzVG9rZW5zJywgKGNoYW5nZSkgPT4ge1xyXG5cclxuICAgICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlLl9pblByb2dyZXNzQWNjZXNzVG9rZW5dIGFjY2Vzc1Rva2VucyBjaGFuZ2VkICcgKyB0aGlzLmlkZW50aXRpZXMuYWNjZXNzVG9rZW5zKTtcclxuXHJcbiAgICAgIGxldCBrZXlwYXRoID0gY2hhbmdlLmtleXBhdGg7XHJcblxyXG4gICAgICBpZiAoa2V5cGF0aC5pbmNsdWRlcygnc3RhdHVzJykpIHtcclxuICAgICAgICBrZXlwYXRoID0ga2V5cGF0aC5yZXBsYWNlKCcuc3RhdHVzJywgJycpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoa2V5cGF0aCA9PT0gZG9tYWluICYmIGNoYW5nZS5uYW1lID09PSAnc3RhdHVzJyAmJiBjaGFuZ2UubmV3VmFsdWUgPT09ICdjcmVhdGVkJykge1xyXG4gICAgICAgIC8vIGxvZy5sb2coJ1tJZGVudGl0eS5JZGVudGl0eU1vZHVsZS5nZXRUb2tlbl0gdG9rZW4gaXMgY3JlYXRlZCAnICsgX3RoaXMuaWRlbnRpdGllc0xpc3RbZG9tYWluXSk7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmlkZW50aXRpZXMuZ2V0QWNjZXNzVG9rZW4oZG9tYWluLCByZXNvdXJjZXMpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIF9nZXROZXdBY2Nlc3NUb2tlbihkb21haW4sIHJlc291cmNlcykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBfdGhpcy5pZGVudGl0aWVzLnNldEFjY2Vzc1Rva2VuSW5Qcm9ncmVzcyhkb21haW4pO1xyXG5cclxuICAgICAgbGV0IG1lc3NhZ2UgPSB7XHJcbiAgICAgICAgdHlwZTogJ2V4ZWN1dGUnLFxyXG4gICAgICAgIHRvOiBfdGhpcy5fcmVzb2x2ZURvbWFpbihkb21haW4pLFxyXG4gICAgICAgIGZyb206IF90aGlzLl9pZG1VUkwsXHJcbiAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgbWV0aG9kOiAnZ2V0QWNjZXNzVG9rZW5BdXRob3Jpc2F0aW9uRW5kcG9pbnQnLFxyXG4gICAgICAgICAgcGFyYW1zOiByZXNvdXJjZXNcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvL2xldCdzIGZpcnN0IGdldCB0aGUgYXV0aG9yaXNhdGlvbiBVUkwgZnJvbSB0aGUgSWRwIFByb3h5XHJcbiAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLmJvZHkuY29kZSA+IDI5OSkge1xyXG4gICAgICAgICAgcmV0dXJuIHJlamVjdCgnW0lkZW50aXR5TW9kdWxlLl9nZXROZXdBY2Nlc3NUb2tlbl0gRXJyb3Igb24gZ2V0QWNjZXNzVG9rZW5BdXRob3Jpc2F0aW9uRW5kcG9pbnQgZnJvbSBJZFAgUHJveHk6ICcsIHJlcy5ib2R5LmRlc2MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gbGV0J3MgYXNrIHRoZSB1c2VyIGZvciBhdXRob3Jpc2F0aW9uXHJcbiAgICAgICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnb3BlblBvcHVwJywgeyB1cmxyZWNlaXZlZDogcmVzLmJvZHkudmFsdWUgfSkudGhlbigoYXV0aG9yaXNhdGlvbikgPT4ge1xyXG4gICAgICAgICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlOmNhbGxJZGVudGl0eU1vZHVsZUZ1bmM6b3BlblBvcHVwXSBhdWh0b3Jpc2F0aW9uIHJlc3VsdDogJywgYXV0aG9yaXNhdGlvbik7XHJcblxyXG4gICAgICAgICAgbWVzc2FnZS5ib2R5Lm1ldGhvZCA9ICdnZXRBY2Nlc3NUb2tlbic7XHJcbiAgICAgICAgICBtZXNzYWdlLmJvZHkucGFyYW1zID0ge1xyXG4gICAgICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcyxcclxuICAgICAgICAgICAgbG9naW46IGF1dGhvcmlzYXRpb25cclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgLy93aWh0b3V0IGNhbGxiYWNrIHRvIGF2b2lkIHRpbWVvdXQgZXJyb3JzP1xyXG5cclxuICAgICAgICAgIC8vIGxldCdzIGFzayBBY2Nlc3MgVG9rZW4gZnJvbSB0aGUgSWRwIFByb3h5XHJcbiAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCAocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMuYm9keS5jb2RlID4gMjk5KSByZXR1cm4gcmVqZWN0KCdbSWRlbnRpdHlNb2R1bGUuX2dldE5ld0FjY2Vzc1Rva2VuXSBFcnJvciBvbiBnZXRBY2Nlc3NUb2tlbiBmcm9tIElkUCBQcm94eTogJywgcmVzLmJvZHkuZGVzYyk7XHJcblxyXG4gICAgICAgICAgICBfdGhpcy5pZGVudGl0aWVzLmFkZEFjY2Vzc1Rva2VuKHJlcy5ib2R5LnZhbHVlKS50aGVuKCh0b2tlbikgPT4ge1xyXG4gICAgICAgICAgICAgIGxvZy5pbmZvKCdbSWRlbnRpdHlNb2R1bGUuX2dldE5ld0FjY2Vzc1Rva2VuXSByZXNvbHZpbmcgdG9rZW46ICcsIHRva2VuKTtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXMuYm9keS52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICB9LCAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBfcmVmcmVzaEFjY2Vzc1Rva2VuKG91dGRhdGVkVG9rZW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy8gICAgbGV0IGRvbWFpbiA9IF90aGlzLl9yZXNvbHZlRG9tYWluKG9sZElkZW50aXR5LmlkcCk7XHJcbiAgICAvLyAgICBsZXQgbWVzc2FnZTtcclxuICAgIC8vICAgIGxldCBhc3NlcnRpb24gPSBfdGhpcy5nZXRJZGVudGl0eShvbGRJZGVudGl0eS51c2VyUHJvZmlsZS51c2VyVVJMKTtcclxuXHJcbiAgICBsb2cubG9nKCdJZGVudGl0eU1vZHVsZS5fcmVmcmVzaEFjY2Vzc1Rva2VuOm91dGRhdGVkVG9rZW4nLCBvdXRkYXRlZFRva2VuKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IGRvbWFpbiA9IF90aGlzLl9yZXNvbHZlRG9tYWluKG91dGRhdGVkVG9rZW4uZG9tYWluKTtcclxuICAgICAgbGV0IG1lc3NhZ2U7XHJcblxyXG4gICAgICBtZXNzYWdlID0geyB0eXBlOiAnZXhlY3V0ZScsIHRvOiBkb21haW4sIGZyb206IF90aGlzLl9pZG1VUkwsIGJvZHk6IHsgbWV0aG9kOiAncmVmcmVzaEFjY2Vzc1Rva2VuJywgcGFyYW1zOiB7IHRva2VuOiBvdXRkYXRlZFRva2VuIH0gfSB9O1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIChyZXMpID0+IHtcclxuICAgICAgICAgIGxldCByZXN1bHQgPSByZXMuYm9keS52YWx1ZTtcclxuICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgcmVqZWN0KCdJbiBJZGVudGl0eU1vZHVsZS5fcmVmcmVzaEFjY2Vzc1Rva2VuIG9uIHBvc3RNZXNzYWdlIGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIHNlbmRSZWZyZXNoTWVzc2FnZShvbGRJZGVudGl0eSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAvLyAgICBsZXQgZG9tYWluID0gX3RoaXMuX3Jlc29sdmVEb21haW4ob2xkSWRlbnRpdHkuaWRwKTtcclxuICAgIC8vICAgIGxldCBtZXNzYWdlO1xyXG4gICAgLy8gICAgbGV0IGFzc2VydGlvbiA9IF90aGlzLmdldElkZW50aXR5KG9sZElkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJVUkwpO1xyXG5cclxuICAgIGxvZy5sb2coJ3NlbmRSZWZyZXNoTWVzc2FnZTpvbGRJZGVudGl0eScsIG9sZElkZW50aXR5KTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBsZXQgZG9tYWluID0gX3RoaXMuX3Jlc29sdmVEb21haW4ob2xkSWRlbnRpdHkuaWRwLmRvbWFpbik7XHJcbiAgICAgIGxldCBtZXNzYWdlO1xyXG4gICAgICBsZXQgYXNzZXJ0aW9uID0gX3RoaXMuZ2V0SWRlbnRpdHkob2xkSWRlbnRpdHkudXNlclByb2ZpbGUudXNlclVSTCk7XHJcblxyXG4gICAgICBsb2cuaW5mbygnc2VuZFJlZnJlc2hNZXNzYWdlOm9sZElkZW50aXR5Jywgb2xkSWRlbnRpdHkpO1xyXG5cclxuICAgICAgbWVzc2FnZSA9IHsgdHlwZTogJ2V4ZWN1dGUnLCB0bzogZG9tYWluLCBmcm9tOiBfdGhpcy5faWRtVVJMLCBib2R5OiB7IHJlc291cmNlOiAnaWRlbnRpdHknLCBtZXRob2Q6ICdyZWZyZXNoQXNzZXJ0aW9uJywgcGFyYW1zOiB7IGlkZW50aXR5OiBhc3NlcnRpb24gfSB9IH07XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgKHJlcykgPT4ge1xyXG4gICAgICAgICAgaWYgKHJlcy5ib2R5LmNvZGUgPCAzMDApIHtcclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHJlcy5ib2R5LnZhbHVlO1xyXG4gICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICB9IGVsc2UgcmVzb2x2ZShyZXMuYm9keS52YWx1ZS5ib2R5LnBhcmFtcyxpZGVudGl0eSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIHJlamVjdCgnSW4gc2VuZFJlZnJlc2hNZXNzYWdlIG9uIHBvc3RNZXNzYWdlIGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGdldEFjY2Vzc1Rva2VuKGlkcERvbWFpbiwgcmVzb3VyY2VzLCBsb2dpbikge1xyXG4gICAgbG9nLmxvZygnW2dldEFjY2Vzc1Rva2VuOmlkcERvbWFpbl0nLCBpZHBEb21haW4pO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IGRvbWFpbiA9IF90aGlzLl9yZXNvbHZlRG9tYWluKGlkcERvbWFpbik7XHJcbiAgICAgIGxldCBtZXNzYWdlO1xyXG5cclxuICAgICAgbWVzc2FnZSA9IHtcclxuICAgICAgICB0eXBlOiAnZXhlY3V0ZScsIHRvOiBkb21haW4sIGZyb206IF90aGlzLl9pZG1VUkwsIGJvZHk6IHsgcmVzb3VyY2U6ICdpZGVudGl0eScsIG1ldGhvZDogJ2dldEFjY2Vzc1Rva2VuJywgcGFyYW1zOiB7IHJlc291cmNlczogcmVzb3VyY2VzLCBsb2dpbjogbG9naW4gfSB9XHJcbiAgICAgIH07XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgKHJlcykgPT4ge1xyXG5cclxuICAgICAgICAgIGlmIChyZXMuYm9keS5jb2RlIDwgMjk5KSB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXMuYm9keS52YWx1ZTtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgfSBlbHNlIHJlc29sdmUocmVzLmJvZHkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICByZWplY3QoJ0lkZW50aXR5TW9kdWxlLkluIGdldEFjY2Vzc1Rva2VuOiAnICsgZXJyKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRBY2Nlc3NUb2tlbkF1dGhvcmlzYXRpb25FbmRwb2ludChzY29wZSwgaWRwRG9tYWluKSB7XHJcbiAgICBsb2cubG9nKCdbZ2V0QWNjZXNzVG9rZW5BdXRob3Jpc2F0aW9uRW5kcG9pbnQ6aWRwRG9tYWluXScsIGlkcERvbWFpbik7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgZG9tYWluID0gX3RoaXMuX3Jlc29sdmVEb21haW4oaWRwRG9tYWluKTtcclxuICAgICAgbGV0IG1lc3NhZ2U7XHJcblxyXG4gICAgICBtZXNzYWdlID0ge1xyXG4gICAgICAgIHR5cGU6ICdleGVjdXRlJywgdG86IGRvbWFpbiwgZnJvbTogX3RoaXMuX2lkbVVSTCwgYm9keTogeyByZXNvdXJjZTogJ2lkZW50aXR5JywgbWV0aG9kOiAnZ2V0QWNjZXNzVG9rZW5BdXRob3Jpc2F0aW9uRW5kcG9pbnQnLCBwYXJhbXM6IHsgcmVzb3VyY2VzOiBzY29wZSB9IH1cclxuICAgICAgfTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCAocmVzKSA9PiB7XHJcbiAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVzLmJvZHkudmFsdWU7XHJcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIHJlamVjdCgnSW4gZ2V0QWNjZXNzVG9rZW5BdXRob3Jpc2F0aW9uRW5kcG9pbnQ6ICcgKyBlcnIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNlbmRHZW5lcmF0ZU1lc3NhZ2UoY29udGVudHMsIG9yaWdpbiwgdXNlcm5hbWVIaW50LCBpZHBEb21haW4pIHtcclxuICAgIGxvZy5sb2coJ1tzZW5kR2VuZXJhdGVNZXNzYWdlOmNvbnRlbnRzXScsIGNvbnRlbnRzKTtcclxuICAgIGxvZy5sb2coJ1tzZW5kR2VuZXJhdGVNZXNzYWdlOm9yaWdpbl0nLCBvcmlnaW4pO1xyXG4gICAgbG9nLmxvZygnW3NlbmRHZW5lcmF0ZU1lc3NhZ2U6dXNlcm5hbWVIaW50XScsIHVzZXJuYW1lSGludCk7XHJcbiAgICBsb2cubG9nKCdbc2VuZEdlbmVyYXRlTWVzc2FnZTppZHBEb21haW5dJywgaWRwRG9tYWluKTtcclxuICAgIGxvZy5sb2coJ3NlbmRHZW5lcmF0ZU1lc3NhZ2VfaGludCcpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IGRvbWFpbiA9IF90aGlzLl9yZXNvbHZlRG9tYWluKGlkcERvbWFpbik7XHJcbiAgICAgIGxldCBtZXNzYWdlO1xyXG5cclxuICAgICAgbWVzc2FnZSA9IHtcclxuICAgICAgICB0eXBlOiAnZXhlY3V0ZScsIHRvOiBkb21haW4sIGZyb206IF90aGlzLl9pZG1VUkwsIGJvZHk6IHsgcmVzb3VyY2U6ICdpZGVudGl0eScsIG1ldGhvZDogJ2dlbmVyYXRlQXNzZXJ0aW9uJywgcGFyYW1zOiB7IGNvbnRlbnRzOiBjb250ZW50cywgb3JpZ2luOiBvcmlnaW4sIHVzZXJuYW1lSGludDogdXNlcm5hbWVIaW50IH0gfVxyXG4gICAgICB9O1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIChyZXMpID0+IHtcclxuXHJcbiAgICAgICAgICBpZiAocmVzLmJvZHkuY29kZSA8IDMwMCkgcmVzb2x2ZShyZXMuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICBlbHNlIHJlamVjdChyZXMuYm9keSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIHJlamVjdCgnSW4gc2VuZEdlbmVyYXRlTWVzc2FnZTogJyArIGVycik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBSZXF1ZXN0cyB0aGUgSWRwUHJveHkgZnJvbSBhIGdpdmVuIERvbWFpbiBmb3IgYW4gaWRlbnRpdHlBc3NlcnRpb25cclxuICAqXHJcbiAgKiBAcGFyYW0gIHtET01TdHJpbmd9IGNvbnRlbnRzICAgICBjb250ZW50c1xyXG4gICogQHBhcmFtICB7RE9NU3RyaW5nfSBvcmlnaW4gICAgICAgb3JpZ2luXHJcbiAgKiBAcGFyYW0gIHtET01TdHJpbmd9IHVzZXJuYW1lSGludCB1c2VybmFtZUhpbnRcclxuICAqIEBwYXJhbSAge0pTT059ICAgICAga2V5UGFpciAgICAgICB1c2VyIGtleVBhaXJcclxuICAqIEByZXR1cm4ge0lkQXNzZXJ0aW9ufSAgICAgICAgICAgICAgSWRBc3NlcnRpb25cclxuICAqL1xyXG4gIGdlbmVyYXRlQXNzZXJ0aW9uKGNvbnRlbnRzLCBvcmlnaW4sIHVzZXJuYW1lSGludCwgaWRwRG9tYWluKSB7XHJcbiAgICBsb2cubG9nKCdbZ2VuZXJhdGVBc3NlcnRpb246Y29udGVudHNdJywgY29udGVudHMpO1xyXG4gICAgbG9nLmxvZygnW2dlbmVyYXRlQXNzZXJ0aW9uOm9yaWdpbl0nLCBvcmlnaW4pO1xyXG4gICAgbG9nLmxvZygnW2dlbmVyYXRlQXNzZXJ0aW9uOnVzZXJuYW1lSGludF0nLCB1c2VybmFtZUhpbnQpO1xyXG5cclxuICAgIC8vICAgIGxvZy5sb2coJ1tnZW5lcmF0ZUFzc2VydGlvbjprZXlQYWlyXScsIGtleVBhaXIpO1xyXG4gICAgbG9nLmxvZygnW2dlbmVyYXRlQXNzZXJ0aW9uOmlkcERvbWFpbl0nLCBpZHBEb21haW4pO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIGxvZy5sb2coJ1tJZGVudGl0eU1vZHVsZTpzZW5kR2VuZXJhdGVNZXNzYWdlOnNlbmRHZW5lcmF0ZU1lc3NhZ2VdJywgdXNlcm5hbWVIaW50KTtcclxuICAgICAgX3RoaXMuc2VuZEdlbmVyYXRlTWVzc2FnZShjb250ZW50cywgb3JpZ2luLCB1c2VybmFtZUhpbnQsIGlkcERvbWFpbikudGhlbigocmVzdWx0KSA9PiB7XHJcblxyXG4gICAgICAgaWYgKHJlc3VsdCkge1xyXG5cclxuICAgICAgICAgIF90aGlzLmlkZW50aXRpZXMuYWRkQXNzZXJ0aW9uKHJlc3VsdCkudGhlbigodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVqZWN0KCdlcnJvciBvbiBvYnRhaW5pbmcgaWRlbnRpdHkgaW5mb3JtYXRpb24nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9LCAoZXJyb3IpPT4ge1xyXG4gICAgICAgIGlmIChlcnJvci5oYXNPd25Qcm9wZXJ0eSgnZGVzY3JpcHRpb24nKSAmJiBlcnJvci5kZXNjcmlwdGlvbi5oYXNPd25Qcm9wZXJ0eSgnbG9naW5VcmwnKSkge1xyXG4gICAgICAgICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnb3BlblBvcHVwJywgeyB1cmxyZWNlaXZlZDogZXJyb3IuZGVzY3JpcHRpb24ubG9naW5VcmwgfSkudGhlbigodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlOmNhbGxJZGVudGl0eU1vZHVsZUZ1bmM6b3BlblBvcHVwXScsIHVzZXJuYW1lSGludCk7XHJcbiAgXHJcbiAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2cuZXJyb3IoJ1tJZGVudGl0eU1vZHVsZTpzZW5kR2VuZXJhdGVNZXNzYWdlXSBnZW5lcmF0ZSBhc3NlcnRpb24gd2l0aCBoaW50IGVycm9yICcsIGVycm9yKTtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5jYXRjaChlcnIgPT4geyByZWplY3QoJ09uIGdlbmVyYXRlQXNzZXJ0aW9uIGZyb20gbWV0aG9kIHNlbmRHZW5lcmF0ZU1lc3NhZ2UgZXJyb3I6ICcgKyBlcnIpOyB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBSZXF1ZXN0cyB0aGUgSWRwUHJveHkgZnJvbSBhIGdpdmVuIERvbWFpbiB0byB2YWxpZGF0ZSBhbiBJZGVudGl0eUFzc2VydGlvblxyXG4gICogUmV0dXJucyBhIHByb21pc2Ugd2l0aCB0aGUgcmVzdWx0IGZyb20gdGhlIHZhbGlkYXRpb24uXHJcbiAgKiBAcGFyYW0gIHtET01TdHJpbmd9IGFzc2VydGlvblxyXG4gICogQHBhcmFtICB7RE9NU3RyaW5nfSBvcmlnaW4gICAgICAgb3JpZ2luXHJcbiAgKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgICAgIFByb21pc2UgICAgICAgICBwcm9taXNlIHdpdGggdGhlIHJlc3VsdCBmcm9tIHRoZSB2YWxpZGF0aW9uXHJcbiAgKi9cclxuICB2YWxpZGF0ZUFzc2VydGlvbihhc3NlcnRpb24sIG9yaWdpbiwgaWRwRG9tYWluKSB7XHJcbiAgICBsb2cubG9nKCdbdmFsaWRhdGVBc3NlcnRpb246YXNzZXJ0aW9uXScsIGFzc2VydGlvbik7XHJcbiAgICBsb2cubG9nKCdbdmFsaWRhdGVBc3NlcnRpb246b3JpZ2luXScsIG9yaWdpbik7XHJcbiAgICBsb2cubG9nKCdbdmFsaWRhdGVBc3NlcnRpb246aWRwRG9tYWluXScsIGlkcERvbWFpbik7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBkb21haW4gPSBfdGhpcy5fcmVzb2x2ZURvbWFpbihpZHBEb21haW4pO1xyXG5cclxuICAgIGxldCBtZXNzYWdlID0ge1xyXG4gICAgICB0eXBlOiAnZXhlY3V0ZScsIHRvOiBkb21haW4sIGZyb206IF90aGlzLl9pZG1VUkwsIGJvZHk6IHtcclxuICAgICAgICByZXNvdXJjZTogJ2lkZW50aXR5JywgbWV0aG9kOiAndmFsaWRhdGVBc3NlcnRpb24nLFxyXG4gICAgICAgIHBhcmFtczogeyBhc3NlcnRpb246IGFzc2VydGlvbiwgb3JpZ2luOiBvcmlnaW4gfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCAocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICBpZiAocmVzdWx0LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmJvZHkudmFsdWUpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KCdlcnJvcicsIHJlc3VsdC5ib2R5LmNvZGUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICByZWplY3QoJ09uIHZhbGlkYXRlQXNzZXJ0aW9uIGZyb20gbWV0aG9kIHBvc3RNZXNzYWdlIGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRHVUlMaXN0ZW5lcnMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9tZXNzYWdlQnVzLmFkZExpc3RlbmVyKF90aGlzLl9pZG1VUkwsIChtc2cpID0+IHtcclxuICAgICAgbGV0IGZ1bmNOYW1lID0gbXNnLmJvZHkubWV0aG9kO1xyXG5cclxuICAgICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlOmFkZEdVSUxpc3RlbmVyc10nLCBtc2csIG1zZy5ib2R5LCBmdW5jTmFtZSk7XHJcblxyXG4gICAgICBsZXQgcmV0dXJuZWRWYWx1ZTtcclxuXHJcbiAgICAgIGlmIChmdW5jTmFtZSA9PT0gJ2RlcGxveUdVSScpIHtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuZGVwbG95R1VJKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZnVuY05hbWUgPT09ICdnZXRJZGVudGl0aWVzVG9DaG9vc2UnKSB7XHJcbiAgICAgICAgX3RoaXMuZ2V0SWRlbnRpdGllc1RvQ2hvb3NlKCkudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAvLyBpZiB0aGUgZnVuY3Rpb24gcmVxdWVzdGVkIGlzIG5vdCBhIHByb21pc2VcclxuICAgICAgICAgIGxldCB2YWx1ZSA9IHsgdHlwZTogJ2V4ZWN1dGUnLCB2YWx1ZTogcmVzdWx0LCBjb2RlOiAyMDAgfTtcclxuICAgICAgICAgIGxldCByZXBseU1zZyA9IHsgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8sIGJvZHk6IHZhbHVlIH07XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShyZXBseU1zZyk7XHJcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgbG9nLmVycm9yKCdPbiBhZGRHVUlMaXN0ZW5lcnMgZnJvbSBpZiBzdG9yZUlkZW50aXR5IG1ldGhvZCBwb3N0TWVzc2FnZSBlcnJvcjogJyArIGVycik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgfSBlbHNlIGlmIChmdW5jTmFtZSA9PT0gJ3VucmVnaXN0ZXJJZGVudGl0eScpIHtcclxuICAgICAgICBsZXQgZW1haWwgPSBtc2cuYm9keS5wYXJhbXMuZW1haWw7XHJcbiAgICAgICAgcmV0dXJuZWRWYWx1ZSA9IF90aGlzLnVucmVnaXN0ZXJJZGVudGl0eShlbWFpbCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZnVuY05hbWUgPT09ICdnZXRNeVB1YmxpY0tleScpIHtcclxuICAgICAgICAvLyBiZWNhdXNlIGdlbmVyYXRlUlNBS2V5UGFpciBpcyBhIHByb21pc2VcclxuICAgICAgICAvLyB3ZSBoYXZlIHRvIHNlbmQgdGhlIG1lc3NhZ2Ugb25seSBhZnRlciBnZXR0aW5nIHRoZSBrZXkgcGFpclxyXG4gICAgICAgIF90aGlzLl9jcnlwdG8uZ2V0TXlQdWJsaWNLZXkoKS50aGVuKChwdWJLZXkpID0+IHtcclxuICAgICAgICAgIHB1YktleSA9IHN0cmluZ2lmeShwdWJLZXkpO1xyXG4gICAgICAgICAgbGV0IHZhbHVlID0geyB0eXBlOiAnZXhlY3V0ZScsIHZhbHVlOiBwdWJLZXksIGNvZGU6IDIwMCB9O1xyXG4gICAgICAgICAgbGV0IHJlcGx5TXNnID0geyBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCB0bzogbXNnLmZyb20sIGZyb206IG1zZy50bywgYm9keTogdmFsdWUgfTtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBsb2cuZXJyb3IoJ09uIGFkZEdVSUxpc3RlbmVycyBmcm9tIGlmIGdlbmVyYXRlUlNBS2V5UGFpciBtZXRob2QgcG9zdE1lc3NhZ2UgZXJyb3I6ICcgKyBlcnIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIGlmIChmdW5jTmFtZSA9PT0gJ3NlbmRHZW5lcmF0ZU1lc3NhZ2UnKSB7XHJcbiAgICAgICAgbGV0IGNvbnRlbnRzID0gbXNnLmJvZHkucGFyYW1zLmNvbnRlbnRzO1xyXG4gICAgICAgIGxldCBvcmlnaW4gPSBtc2cuYm9keS5wYXJhbXMub3JpZ2luO1xyXG4gICAgICAgIGxldCB1c2VybmFtZUhpbnQgPSBtc2cuYm9keS5wYXJhbXMudXNlcm5hbWVIaW50O1xyXG4gICAgICAgIGxldCBpZHBEb21haW4gPSBtc2cuYm9keS5wYXJhbXMuaWRwRG9tYWluO1xyXG4gICAgICAgIGxldCByZXBseU1zZyA9IHsgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8gfTtcclxuICAgICAgICBfdGhpcy5zZW5kR2VuZXJhdGVNZXNzYWdlKGNvbnRlbnRzLCBvcmlnaW4sIHVzZXJuYW1lSGludCwgaWRwRG9tYWluKS50aGVuKChyZXR1cm5lZFZhbHVlKSA9PiB7XHJcbiAgICAgICAgICBsZXQgdmFsdWUgPSB7IHR5cGU6ICdleGVjdXRlJywgdmFsdWU6IHJldHVybmVkVmFsdWUsIGNvZGU6IDIwMCB9O1xyXG4gICAgICAgICAgcmVwbHlNc2cuYm9keSA9IHZhbHVlO1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHlNc2cpO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGxvZy5lcnJvcignSWRlbnRpdHlNb2R1bGUuYWRkR1VJTGlzdGVuZXJzIHNlbmRHZW5lcmF0ZU1lc3NhZ2UgZXJyb3I6ICcgKyBlcnIpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LCAoZXJyKT0+IHtcclxuICAgICAgICAgIGxvZy5pbmZvKCdJRFBQcm94eSBnZW5lcmF0ZUFzc2VydGlvbiByZXBseSBlcnJvciAnICsgZXJyKTtcclxuICAgICAgICAgIHJlcGx5TXNnLmJvZHkgPSBlcnI7XHJcbiAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShyZXBseU1zZyk7XHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIGlmIChmdW5jTmFtZSA9PT0gJ2dldEFjY2Vzc1Rva2VuQXV0aG9yaXNhdGlvbkVuZHBvaW50Jykge1xyXG4gICAgICAgIGxldCBzY29wZSA9IG1zZy5ib2R5LnBhcmFtcy5zY29wZTtcclxuICAgICAgICBsZXQgaWRwRG9tYWluID0gbXNnLmJvZHkucGFyYW1zLmlkcERvbWFpbjtcclxuICAgICAgICBfdGhpcy5nZXRBY2Nlc3NUb2tlbkF1dGhvcmlzYXRpb25FbmRwb2ludChzY29wZSwgaWRwRG9tYWluKS50aGVuKChyZXR1cm5lZFZhbHVlKSA9PiB7XHJcbiAgICAgICAgICBsZXQgdmFsdWUgPSB7IHR5cGU6ICdleGVjdXRlJywgdmFsdWU6IHJldHVybmVkVmFsdWUsIGNvZGU6IDIwMCB9O1xyXG4gICAgICAgICAgbGV0IHJlcGx5TXNnID0geyBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCB0bzogbXNnLmZyb20sIGZyb206IG1zZy50bywgYm9keTogdmFsdWUgfTtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBsb2cuZXJyb3IoJ09uIGFkZEdVSUxpc3RlbmVycyBmcm9tIGlmIHNlbmRHZW5lcmF0ZU1lc3NhZ2UgbWV0aG9kIHBvc3RNZXNzYWdlIGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2UgaWYgKGZ1bmNOYW1lID09PSAnYWRkQWNjZXNzVG9rZW4nKSB7XHJcbiAgICAgICAgbGV0IGFjY2Vzc1Rva2VuID0gbXNnLmJvZHkucGFyYW1zO1xyXG5cclxuICAgICAgICBfdGhpcy5pZGVudGl0aWVzLmFkZEFjY2Vzc1Rva2VuKGFjY2Vzc1Rva2VuKS50aGVuKChyZXR1cm5lZFZhbHVlKSA9PiB7XHJcbiAgICAgICAgICBsZXQgdmFsdWUgPSB7IHR5cGU6ICdleGVjdXRlJywgdmFsdWU6IHJldHVybmVkVmFsdWUsIGNvZGU6IDIwMCB9O1xyXG4gICAgICAgICAgbGV0IHJlcGx5TXNnID0geyBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCB0bzogbXNnLmZyb20sIGZyb206IG1zZy50bywgYm9keTogdmFsdWUgfTtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBsb2cuZXJyb3IoJ09uIGFkZEdVSUxpc3RlbmVycyBmcm9tIGlmIHN0b3JlSWRlbnRpdHkgbWV0aG9kIHBvc3RNZXNzYWdlIGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2UgaWYgKGZ1bmNOYW1lID09PSAnZ2V0QWNjZXNzVG9rZW4nKSB7XHJcblxyXG4gICAgICAgIGxldCBkb21haW4gPSBtc2cuYm9keS5wYXJhbXMuaWRwRG9tYWluO1xyXG4gICAgICAgIGxldCByZXNvdXJjZXMgPSBtc2cuYm9keS5wYXJhbXMucmVzb3VyY2VzO1xyXG4gICAgICAgIGxldCBsb2dpbiA9IG1zZy5ib2R5LnBhcmFtcy5sb2dpbjtcclxuICAgICAgICBsZXQgcmVwbHlNc2cgPSB7IGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIHRvOiBtc2cuZnJvbSwgZnJvbTogbXNnLnRvfTtcclxuXHJcbiAgICAgICAgX3RoaXMuZ2V0QWNjZXNzVG9rZW4oZG9tYWluLCByZXNvdXJjZXMsIGxvZ2luKS50aGVuKChyZXR1cm5lZFZhbHVlKSA9PiB7XHJcbiAgICAgICAgICBsZXQgdmFsdWUgPSB7IHR5cGU6ICdleGVjdXRlJywgdmFsdWU6IHJldHVybmVkVmFsdWUsIGNvZGU6IDIwMCB9O1xyXG4gICAgICAgICAgcmVwbHlNc2cuYm9keSA9IHZhbHVlO1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHlNc2cpO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGxvZy5lcnJvcignT24gYWRkR1VJTGlzdGVuZXJzIGZyb20gaWYgc2VuZEdlbmVyYXRlTWVzc2FnZSBtZXRob2QgcG9zdE1lc3NhZ2UgZXJyb3I6ICcgKyBlcnIpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LCAoZXJyb3IpID0+IHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJlcGx5TXNnLmJvZHkgPSBlcnJvcjtcclxuICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHlNc2cpO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGxvZy5lcnJvcignT24gYWRkR1VJTGlzdGVuZXJzIGZyb20gaWYgc2VuZEdlbmVyYXRlTWVzc2FnZSBtZXRob2QgcG9zdE1lc3NhZ2UgZXJyb3I6ICcgKyBlcnIpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSBpZiAoZnVuY05hbWUgPT09ICdhZGRBc3NlcnRpb24nKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IG1zZy5ib2R5LnBhcmFtcztcclxuXHJcbiAgICAgICAgLy8gICAgICAgIGxldCBrZXlQYWlyID0gbXNnLmJvZHkucGFyYW1zLmtleVBhaXI7XHJcbiAgICAgICAgX3RoaXMuaWRlbnRpdGllcy5hZGRBc3NlcnRpb24ocmVzdWx0KS50aGVuKChyZXR1cm5lZFZhbHVlKSA9PiB7XHJcbiAgICAgICAgICBsZXQgdmFsdWUgPSB7IHR5cGU6ICdleGVjdXRlJywgdmFsdWU6IHJldHVybmVkVmFsdWUsIGNvZGU6IDIwMCB9O1xyXG4gICAgICAgICAgbGV0IHJlcGx5TXNnID0geyBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCB0bzogbXNnLmZyb20sIGZyb206IG1zZy50bywgYm9keTogdmFsdWUgfTtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBsb2cuZXJyb3IoJ09uIGFkZEdVSUxpc3RlbmVycyBmcm9tIGlmIHN0b3JlSWRlbnRpdHkgbWV0aG9kIHBvc3RNZXNzYWdlIGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2UgaWYgKGZ1bmNOYW1lID09PSAncmVmcmVzaEFjY2Vzc1Rva2VuJykge1xyXG4gICAgICAgIGxldCBkb21haW4gPSBtc2cuYm9keS5wYXJhbXMuZG9tYWluO1xyXG4gICAgICAgIGxldCByZXNvdXJjZXMgPSBtc2cuYm9keS5wYXJhbXMucmVzb3VyY2VzO1xyXG5cclxuICAgICAgICBfdGhpcy5fZ2V0QWNjZXNzVG9rZW5Gb3JEb21haW4oZG9tYWluLCByZXNvdXJjZXMpLnRoZW4oKHRva2VuKT0+IHtcclxuICAgICAgICAgIGxldCByZXBseU1zZyA9IHsgXHJcbiAgICAgICAgICAgIGlkOiBtc2cuaWQsIFxyXG4gICAgICAgICAgICB0eXBlOiAncmVzcG9uc2UnLCBcclxuICAgICAgICAgICAgdG86IG1zZy5mcm9tLCBcclxuICAgICAgICAgICAgZnJvbTogbXNnLnRvLCBcclxuICAgICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICAgIHZhbHVlOiB0b2tlbi5hY2Nlc3NUb2tlbixcclxuICAgICAgICAgICAgICBjb2RlOiAyMDBcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShyZXBseU1zZyk7XHJcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgbG9nLmVycm9yKCdPbiBhZGRHVUlMaXN0ZW5lcnMgZm9yIHJlZnJlc2hBY2Nlc3NUb2tlbiByZXF1ZXN0OiAnICsgZXJyKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9LyplbHNlIGlmIChmdW5jTmFtZSA9PT0gJ3NlbGVjdElkZW50aXR5Rm9ySHlwZXJ0eScpIHtcclxuICAgICAgICBsZXQgb3JpZ2luID0gbXNnLmJvZHkucGFyYW1zLm9yaWdpbjtcclxuICAgICAgICBsZXQgaWRwID0gbXNnLmJvZHkucGFyYW1zLmlkcDtcclxuICAgICAgICBsZXQgaWRIaW50ID0gbXNnLmJvZHkucGFyYW1zLmlkSGludDtcclxuICAgICAgICBfdGhpcy5zZWxlY3RJZGVudGl0eUZvckh5cGVydHkob3JpZ2luLCBpZHAsIGlkSGludCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9Ki9cclxuXHJcbiAgICAgIC8vIGlmIHRoZSBmdW5jdGlvbiByZXF1ZXN0ZWQgaXMgbm90IGEgcHJvbWlzZVxyXG4gICAgICBsZXQgdmFsdWUgPSB7IHR5cGU6ICdleGVjdXRlJywgdmFsdWU6IHJldHVybmVkVmFsdWUsIGNvZGU6IDIwMCB9O1xyXG4gICAgICBsZXQgcmVwbHlNc2cgPSB7IGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIHRvOiBtc2cuZnJvbSwgZnJvbTogbXNnLnRvLCBib2R5OiB2YWx1ZSB9O1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcclxuICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgbG9nLmVycm9yKCdPbiBhZGRHVUlMaXN0ZW5lcnMgZnJvbSBpZiBzdG9yZUlkZW50aXR5IG1ldGhvZCBwb3N0TWVzc2FnZSBlcnJvcjogJyArIGVycik7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlcGxveUdVSSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5ndWlEZXBsb3llZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvLyoqKioqKioqKioqKioqKioqKiogUFJJVkFURSBNRVRIT0RTICoqKioqKioqKioqKioqKioqKipcclxuICAvKipcclxuICAgKiBHZXRWYWxpZFRva2VuIGlzIGZvciBub24gbGVnYWN5IGh5cGVydGllcyBhbmQgdmVyaWZpZXMgaWYgdGhlIFRva2VuIGlzIHN0aWxsIHZhbGlkXHJcbiAgICogaWYgdGhlIHRva2VuIGlzIGludmFsaWQgaXQgcmVxdWVzdHMgYSBuZXcgdG9rZW5cclxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IGh5cGVydHlVUkwgaHlwZXJ0eVVSTFxyXG4gICAqIEByZXR1cm4ge1Byb21pc2V9XHJcbiAgICovXHJcbiAgX2dldFZhbGlkVG9rZW4oaHlwZXJ0eVVSTCkge1xyXG4gICAgbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlLl9nZXRWYWxpZFRva2VuXTpoeXBlcnR5VVJMJywgaHlwZXJ0eVVSTCk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgX3RoaXMuZ2V0SWRUb2tlbihoeXBlcnR5VVJMKS50aGVuKGZ1bmN0aW9uKGFzc2VydGlvbikge1xyXG4gICAgICAgIGxvZy5sb2coJ1tJZGVudGl0eU1vZHVsZS5fZ2V0VmFsaWRUb2tlbl0gcmV0cmlldmVkIElkQXNzZXJ0aW9uJywgYXNzZXJ0aW9uKTtcclxuICAgICAgICBsZXQgdGltZU5vdyA9IHNlY29uZHNTaW5jZUVwb2NoKCk7XHJcblxyXG4gICAgICAgIGlmICghYXNzZXJ0aW9uLmhhc093blByb3BlcnR5KCdleHBpcmVzJykpIHJldHVybiByZXNvbHZlKGFzc2VydGlvbik7XHJcblxyXG4gICAgICAgIGxldCBleHBpcmF0aW9uRGF0ZSA9IGFzc2VydGlvbi5leHBpcmVzO1xyXG5cclxuICAgICAgICAvKiBpZiAoY29tcGxldGVJZC5oYXNPd25Qcm9wZXJ0eSgnaW5mbycpKSB7XHJcbiAgICAgICAgICBpZiAoY29tcGxldGVJZC5pbmZvLmhhc093blByb3BlcnR5KCdleHBpcmVzJykpIHtcclxuICAgICAgICAgICAgZXhwaXJhdGlvbkRhdGUgPSBjb21wbGV0ZUlkLmluZm8uZXhwaXJlcztcclxuICAgICAgICAgIH0gZWxzZSBpZiAoY29tcGxldGVJZC5pbmZvLmhhc093blByb3BlcnR5KCd0b2tlbklESlNPTicpKSB7XHJcbiAgICAgICAgICAgIGV4cGlyYXRpb25EYXRlID0gY29tcGxldGVJZC5pbmZvLnRva2VuSURKU09OLmV4cDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRocm93ICdUaGUgSUQgVG9rZW4gZG9lcyBub3QgaGF2ZSBhbiBleHBpcmF0aW9uIHRpbWUnO1xyXG4gICAgICAgICAgICBsb2cuaW5mbygnVGhlIElEIFRva2VuIGRvZXMgbm90IGhhdmUgYW4gZXhwaXJhdGlvbiB0aW1lJyk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoYXNzZXJ0aW9uKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGNvbXBsZXRlSWQuaGFzT3duUHJvcGVydHkoJ2luZm9Ub2tlbicpICYmIGNvbXBsZXRlSWQuaW5mb1Rva2VuLmhhc093blByb3BlcnR5KCdleHAnKSkge1xyXG4gICAgICAgICAgZXhwaXJhdGlvbkRhdGUgPSBjb21wbGV0ZUlkLmluZm9Ub2tlbi5leHA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIHRocm93ICdUaGUgSUQgVG9rZW4gZG9lcyBub3QgaGF2ZSBhbiBleHBpcmF0aW9uIHRpbWUnO1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1RoZSBJRCBUb2tlbiBkb2VzIG5vdCBoYXZlIGFuIGV4cGlyYXRpb24gdGltZScpO1xyXG4gICAgICAgICAgcmVzb2x2ZShhc3NlcnRpb24pO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbSWRlbnRpdHkuSWRlbnRpdHlNb2R1bGUuZ2V0VmFsaWRUb2tlbl0gVG9rZW4gZXhwaXJlcyBpbicsIGV4cGlyYXRpb25EYXRlKTtcclxuICAgICAgICBsb2cubG9nKCdbSWRlbnRpdHkuSWRlbnRpdHlNb2R1bGUuZ2V0VmFsaWRUb2tlbl0gdGltZSBub3c6JywgdGltZU5vdyk7XHJcblxyXG4gICAgICAgIGlmICh0aW1lTm93ID49IGV4cGlyYXRpb25EYXRlKSB7XHJcbi8vICAgICAgICBpZiAodGltZU5vdyA+PSAwKSB7XHJcbiAgICAgICAgICAgIGlmIChhc3NlcnRpb24uaGFzT3duUHJvcGVydHkoJ3JlZnJlc2gnKSkge1xyXG4gICAgICAgICAgICAgIGxvZy5sb2coJ1tJZGVudGl0eS5JZGVudGl0eU1vZHVsZS5nZXRWYWxpZFRva2VuXSByZWZyZXNoaW5nIGFzc2VydGlvbjogJywgYXNzZXJ0aW9uKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIF90aGlzLnNlbmRSZWZyZXNoTWVzc2FnZShhc3NlcnRpb24pLnRoZW4oKG5ld0Fzc2VydGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgbG9nLmxvZygnW0lkZW50aXR5LklkZW50aXR5TW9kdWxlLmdldFZhbGlkVG9rZW5dIHJlZnJlc2hlZCBhc3NlcnRpb246ICcsIG5ld0Fzc2VydGlvbik7XHJcbiAgICAgICAgICAgICAgX3RoaXMuaWRlbnRpdGllcy51cGRhdGVBc3NlcnRpb24obmV3QXNzZXJ0aW9uKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUobmV3QXNzZXJ0aW9uKTtcclxuICAgICAgICAgICAgICB9LCAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoJ1tJZGVudGl0eU1vZHVsZS5nZXRWYWxpZFRva2VuXSBlcnJvciB1cGRhdGluZyB0aGUgYXNzZXJ0aW9uICcsIGVycik7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgIGxvZy5lcnJvcignW0lkZW50aXR5TW9kdWxlLmdldFZhbGlkVG9rZW5dIGVycm9yIHJlZnJlc2hpbmcgdGhlIGFzc2VydGlvbiAnLCBlcnIpO1xyXG4gICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7IC8vIG5vIHJlZnJlc2ggdG9rZW4gYXZhaWxhYmxlLCB1c2VyIGhhcyB0byBhdXRoZW50aWNhdGUgYWdhaW4gdG8gZ2V0IGEgbmV3IGFzc2VydGlvblxyXG4gICAgICAgICAgICAvLyBnZW5lcmF0ZSBuZXcgaWRUb2tlblxyXG4gICAgICAgICAgICBfdGhpcy5jYWxsR2VuZXJhdGVNZXRob2RzKGFzc2VydGlvbi5pZHAuZG9tYWluKS50aGVuKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4geyByZWplY3QoJ1tJZGVudGl0eU1vZHVsZS5nZXRWYWxpZFRva2VuXSBlcnJvciB3aGVuIGdlbmVyYXRpbmcgYSBuZXcgYXNzZXJ0aW9uICcgKyBlcnIpOyB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzb2x2ZShhc3NlcnRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICBsb2cuZXJyb3IoJ1tJZGVudGl0eU1vZHVsZS5nZXRWYWxpZFRva2VuXSBlcnJvciBvbiBnZXRJZFRva2VuJywgZXJyb3IpO1xyXG4gICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIHJldHVybnMgdGhlIHJlcG9ydGVyIGFzc29jaWF0ZWQgdG8gdGhlIGRhdGFPYmplY3QgVVJMXHJcbiAgKiBAcGFyYW0gICB7U3RyaW5nfSAgIGRhdGFPYmplY3RVUkwgICAgICAgICBkYXRhT2JqZWN0IHVybFxyXG4gICogQHJldHVybiAgIHtTdHJpbmd9ICByZXBvcnRlciAgICAgICAgICAgICAgZGF0YU9iamVjdCB1cmwgcmVwb3J0ZXJcclxuICAqL1xyXG4gIF9nZXRIeXBlcnR5RnJvbURhdGFPYmplY3QoZGF0YU9iamVjdFVSTCkge1xyXG4gICAgbG9nLmluZm8oJ19nZXRIeXBlcnR5RnJvbURhdGFPYmplY3Q6ZGF0YU9iamVjdFVSTCcsIGRhdGFPYmplY3RVUkwpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBsZXQgc3BsaXRlZFVSTCA9IGRpdmlkZVVSTChkYXRhT2JqZWN0VVJMKTtcclxuICAgICAgbGV0IGRvbWFpbiA9IHNwbGl0ZWRVUkwuZG9tYWluO1xyXG4gICAgICBsZXQgZmluYWxVUkwgPSBwYXJzZU1lc3NhZ2VVUkwoZGF0YU9iamVjdFVSTCk7XHJcblxyXG4gICAgICAvLyBjaGVjayBpZiBpcyB0aGUgY3JlYXRvciBvZiB0aGUgaHlwZXJ0eVxyXG4gICAgICBsZXQgcmVwb3J0ZXJVUkwgPSBfdGhpcy5yZWdpc3RyeS5nZXRSZXBvcnRlclVSTFN5bmNob25vdXMoZmluYWxVUkwpO1xyXG4gICAgICBsb2cuaW5mbygnX2dldEh5cGVydHlGcm9tRGF0YU9iamVjdDpyZXBvcnRlclVSTCcsIHJlcG9ydGVyVVJMKTtcclxuXHJcbiAgICAgIGlmIChyZXBvcnRlclVSTCkge1xyXG4gICAgICAgIHJlc29sdmUocmVwb3J0ZXJVUkwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIGFscmVhZHkgYW4gYXNzb2NpYXRpb24gZnJvbSBhbiBoeXBlcnR5VVJMIHRvIHRoZSBkYXRhT2JqZWN0XHJcbiAgICAgICAgbGV0IHN0b3JlZFJlcG9ydGVyVVJMID0gX3RoaXMuZGF0YU9iamVjdHNJZGVudGl0eVtmaW5hbFVSTF07XHJcbiAgICAgICAgbG9nLmluZm8oJ19nZXRIeXBlcnR5RnJvbURhdGFPYmplY3Q6c3RvcmVkUmVwb3J0ZXJVUkwnLCBzdG9yZWRSZXBvcnRlclVSTCk7XHJcblxyXG4gICAgICAgIGlmIChzdG9yZWRSZXBvcnRlclVSTCkge1xyXG4gICAgICAgICAgcmVzb2x2ZShzdG9yZWRSZXBvcnRlclVSTCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIGFueSBoeXBlcnR5IHRoYXQgc3Vic2NyaWJlZCB0aGUgZGF0YU9iamVjdFVSTFxyXG4gICAgICAgICAgbGV0IHN1YnNjcmliZXJIeXBlcnR5ID0gX3RoaXMucmVnaXN0cnkuZ2V0RGF0YU9iamVjdFN1YnNjcmliZXJIeXBlcnR5KGRhdGFPYmplY3RVUkwpO1xyXG4gICAgICAgICAgbG9nLmluZm8oJ19nZXRIeXBlcnR5RnJvbURhdGFPYmplY3Q6c3Vic2NyaWJlckh5cGVydHknLCBzdWJzY3JpYmVySHlwZXJ0eSk7XHJcblxyXG4gICAgICAgICAgaWYgKHN1YnNjcmliZXJIeXBlcnR5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoc3Vic2NyaWJlckh5cGVydHkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gc2VhcmNoIGluIGRvbWFpbiByZWdpc3RyeSBmb3IgdGhlIGh5cGVydHkgYXNzb2NpYXRlZCB0byB0aGUgZGF0YU9iamVjdFxyXG4gICAgICAgICAgICAvLyBzZWFyY2ggaW4gY2FzZSBpcyBhIHN1YnNjcmliZXIgd2hvIHdhbnRzIHRvIGtub3cgdGhlIHJlcG9ydGVyXHJcbiAgICAgICAgICAgIC8vIFRvIGJlIHJldmlld2VkIGluIG9yZGVyIHRvIGF2b2lkIHRoZSBkaXNjb3ZlcnkgdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgX3RoaXMuX2NvcmVEaXNjb3ZlcnkuZGlzY292ZXJEYXRhT2JqZWN0UGVyVVJMKGZpbmFsVVJMLCBkb21haW4pLnRoZW4oZGF0YU9iamVjdCA9PiB7XHJcbiAgICAgICAgICAgICAgbG9nLmluZm8oJ19nZXRIeXBlcnR5RnJvbURhdGFPYmplY3Q6ZGF0YU9iamVjdCcsIGRhdGFPYmplY3QpO1xyXG4gICAgICAgICAgICAgIF90aGlzLmRhdGFPYmplY3RzSWRlbnRpdHlbZmluYWxVUkxdID0gZGF0YU9iamVjdC5yZXBvcnRlcjtcclxuICAgICAgICAgICAgICBsb2cuaW5mbygnX2dldEh5cGVydHlGcm9tRGF0YU9iamVjdDpkYXRhT2JqZWN0LnJlcG9ydGVyJywgZGF0YU9iamVjdC5yZXBvcnRlcik7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhT2JqZWN0LnJlcG9ydGVyKTtcclxuICAgICAgICAgICAgfSwgZXJyID0+IHtcclxuICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogRnVuY3Rpb24gdGhhdCByZXNvbHZlIGFuZCBjcmVhdGUgdGhlIGRvbWFpblVSTCBpbiBjYXNlIGl0IGlzIHByb3ZpZGVkIG9uZS4gSWYgbm90LCByZXNvbHZlIHRoZSBkZWZhdWx0IGRvbWFpblVSTFxyXG4gICogQHBhcmFtIHtTdHJpbmd9ICAgICBpZHBEb21haW4gICAgIGlkcERvbWFpbiAoT3B0aW9uYWwpXHJcbiAgKi9cclxuICBfcmVzb2x2ZURvbWFpbihpZHBEb21haW4pIHtcclxuICAgIGlmICghaWRwRG9tYWluKSB7XHJcbiAgICAgIHJldHVybiAnZG9tYWluLWlkcDovL2dvb2dsZS5jb20nO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuICdkb21haW4taWRwOi8vJyArIGlkcERvbWFpbjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICBfc2Vjb25kc1NpbmNlRXBvY2goKSB7XHJcbiAgICAgIHJldHVybiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcclxuICAgIH0qL1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgSWRlbnRpdHlNb2R1bGU7XHJcbiIsIi8qKlxyXG4qIFByb3ZpZGVzIGFuIEFQSSB0byBtYW5hZ2UgaWRlbnRpdGllcyBmcm9tIG1zZyBidXMgcGlwZWxpbmVcclxuKiBUT0RPOiByZW5hbWUgdG8gc29tZXRoaW5nIGxpa2UgSWRlbnRpdHlQaXBlbGluZUhhbmRsZXIgaW4gb3JkZXIgbm90IHRvIGNvbmZsaWN0IHdpdGggZnJhbWV3b3JrIHJlbGF0ZWQgSWRlbnRpdHlIYW5kbGVyXHJcbiovXHJcblxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5pbXBvcnQgSWRlbnRpdGllcyBmcm9tICcuL0lkZW50aXRpZXMnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignSWRlbnRpdHlIYW5kbGVyJyk7XHJcblxyXG5jbGFzcyBJZGVudGl0eUhhbmRsZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcihpZG0pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX2lkbSA9IGlkbTtcclxuXHJcbiAgfVxyXG5cclxuICByZXNldCgpIHtcclxuICAgIGNvbnNvbGUubG9nKCdJTSByZXNldCcpO1xyXG5cclxuICAgIC8vIHRoaXMuX2lkbS5pZGVudGl0aWVzLnJlc2V0KCk7XHJcbiAgICB0aGlzLl9pZG0uaWRlbnRpdGllcyA9IG5ldyBJZGVudGl0aWVzKHRoaXMuX2lkbS5pZGVudGl0aWVzLl90eXBlLCB0aGlzLl9pZG0uaWRlbnRpdGllcy5fc3RvcmFnZU1hbmFnZXIpO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5faWRtLmlkZW50aXRpZXMpO1xyXG4gIH1cclxuXHJcbiAgX2lzVG9TZXRJRChtZXNzYWdlKSB7XHJcbiAgICBsZXQgc2NoZW1hc1RvSWdub3JlID0gWydkb21haW4taWRwJywgJ3J1bnRpbWUnLCAnZG9tYWluJ107XHJcblxyXG4gICAgbGV0IF9mcm9tID0gbWVzc2FnZS5mcm9tO1xyXG5cclxuICAgIGlmIChtZXNzYWdlLmJvZHkgJiYgbWVzc2FnZS5ib2R5Lmhhc093blByb3BlcnR5KCdzb3VyY2UnKSkge1xyXG4gICAgICBfZnJvbSA9IG1lc3NhZ2UuYm9keS5zb3VyY2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG1lc3NhZ2UuYm9keSAmJiBtZXNzYWdlLmJvZHkuaGFzT3duUHJvcGVydHkoJ3N1YnNjcmliZXInKSkge1xyXG4gICAgICBfZnJvbSA9IG1lc3NhZ2UuYm9keS5zdWJzY3JpYmVyO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChtZXNzYWdlLnR5cGUgPT09ICdmb3J3YXJkJykge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2lnbmFsbGluZyBNZXNzYWdlcyBiZXR3ZWVuIFAyUCBTdHVicyBkb24ndCBoYXZlIElkZW50aXRpZXMuIEZGU1xyXG4gICAgaWYgKF9mcm9tLmluY2x1ZGVzKCcvcDJwcmVxdWVzdGVyLycpIHx8IF9mcm9tLmluY2x1ZGVzKCcvcDJwaGFuZGxlci8nKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHNwbGl0RnJvbSA9IChfZnJvbSkuc3BsaXQoJzovLycpO1xyXG4gICAgbGV0IGZyb21TY2hlbWEgPSBzcGxpdEZyb21bMF07XHJcbiAgICBsZXQgaXNUb0lnbm9yZSA9IHNjaGVtYXNUb0lnbm9yZS5pbmRleE9mKGZyb21TY2hlbWEpID09PSAtMTtcclxuXHJcbiAgICByZXR1cm4gaXNUb0lnbm9yZTtcclxuICB9XHJcblxyXG4gIHByb2Nlc3NNZXNzYWdlKG1lc3NhZ2UpIHtcclxuICAgIGxvZy5sb2coJ1tJZGVudGl0eUhhbmRsZXIucHJvY2Vzc01lc3NhZ2VdICcsIG1lc3NhZ2UpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICAvLyBza2lwIG1lc3NhZ2VzIHRoYXQgZG9uJ3QgbmVlZCBpZGVudGl0eSB0b2tlbnMgaW4gdGhlIGJvZHlcclxuXHJcbiAgICAgIGlmICghdGhpcy5faXNUb1NldElEKG1lc3NhZ2UpKSByZXR1cm4gcmVzb2x2ZShtZXNzYWdlKTtcclxuXHJcbiAgICAgIC8qICAgICAgbGV0IGZyb20gPSBtZXNzYWdlLmZyb207XHJcbiAgICAgIGxldCBzb3VyY2VVUkwgPSB1bmRlZmluZWQ7XHJcbiAgICAgIGlmICggbWVzc2FnZS5oYXNPd25Qcm9wZXJ0eSgnYm9keScpICYmIG1lc3NhZ2UuYm9keS5oYXNPd25Qcm9wZXJ0eSgnc291cmNlJykpIHtcclxuICAgICAgICBmcm9tID0gbWVzc2FnZS5ib2R5LnNvdXJjZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ2ZvcndhcmQnKSB7XHJcbiAgICAgICAgZnJvbSA9IG1lc3NhZ2UuYm9keS5mcm9tO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAobWVzc2FnZS5oYXNPd25Qcm9wZXJ0eSgnYm9keScpICYmIG1lc3NhZ2UuYm9keS5oYXNPd25Qcm9wZXJ0eSgnc3Vic2NyaWJlcicpKSB7XHJcbiAgICAgICAgZnJvbSA9IG1lc3NhZ2UuYm9keS5zdWJzY3JpYmVyO1xyXG4gICAgICB9Ki9cclxuXHJcbiAgICAgIHRoaXMuX2lkbS5nZXRUb2tlbihtZXNzYWdlKS50aGVuKChpZGVudGl0eSkgPT4ge1xyXG5cclxuICAgICAgICBpZiAoIW1lc3NhZ2UuaGFzT3duUHJvcGVydHkoJ2JvZHknKSkgbWVzc2FnZS5ib2R5ID0ge307XHJcblxyXG4gICAgICAgIG1lc3NhZ2UuYm9keS5pZGVudGl0eSA9IGlkZW50aXR5O1xyXG4gICAgICAgIHJlc29sdmUobWVzc2FnZSk7XHJcbiAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICBsb2cuZXJyb3IocmVhc29uKTtcclxuICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxuICB9XHJcblxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgSWRlbnRpdHlIYW5kbGVyO1xyXG4iLCJjbGFzcyBBY3Rpb25zU2VydmljZSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbnRleHQpIHtcclxuICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcbiAgfVxyXG5cclxuICBlbmZvcmNlUG9saWNpZXMobWVzc2FnZSwgaXNJbmNvbWluZ01lc3NhZ2UpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IHBvbGljaWVzID0gX3RoaXMuY29udGV4dC5nZXRQb2xpY2llcyhtZXNzYWdlLCBpc0luY29taW5nTWVzc2FnZSk7XHJcblxyXG4gICAgICBpZiAocG9saWNpZXMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGlmIChwb2xpY2llcy5zZXJ2aWNlUHJvdmlkZXJQb2xpY3kgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgcG9saWNpZXMuc2VydmljZVByb3ZpZGVyUG9saWN5LmVuZm9yY2VBY3Rpb25zKF90aGlzLmNvbnRleHQsIG1lc3NhZ2UpLnRoZW4obWVzc2FnZXMgPT4ge1xyXG4gICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2VzKTtcclxuICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChwb2xpY2llcy51c2VyUG9saWN5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcG9saWNpZXMudXNlclBvbGljeS5lbmZvcmNlQWN0aW9ucyhfdGhpcy5jb250ZXh0LCBtZXNzYWdlKS50aGVuKG1lc3NhZ2VzID0+IHtcclxuICAgICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2VzKTtcclxuICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXNvbHZlKFttZXNzYWdlXSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlc29sdmUoW21lc3NhZ2VdKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmb3J3YXJkVG9JRChtZXNzYWdlLCBlbWFpbCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGlmICghX3RoaXMuY29udGV4dC5ydW50aW1lUmVnaXN0cnkpIHRocm93IG5ldyBFcnJvcignZm9yd2FyZCBtZXNzYWdlIHRvIGdpdmVuIElEIGlzIHVuc3VwcG9ydGVkIGluIHRoaXMgZW52aXJvbm1lbnQnKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBpZiAoX3RoaXMuY29udGV4dC5ydW50aW1lUmVnaXN0cnkuaHlwZXJ0aWVzTGlzdFswXS5oeXBlcnR5VVJMID09PSBtZXNzYWdlLnRvKSB7XHJcbiAgICAgICAgbGV0IHNwbGl0VG8gPSAobWVzc2FnZS50bykuc3BsaXQoJzovLycpO1xyXG4gICAgICAgIGlmIChzcGxpdFRvWzBdICE9PSAncnVudGltZScpIHtcclxuICAgICAgICAgIF90aGlzLmNvbnRleHQucnVudGltZVJlZ2lzdHJ5LmRpc2NvdmVySHlwZXJ0eVBlclVzZXIoZW1haWwpLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgbWVzc2FnZS50byA9IHJlc3VsdC5oeXBlcnR5VVJMO1xyXG4gICAgICAgICAgICBtZXNzYWdlLmJvZHkudmlhID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBfdGhpcy5jb250ZXh0LnJ1bnRpbWVSZWdpc3RyeS5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlKTtcclxuICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlc29sdmUobWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlc29sdmUobWVzc2FnZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZm9yd2FyZFRvSHlwZXJ0eShtZXNzYWdlLCBoeXBlcnR5VVJMKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgaWYgKCFfdGhpcy5jb250ZXh0LnJ1bnRpbWVSZWdpc3RyeSkgdGhyb3cgbmV3IEVycm9yKCdmb3J3YXJkIG1lc3NhZ2UgdG8gZ2l2ZW4gSUQgaXMgdW5zdXBwb3J0ZWQgaW4gdGhpcyBlbnZpcm9ubWVudCcpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICBpZiAoX3RoaXMuY29udGV4dC5ydW50aW1lUmVnaXN0cnkuaHlwZXJ0aWVzTGlzdFswXS5oeXBlcnR5VVJMID09PSBtZXNzYWdlLnRvKSB7XHJcbiAgICAgICAgbGV0IHNwbGl0VG8gPSAobWVzc2FnZS50bykuc3BsaXQoJzovLycpO1xyXG4gICAgICAgIGlmIChzcGxpdFRvWzBdICE9PSAncnVudGltZScpIHtcclxuICAgICAgICAgIG1lc3NhZ2UudG8gPSBoeXBlcnR5VVJMO1xyXG4gICAgICAgICAgbWVzc2FnZS5ib2R5LnZpYSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgIHJlc29sdmUobWVzc2FnZSk7XHJcbiAgICAgICAgICBfdGhpcy5jb250ZXh0LnJ1bnRpbWVSZWdpc3RyeS5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZW5kQXV0b21hdGljTWVzc2FnZShtZXNzYWdlLCB0ZXh0KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgIGxldCBhdXRvbWF0aWNNZXNzYWdlID0ge1xyXG4gICAgICAgIGZyb206IG1lc3NhZ2UudG8sXHJcbiAgICAgICAgdG86IG1lc3NhZ2UuZnJvbSxcclxuICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICB2YWx1ZTogdGV4dFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdHlwZTogbWVzc2FnZS50eXBlXHJcbiAgICAgIH07XHJcbiAgICAgIHJlc29sdmUobWVzc2FnZSk7XHJcbiAgICAgIF90aGlzLmNvbnRleHQucnVudGltZVJlZ2lzdHJ5Ll9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKGF1dG9tYXRpY01lc3NhZ2UpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQWN0aW9uc1NlcnZpY2U7XHJcbiIsImNsYXNzIE9wZXJhdG9ycyB7XHJcblxyXG4gIGFuZChwYXJhbXMpIHtcclxuICAgIHJldHVybiBwYXJhbXNbMF0gJiYgcGFyYW1zWzFdO1xyXG4gIH1cclxuXHJcbiAgYmV0d2VlbihwYXJhbXMpIHtcclxuICAgIGxldCBzdGFydCA9IHBhcnNlSW50KHBhcmFtc1swXVswXSk7XHJcbiAgICBsZXQgZW5kID0gcGFyc2VJbnQocGFyYW1zWzBdWzFdKTtcclxuICAgIGxldCBub3cgPSBwYXJhbXNbMV07XHJcblxyXG4gICAgaWYgKGVuZCA8IHN0YXJ0KSB7XHJcbiAgICAgIG5vdyA9IChub3cgPCBzdGFydCkgPyBub3cgKz0gMjQwMCA6IG5vdztcclxuICAgICAgZW5kICs9IDI0MDA7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIChub3cgPiBzdGFydCAmJiBub3cgPCBlbmQpO1xyXG4gIH1cclxuXHJcbiAgZXF1YWxzKHBhcmFtcykge1xyXG4gICAgcmV0dXJuIFN0cmluZyhwYXJhbXNbMF0pID09PSAnKicgfHwgU3RyaW5nKHBhcmFtc1swXSkgPT09IFN0cmluZyhwYXJhbXNbMV0pO1xyXG4gIH1cclxuXHJcbiAgZ3JlYXRlclRoYW4ocGFyYW1zKSB7XHJcbiAgICByZXR1cm4gcGFyYW1zWzFdID4gcGFyYW1zWzBdO1xyXG4gIH1cclxuXHJcbiAgaW4ocGFyYW1zKSB7XHJcbiAgICByZXR1cm4gcGFyYW1zWzBdLmluZGV4T2YocGFyYW1zWzFdKSA+IC0xO1xyXG4gIH1cclxuXHJcbiAgbGVzc1RoYW4ocGFyYW1zKSB7XHJcbiAgICByZXR1cm4gcGFyYW1zWzFdIDwgcGFyYW1zWzBdO1xyXG4gIH1cclxuXHJcbiAgbm90KHBhcmFtcykge1xyXG4gICAgcmV0dXJuICFwYXJhbXNbMF07XHJcbiAgfVxyXG5cclxuICBvcihwYXJhbXMpIHtcclxuICAgIHJldHVybiBwYXJhbXNbMF0gfHwgcGFyYW1zWzFdO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IE9wZXJhdG9ycztcclxuIiwiaW1wb3J0IE9wZXJhdG9ycyBmcm9tICcuL09wZXJhdG9ycyc7XHJcblxyXG4vKipcclxuKiBUaGUgUG9saWN5IERlY2lzaW9uIFBvaW50IChQRFApIGRlY2lkZXMgaWYgYSBtZXNzYWdlIGlzIHRvIGJlIGF1dGhvcmlzZWQgYnkgY2hlY2tpbmcgYSBzZXQgb2ZcclxuKiBwb2xpY2llcy4gVGhlIHJlc291cmNlIHRvIGJlIHZlcmlmaWVkIGlzIHNwZWNpZmllZCBpbiB0aGUgZmlyc3Qgd29yZCBvZiB0aGUgJ2NvbmRpdGlvbicgZmllbGQgb2ZcclxuKiBhIFBvbGljeSBvYmplY3QuIFRoZSBpbXBsZW1lbnRhdGlvbiB0aGF0IHZlcmlmaWVzIGlmIHRoZSBtZXNzYWdlIGlzIGNvbXBsaWFudCB3aXRoIGEgcG9saWN5IGlzXHJcbiogc3BlY2lmaWVkIGluIGEgaGFzaHRhYmxlIHRvIGFsbG93IGR5bmFtaWMgZGVmaW5pdGlvbiBvZiB0aGUgaW1wbGVtZW50YXRpb24sIHByb3ZpZGluZ1xyXG4qIGV4dGVuc2liaWxpdHkgdG8gdGhlIFBvbGljeSBFbmdpbmUgZnVuY3Rpb25hbGl0aWVzLlxyXG4qL1xyXG5jbGFzcyBQRFAge1xyXG5cclxuICBjb25zdHJ1Y3Rvcihjb250ZXh0KSB7XHJcbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xyXG4gICAgdGhpcy5vcGVyYXRvcnMgPSBuZXcgT3BlcmF0b3JzKCk7XHJcbiAgfVxyXG5cclxuICBldmFsdWF0ZVBvbGljaWVzKG1lc3NhZ2UsIGlzSW5jb21pbmdNZXNzYWdlKSB7XHJcbiAgICBsZXQgcG9saWNpZXMgPSB0aGlzLmNvbnRleHQuZ2V0UG9saWNpZXMobWVzc2FnZSwgaXNJbmNvbWluZ01lc3NhZ2UpO1xyXG4gICAgbGV0IHJlc3VsdCA9ICdOb3QgQXBwbGljYWJsZSc7XHJcbiAgICBpZiAocG9saWNpZXMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICByZXN1bHQgPSB0aGlzLmV2YWx1YXRlUG9saWN5KG1lc3NhZ2UsIHBvbGljaWVzLnNlcnZpY2VQcm92aWRlclBvbGljeSwgaXNJbmNvbWluZ01lc3NhZ2UpO1xyXG4gICAgICBpZiAocmVzdWx0IHx8IHJlc3VsdCA9PT0gJ05vdCBBcHBsaWNhYmxlJykge1xyXG4gICAgICAgIGxldCB1c2VyUmVzdWx0ID0gdGhpcy5ldmFsdWF0ZVBvbGljeShtZXNzYWdlLCBwb2xpY2llcy51c2VyUG9saWN5LCBpc0luY29taW5nTWVzc2FnZSk7XHJcbiAgICAgICAgaWYgKHVzZXJSZXN1bHQgIT09ICdOb3QgQXBwbGljYWJsZScpIHtcclxuICAgICAgICAgIHJlc3VsdCA9IHVzZXJSZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIGV2YWx1YXRlUG9saWN5KG1lc3NhZ2UsIHBvbGljeSwgaXNJbmNvbWluZykge1xyXG4gICAgbGV0IHJlc3VsdCA9ICdOb3QgQXBwbGljYWJsZSc7XHJcbiAgICBpZiAocG9saWN5KSB7XHJcbiAgICAgIHJlc3VsdCA9IHBvbGljeS5ldmFsdWF0ZVJ1bGVzKHRoaXMuY29udGV4dCwgbWVzc2FnZSwgaXNJbmNvbWluZyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQRFA7XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbi8qKlxyXG4qIEBhdXRob3IgQW5hIENhbGRlaXJhIDxhbmEuY2FsZGVpcmFAdGVjbmljby51bGlzYm9hLnB0PlxyXG4qIEBjbGFzc2Rlc2MgQ2xhc3MgdG8gY29tYmluZSB0aGUgYXV0aG9yaXphdGlvbiBkZWNpc2lvbnMgdGhhdCByZXN1bHQgZnJvbSBydWxlcyBldmFsdWF0aW9uLlxyXG4qL1xyXG5jbGFzcyBBbGxvd092ZXJyaWRlcyB7XHJcblxyXG4gIC8qKlxyXG4gICogR2l2ZW4gYW4gYXJyYXkgb2YgaW5kaXZpZHVhbCBhdXRob3JpemF0aW9uIGRlY2lzaW9ucywgcHJpb3JpdGl6ZXMgYSBwb3NpdGl2ZSBvbmUuXHJcbiAgKiBAcGFyYW0gICAge2Jvb2xlYW5bXX0gICBkZWNpc2lvbnNcclxuICAqIEByZXR1cm5zICB7Ym9vbGVhbn1cclxuICAqL1xyXG4gIGNvbWJpbmUoZGVjaXNpb25zKSB7XHJcbiAgICBpZiAoZGVjaXNpb25zLmluZGV4T2YodHJ1ZSkgIT09IC0xKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGRlY2lzaW9ucy5pbmRleE9mKGZhbHNlKSAhPT0gLTEpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuICdOb3QgQXBwbGljYWJsZSc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBbGxvd092ZXJyaWRlcztcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5cclxuLyoqXHJcbiogQGF1dGhvciBBbmEgQ2FsZGVpcmEgPGFuYS5jYWxkZWlyYUB0ZWNuaWNvLnVsaXNib2EucHQ+XHJcbiogQGNsYXNzZGVzYyBDbGFzcyB0byBjb21iaW5lIHRoZSBhdXRob3JpemF0aW9uIGRlY2lzaW9ucyB0aGF0IHJlc3VsdCBmcm9tIHJ1bGVzIGV2YWx1YXRpb24uXHJcbiovXHJcbmNsYXNzIEJsb2NrT3ZlcnJpZGVzIHtcclxuXHJcbiAgLyoqXHJcbiAgKiBHaXZlbiBhbiBhcnJheSBvZiBpbmRpdmlkdWFsIGF1dGhvcmlzYXRpb24gZGVjaXNpb25zLCBwcmlvcml0aXNlcyBhIG5lZ2F0aXZlIG9uZS5cclxuICAqIEBwYXJhbSAgICB7Ym9vbGVhbltdfSAgIGRlY2lzaW9uc1xyXG4gICogQHJldHVybnMgIHtib29sZWFufVxyXG4gICovXHJcbiAgY29tYmluZShkZWNpc2lvbnMpIHtcclxuICAgIGlmIChkZWNpc2lvbnMuaW5kZXhPZihmYWxzZSkgIT09IC0xKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChkZWNpc2lvbnMuaW5kZXhPZih0cnVlKSAhPT0gLTEpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJ05vdCBBcHBsaWNhYmxlJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEJsb2NrT3ZlcnJpZGVzO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vKipcclxuKiBAYXV0aG9yIEFuYSBDYWxkZWlyYSA8YW5hLmNhbGRlaXJhQHRlY25pY28udWxpc2JvYS5wdD5cclxuKiBAY2xhc3NkZXNjIENsYXNzIHRvIGNvbWJpbmUgdGhlIGF1dGhvcml6YXRpb24gZGVjaXNpb25zIHRoYXQgcmVzdWx0IGZyb20gcnVsZXMgZXZhbHVhdGlvbi5cclxuKi9cclxuY2xhc3MgRmlyc3RBcHBsaWNhYmxlIHtcclxuXHJcbiAgLyoqXHJcbiAgKiBHaXZlbiBhbiBhcnJheSBvZiBpbmRpdmlkdWFsIGF1dGhvcmlzYXRpb24gZGVjaXNpb25zLCByZXR1cm5zIHRoZSBmaXJzdCBvbmUgZGlmZmVyZW50IGZyb20gJ05vdCBBcHBsaWNhYmxlJywgZWl0aGVyIHBvc2l0aXZlIG9yIG5lZ2F0aXZlLlxyXG4gICogQHBhcmFtICAgIHtib29sZWFuW119ICAgICBkZWNpc2lvbnNcclxuICAqIEByZXR1cm5zICB7Ym9vbGVhbn1cclxuICAqL1xyXG4gIGNvbWJpbmUoZGVjaXNpb25zKSB7XHJcbiAgICBmb3IgKGxldCBpIGluIGRlY2lzaW9ucykge1xyXG4gICAgICBpZiAoZGVjaXNpb25zW2ldICE9PSAnTm90IEFwcGxpY2FibGUnKSB7XHJcbiAgICAgICAgcmV0dXJuIGRlY2lzaW9uc1tpXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuICdOb3QgQXBwbGljYWJsZSc7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRmlyc3RBcHBsaWNhYmxlO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG5pbXBvcnQgT3BlcmF0b3JzIGZyb20gJy4uL09wZXJhdG9ycyc7XHJcblxyXG4vKipcclxuKiBAYXV0aG9yIEFuYSBDYWxkZWlyYSA8YW5hLmNhbGRlaXJhQHRlY25pY28udWxpc2JvYS5wdD5cclxuKiBAY2xhc3NkZXNjIENsYXNzIHRvIHJlcHJlc2VudCBhIGNvbmRpdGlvbiBhbmQgZXZhbHVhdGUgaXRzIGFwcGxpY2FiaWxpdHkuXHJcbiovXHJcbmNsYXNzIENvbmRpdGlvbiB7XHJcblxyXG4gIC8qKlxyXG4gICogQ3JlYXRlcyBhIG5ldyBDb25kaXRpb24uXHJcbiAgKiBAY2xhc3NcclxuICAqIEBwYXJhbSAge3N0cmluZ30gIGF0dHJpYnV0ZVxyXG4gICogQHBhcmFtICB7c3RyaW5nfSAgb3BlcmF0b3JcclxuICAqIEBwYXJhbSAgeyp9ICAgICAgIHBhcmFtc1xyXG4gICovXHJcbiAgY29uc3RydWN0b3IoYXR0cmlidXRlLCBvcGVyYXRvciwgcGFyYW1zKSB7XHJcbiAgICB0aGlzLmF0dHJpYnV0ZSA9IGF0dHJpYnV0ZTtcclxuICAgIHRoaXMub3BlcmF0b3IgPSBvcGVyYXRvcjtcclxuICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xyXG4gICAgdGhpcy5vcGVyYXRvcnMgPSBuZXcgT3BlcmF0b3JzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFZlcmlmaWVzIGlmIHRoZSBjb25kaXRpb24gaXMgYXBwbGljYWJsZSB0byB0aGUgbWVzc2FnZS4gRmlyc3QsIHRoZSBzeXN0ZW0gdmFsdWUgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgYXR0cmlidXRlIGlzIHJldHJpZXZlZDsgdGhlbiwgdGhhdCB2YWx1ZSBpcyBjb21wYXJlZCB3aXRoIHRoZSBwYXJhbWV0ZXIgc3BlY2lmaWVkIGluIHRoZSBjb25kaXRpb24gYnkgZXhlY3V0aW5nIHRoZSBvcGVyYXRvciBpbXBsZW1lbnRhdGlvbi4gSWYgdGhlIG9wZXJhdG9yIGlzICdpbicgYW5kIHRoZSBuYW1lIG9mIGEgZ3JvdXAgaXMgZ2l2ZW4sIHRoZW4gdGhlIGFycmF5IGhvbGRpbmcgdGhlIG1lbWJlcnMgb2YgdGhlIGdyb3VwIGlzIHJldHJpZXZlZCBiZWZvcmUgdGhlIGNvbXBhcmlzb24uXHJcbiAgKiBAcGFyYW0gIHtPYmplY3R9ICAgIGNvbnRleHQgICBlbnZpcm9ubWVudCB3aGVyZSB0aGUgUG9saWN5IEVuZ2luZSBpcyBiZWluZyB1c2VkXHJcbiAgKiBAcGFyYW0gIHtPYmplY3R9ICAgIG1lc3NhZ2VcclxuICAqL1xyXG4gIGlzQXBwbGljYWJsZShjb250ZXh0LCBtZXNzYWdlKSB7XHJcbiAgICBjb250ZXh0W3RoaXMuYXR0cmlidXRlXSA9IHsgbWVzc2FnZTogbWVzc2FnZSB9O1xyXG4gICAgbGV0IHZhbHVlID0gY29udGV4dFt0aGlzLmF0dHJpYnV0ZV07XHJcbiAgICBsZXQgdGVtcFBhcmFtO1xyXG5cclxuICAgIGlmICh0aGlzLm9wZXJhdG9yID09PSAnaW4nKSB7XHJcbiAgICAgIGlmICghKEFycmF5LmlzQXJyYXkodGhpcy5wYXJhbXMpKSkge1xyXG4gICAgICAgIHRlbXBQYXJhbSA9IGNvbnRleHQuZ2V0R3JvdXAodGhpcy5wYXJhbXMsIG1lc3NhZ2UudG8pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9wZXJhdG9yc1t0aGlzLm9wZXJhdG9yXShbdGVtcFBhcmFtLCB2YWx1ZV0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMub3BlcmF0b3JzW3RoaXMub3BlcmF0b3JdKFt0aGlzLnBhcmFtcywgdmFsdWVdKTtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb25kaXRpb247XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbmltcG9ydCBDb25kaXRpb24gZnJvbSAnLi9Db25kaXRpb24nO1xyXG5cclxuLyoqXHJcbiogQGF1dGhvciBBbmEgQ2FsZGVpcmEgPGFuYS5jYWxkZWlyYUB0ZWNuaWNvLnVsaXNib2EucHQ+XHJcbiogQGNsYXNzZGVzYyBDbGFzcyB0byByZXByZXNlbnQgYSBzdWJzY3JpcHRpb24gY29uZGl0aW9uIGFuZCBldmFsdWF0ZSBpdHMgYXBwbGljYWJpbGl0eS5cclxuKi9cclxuY2xhc3MgU3Vic2NyaXB0aW9uQ29uZGl0aW9uIGV4dGVuZHMgQ29uZGl0aW9uIHtcclxuXHJcbiAgLyoqXHJcbiAgKiBDcmVhdGVzIGEgbmV3IFN1YnNjcmlwdGlvbkNvbmRpdGlvbi5cclxuICAqIEBjbGFzc1xyXG4gICogQHBhcmFtICB7c3RyaW5nfSAgYXR0cmlidXRlXHJcbiAgKiBAcGFyYW0gIHtzdHJpbmd9ICBvcGVyYXRvclxyXG4gICogQHBhcmFtICB7Kn0gICAgICAgcGFyYW1zXHJcbiAgKi9cclxuICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGUsIG9wZXJhdG9yLCBwYXJhbXMpIHtcclxuICAgIHN1cGVyKGF0dHJpYnV0ZSwgb3BlcmF0b3IsIHBhcmFtcyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFZlcmlmaWVzIGlmIHRoZSBzdWJzY3JpcHRpb24gY29uZGl0aW9uIGlzIGFwcGxpY2FibGUgdG8gdGhlIG1lc3NhZ2UuIEZpcnN0LCB2ZXJpZmllcyBpZiB0aGUgbWVzc2FnZSBpcyBvZiB0aGUgc3Vic2NyaXB0aW9uIHR5cGU7IHNlY29uZCwgdmVyaWZpZXMgaWYgdGhlIG1lc3NhZ2UgaXMgZnJvbSBhIHJlbW90ZSBydW50aW1lIHRvIGd1YXJhbnRlZSB0aGF0IHRoZSBzdWJzY3JpcHRpb24gaXMgYmVpbmcgdmFsaWRhdGVkIGluIHRoZSBkZXN0aW5hdGlvbiBydW50aW1lOyB0aGlyZCwgdmVyaWZpZXMgaWYgdGhlIHN1YnNjcmlwdGlvbiBwcmVmZXJlbmNlIGlzIG1ldC5cclxuICAqIEBwYXJhbSAge09iamVjdH0gICAgY29udGV4dCAgIGVudmlyb25tZW50IHdoZXJlIHRoZSBQb2xpY3kgRW5naW5lIGlzIGJlaW5nIHVzZWRcclxuICAqIEBwYXJhbSAge09iamVjdH0gICAgbWVzc2FnZVxyXG4gICovXHJcbiAgaXNBcHBsaWNhYmxlKGNvbnRleHQsIG1lc3NhZ2UpIHtcclxuICAgIGxldCBpc1N1YnNjcmlwdGlvbiA9IG1lc3NhZ2UudHlwZSA9PT0gJ3N1YnNjcmliZSc7XHJcbiAgICBsZXQgaXNGcm9tUmVtb3RlU00gPSBjb250ZXh0LmlzRnJvbVJlbW90ZVNNKG1lc3NhZ2UuZnJvbSk7XHJcbiAgICBpZiAoaXNTdWJzY3JpcHRpb24gJiBpc0Zyb21SZW1vdGVTTSkge1xyXG4gICAgICByZXR1cm4gc3VwZXIuaXNBcHBsaWNhYmxlKGNvbnRleHQsIG1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFN1YnNjcmlwdGlvbkNvbmRpdGlvbjtcclxuIiwiaW1wb3J0IENvbmRpdGlvbiBmcm9tICcuL0NvbmRpdGlvbic7XHJcbmltcG9ydCBPcGVyYXRvcnMgZnJvbSAnLi4vT3BlcmF0b3JzJztcclxuaW1wb3J0IFN1YnNjcmlwdGlvbkNvbmRpdGlvbiBmcm9tICcuL1N1YnNjcmlwdGlvbkNvbmRpdGlvbic7XHJcblxyXG5jbGFzcyBBZHZhbmNlZENvbmRpdGlvbiB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbmRpdGlvbikge1xyXG4gICAgdGhpcy5vcGVyYXRvcnMgPSBuZXcgT3BlcmF0b3JzKCk7XHJcbiAgICBpZiAoY29uZGl0aW9uLm9wZXJhdG9ycyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGNvbmRpdGlvbiA9IGNvbmRpdGlvbi5jb25kaXRpb247XHJcbiAgICB9XHJcbiAgICBjb25kaXRpb24gPSB0aGlzLmJ1aWxkQ29uZGl0aW9uKGNvbmRpdGlvbik7XHJcbiAgICB0aGlzLmNvbmRpdGlvbiA9IGNvbmRpdGlvbjtcclxuICB9XHJcblxyXG4gIGJ1aWxkQ29uZGl0aW9uKGNvbmRpdGlvbikge1xyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoY29uZGl0aW9uWzFdKSkge1xyXG4gICAgICBjb25kaXRpb25bMV0gPSB0aGlzLmJ1aWxkQ29uZGl0aW9uKGNvbmRpdGlvblsxXSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoY29uZGl0aW9uWzFdLmF0dHJpYnV0ZSA9PT0gJ3N1YnNjcmlwdGlvbicpIHtcclxuICAgICAgICBjb25kaXRpb25bMV0gPSBuZXcgU3Vic2NyaXB0aW9uQ29uZGl0aW9uKGNvbmRpdGlvblsxXS5hdHRyaWJ1dGUsIGNvbmRpdGlvblsxXS5vcGVyYXRvciwgY29uZGl0aW9uWzFdLnBhcmFtcyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uZGl0aW9uWzFdID0gbmV3IENvbmRpdGlvbihjb25kaXRpb25bMV0uYXR0cmlidXRlLCBjb25kaXRpb25bMV0ub3BlcmF0b3IsIGNvbmRpdGlvblsxXS5wYXJhbXMpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNvbmRpdGlvblsyXSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbmRpdGlvblsyXSkpIHtcclxuICAgICAgICBjb25kaXRpb25bMl0gPSB0aGlzLmJ1aWxkQ29uZGl0aW9uKGNvbmRpdGlvblsyXSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKGNvbmRpdGlvblsyXS5hdHRyaWJ1dGUgPT09ICdzdWJzY3JpcHRpb24nKSB7XHJcbiAgICAgICAgICBjb25kaXRpb25bMl0gPSBuZXcgU3Vic2NyaXB0aW9uQ29uZGl0aW9uKGNvbmRpdGlvblsyXS5hdHRyaWJ1dGUsIGNvbmRpdGlvblsyXS5vcGVyYXRvciwgY29uZGl0aW9uWzJdLnBhcmFtcyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbmRpdGlvblsyXSA9IG5ldyBDb25kaXRpb24oY29uZGl0aW9uWzJdLmF0dHJpYnV0ZSwgY29uZGl0aW9uWzJdLm9wZXJhdG9yLCBjb25kaXRpb25bMl0ucGFyYW1zKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjb25kaXRpb247XHJcbiAgfVxyXG5cclxuICBpc0FwcGxpY2FibGUoY29udGV4dCwgbWVzc2FnZSwgc2NvcGUsIHRhcmdldCwgb3BlcmF0b3IsIGxlZnQsIHJpZ2h0KSB7XHJcbiAgICBpZiAoIW9wZXJhdG9yKSB7XHJcbiAgICAgIG9wZXJhdG9yID0gdGhpcy5jb25kaXRpb25bMF07XHJcbiAgICAgIGxlZnQgPSB0aGlzLmNvbmRpdGlvblsxXTtcclxuICAgICAgcmlnaHQgPSB0aGlzLmNvbmRpdGlvblsyXTtcclxuICAgIH1cclxuXHJcbiAgICB3aGlsZSAoIShsZWZ0IGluc3RhbmNlb2YgQ29uZGl0aW9uKSAmICEobGVmdCBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbkNvbmRpdGlvbikgJiAodHlwZW9mIGxlZnQgIT09ICdib29sZWFuJykpIHtcclxuICAgICAgbGVmdCA9IHRoaXMuaXNBcHBsaWNhYmxlKGNvbnRleHQsIG1lc3NhZ2UsIHNjb3BlLCB0YXJnZXQsIGxlZnRbMF0sIGxlZnRbMV0sIGxlZnRbMl0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHJpZ2h0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgd2hpbGUgKCEocmlnaHQgaW5zdGFuY2VvZiBDb25kaXRpb24pICYgIShyaWdodCBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbkNvbmRpdGlvbikgJiAodHlwZW9mIHJpZ2h0ICE9PSAnYm9vbGVhbicpKSB7XHJcbiAgICAgICAgcmlnaHQgPSB0aGlzLmlzQXBwbGljYWJsZShjb250ZXh0LCBtZXNzYWdlLCBzY29wZSwgdGFyZ2V0LCByaWdodFswXSwgcmlnaHRbMV0sIHJpZ2h0WzJdKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxldCByZXN1bHRMZWZ0ID0gKHR5cGVvZiBsZWZ0ID09PSAnYm9vbGVhbicpID8gbGVmdCA6IGxlZnQuaXNBcHBsaWNhYmxlKGNvbnRleHQsIG1lc3NhZ2UsIHNjb3BlLCB0YXJnZXQpO1xyXG4gICAgbGV0IHJlc3VsdFJpZ2h0O1xyXG4gICAgaWYgKHJpZ2h0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgcmVzdWx0UmlnaHQgPSAodHlwZW9mIHJpZ2h0ID09PSAnYm9vbGVhbicpID8gcmlnaHQgOiByaWdodC5pc0FwcGxpY2FibGUoY29udGV4dCwgbWVzc2FnZSwgc2NvcGUsIHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5vcGVyYXRvcnNbb3BlcmF0b3JdKFtyZXN1bHRMZWZ0LCByZXN1bHRSaWdodF0pO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFkdmFuY2VkQ29uZGl0aW9uO1xyXG4iLCJpbXBvcnQgQWR2YW5jZWRDb25kaXRpb24gZnJvbSAnLi9jb25kaXRpb25zL0FkdmFuY2VkQ29uZGl0aW9uJztcclxuaW1wb3J0IENvbmRpdGlvbiBmcm9tICcuL2NvbmRpdGlvbnMvQ29uZGl0aW9uJztcclxuaW1wb3J0IHtnZXRVc2VyRW1haWxGcm9tVVJMLCBpc0RhdGFPYmplY3RVUkwsIHJlbW92ZVBhdGhGcm9tVVJMfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBTdWJzY3JpcHRpb25Db25kaXRpb24gZnJvbSAnLi9jb25kaXRpb25zL0FkdmFuY2VkQ29uZGl0aW9uJztcclxuXHJcbmNsYXNzIFJ1bGUge1xyXG5cclxuICBjb25zdHJ1Y3RvcihkZWNpc2lvbiwgY29uZGl0aW9uLCBzY29wZSwgdGFyZ2V0LCBwcmlvcml0eSkge1xyXG4gICAgdGhpcy5kZWNpc2lvbiA9IGRlY2lzaW9uO1xyXG4gICAgdGhpcy5zZXRDb25kaXRpb24oY29uZGl0aW9uKTtcclxuICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcclxuICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcclxuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gIH1cclxuXHJcbiAgc2V0Q29uZGl0aW9uKGNvbmRpdGlvbikge1xyXG4gICAgaWYgKCEoY29uZGl0aW9uIGluc3RhbmNlb2YgQ29uZGl0aW9uIHx8IGNvbmRpdGlvbiBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbkNvbmRpdGlvbiB8fCBjb25kaXRpb24gaW5zdGFuY2VvZiBBZHZhbmNlZENvbmRpdGlvbikpIHtcclxuICAgICAgbGV0IGF0dHJpYnV0ZSA9IGNvbmRpdGlvbi5hdHRyaWJ1dGU7XHJcbiAgICAgIHN3aXRjaCAoYXR0cmlidXRlKSB7XHJcbiAgICAgICAgY2FzZSAnc3Vic2NyaXB0aW9uJzpcclxuICAgICAgICAgIHRoaXMuY29uZGl0aW9uID0gbmV3IFN1YnNjcmlwdGlvbkNvbmRpdGlvbihjb25kaXRpb24uYXR0cmlidXRlLCBjb25kaXRpb24ub3BlcmF0b3IsIGNvbmRpdGlvbi5wYXJhbXMpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSB1bmRlZmluZWQ6XHJcbiAgICAgICAgICB0aGlzLmNvbmRpdGlvbiA9IG5ldyBBZHZhbmNlZENvbmRpdGlvbihjb25kaXRpb24pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHRoaXMuY29uZGl0aW9uID0gbmV3IENvbmRpdGlvbihjb25kaXRpb24uYXR0cmlidXRlLCBjb25kaXRpb24ub3BlcmF0b3IsIGNvbmRpdGlvbi5wYXJhbXMpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNvbmRpdGlvbiA9IGNvbmRpdGlvbjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGV2YWx1YXRlKGNvbnRleHQsIG1lc3NhZ2UsIGlzSW5jb21pbmcpIHtcclxuICAgIGxldCBmaWVsZCA9IChpc0luY29taW5nKSA/IG1lc3NhZ2UudG8gOiBtZXNzYWdlLmZyb207XHJcbiAgICBsZXQgaHlwZXJ0eU5hbWU7XHJcbiAgICBzd2l0Y2ggKHRoaXMuc2NvcGUpIHtcclxuICAgICAgY2FzZSAnZ2xvYmFsJzpcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ2h5cGVydHknOlxyXG4gICAgICAgIGlmIChpc0RhdGFPYmplY3RVUkwoZmllbGQpKSB7XHJcbiAgICAgICAgICBsZXQgcmVwb3J0ZXIgPSBjb250ZXh0LnJ1bnRpbWVSZWdpc3RyeS5nZXRSZXBvcnRlclVSTFN5bmNob25vdXMocmVtb3ZlUGF0aEZyb21VUkwoZmllbGQpKTtcclxuICAgICAgICAgIGlmIChyZXBvcnRlciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGh5cGVydHlOYW1lID0gY29udGV4dC5ydW50aW1lUmVnaXN0cnkuZ2V0SHlwZXJ0eU5hbWUocmVwb3J0ZXIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoZmllbGQuc3BsaXQoJzovLycpWzBdID09PSAnaHlwZXJ0eScpIHtcclxuICAgICAgICAgICAgaHlwZXJ0eU5hbWUgPSBjb250ZXh0LnJ1bnRpbWVSZWdpc3RyeS5nZXRIeXBlcnR5TmFtZShyZW1vdmVQYXRoRnJvbVVSTChmaWVsZCkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaHlwZXJ0eU5hbWUgPT09IHRoaXMudGFyZ2V0KSB7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAnTm90IEFwcGxpY2FibGUnO1xyXG5cclxuICAgICAgY2FzZSAnaWRlbnRpdHknOlxyXG4gICAgICAgIGxldCBvd25lcjtcclxuXHJcbiAgICAgICAgaWYgKGlzRGF0YU9iamVjdFVSTChmaWVsZCkpIHtcclxuICAgICAgICAgIGxldCByZXBvcnRlciA9IGNvbnRleHQucnVudGltZVJlZ2lzdHJ5LmdldFJlcG9ydGVyVVJMU3luY2hvbm91cyhyZW1vdmVQYXRoRnJvbVVSTChmaWVsZCkpO1xyXG4gICAgICAgICAgb3duZXIgPSBjb250ZXh0LnJ1bnRpbWVSZWdpc3RyeS5nZXRIeXBlcnR5T3duZXIocmVwb3J0ZXIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoZmllbGQuc3BsaXQoJzovLycpWzBdID09PSAnaHlwZXJ0eScpIHtcclxuICAgICAgICAgICAgb3duZXIgPSBjb250ZXh0LnJ1bnRpbWVSZWdpc3RyeS5nZXRIeXBlcnR5T3duZXIocmVtb3ZlUGF0aEZyb21VUkwoZmllbGQpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG93bmVyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIG93bmVyID0gZ2V0VXNlckVtYWlsRnJvbVVSTChvd25lcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvd25lciA9PT0gdGhpcy50YXJnZXQpIHtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuICdOb3QgQXBwbGljYWJsZSc7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuY29uZGl0aW9uLmlzQXBwbGljYWJsZShjb250ZXh0LCBtZXNzYWdlLCB0aGlzLnNjb3BlLCB0aGlzLnRhcmdldCkpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuZGVjaXNpb247XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gJ05vdCBBcHBsaWNhYmxlJztcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFJ1bGU7XHJcbiIsImltcG9ydCBBbGxvd092ZXJyaWRlcyBmcm9tICcuL2NvbWJpbmluZ0FsZ29yaXRobXMvQWxsb3dPdmVycmlkZXMnO1xyXG5pbXBvcnQgQmxvY2tPdmVycmlkZXMgZnJvbSAnLi9jb21iaW5pbmdBbGdvcml0aG1zL0Jsb2NrT3ZlcnJpZGVzJztcclxuaW1wb3J0IEZpcnN0QXBwbGljYWJsZSBmcm9tICcuL2NvbWJpbmluZ0FsZ29yaXRobXMvRmlyc3RBcHBsaWNhYmxlJztcclxuaW1wb3J0IFJ1bGUgZnJvbSAnLi9SdWxlJztcclxuXHJcbmNsYXNzIFBvbGljeSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGtleSwgcnVsZXMsIGFjdGlvbnMsIGNvbWJpbmluZ0FsZ29yaXRobSkge1xyXG4gICAgaWYgKCFrZXkpIHRocm93IG5ldyBFcnJvcigna2V5IGlzIG5vdCBkZWZpbmVkJyk7XHJcbiAgICBpZiAoIWFjdGlvbnMpIHRocm93IG5ldyBFcnJvcignYWN0aW9ucyBhcmUgbm90IGRlZmluZWQnKTtcclxuXHJcbiAgICB0aGlzLmFjdGlvbnMgPSBhY3Rpb25zO1xyXG4gICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICB0aGlzLl9zZXRSdWxlcyhydWxlcyk7XHJcbiAgICB0aGlzLl9zZXRDb21iaW5pbmdBbGdvcml0aG0oY29tYmluaW5nQWxnb3JpdGhtKTtcclxuICB9XHJcblxyXG4gIGFkZEFjdGlvbihtZXRob2QsIHBhcmFtKSB7XHJcbiAgICB0aGlzLmFjdGlvbnMucHVzaCh7IG1ldGhvZDogbWV0aG9kLCBwYXJhbTogcGFyYW0gfSk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVSdWxlKGRlY2lzaW9uLCBjb25kaXRpb24sIHNjb3BlLCB0YXJnZXQsIHByaW9yaXR5KSB7XHJcbiAgICBpZiAocHJpb3JpdHkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBwcmlvcml0eSA9IHRoaXMuZ2V0TGFzdFByaW9yaXR5KCkgKyAxO1xyXG4gICAgfVxyXG4gICAgbGV0IHJ1bGUgPSBuZXcgUnVsZShkZWNpc2lvbiwgY29uZGl0aW9uLCBzY29wZSwgdGFyZ2V0LCBwcmlvcml0eSk7XHJcbiAgICB0aGlzLnJ1bGVzLnB1c2gocnVsZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVSdWxlKHJ1bGUpIHtcclxuICAgIGxldCBpbmRleFRvUmVtb3ZlID0gdGhpcy5ydWxlcy5pbmRleE9mKHJ1bGUpO1xyXG4gICAgdGhpcy5ydWxlcy5zcGxpY2UoaW5kZXhUb1JlbW92ZSwgMSk7XHJcbiAgfVxyXG5cclxuICBlbmZvcmNlQWN0aW9ucyhjb250ZXh0LCBtZXNzYWdlKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBsZXQgcmVzdWx0cyA9IFtdO1xyXG4gICAgICBpZiAodGhpcy5hY3Rpb25zLmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5hY3Rpb25zKSB7XHJcbiAgICAgICAgICBsZXQgcmVzdWx0ID0gY29udGV4dC5wZXAuYWN0aW9uc1NlcnZpY2VbdGhpcy5hY3Rpb25zW2ldLm1ldGhvZF0obWVzc2FnZSwgdGhpcy5hY3Rpb25zW2ldLnBhcmFtKTtcclxuICAgICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQcm9taXNlLmFsbChyZXN1bHRzKS50aGVuKChtZXNzYWdlcykgPT4ge1xyXG4gICAgICAgICAgcmVzb2x2ZShtZXNzYWdlcyk7XHJcbiAgICAgICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNvbHZlKFttZXNzYWdlXSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZXZhbHVhdGVSdWxlcyhjb250ZXh0LCBtZXNzYWdlLCBpc0luY29taW5nKSB7XHJcbiAgICBsZXQgcmVzdWx0cyA9IFtdO1xyXG4gICAgZm9yIChsZXQgaSBpbiB0aGlzLnJ1bGVzKSB7XHJcbiAgICAgIHJlc3VsdHMucHVzaCh0aGlzLnJ1bGVzW2ldLmV2YWx1YXRlKGNvbnRleHQsIG1lc3NhZ2UsIGlzSW5jb21pbmcpKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5jb21iaW5pbmdBbGdvcml0aG0uY29tYmluZShyZXN1bHRzKTtcclxuICB9XHJcblxyXG4gIGdldExhc3RQcmlvcml0eSgpIHtcclxuICAgIGxldCBwcmlvcml0aWVzID0gW107XHJcblxyXG4gICAgaWYgKHRoaXMucnVsZXMubGVuZ3RoICE9PSAwKSB7XHJcbiAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5ydWxlcykge1xyXG4gICAgICAgIHByaW9yaXRpZXMucHVzaCh0aGlzLnJ1bGVzW2ldLnByaW9yaXR5KTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gTWF0aC5tYXguYXBwbHkoTWF0aCwgcHJpb3JpdGllcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gLTE7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRSdWxlQnlQcmlvcml0eShwcmlvcml0eSkge1xyXG4gICAgZm9yIChsZXQgaSBpbiB0aGlzLnJ1bGVzKSB7XHJcbiAgICAgIGlmIChTdHJpbmcodGhpcy5ydWxlc1tpXS5wcmlvcml0eSkgPT09IFN0cmluZyhwcmlvcml0eSkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ydWxlc1tpXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhyb3cgRXJyb3IoJ1J1bGUgd2l0aCBwcmlvcml0eSAnICsgcHJpb3JpdHkgKyAnIGRvZXMgbm90IGV4aXN0IScpO1xyXG4gIH1cclxuXHJcbiAgX3NldENvbWJpbmluZ0FsZ29yaXRobShjb21iaW5pbmdBbGdvcml0aG0pIHtcclxuICAgIGlmICghY29tYmluaW5nQWxnb3JpdGhtKSB7XHJcbiAgICAgIGNvbWJpbmluZ0FsZ29yaXRobSA9ICdibG9ja092ZXJyaWRlcyc7XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKGNvbWJpbmluZ0FsZ29yaXRobSkge1xyXG4gICAgICBjYXNlICdibG9ja092ZXJyaWRlcyc6XHJcbiAgICAgICAgdGhpcy5jb21iaW5pbmdBbGdvcml0aG0gPSBuZXcgQmxvY2tPdmVycmlkZXMoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYWxsb3dPdmVycmlkZXMnOlxyXG4gICAgICAgIHRoaXMuY29tYmluaW5nQWxnb3JpdGhtID0gbmV3IEFsbG93T3ZlcnJpZGVzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2ZpcnN0QXBwbGljYWJsZSc6XHJcbiAgICAgICAgdGhpcy5jb21iaW5pbmdBbGdvcml0aG0gPSBuZXcgRmlyc3RBcHBsaWNhYmxlKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhyb3cgRXJyb3IoJ1Vua25vd24gYWxnb3JpdGhtOiAnICsgY29tYmluaW5nQWxnb3JpdGhtKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRSdWxlcyhydWxlcykge1xyXG4gICAgdGhpcy5ydWxlcyA9IFtdO1xyXG5cclxuICAgIGZvciAobGV0IGkgaW4gcnVsZXMpIHtcclxuICAgICAgbGV0IHJ1bGUgPSBydWxlc1tpXTtcclxuICAgICAgaWYgKHJ1bGUucHJpb3JpdHkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJ1bGUucHJpb3JpdHkgPSB0aGlzLmdldExhc3RQcmlvcml0eSgpICsgMTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIShydWxlIGluc3RhbmNlb2YgUnVsZSkpIHtcclxuICAgICAgICBydWxlID0gbmV3IFJ1bGUocnVsZS5kZWNpc2lvbiwgcnVsZS5jb25kaXRpb24sIHJ1bGUuc2NvcGUsIHJ1bGUudGFyZ2V0LCBydWxlLnByaW9yaXR5KTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnJ1bGVzLnB1c2gocnVsZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzb3J0UnVsZXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5ydWxlcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgbGV0IHggPSBhLnByaW9yaXR5OyBsZXQgeSA9IGIucHJpb3JpdHk7XHJcbiAgICAgIHJldHVybiAoKHggPCB5KSA/IC0xIDogKCh4ID4geSkgPyAxIDogMCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9saWN5O1xyXG4iLCIvLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdQRVAnKTtcclxuXHJcbmltcG9ydCBBY3Rpb25zU2VydmljZSBmcm9tICcuL0FjdGlvbnNTZXJ2aWNlJztcclxuaW1wb3J0IFBEUCBmcm9tICcuL1BEUCc7XHJcbmltcG9ydCBQb2xpY3kgZnJvbSAnLi9Qb2xpY3knO1xyXG5pbXBvcnQge2lzSHlwZXJ0eVVSTH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuY2xhc3MgUEVQIHtcclxuXHJcbiAgLyoqXHJcbiAgKiBDcmVhdGVzIGEgUG9saWN5IEVuZm9yY2VtZW50IFBvaW50IChQRVApIGluc3RhbmNlXHJcbiAgKiBAcGFyYW0gICAge09iamVjdH0gICAgY29udGV4dFxyXG4gICovXHJcbiAgY29uc3RydWN0b3IoY29udGV4dCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5wZHAgPSBuZXcgUERQKGNvbnRleHQpO1xyXG4gICAgX3RoaXMuYWN0aW9uc1NlcnZpY2UgPSBuZXcgQWN0aW9uc1NlcnZpY2UoY29udGV4dCk7XHJcbiAgICBfdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgIGNvbnRleHQucGVwID0gX3RoaXM7XHJcblxyXG4gICAgLy9UT0RPIHNob3VsZCBiZSBhZGRlZCBhIHRyaWdnZXIgdG8gdmVyaWZ5IHdoZW4gdGhlIGxvYWRDb25maWd1cmF0aW9ucyBpcyBzdWNjZXNzZnVsbHkgY29tcGxldGVkXHJcbiAgICBjb250ZXh0LmxvYWRDb25maWd1cmF0aW9ucygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiByZXR1cm4gdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeVxyXG4gICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1c1xyXG4gICovXHJcbiAgZ2V0IG1lc3NhZ2VCdXMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLmNvbnRleHQubWVzc2FnZUJ1cztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogU2V0IHRoZSBtZXNzYWdlQnVzIGluIHRoaXMgUmVnaXN0cnlcclxuICAqIEBwYXJhbSB7TWVzc2FnZUJ1c30gICAgICAgICAgIG1lc3NhZ2VCdXNcclxuICAqL1xyXG4gIHNldCBtZXNzYWdlQnVzKG1lc3NhZ2VCdXMpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5jb250ZXh0Lm1lc3NhZ2VCdXMgPSBtZXNzYWdlQnVzO1xyXG4gICAgX3RoaXMuYWRkR1VJTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBhZGRHVUlMaXN0ZW5lcnMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLmNvbnRleHQubWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihfdGhpcy5jb250ZXh0LnBlcFVSTCwgKG1zZykgPT4ge1xyXG4gICAgICBsZXQgZnVuY05hbWUgPSBtc2cuYm9keS5tZXRob2Q7XHJcblxyXG4gICAgICBsZXQgcmV0dXJuZWRWYWx1ZTtcclxuICAgICAgaWYgKGZ1bmNOYW1lID09PSAnYWRkVG9Hcm91cCcpIHtcclxuICAgICAgICBsZXQgZ3JvdXBOYW1lID0gbXNnLmJvZHkucGFyYW1zLmdyb3VwTmFtZTtcclxuICAgICAgICBsZXQgdXNlckVtYWlsID0gbXNnLmJvZHkucGFyYW1zLnVzZXJFbWFpbDtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuY29udGV4dC5hZGRUb0dyb3VwKGdyb3VwTmFtZSwgdXNlckVtYWlsKTtcclxuICAgICAgfSBlbHNlIGlmIChmdW5jTmFtZSA9PT0gJ2NyZWF0ZUdyb3VwJykge1xyXG4gICAgICAgIGxldCBncm91cE5hbWUgPSBtc2cuYm9keS5wYXJhbXMuZ3JvdXBOYW1lO1xyXG4gICAgICAgIHJldHVybmVkVmFsdWUgPSBfdGhpcy5jb250ZXh0LmNyZWF0ZUdyb3VwKGdyb3VwTmFtZSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZnVuY05hbWUgPT09ICdhZGRQb2xpY3knKSB7XHJcbiAgICAgICAgbGV0IHNvdXJjZSA9IG1zZy5ib2R5LnBhcmFtcy5zb3VyY2U7XHJcbiAgICAgICAgbGV0IGtleSA9IG1zZy5ib2R5LnBhcmFtcy5rZXk7XHJcbiAgICAgICAgbGV0IHBvbGljeSA9IG1zZy5ib2R5LnBhcmFtcy5wb2xpY3k7XHJcbiAgICAgICAgbGV0IGNvbWJpbmluZ0FsZ29yaXRobSA9IG1zZy5ib2R5LnBhcmFtcy5jb21iaW5pbmdBbGdvcml0aG07XHJcbiAgICAgICAgcmV0dXJuZWRWYWx1ZSA9IF90aGlzLmFkZFBvbGljeShzb3VyY2UsIGtleSwgcG9saWN5LCBjb21iaW5pbmdBbGdvcml0aG0pO1xyXG4gICAgICB9IGVsc2UgaWYgKGZ1bmNOYW1lID09PSAnZGVsZXRlR3JvdXAnKSB7XHJcbiAgICAgICAgbGV0IGdyb3VwTmFtZSA9IG1zZy5ib2R5LnBhcmFtcy5ncm91cE5hbWU7XHJcbiAgICAgICAgcmV0dXJuZWRWYWx1ZSA9IF90aGlzLmNvbnRleHQuZGVsZXRlR3JvdXAoZ3JvdXBOYW1lKTtcclxuICAgICAgfSBlbHNlIGlmIChmdW5jTmFtZSA9PT0gJ3JlbW92ZVBvbGljeScpIHtcclxuICAgICAgICBsZXQgc291cmNlID0gbXNnLmJvZHkucGFyYW1zLnNvdXJjZTtcclxuICAgICAgICBsZXQga2V5ID0gbXNnLmJvZHkucGFyYW1zLmtleTtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMucmVtb3ZlUG9saWN5KHNvdXJjZSwga2V5KTtcclxuICAgICAgfSBlbHNlIGlmIChmdW5jTmFtZSA9PT0gJ3NhdmVQb2xpY2llcycpIHtcclxuICAgICAgICBsZXQgc291cmNlID0gbXNnLmJvZHkucGFyYW1zLnNvdXJjZTtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuY29udGV4dC5zYXZlUG9saWNpZXMoc291cmNlKTtcclxuICAgICAgfSBlbHNlIGlmIChmdW5jTmFtZSA9PT0gJ3VzZXJQb2xpY2llcycpIHtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuY29udGV4dC51c2VyUG9saWNpZXM7XHJcbiAgICAgIH0gZWxzZSBpZiAoZnVuY05hbWUgPT09ICdhY3RpdmVVc2VyUG9saWN5Jykge1xyXG4gICAgICAgIGxldCB1c2VyUG9saWN5ID0gbXNnLmJvZHkucGFyYW1zLnVzZXJQb2xpY3k7XHJcbiAgICAgICAgaWYgKHVzZXJQb2xpY3kpIHsgX3RoaXMuY29udGV4dC5hY3RpdmVVc2VyUG9saWN5ID0gdXNlclBvbGljeTsgfVxyXG4gICAgICAgIHJldHVybmVkVmFsdWUgPSBfdGhpcy5jb250ZXh0LmFjdGl2ZVVzZXJQb2xpY3k7XHJcbiAgICAgIH0gZWxzZSBpZiAoZnVuY05hbWUgPT09ICd1c2VyUG9saWN5Jykge1xyXG4gICAgICAgIGxldCBrZXkgPSBtc2cuYm9keS5wYXJhbXMua2V5O1xyXG4gICAgICAgIHJldHVybmVkVmFsdWUgPSBfdGhpcy5jb250ZXh0LnVzZXJQb2xpY2llc1trZXldO1xyXG4gICAgICB9IGVsc2UgaWYgKGZ1bmNOYW1lID09PSAnc2F2ZUFjdGl2ZVBvbGljeScpIHtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuY29udGV4dC5zYXZlQWN0aXZlUG9saWN5KCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZnVuY05hbWUgPT09ICdnZXRNeUVtYWlscycpIHtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuY29udGV4dC5nZXRNeUVtYWlscygpO1xyXG4gICAgICB9IGVsc2UgaWYgKGZ1bmNOYW1lID09PSAnZ2V0TXlIeXBlcnRpZXMnKSB7XHJcbiAgICAgICAgcmV0dXJuZWRWYWx1ZSA9IF90aGlzLmNvbnRleHQuZ2V0TXlIeXBlcnRpZXMoKTtcclxuICAgICAgfSBlbHNlIGlmIChmdW5jTmFtZSA9PT0gJ2dyb3VwcycpIHtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuY29udGV4dC5ncm91cHM7XHJcbiAgICAgIH0gZWxzZSBpZiAoZnVuY05hbWUgPT09ICdnZXRHcm91cHNOYW1lcycpIHtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuY29udGV4dC5nZXRHcm91cHNOYW1lcygpO1xyXG4gICAgICB9IGlmIChmdW5jTmFtZSA9PT0gJ3JlbW92ZUZyb21Hcm91cCcpIHtcclxuICAgICAgICBsZXQgZ3JvdXBOYW1lID0gbXNnLmJvZHkucGFyYW1zLmdyb3VwTmFtZTtcclxuICAgICAgICBsZXQgdXNlckVtYWlsID0gbXNnLmJvZHkucGFyYW1zLnVzZXJFbWFpbDtcclxuICAgICAgICByZXR1cm5lZFZhbHVlID0gX3RoaXMuY29udGV4dC5yZW1vdmVGcm9tR3JvdXAoZ3JvdXBOYW1lLCB1c2VyRW1haWwpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgdmFsdWUgPSB7dHlwZTogJ2V4ZWN1dGUnLCB2YWx1ZTogcmV0dXJuZWRWYWx1ZSwgY29kZTogMjAwfTtcclxuICAgICAgbGV0IHJlcGx5TXNnID0ge2lkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIHRvOiBtc2cuZnJvbSwgZnJvbTogbXNnLnRvLCBib2R5OiB2YWx1ZX07XHJcbiAgICAgIF90aGlzLmNvbnRleHQubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShyZXBseU1zZyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogQWRkcyBhIHBvbGljeSB0byB0aGUgUG9saWN5IEVuZm9yY2VtZW50IFBvaW50IChQRVApLiBUaGUgcG9saWN5IGNhbiBiZSBjcmVhdGVkIGJ5IHRoZSBzZXJ2aWNlXHJcbiAgKiBwcm92aWRlciBvciBieSB0aGUgdXNlci5cclxuICAqIEBwYXJhbSAgICB7U3RyaW5nfSAgICBzb3VyY2VcclxuICAqIEBwYXJhbSAgICB7U3RyaW5nfSAgICBrZXlcclxuICAqIEBwYXJhbSAgICB7T2JqZWN0fSAgICBwb2xpY3lcclxuICAqL1xyXG4gIGFkZFBvbGljeShzb3VyY2UsIGtleSwgcG9saWN5LCBjb21iaW5pbmdBbGdvcml0aG0pIHtcclxuICAgIGlmICghc291cmNlKSB0aHJvdyBuZXcgRXJyb3IoJ3NvdXJjZSBpcyBub3QgZGVmaW5lZCcpO1xyXG4gICAgaWYgKCFrZXkpIHRocm93IG5ldyBFcnJvcigna2V5IGlzIG5vdCBkZWZpbmVkJyk7XHJcblxyXG4gICAgaWYgKHBvbGljeSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHBvbGljeSA9IG5ldyBQb2xpY3koa2V5LCBbXSwgW10sIGNvbWJpbmluZ0FsZ29yaXRobSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoIShwb2xpY3kgaW5zdGFuY2VvZiBQb2xpY3kpKSB7XHJcbiAgICAgICAgcG9saWN5ID0gbmV3IFBvbGljeShwb2xpY3kua2V5LCBwb2xpY3kucnVsZXMsIHBvbGljeS5hY3Rpb25zLCBwb2xpY3kuY29tYmluaW5nQWxnb3JpdGhtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHN3aXRjaCAoc291cmNlKSB7XHJcbiAgICAgIGNhc2UgJ1NFUlZJQ0VfUFJPVklERVInOlxyXG4gICAgICAgIHRoaXMuY29udGV4dC5zYXZlUG9saWNpZXMoc291cmNlLCBwb2xpY3ksIGtleSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ1VTRVInOlxyXG4gICAgICAgIHRoaXMuY29udGV4dC51c2VyUG9saWNpZXNba2V5XSA9IHBvbGljeTtcclxuICAgICAgICB0aGlzLmNvbnRleHQuc2F2ZVBvbGljaWVzKHNvdXJjZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhyb3cgRXJyb3IoJ1Vua25vd24gcG9saWN5IHNvdXJjZTogJyArIHNvdXJjZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhdXRob3Jpc2UobWVzc2FnZSwgaXNJbmNvbWluZykge1xyXG4gICAgLy8gbG9nLmxvZygnW1BvbGljeS5QRVAgQXV0aG9yaXNlXSAnLCBtZXNzYWdlKTtcclxuICAgIC8vIGxvZy5sb2cobWVzc2FnZSk7XHJcbiAgICBpZiAoIW1lc3NhZ2UpIHRocm93IG5ldyBFcnJvcignbWVzc2FnZSBpcyBub3QgZGVmaW5lZCcpO1xyXG4gICAgaWYgKCFtZXNzYWdlLmZyb20pIHRocm93IG5ldyBFcnJvcignbWVzc2FnZS5mcm9tIGlzIG5vdCBkZWZpbmVkJyk7XHJcbiAgICBpZiAoIW1lc3NhZ2UudG8pIHRocm93IG5ldyBFcnJvcignbWVzc2FnZS50byBpcyBub3QgZGVmaW5lZCcpO1xyXG4gICAgaWYgKCFtZXNzYWdlLnR5cGUpIHRocm93IG5ldyBFcnJvcignbWVzc2FnZS50eXBlIGlzIG5vdCBkZWZpbmVkJyk7XHJcbiAgICBtZXNzYWdlLmJvZHkgPSBtZXNzYWdlLmJvZHkgfHwge307XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIG1lc3NhZ2UuYm9keSA9IG1lc3NhZ2UuYm9keSB8fCB7fTtcclxuICAgICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAgIGxldCByZXN1bHQgPSBfdGhpcy5wZHAuZXZhbHVhdGVQb2xpY2llcyhtZXNzYWdlLCBpc0luY29taW5nKTtcclxuICAgICAgaWYgKHJlc3VsdCA9PT0gJ05vdCBBcHBsaWNhYmxlJykge1xyXG4gICAgICAgIHJlc3VsdCA9IF90aGlzLmNvbnRleHQuZGVmYXVsdEJlaGF2aW91cjtcclxuICAgICAgICBtZXNzYWdlLmJvZHkuYXV0aCA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIF90aGlzLmFjdGlvbnNTZXJ2aWNlLmVuZm9yY2VQb2xpY2llcyhtZXNzYWdlLCBpc0luY29taW5nKS50aGVuKG1lc3NhZ2VzID0+IHtcclxuICAgICAgICBmb3IgKGxldCBpIGluIG1lc3NhZ2VzKSB7XHJcbiAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZXNbaV07XHJcbiAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UuYm9keS5hdXRoID0gKG1lc3NhZ2UuYm9keS5hdXRoID09PSB1bmRlZmluZWQpID8gdHJ1ZSA6IG1lc3NhZ2UuYm9keS5hdXRoO1xyXG4gICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IGVycm9yTWVzc2FnZSA9IHsgYm9keTogeyBjb2RlOiA0MDMsIGRlc2NyaXB0aW9uOiAnQmxvY2tlZCBieSBwb2xpY3knIH0sIGZyb206IG1lc3NhZ2UudG8sIHRvOiBtZXNzYWdlLmZyb20sIHR5cGU6ICdyZXNwb25zZScgfTtcclxuICAgICAgICAgICAgcmVqZWN0KGVycm9yTWVzc2FnZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAoZXJyb3IpID0+IHtcclxuICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuICB9XHJcbiAgYXV0aG9yaXNlU3luYyhtZXNzYWdlKSB7XHJcbiAgICBsZXQgcmVzdWx0O1xyXG4gICAgbWVzc2FnZS5ib2R5ID0gbWVzc2FnZS5ib2R5IHx8IHt9O1xyXG4gICAgcmVzdWx0ID0gdGhpcy5wZHAuZXZhbHVhdGVQb2xpY2llcyhtZXNzYWdlLCB0cnVlKTtcclxuICAgIGlmIChyZXN1bHQgPT09ICdOb3QgQXBwbGljYWJsZScpIHtcclxuICAgICAgcmVzdWx0ID0gdGhpcy5jb250ZXh0LmRlZmF1bHRCZWhhdmlvdXI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG5cclxuICB9XHJcblxyXG4gIHJlbW92ZVBvbGljeShzb3VyY2UsIGtleSkge1xyXG4gICAgaWYgKCFzb3VyY2UpIHRocm93IG5ldyBFcnJvcignc291cmNlIGlzIG5vdCBkZWZpbmVkJyk7XHJcbiAgICBpZiAoc291cmNlICE9PSAnKicgJiYgIWtleSkgdGhyb3cgbmV3IEVycm9yKCdrZXkgaXMgbm90IGRlZmluZWQnKTtcclxuXHJcbiAgICBzd2l0Y2ggKHNvdXJjZSkge1xyXG4gICAgICBjYXNlICcqJzpcclxuICAgICAgICB0aGlzLmNvbnRleHQuc2VydmljZVByb3ZpZGVyUG9saWN5ID0ge307XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LnVzZXJQb2xpY2llcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5hY3RpdmVVc2VyUG9saWN5ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5zYXZlUG9saWNpZXMoJ1VTRVInKTtcclxuICAgICAgICB0aGlzLmNvbnRleHQuc2F2ZVBvbGljaWVzKCdTRVJWSUNFX1BST1ZJREVSJyk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LnNhdmVBY3RpdmVQb2xpY3koKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnU0VSVklDRV9QUk9WSURFUic6XHJcbiAgICAgICAgZGVsZXRlIHRoaXMuY29udGV4dC5zZXJ2aWNlUHJvdmlkZXJQb2xpY3lba2V5XTtcclxuICAgICAgICB0aGlzLmNvbnRleHQuc2F2ZVBvbGljaWVzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ1VTRVInOlxyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmNvbnRleHQudXNlclBvbGljaWVzW2tleV07XHJcbiAgICAgICAgaWYgKGtleSA9PT0gdGhpcy5jb250ZXh0LmFjdGl2ZVVzZXJQb2xpY3kpIHtcclxuICAgICAgICAgIHRoaXMuY29udGV4dC5hY3RpdmVVc2VyUG9saWN5ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgdGhpcy5jb250ZXh0LnNhdmVBY3RpdmVQb2xpY3koKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LnNhdmVQb2xpY2llcygnVVNFUicpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHRocm93IEVycm9yKCdVbmtub3duIHBvbGljeSBzb3VyY2U6ICcgKyBzb3VyY2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBFUDtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignUGlwZWxpbmUnKTtcclxuXHJcbi8qKlxyXG4qIEBhdXRob3IgbWljYWVscGVkcm9zYUBnbWFpbC5jb21cclxuKiBTZXF1ZW5jaWFsIHByb2Nlc3NvciBvZiBtZXRob2RzLiBTaW1pbGFyIHRvIGhvdyBTZXF1ZW50aWFsIFByb21pc2UncyB3b3JrLCBidXQgYmV0dGVyIGZpdCBmb3IgbWVzc2FnZSBwcm9jZXNzaW5nLlxyXG4qIE5vcm1hbCB1c2UgZm9yIHRoaXMsIGlzIHRvIGludGVyY2VwdCBhbGwgbWVzc2FnZXMgd2l0aCBjb25maWd1cmVkIGhhbmRsZXJzLCBhbmQgYWN0IGFjY29yZGluZ2x5LlxyXG4qL1xyXG5cclxuaW1wb3J0IHtpc0RhdGFPYmplY3RVUkx9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuXHJcbmNsYXNzIFBpcGVsaW5lIHtcclxuICAvKiBwdWJsaWNcclxuICAgIGhhbmRsZXJzOiAoKFBpcGVDb250ZXh0KSA9PiB2b2lkKVtdXHJcbiAgICBvbkZhaWw6IChlcnJvcikgPT4gdm9pZFxyXG4gICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKF9vbkZhaWwpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuaGFuZGxlcnMgPSBbXTtcclxuICAgIF90aGlzLm9uRmFpbCA9IF9vbkZhaWw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbnNlcnQgYSBtZXNzYWdlIGluIHRoZSBwaXBlbGluZSBxdWV1ZS4gQWxsIG1lc3NhZ2VzIGFyZSB3cmFwcGVkIHdpdGggYSBQaXBlQ29udGV4dC5cclxuICAgKiBAcGFyYW0gIHtNZXNzYWdlfSBtc2cgICAgICAgTWVzc2FnZSBmb3IgdGhlIHF1ZXVlXHJcbiAgICogQHBhcmFtICB7Q2FsbGJhY2t9IG9uRGVsaXZlciBXaGVuIG1lc3NhZ2UgaXMgZmluaXNoZWQgcHJvY2Vzc2luZyBmcm9tIGFsbCBoYW5kbGVycywgaXQgd2lsbCBiZSBkZWxpdmVyZWQgaW4gdGhpcyBjYWxsYmFjay5cclxuICAgKi9cclxuICBwcm9jZXNzKG1zZywgb25EZWxpdmVyKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGlmIChfdGhpcy5oYW5kbGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGxldCBpdGVyID0gbmV3IEl0ZXJhdG9yKF90aGlzLmhhbmRsZXJzKTtcclxuICAgICAgaXRlci5uZXh0KG5ldyBQaXBlQ29udGV4dChfdGhpcywgaXRlciwgbXNnLCBvbkRlbGl2ZXIpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIG9uRGVsaXZlcihtc2cpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiogQGF1dGhvciBtaWNhZWxwZWRyb3NhQGdtYWlsLmNvbVxyXG4qIFdyYXBwZXIgYXJvdW5kIGEgbWVzc2FnZSB0aGF0IGFkZHMgYWN0aW9ucyB0aGF0IGNhbiBiZSBmaXJlZCBieSBhbnkgaW50ZXJjZXB0b3IgaGFuZGxlci5cclxuKiBUaGUgUGlwZWxpbmUgaXMgYXN5bmNocm9ub3VzLCBzbyBhbiBoYW5kbGVyIHNob3VsZCBhbHdheXMgY2FsbCBhbiBhY3Rpb24sIHRoZSBkZWZhdWx0IG9uZSBpcyBcIm5leHQoKVwiXHJcbiovXHJcbmNsYXNzIFBpcGVDb250ZXh0IHtcclxuICAvKiBwcml2YXRlXHJcbiAgICBfaW5TdG9wOiBib29sZWFuXHJcblxyXG4gICAgX3BpcGVsaW5lOiBQaXBlbGluZVxyXG4gICAgX2l0ZXI6IEl0ZXJhdG9yXHJcbiAgICBfbXNnOiBNZXNzYWdlXHJcbiAgKi9cclxuXHJcbiAgY29uc3RydWN0b3IocGlwZWxpbmUsIGl0ZXIsIG1zZywgb25EZWxpdmVyKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9pblN0b3AgPSBmYWxzZTtcclxuXHJcbiAgICBfdGhpcy5fcGlwZWxpbmUgPSBwaXBlbGluZTtcclxuICAgIF90aGlzLl9pdGVyID0gaXRlcjtcclxuICAgIF90aGlzLl9tc2cgPSBtc2c7XHJcbiAgICBfdGhpcy5fb25EZWxpdmVyID0gb25EZWxpdmVyO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHBpcGVsaW5lKCkgeyByZXR1cm4gdGhpcy5fcGlwZWxpbmU7IH1cclxuXHJcbiAgZ2V0IG1zZygpIHsgcmV0dXJuIHRoaXMuX21zZzsgfVxyXG4gIHNldCBtc2coaW5Nc2cpIHsgdGhpcy5fbXNnID0gaW5Nc2c7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogUHJvY2VlZCB0byB0aGUgbmV4dCBpbnRlcmNlcHRvciBoYW5kbGVyLCB1bmxlc3MgdGhlcmUgd2FzIGFuIGVycm9yLiBJZiBpdCdzIHRoZSBsYXN0IG9uZSwgcHJvY2VlZCB0byBvbkRlbGl2ZXIgaGFuZGxlci5cclxuICAgKi9cclxuICBuZXh0KCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoIV90aGlzLl9pblN0b3ApIHtcclxuICAgICAgaWYgKF90aGlzLl9pdGVyLmhhc05leHQpIHtcclxuICAgICAgICBfdGhpcy5faXRlci5uZXh0KF90aGlzKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBfdGhpcy5fb25EZWxpdmVyKF90aGlzLl9tc2cpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQcm9jZWVkIGRpcmVjdGx5IHRvIHRoZSBvbkRlbGl2ZXIgaGFuZGxlciwgdW5sZXNzIHRoZXJlIHdhcyBhbiBlcnJvci5cclxuICAgKi9cclxuICBkZWxpdmVyKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGlmICghX3RoaXMuX2luU3RvcCkge1xyXG4gICAgICBfdGhpcy5faW5TdG9wID0gdHJ1ZTtcclxuICAgICAgX3RoaXMuX29uRGVsaXZlcihfdGhpcy5fbXNnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1hcmsgdGhlIGNvbnRleHQgd2l0aCBhbiBlcnJvciBhbmQgcHJvY2VlZCB0byB0aGUgb25GYWlsIGhhbmRsZXIuXHJcbiAgICogQHBhcmFtICB7W3R5cGVdfSBlcnJvciBbZGVzY3JpcHRpb25dXHJcbiAgICovXHJcbiAgZmFpbChlcnJvcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoIV90aGlzLl9pblN0b3ApIHtcclxuICAgICAgX3RoaXMuX2luU3RvcCA9IHRydWU7XHJcbiAgICAgIGlmIChfdGhpcy5fcGlwZWxpbmUub25GYWlsKSB7XHJcbiAgICAgICAgX3RoaXMuX3BpcGVsaW5lLm9uRmFpbChlcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuXHJcblxyXG59XHJcblxyXG5jbGFzcyBJdGVyYXRvciB7XHJcbiAgLyogcHJpdmF0ZVxyXG4gICAgX2luZGV4OiBudW1iZXJcclxuICAgIF9hcnJheTogW11cclxuICAqL1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcnJheSkge1xyXG4gICAgdGhpcy5faW5kZXggPSAtMTtcclxuICAgIHRoaXMuX2FycmF5ID0gYXJyYXk7XHJcbiAgfVxyXG5cclxuICBnZXQgaGFzTmV4dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbmRleCA8IHRoaXMuX2FycmF5Lmxlbmd0aCAtIDE7XHJcbiAgfVxyXG5cclxuICBnZXQgbmV4dCgpIHtcclxuICAgIHRoaXMuX2luZGV4Kys7XHJcbiAgICByZXR1cm4gdGhpcy5fYXJyYXlbdGhpcy5faW5kZXhdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUGlwZWxpbmU7XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcbi8vIExvZyBzeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ01lc3NhZ2VCdXMnKTtcclxuXHJcbmltcG9ydCBCdXMgZnJvbSAnLi9CdXMnO1xyXG5pbXBvcnQgUGlwZWxpbmUgZnJvbSAnLi9QaXBlbGluZSc7XHJcblxyXG4vKipcclxuKiBAYXV0aG9yIG1pY2FlbHBlZHJvc2FAZ21haWwuY29tXHJcbiogTWVzc2FnZSBCVVMgSW50ZXJmYWNlIGlzIGFuIGV4dGVuc2lvbiBvZiB0aGUgQnVzXHJcbiogSXQgZG9lc24ndCBzdXBwb3J0IHRoZSBkZWZhdWx0ICcqJyBsaXN0ZW5lciwgaW5zdGVhZCBpdCB1c2VzIHRoZSByZWdpc3RyeS5yZXNvbHZlKC4uKVxyXG4qL1xyXG5jbGFzcyBNZXNzYWdlQnVzIGV4dGVuZHMgQnVzIHtcclxuICAvKiBwcml2YXRlXHJcbiAgX3JlZ2lzdHJ5OiBSZWdpc3RyeVxyXG4gIF9mb3J3YXJkczogeyA8ZnJvbS11cmw+OiB7IGZsOiBNc2dMaXN0ZW5lciwgc2FuZGJveFRvVXJsczogTWFwKFNhbmRib3gsIFt0by11cmxdKSwgdXJsVG9TYW5kYm94OiB7IHRvLXVybDogU2FuZGJveCB9IH0gfVxyXG5cclxuICBfcGlwZWxpbmU6IFBpcGVsaW5lXHJcbiAgKi9cclxuXHJcbiAgLy9UT0RPOiBmdXR1cmUgb3B0aW1pemF0aW9uXHJcbiAgLy8xLiBtZXNzYWdlIGJhdGNoIHByb2Nlc3Npbmcgd2l0aCBzZXRJbnRlcnZhbFxyXG4gIC8vMi4gcmVzb2x2ZSBkZWZhdWx0IGdhdGV3YXkvcHJvdG9zdHViIHdpdGggcmVnaXN0ZXIucmVzb2x2ZVxyXG5cclxuICBjb25zdHJ1Y3RvcihyZWdpc3RyeSkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuX3JlZ2lzdHJ5ID0gcmVnaXN0cnk7XHJcbiAgICB0aGlzLl9mb3J3YXJkcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX3BpcGVsaW5lSW4gPSBuZXcgUGlwZWxpbmUoKGVycm9yKSA9PiB7XHJcbiAgICAgIGxvZy5lcnJvcignUElQRUxJTkUtRVJST1I6ICcsIEpTT04uc3RyaW5naWZ5KGVycm9yKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9waXBlbGluZU91dCA9IG5ldyBQaXBlbGluZSgoZXJyb3IpID0+IHtcclxuICAgICAgbG9nLmVycm9yKCdQSVBFTElORS1FUlJPUjogJywgSlNPTi5zdHJpbmdpZnkoZXJyb3IpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHBpcGVsaW5lSW4oKSB7IHJldHVybiB0aGlzLl9waXBlbGluZUluOyB9XHJcblxyXG4gIGdldCBwaXBlbGluZU91dCgpIHsgcmV0dXJuIHRoaXMuX3BpcGVsaW5lT3V0OyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBvc3QgYSBtZXNzYWdlIGZvciByb3V0aW5nLiBJdCB3aWxsIGZpcnN0IHNlYXJjaCBmb3IgYSBsaXN0ZW5lciwgaWYgdGhlcmUgaXMgbm8gb25lLCBpdCBzZW5kcyB0byBhIGV4dGVybmFsIHJvdXRpbmcgdXNpbmcgdGhlIF9vblBvc3RNZXNzYWdlLlxyXG4gICAqIEV4dGVybmFsIHJvdXRpbmcgdXNlIHRoZSByZWdpc3RyeS5yZXNvbHZlKC4uKSBtZXRob2QgdG8gZGVjaWRlIHRoZSBkZXN0aW5hdGlvbiBzYW5kYm94LlxyXG4gICAqIEBwYXJhbSAge01lc3NhZ2V9IGluTXNnICAgICAgICAgICAgSlNPTiB3aXRoIG1hbmRhdG9yeSBNZXNzYWdlIHN0cnVjdHVyZSB7aWQsIHR5cGUsIGZyb20sIHRvfVxyXG4gICAqIEBwYXJhbSAge0NhbGxiYWNrfSByZXNwb25zZUNhbGxiYWNrIE9wdGlvbmFsIGNhbGxiYWNrIGlmIGEgcmVzcG9uc2UgaXMgZXhwZWN0ZWQgZnJvbSB0aGUgcmVxdWVzdC4gQSByZXNwb25zZSB3aWxsIGJlIGFsd2F5cyBzZW50LCBldmVuIGlmIGl0IGlzIGEgXCJUaW1lb3V0XCIuXHJcbiAgICogQHJldHVybiB7bnVtYmVyfSAgICAgICAgICAgICAgICAgIHRoZSBNZXNzYWdlIGlkXHJcbiAgICovXHJcbiAgcG9zdE1lc3NhZ2UoaW5Nc2csIHJlc3BvbnNlQ2FsbGJhY2ssIHRpbWVvdXQpIHtcclxuICAgIGxvZy5pbmZvKCdvblBPU1RNZXNzYWdlOiAnLCBpbk1zZyk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBkZWxpdmVyID0gKG1zZykgPT4ge1xyXG5cclxuICAgICAgICAgIF90aGlzLl9yZXNwb25zZUNhbGxiYWNrKGluTXNnLCByZXNwb25zZUNhbGxiYWNrLCB0aW1lb3V0KTtcclxuXHJcbiAgICAgICAgICBpZiAoIV90aGlzLl9vblJlc3BvbnNlKG1zZykpIHtcclxuICAgICAgICAgICAgbGV0IGl0ZW1MaXN0ID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbbXNnLnRvXTtcclxuICAgICAgICAgICAgaWYgKGl0ZW1MaXN0KSB7XHJcbiAgICAgICAgICAgICAgLy9kbyBub3QgcHVibGlzaCBvbiBkZWZhdWx0IGFkZHJlc3MsIGJlY2F1c2Ugb2YgbG9vcGJhY2sgY3ljbGVcclxuICAgICAgICAgICAgICBfdGhpcy5fcHVibGlzaE9uKGl0ZW1MaXN0LCBtc2cpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgbm8gbGlzdGVuZXIsIHNlbmQgdG8gZXh0ZXJuYWwgaW50ZXJmYWNlXHJcbiAgICAgICAgICAgICAgX3RoaXMuX29uUG9zdE1lc3NhZ2UobXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF90aGlzLl9nZW5JZChpbk1zZyk7XHJcblxyXG4gICAgaWYgKF90aGlzLl9pc1RvUHJvY2Vzcyhpbk1zZykpIHtcclxuICAgICAgbGV0IGlzSW5jb21pbmcgPSBfdGhpcy5faXNJbmNvbWluZ01lc3NhZ2UoaW5Nc2cpO1xyXG5cclxuICAgICAgaWYgKGlzSW5jb21pbmcpIF90aGlzLl9waXBlbGluZUluLnByb2Nlc3MoaW5Nc2csIGRlbGl2ZXIpO1xyXG4gICAgICBlbHNlIF90aGlzLl9waXBlbGluZU91dC5wcm9jZXNzKGluTXNnLCBkZWxpdmVyKTtcclxuICAgIH0gZWxzZSBkZWxpdmVyKGluTXNnKTtcclxuXHJcbiAgICByZXR1cm4gaW5Nc2cuaWQ7XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIF9pc1RvUHJvY2VzcyhtZXNzYWdlKSB7XHJcbiAgICBsZXQgc2NoZW1hc1RvSWdub3JlID0gWydkb21haW4nLCAnZG9tYWluLWlkcCcsICdnbG9iYWwnLCAnaHlwZXJ0eS1ydW50aW1lJywgJ3J1bnRpbWUnXTtcclxuICAgIGxldCBzcGxpdEZyb20gPSAobWVzc2FnZS5mcm9tKS5zcGxpdCgnOi8vJyk7XHJcbiAgICBsZXQgZnJvbVNjaGVtYSA9IHNwbGl0RnJvbVswXTtcclxuICAgIGxldCBzcGxpdFRvID0gKG1lc3NhZ2UudG8pLnNwbGl0KCc6Ly8nKTtcclxuICAgIGxldCB0b1NjaGVtYSA9ICBzcGxpdFRvWzBdO1xyXG4gICAgbGV0IGZyb20gPSBtZXNzYWdlLmZyb207XHJcbiAgICBsZXQgdG8gPSBtZXNzYWdlLnRvO1xyXG5cclxuICAgIC8vIFNpZ25hbGxpbmcgbWVzc2FnZXMgYmV0d2VlbiBQMlAgU3R1YnMgZG9uJ3QgaGF2ZSB0byBiZSB2ZXJpZmllZC4gRkZTXHJcblxyXG4gICAgaWYgKG1lc3NhZ2UuYm9keSAmJiBtZXNzYWdlLmJvZHkuc291cmNlKSB7XHJcbiAgICAgIGZyb20gPSBtZXNzYWdlLmJvZHkuc291cmNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChtZXNzYWdlLmJvZHkgJiYgbWVzc2FnZS5ib2R5LnN1YnNjcmliZXIpIHtcclxuICAgICAgZnJvbSA9IG1lc3NhZ2UuYm9keS5zdWJzY3JpYmVyO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChmcm9tLmluZGV4T2YoJy9wMnBoYW5kbGVyLycpICE9PSAtMSB8fCBmcm9tLmluZGV4T2YoJy9wMnByZXF1ZXN0ZXIvJykgIT09IC0xIHx8IHRvLmluZGV4T2YoJy9wMnBoYW5kbGVyLycpICE9PSAtMSB8fCB0by5pbmRleE9mKCcvcDJwcmVxdWVzdGVyLycpICE9PSAtMSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuX3JlZ2lzdHJ5LmlzTG9jYWwoZnJvbSkgJiYgdGhpcy5fcmVnaXN0cnkuaXNMb2NhbChtZXNzYWdlLnRvKSlcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIGlmIChtZXNzYWdlLmZyb20gPT09IGZyb21TY2hlbWEgfHwgbWVzc2FnZS50byA9PT0gdG9TY2hlbWEgfHwgbWVzc2FnZS50eXBlID09PSAncmVhZCcgfHwgbWVzc2FnZS50eXBlID09PSAncmVzcG9uc2UnIHx8IChtZXNzYWdlLmZyb20uaW5jbHVkZXMoJ2h5cGVydHk6Ly8nKSAmJiBtZXNzYWdlLnR5cGUgPT09ICdkZWxldGUnKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gc2NoZW1hc1RvSWdub3JlLmluZGV4T2YoZnJvbVNjaGVtYSkgPT09IC0xIHx8IHNjaGVtYXNUb0lnbm9yZS5pbmRleE9mKHRvU2NoZW1hKSA9PT0gLTE7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaXNJbmNvbWluZ01lc3NhZ2UobWVzc2FnZSkge1xyXG4gICAgbGV0IGZyb207XHJcblxyXG4gICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ2ZvcndhcmQnKSB7XHJcbiAgICAgIGxvZy5pbmZvKCdbTWVzc2FnZUJ1cyAtIGlzSW5jb21pbmdNZXNzYWdlXSAtIG1lc3NhZ2UudHlwZTogJywgbWVzc2FnZS50eXBlKTtcclxuICAgICAgZnJvbSA9IG1lc3NhZ2UuYm9keS5mcm9tO1xyXG4gICAgfSBlbHNlIGlmIChtZXNzYWdlLmhhc093blByb3BlcnR5KCdib2R5JykgJiYgbWVzc2FnZS5ib2R5Lmhhc093blByb3BlcnR5KCdzb3VyY2UnKSAmJiBtZXNzYWdlLmJvZHkuc291cmNlKSB7XHJcbiAgICAgIGxvZy5pbmZvKCdbTWVzc2FnZUJ1cyAtIGlzSW5jb21pbmdNZXNzYWdlXSAtIG1lc3NhZ2UuYm9keS5zb3VyY2U6ICcsIG1lc3NhZ2UuYm9keS5zb3VyY2UpO1xyXG4gICAgICBmcm9tID0gbWVzc2FnZS5ib2R5LnNvdXJjZTtcclxuICAgIH0gZWxzZSBpZiAobWVzc2FnZS5oYXNPd25Qcm9wZXJ0eSgnYm9keScpICYmIG1lc3NhZ2UuYm9keS5oYXNPd25Qcm9wZXJ0eSgnc3Vic2NyaWJlcicpICYmIG1lc3NhZ2UuYm9keS5zdWJzY3JpYmVyKSB7XHJcbiAgICAgIC8vVE9ETzogdGhpcyBzdWJzY3JpYmVyIHZhbGlkYXRpb24gc2hvdWxkIG5vdCBleGlzdCwgYmVjYXVzZSBpcyBvdXRkYXRlZFxyXG4gICAgICAvL1RPRE86IHRoZSBzeW5jaGVyIGFuZCBzeW5jaGVyIG1hbmFnZXIgbm90IGZvbGxvd2luZyB0aGUgY29ycmVjdCBzcGVjO1xyXG4gICAgICBsb2cuaW5mbygnW01lc3NhZ2VCdXMgLSBpc0luY29taW5nTWVzc2FnZV0gLSBtZXNzYWdlLmJvZHkuc3Vic2NyaWJlcjogJywgbWVzc2FnZS5ib2R5LnN1YnNjcmliZXIpO1xyXG4gICAgICBmcm9tID0gbWVzc2FnZS5ib2R5LnN1YnNjcmliZXI7XHJcbiAgICB9ICBlbHNlIGlmIChtZXNzYWdlLmhhc093blByb3BlcnR5KCdib2R5JykgJiYgbWVzc2FnZS5ib2R5Lmhhc093blByb3BlcnR5KCdyZXBvcnRlcicpICYmIG1lc3NhZ2UuYm9keS5yZXBvcnRlcikge1xyXG4gICAgICAvL1RPRE86IHRoaXMgc3Vic2NyaWJlciB2YWxpZGF0aW9uIHNob3VsZCBub3QgZXhpc3QsIGJlY2F1c2UgaXMgb3V0ZGF0ZWRcclxuICAgICAgLy9UT0RPOiB0aGUgc3luY2hlciBhbmQgc3luY2hlciBtYW5hZ2VyIG5vdCBmb2xsb3dpbmcgdGhlIGNvcnJlY3Qgc3BlYztcclxuICAgICAgbG9nLmluZm8oJ1tNZXNzYWdlQnVzIC0gaXNJbmNvbWluZ01lc3NhZ2VdIC0gbWVzc2FnZS5ib2R5LnJlcG9ydGVyOiAnLCBtZXNzYWdlLmJvZHkucmVwb3J0ZXIpO1xyXG4gICAgICBmcm9tID0gbWVzc2FnZS5ib2R5LnJlcG9ydGVyO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbG9nLmluZm8oJ1tNZXNzYWdlQnVzIC0gaXNJbmNvbWluZ01lc3NhZ2VdIC0gbWVzc2FnZS5mcm9tICcsIG1lc3NhZ2UuZnJvbSk7XHJcbiAgICAgIGZyb20gPSBtZXNzYWdlLmZyb207XHJcbiAgICB9XHJcblxyXG4gICAgbG9nLmluZm8oJ1tNZXNzYWdlQnVzIC0gaXNJbmNvbWluZ01lc3NhZ2VdIC0gY2hlY2sgaWYgaXNMb2NhbDogJywgZnJvbSk7XHJcbiAgICByZXR1cm4gIXRoaXMuX3JlZ2lzdHJ5LmlzTG9jYWwoZnJvbSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkcyBhbiBleHRlcm5hbCBwdWJsaXNoIGFkZHJlc3MgbGlzdGVuZXIuIEV2ZXJ5IG1lc3NhZ2UgZm9yIHRoZSBhZGRyZXNzIHdpbGwgYmUgZm9yd2FyZGVkIHRvIHRoZSBleHRlcm5hbCByb3V0aW5nIGJ5IF9vblBvc3RNZXNzYWdlLlxyXG4gICAqIFRoaXMgbWVhbnMsIGV2ZW4gaWYgdGhlcmUgaXMgYSBsaXN0ZW5lciBmb3IgdGhlIGFkZHJlc3MsIGl0IHdpbGwgYWxzbyBzZW5kIHRoZSBtZXNzYWdlIHRvIHRoZSBleHRlcm5hbCByb3V0aW5nLlxyXG4gICAqIEBwYXJhbSB7VVJMfSBmcm9tIFB1Ymxpc2ggYWRkcmVzcy5cclxuICAgKi9cclxuICBhZGRQdWJsaXNoKGZyb20pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy92ZXJpZnkgaWYgZm9yd2FyZCBleGlzdFxyXG4gICAgbGV0IHJlZkNvdW50ID0gX3RoaXMuX2ZvcndhcmRzW2Zyb21dO1xyXG4gICAgaWYgKCFyZWZDb3VudCkge1xyXG4gICAgICBsZXQgZm9yd2FyZExpc3RlbmVyID0gX3RoaXMuYWRkTGlzdGVuZXIoZnJvbSwgKG1zZykgPT4ge1xyXG4gICAgICAgIGxvZy5pbmZvKCdNQi1QVUJMSVNIOiAoICcgKyBmcm9tICsgJyApJyk7XHJcbiAgICAgICAgX3RoaXMuX29uUG9zdE1lc3NhZ2UobXNnKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZWZDb3VudCA9IHtcclxuICAgICAgICBjb3VudGVyOiAwLFxyXG4gICAgICAgIGZsOiBmb3J3YXJkTGlzdGVuZXIsXHJcbiAgICAgICAgcmVtb3ZlOiAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmNvdW50ZXItLTtcclxuICAgICAgICAgIGlmICh0aGlzLmNvdW50ZXIgPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5mbC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgZGVsZXRlIF90aGlzLl9mb3J3YXJkc1tmcm9tXTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgIF90aGlzLl9mb3J3YXJkc1tmcm9tXSA9IHJlZkNvdW50O1xyXG4gICB9XHJcblxyXG4gICByZWZDb3VudC5jb3VudGVyKys7XHJcbiAgIHJldHVybiByZWZDb3VudDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBmb3J3YXJkIGxpc3RlbmVyIGZvciBhIG1lc3NhZ2UgZGVzdGluYXRpb24uIEV2ZXJ5IG1lc3NhZ2UgcmVhY2hpbmcgYW4gYWRkcmVzcyB3aWxsIGJlIGFsc28gc2VudCB0byB0aGUgZm9yd2FyZCBhZGRyZXNzLlxyXG4gICAqIEBwYXJhbSB7VVJMfSBmcm9tIE1lc3NhZ2UgZGVzdGluYXRpb24sIGl0J3MgYWN0dWFsbHkgdGhlIGZpZWxkIFwidG9cIiBvZiB0aGUgbWVzc2FnZS5cclxuICAgKiBAcGFyYW0ge1VSTH0gdG8gICBGb3J3YXJkIGFkZHJlc3MuXHJcbiAgICovXHJcbiAgIGFkZEZvcndhcmQoZnJvbSwgdG8pIHtcclxuICAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgICByZXR1cm4gX3RoaXMuYWRkTGlzdGVuZXIoZnJvbSwgKG1zZykgPT4ge1xyXG4gICAgICAgbG9nLmluZm8oJ01CLUZPUldBUkQ6ICggJyArIGZyb20gKyAnIHRvICcgKyB0byArICcgKScpO1xyXG4gICAgICAgX3RoaXMuZm9yd2FyZCh0bywgbXNnKTtcclxuICAgICB9KTtcclxuICAgfVxyXG5cclxuICAgLyoqXHJcbiAgICAqIEp1c3QgZm9yd2FyZCdzIGEgbWVzc2FnZSB0byB0aGUgZm9yd2FyZCBhZGRyZXNzLiBMaXN0ZW5lcnMgc2hvdWxkIGJlIGF2YWlsYWJsZSBmb3IgdGhlIGZvcndhcmQgYWRkcmVzcy5cclxuICAgICogQHBhcmFtICB7VVJMfSB1cmwgRm9yd2FyZCBhZGRyZXNzLlxyXG4gICAgKiBAcGFyYW0gIHtNZXNzYWdlfSBtc2cgTWVzc2FnZSB0byBmb3J3YXJkXHJcbiAgICAqL1xyXG4gICBmb3J3YXJkKHVybCwgbXNnKSB7XHJcbiAgICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAgbGV0IGl0ZW1MaXN0ID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbdXJsXTtcclxuICAgICBpZiAoaXRlbUxpc3QpIHtcclxuICAgICAgIF90aGlzLl9wdWJsaXNoT24oaXRlbUxpc3QsIG1zZyk7XHJcbiAgICAgfVxyXG4gICB9XHJcblxyXG4gICAvL2RlZmF1bHQgcm91dGUsIGlmIHRoZXJlIGFyZSBubyBsaXN0ZW5lcnMgYXZhaWxhYmxlIGZvciBhIG1lc3NhZ2UgZGVzdGluYXRpb24uXHJcbiAgIF9vblBvc3RNZXNzYWdlKG1zZykge1xyXG4gICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgIC8vcmVzb2x2ZSBleHRlcm5hbCBwcm90b3N0dWIuLi5cclxuICAgICBfdGhpcy5fcmVnaXN0cnkucmVzb2x2ZShtc2cpLnRoZW4oKHJvdXRlLCBtc2cycm91dGUpID0+IHtcclxuICAgICAgIGlmIChtc2cycm91dGUpIF90aGlzLmZvcndhcmQocm91dGUsIG1zZzJyb3V0ZSk7XHJcbiAgICAgICBlbHNlIF90aGlzLmZvcndhcmQocm91dGUsIG1zZyk7XHJcbiAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSkge1xyXG4gICAgICAgbG9nLmVycm9yKCdSRVNPTFZFLUVSUk9SOiAnLCBlKTtcclxuICAgICB9KTtcclxuICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBNZXNzYWdlQnVzO1xyXG4iLCIvLyBNYXJzaGFscyBhIHN0cmluZyB0byBVaW50OEFycmF5LlxyXG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlVVRGOChzKSB7XHJcblx0dmFyIGkgPSAwO1xyXG5cdHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KHMubGVuZ3RoICogNCk7XHJcblx0Zm9yICh2YXIgY2kgPSAwOyBjaSAhPSBzLmxlbmd0aDsgY2krKykge1xyXG4gICAgdHJ5e1xyXG4gICAgICB2YXIgeHh4ID0gcy5jaGFyQ29kZUF0KGNpKTtcclxuICAgIH0gY2F0Y2ggKGVycil7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTtcclxuICAgICAgcmV0dXJuO1xyXG5cclxuICAgIH1cclxuXHRcdHZhciBjID0gcy5jaGFyQ29kZUF0KGNpKTtcclxuXHRcdGlmIChjIDwgMTI4KSB7XHJcblx0XHRcdGJ5dGVzW2krK10gPSBjO1xyXG5cdFx0XHRjb250aW51ZTtcclxuXHRcdH1cclxuXHRcdGlmIChjIDwgMjA0OCkge1xyXG5cdFx0XHRieXRlc1tpKytdID0gYyA+PiA2IHwgMTkyO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aWYgKGMgPiAweGQ3ZmYgJiYgYyA8IDB4ZGMwMCkge1xyXG5cdFx0XHRcdGlmICgrK2NpID09IHMubGVuZ3RoKSB0aHJvdyAnVVRGLTggZW5jb2RlOiBpbmNvbXBsZXRlIHN1cnJvZ2F0ZSBwYWlyJztcclxuXHRcdFx0XHR2YXIgYzIgPSBzLmNoYXJDb2RlQXQoY2kpO1xyXG5cdFx0XHRcdGlmIChjMiA8IDB4ZGMwMCB8fCBjMiA+IDB4ZGZmZikgdGhyb3cgJ1VURi04IGVuY29kZTogc2Vjb25kIGNoYXIgY29kZSAweCcgKyBjMi50b1N0cmluZygxNikgKyAnIGF0IGluZGV4ICcgKyBjaSArICcgaW4gc3Vycm9nYXRlIHBhaXIgb3V0IG9mIHJhbmdlJztcclxuXHRcdFx0XHRjID0gMHgxMDAwMCArICgoYyAmIDB4MDNmZikgPDwgMTApICsgKGMyICYgMHgwM2ZmKTtcclxuXHRcdFx0XHRieXRlc1tpKytdID0gYyA+PiAxOCB8IDI0MDtcclxuXHRcdFx0XHRieXRlc1tpKytdID0gYz4+IDEyICYgNjMgfCAxMjg7XHJcblx0XHRcdH0gZWxzZSB7IC8vIGMgPD0gMHhmZmZmXHJcblx0XHRcdFx0Ynl0ZXNbaSsrXSA9IGMgPj4gMTIgfCAyMjQ7XHJcblx0XHRcdH1cclxuXHRcdFx0Ynl0ZXNbaSsrXSA9IGMgPj4gNiAmIDYzIHwgMTI4O1xyXG5cdFx0fVxyXG5cdFx0Ynl0ZXNbaSsrXSA9IGMgJiA2MyB8IDEyODtcclxuXHR9XHJcblx0cmV0dXJuIGJ5dGVzLnN1YmFycmF5KDAsIGkpO1xyXG59XHJcblxyXG4vLyBVbm1hcnNoYWxzIGFuIFVpbnQ4QXJyYXkgdG8gc3RyaW5nLlxyXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlVVRGOChieXRlcykge1xyXG5cdHZhciBzID0gJyc7XHJcblx0dmFyIGkgPSAwO1xyXG5cdHdoaWxlIChpIDwgYnl0ZXMubGVuZ3RoKSB7XHJcblx0XHR2YXIgYyA9IGJ5dGVzW2krK107XHJcblx0XHRpZiAoYyA+IDEyNykge1xyXG5cdFx0XHRpZiAoYyA+IDE5MSAmJiBjIDwgMjI0KSB7XHJcblx0XHRcdFx0aWYgKGkgPj0gYnl0ZXMubGVuZ3RoKSB0aHJvdyAnVVRGLTggZGVjb2RlOiBpbmNvbXBsZXRlIDItYnl0ZSBzZXF1ZW5jZSc7XHJcblx0XHRcdFx0YyA9IChjICYgMzEpIDw8IDYgfCBieXRlc1tpXSAmIDYzO1xyXG5cdFx0XHR9IGVsc2UgaWYgKGMgPiAyMjMgJiYgYyA8IDI0MCkge1xyXG5cdFx0XHRcdGlmIChpICsgMSA+PSBieXRlcy5sZW5ndGgpIHRocm93ICdVVEYtOCBkZWNvZGU6IGluY29tcGxldGUgMy1ieXRlIHNlcXVlbmNlJztcclxuXHRcdFx0XHRjID0gKGMgJiAxNSkgPDwgMTIgfCAoYnl0ZXNbaV0gJiA2MykgPDwgNiB8IGJ5dGVzWysraV0gJiA2MztcclxuXHRcdFx0fSBlbHNlIGlmIChjID4gMjM5ICYmIGMgPCAyNDgpIHtcclxuXHRcdFx0XHRpZiAoaSsyID49IGJ5dGVzLmxlbmd0aCkgdGhyb3cgJ1VURi04IGRlY29kZTogaW5jb21wbGV0ZSA0LWJ5dGUgc2VxdWVuY2UnO1xyXG5cdFx0XHRcdGMgPSAoYyAmIDcpIDw8IDE4IHwgKGJ5dGVzW2ldICYgNjMpIDw8IDEyIHwgKGJ5dGVzWysraV0gJiA2MykgPDwgNiB8IGJ5dGVzWysraV0gJiA2MztcclxuXHRcdFx0fSBlbHNlIHRocm93ICdVVEYtOCBkZWNvZGU6IHVua25vd24gbXVsdGlieXRlIHN0YXJ0IDB4JyArIGMudG9TdHJpbmcoMTYpICsgJyBhdCBpbmRleCAnICsgKGkgLSAxKTtcclxuXHRcdFx0KytpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChjIDw9IDB4ZmZmZikgcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpO1xyXG5cdFx0ZWxzZSBpZiAoYyA8PSAweDEwZmZmZikge1xyXG5cdFx0XHRjIC09IDB4MTAwMDA7XHJcblx0XHRcdHMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjID4+IDEwIHwgMHhkODAwKVxyXG5cdFx0XHRzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYyAmIDB4M0ZGIHwgMHhkYzAwKVxyXG5cdFx0fSBlbHNlIHRocm93ICdVVEYtOCBkZWNvZGU6IGNvZGUgcG9pbnQgMHgnICsgYy50b1N0cmluZygxNikgKyAnIGV4Y2VlZHMgVVRGLTE2IHJlYWNoJztcclxuXHR9XHJcblx0cmV0dXJuIHM7XHJcbn1cclxuIiwiaW1wb3J0IHtlbmNvZGVVVEY4LCBkZWNvZGVVVEY4fSBmcm9tICcuL3V0ZjguanMnO1xyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignQ3J5cHRvTWFuYWdlcicpO1xyXG5cclxuLyoqXHJcbiogQ2xhc3Mgd2l0aCB0aGUgY3J5cHRvZ3JhcGhpYyBmdW5jdGlvbnMgZm9yIHRoZSBhdXRoZW50aWNhdGlvbiBwcm90b2NvbFxyXG4qXHJcbiovXHJcbmNsYXNzIENyeXB0byB7XHJcblxyXG4vKipcclxuKiBSdW50aW1lZmFjdG9yeSBpcyBwYXNzZWQgaW4gdGhlIGNvc3RydWN0b3IsIGJlY2F1c2UgdGhlIG5vZGVKUyBoYXMgYSBkaWZmZXJlbnQgY3J5cHRvIG1vZHVsZVxyXG4qIGZyb20gdGhlIGJyb3dzZXIuIFJ1bnRpbWVGYWN0b3J5IHByb3ZpZGVzIGEgd3JhcHBlciBmb3IgdGhlIGZ1Y3Rpb25zIG9mIG5vZGVKUywgc28gdGhleSBjYW4gYmVcclxuKiBpbnZva2VkIGJyb3dzZXIgbGlrZS5cclxuKi9cclxuICBjb25zdHJ1Y3RvcihydW50aW1lRmFjdG9yeSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHR5cGVvZiBydW50aW1lRmFjdG9yeS5jcmVhdGVXZWJjcnlwdG8gPT09ICdmdW5jdGlvbicgPyBfdGhpcy5fY3J5cHRvID0gcnVudGltZUZhY3RvcnkuY3JlYXRlV2ViY3J5cHRvKCkgOiBfdGhpcy5fY3J5cHRvID0gY3J5cHRvO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBQZXJmb3JtcyBhIFJTQSBlbmNyeXB0aW9uXHJcbiAgKiBAcGFyYW0gICB7QXJyYXlCdWZmZXJ9ICAgIHZhbHVlICAgIHRoZSBwdWJsaWMga2V5XHJcbiAgKiBAcGFyYW0gICB7QnVmZmVyU291cmNlfSAgICB2YWx1ZSAgICBkYXRhIHRvIGJlIGVuY3J5cGVkXHJcbiAgKiBAcmV0dXJuICB7VWludDhBcnJheX0gICBlbmNyeXB0ZWQgZGF0YVxyXG4gICovXHJcbiAgZW5jcnlwdFJTQShwdWJLZXksIGRhdGEpIHtcclxuICAgIGxvZy5sb2coJ2VuY3J5cHRSU0E6cHViS2V5JywgcHViS2V5KTtcclxuICAgIGxvZy5sb2coJ2VuY3J5cHRSU0E6ZGF0YScsIGRhdGEpO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBfdGhpcy5faW1wb3J0UlNBZW5jcnlwdEtleShuZXcgVWludDhBcnJheShwdWJLZXkpKS50aGVuKGZ1bmN0aW9uKHB1YmxpY0tleSkge1xyXG5cclxuICAgICAgICBfdGhpcy5fY3J5cHRvLnN1YnRsZS5lbmNyeXB0KFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiAnUlNBLU9BRVAnXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcHVibGljS2V5LCAvL2Zyb20gZ2VuZXJhdGVLZXkgb3IgaW1wb3J0S2V5IGFib3ZlXHJcbiAgICAgICAgICBkYXRhIC8vQXJyYXlCdWZmZXIgb2YgZGF0YSB5b3Ugd2FudCB0byBlbmNyeXB0XHJcbiAgICAgICAgKVxyXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW5jcnlwdGVkKSB7XHJcbiAgICAgICAgICAvL3JldHVybnMgYW4gQXJyYXlCdWZmZXIgY29udGFpbmluZyB0aGUgZW5jcnlwdGVkIGRhdGFcclxuICAgICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1lbmNyeXB0UlNBJywgbmV3IFVpbnQ4QXJyYXkoZW5jcnlwdGVkKSk7XHJcbiAgICAgICAgICAgIHJlc29sdmUobmV3IFVpbnQ4QXJyYXkoZW5jcnlwdGVkKSk7XHJcblxyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAvLyBsb2cubG9nKCdjcnlwdG8tZW5jcnlwdFJTQScsIGVycik7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFBlcmZvcm1zIGEgUlNBIGRlY3J5cHRpb25cclxuICAqIEBwYXJhbSAgIHtBcnJheUJ1ZmZlcn0gICAgdmFsdWUgICAgdGhlIHByaXZhdGUga2V5XHJcbiAgKiBAcGFyYW0gICB7QnVmZmVyU291cmNlfSAgICB2YWx1ZSAgICBkYXRhIHRvIGJlIGRlY3J5cHRlZFxyXG4gICogQHJldHVybiAge1VpbnQ4QXJyYXl9ICAgZGVjcnlwdGVkIGRhdGFcclxuICAqL1xyXG4gIGRlY3J5cHRSU0EocHJpdktleSwgZGF0YSkge1xyXG4gICAgbG9nLmxvZygnZGVjcnlwdFJTQTpwcml2S2V5JywgcHJpdktleSk7XHJcbiAgICBsb2cubG9nKCdkZWNyeXB0UlNBOmRhdGEnLCBkYXRhKTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBfdGhpcy5faW1wb3J0UlNBZGVjcnlwdEtleShwcml2S2V5KS50aGVuKGZ1bmN0aW9uKHByaXZhdGVLZXkpIHtcclxuXHJcbiAgICAgICAgX3RoaXMuX2NyeXB0by5zdWJ0bGUuZGVjcnlwdChcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgbmFtZTogJ1JTQS1PQUVQJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHByaXZhdGVLZXksIC8vZnJvbSBnZW5lcmF0ZUtleSBvciBpbXBvcnRLZXkgYWJvdmVcclxuICAgICAgICAgIGRhdGEgLy9BcnJheUJ1ZmZlciBvZiB0aGUgZGF0YVxyXG4gICAgICAgIClcclxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRlY3J5cHRlZCkge1xyXG5cclxuICAgICAgICAgICAgbGV0IGRlY3J5cHRlZERhdGEgPSBuZXcgVWludDhBcnJheShkZWNyeXB0ZWQpO1xyXG5cclxuICAgICAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLWRlY3J5cHRSU0EnLCBkZWNyeXB0ZWREYXRhKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShkZWNyeXB0ZWREYXRhKTtcclxuXHJcbiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1kZWNyeXB0UlNBJywgZXJyKTtcclxuICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFBlcmZvcm1zIGEgUlNBIHNpZ25cclxuICAqIEBwYXJhbSAgIHtBcnJheUJ1ZmZlcn0gICAgdmFsdWUgICAgdGhlIHByaXZhdGUga2V5XHJcbiAgKiBAcGFyYW0gICB7QnVmZmVyU291cmNlfSAgICB2YWx1ZSAgICBkYXRhIHRvIGJlIHNpZ25lZFxyXG4gICogQHJldHVybiAge1VpbnQ4QXJyYXl9ICAgZGF0YSBzaWduYXR1cmVcclxuICAqL1xyXG4gIHNpZ25SU0EocHJpdktleSwgZGF0YSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIF90aGlzLl9pbXBvcnRSU0FzaWduS2V5KHByaXZLZXkpLnRoZW4oZnVuY3Rpb24ocHJpdmF0ZUtleSkge1xyXG5cclxuICAgICAgICBfdGhpcy5fY3J5cHRvLnN1YnRsZS5zaWduKFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiAnUlNBU1NBLVBLQ1MxLXYxXzUnXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcHJpdmF0ZUtleSwgLy9mcm9tIGdlbmVyYXRlS2V5IG9yIGltcG9ydEtleSBhYm92ZVxyXG4gICAgICAgICAgZW5jb2RlVVRGOChkYXRhKSAvL0FycmF5QnVmZmVyIG9mIGRhdGEgeW91IHdhbnQgdG8gc2lnblxyXG4gICAgICAgIClcclxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHNpZ25hdHVyZSkge1xyXG4gICAgICAgICAgLy9yZXR1cm5zIGFuIEFycmF5QnVmZmVyIGNvbnRhaW5pbmcgdGhlIHNpZ25hdHVyZVxyXG4gICAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLXNpZ25SU0EnLCBuZXcgVWludDhBcnJheShzaWduYXR1cmUpKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShuZXcgVWludDhBcnJheShzaWduYXR1cmUpKTtcclxuXHJcbiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1zaWduUlNBJywgZXJyKTtcclxuICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBQZXJmb3JtcyBhIFJTQSBzaWduYXR1cmUgdmVyaWZpY2F0aW9uXHJcbiAgKiBAcGFyYW0gICB7QXJyYXlCdWZmZXJ9ICAgIHZhbHVlICAgIHRoZSBwdWJsaWMga2V5XHJcbiAgKiBAcGFyYW0gICB7QnVmZmVyU291cmNlfSAgICB2YWx1ZSAgICBkYXRhIHRvIGJlIHZlcmlmaWVkXHJcbiAgKiBAcmV0dXJuICB7Qm9vbGVhbn0gICByZXN1bHQgb2YgdGhlIHNpZ25hdHVyZSB2ZXJpZmljYXRpb25cclxuICAqL1xyXG4gIHZlcmlmeVJTQShwdWJLZXksIGRhdGEsIHNpZ25hdHVyZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIF90aGlzLl9pbXBvcnRSU0F2ZXJpZnlLZXkocHViS2V5KS50aGVuKGZ1bmN0aW9uKHB1YmxpY0tleSkge1xyXG5cclxuICAgICAgICBfdGhpcy5fY3J5cHRvLnN1YnRsZS52ZXJpZnkoXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIG5hbWU6ICdSU0FTU0EtUEtDUzEtdjFfNSdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBwdWJsaWNLZXksIC8vZnJvbSBnZW5lcmF0ZUtleSBvciBpbXBvcnRLZXkgYWJvdmVcclxuICAgICAgICAgIHNpZ25hdHVyZSwgLy9BcnJheUJ1ZmZlciBvZiB0aGUgc2lnbmF0dXJlXHJcbiAgICAgICAgICBlbmNvZGVVVEY4KGRhdGEpIC8vQXJyYXlCdWZmZXIgb2YgdGhlIGRhdGFcclxuICAgICAgICApXHJcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAvL3JldHVybnMgYSBib29sZWFuIG9uIHdoZXRoZXIgdGhlIHNpZ25hdHVyZSBpcyB0cnVlIG9yIG5vdFxyXG4gICAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLXZlcmlmeVJTQScsIGlzdmFsaWQpO1xyXG4gICAgICAgICAgICByZXNvbHZlKGlzdmFsaWQpO1xyXG5cclxuICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLXZlcmlmeVJTQScsIGVycik7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogUGVyZm9ybXMgYSBSU0Egc2lnbmF0dXJlIHZlcmlmaWNhdGlvblxyXG4gICogQHBhcmFtICAge0FycmF5QnVmZmVyfSAgICB2YWx1ZSAgICB0aGUgcHVibGljIGtleVxyXG4gICogQHBhcmFtICAge0J1ZmZlclNvdXJjZX0gICAgdmFsdWUgICAgZGF0YSB0byBiZSB2ZXJpZmllZFxyXG4gICogQHJldHVybiAge0Jvb2xlYW59ICAgcmVzdWx0IG9mIHRoZSBzaWduYXR1cmUgdmVyaWZpY2F0aW9uXHJcbiAgKi9cclxuICBlbmNyeXB0QUVTKGtleSwgZGF0YSwgaXYpIHtcclxuICAgIGxvZy5sb2coJ2VuY3J5cHRBRVM6a2V5Jywga2V5KTtcclxuICAgIGxvZy5sb2coJ2VuY3J5cHRBRVM6ZGF0YScsIGRhdGEpO1xyXG4gICAgbG9nLmxvZygnZW5jcnlwdEFFUzppdicsIGl2KTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBfdGhpcy5faW1wb3J0QUVTa2V5KGtleSkudGhlbihmdW5jdGlvbihhZXNLZXkpIHtcclxuXHJcbiAgICAgICAgX3RoaXMuX2NyeXB0by5zdWJ0bGUuZW5jcnlwdChcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgbmFtZTogJ0FFUy1DQkMnLFxyXG5cclxuICAgICAgICAgICAgLy9Eb24ndCByZS11c2UgaW5pdGlhbGl6YXRpb24gdmVjdG9ycyFcclxuICAgICAgICAgICAgLy9BbHdheXMgZ2VuZXJhdGUgYSBuZXcgaXYgZXZlcnkgdGltZSB5b3VyIGVuY3J5cHQhXHJcbiAgICAgICAgICAgIGl2OiBpdlxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGFlc0tleSwgLy9mcm9tIGdlbmVyYXRlS2V5IG9yIGltcG9ydEtleSBhYm92ZVxyXG4gICAgICAgICAgZW5jb2RlVVRGOChkYXRhKSAvL0FycmF5QnVmZmVyIG9mIGRhdGEgeW91IHdhbnQgdG8gZW5jcnlwdFxyXG4gICAgICAgIClcclxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGVuY3J5cHRlZCkge1xyXG4gICAgICAgICAgLy9yZXR1cm5zIGFuIEFycmF5QnVmZmVyIGNvbnRhaW5pbmcgdGhlIGVuY3J5cHRlZCBkYXRhXHJcbiAgICAgICAgICAvLyBsb2cubG9nKCdjcnlwdG8tZW5jcnlwdEFFUycsIG5ldyBVaW50OEFycmF5KGVuY3J5cHRlZCkpO1xyXG4gICAgICAgICAgICByZXNvbHZlKG5ldyBVaW50OEFycmF5KGVuY3J5cHRlZCkpO1xyXG5cclxuICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLWVuY3J5cHRBRVMnLCBlcnIpO1xyXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWNyeXB0QUVTKGtleSwgZGF0YSwgaXYpIHtcclxuICAgIGxvZy5sb2coJ2RlY3J5cHRBRVM6a2V5Jywga2V5KTtcclxuICAgIGxvZy5sb2coJ2RlY3J5cHRBRVM6ZGF0YScsIGRhdGEpO1xyXG4gICAgbG9nLmxvZygnZGVjcnlwdEFFUzppdicsIGl2KTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBfdGhpcy5faW1wb3J0QUVTa2V5KGtleSkudGhlbihmdW5jdGlvbihhZXNLZXkpIHtcclxuXHJcbiAgICAgICAgX3RoaXMuX2NyeXB0by5zdWJ0bGUuZGVjcnlwdChcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgbmFtZTogJ0FFUy1DQkMnLFxyXG4gICAgICAgICAgICBpdjogaXZcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBhZXNLZXksIC8vZnJvbSBnZW5lcmF0ZUtleSBvciBpbXBvcnRLZXkgYWJvdmVcclxuICAgICAgICAgIGRhdGEgLy9BcnJheUJ1ZmZlciBvZiB0aGUgZGF0YVxyXG4gICAgICAgIClcclxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRlY3J5cHRlZCkge1xyXG5cclxuICAgICAgICAgICAgbGV0IGRlY29kZWREYXRhID0gZGVjb2RlVVRGOChuZXcgVWludDhBcnJheShkZWNyeXB0ZWQpKTtcclxuICAgICAgICAgICAgbG9nLmxvZygnY3J5cHRvLWRlY3J5cHRBRVMnLCBkZWNvZGVkRGF0YSk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoZGVjb2RlZERhdGEpO1xyXG5cclxuICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLWRlY3J5cHRBRVMnLCBlcnIpO1xyXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGNyZWF0ZXMgYSBoYXNoIHVzaW5nIHRoZSBITUFDIGFsZ29yaXRobVxyXG4gICogQHBhcmFtICB7Ynl0ZUFycmF5fSAgICBrZXkgICAgICAga2V5IHRvIGJlIHVzZWQgaW4gdGhlIGhtYWNcclxuICAqIEBwYXJhbSAge3N0cmluZ30gICAgICBkYXRhICAgICAgIGluZm9ybWF0aW9uIHRvIGJlIGhhc2hlZFxyXG4gICogQHJldHVybiAge2J5dGVBcnJheX0gICBzaWduYXR1cmUgIHJlc3VsdGluZyBoYXNoXHJcbiAgKi9cclxuICBoYXNoSE1BQyhrZXksIGRhdGEpIHtcclxuICAgIGxvZy5sb2coJ2hhc2hITUFDOmtleScsIGtleSk7XHJcbiAgICBsb2cubG9nKCdoYXNoSE1BQzpkYXRhJywgZGF0YSk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGlmICh0eXBlb2YgZGF0YSAhPSAnc3RyaW5nJykge1xyXG4gICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuICAgICAgICBsb2cubG9nKCdDb252ZXJ0aW5nIGhhc2hITUFDIGlucHVyZWQgREFUQScpO1xyXG4gICAgICAgIGxvZy5sb2coJ0hIYXNoSE1BQzonLCBkYXRhKTtcclxuICAgICAgfVxyXG5cclxuXHJcbiAgICAgIF90aGlzLl9pbXBvcnRITUFDa2V5KGtleSkudGhlbihmdW5jdGlvbihobWFjS2V5KSB7XHJcblxyXG4gICAgICAgIF90aGlzLl9jcnlwdG8uc3VidGxlLnNpZ24oXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIG5hbWU6ICdITUFDJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGhtYWNLZXksIC8vZnJvbSBnZW5lcmF0ZUtleSBvciBpbXBvcnRLZXkgYWJvdmVcclxuICAgICAgICAgIGVuY29kZVVURjgoZGF0YSkgLy9BcnJheUJ1ZmZlciBvZiBkYXRhIHlvdSB3YW50IHRvIHNpZ25cclxuICAgICAgICApXHJcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihzaWduYXR1cmUpIHtcclxuICAgICAgICAgICAgbG9nLmxvZygnSGFzaEhNQUMgc2lnbmF0dXJlOicsIG5ldyBVaW50OEFycmF5KHNpZ25hdHVyZSkpO1xyXG5cclxuICAgICAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLWhhc2hITUFDJywgc2lnbmF0dXJlKTtcclxuICAgICAgICAgICAgLy9yZXR1cm5zIGFuIEFycmF5QnVmZmVyIGNvbnRhaW5pbmcgdGhlIHNpZ25hdHVyZVxyXG4gICAgICAgICAgICByZXNvbHZlKG5ldyBVaW50OEFycmF5KHNpZ25hdHVyZSkpO1xyXG5cclxuICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAvLyBsb2cubG9nKCdjcnlwdG8taGFzaEhNQUMnLCBlcnIpO1xyXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiB2ZXJpZmllcyBhbiBoYXNoIHVzaW5nIHRoZSBITUFDIGFsZ29yaXRobVxyXG4gICogQHBhcmFtICB7Ynl0ZUFycmF5fSAgICBrZXkgICAgICAga2V5IHRvIGJlIHVzZWQgaW4gdGhlIGhtYWNcclxuICAqIEBwYXJhbSAge3N0cmluZ30gICAgICBkYXRhICAgICAgIGluZm9ybWF0aW9uIHRvIGJlIGhhc2hlZCB0byBjb21wYXJlXHJcbiAgKiBAcGFyYW0gIHtieXRlQXJyYXl9ICBzaWduYXR1cmUgICBoYXNoIHRvIGNvbXBhcmUgd2l0aCB0aGUgcmVjZWl2ZWQgZGF0YVxyXG4gICogQHJldHVybiAge2Jvb2xlYW59ICAgaXN2YWxpZCAgICAgYm9vbGVhbiBzYXlpbmcgaWYgdGhlIGRhdGEgY29ycmVzcG9uZHMgdG8gdGhlIGhhc2ggcmVjZWl2ZWRcclxuICAqL1xyXG4gIHZlcmlmeUhNQUMoa2V5LCBkYXRhLCBzaWduYXR1cmUpIHtcclxuICAgIGxvZy5sb2coJ3ZlcmlmeUhNQUM6a2V5Jywga2V5KTtcclxuICAgIGxvZy5sb2coJ3ZlcmlmeUhNQUM6ZGF0YScsIGRhdGEpO1xyXG4gICAgbG9nLmxvZygndmVyaWZ5SE1BQzpzaWduYXR1cmUnLCBzaWduYXR1cmUpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBfdGhpcy5faW1wb3J0SE1BQ2tleShrZXkpLnRoZW4oZnVuY3Rpb24oaG1hY0tleSkge1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIGRhdGEgIT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuICAgICAgICAgIGxvZy5sb2coJ0NvbnZlcnRpbmcgdmVyaWZ5SE1BQyBpbnB1dGVkIERBVEE6JywgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfdGhpcy5fY3J5cHRvLnN1YnRsZS52ZXJpZnkoXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIG5hbWU6ICdITUFDJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGhtYWNLZXksIC8vZnJvbSBnZW5lcmF0ZUtleSBvciBpbXBvcnRLZXkgYWJvdmVcclxuICAgICAgICAgIHNpZ25hdHVyZSwgLy9BcnJheUJ1ZmZlciBvZiB0aGUgc2lnbmF0dXJlXHJcbiAgICAgICAgICBlbmNvZGVVVEY4KGRhdGEpIC8vQXJyYXlCdWZmZXIgb2YgdGhlIGRhdGFcclxuICAgICAgICApXHJcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihpc3ZhbGlkKSB7XHJcbiAgICAgICAgICAvL3JldHVybnMgYSBib29sZWFuIG9uIHdoZXRoZXIgdGhlIHNpZ25hdHVyZSBpcyB0cnVlIG9yIG5vdFxyXG4gICAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLXZlcmlmeUhNQUMnLCBpc3ZhbGlkKTtcclxuICAgICAgICAgICAgbG9nLmxvZygndmVyaWZ5SE1BQyByZXN1bHQnLCBpc3ZhbGlkKTtcclxuICAgICAgICAgICAgKGlzdmFsaWQpID8gcmVzb2x2ZShpc3ZhbGlkKSA6IHJlamVjdChpc3ZhbGlkKTtcclxuXHJcbiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgbG9nLmVycm9yKCdjcnlwdG8tdmVyaWZ5SE1BQycsIGVycik7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGdlbmVyYXRlcyBhIFJTQSBwdWJsaWMvcHJpdmF0ZSBrZXkgcGFpciB3aXRoIGEgbW9kdWx1cyBsZW5ndGggb2YgMjA0OCBiaXRzXHJcbiAgKiBAcmV0dXJuICB7SlNPTn0gICBrZXlQYWlyICAgIGpzb24gY29udGFpbmluZyB0aGUgcHVibGljIGFuZCBwcml2YXRlIGtleXNcclxuICAqL1xyXG4gIGdlbmVyYXRlUlNBS2V5UGFpcigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQga2V5UGFpciA9IHt9O1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgX3RoaXMuX2NyeXB0by5zdWJ0bGUuZ2VuZXJhdGVLZXkoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgbmFtZTogJ1JTQS1QU1MnLFxyXG4gICAgICAgICAgbW9kdWx1c0xlbmd0aDogMjA0OCwgLy9jYW4gYmUgMTAyNCwgMjA0OCwgb3IgNDA5NlxyXG4gICAgICAgICAgcHVibGljRXhwb25lbnQ6IG5ldyBVaW50OEFycmF5KFsweDAxLCAweDAwLCAweDAxXSksXHJcbiAgICAgICAgICBoYXNoOiB7bmFtZTogJ1NIQS0yNTYnfSAvL2NhbiBiZSAnU0hBLTEnLCAnU0hBLTI1NicsICdTSEEtMzg0Jywgb3IgJ1NIQS01MTInXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0cnVlLCAvL3doZXRoZXIgdGhlIGtleSBpcyBleHRyYWN0YWJsZSAoaS5lLiBjYW4gYmUgdXNlZCBpbiBleHBvcnRLZXkpXHJcbiAgICAgICAgWydzaWduJywgJ3ZlcmlmeSddIC8vY2FuIGJlIGFueSBjb21iaW5hdGlvbiBvZiAnc2lnbicgYW5kICd2ZXJpZnknXHJcblxyXG4gICAgICApLnRoZW4oZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgLy9yZXR1cm5zIGEga2V5cGFpciBvYmplY3RcclxuICAgICAgICAvLyBsb2cubG9nKGtleSk7XHJcblxyXG4gICAgICAgIF90aGlzLl9jcnlwdG8uc3VidGxlLmV4cG9ydEtleShcclxuICAgICAgICAgICdzcGtpJywgLy9jYW4gYmUgJ2p3aycgKHB1YmxpYyBvciBwcml2YXRlKSwgJ3Nwa2knIChwdWJsaWMgb25seSksIG9yICdwa2NzOCcgKHByaXZhdGUgb25seSlcclxuICAgICAgICAgIGtleS5wdWJsaWNLZXkgLy9jYW4gYmUgYSBwdWJsaWNLZXkgb3IgcHJpdmF0ZUtleSwgYXMgbG9uZyBhcyBleHRyYWN0YWJsZSB3YXMgdHJ1ZVxyXG4gICAgICAgICkudGhlbihmdW5jdGlvbihwdWJsaWNLZXkpIHtcclxuICAgICAgICAgIC8vcmV0dXJucyB0aGUgZXhwb3J0ZWQga2V5IGRhdGFcclxuICAgICAgICAgIGtleVBhaXIucHVibGljICA9IG5ldyBVaW50OEFycmF5KHB1YmxpY0tleSk7XHJcbiAgICAgICAgICByZXR1cm4gX3RoaXMuX2NyeXB0by5zdWJ0bGUuZXhwb3J0S2V5KFxyXG4gICAgICAgICAgICAncGtjczgnLCAvL2NhbiBiZSAnandrJyAocHVibGljIG9yIHByaXZhdGUpLCAnc3BraScgKHB1YmxpYyBvbmx5KSwgb3IgJ3BrY3M4JyAocHJpdmF0ZSBvbmx5KVxyXG4gICAgICAgICAgICBrZXkucHJpdmF0ZUtleSAvL2NhbiBiZSBhIHB1YmxpY0tleSBvciBwcml2YXRlS2V5LCBhcyBsb25nIGFzIGV4dHJhY3RhYmxlIHdhcyB0cnVlXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocHJpdmF0ZUtleSkge1xyXG4gICAgICAgICAga2V5UGFpci5wcml2YXRlICA9IG5ldyBVaW50OEFycmF5KHByaXZhdGVLZXkpO1xyXG5cclxuICAgICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1nZW5lcmF0ZVJTQUtleVBhaXInLCBrZXlQYWlyKTtcclxuICAgICAgICAgIHJlc29sdmUoa2V5UGFpcik7XHJcblxyXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgbG9nLmVycm9yKGVycik7XHJcbiAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIGxvZy5lcnJvcihlcnIpO1xyXG4gICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBHZW5lcmF0ZXMgYSAxMjggYml0IHJhbmRvbSB2YWx1ZS5cclxuICAqIEByZXR1cm4ge2J5dGVBcnJheX0gIGFycmF5ICAgIHJhbmRvbSB2YWx1ZVxyXG4gICovXHJcbiAgZ2VuZXJhdGVJVigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IGFycmF5ID0gbmV3ICBVaW50OEFycmF5KDE2KTtcclxuICAgIF90aGlzLl9jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFycmF5KTtcclxuXHJcbiAgICByZXR1cm4gYXJyYXk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIEdlbmVyYXRlcyBhIDI1NiBiaXQgcmFuZG9tIHZhbHVlLiAzMiBiaXRzIGFyZSBleHRyYXRlZCBmcm9tIHRoZSBtYWNoaW5lIHRpbWUsXHJcbiAgKiB0aGUgcmVtYWluaW5nIGFyZSBnZW5lcmF0ZWQgcmFuZG9tbHlcclxuICAqIEByZXR1cm4ge2J5dGVBcnJheX0gIGFycmF5ICAgIHJhbmRvbSB2YWx1ZVxyXG4gICovXHJcbiAgZ2VuZXJhdGVSYW5kb20oKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBhcnJheSA9IG5ldyAgVWludDhBcnJheSgzMik7XHJcbiAgICBfdGhpcy5fY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhhcnJheSk7XHJcblxyXG4gICAgbGV0IGRhdGUgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIGxldCBkYXRlRW5jb2RlZCA9IGVuY29kZVVURjgoZGF0ZS50b1N0cmluZygpKTtcclxuXHJcbiAgICAvL2V4dHJhY3QgdGhlIGxlYXN0IHNpZ25pZmljYW50IDQgYnl0ZXMgaW4gdGhlIGRhdGVcclxuICAgIGxldCBmaW5hbERhdGUgPSBkYXRlRW5jb2RlZC5zbGljZShkYXRlRW5jb2RlZC5sZW5ndGggLSA0LCBkYXRlRW5jb2RlZC5sZW5ndGgpO1xyXG5cclxuICAgIC8vIGFkZCBpbiB0aGUgZmlyc3QgNCBieXRlcyBvZiB0aGUgYXJyYXkgdGhlIGJ5dGVzIGV4dHJhY3RlZCBwcmV2aW91c2x5O1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHsgYXJyYXlbaV0gPSBmaW5hbERhdGVbaV07IH1cclxuICAgIHJldHVybiBhcnJheTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZ2VuZXJhdGVzIGEgcHJlbWFzdGVyIHNlY3JldCAoUE1TKSBvZiA0OCBieXRlcyAoMzg0IGJpdHMpIHJhbmRvbWx5XHJcbiAgKiBAcmV0dXJuIHtieXRlQXJyYXl9ICBhcnJheSAgICBwcmVtYXN0ZXIgc2VjcmV0IGtleVxyXG4gICovXHJcbiAgZ2VuZXJhdGVQTVMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBhcnJheSA9IG5ldyBVaW50OEFycmF5KDQ4KTtcclxuICAgIF90aGlzLl9jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFycmF5KTtcclxuICAgIHJldHVybiBhcnJheTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZ2VuZXJhdGVzIGEgbWFzdGVyS2V5IHNlY3JldCAoUE1TKSBvZiA0OCBieXRlcyAoMzg0IGJpdHMpIHVzaW5nIHRoZSBwcmVtYXN0ZXIgc2VjcmV0IGFuZFxyXG4gICogdHdvIHJhbmRvbXNcclxuICAqIEByZXR1cm4ge2J5dGVBcnJheX0gIGFycmF5ICAgIG1hc3RlciBzZWNyZXQga2V5IHdpdGggNDggYnl0ZXNcclxuICAqL1xyXG4gIGdlbmVyYXRlTWFzdGVyU2VjcmV0KGhtYWNLZXksIGRhdGEpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBsZXQga2V5ID0gbmV3IFVpbnQ4QXJyYXkoNDgpO1xyXG4gICAgICBsZXQgc2VlZCA9IGRhdGE7XHJcblxyXG4gICAgICBfdGhpcy5fZGlnZXN0KGhtYWNLZXkpLnRoZW4oKGRpZ2VzdGVkS2V5KSA9PiB7XHJcblxyXG4gICAgICAgIF90aGlzLmhhc2hITUFDKGRpZ2VzdGVkS2V5LCBzZWVkKS50aGVuKGZ1bmN0aW9uKGtleXBhcnQwKSB7XHJcblxyXG4gICAgICAgICAgLy9jb3B5IHRoZSBmaXJzdCAzMiBieXRlcyBpbnRvIHRoZSBrZXlcclxuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzI7IGkrKykgeyBrZXlbaV0gPSBrZXlwYXJ0MFtpXTsgfVxyXG4gICAgICAgICAgcmV0dXJuIF90aGlzLmhhc2hITUFDKGRpZ2VzdGVkS2V5LCBzZWVkICsga2V5cGFydDApO1xyXG5cclxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKGtleXBhcnQxKSB7XHJcblxyXG4gICAgICAgICAgLy9jb3B5IHRoZSBmaXJzdCAxNiBieXRlcyB0byB0aGUga2V5IHJlbWFpbmluZyAxNiBieXRlc1xyXG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7IGtleVtpICsgMzJdID0ga2V5cGFydDFbaV07IH1cclxuXHJcbiAgICAgICAgICAvLyBsb2cubG9nKCdjcnlwdG8tZ2VuZXJhdGVNYXN0ZXJTZWNyZXQnLCBrZXkpO1xyXG4gICAgICAgICAgcmVzb2x2ZShrZXkpO1xyXG5cclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1nZW5lcmF0ZU1hc3RlclNlY3JldCcsIGVycik7XHJcbiAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGdlbmVyYXRlcyBib3RoIHVzZXJzIE1BQyBhbmQgZW5jcnlwdGlvbiBrZXlzLiBnZW5lcmF0ZSBhcyBvdXRwdXQgYW4gYXJyYXlcclxuICAqIHdpdGggNCBieXRlQXJyYXkgZWFjaCB3aXRoIDMyIGJ5dGVzXHJcbiAgKiBAcGFyYW0gIHtieXRlQXJyYXl9ICAgICAgICBzZWNyZXQgICAgICAgc2VjcmV0IHRvIGJlIHVzZWQgaW4gdGhlIEhNQUMgZnVuY3Rpb25cclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRhdGEgICAgICAgICBpbmZvcm1hdGlvbiB0byBiZSB1c2VkIGFzIHNlZWRcclxuICAqIEByZXR1cm4ge0FycmF5PGJ5dGVBcnJheT59IGtleSAgICAgICAgICBhcnJheSB3aXRoIHRoZSBpbmZvcm1hdGlvbiB0byBnZW5lcmF0ZSBrZXlzXHJcbiAgKi9cclxuICBnZW5lcmF0ZUtleXMoaG1hY0tleSwgZGF0YSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBsZXQga2V5ID0gW107XHJcbiAgICAgIGxldCBzZWVkID0gZGF0YTtcclxuXHJcbiAgICAgIC8vIGl0ZXJhdGUgNCB0aW1lcyB0byBvYnRhaW4gYSAxMDI0IGtleSBzaXplXHJcbiAgICAgIF90aGlzLmhhc2hITUFDKGhtYWNLZXksIHNlZWQpLnRoZW4oZnVuY3Rpb24oa2V5cGFydDApIHtcclxuICAgICAgICBrZXkucHVzaChrZXlwYXJ0MCk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzLmhhc2hITUFDKGhtYWNLZXksIHNlZWQgKyBrZXlwYXJ0MCk7XHJcblxyXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKGtleXBhcnQxKSB7XHJcbiAgICAgICAga2V5LnB1c2goa2V5cGFydDEpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcy5oYXNoSE1BQyhobWFjS2V5LCBzZWVkICsga2V5cGFydDEpO1xyXG5cclxuICAgICAgfSkudGhlbihmdW5jdGlvbihrZXlwYXJ0Mikge1xyXG4gICAgICAgIGtleS5wdXNoKGtleXBhcnQyKTtcclxuICAgICAgICByZXR1cm4gX3RoaXMuaGFzaEhNQUMoaG1hY0tleSwgc2VlZCArIGtleXBhcnQyKTtcclxuXHJcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oa2V5cGFydDMpIHtcclxuICAgICAgICBrZXkucHVzaChrZXlwYXJ0Myk7XHJcblxyXG4gICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1nZW5lcmF0ZUtleXMnLCBrZXkpO1xyXG4gICAgICAgIHJlc29sdmUoa2V5KTtcclxuXHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1nZW5lcmF0ZUtleXMnLCBlcnIpO1xyXG4gICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIGxvZy5sb2coaG1hY0tleSwgZGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9pbXBvcnRSU0FzaWduS2V5KHByaXZLZXkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBfdGhpcy5fY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXHJcbiAgICAgICAgJ3BrY3M4JywgLy9jYW4gYmUgJ2p3aycgKHB1YmxpYyBvciBwcml2YXRlKSwgJ3Nwa2knIChwdWJsaWMgb25seSksIG9yICdwa2NzOCcgKHByaXZhdGUgb25seSlcclxuICAgICAgICBwcml2S2V5LFxyXG4gICAgICAgIHsgICAvL3RoZXNlIGFyZSB0aGUgYWxnb3JpdGhtIG9wdGlvbnNcclxuICAgICAgICAgIG5hbWU6ICdSU0FTU0EtUEtDUzEtdjFfNScsXHJcbiAgICAgICAgICBoYXNoOiB7bmFtZTogJ1NIQS0yNTYnfSAvL2NhbiBiZSAnU0hBLTEnLCAnU0hBLTI1NicsICdTSEEtMzg0Jywgb3IgJ1NIQS01MTInXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0cnVlLCAvL3doZXRoZXIgdGhlIGtleSBpcyBleHRyYWN0YWJsZSAoaS5lLiBjYW4gYmUgdXNlZCBpbiBleHBvcnRLZXkpXHJcbiAgICAgICAgWydzaWduJ10gLy8ndmVyaWZ5JyBmb3IgcHVibGljIGtleSBpbXBvcnQsICdzaWduJyBmb3IgcHJpdmF0ZSBrZXkgaW1wb3J0c1xyXG4gICAgICApXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocHJpdmF0ZUtleSkge1xyXG4gICAgICAgIC8vcmV0dXJucyBhIHB1YmxpY0tleSAob3IgcHJpdmF0ZUtleSBpZiB5b3UgYXJlIGltcG9ydGluZyBhIHByaXZhdGUga2V5KVxyXG4gICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1faW1wb3J0UlNBc2lnbktleScsIHByaXZhdGVLZXkpO1xyXG4gICAgICAgICAgcmVzb2x2ZShwcml2YXRlS2V5KTtcclxuXHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICBsb2cuZXJyb3IoJ2NyeXB0by1faW1wb3J0UlNBc2lnbktleScsIGVycik7XHJcbiAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2ltcG9ydFJTQXZlcmlmeUtleShwdWJLZXkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBfdGhpcy5fY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXHJcbiAgICAgICAgJ3Nwa2knLCAvL2NhbiBiZSAnandrJyAocHVibGljIG9yIHByaXZhdGUpLCAnc3BraScgKHB1YmxpYyBvbmx5KSwgb3IgJ3BrY3M4JyAocHJpdmF0ZSBvbmx5KVxyXG4gICAgICAgIHB1YktleSxcclxuICAgICAgICB7ICAgLy90aGVzZSBhcmUgdGhlIGFsZ29yaXRobSBvcHRpb25zXHJcbiAgICAgICAgICBuYW1lOiAnUlNBU1NBLVBLQ1MxLXYxXzUnLFxyXG4gICAgICAgICAgaGFzaDoge25hbWU6ICdTSEEtMjU2J30gLy9jYW4gYmUgJ1NIQS0xJywgJ1NIQS0yNTYnLCAnU0hBLTM4NCcsIG9yICdTSEEtNTEyJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdHJ1ZSwgLy93aGV0aGVyIHRoZSBrZXkgaXMgZXh0cmFjdGFibGUgKGkuZS4gY2FuIGJlIHVzZWQgaW4gZXhwb3J0S2V5KVxyXG4gICAgICAgIFsndmVyaWZ5J10gLy8ndmVyaWZ5JyBmb3IgcHVibGljIGtleSBpbXBvcnQsICdzaWduJyBmb3IgcHJpdmF0ZSBrZXkgaW1wb3J0c1xyXG4gICAgICApXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocHVibGljS2V5KSB7XHJcbiAgICAgICAgLy9yZXR1cm5zIGEgcHVibGljS2V5IChvciBwcml2YXRlS2V5IGlmIHlvdSBhcmUgaW1wb3J0aW5nIGEgcHJpdmF0ZSBrZXkpXHJcbiAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLV9pbXBvcnRSU0F2ZXJpZnlLZXknLCBwdWJsaWNLZXkpO1xyXG4gICAgICAgICAgcmVzb2x2ZShwdWJsaWNLZXkpO1xyXG5cclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIGxvZy5lcnJvcignY3J5cHRvLV9pbXBvcnRSU0F2ZXJpZnlLZXknLCBlcnIpO1xyXG4gICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9pbXBvcnRSU0FlbmNyeXB0S2V5KHB1YktleSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIF90aGlzLl9jcnlwdG8uc3VidGxlLmltcG9ydEtleShcclxuICAgICAgICAnc3BraScsIC8vY2FuIGJlICdqd2snIChwdWJsaWMgb3IgcHJpdmF0ZSksICdzcGtpJyAocHVibGljIG9ubHkpLCBvciAncGtjczgnIChwcml2YXRlIG9ubHkpXHJcbiAgICAgICAgcHViS2V5LFxyXG4gICAgICAgIHsgICAvL3RoZXNlIGFyZSB0aGUgYWxnb3JpdGhtIG9wdGlvbnNcclxuICAgICAgICAgIG5hbWU6ICdSU0EtT0FFUCcsXHJcbiAgICAgICAgICBoYXNoOiB7bmFtZTogJ1NIQS0yNTYnfSAvL2NhbiBiZSAnU0hBLTEnLCAnU0hBLTI1NicsICdTSEEtMzg0Jywgb3IgJ1NIQS01MTInXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0cnVlLCAvL3doZXRoZXIgdGhlIGtleSBpcyBleHRyYWN0YWJsZSAoaS5lLiBjYW4gYmUgdXNlZCBpbiBleHBvcnRLZXkpXHJcbiAgICAgICAgWydlbmNyeXB0J10gLy8nZW5jcnlwdCcgb3IgJ3dyYXBLZXknIGZvciBwdWJsaWMga2V5IGltcG9ydCBvclxyXG4gICAgICAgIC8vJ2RlY3J5cHQnIG9yICd1bndyYXBLZXknIGZvciBwcml2YXRlIGtleSBpbXBvcnRzXHJcbiAgICAgIClcclxuICAgICAgICAudGhlbihmdW5jdGlvbihwdWJsaWNLZXkpIHtcclxuICAgICAgICAvL3JldHVybnMgYSBwdWJsaWNLZXkgKG9yIHByaXZhdGVLZXkgaWYgeW91IGFyZSBpbXBvcnRpbmcgYSBwcml2YXRlIGtleSlcclxuICAgICAgICAvLyBsb2cubG9nKCdjcnlwdG8tX2ltcG9ydFJTQWVuY3J5cHRLZXknLCBwdWJsaWNLZXkpO1xyXG4gICAgICAgICAgcmVzb2x2ZShwdWJsaWNLZXkpO1xyXG5cclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIGxvZy5lcnJvcignY3J5cHRvLV9pbXBvcnRSU0FlbmNyeXB0S2V5JywgZXJyLm5hbWUpO1xyXG4gICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9pbXBvcnRSU0FkZWNyeXB0S2V5KHByaXZLZXkpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBfdGhpcy5fY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXHJcbiAgICAgICAgJ3BrY3M4JywgLy9jYW4gYmUgJ2p3aycgKHB1YmxpYyBvciBwcml2YXRlKSwgJ3Nwa2knIChwdWJsaWMgb25seSksIG9yICdwa2NzOCcgKHByaXZhdGUgb25seSlcclxuICAgICAgICBwcml2S2V5LFxyXG4gICAgICAgIHsgICAvL3RoZXNlIGFyZSB0aGUgYWxnb3JpdGhtIG9wdGlvbnNcclxuICAgICAgICAgIG5hbWU6ICdSU0EtT0FFUCcsXHJcbiAgICAgICAgICBoYXNoOiB7bmFtZTogJ1NIQS0yNTYnfSAvL2NhbiBiZSAnU0hBLTEnLCAnU0hBLTI1NicsICdTSEEtMzg0Jywgb3IgJ1NIQS01MTInXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0cnVlLCAvL3doZXRoZXIgdGhlIGtleSBpcyBleHRyYWN0YWJsZSAoaS5lLiBjYW4gYmUgdXNlZCBpbiBleHBvcnRLZXkpXHJcbiAgICAgICAgWydkZWNyeXB0J10gLy8nZW5jcnlwdCcgb3IgJ3dyYXBLZXknIGZvciBwdWJsaWMga2V5IGltcG9ydCBvclxyXG4gICAgICAgIC8vJ2RlY3J5cHQnIG9yICd1bndyYXBLZXknIGZvciBwcml2YXRlIGtleSBpbXBvcnRzXHJcbiAgICAgIClcclxuICAgICAgICAudGhlbihmdW5jdGlvbihwcml2YXRlS2V5KSB7XHJcbiAgICAgICAgLy9yZXR1cm5zIGEgcHVibGljS2V5IChvciBwcml2YXRlS2V5IGlmIHlvdSBhcmUgaW1wb3J0aW5nIGEgcHJpdmF0ZSBrZXkpXHJcbiAgICAgICAgLy8gbG9nLmxvZygnY3J5cHRvLV9pbXBvcnRSU0FkZWNyeXB0S2V5JywgcHJpdmF0ZUtleSk7XHJcbiAgICAgICAgICByZXNvbHZlKHByaXZhdGVLZXkpO1xyXG5cclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIGxvZy5lcnJvcignY3J5cHRvLV9pbXBvcnRSU0FkZWNyeXB0S2V5JywgZXJyKTtcclxuICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjb25jYXRQTVN3aXRoUmFuZG9tcyhwbXMsIHRvUmFuZG9tLCBmcm9tUmFuZG9tKSB7XHJcblxyXG4gICAgbGV0IGZpbmFsS2V5ID0gbmV3IFVpbnQ4QXJyYXkocG1zLmxlbmd0aCArIHRvUmFuZG9tLmxlbmd0aCArIGZyb21SYW5kb20ubGVuZ3RoKTtcclxuXHJcbiAgICAvLyBhZGQgUHJlbWFzdGVyS2V5XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBmaW5hbEtleVtpXSA9IHBtc1tpXTtcclxuICAgIH1cclxuXHJcbiAgICAvL2FkZCB0byByYW5kb21cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG9SYW5kb20ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgZmluYWxLZXlbaSArIHBtcy5sZW5ndGhdID0gcG1zW2ldO1xyXG4gICAgfVxyXG5cclxuICAgIC8vYWRkIGZyb20gcmFuZG9tXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZyb21SYW5kb20ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgZmluYWxLZXlbaSArIHBtcy5sZW5ndGggKyB0b1JhbmRvbS5sZW5ndGhdID0gcG1zW2ldO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmaW5hbEtleTtcclxuICB9XHJcblxyXG4gIF9nZW5lcmF0ZTI1NmJpdEtleSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYXJyYXkgPSBuZXcgIFVpbnQ4QXJyYXkoMzIpO1xyXG4gICAgX3RoaXMuX2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoYXJyYXkpO1xyXG5cclxuICAgIHJldHVybiBhcnJheTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogaW1wb3J0cyB0aGUgc2VjcmV0IHRvIHRoZSBITUFDIGZ1bmN0aW9uXHJcbiAgKiBAcGFyYW0gIHtieXRlQXJyYXl9ICAgYXJyYXlCdWZmZXIgICAgIGJ5dGVzIHRvIGltcG9ydCBhcyBrZXlcclxuICAqIEByZXR1cm4ge0pTT059ICAgICAgIGtleSAgICAgICAgICAgICAga2V5IHJlYWR5IHRvIGJlIHVzZWQgaW4gdGhlIEhNQUMgY3J5cHRvZ3JhcGhpYyBmdW5jdGlvblxyXG4gICovXHJcbiAgX2ltcG9ydEhNQUNrZXkoYXJyYXlCdWZmZXIpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgX3RoaXMuX2RpZ2VzdChhcnJheUJ1ZmZlcikudGhlbigoa2V5KSA9PiB7XHJcblxyXG4gICAgICAgIF90aGlzLl9jcnlwdG8uc3VidGxlLmltcG9ydEtleShcclxuICAgICAgICAgICdyYXcnLCAvL2NhbiBiZSAnandrJyBvciAncmF3J1xyXG4gICAgICAgICAga2V5LFxyXG4gICAgICAgICAgeyAgIC8vdGhpcyBpcyB0aGUgYWxnb3JpdGhtIG9wdGlvbnNcclxuICAgICAgICAgICAgbmFtZTogJ0hNQUMnLFxyXG4gICAgICAgICAgICBoYXNoOiB7bmFtZTogJ1NIQS0yNTYnfSwgLy9jYW4gYmUgJ1NIQS0xJywgJ1NIQS0yNTYnLCAnU0hBLTM4NCcsIG9yICdTSEEtNTEyJ1xyXG4gICAgICAgICAgICBsZW5ndGg6IDI1NiAvL29wdGlvbmFsLCBpZiB5b3Ugd2FudCB5b3VyIGtleSBsZW5ndGggdG8gZGlmZmVyIGZyb20gdGhlIGhhc2ggZnVuY3Rpb24ncyBibG9jayBsZW5ndGhcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB0cnVlLCAvL3doZXRoZXIgdGhlIGtleSBpcyBleHRyYWN0YWJsZSAoaS5lLiBjYW4gYmUgdXNlZCBpbiBleHBvcnRLZXkpXHJcbiAgICAgICAgICBbJ3NpZ24nLCAndmVyaWZ5J10gLy9jYW4gYmUgYW55IGNvbWJpbmF0aW9uIG9mICdzaWduJyBhbmQgJ3ZlcmlmeSdcclxuICAgICAgICApLnRoZW4oZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgICAvL3JldHVybnMgdGhlIHN5bW1ldHJpYyBrZXlcclxuICAgICAgICAgIC8vIGxvZy5sb2coJ2NyeXB0by1faW1wb3J0SE1BQ2tleScsIGtleSk7XHJcbiAgICAgICAgICByZXNvbHZlKGtleSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9kaWdlc3QodmFsdWUpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBfdGhpcy5fY3J5cHRvLnN1YnRsZS5kaWdlc3QoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgbmFtZTogJ1NIQS0yNTYnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB2YWx1ZSAvL1RoZSBkYXRhIHlvdSB3YW50IHRvIGhhc2ggYXMgYW4gQXJyYXlCdWZmZXJcclxuICAgICAgKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICAvL3JldHVybnMgdGhlIGhhc2ggYXMgYW4gQXJyYXlCdWZmZXJcclxuICAgICAgICAvLyBsb2cubG9nKCdjcnlwdG8tZGlnZXN0JywgbmV3IFVpbnQ4QXJyYXkoaGFzaCkpO1xyXG4gICAgICAgICAgcmVzb2x2ZShuZXcgVWludDhBcnJheShoYXNoKSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICBsb2cuZXJyb3IoZXJyKTtcclxuICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2ltcG9ydEFFU2tleShhcnJheUJ1ZmZlcikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgX3RoaXMuX2NyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxyXG4gICAgICAgICdyYXcnLCAvL2NhbiBiZSAnandrJyBvciAncmF3J1xyXG4gICAgICAgIGFycmF5QnVmZmVyLFxyXG4gICAgICAgIHsgICAvL3RoaXMgaXMgdGhlIGFsZ29yaXRobSBvcHRpb25zXHJcbiAgICAgICAgICBuYW1lOiAnQUVTLUNCQydcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRydWUsIC8vd2hldGhlciB0aGUga2V5IGlzIGV4dHJhY3RhYmxlIChpLmUuIGNhbiBiZSB1c2VkIGluIGV4cG9ydEtleSlcclxuICAgICAgICBbJ2VuY3J5cHQnLCAnZGVjcnlwdCddIC8vY2FuIGJlICdlbmNyeXB0JywgJ2RlY3J5cHQnLCAnd3JhcEtleScsIG9yICd1bndyYXBLZXknXHJcbiAgICAgIClcclxuICAgICAgICAudGhlbihmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAvL3JldHVybnMgdGhlIHN5bW1ldHJpYyBrZXlcclxuICAgICAgICAvLyBsb2cubG9nKCdjcnlwdG8taW1wb3J0QUVTa2V5Jywga2V5KTtcclxuICAgICAgICAgIHJlc29sdmUoa2V5KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIGxvZy5lcnJvcignY3J5cHRvLWltcG9ydEFFU2tleScsIGVycik7XHJcbiAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3NoYTI1NihzdHIpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYnVmZmVyID0gbmV3IFRleHRFbmNvZGVyKCd1dGYtOCcpLmVuY29kZShzdHIpO1xyXG4gICAgcmV0dXJuIF90aGlzLl9jcnlwdG8uc3VidGxlLmRpZ2VzdCgnU0hBLTI1NicsIGJ1ZmZlcikudGhlbihmdW5jdGlvbihoYXNoKSB7XHJcbiAgICAgIHJldHVybiBfdGhpcy5faGV4KGhhc2gpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGV4KGJ1ZmZlcikge1xyXG4gICAgbGV0IGhleENvZGVzID0gW107XHJcbiAgICBsZXQgdmlldyA9IG5ldyBEYXRhVmlldyhidWZmZXIpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2aWV3LmJ5dGVMZW5ndGg7IGkgKz0gNCkge1xyXG4gICAgICAvLyBVc2luZyBnZXRVaW50MzIgcmVkdWNlcyB0aGUgbnVtYmVyIG9mIGl0ZXJhdGlvbnMgbmVlZGVkICh3ZSBwcm9jZXNzIDQgYnl0ZXMgZWFjaCB0aW1lKVxyXG4gICAgICBsZXQgdmFsdWUgPSB2aWV3LmdldFVpbnQzMihpKVxyXG5cclxuICAgICAgbGV0IHN0cmluZ1ZhbHVlID0gdmFsdWUudG9TdHJpbmcoMTYpXHJcblxyXG4gICAgICBsZXQgcGFkZGluZyA9ICcwMDAwMDAwMCdcclxuICAgICAgbGV0IHBhZGRlZFZhbHVlID0gKHBhZGRpbmcgKyBzdHJpbmdWYWx1ZSkuc2xpY2UoLXBhZGRpbmcubGVuZ3RoKVxyXG4gICAgICBoZXhDb2Rlcy5wdXNoKHBhZGRlZFZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBKb2luIGFsbCB0aGUgaGV4IHN0cmluZ3MgaW50byBvbmVcclxuICAgIHJldHVybiBoZXhDb2Rlcy5qb2luKCcnKTtcclxuICB9XHJcblxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ3J5cHRvO1xyXG4iLCIvLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdDcnlwdG9NYW5hZ2VyJyk7XHJcblxyXG5pbXBvcnQge2RpdmlkZVVSTCwgaXNEYXRhT2JqZWN0VVJMLCBpc0xlZ2FjeSwgY2hhdGtleXNUb1N0cmluZ0Nsb25lciwgY2hhdGtleXNUb0FycmF5Q2xvbmVyLCBwYXJzZU1lc3NhZ2VVUkwsXHJcbiAgcGFyc2UsIHN0cmluZ2lmeSwgZW5jb2RlLCBkZWNvZGUsIGRlY29kZVRvVWludDhBcnJheSwgcGFyc2VUb1VpbnQ4QXJyYXksIGdlbmVyYXRlR1VJRH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMuanMnO1xyXG5pbXBvcnQgQ3J5cHRvIGZyb20gJy4vQ3J5cHRvJztcclxuXHJcbi8qKlxyXG4qICBUaGUgQ3J5cHRvIE1hbmFnZXIgcHJvdmlkZXMgbWFuYWdlcyBjcnlwdG9ncmFwaGljIGZlYXR1cmVzIGZvciB0aGUgcnVudGltZSBpbmNsdWRpbmc6XHJcbiogIC0gTXV0dWFsIEF1dGhlbnRpY2F0aW9uIGJldHdlZW4gcGVlcnNcclxuKiAgLSBDcnlwdG8gS2V5c1xyXG4qICAtIGUyZSBlbmNyeXB0aW9uIGFuZCBkZWNyaXB0aW9uIG9mIGNvbW11bmljYXRpb24gYmV0d2VlbiBIeXBlcnRpZXMgYW5kIGR0YSBvYmplY3RzXHJcbipcclxuKi9cclxuY2xhc3MgQ3J5cHRvTWFuYWdlciB7XHJcblxyXG4gIC8qKlxyXG4gICogVGhpcyBpcyB0aGUgY29uc3RydWN0b3IgdG8gaW5pdGlhbGlzZSB0aGUgQ3J5cHRvTWFuYWdlciwgaXQgZG9lcyBub3QgcmVxdWlyZSBhbnkgaW5wdXQuXHJcbiAgKiBUaGUgaW5pdCgpIG11c3QgY2FsbGVkIGluIG9yZGVyIHRvIHNldCBtYW5kYXRvcmllcyBhdHRyaWJ1dGVzXHJcbiAgKi9cclxuXHJcbiAgY29uc3RydWN0b3Ioc3RvcmFnZU1hbmFnZXIpIHtcclxuICAgIHRoaXMuc3RvcmFnZU1hbmFnZXIgPSBzdG9yYWdlTWFuYWdlcjtcclxuICAgIHRoaXMudXNlckRlZmF1bHRLZXlSZWYgPSAndXNlckFzeW1tZXRyaWNLZXknO1xyXG4gIH1cclxuXHJcbiAgaW5pdChydW50aW1lVVJMLCBydW50aW1lQ2FwYWJpbGl0aWVzLCBzdG9yYWdlTWFuYWdlciwgZGF0YU9iamVjdHNTdG9yYWdlLCByZWdpc3RyeSwgY29yZURpc2NvdmVyeSwgaWRtLCBydW50aW1lRmFjdG9yeSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoIXJ1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcignW10gcnVudGltZVVSTCBpcyBtaXNzaW5nLicpO1xyXG4gICAgaWYgKCFzdG9yYWdlTWFuYWdlcikgdGhyb3cgbmV3IEVycm9yKCdzdG9yYWdlTWFuYWdlciBpcyBtaXNzaW5nJyk7XHJcbiAgICBpZiAoIXJ1bnRpbWVGYWN0b3J5KSB0aHJvdyBuZXcgRXJyb3IoJ3J1bnRpbWVGYWN0b3J5IGlzIG1pc3NpbmcnKTtcclxuXHJcbiAgICBfdGhpcy5fcnVudGltZVVSTCA9IHJ1bnRpbWVVUkw7XHJcbiAgICBfdGhpcy5fY3J5cHRvTWFuYWdlclVSTCA9IF90aGlzLl9ydW50aW1lVVJMICsgJy9jcnlwdG9NYW5hZ2VyJztcclxuXHJcbiAgICAvL190aGlzLl9teVVSTCA9IF90aGlzLl9ydW50aW1lVVJMICsgJy9jcnlwdG8nO1xyXG4gICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIgPSBzdG9yYWdlTWFuYWdlcjtcclxuICAgIF90aGlzLmRhdGFPYmplY3RzU3RvcmFnZSA9IGRhdGFPYmplY3RzU3RvcmFnZTtcclxuICAgIF90aGlzLnJ1bnRpbWVDYXBhYmlsaXRpZXMgPSBydW50aW1lQ2FwYWJpbGl0aWVzO1xyXG5cclxuICAgIF90aGlzLl9ydW50aW1lRmFjdG9yeSA9IHJ1bnRpbWVGYWN0b3J5O1xyXG4gICAgX3RoaXMuX2RvbWFpbiA9IGRpdmlkZVVSTChfdGhpcy5fcnVudGltZVVSTCkuZG9tYWluO1xyXG5cclxuICAgIF90aGlzLmNyeXB0byA9IG5ldyBDcnlwdG8oX3RoaXMuX3J1bnRpbWVGYWN0b3J5KTtcclxuXHJcbiAgICAvLyBoYXNoVGFibGUgdG8gc3RvcmUgYWxsIHRoZSBjcnlwdG8gaW5mb3JtYXRpb24gYmV0d2VlbiB0d28gaHlwZXJ0aWVzXHJcbiAgICBfdGhpcy5jaGF0S2V5cyA9IHt9O1xyXG5cclxuICAgIC8vIGhhc2hUYWJsZSB0byBzdG9yZSB0aGUgc3ltbWV0cmljIGtleXMgdG8gYmUgdXNlZCBpbiB0aGUgY2hhdCBncm91cFxyXG4gICAgX3RoaXMuZGF0YU9iamVjdFNlc3Npb25LZXlzID0ge307XHJcblxyXG4gICAgLy9mYWlsc2FmZSB0byBlbmFibGUvZGlzYWJsZSBhbGwgdGhlIGNyaXB0b2dyYXBoaWMgZnVuY3Rpb25zXHJcbiAgICBfdGhpcy5pc1RvVXNlRW5jcnlwdGlvbiA9IHRydWU7XHJcblxyXG4gICAgX3RoaXMuX3JlZ2lzdHJ5ID0gcmVnaXN0cnk7XHJcbiAgICBfdGhpcy5fY29yZURpc2NvdmVyeSA9IGNvcmVEaXNjb3Zlcnk7XHJcblxyXG4gICAgX3RoaXMuX2lkbSA9IGlkbTtcclxuXHJcbiAgfVxyXG5cclxuICAvLyoqKioqKioqKioqKioqKioqKiogR0VUIEFORCBTRVQgTUVUSE9EUyAqKioqKioqKioqKioqKioqKioqXHJcblxyXG4gIC8qKlxyXG4gICogcmV0dXJuIHRoZSBtZXNzYWdlQnVzIGluIHRoaXMgUmVnaXN0cnlcclxuICAqIEBwYXJhbSB7TWVzc2FnZUJ1c30gICAgICAgICAgIG1lc3NhZ2VCdXNcclxuICAqL1xyXG4gIGdldCBtZXNzYWdlQnVzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fbWVzc2FnZUJ1cztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogU2V0IHRoZSBtZXNzYWdlQnVzIGluIHRoaXMgUmVnaXN0cnlcclxuICAqIEBwYXJhbSB7TWVzc2FnZUJ1c30gICAgICAgICAgIG1lc3NhZ2VCdXNcclxuICAqL1xyXG4gIHNldCBtZXNzYWdlQnVzKG1lc3NhZ2VCdXMpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBfdGhpcy5fbWVzc2FnZUJ1cyA9IG1lc3NhZ2VCdXM7XHJcblxyXG4gICAgX3RoaXMuYWRkQ3J5cHRvR1VJTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIHJldHVybiB0aGUgY29yZURpc2NvdmVyeSBjb21wb25lbnRcclxuICAqL1xyXG4gIGdldCBjb3JlRGlzY292ZXJ5KCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fY29yZURpc2NvdmVyeTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogcmV0dXJuIHVzZXIncyBwdWJsaWMga2V5XHJcbiAgKi9cclxuXHJcbiAgLyogIGdldE15UHVibGljS2V5KCkge1xyXG4gICAgLy8gdG8gYmUgaW1wbGVtZW50ZWRcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpPT4ge1xyXG4gICAgICByZXNvbHZlKCdteXB1YmxpY2tleScpO1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuKi9cclxuICAvKipcclxuICAqIFNldCB0aGUgY29yZURpc2NvdmVyeSBjb21wb25lbnRcclxuICAqIEBwYXJhbSB7Y29yZURpc2NvdmVyeX0gY29yZURpc2NvdmVyeVxyXG4gICovXHJcbiAgc2V0IGNvcmVEaXNjb3ZlcnkoY29yZURpc2NvdmVyeSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9jb3JlRGlzY292ZXJ5ID0gY29yZURpc2NvdmVyeTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogcmV0dXJuIHRoZSByZWdpc3RyeSBpbiB0aGlzIGlkTW9kdWxlXHJcbiAgKiBAcGFyYW0ge3JlZ2lzdHJ5fSAgICAgICAgICAgcmVnaXN0cnlcclxuICAqL1xyXG4gIGdldCByZWdpc3RyeSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gX3RoaXMuX3JlZ2lzdHJ5O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBTZXQgdGhlIHJlZ2lzdHJ5IGluIHRoaXMgaWRNb2R1bGVcclxuICAqIEBwYXJhbSB7cmVnaXN0cnl9ICAgICByZWdcclxuICAqL1xyXG4gIHNldCByZWdpc3RyeShyZWdpc3RyeSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9yZWdpc3RyeSA9IHJlZ2lzdHJ5O1xyXG4gIH1cclxuXHJcblxyXG4gIC8vIHRvIGJlIHVzZWQgdG8gaW5pdGlhbGlzZSBJRE0gd2l0aCBTZXNzaW9uS2V5cyB1c2VkIGluIHByZXZpb3VzIHNlc3Npb25cclxuXHJcbiAgbG9hZFNlc3Npb25LZXlzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG5cclxuICAgICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIuZ2V0KCdkYXRhT2JqZWN0U2Vzc2lvbktleXMnKS50aGVuKChzZXNzaW9uS2V5cykgPT4ge1xyXG4gICAgICAgIGlmIChzZXNzaW9uS2V5cykgX3RoaXMuZGF0YU9iamVjdFNlc3Npb25LZXlzID0gc2Vzc2lvbktleXM7XHJcbiAgICAgICAgZWxzZSBfdGhpcy5kYXRhT2JqZWN0U2Vzc2lvbktleXMgPSB7fTtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaXNGcm9tUmVtb3RlU00oZnJvbSkge1xyXG4gICAgbGV0IHNwbGl0RnJvbSA9IGZyb20uc3BsaXQoJzovLycpO1xyXG4gICAgcmV0dXJuIHNwbGl0RnJvbVswXSA9PT0gJ3J1bnRpbWUnICYmIGZyb20gIT09IHRoaXMuX3J1bnRpbWVVUkwgKyAnL3NtJztcclxuICB9XHJcblxyXG4gIGFkZENyeXB0b0dVSUxpc3RlbmVycygpIHtcclxuICAgIC8vVE9ETzogQ2hhbmdlIHRoZSBHVUkgaW52b2NhdGlvbiBvZiB0aGlzIG1ldGhvZFxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihfdGhpcy5fY3J5cHRvTWFuYWdlclVSTCwgKG1zZykgPT4ge1xyXG4gICAgICBsZXQgZnVuY05hbWUgPSBtc2cuYm9keS5tZXRob2Q7XHJcblxyXG4gICAgICAvL2xldCByZXR1cm5lZFZhbHVlO1xyXG4gICAgICBpZiAoZnVuY05hbWUgPT09ICdnZW5lcmF0ZVJTQUtleVBhaXInKSB7XHJcbiAgICAgICAgX3RoaXMuX2NyeXB0by5nZXRNeVB1YmxpY0tleSgpLnRoZW4oKGtleSkgPT4ge1xyXG4gICAgICAgICAgbGV0IHZhbHVlID0ge3R5cGU6ICdleGVjdXRlJywgdmFsdWU6IGtleSwgY29kZTogMjAwfTtcclxuICAgICAgICAgIGxldCByZXBseU1zZyA9IHtpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCB0bzogbXNnLmZyb20sIGZyb206IG1zZy50bywgYm9keTogdmFsdWV9O1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHlNc2cpO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGxvZy5lcnJvcignT24gYWRkR1VJTGlzdGVuZXJzIGZyb20gaWYgZ2VuZXJhdGVSU0FLZXlQYWlyIG1ldGhvZCBwb3N0TWVzc2FnZSBlcnJvcjogJyArIGVycik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLy8qKioqKioqKioqKioqKioqKioqIEVOQ1JZUFRJT04gTUVUSE9EUyAqKioqKioqKioqKioqKioqKioqXHJcbiAgLyoqXHJcbiogSWRlbnRpZmllcyB0aGUgbWVzc2FnZXMgdG8gYmUgZW5jcnlwdGVkXHJcbiogQHBhcmFtIHtNZXNzYWdlfSAgICBtZXNzYWdlXHJcbiogQHJldHVybnMge2Jvb2xlYW59ICByZXR1cm5zIHRydWUgaWYgdGhlIG1lc3NhZ2UgcmVxdWlyZXMgZW5jcnlwdGlvblxyXG4qL1xyXG5cclxuICBfaXNUb0VuY3J5cHQobWVzc2FnZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxvZy5sb2coJ1tDcnlwdG9NYW5hZ2VyLl9pc1RvRW5jcnlwdF0nLCBtZXNzYWdlKTtcclxuICAgIGxldCBpc0NyZWF0ZSA9IG1lc3NhZ2UudHlwZSA9PT0gJ2NyZWF0ZSc7XHJcbiAgICBsZXQgaXNGcm9tSHlwZXJ0eSA9IG1lc3NhZ2UuZnJvbS5pbmNsdWRlcygnaHlwZXJ0eTovLycpO1xyXG4gICAgbGV0IGlzVG9IeXBlcnR5ID0gbWVzc2FnZS50by5pbmNsdWRlcygnaHlwZXJ0eTovLycpO1xyXG4gICAgbGV0IGlzVG9EYXRhT2JqZWN0ID0gaXNEYXRhT2JqZWN0VVJMKG1lc3NhZ2UudG8pO1xyXG4gICAgbGV0IHJlcG9ydGVyID0gX3RoaXMucmVnaXN0cnkuZ2V0RGF0YU9iamVjdFJlcG9ydGVyKG1lc3NhZ2UudG8pO1xyXG5cclxuICAgIGxldCBkb011dHVhbEF1dGhlbnRpY2F0aW9uID0gbWVzc2FnZS5oYXNPd25Qcm9wZXJ0eSgnYm9keScpICYmIG1lc3NhZ2UuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykgPyBtZXNzYWdlLmJvZHkubXV0dWFsXHJcbiAgICA6ICBtZXNzYWdlLmhhc093blByb3BlcnR5KCdib2R5JykgJiYgbWVzc2FnZS5ib2R5Lmhhc093blByb3BlcnR5KCd2YWx1ZScpICYmIG1lc3NhZ2UuYm9keS52YWx1ZS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykgPyBtZXNzYWdlLmJvZHkudmFsdWUubXV0dWFsICA6IHRydWU7XHJcblxyXG4gICAgaWYgKCFkb011dHVhbEF1dGhlbnRpY2F0aW9uKSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAocmVwb3J0ZXIgIT09IG51bGwgJiYgaXNMZWdhY3kocmVwb3J0ZXIpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvL2lmIGlzIG5vdCB0byBhcHBseSBlbmNyeXB0aW9uLCB0aGVuIHJldHVybnMgcmVzb2x2ZVxyXG4gICAgaWYgKCF0aGlzLmlzVG9Vc2VFbmNyeXB0aW9uICYmICEobWVzc2FnZS50eXBlID09PSAnaGFuZHNoYWtlJykpIHtcclxuICAgICAgbG9nLmluZm8oJ25vdCBoYW5kc2hha2U6IGVuY3J5cHRpb24gZGlzYWJsZWQnKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChtZXNzYWdlLnR5cGUgPT09ICd1cGRhdGUnKSB7XHJcbiAgICAgIGxvZy5pbmZvKCd1cGRhdGU6ZW5jcnlwdGlvbiBkaXNhYmxlZCcpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ2ZvcndhcmQnKSB7XHJcbiAgICAgIGxvZy5pbmZvKCdmb3J3YXJkOmVuY3J5cHRpb24gZGlzYWJsZWQnKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChpc0xlZ2FjeShtZXNzYWdlLnRvKSkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIHJldHVybiAoKGlzQ3JlYXRlICYmIGlzRnJvbUh5cGVydHkgJiYgaXNUb0h5cGVydHkpIHx8IChpc0NyZWF0ZSAmJiBpc0Zyb21IeXBlcnR5ICYmIGlzVG9EYXRhT2JqZWN0ICYmIGRvTXV0dWFsQXV0aGVudGljYXRpb24pIHx8IG1lc3NhZ2UudHlwZSA9PT0gJ2hhbmRzaGFrZScgfHwgKG1lc3NhZ2UudHlwZSA9PT0gJ3VwZGF0ZScgJiYgZG9NdXR1YWxBdXRoZW50aWNhdGlvbikpO1xyXG4gIH1cclxuXHJcblxyXG4gIF9pc1RvRGVjcnlwdChtZXNzYWdlKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAvLyBGb3Igc3lic2NyaWJlIG1lc3NhZ2UgbGV0J3Mgc3RhcnQgdGhlIG11dHVhbEF1dGhlbnRpY2F0aW9uXHJcbiAgICAgIGxldCBpc1N1YnNjcmlwdGlvbiA9IG1lc3NhZ2UudHlwZSA9PT0gJ3N1YnNjcmliZSc7XHJcbiAgICAgIGxldCBpc0Zyb21SZW1vdGVTTSA9IF90aGlzLl9pc0Zyb21SZW1vdGVTTShtZXNzYWdlLmZyb20pO1xyXG4gICAgICBsZXQgbXV0dWFsID0gbWVzc2FnZS5ib2R5Lmhhc093blByb3BlcnR5KCd2YWx1ZScpICYmIG1lc3NhZ2UuYm9keS52YWx1ZS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykgPyBtZXNzYWdlLmJvZHkudmFsdWUubXV0dWFsIDogXHJcbiAgICAgIG1lc3NhZ2UuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykgPyBtZXNzYWdlLmJvZHkubXV0dWFsIDogdHJ1ZTtcclxuICAgICAgLy8gICAgICBsZXQgbXV0dWFsID0gbWVzc2FnZS5ib2R5Lmhhc093blByb3BlcnR5KCdtdXR1YWwnKSA/IG1lc3NhZ2UuYm9keS5tdXR1YWwgOiBmYWxzZTtcclxuXHJcbmlmIChpc1N1YnNjcmlwdGlvbiAmJiBpc0Zyb21SZW1vdGVTTSAmJiBtdXR1YWwpIHtcclxuLy8gIGlmIChpc1N1YnNjcmlwdGlvbiAmJiBpc0Zyb21SZW1vdGVTTSApIHtcclxuICAgIGxvZy5sb2coJ1tDcnlwdG9NYW5hZ2VyLl9pc1RvRGVjcnlwdF0gX2RvTXV0dWFsQXV0aGVudGljYXRpb25QaGFzZTEnKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0NyeXB0b01hbmFnZXIuX2lzVG9EZWNyeXB0XSAnLCBtZXNzYWdlKTtcclxuICAgICAgICBsZXQgcmVwb3J0ZXIgPSBfdGhpcy5yZWdpc3RyeS5nZXREYXRhT2JqZWN0UmVwb3J0ZXIobWVzc2FnZS50byk7XHJcbiAgICAgICAgaWYgKHJlcG9ydGVyICE9PSBudWxsICYmIGlzTGVnYWN5KHJlcG9ydGVyKSkge1xyXG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX3RoaXMuX2RvTXV0dWFsQXV0aGVudGljYXRpb25QaGFzZTEobWVzc2FnZSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICB9LCAoZXJyb3IpID0+IHtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4vLyAgICAgIH0gZWxzZSBpZiAobWVzc2FnZS5oYXNPd25Qcm9wZXJ0eSgnYm9keScpICYmIG1lc3NhZ2UuYm9keS5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSAmJiB0eXBlb2YgbWVzc2FnZS5ib2R5LnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICB9IGVsc2UgaWYgKG1lc3NhZ2UuaGFzT3duUHJvcGVydHkoJ2JvZHknKSAmJiBtZXNzYWdlLmJvZHkuaGFzT3duUHJvcGVydHkoJ3ZhbHVlJykgJiYgdHlwZW9mIG1lc3NhZ2UuYm9keS52YWx1ZSA9PT0gJ3N0cmluZycgJiYgbXV0dWFsKSB7XHJcbiAgICAgICAgbG9nLmxvZygnW0NyeXB0b01hbmFnZXIuX2lzVG9EZWNyeXB0XSB0cnVlJyk7XHJcbiAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsb2cubG9nKCdbQ3J5cHRvTWFuYWdlci5faXNUb0RlY3J5cHRdIGZhbHNlJyk7XHJcbiAgICAgICAgcmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgbG9nLmVycm9yKCdbQ3J5cHRvTWFuYWdlci5faXNUb0RlY3J5cHRdJywgZXJyb3IpO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgZW5jcnlwdE1lc3NhZ2UobWVzc2FnZSkge1xyXG4gICAgLy9sb2cuaW5mbygnZW5jcnlwdE1lc3NhZ2U6bWVzc2FnZScsIG1lc3NhZ2UpO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsb2cubG9nKCdlbmNyeXB0IG1lc3NhZ2UgJyk7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IGlzSGFuZFNoYWtlVHlwZSA9IG1lc3NhZ2UudHlwZSA9PT0gJ2hhbmRzaGFrZSc7XHJcblxyXG4gICAgICAvL2lmIGlzIG5vdCB0byBhcHBseSBlbmNyeXB0aW9uLCB0aGVuIHJldHVybnMgcmVzb2x2ZVxyXG4gICAgICBpZiAoIV90aGlzLl9pc1RvRW5jcnlwdChtZXNzYWdlKSkge1xyXG4gICAgICAgIC8vIGxvZy5sb2coJ2RlY3J5cHRpb24gZGlzYWJsZWQnKTtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShtZXNzYWdlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGRhdGFPYmplY3RVUkwgPSBwYXJzZU1lc3NhZ2VVUkwobWVzc2FnZS50byk7XHJcblxyXG4gICAgICBsZXQgaXNUb0RhdGFPYmplY3QgPSBpc0RhdGFPYmplY3RVUkwoZGF0YU9iamVjdFVSTCk7XHJcbiAgICAgIGxldCBpc1RvTGVnYWN5SWRlbnRpdHkgPSBpc0xlZ2FjeShtZXNzYWdlLnRvKTtcclxuICAgICAgbGV0IGlzRnJvbUh5cGVydHkgPSBkaXZpZGVVUkwobWVzc2FnZS5mcm9tKS50eXBlID09PSAnaHlwZXJ0eSc7XHJcbiAgICAgIGxldCBpc1RvSHlwZXJ0eSA9IGRpdmlkZVVSTChtZXNzYWdlLnRvKS50eXBlID09PSAnaHlwZXJ0eSc7XHJcblxyXG4gICAgICBpZiAobWVzc2FnZS50eXBlID09PSAndXBkYXRlJykge1xyXG4gICAgICAgIGxvZy5sb2coJ2VuY3J5cHQgbWVzc2FnZTogbWVzc2FnZSB0eXBlIHVwZGF0ZScpO1xyXG4gICAgICAgIHJldHVybiByZXNvbHZlKG1lc3NhZ2UpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoaXNUb0xlZ2FjeUlkZW50aXR5KSB7XHJcbiAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTtcclxuICAgICAgfSBlbHNlIGlmIChpc0Zyb21IeXBlcnR5ICYmIGlzVG9IeXBlcnR5KSB7XHJcbiAgICAgICAgbGV0IHVzZXJVUkwgPSBfdGhpcy5fcmVnaXN0cnkuZ2V0SHlwZXJ0eU93bmVyKG1lc3NhZ2UuZnJvbSk7XHJcbiAgICAgICAgaWYgKHVzZXJVUkwpIHtcclxuXHJcbiAgICAgICAgICAvLyBjaGVjayBpZiBleGlzdHMgYW55IGtleXMgYmV0d2VlbiB0d28gdXNlcnNcclxuICAgICAgICAgIGxldCBjaGF0S2V5cyA9IF90aGlzLmNoYXRLZXlzW21lc3NhZ2UuZnJvbSArICc8LT4nICsgbWVzc2FnZS50b107XHJcbiAgICAgICAgICBpZiAoIWNoYXRLZXlzKSB7XHJcbiAgICAgICAgICAgIGNoYXRLZXlzID0gX3RoaXMuX25ld0NoYXRDcnlwdG8obWVzc2FnZSwgdXNlclVSTCk7XHJcblxyXG4gICAgICAgICAgICAvL2xvZy5sb2coJ2NyZWF0ZUNoYXRLZXkgZW5jcnlwdCcsIG1lc3NhZ2UuZnJvbSArIG1lc3NhZ2UudG8pO1xyXG4gICAgICAgICAgICBfdGhpcy5jaGF0S2V5c1ttZXNzYWdlLmZyb20gKyAnPC0+JyArIG1lc3NhZ2UudG9dID0gY2hhdEtleXM7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UuYm9keS5oYW5kc2hha2VQaGFzZSA9ICdzdGFydEhhbmRTaGFrZSc7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKGNoYXRLZXlzLmF1dGhlbnRpY2F0ZWQgJiYgIWlzSGFuZFNoYWtlVHlwZSkge1xyXG5cclxuICAgICAgICAgICAgbGV0IGl2ID0gX3RoaXMuY3J5cHRvLmdlbmVyYXRlSVYoKTtcclxuICAgICAgICAgICAgX3RoaXMuY3J5cHRvLmVuY3J5cHRBRVMoY2hhdEtleXMua2V5cy5oeXBlcnR5RnJvbVNlc3Npb25LZXksIHN0cmluZ2lmeShtZXNzYWdlLmJvZHkudmFsdWUpLCBpdikudGhlbihlbmNyeXB0ZWRWYWx1ZSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgIGxldCBmaWx0ZXJlZE1lc3NhZ2UgPSBfdGhpcy5fZmlsdGVyTWVzc2FnZVRvSGFzaChtZXNzYWdlLCBzdHJpbmdpZnkobWVzc2FnZS5ib2R5LnZhbHVlKSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ2lmeShpdiksIGNoYXRLZXlzLmh5cGVydHlGcm9tLm1lc3NhZ2VJbmZvKTtcclxuXHJcbiAgICAgICAgICAgICAgX3RoaXMuY3J5cHRvLmhhc2hITUFDKGNoYXRLZXlzLmtleXMuaHlwZXJ0eUZyb21IYXNoS2V5LCBmaWx0ZXJlZE1lc3NhZ2UpLnRoZW4oaGFzaCA9PiB7XHJcbiAgICAgICAgICAgICAgICAvL2xvZy5sb2coJ3Jlc3VsdCBvZiBoYXNoICcsIGhhc2gpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHZhbHVlID0ge2l2OiBlbmNvZGUoaXYpLCB2YWx1ZTogZW5jb2RlKGVuY3J5cHRlZFZhbHVlKSwgaGFzaDogZW5jb2RlKGhhc2gpfTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2UuYm9keS52YWx1ZSA9IGVuY29kZSh2YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBpZiBpcyBhIGhhbmRzaGFrZSBtZXNzYWdlLCBqdXN0IHJlc29sdmUgaXRcclxuICAgICAgICAgIH0gZWxzZSBpZiAoaXNIYW5kU2hha2VUeXBlKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUobWVzc2FnZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBlbHNlLCBzdGFydHMgYSBuZXcgaGFuZHNoYWtlIHByb3RvY29sXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBfdGhpcy5fZG9IYW5kU2hha2VQaGFzZShtZXNzYWdlLCBjaGF0S2V5cykudGhlbihmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgICAgIF90aGlzLmNoYXRLZXlzW21lc3NhZ2UuZnJvbSArICc8LT4nICsgbWVzc2FnZS50b10gPSB2YWx1ZS5jaGF0S2V5cztcclxuXHJcbiAgICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UodmFsdWUubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KCdlbmNyeXB0IGhhbmRzaGFrZSBwcm90b2NvbCBwaGFzZSAnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlamVjdCgnSW4gZW5jcnlwdE1lc3NhZ2U6IEh5cGVydHkgb3duZXIgVVJMIHdhcyBub3QgZm91bmQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAvL2lmIGZyb20gaHlwZXJ0eSB0byBhIGRhdGFPYmplY3RVUkxcclxuICAgICAgfSBlbHNlIGlmIChpc0Zyb21IeXBlcnR5ICYmIGlzVG9EYXRhT2JqZWN0KSB7XHJcblxyXG4gICAgICAgIC8vbG9nLmxvZygnZGF0YU9iamVjdCB2YWx1ZSB0byBlbmNyeXB0OiAnLCBtZXNzYWdlLmJvZHkudmFsdWUpO1xyXG4gICAgICAgIC8vbG9nLmxvZygnSWRlbnRpdHlNb2R1bGUgLSBlbmNyeXB0IGZyb20gaHlwZXJ0eSB0byBkYXRhb2JqZWN0ICcsIG1lc3NhZ2UpO1xyXG5cclxuICAgICAgICBfdGhpcy5zdG9yYWdlTWFuYWdlci5nZXQoJ2RhdGFPYmplY3RTZXNzaW9uS2V5cycpLnRoZW4oKHNlc3Npb25LZXlzKSA9PiB7XHJcbiAgICAgICAgICBzZXNzaW9uS2V5cyA9IGNoYXRrZXlzVG9BcnJheUNsb25lcihzZXNzaW9uS2V5cyB8fCB7fSk7XHJcbiAgICAgICAgICBsZXQgZGF0YU9iamVjdEtleSA9IHNlc3Npb25LZXlzID8gc2Vzc2lvbktleXNbZGF0YU9iamVjdFVSTF0gOiBudWxsO1xyXG5cclxuICAgICAgICAgIF90aGlzLmRhdGFPYmplY3RzU3RvcmFnZS5nZXREYXRhT2JqZWN0KGRhdGFPYmplY3RVUkwpLnRoZW4oKGlzSHlwZXJ0eVJlcG9ydGVyKSA9PiB7XHJcbiAgICAgICAgICAgIC8vaWYgbm8ga2V5IGV4aXN0cywgY3JlYXRlIGEgbmV3IG9uZSBpZiBpcyB0aGUgcmVwb3J0ZXIgb2YgZGF0YU9iamVjdFxyXG4gICAgICAgICAgICBpZiAoIWRhdGFPYmplY3RLZXkpIHtcclxuICAgICAgICAgICAgICAvLyBpZiB0aGUgaHlwZXJ0eSBpcyB0aGUgcmVwb3J0ZXIgb2YgdGhlIGRhdGFPYmplY3QgdGhlbiBnZW5lcmF0ZXMgYSBzZXNzaW9uIGtleVxyXG4gICAgICAgICAgICAgIGlmIChpc0h5cGVydHlSZXBvcnRlci5yZXBvcnRlciAmJiBpc0h5cGVydHlSZXBvcnRlci5yZXBvcnRlciA9PT0gbWVzc2FnZS5mcm9tKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHNlc3Npb25LZXkgPSBfdGhpcy5jcnlwdG8uZ2VuZXJhdGVSYW5kb20oKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmRhdGFPYmplY3RTZXNzaW9uS2V5c1tkYXRhT2JqZWN0VVJMXSA9IHtzZXNzaW9uS2V5OiBzZXNzaW9uS2V5LCBpc1RvRW5jcnlwdDogdHJ1ZX07XHJcbiAgICAgICAgICAgICAgICBsZXQgZGF0YU9iamVjdFNlc3Npb25LZXlzQ2xvbmUgPSBjaGF0a2V5c1RvU3RyaW5nQ2xvbmVyKF90aGlzLmRhdGFPYmplY3RTZXNzaW9uS2V5cyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9UT0RPOiBjaGVjayBpZiB0aGlzIGRvZXMgbm90IG5lZWQgdG8gYmUgc3RvcmVkXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zdG9yYWdlTWFuYWdlci5zZXQoJ2RhdGFPYmplY3RTZXNzaW9uS2V5cycsIDAsIGRhdGFPYmplY3RTZXNzaW9uS2V5c0Nsb25lKS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICByZWplY3QoJ09uIGVuY3J5cHRNZXNzYWdlIGZyb20gbWV0aG9kIHN0b3JhZ2VNYW5hZ2VyLnNldCBlcnJvcjogJyArIGVycik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGRhdGFPYmplY3RLZXkgPSBfdGhpcy5kYXRhT2JqZWN0U2Vzc2lvbktleXNbZGF0YU9iamVjdFVSTF07XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL2NoZWNrIGlmIHRoZXJlIGlzIGFscmVhZHkgYSBzZXNzaW9uIGtleSBmb3IgdGhlIGNoYXQgcm9vbVxyXG4gICAgICAgICAgICBpZiAoZGF0YU9iamVjdEtleSkge1xyXG5cclxuICAgICAgICAgICAgICAvLyBhbmQgaWYgaXMgdG8gYXBwbHkgZW5jcnlwdGlvbiwgZW5jcnlwdCB0aGUgbWVzc2FnZXNcclxuICAgICAgICAgICAgICBpZiAoZGF0YU9iamVjdEtleS5pc1RvRW5jcnlwdCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGl2ID0gX3RoaXMuY3J5cHRvLmdlbmVyYXRlSVYoKTtcclxuICAgICAgICAgICAgICAgIGxldCBzdHJpbmdpZmllZElWID0gc3RyaW5naWZ5KGl2KTtcclxuICAgICAgICAgICAgICAgIGxldCBzdHJpbmdpZmllZE1lc3NhZ2VCb2R5ID0gc3RyaW5naWZ5KG1lc3NhZ2UuYm9keS52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3RoaXMuY3J5cHRvLmVuY3J5cHRBRVMoZGF0YU9iamVjdEtleS5zZXNzaW9uS2V5LCBzdHJpbmdpZmllZE1lc3NhZ2VCb2R5LCBpdikudGhlbihlbmNyeXB0ZWRWYWx1ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtZXNzYWdlLmJvZHkuaWRlbnRpdHkuYXNzZXJ0aW9uOyAvL1RPRE86IENoZWNrIHdoeSBhc3NlcnRpb24gaXMgY29tbWluZyBvbiB0aGUgbWVzc2FnZSFcclxuICAgICAgICAgICAgICAgICAgZGVsZXRlIG1lc3NhZ2UuYm9keS5pZGVudGl0eS5leHBpcmVzOyAvL1RPRE86IENoZWNrIHdoeSBleHBpcmVzIGlzIGNvbW1pbmcgb24gdGhlIG1lc3NhZ2UhXHJcbiAgICAgICAgICAgICAgICAgIGxldCBmaWx0ZXJlZE1lc3NhZ2UgPSBfdGhpcy5fZmlsdGVyTWVzc2FnZVRvSGFzaChtZXNzYWdlLCBzdHJpbmdpZmllZE1lc3NhZ2VCb2R5ICsgc3RyaW5naWZpZWRJVik7XHJcblxyXG4gICAgICAgICAgICAgICAgICBfdGhpcy5jcnlwdG8uaGFzaEhNQUMoZGF0YU9iamVjdEtleS5zZXNzaW9uS2V5LCBmaWx0ZXJlZE1lc3NhZ2UpLnRoZW4oaGFzaCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbG9nLmxvZygnaGFzaCAnLCBoYXNoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5ld1ZhbHVlID0ge3ZhbHVlOiBlbmNvZGUoZW5jcnlwdGVkVmFsdWUpLCBpdjogZW5jb2RlKGl2KSwgaGFzaDogZW5jb2RlKGhhc2gpfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5ib2R5LnZhbHVlID0gc3RyaW5naWZ5KG5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAvLyBpZiBub3QsIGp1c3Qgc2VuZCB0aGUgbWVzc2FnZVxyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gc3RhcnQgdGhlIGdlbmVyYXRpb24gb2YgYSBuZXcgc2Vzc2lvbiBLZXlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICByZWplY3QoJ0RhdGEgb2JqZWN0IGtleSBjb3VsZCBub3QgYmUgZGVmaW5lZDogRmFpbGVkIHRvIGRlY3J5cHQgbWVzc2FnZSAnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsgcmVqZWN0KCdPbiBlbmNyeXB0TWVzc2FnZSBmcm9tIG1ldGhvZCBkYXRhT2JqZWN0c1N0b3JhZ2UuZ2V0RGF0YU9iamVjdCBlcnJvcjogJyArIGVycik7IH0pO1xyXG4gICAgICAgIH0pLmNhdGNoKGVyciA9PiB7IHJlamVjdCgnT24gZW5jcnlwdE1lc3NhZ2UgZnJvbSBtZXRob2Qgc3RvcmFnZU1hbmFnZXIuZ2V0IGVycm9yOiAnICsgZXJyKTsgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5jcnlwdERhdGFPYmplY3QoZGF0YU9iamVjdCwgc2VuZGVyKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgbG9nLmluZm8oJ2RhdGFPYmplY3QgdmFsdWUgdG8gZW5jcnlwdDogJywgZGF0YU9iamVjdCk7XHJcblxyXG4gICAgICBsZXQgZGF0YU9iamVjdFVSTCA9IHBhcnNlTWVzc2FnZVVSTChzZW5kZXIpO1xyXG5cclxuICAgICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIuZ2V0KCdkYXRhT2JqZWN0U2Vzc2lvbktleXMnKS50aGVuKChzZXNzaW9uS2V5cykgPT4ge1xyXG4gICAgICAgIHNlc3Npb25LZXlzID0gY2hhdGtleXNUb0FycmF5Q2xvbmVyKHNlc3Npb25LZXlzIHx8IHt9KTtcclxuICAgICAgICBsZXQgZGF0YU9iamVjdEtleSA9IHNlc3Npb25LZXlzID8gc2Vzc2lvbktleXNbZGF0YU9iamVjdFVSTF0gOiBudWxsO1xyXG5cclxuICAgICAgICAvL2NoZWNrIGlmIHRoZXJlIGlzIGFscmVhZHkgYSBzZXNzaW9uIGtleSBmb3IgdGhlIGNoYXQgcm9vbVxyXG4gICAgICAgIGlmIChkYXRhT2JqZWN0S2V5KSB7XHJcblxyXG4gICAgICAgICAgLy8gYW5kIGlmIGlzIHRvIGFwcGx5IGVuY3J5cHRpb24sIGVuY3J5cHQgdGhlIG1lc3NhZ2VzXHJcbiAgICAgICAgICBpZiAoZGF0YU9iamVjdEtleS5pc1RvRW5jcnlwdCkge1xyXG4gICAgICAgICAgICBsZXQgaXYgPSBfdGhpcy5jcnlwdG8uZ2VuZXJhdGVJVigpO1xyXG5cclxuICAgICAgICAgICAgX3RoaXMuY3J5cHRvLmVuY3J5cHRBRVMoZGF0YU9iamVjdEtleS5zZXNzaW9uS2V5LCBzdHJpbmdpZnkoZGF0YU9iamVjdCksIGl2KS50aGVuKGVuY3J5cHRlZFZhbHVlID0+IHtcclxuICAgICAgICAgICAgICBsZXQgbmV3VmFsdWUgPSB7IHZhbHVlOiBlbmNvZGUoZW5jcnlwdGVkVmFsdWUpLCBpdjogZW5jb2RlKGl2KSB9O1xyXG5cclxuICAgICAgICAgICAgICAvL2xvZy5sb2coJ2VuY3J5cHRlZCBkYXRhT2JqZWN0JywgbmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKG5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsgcmVqZWN0KCdPbiBlbmNyeXB0RGF0YU9iamVjdCBmcm9tIG1ldGhvZCBlbmNyeXB0QUVTIGVycm9yOiAnICsgZXJyKTsgfSk7XHJcblxyXG4gICAgICAgICAgLy8gaWYgbm90LCBqdXN0IHNlbmQgdGhlIG1lc3NhZ2VcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdUaGUgZGF0YU9iamVjdCBpcyBub3QgZW5jcnlwdGVkJyk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGRhdGFPYmplY3QpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIHN0YXJ0IHRoZSBnZW5lcmF0aW9uIG9mIGEgbmV3IHNlc3Npb24gS2V5XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiByZWplY3QoJ05vIGRhdGFPYmplY3RLZXkgZm9yIHRoaXMgZGF0YU9iamVjdFVSTDonLCBkYXRhT2JqZWN0VVJMKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pLmNhdGNoKGVyciA9PiB7IHJlamVjdCgnT24gZW5jcnlwdERhdGFPYmplY3QgZnJvbSBtZXRob2Qgc3RvcmFnZU1hbmFnZXIuZ2V0IGVycm9yOiAnICsgZXJyKTsgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlY3J5cHRNZXNzYWdlKG1lc3NhZ2UpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy8gIGxvZy5sb2coJ2RlY3J5cHRNZXNzYWdlOm1lc3NhZ2UnLCBtZXNzYWdlKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIGxldCBpc0hhbmRTaGFrZVR5cGUgPSBtZXNzYWdlLnR5cGUgPT09ICdoYW5kc2hha2UnO1xyXG5cclxuICAgICAgX3RoaXMuX2lzVG9EZWNyeXB0KG1lc3NhZ2UpLnRoZW4oKGlzVG9EZWNyeXB0KSA9PiB7XHJcblxyXG4gICAgICAgIC8vaWYgaXMgbm90IHRvIGFwcGx5IGVuY3J5cHRpb24sIHRoZW4gcmV0dXJucyByZXNvbHZlXHJcbiAgICAgICAgaWYgKCFpc1RvRGVjcnlwdCkgcmV0dXJuIHJlc29sdmUobWVzc2FnZSk7XHJcblxyXG4gICAgICAgIGxldCBkYXRhT2JqZWN0VVJMID0gcGFyc2VNZXNzYWdlVVJMKG1lc3NhZ2UudG8pO1xyXG5cclxuICAgICAgICBsZXQgaXNUb0RhdGFPYmplY3QgPSBpc0RhdGFPYmplY3RVUkwoZGF0YU9iamVjdFVSTCk7XHJcbiAgICAgICAgbGV0IGlzRnJvbUh5cGVydHkgPSBkaXZpZGVVUkwobWVzc2FnZS5mcm9tKS50eXBlID09PSAnaHlwZXJ0eSc7XHJcbiAgICAgICAgbGV0IGlzVG9IeXBlcnR5ID0gZGl2aWRlVVJMKG1lc3NhZ2UudG8pLnR5cGUgPT09ICdoeXBlcnR5JztcclxuXHJcbiAgICAgICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ3VwZGF0ZScpIHtcclxuICAgICAgICAgIHJldHVybiByZXNvbHZlKG1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9pcyBpcyBoeXBlcnR5IHRvIGh5cGVydHkgY29tbXVuaWNhdGlvblxyXG4gICAgICAgIGlmIChpc0Zyb21IeXBlcnR5ICYmIGlzVG9IeXBlcnR5KSB7XHJcbiAgICAgICAgICAvLyBsb2cubG9nKCdkZWNyeXB0IGh5cGVydHkgdG8gaHlwZXJ0eScpO1xyXG4gICAgICAgICAgbGV0IHVzZXJVUkwgPSBfdGhpcy5fcmVnaXN0cnkuZ2V0SHlwZXJ0eU93bmVyKG1lc3NhZ2UudG8pO1xyXG4gICAgICAgICAgaWYgKHVzZXJVUkwpIHtcclxuXHJcbiAgICAgICAgICAgIGxldCBjaGF0S2V5cyA9IF90aGlzLmNoYXRLZXlzW21lc3NhZ2UudG8gKyAnPC0+JyArIG1lc3NhZ2UuZnJvbV07XHJcbiAgICAgICAgICAgIGlmICghY2hhdEtleXMpIHtcclxuICAgICAgICAgICAgICBjaGF0S2V5cyA9IF90aGlzLl9uZXdDaGF0Q3J5cHRvKG1lc3NhZ2UsIHVzZXJVUkwsICdkZWNyeXB0Jyk7XHJcbiAgICAgICAgICAgICAgX3RoaXMuY2hhdEtleXNbbWVzc2FnZS50byArICc8LT4nICsgbWVzc2FnZS5mcm9tXSA9IGNoYXRLZXlzO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY2hhdEtleXMuYXV0aGVudGljYXRlZCAmJiAhaXNIYW5kU2hha2VUeXBlKSB7XHJcbiAgICAgICAgICAgICAgbGV0IHZhbHVlID0gZGVjb2RlKG1lc3NhZ2UuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgbGV0IGl2ID0gZGVjb2RlVG9VaW50OEFycmF5KHZhbHVlLml2KTtcclxuICAgICAgICAgICAgICBsZXQgZGF0YSA9IGRlY29kZVRvVWludDhBcnJheSh2YWx1ZS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgbGV0IGhhc2ggPSBkZWNvZGVUb1VpbnQ4QXJyYXkodmFsdWUuaGFzaCk7XHJcbiAgICAgICAgICAgICAgX3RoaXMuY3J5cHRvLmRlY3J5cHRBRVMoY2hhdEtleXMua2V5cy5oeXBlcnR5VG9TZXNzaW9uS2V5LCBkYXRhLCBpdikudGhlbihkZWNyeXB0ZWREYXRhID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIGxvZy5sb2coJ2RlY3J5cHRlZCB2YWx1ZSAnLCBkZWNyeXB0ZWREYXRhKTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2UuYm9keS52YWx1ZSA9IGRlY3J5cHRlZERhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkTWVzc2FnZSA9IF90aGlzLl9maWx0ZXJNZXNzYWdlVG9IYXNoKG1lc3NhZ2UsIGRlY3J5cHRlZERhdGEgKyBpdik7XHJcblxyXG4gICAgICAgICAgICAgICAgX3RoaXMuY3J5cHRvLnZlcmlmeUhNQUMoY2hhdEtleXMua2V5cy5oeXBlcnR5VG9IYXNoS2V5LCBmaWx0ZXJlZE1lc3NhZ2UsIGhhc2gpLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgLy9sb2cubG9nKCdyZXN1bHQgb2YgaGFzaCB2ZXJpZmljYXRpb24hICcsIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2UuYm9keS5hc3NlcnRlZElkZW50aXR5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0hhbmRTaGFrZVR5cGUpIHtcclxuICAgICAgICAgICAgICBfdGhpcy5fZG9IYW5kU2hha2VQaGFzZShtZXNzYWdlLCBjaGF0S2V5cykudGhlbihmdW5jdGlvbih2YWx1ZSkge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vaWYgaXQgd2FzIHN0YXJ0ZWQgYnkgZG9NdXR1YWxBdXRoZW50aWNhdGlvbiB0aGVuIGVuZHMgdGhlIHByb3RvY29sXHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICdoYW5kU2hha2VFbmQnKSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vcmVqZWN0KCdkZWNyeXB0IGhhbmRzaGFrZSBwcm90b2NvbCBwaGFzZScpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgLy8gaWYgd2FzIHN0YXJ0ZWQgYnkgYSBtZXNzYWdlLCB0aGVuIHJlc2VuZCB0aGF0IG1lc3NhZ2VcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIF90aGlzLmNoYXRLZXlzW21lc3NhZ2UudG8gKyAnPC0+JyArIG1lc3NhZ2UuZnJvbV0gPSB2YWx1ZS5jaGF0S2V5cztcclxuICAgICAgICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UodmFsdWUubWVzc2FnZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAvL3JlamVjdCgnZGVjcnlwdCBoYW5kc2hha2UgcHJvdG9jb2wgcGhhc2UgJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KCd3cm9uZyBtZXNzYWdlIGRvIGRlY3J5cHQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KCdlcnJvciBvbiBkZWNyeXB0IG1lc3NhZ2UnKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvL2lmIGZyb20gaHlwZXJ0eSB0byBhIGRhdGFPYmplY3RVUkxcclxuICAgICAgICB9IGVsc2UgaWYgKGlzRnJvbUh5cGVydHkgJiYgaXNUb0RhdGFPYmplY3QpIHtcclxuICAgICAgICAgIC8vIGxvZy5sb2coJ2RhdGFPYmplY3QgdmFsdWUgdG8gZGVjcnlwdDogJywgbWVzc2FnZS5ib2R5KTtcclxuXHJcbiAgICAgICAgICBfdGhpcy5zdG9yYWdlTWFuYWdlci5nZXQoJ2RhdGFPYmplY3RTZXNzaW9uS2V5cycpLnRoZW4oKHNlc3Npb25LZXlzKSA9PiB7XHJcbiAgICAgICAgICAgIHNlc3Npb25LZXlzID0gY2hhdGtleXNUb0FycmF5Q2xvbmVyKHNlc3Npb25LZXlzIHx8IHt9KTtcclxuICAgICAgICAgICAgbGV0IGRhdGFPYmplY3RLZXkgPSBzZXNzaW9uS2V5cyA/IHNlc3Npb25LZXlzW2RhdGFPYmplY3RVUkxdIDogbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGlmIChkYXRhT2JqZWN0S2V5KSB7XHJcblxyXG4gICAgICAgICAgICAgIC8vY2hlY2sgaWYgaXMgdG8gYXBwbHkgZW5jcnlwdGlvblxyXG4gICAgICAgICAgICAgIGlmIChkYXRhT2JqZWN0S2V5LmlzVG9FbmNyeXB0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGFyc2VkVmFsdWUgPSBwYXJzZShtZXNzYWdlLmJvZHkudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGl2ID0gZGVjb2RlVG9VaW50OEFycmF5KHBhcnNlZFZhbHVlLml2KTtcclxuICAgICAgICAgICAgICAgIGxldCBlbmNyeXB0ZWRWYWx1ZSA9IGRlY29kZVRvVWludDhBcnJheShwYXJzZWRWYWx1ZS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgaGFzaCA9IGRlY29kZVRvVWludDhBcnJheShwYXJzZWRWYWx1ZS5oYXNoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jcnlwdG8uZGVjcnlwdEFFUyhkYXRhT2JqZWN0S2V5LnNlc3Npb25LZXksIGVuY3J5cHRlZFZhbHVlLCBpdikudGhlbihkZWNyeXB0ZWRWYWx1ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGxldCBwYXJzZWRWYWx1ZSA9IHBhcnNlKGRlY3J5cHRlZFZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgIC8vIGxvZy5sb2coJ2RlY3J5cHRlZCBWYWx1ZSwnLCBwYXJzZWRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2UuYm9keS52YWx1ZSA9IHBhcnNlZFZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgbGV0IGZpbHRlcmVkTWVzc2FnZSA9IF90aGlzLl9maWx0ZXJNZXNzYWdlVG9IYXNoKG1lc3NhZ2UsIHN0cmluZ2lmeShwYXJzZWRWYWx1ZSkgKyBzdHJpbmdpZnkoaXYpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgIF90aGlzLmNyeXB0by52ZXJpZnlITUFDKGRhdGFPYmplY3RLZXkuc2Vzc2lvbktleSwgZmlsdGVyZWRNZXNzYWdlLCBoYXNoKS50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nLmxvZygnUmVjZWl2ZWQgbWVzc2FnZSBITUFDIHJlc3VsdCcsIHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UuYm9keS5hc3NlcnRlZElkZW50aXR5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4geyByZWplY3QoJ01lc3NhZ2UgSE1BQyBpcyBpbnZhbGlkOiAnICsgZXJyKTsgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL2lmIG5vdCwganVzdCByZXR1cm4gdGhlIG1lc3NhZ2VcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZS5ib2R5LmFzc2VydGVkSWRlbnRpdHkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIG1lc3NhZ2UuYm9keS5hc3NlcnRlZElkZW50aXR5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UpO1xyXG5cclxuICAgICAgICAgICAgICAvL3JlamVjdCgnbm8gc2Vzc2lvbktleSBmb3IgY2hhdCByb29tIGZvdW5kJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVqZWN0KCd3cm9uZyBtZXNzYWdlIHRvIGRlY3J5cHQnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVjcnlwdERhdGFPYmplY3QoZGF0YU9iamVjdCwgc2VuZGVyKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgLy9pZiBpcyBub3QgdG8gYXBwbHkgZW5jcnlwdGlvbiwgdGhlbiByZXR1cm5zIHJlc29sdmVcclxuICAgICAgaWYgKCFfdGhpcy5pc1RvVXNlRW5jcnlwdGlvbikge1xyXG4gICAgICAgIC8vIGxvZy5sb2coJ2RlY3J5cHRpb24gZGlzYWJsZWQnKTtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShkYXRhT2JqZWN0KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGRhdGFPYmplY3RVUkwgPSBwYXJzZU1lc3NhZ2VVUkwoc2VuZGVyKTtcclxuXHJcbiAgICAgIC8vIGxvZy5sb2coJ2RhdGFPYmplY3QgdmFsdWUgdG8gZGVjcnlwdDogJywgZGF0YU9iamVjdCk7XHJcblxyXG4gICAgICBfdGhpcy5zdG9yYWdlTWFuYWdlci5nZXQoJ2RhdGFPYmplY3RTZXNzaW9uS2V5cycpLnRoZW4oKHNlc3Npb25LZXlzKSA9PiB7XHJcbiAgICAgICAgc2Vzc2lvbktleXMgPSBjaGF0a2V5c1RvQXJyYXlDbG9uZXIoc2Vzc2lvbktleXMpO1xyXG4gICAgICAgIGxldCBkYXRhT2JqZWN0S2V5ID0gc2Vzc2lvbktleXMgPyBzZXNzaW9uS2V5c1tkYXRhT2JqZWN0VVJMXSA6IG51bGw7XHJcblxyXG4gICAgICAgIGlmIChkYXRhT2JqZWN0S2V5KSB7XHJcblxyXG4gICAgICAgICAgLy9jaGVjayBpZiBpcyB0byBhcHBseSBlbmNyeXB0aW9uXHJcbiAgICAgICAgICBpZiAoZGF0YU9iamVjdEtleS5pc1RvRW5jcnlwdCkge1xyXG4gICAgICAgICAgICBsZXQgaXYgPSBkZWNvZGVUb1VpbnQ4QXJyYXkoZGF0YU9iamVjdC5pdik7XHJcbiAgICAgICAgICAgIGxldCBlbmNyeXB0ZWRWYWx1ZSA9IGRlY29kZVRvVWludDhBcnJheShkYXRhT2JqZWN0LnZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgIF90aGlzLmNyeXB0by5kZWNyeXB0QUVTKGRhdGFPYmplY3RLZXkuc2Vzc2lvbktleSwgZW5jcnlwdGVkVmFsdWUsIGl2KS50aGVuKGRlY3J5cHRlZFZhbHVlID0+IHtcclxuICAgICAgICAgICAgICBsZXQgcGFyc2VkVmFsdWUgPSBwYXJzZShkZWNyeXB0ZWRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgbGV0IG5ld1ZhbHVlID0geyB2YWx1ZTogcGFyc2VkVmFsdWUsIGl2OiBlbmNvZGUoaXYpIH07XHJcblxyXG4gICAgICAgICAgICAgIC8vIGxvZy5sb2coJ2RlY3J5cHRlZCBkYXRhT2JqZWN0LCcsIG5ld1ZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUobmV3VmFsdWUpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4geyByZWplY3QoJ09uIGRlY3J5cHREYXRhT2JqZWN0IGZyb20gbWV0aG9kIGVuY3J5cHRBRVMgZXJyb3I6ICcgKyBlcnIpOyB9KTtcclxuXHJcbiAgICAgICAgICAvL2lmIG5vdCwganVzdCByZXR1cm4gdGhlIGRhdGFPYmplY3RcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGxvZy5sb2coJ1RoZSBkYXRhT2JqZWN0IGlzIG5vdCBlbmNyeXB0ZWQnKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoZGF0YU9iamVjdCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KCdObyBkYXRhT2JqZWN0S2V5IGZvciB0aGlzIGRhdGFPYmplY3RVUkw6JywgZGF0YU9iamVjdFVSTCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2RvTXV0dWFsQXV0aGVudGljYXRpb25QaGFzZTEobWVzc2FnZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgbGV0IHRvID0gbWVzc2FnZS50by5zcGxpdCgnLycpO1xyXG5cclxuICAgICAgLy9sZXQgc3Vic0luZGV4ID0gdG8uaW5kZXhPZignc3Vic2NyaXB0aW9uJyk7XHJcbiAgICAgIC8vbGV0IGlzRGF0YU9iamVjdFN1YnNjcmlwdGlvbiA9IHN1YnNJbmRleCAhPT0gLTE7XHJcbiAgICAgIHRvLnBvcCgpO1xyXG4gICAgICBsZXQgZGF0YU9iamVjdFVSTCA9IHRvWzBdICsgJy8vJyArIHRvWzJdICsgJy8nICsgdG9bM107XHJcbiAgICAgIF90aGlzLl9kb011dHVhbEF1dGhlbnRpY2F0aW9uUGhhc2UyKGRhdGFPYmplY3RVUkwsIG1lc3NhZ2UuYm9keS5zdWJzY3JpYmVyKS50aGVuKCgpID0+IHtcclxuICAgICAgICBfdGhpcy5fcmVnaXN0cnkucmVnaXN0ZXJTdWJzY3JpYmVyKGRhdGFPYmplY3RVUkwsIG1lc3NhZ2UuYm9keS5zdWJzY3JpYmVyKTtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZG9NdXR1YWxBdXRoZW50aWNhdGlvblBoYXNlMihzZW5kZXIsIHJlY2VpdmVyKSB7XHJcbiAgICBsb2cuaW5mbygnZG9NdXR1YWxBdXRoZW50aWNhdGlvbjpzZW5kZXIgJywgc2VuZGVyKTtcclxuICAgIGxvZy5pbmZvKCdkb011dHVhbEF1dGhlbnRpY2F0aW9uOnJlY2VpdmVyICcsIHJlY2VpdmVyKTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IGRhdGFPYmplY3RVUkw7XHJcblxyXG4gICAgICAvLyBjaGVjayBpZiB0aGUgc2VuZGVyIGlzIGEgZGF0YU9iamVjdCBhbmQgaWYgc28gc3RvcmVzIHRoYXQgdmFsdWVcclxuICAgICAgbGV0IHJlcG9ydGVyVVJMID0gX3RoaXMuX3JlZ2lzdHJ5LmdldFJlcG9ydGVyVVJMU3luY2hvbm91cyhzZW5kZXIpO1xyXG4gICAgICBpZiAocmVwb3J0ZXJVUkwpIHtcclxuICAgICAgICBkYXRhT2JqZWN0VVJMID0gc2VuZGVyO1xyXG4gICAgICAgIHNlbmRlciA9IHJlcG9ydGVyVVJMO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgbXNnID0ge1xyXG4gICAgICAgIHRvOiByZWNlaXZlcixcclxuICAgICAgICBmcm9tOiBzZW5kZXIsXHJcbiAgICAgICAgY2FsbGJhY2s6IHVuZGVmaW5lZCxcclxuICAgICAgICBib2R5OiB7aGFuZHNoYWtlUGhhc2U6ICdzdGFydEhhbmRTaGFrZScsIGlnbm9yZTogJ2lnbm9yZU1lc3NhZ2UnfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWYgKCFzZW5kZXIgfHwgIXJlY2VpdmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdCgnc2VuZGVyIG9yIHJlY2VpdmVyIG1pc3Npbmcgb24gZG9NdXR1YWxBdXRoZW50aWNhdGlvbicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgY2hhdEtleXMgPSBfdGhpcy5jaGF0S2V5c1tzZW5kZXIgKyAnPC0+JyArIHJlY2VpdmVyXTtcclxuICAgICAgbGV0IHVzZXJVUkwgPSBfdGhpcy5fcmVnaXN0cnkuZ2V0SHlwZXJ0eU93bmVyKHNlbmRlcik7XHJcblxyXG4gICAgICBpZiAodXNlclVSTCkge1xyXG5cclxuICAgICAgICBpZiAoIWNoYXRLZXlzKSB7XHJcbiAgICAgICAgICAvLyBjYWxsYmFjayB0byByZXNvbHZlIHdoZW4gZmluaXNoIHRoZSBtdXR1YWwgYXV0aGVudGljYXRpb25cclxuICAgICAgICAgIGxldCByZXNvbHZlZCA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIC8vIGxvZy5sb2coJ2NhbGxiYWNrIHZhbHVlOicsIHZhbHVlKTtcclxuICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgbXNnLmNhbGxiYWNrID0gcmVzb2x2ZWQ7XHJcbiAgICAgICAgICBtc2cuZGF0YU9iamVjdFVSTCA9IGRhdGFPYmplY3RVUkw7XHJcblxyXG4gICAgICAgICAgY2hhdEtleXMgPSBfdGhpcy5fbmV3Q2hhdENyeXB0byhtc2csIHVzZXJVUkwpO1xyXG4gICAgICAgICAgX3RoaXMuY2hhdEtleXNbc2VuZGVyICsgJzwtPicgKyByZWNlaXZlcl0gPSBjaGF0S2V5cztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGF0S2V5cy5hdXRoZW50aWNhdGVkKSB7XHJcblxyXG4gICAgICAgICAgbGV0IHN0YXJ0U2Vzc2lvbktleUV4Y2hhbmdlID0ge1xyXG4gICAgICAgICAgICB0bzogc2VuZGVyLFxyXG4gICAgICAgICAgICBmcm9tOiByZWNlaXZlclxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGNoYXRLZXlzLmRhdGFPYmplY3RVUkwgPSBkYXRhT2JqZWN0VVJMO1xyXG4gICAgICAgICAgX3RoaXMuX3NlbmRSZXBvcnRlclNlc3Npb25LZXkoc3RhcnRTZXNzaW9uS2V5RXhjaGFuZ2UsIGNoYXRLZXlzKS50aGVuKHZhbHVlID0+IHtcclxuXHJcbiAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHZhbHVlLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICByZXNvbHZlKCdleGNoYW5nZSBvZiBjaGF0IHNlc3Npb25LZXkgaW5pdGlhdGVkJyk7XHJcbiAgICAgICAgICB9KS5jYXRjaChlcnIgPT4geyByZWplY3QoJ09uIGRvTXV0dWFsQXV0aGVudGljYXRpb24gZnJvbSBtZXRob2QgX3NlbmRSZXBvcnRlclNlc3Npb25LZXkgZXJyb3I6ICcgKyBlcnIpOyB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgX3RoaXMuX2RvSGFuZFNoYWtlUGhhc2UobXNnLCBjaGF0S2V5cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlamVjdCgnTXV0dWFsIGF1dGhlbnRpY2F0aW9uIGVycm9yOiBIeXBlcnR5IG93bmVyIGNvdWxkIG5vdCBiZSByZXNvbHZlZCcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgKiByZXR1cm5zIHRoZSByZXBvcnRlciBhc3NvY2lhdGVkIHRvIHRoZSBkYXRhT2JqZWN0IFVSTFxyXG4gICogQHBhcmFtICAge1N0cmluZ30gICBkYXRhT2JqZWN0VVJMICAgICAgICAgZGF0YU9iamVjdCB1cmxcclxuICAqIEByZXR1cm4gICB7U3RyaW5nfSAgcmVwb3J0ZXIgICAgICAgICAgICAgIGRhdGFPYmplY3QgdXJsIHJlcG9ydGVyXHJcbiAgKi9cclxuICAvKiAgX2dldEh5cGVydHlGcm9tRGF0YU9iamVjdChkYXRhT2JqZWN0VVJMKSB7XHJcbiAgICBsb2cuaW5mbygnX2dldEh5cGVydHlGcm9tRGF0YU9iamVjdDpkYXRhT2JqZWN0VVJMJywgZGF0YU9iamVjdFVSTCk7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGxldCBzcGxpdGVkVVJMID0gZGl2aWRlVVJMKGRhdGFPYmplY3RVUkwpO1xyXG4gICAgICBsZXQgZG9tYWluID0gc3BsaXRlZFVSTC5kb21haW47XHJcbiAgICAgIGxldCBmaW5hbFVSTCA9IF90aGlzLl9wYXJzZU1lc3NhZ2VVUkwoZGF0YU9iamVjdFVSTCk7XHJcblxyXG4gICAgICAvLyBjaGVjayBpZiBpcyB0aGUgY3JlYXRvciBvZiB0aGUgaHlwZXJ0eVxyXG4gICAgICBsZXQgcmVwb3J0ZXJVUkwgPSBfdGhpcy5yZWdpc3RyeS5nZXRSZXBvcnRlclVSTFN5bmNob25vdXMoZmluYWxVUkwpO1xyXG4gICAgICBsb2cuaW5mbygnX2dldEh5cGVydHlGcm9tRGF0YU9iamVjdDpyZXBvcnRlclVSTCcsIHJlcG9ydGVyVVJMKTtcclxuXHJcbiAgICAgIGlmIChyZXBvcnRlclVSTCkge1xyXG4gICAgICAgIHJlc29sdmUocmVwb3J0ZXJVUkwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIGFscmVhZHkgYW4gYXNzb2NpYXRpb24gZnJvbSBhbiBoeXBlcnR5VVJMIHRvIHRoZSBkYXRhT2JqZWN0XHJcbiAgICAgICAgbGV0IHN0b3JlZFJlcG9ydGVyVVJMID0gX3RoaXMuZGF0YU9iamVjdHNJZGVudGl0eVtmaW5hbFVSTF07XHJcbiAgICAgICAgbG9nLmluZm8oJ19nZXRIeXBlcnR5RnJvbURhdGFPYmplY3Q6c3RvcmVkUmVwb3J0ZXJVUkwnLCBzdG9yZWRSZXBvcnRlclVSTCk7XHJcblxyXG4gICAgICAgIGlmIChzdG9yZWRSZXBvcnRlclVSTCkge1xyXG4gICAgICAgICAgcmVzb2x2ZShzdG9yZWRSZXBvcnRlclVSTCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIGFueSBoeXBlcnR5IHRoYXQgc3Vic2NyaWJlZCB0aGUgZGF0YU9iamVjdFVSTFxyXG4gICAgICAgICAgbGV0IHN1YnNjcmliZXJIeXBlcnR5ID0gX3RoaXMucmVnaXN0cnkuZ2V0RGF0YU9iamVjdFN1YnNjcmliZXJIeXBlcnR5KGRhdGFPYmplY3RVUkwpO1xyXG4gICAgICAgICAgbG9nLmluZm8oJ19nZXRIeXBlcnR5RnJvbURhdGFPYmplY3Q6c3Vic2NyaWJlckh5cGVydHknLCBzdWJzY3JpYmVySHlwZXJ0eSk7XHJcblxyXG4gICAgICAgICAgaWYgKHN1YnNjcmliZXJIeXBlcnR5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoc3Vic2NyaWJlckh5cGVydHkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gc2VhcmNoIGluIGRvbWFpbiByZWdpc3RyeSBmb3IgdGhlIGh5cGVydHkgYXNzb2NpYXRlZCB0byB0aGUgZGF0YU9iamVjdFxyXG4gICAgICAgICAgICAvLyBzZWFyY2ggaW4gY2FzZSBpcyBhIHN1YnNjcmliZXIgd2hvIHdhbnRzIHRvIGtub3cgdGhlIHJlcG9ydGVyXHJcbiAgICAgICAgICAgIF90aGlzLl9jb3JlRGlzY292ZXJ5LmRpc2NvdmVyRGF0YU9iamVjdFBlclVSTChmaW5hbFVSTCwgZG9tYWluKS50aGVuKGRhdGFPYmplY3QgPT4ge1xyXG4gICAgICAgICAgICAgIGxvZy5pbmZvKCdfZ2V0SHlwZXJ0eUZyb21EYXRhT2JqZWN0OmRhdGFPYmplY3QnLCBkYXRhT2JqZWN0KTtcclxuICAgICAgICAgICAgICBfdGhpcy5kYXRhT2JqZWN0c0lkZW50aXR5W2ZpbmFsVVJMXSA9IGRhdGFPYmplY3QucmVwb3J0ZXI7XHJcbiAgICAgICAgICAgICAgbG9nLmluZm8oJ19nZXRIeXBlcnR5RnJvbURhdGFPYmplY3Q6ZGF0YU9iamVjdC5yZXBvcnRlcicsIGRhdGFPYmplY3QucmVwb3J0ZXIpO1xyXG4gICAgICAgICAgICAgIHJlc29sdmUoZGF0YU9iamVjdC5yZXBvcnRlcik7XHJcbiAgICAgICAgICAgIH0sIGVyciA9PiB7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSovXHJcblxyXG4gIF9zZW5kUmVwb3J0ZXJTZXNzaW9uS2V5KG1lc3NhZ2UsIGNoYXRLZXlzKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGxldCBzZXNzaW9uS2V5QnVuZGxlID0gX3RoaXMuZGF0YU9iamVjdFNlc3Npb25LZXlzW2NoYXRLZXlzLmRhdGFPYmplY3RVUkxdO1xyXG4gICAgICBsZXQgcmVwb3J0ZXJTZXNzaW9uS2V5TXNnO1xyXG4gICAgICBsZXQgdmFsdWVUb0VuY3J5cHQ7XHJcbiAgICAgIGxldCBzZXNzaW9uS2V5O1xyXG4gICAgICBsZXQgaXY7XHJcbiAgICAgIGxldCB2YWx1ZSA9IHt9O1xyXG5cclxuICAgICAgLy9pZiB0aGVyZSBpcyBub3QgeWV0IGEgc2Vzc2lvbiBLZXksIGdlbmVyYXRlcyBhIG5ldyBvbmVcclxuICAgICAgaWYgKCFzZXNzaW9uS2V5QnVuZGxlKSB7XHJcbiAgICAgICAgc2Vzc2lvbktleSA9IF90aGlzLmNyeXB0by5nZW5lcmF0ZVJhbmRvbSgpO1xyXG4gICAgICAgIF90aGlzLmRhdGFPYmplY3RTZXNzaW9uS2V5c1tjaGF0S2V5cy5kYXRhT2JqZWN0VVJMXSA9IHtzZXNzaW9uS2V5OiBzZXNzaW9uS2V5LCBpc1RvRW5jcnlwdDogdHJ1ZX07XHJcblxyXG4gICAgICAgIGxldCBkYXRhT2JqZWN0U2Vzc2lvbktleXNDbG9uZSA9IGNoYXRrZXlzVG9TdHJpbmdDbG9uZXIoX3RoaXMuZGF0YU9iamVjdFNlc3Npb25LZXlzKTtcclxuXHJcbiAgICAgICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIuc2V0KCdkYXRhT2JqZWN0U2Vzc2lvbktleXMnLCAwLCBkYXRhT2JqZWN0U2Vzc2lvbktleXNDbG9uZSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgIHJlamVjdCgnT24gX3NlbmRSZXBvcnRlclNlc3Npb25LZXkgZnJvbSBtZXRob2Qgc3RvcmFnZU1hbmFnZXIuc2V0KGRhdGFPYmplY3RTZXNzaW9uS2V5cy4uLikgZXJyb3I6ICcgKyBlcnIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzZXNzaW9uS2V5ID0gc2Vzc2lvbktleUJ1bmRsZS5zZXNzaW9uS2V5O1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIHZhbHVlVG9FbmNyeXB0ID0gZW5jb2RlKHt2YWx1ZTogZW5jb2RlKHNlc3Npb25LZXkpLCBkYXRhT2JqZWN0VVJMOiBjaGF0S2V5cy5kYXRhT2JqZWN0VVJMfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIHJldHVybiByZWplY3QoJ09uIF9zZW5kUmVwb3J0ZXJTZXNzaW9uS2V5IGZyb20gbWV0aG9kIHN0b3JhZ2VNYW5hZ2VyLnNldCBlcnJvciB2YWx1ZVRvRW5jcnlwdDogJyArIGVycik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGl2ID0gX3RoaXMuY3J5cHRvLmdlbmVyYXRlSVYoKTtcclxuICAgICAgdmFsdWUuaXYgPSBlbmNvZGUoaXYpO1xyXG4gICAgICBfdGhpcy5jcnlwdG8uZW5jcnlwdEFFUyhjaGF0S2V5cy5rZXlzLmh5cGVydHlGcm9tU2Vzc2lvbktleSwgdmFsdWVUb0VuY3J5cHQsIGl2KS50aGVuKGVuY3J5cHRlZFZhbHVlID0+IHtcclxuXHJcbiAgICAgICAgcmVwb3J0ZXJTZXNzaW9uS2V5TXNnID0ge1xyXG4gICAgICAgICAgdHlwZTogJ2hhbmRzaGFrZScsXHJcbiAgICAgICAgICB0bzogbWVzc2FnZS5mcm9tLFxyXG4gICAgICAgICAgZnJvbTogbWVzc2FnZS50byxcclxuICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgaGFuZHNoYWtlUGhhc2U6ICdyZXBvcnRlclNlc3Npb25LZXknLFxyXG4gICAgICAgICAgICB2YWx1ZTogZW5jb2RlKGVuY3J5cHRlZFZhbHVlKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGxldCBmaWx0ZXJlZE1lc3NhZ2UgPSBfdGhpcy5fZmlsdGVyTWVzc2FnZVRvSGFzaChyZXBvcnRlclNlc3Npb25LZXlNc2csIHZhbHVlVG9FbmNyeXB0ICsgaXYsIGNoYXRLZXlzLmh5cGVydHlGcm9tLm1lc3NhZ2VJbmZvKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIF90aGlzLmNyeXB0by5oYXNoSE1BQyhjaGF0S2V5cy5rZXlzLmh5cGVydHlGcm9tSGFzaEtleSwgZmlsdGVyZWRNZXNzYWdlKTtcclxuICAgICAgfSkudGhlbihoYXNoZWRNZXNzYWdlID0+IHtcclxuICAgICAgICBsZXQgdmFsdWVXaXRoSGFzaCA9IGVuY29kZSh7dmFsdWU6IHJlcG9ydGVyU2Vzc2lvbktleU1zZy5ib2R5LnZhbHVlLCBoYXNoOiBlbmNvZGUoaGFzaGVkTWVzc2FnZSksIGl2OiB2YWx1ZS5pdn0pO1xyXG5cclxuICAgICAgICByZXBvcnRlclNlc3Npb25LZXlNc2cuYm9keS52YWx1ZSA9IHZhbHVlV2l0aEhhc2g7XHJcblxyXG4gICAgICAgIHJlc29sdmUoe21lc3NhZ2U6IHJlcG9ydGVyU2Vzc2lvbktleU1zZywgY2hhdEtleXM6IGNoYXRLZXlzfSk7XHJcbiAgICAgIH0pLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgcmVqZWN0KCdPbiBfc2VuZFJlcG9ydGVyU2Vzc2lvbktleSBmcm9tIGNoYWluZWQgcHJvbWlzZXMgZW5jcnlwdEFFUyBlcnJvcjogJyArIGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIEZ1bmN0aW9uIHRoYXQgcmVzb2x2ZSBhbmQgY3JlYXRlIHRoZSBkb21haW5VUkwgaW4gY2FzZSBpdCBpcyBwcm92aWRlZCBvbmUuIElmIG5vdCwgcmVzb2x2ZSB0aGUgZGVmYXVsdCBkb21haW5VUkxcclxuICAqIEBwYXJhbSB7U3RyaW5nfSAgICAgaWRwRG9tYWluICAgICBpZHBEb21haW4gKE9wdGlvbmFsKVxyXG4gICovXHJcbiAgX3Jlc29sdmVEb21haW4oaWRwRG9tYWluKSB7XHJcbiAgICBpZiAoIWlkcERvbWFpbikge1xyXG4gICAgICByZXR1cm4gJ2RvbWFpbi1pZHA6Ly9nb29nbGUuY29tJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiAnZG9tYWluLWlkcDovLycgKyBpZHBEb21haW47XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZG9IYW5kU2hha2VQaGFzZShtZXNzYWdlLCBjaGF0S2V5cykge1xyXG4gIC8vIGxvZygnX2RvSGFuZFNoYWtlUGhhc2U6ZGF0YU9iamVjdCcsIG1lc3NhZ2UpO1xyXG4gIC8vXHRsb2coJ19kb0hhbmRTaGFrZVBoYXNlOmNoYXRLZXlzJywgY2hhdEtleXMpO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgbGV0IGhhbmRzaGFrZVR5cGUgPSBtZXNzYWdlLmJvZHkuaGFuZHNoYWtlUGhhc2U7XHJcbiAgICAgIGxldCBpdjtcclxuICAgICAgbGV0IGhhc2g7XHJcbiAgICAgIGxldCB2YWx1ZSA9IHt9O1xyXG4gICAgICBsZXQgZmlsdGVyZWRNZXNzYWdlO1xyXG4gICAgICBsZXQgcHJpdmF0ZUtleUhvbGRlcjtcclxuXHJcbiAgICAgIGxvZy5pbmZvKCdoYW5kc2hha2UgcGhhc2U6ICcsIGhhbmRzaGFrZVR5cGUpO1xyXG5cclxuICAgICAgc3dpdGNoIChoYW5kc2hha2VUeXBlKSB7XHJcblxyXG4gICAgICAgIGNhc2UgJ3N0YXJ0SGFuZFNoYWtlJzoge1xyXG4gICAgICAgICAgY2hhdEtleXMua2V5cy5mcm9tUmFuZG9tID0gX3RoaXMuY3J5cHRvLmdlbmVyYXRlUmFuZG9tKCk7XHJcbiAgICAgICAgICBsZXQgc3RhcnRIYW5kU2hha2VNc2cgPSB7XHJcbiAgICAgICAgICAgIHR5cGU6ICdoYW5kc2hha2UnLFxyXG4gICAgICAgICAgICB0bzogbWVzc2FnZS50byxcclxuICAgICAgICAgICAgZnJvbTogbWVzc2FnZS5mcm9tLFxyXG4gICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgaGFuZHNoYWtlUGhhc2U6ICdzZW5kZXJIZWxsbycsXHJcbiAgICAgICAgICAgICAgdmFsdWU6IGVuY29kZShjaGF0S2V5cy5rZXlzLmZyb21SYW5kb20pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBjaGF0S2V5cy5oYW5kc2hha2VIaXN0b3J5LnNlbmRlckhlbGxvID0gX3RoaXMuX2ZpbHRlck1lc3NhZ2VUb0hhc2goc3RhcnRIYW5kU2hha2VNc2csIHVuZGVmaW5lZCwgY2hhdEtleXMuaHlwZXJ0eUZyb20ubWVzc2FnZUluZm8pO1xyXG5cclxuICAgICAgICAgIC8vIGNoZWNrIGlmIHdhcyB0aGUgZW5jcnlwdCBmdW5jdGlvbiBvciB0aGUgbXV0dWFsIGF1dGhlbnRpY2F0aW9uIHRoYXQgcmVxdWVzdCB0aGVcclxuICAgICAgICAgIC8vIHN0YXJ0IG9mIHRoZSBoYW5kU2hha2VQaGFzZS5cclxuXHJcbiAgICAgICAgICBpZiAoY2hhdEtleXMuaW5pdGlhbE1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7bWVzc2FnZTogc3RhcnRIYW5kU2hha2VNc2csIGNoYXRLZXlzOiBjaGF0S2V5c30pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgX3RoaXMuY2hhdEtleXNbbWVzc2FnZS5mcm9tICsgJzwtPicgKyBtZXNzYWdlLnRvXSA9IGNoYXRLZXlzO1xyXG4gICAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShzdGFydEhhbmRTaGFrZU1zZyk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlICdzZW5kZXJIZWxsbyc6IHtcclxuXHJcbiAgICAgICAgICBsb2cubG9nKCdzZW5kZXJIZWxsbycpO1xyXG4gICAgICAgICAgY2hhdEtleXMuaGFuZHNoYWtlSGlzdG9yeS5zZW5kZXJIZWxsbyA9IF90aGlzLl9maWx0ZXJNZXNzYWdlVG9IYXNoKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgY2hhdEtleXMua2V5cy5mcm9tUmFuZG9tID0gZGVjb2RlVG9VaW50OEFycmF5KG1lc3NhZ2UuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICBjaGF0S2V5cy5rZXlzLnRvUmFuZG9tID0gX3RoaXMuY3J5cHRvLmdlbmVyYXRlUmFuZG9tKCk7XHJcblxyXG4gICAgICAgICAgbGV0IHNlbmRlckhlbGxvTXNnID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAnaGFuZHNoYWtlJyxcclxuICAgICAgICAgICAgdG86IG1lc3NhZ2UuZnJvbSxcclxuICAgICAgICAgICAgZnJvbTogbWVzc2FnZS50byxcclxuICAgICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICAgIGhhbmRzaGFrZVBoYXNlOiAncmVjZWl2ZXJIZWxsbycsXHJcbiAgICAgICAgICAgICAgdmFsdWU6IGVuY29kZShjaGF0S2V5cy5rZXlzLnRvUmFuZG9tKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgY2hhdEtleXMuaGFuZHNoYWtlSGlzdG9yeS5yZWNlaXZlckhlbGxvID0gX3RoaXMuX2ZpbHRlck1lc3NhZ2VUb0hhc2goc2VuZGVySGVsbG9Nc2csIHVuZGVmaW5lZCwgY2hhdEtleXMuaHlwZXJ0eUZyb20ubWVzc2FnZUluZm8pO1xyXG4gICAgICAgICAgcmVzb2x2ZSh7bWVzc2FnZTogc2VuZGVySGVsbG9Nc2csIGNoYXRLZXlzOiBjaGF0S2V5c30pO1xyXG5cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlICdyZWNlaXZlckhlbGxvJzoge1xyXG5cclxuICAgICAgICAgIGxvZy5sb2coJ3JlY2VpdmVySGVsbG8nKTtcclxuICAgICAgICAgIF90aGlzLmdldE15UHJpdmF0ZUtleSgpLnRoZW4ocHJpdmF0ZUtleSA9PntcclxuICAgICAgICAgICAgcHJpdmF0ZUtleUhvbGRlciA9IHByaXZhdGVLZXk7XHJcblxyXG4gICAgICAgICAgICBjaGF0S2V5cy5oYW5kc2hha2VIaXN0b3J5LnJlY2VpdmVySGVsbG8gPSBfdGhpcy5fZmlsdGVyTWVzc2FnZVRvSGFzaChtZXNzYWdlKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5faWRtLnZhbGlkYXRlQXNzZXJ0aW9uKG1lc3NhZ2UuYm9keS5pZGVudGl0eS5hc3NlcnRpb24sIHVuZGVmaW5lZCwgbWVzc2FnZS5ib2R5LmlkZW50aXR5LmlkcC5kb21haW4pO1xyXG4gICAgICAgICAgfSkudGhlbigodmFsdWUpID0+IHtcclxuXHJcbiAgICAgICAgICAgIC8vVE9ETyByZW1vdmUgbGF0ZXIgdGhpcyB2ZXJpZmljYXRpb24gYXMgc29vbiBhcyBhbGwgdGhlIElkUCBwcm94eSBhcmUgdXBkYXRlZCBpbiB0aGUgZXhhbXBsZVxyXG4gICAgICAgICAgICBsZXQgZW5jb2RlZHB1YmxpY0tleSA9ICh0eXBlb2YgdmFsdWUuY29udGVudHMgPT09ICdzdHJpbmcnKSA/IHZhbHVlLmNvbnRlbnRzIDogdmFsdWUuY29udGVudHMubm9uY2U7XHJcblxyXG4gICAgICAgICAgICBsZXQgcmVjZWl2ZXJQdWJsaWNLZXkgPSBwYXJzZVRvVWludDhBcnJheShlbmNvZGVkcHVibGljS2V5KTtcclxuICAgICAgICAgICAgbGV0IHByZW1hc3RlclNlY3JldCA9IF90aGlzLmNyeXB0by5nZW5lcmF0ZVBNUygpO1xyXG4gICAgICAgICAgICBsZXQgdG9SYW5kb20gPSBtZXNzYWdlLmJvZHkudmFsdWU7XHJcbiAgICAgICAgICAgIGNoYXRLZXlzLmh5cGVydHlUby5hc3NlcnRpb24gPSBtZXNzYWdlLmJvZHkuaWRlbnRpdHkuYXNzZXJ0aW9uO1xyXG4gICAgICAgICAgICBjaGF0S2V5cy5oeXBlcnR5VG8ucHVibGljS2V5ID0gcmVjZWl2ZXJQdWJsaWNLZXk7XHJcbiAgICAgICAgICAgIGNoYXRLZXlzLmh5cGVydHlUby51c2VySUQgICAgPSBtZXNzYWdlLmJvZHkuaWRlbnRpdHkudXNlclByb2ZpbGUudXNlclVSTDtcclxuICAgICAgICAgICAgY2hhdEtleXMua2V5cy50b1JhbmRvbSAgPSBkZWNvZGVUb1VpbnQ4QXJyYXkodG9SYW5kb20pO1xyXG4gICAgICAgICAgICBjaGF0S2V5cy5rZXlzLnByZW1hc3RlcktleSA9IHByZW1hc3RlclNlY3JldDtcclxuXHJcbiAgICAgICAgICAgIGxldCBjb25jYXRLZXkgPSBfdGhpcy5jcnlwdG8uY29uY2F0UE1Td2l0aFJhbmRvbXMocHJlbWFzdGVyU2VjcmV0LCBjaGF0S2V5cy5rZXlzLnRvUmFuZG9tLCBjaGF0S2V5cy5rZXlzLmZyb21SYW5kb20pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNyeXB0by5nZW5lcmF0ZU1hc3RlclNlY3JldChjb25jYXRLZXksICdtZXNzYWdlSGlzdG9yaWMnICsgY2hhdEtleXMua2V5cy50b1JhbmRvbSArIGNoYXRLZXlzLmtleXMuZnJvbVJhbmRvbSk7XHJcblxyXG4gICAgICAgICAgICAvL2dlbmVyYXRlIHRoZSBtYXN0ZXIga2V5XHJcbiAgICAgICAgICB9KS50aGVuKChtYXN0ZXJLZXkpID0+IHtcclxuICAgICAgICAgICAgY2hhdEtleXMua2V5cy5tYXN0ZXJLZXkgPSBtYXN0ZXJLZXk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY3J5cHRvLmdlbmVyYXRlS2V5cyhtYXN0ZXJLZXksICdrZXkgZXhwYW5zaW9uJyArIGNoYXRLZXlzLmtleXMudG9SYW5kb20gKyBjaGF0S2V5cy5rZXlzLmZyb21SYW5kb20pO1xyXG5cclxuICAgICAgICAgICAgLy9nZW5lcmF0ZSB0aGUgc3ltbWV0cmljIGFuZCBoYXNoIGtleXNcclxuICAgICAgICAgIH0pLnRoZW4oKGtleXMpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGNoYXRLZXlzLmtleXMuaHlwZXJ0eVRvU2Vzc2lvbktleSA9IG5ldyBVaW50OEFycmF5KGtleXNbMF0pO1xyXG4gICAgICAgICAgICBjaGF0S2V5cy5rZXlzLmh5cGVydHlGcm9tU2Vzc2lvbktleSA9IG5ldyBVaW50OEFycmF5KGtleXNbMV0pO1xyXG4gICAgICAgICAgICBjaGF0S2V5cy5rZXlzLmh5cGVydHlUb0hhc2hLZXkgPSBuZXcgVWludDhBcnJheShrZXlzWzJdKTtcclxuICAgICAgICAgICAgY2hhdEtleXMua2V5cy5oeXBlcnR5RnJvbUhhc2hLZXkgPSBuZXcgVWludDhBcnJheShrZXlzWzNdKTtcclxuICAgICAgICAgICAgaXYgPSBfdGhpcy5jcnlwdG8uZ2VuZXJhdGVJVigpO1xyXG4gICAgICAgICAgICB2YWx1ZS5pdiA9IGVuY29kZShpdik7XHJcblxyXG4gICAgICAgICAgICBsZXQgbWVzc2FnZVN0cnVjdHVyZSA9IHtcclxuICAgICAgICAgICAgICB0eXBlOiAnaGFuZHNoYWtlJyxcclxuICAgICAgICAgICAgICB0bzogbWVzc2FnZS5mcm9tLFxyXG4gICAgICAgICAgICAgIGZyb206IG1lc3NhZ2UudG8sXHJcbiAgICAgICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICAgICAgaGFuZHNoYWtlUGhhc2U6ICdzZW5kZXJDZXJ0aWZpY2F0ZSdcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBoYXNoIHRoZSB2YWx1ZSBhbmQgdGhlIGl2XHJcbiAgICAgICAgICAgIGZpbHRlcmVkTWVzc2FnZSA9IF90aGlzLl9maWx0ZXJNZXNzYWdlVG9IYXNoKG1lc3NhZ2VTdHJ1Y3R1cmUsICdvaycgKyBpdiwgY2hhdEtleXMuaHlwZXJ0eUZyb20ubWVzc2FnZUluZm8pO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY3J5cHRvLmhhc2hITUFDKGNoYXRLZXlzLmtleXMuaHlwZXJ0eUZyb21IYXNoS2V5LCBmaWx0ZXJlZE1lc3NhZ2UpO1xyXG4gICAgICAgICAgfSkudGhlbigoaGFzaCkgPT4ge1xyXG4gICAgICAgICAgICB2YWx1ZS5oYXNoID0gZW5jb2RlKGhhc2gpO1xyXG5cclxuICAgICAgICAgICAgLy9lbmNyeXB0IHRoZSBkYXRhXHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5jcnlwdG8uZW5jcnlwdEFFUyhjaGF0S2V5cy5rZXlzLmh5cGVydHlGcm9tU2Vzc2lvbktleSwgJ29rJywgaXYpO1xyXG4gICAgICAgICAgfSkudGhlbigoZW5jcnlwdGVkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICB2YWx1ZS5zeW1ldHJpY0VuY3J5cHRpb24gPSBlbmNvZGUoZW5jcnlwdGVkRGF0YSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY3J5cHRvLmVuY3J5cHRSU0EoY2hhdEtleXMuaHlwZXJ0eVRvLnB1YmxpY0tleSwgY2hhdEtleXMua2V5cy5wcmVtYXN0ZXJLZXkpO1xyXG5cclxuICAgICAgICAgIH0pLnRoZW4oKGVuY3J5cHRlZFZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIHZhbHVlLmFzc3ltZXRyaWNFbmNyeXB0aW9uID0gZW5jb2RlKGVuY3J5cHRlZFZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBtZXNzYWdlU3RydWN0dXJlID0ge1xyXG4gICAgICAgICAgICAgIHR5cGU6ICdoYW5kc2hha2UnLFxyXG4gICAgICAgICAgICAgIHRvOiBtZXNzYWdlLmZyb20sXHJcbiAgICAgICAgICAgICAgZnJvbTogbWVzc2FnZS50byxcclxuICAgICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICBoYW5kc2hha2VQaGFzZTogJ3NlbmRlckNlcnRpZmljYXRlJ1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGxldCBtZXNzYWdlVG9IYXNoID0gX3RoaXMuX2ZpbHRlck1lc3NhZ2VUb0hhc2gobWVzc2FnZVN0cnVjdHVyZSwgY2hhdEtleXMua2V5cy5wcmVtYXN0ZXJLZXksIGNoYXRLZXlzLmh5cGVydHlGcm9tLm1lc3NhZ2VJbmZvKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNyeXB0by5zaWduUlNBKHByaXZhdGVLZXlIb2xkZXIsIGVuY29kZShjaGF0S2V5cy5oYW5kc2hha2VIaXN0b3J5KSArIGVuY29kZShtZXNzYWdlVG9IYXNoKSk7XHJcbiAgICAgICAgICB9KS50aGVuKHNpZ25hdHVyZSA9PiB7XHJcblxyXG4gICAgICAgICAgICB2YWx1ZS5zaWduYXR1cmUgPSBlbmNvZGUoc2lnbmF0dXJlKTtcclxuXHJcbiAgICAgICAgICAgIGxldCByZWNlaXZlckhlbGxvTXNnID0ge1xyXG4gICAgICAgICAgICAgIHR5cGU6ICdoYW5kc2hha2UnLFxyXG4gICAgICAgICAgICAgIHRvOiBtZXNzYWdlLmZyb20sXHJcbiAgICAgICAgICAgICAgZnJvbTogbWVzc2FnZS50byxcclxuICAgICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICBoYW5kc2hha2VQaGFzZTogJ3NlbmRlckNlcnRpZmljYXRlJyxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBlbmNvZGUodmFsdWUpXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjaGF0S2V5cy5oYW5kc2hha2VIaXN0b3J5LnNlbmRlckNlcnRpZmljYXRlID0gX3RoaXMuX2ZpbHRlck1lc3NhZ2VUb0hhc2gocmVjZWl2ZXJIZWxsb01zZywgJ29rJyArIGl2LCBjaGF0S2V5cy5oeXBlcnR5RnJvbS5tZXNzYWdlSW5mbyk7XHJcblxyXG4gICAgICAgICAgICByZXNvbHZlKHttZXNzYWdlOiByZWNlaXZlckhlbGxvTXNnLCBjaGF0S2V5czogY2hhdEtleXN9KTtcclxuXHJcbiAgICAgICAgICB9LCBlcnJvciA9PiByZWplY3QoZXJyb3IpKTtcclxuXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FzZSAnc2VuZGVyQ2VydGlmaWNhdGUnOiB7XHJcblxyXG4gICAgICAgICAgbG9nLmxvZygnc2VuZGVyQ2VydGlmaWNhdGUnKTtcclxuXHJcbiAgICAgICAgICBsZXQgcmVjZWl2ZWRWYWx1ZSA9IGRlY29kZShtZXNzYWdlLmJvZHkudmFsdWUpO1xyXG5cclxuICAgICAgICAgIF90aGlzLmdldE15UHJpdmF0ZUtleSgpLnRoZW4ocHJpdmF0ZUtleSA9PntcclxuICAgICAgICAgICAgcHJpdmF0ZUtleUhvbGRlciA9IHByaXZhdGVLZXk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuX2lkbS52YWxpZGF0ZUFzc2VydGlvbihtZXNzYWdlLmJvZHkuaWRlbnRpdHkuYXNzZXJ0aW9uLCB1bmRlZmluZWQsIG1lc3NhZ2UuYm9keS5pZGVudGl0eS5pZHAuZG9tYWluKTtcclxuICAgICAgICAgIH0pLnRoZW4oKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBlbmNyeXB0ZWRQTVMgPSBkZWNvZGVUb1VpbnQ4QXJyYXkocmVjZWl2ZWRWYWx1ZS5hc3N5bWV0cmljRW5jcnlwdGlvbik7XHJcblxyXG4gICAgICAgICAgICAvL1RPRE8gcmVtb3ZlIGxhdGVyIHRoaXMgdmVyaWZpY2F0aW9uIGFzIHNvb24gYXMgYWxsIHRoZSBJZFAgcHJveHkgYXJlIHVwZGF0ZWQgaW4gdGhlIGV4YW1wbGVcclxuICAgICAgICAgICAgbGV0IGVuY29kZWRwdWJsaWNLZXkgPSAodHlwZW9mIHZhbHVlLmNvbnRlbnRzID09PSAnc3RyaW5nJykgPyB2YWx1ZS5jb250ZW50cyA6IHZhbHVlLmNvbnRlbnRzLm5vbmNlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNlbmRlclB1YmxpY0tleSA9IHBhcnNlVG9VaW50OEFycmF5KGVuY29kZWRwdWJsaWNLZXkpO1xyXG4gICAgICAgICAgICBjaGF0S2V5cy5oeXBlcnR5VG8uYXNzZXJ0aW9uID0gbWVzc2FnZS5ib2R5LmlkZW50aXR5LmFzc2VydGlvbjtcclxuICAgICAgICAgICAgY2hhdEtleXMuaHlwZXJ0eVRvLnB1YmxpY0tleSA9IHNlbmRlclB1YmxpY0tleTtcclxuICAgICAgICAgICAgY2hhdEtleXMuaHlwZXJ0eVRvLnVzZXJJRCAgICA9IG1lc3NhZ2UuYm9keS5pZGVudGl0eS51c2VyUHJvZmlsZS51c2VyVVJMO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNyeXB0by5kZWNyeXB0UlNBKHByaXZhdGVLZXlIb2xkZXIsIGVuY3J5cHRlZFBNUyk7XHJcblxyXG4gICAgICAgICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGxvZy5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICByZWplY3QoJ0Vycm9yIGR1cmluZyBhdXRoZW50aWNhdGlvbiBvZiBpZGVudGl0eTogJywgZXJyb3IubWVzc2FnZSk7XHJcblxyXG4gICAgICAgICAgICAvL29idGFpbiB0aGUgUHJlbWFzdGVyS2V5IHVzaW5nIHRoZSBwcml2YXRlIGtleVxyXG4gICAgICAgICAgfSkudGhlbihwbXMgPT4ge1xyXG5cclxuICAgICAgICAgICAgY2hhdEtleXMua2V5cy5wcmVtYXN0ZXJLZXkgPSBuZXcgVWludDhBcnJheShwbXMpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNpZ25hdHVyZSA9IGRlY29kZVRvVWludDhBcnJheShyZWNlaXZlZFZhbHVlLnNpZ25hdHVyZSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgcmVjZWl2ZWRtc2dUb0hhc2ggPSBfdGhpcy5fZmlsdGVyTWVzc2FnZVRvSGFzaChtZXNzYWdlLCBjaGF0S2V5cy5rZXlzLnByZW1hc3RlcktleSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY3J5cHRvLnZlcmlmeVJTQShjaGF0S2V5cy5oeXBlcnR5VG8ucHVibGljS2V5LCBlbmNvZGUoY2hhdEtleXMuaGFuZHNoYWtlSGlzdG9yeSkgKyBlbmNvZGUocmVjZWl2ZWRtc2dUb0hhc2gpLCBzaWduYXR1cmUpO1xyXG5cclxuICAgICAgICAgICAgLy8gdmFsaWRhdGVzIHRoZSBzaWduYXR1cmUgcmVjZWl2ZWRcclxuICAgICAgICAgIH0pLnRoZW4oc2lnblZhbGlkYXRpb25SZXN1bHQgPT4ge1xyXG5cclxuICAgICAgICAgICAgLy9sb2cubG9nKCdTZW5kZXJDZXJ0aWZpY2F0ZSAtIHNpZ25hdHVyZSB2YWxpZGF0aW9uIHJlc3VsdCAnLCBzaWduVmFsaWRhdGlvblJlc3VsdCk7XHJcbiAgICAgICAgICAgIGxldCBjb25jYXRLZXkgPSBfdGhpcy5jcnlwdG8uY29uY2F0UE1Td2l0aFJhbmRvbXMoY2hhdEtleXMua2V5cy5wcmVtYXN0ZXJLZXksIGNoYXRLZXlzLmtleXMudG9SYW5kb20sIGNoYXRLZXlzLmtleXMuZnJvbVJhbmRvbSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY3J5cHRvLmdlbmVyYXRlTWFzdGVyU2VjcmV0KGNvbmNhdEtleSwgJ21lc3NhZ2VIaXN0b3JpYycgKyBjaGF0S2V5cy5rZXlzLnRvUmFuZG9tICsgY2hhdEtleXMua2V5cy5mcm9tUmFuZG9tKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdlbmVyYXRlcyB0aGUgbWFzdGVyIGtleXMgZnJvbSB0aGUgUHJlbWFzdGVyIGtleSBhbmQgdGhlIHJhbmRvbXNcclxuICAgICAgICAgIH0pLnRoZW4obWFzdGVyS2V5ID0+IHtcclxuICAgICAgICAgICAgY2hhdEtleXMua2V5cy5tYXN0ZXJLZXkgPSBtYXN0ZXJLZXk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY3J5cHRvLmdlbmVyYXRlS2V5cyhtYXN0ZXJLZXksICdrZXkgZXhwYW5zaW9uJyArIGNoYXRLZXlzLmtleXMudG9SYW5kb20gKyBjaGF0S2V5cy5rZXlzLmZyb21SYW5kb20pO1xyXG5cclxuICAgICAgICAgICAgLy8gZ2VuZXJhdGVzIHRoZSBzeW1tZXRyaWMga2V5cyB0byBiZSB1c2VkIGluIHRoZSBzeW1tZXRyaWMgZW5jcnlwdGlvblxyXG4gICAgICAgICAgfSkudGhlbihrZXlzID0+IHtcclxuICAgICAgICAgICAgY2hhdEtleXMua2V5cy5oeXBlcnR5RnJvbVNlc3Npb25LZXkgPSBuZXcgVWludDhBcnJheShrZXlzWzBdKTtcclxuICAgICAgICAgICAgY2hhdEtleXMua2V5cy5oeXBlcnR5VG9TZXNzaW9uS2V5ID0gbmV3IFVpbnQ4QXJyYXkoa2V5c1sxXSk7XHJcbiAgICAgICAgICAgIGNoYXRLZXlzLmtleXMuaHlwZXJ0eUZyb21IYXNoS2V5ID0gbmV3IFVpbnQ4QXJyYXkoa2V5c1syXSk7XHJcbiAgICAgICAgICAgIGNoYXRLZXlzLmtleXMuaHlwZXJ0eVRvSGFzaEtleSA9IG5ldyBVaW50OEFycmF5KGtleXNbM10pO1xyXG4gICAgICAgICAgICBpdiA9IGRlY29kZVRvVWludDhBcnJheShyZWNlaXZlZFZhbHVlLml2KTtcclxuICAgICAgICAgICAgbGV0IGRhdGEgPSBkZWNvZGVUb1VpbnQ4QXJyYXkocmVjZWl2ZWRWYWx1ZS5zeW1ldHJpY0VuY3J5cHRpb24pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNyeXB0by5kZWNyeXB0QUVTKGNoYXRLZXlzLmtleXMuaHlwZXJ0eVRvU2Vzc2lvbktleSwgZGF0YSwgaXYpO1xyXG5cclxuICAgICAgICAgIH0pLnRoZW4oZGVjcnlwdGVkRGF0YSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGxvZy5sb2coJ2RlY3J5cHRlZERhdGEnLCBkZWNyeXB0ZWREYXRhKTtcclxuXHJcbiAgICAgICAgICAgIGNoYXRLZXlzLmhhbmRzaGFrZUhpc3Rvcnkuc2VuZGVyQ2VydGlmaWNhdGUgPSBfdGhpcy5fZmlsdGVyTWVzc2FnZVRvSGFzaChtZXNzYWdlLCBkZWNyeXB0ZWREYXRhICsgaXYpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGhhc2hSZWNlaXZlZCA9IGRlY29kZVRvVWludDhBcnJheShyZWNlaXZlZFZhbHVlLmhhc2gpO1xyXG5cclxuICAgICAgICAgICAgZmlsdGVyZWRNZXNzYWdlID0gX3RoaXMuX2ZpbHRlck1lc3NhZ2VUb0hhc2gobWVzc2FnZSwgZGVjcnlwdGVkRGF0YSArIGl2KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5jcnlwdG8udmVyaWZ5SE1BQyhjaGF0S2V5cy5rZXlzLmh5cGVydHlUb0hhc2hLZXksIGZpbHRlcmVkTWVzc2FnZSwgaGFzaFJlY2VpdmVkKTtcclxuXHJcbiAgICAgICAgICB9KS50aGVuKHZlcmlmaWVkSGFzaCAgPT4ge1xyXG5cclxuICAgICAgICAgICAgLy8gbG9nLmxvZygncmVzdWx0IG9mIGhhc2ggdmVyaWZpY2F0aW9uICcsIHZlcmlmaWVkSGFzaCk7XHJcbiAgICAgICAgICAgIGxldCByZWNlaXZlckZpbmlzaGVkTWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICB0eXBlOiAnaGFuZHNoYWtlJyxcclxuICAgICAgICAgICAgICB0bzogbWVzc2FnZS5mcm9tLFxyXG4gICAgICAgICAgICAgIGZyb206IG1lc3NhZ2UudG8sXHJcbiAgICAgICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICAgICAgaGFuZHNoYWtlUGhhc2U6ICdyZWNlaXZlckZpbmlzaGVkTWVzc2FnZSdcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGl2ID0gX3RoaXMuY3J5cHRvLmdlbmVyYXRlSVYoKTtcclxuICAgICAgICAgICAgdmFsdWUuaXYgPSBlbmNvZGUoaXYpO1xyXG5cclxuICAgICAgICAgICAgZmlsdGVyZWRNZXNzYWdlID0gX3RoaXMuX2ZpbHRlck1lc3NhZ2VUb0hhc2gocmVjZWl2ZXJGaW5pc2hlZE1lc3NhZ2UsICdvayEnICsgaXYsIGNoYXRLZXlzLmh5cGVydHlGcm9tLm1lc3NhZ2VJbmZvKTtcclxuXHJcbiAgICAgICAgICAgIC8vbG9nLmxvZygnVElBR086IGRvSGFuZFNoYWtlUGhhc2UgdmVyaWZpZWRIYXNoJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5jcnlwdG8uaGFzaEhNQUMoY2hhdEtleXMua2V5cy5oeXBlcnR5RnJvbUhhc2hLZXksIGZpbHRlcmVkTWVzc2FnZSk7XHJcbiAgICAgICAgICB9KS50aGVuKGhhc2ggPT4ge1xyXG5cclxuICAgICAgICAgICAgdmFsdWUuaGFzaCA9IGVuY29kZShoYXNoKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNyeXB0by5lbmNyeXB0QUVTKGNoYXRLZXlzLmtleXMuaHlwZXJ0eUZyb21TZXNzaW9uS2V5LCAnb2shJywgaXYpO1xyXG5cclxuICAgICAgICAgIH0pLnRoZW4oZW5jcnlwdGVkVmFsdWUgPT4ge1xyXG4gICAgICAgICAgICB2YWx1ZS52YWx1ZSA9IGVuY29kZShlbmNyeXB0ZWRWYWx1ZSk7XHJcbiAgICAgICAgICAgIGxldCByZWNlaXZlckZpbmlzaGVkTWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICB0eXBlOiAnaGFuZHNoYWtlJyxcclxuICAgICAgICAgICAgICB0bzogbWVzc2FnZS5mcm9tLFxyXG4gICAgICAgICAgICAgIGZyb206IG1lc3NhZ2UudG8sXHJcbiAgICAgICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICAgICAgaGFuZHNoYWtlUGhhc2U6ICdyZWNlaXZlckZpbmlzaGVkTWVzc2FnZScsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogZW5jb2RlKHZhbHVlKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNoYXRLZXlzLmhhbmRzaGFrZUhpc3RvcnkucmVjZWl2ZXJGaW5pc2hlZE1lc3NhZ2UgPSBfdGhpcy5fZmlsdGVyTWVzc2FnZVRvSGFzaChyZWNlaXZlckZpbmlzaGVkTWVzc2FnZSwgJ29rIScgKyBpdiwgY2hhdEtleXMuaHlwZXJ0eUZyb20ubWVzc2FnZUluZm8pO1xyXG4gICAgICAgICAgICBjaGF0S2V5cy5hdXRoZW50aWNhdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7bWVzc2FnZTogcmVjZWl2ZXJGaW5pc2hlZE1lc3NhZ2UsIGNoYXRLZXlzOiBjaGF0S2V5c30pO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgcmVqZWN0KCdPbiBfZG9IYW5kU2hha2VQaGFzZSBmcm9tIHNlbmRlckNlcnRpZmljYXRlIGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlICdyZWNlaXZlckZpbmlzaGVkTWVzc2FnZSc6IHtcclxuXHJcbiAgICAgICAgICBjaGF0S2V5cy5hdXRoZW50aWNhdGVkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICB2YWx1ZSA9IGRlY29kZShtZXNzYWdlLmJvZHkudmFsdWUpO1xyXG5cclxuICAgICAgICAgIGl2ID0gZGVjb2RlVG9VaW50OEFycmF5KHZhbHVlLml2KTtcclxuICAgICAgICAgIGxldCBkYXRhID0gZGVjb2RlVG9VaW50OEFycmF5KHZhbHVlLnZhbHVlKTtcclxuICAgICAgICAgIGhhc2ggPSBkZWNvZGVUb1VpbnQ4QXJyYXkodmFsdWUuaGFzaCk7XHJcblxyXG4gICAgICAgICAgX3RoaXMuY3J5cHRvLmRlY3J5cHRBRVMoY2hhdEtleXMua2V5cy5oeXBlcnR5VG9TZXNzaW9uS2V5LCBkYXRhLCBpdikudGhlbihkZWNyeXB0ZWREYXRhID0+IHtcclxuICAgICAgICAgICAgLy8gbG9nLmxvZygnZGVjcnlwdGVkRGF0YScsIGRlY3J5cHRlZERhdGEpO1xyXG4gICAgICAgICAgICBjaGF0S2V5cy5oYW5kc2hha2VIaXN0b3J5LnJlY2VpdmVyRmluaXNoZWRNZXNzYWdlID0gX3RoaXMuX2ZpbHRlck1lc3NhZ2VUb0hhc2gobWVzc2FnZSwgZGVjcnlwdGVkRGF0YSArIGl2KTtcclxuXHJcbiAgICAgICAgICAgIGxldCBmaWx0ZXJlZE1lc3NhZ2UgPSBfdGhpcy5fZmlsdGVyTWVzc2FnZVRvSGFzaChtZXNzYWdlLCBkZWNyeXB0ZWREYXRhICsgaXYpO1xyXG4gICAgICAgICAgICBfdGhpcy5jcnlwdG8udmVyaWZ5SE1BQyhjaGF0S2V5cy5rZXlzLmh5cGVydHlUb0hhc2hLZXksIGZpbHRlcmVkTWVzc2FnZSwgaGFzaCkudGhlbihyZXN1bHQgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGVyZSB3YXMgYW4gaW5pdGlhbCBtZXNzYWdlIHRoYXQgd2FzIGJsb2NrZWQgYW5kIHNlbmQgaXRcclxuICAgICAgICAgICAgICBpZiAoY2hhdEtleXMuaW5pdGlhbE1lc3NhZ2UpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgaW5pdGlhbE1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLFxyXG4gICAgICAgICAgICAgICAgICB0bzogbWVzc2FnZS5mcm9tLFxyXG4gICAgICAgICAgICAgICAgICBmcm9tOiBtZXNzYWdlLnRvLFxyXG4gICAgICAgICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNoYXRLZXlzLmluaXRpYWxNZXNzYWdlLmJvZHkudmFsdWVcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHttZXNzYWdlOiBpbml0aWFsTWVzc2FnZSwgY2hhdEtleXM6IGNoYXRLZXlzfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9zZW5kcyB0aGUgc2Vzc2lvbktleSB0byB0aGUgc3Vic2NyaWJlciBoeXBlcnR5XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLl9zZW5kUmVwb3J0ZXJTZXNzaW9uS2V5KG1lc3NhZ2UsIGNoYXRLZXlzKS50aGVuKHZhbHVlID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgICAgICAgcmVqZWN0KCdPbiBfZG9IYW5kU2hha2VQaGFzZSBmcm9tIHJlY2VpdmVyRmluaXNoZWRNZXNzYWdlIGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhc2UgJ3JlcG9ydGVyU2Vzc2lvbktleSc6IHtcclxuXHJcbiAgICAgICAgICBsb2cubG9nKCdyZXBvcnRlclNlc3Npb25LZXknKTtcclxuXHJcbiAgICAgICAgICBsZXQgdmFsdWVJVmFuZEhhc2ggPSBkZWNvZGUobWVzc2FnZS5ib2R5LnZhbHVlKTtcclxuICAgICAgICAgIGhhc2ggPSBkZWNvZGVUb1VpbnQ4QXJyYXkodmFsdWVJVmFuZEhhc2guaGFzaCk7XHJcbiAgICAgICAgICBpdiA9IGRlY29kZVRvVWludDhBcnJheSh2YWx1ZUlWYW5kSGFzaC5pdik7XHJcbiAgICAgICAgICBsZXQgZW5jcnlwdGVkVmFsdWUgPSBkZWNvZGVUb1VpbnQ4QXJyYXkodmFsdWVJVmFuZEhhc2gudmFsdWUpO1xyXG4gICAgICAgICAgbGV0IHBhcnNlZFZhbHVlO1xyXG4gICAgICAgICAgbGV0IHNlc3Npb25LZXk7XHJcbiAgICAgICAgICBsZXQgZGF0YU9iamVjdFVSTDtcclxuICAgICAgICAgIGxldCByZWNlaXZlckFja25vd2xlZGdlTXNnO1xyXG5cclxuICAgICAgICAgIC8vbG9nLmxvZygnW0lkZW50aXR5TW9kdWxlIHJlcG9ydGVyU2Vzc2lvbktleV0gLSBkZWNyeXB0QUVTOiAnLCBjaGF0S2V5cy5rZXlzLmh5cGVydHlUb1Nlc3Npb25LZXksIGVuY3J5cHRlZFZhbHVlLCBpdik7XHJcblxyXG4gICAgICAgICAgX3RoaXMuY3J5cHRvLmRlY3J5cHRBRVMoY2hhdEtleXMua2V5cy5oeXBlcnR5VG9TZXNzaW9uS2V5LCBlbmNyeXB0ZWRWYWx1ZSwgaXYpLnRoZW4oZGVjcnlwdGVkVmFsdWUgPT4ge1xyXG5cclxuICAgICAgICAgICAgcGFyc2VkVmFsdWUgPSBkZWNvZGUoZGVjcnlwdGVkVmFsdWUpO1xyXG4gICAgICAgICAgICBzZXNzaW9uS2V5ID0gZGVjb2RlVG9VaW50OEFycmF5KHBhcnNlZFZhbHVlLnZhbHVlKTtcclxuICAgICAgICAgICAgZGF0YU9iamVjdFVSTCA9IHBhcnNlZFZhbHVlLmRhdGFPYmplY3RVUkw7XHJcblxyXG4gICAgICAgICAgICBsZXQgbWVzc2FnZVRvSGFzaCA9IF90aGlzLl9maWx0ZXJNZXNzYWdlVG9IYXNoKG1lc3NhZ2UsIGRlY3J5cHRlZFZhbHVlICsgaXYpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNyeXB0by52ZXJpZnlITUFDKGNoYXRLZXlzLmtleXMuaHlwZXJ0eVRvSGFzaEtleSwgbWVzc2FnZVRvSGFzaCwgaGFzaCk7XHJcblxyXG4gICAgICAgICAgfSkudGhlbihoYXNoUmVzdWx0ID0+IHtcclxuXHJcblxyXG4gICAgICAgICAgICAvLyBsb2cubG9nKCdoYXNoIHN1Y2Nlc3NmdWxseSB2YWxpZGF0ZWQgJywgaGFzaFJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICBfdGhpcy5kYXRhT2JqZWN0U2Vzc2lvbktleXNbZGF0YU9iamVjdFVSTF0gPSAge3Nlc3Npb25LZXk6IHNlc3Npb25LZXksIGlzVG9FbmNyeXB0OiB0cnVlfTtcclxuICAgICAgICAgICAgbGV0IGRhdGFPYmplY3RTZXNzaW9uS2V5c0Nsb25lID0gY2hhdGtleXNUb1N0cmluZ0Nsb25lcihfdGhpcy5kYXRhT2JqZWN0U2Vzc2lvbktleXMpO1xyXG4gICAgICAgICAgICBfdGhpcy5zdG9yYWdlTWFuYWdlci5zZXQoJ2RhdGFPYmplY3RTZXNzaW9uS2V5cycsIDAsIGRhdGFPYmplY3RTZXNzaW9uS2V5c0Nsb25lKS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgIHJlamVjdCgnT24gX3NlbmRSZXBvcnRlclNlc3Npb25LZXkgZnJvbSBtZXRob2QgcmVwb3J0ZXJTZXNzaW9uS2V5IGVycm9yOiAnICsgZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpdiA9IF90aGlzLmNyeXB0by5nZW5lcmF0ZUlWKCk7XHJcbiAgICAgICAgICAgIHZhbHVlLml2ID0gZW5jb2RlKGl2KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5jcnlwdG8uZW5jcnlwdEFFUyhjaGF0S2V5cy5rZXlzLmh5cGVydHlGcm9tU2Vzc2lvbktleSwgJ29rISEnLCBpdik7XHJcbiAgICAgICAgICB9KS50aGVuKGVuY3J5cHRlZFZhbHVlID0+IHtcclxuXHJcbiAgICAgICAgICAgIHJlY2VpdmVyQWNrbm93bGVkZ2VNc2cgPSB7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ2hhbmRzaGFrZScsXHJcbiAgICAgICAgICAgICAgdG86IG1lc3NhZ2UuZnJvbSxcclxuICAgICAgICAgICAgICBmcm9tOiBtZXNzYWdlLnRvLFxyXG4gICAgICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgICAgIGhhbmRzaGFrZVBoYXNlOiAncmVjZWl2ZXJBY2tub3dsZWRnZSdcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB2YWx1ZS52YWx1ZSA9IGVuY29kZShlbmNyeXB0ZWRWYWx1ZSk7XHJcbiAgICAgICAgICAgIGxldCBtZXNzYWdlVG9IYXNoID0gX3RoaXMuX2ZpbHRlck1lc3NhZ2VUb0hhc2gocmVjZWl2ZXJBY2tub3dsZWRnZU1zZywgJ29rISEnICsgaXYsIGNoYXRLZXlzLmh5cGVydHlGcm9tLm1lc3NhZ2VJbmZvKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5jcnlwdG8uaGFzaEhNQUMoY2hhdEtleXMua2V5cy5oeXBlcnR5RnJvbUhhc2hLZXksIG1lc3NhZ2VUb0hhc2gpO1xyXG4gICAgICAgICAgfSkudGhlbihoYXNoZWRNZXNzYWdlID0+IHtcclxuICAgICAgICAgICAgbGV0IGZpbmFsVmFsdWUgPSBlbmNvZGUoe3ZhbHVlOiB2YWx1ZS52YWx1ZSwgaGFzaDogZW5jb2RlKGhhc2hlZE1lc3NhZ2UpLCBpdjogdmFsdWUuaXZ9KTtcclxuXHJcbiAgICAgICAgICAgIHJlY2VpdmVyQWNrbm93bGVkZ2VNc2cuYm9keS52YWx1ZSA9IGZpbmFsVmFsdWU7XHJcbiAgICAgICAgICAgIHJlc29sdmUoe21lc3NhZ2U6IHJlY2VpdmVyQWNrbm93bGVkZ2VNc2csIGNoYXRLZXlzOiBjaGF0S2V5c30pO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgcmVqZWN0KCdPbiBfZG9IYW5kU2hha2VQaGFzZSBmcm9tIHJlcG9ydGVyU2Vzc2lvbktleSBlcnJvcjogJyArIGVycik7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhc2UgJ3JlY2VpdmVyQWNrbm93bGVkZ2UnOiB7XHJcblxyXG4gICAgICAgICAgbG9nLmxvZygncmVjZWl2ZXJBY2tub3dsZWRnZScpO1xyXG5cclxuICAgICAgICAgIGxldCByZWNlaXZlZHZhbHVlSVZhbmRIYXNoID0gZGVjb2RlKG1lc3NhZ2UuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICBsZXQgcmVjZWl2ZWRIYXNoID0gZGVjb2RlVG9VaW50OEFycmF5KHJlY2VpdmVkdmFsdWVJVmFuZEhhc2guaGFzaCk7XHJcbiAgICAgICAgICBpdiA9IGRlY29kZVRvVWludDhBcnJheShyZWNlaXZlZHZhbHVlSVZhbmRIYXNoLml2KTtcclxuICAgICAgICAgIGxldCByZWNlaXZlZEVuY3J5cHRlZFZhbHVlID0gZGVjb2RlVG9VaW50OEFycmF5KHJlY2VpdmVkdmFsdWVJVmFuZEhhc2gudmFsdWUpO1xyXG5cclxuICAgICAgICAgIF90aGlzLmNyeXB0by5kZWNyeXB0QUVTKGNoYXRLZXlzLmtleXMuaHlwZXJ0eVRvU2Vzc2lvbktleSwgcmVjZWl2ZWRFbmNyeXB0ZWRWYWx1ZSwgaXYpLnRoZW4oZGVjcnlwdGVkVmFsdWUgPT4ge1xyXG5cclxuICAgICAgICAgICAgbGV0IGZpbHRlcmVkTWVzc2FnZSA9IF90aGlzLl9maWx0ZXJNZXNzYWdlVG9IYXNoKG1lc3NhZ2UsIGRlY3J5cHRlZFZhbHVlICsgaXYpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY3J5cHRvLnZlcmlmeUhNQUMoY2hhdEtleXMua2V5cy5oeXBlcnR5VG9IYXNoS2V5LCBmaWx0ZXJlZE1lc3NhZ2UsIHJlY2VpdmVkSGFzaCk7XHJcbiAgICAgICAgICB9KS50aGVuKGhhc2hSZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAvLyBsb2cubG9nKCdoYXNoUmVzdWx0ICcsIGhhc2hSZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNhbGxiYWNrID0gY2hhdEtleXMuY2FsbGJhY2s7XHJcblxyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICBjYWxsYmFjaygnaGFuZFNoYWtlRW5kJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzb2x2ZSgnaGFuZFNoYWtlRW5kJyk7XHJcbiAgICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICByZWplY3QoJ09uIF9kb0hhbmRTaGFrZVBoYXNlIGZyb20gcmVjZWl2ZXJBY2tub3dsZWRnZSBlcnJvcjogJyArIGVycik7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICByZWplY3QobWVzc2FnZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBmaWx0ZXIgdGhlIG1lc3NhZ2VzIHRvIGhhc2gsIGJ5IHJlbW92aW5nIHNvbWUgZmllbGRzIG5vdCBnZW5lcmF0ZWQgYnkgdGhlIHJ1bnRpbWUgY29yZVxyXG4gICogQHBhcmFtIHtNZXNzYWdlfSAgbWVzc2FnZSAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VcclxuICAqIEBwYXJhbSB7U3RyaW5nfSAgZGVjcnlwdGVkVmFsdWUgKE9wdGlvbmFsKSAgICB2YWx1ZSBmcm9tIGJvZHkudmFsdWUgaW4gY2FzZSBpdCBvcmlnaW5hbGx5IGNvbWVzIGVuY3J5cHRlZFxyXG4gICogQHBhcmFtIHtKU09OfSAgaWRlbnRpdHkoT3B0aW9uYWwpICAgIGFkZCB0aGUgaHlwZXJ0eSBpZGVudGl0eSBhc3NvY2lhdGVkIGluIGNhc2UgaXMgbm90IGFkZGVkIHRvIHRoZSBpbml0aWFsIG1lc3NhZ2VcclxuICAqIEByZXR1cm4ge01lc3NhZ2V9ICBuZXcgbWVzc2FnZSBmaWx0ZXJlZFxyXG4gICovXHJcbiAgX2ZpbHRlck1lc3NhZ2VUb0hhc2gobWVzc2FnZSwgZGVjcnlwdGVkVmFsdWUsIGlkZW50aXR5KSB7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdHlwZTogbWVzc2FnZS50eXBlLFxyXG4gICAgICBmcm9tOiBtZXNzYWdlLmZyb20sXHJcbiAgICAgIHRvOiBtZXNzYWdlLnRvLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgaWRlbnRpdHk6IGlkZW50aXR5IHx8IG1lc3NhZ2UuYm9keS5pZGVudGl0eSxcclxuICAgICAgICB2YWx1ZTogZGVjcnlwdGVkVmFsdWUgfHwgbWVzc2FnZS5ib2R5LnZhbHVlLFxyXG4gICAgICAgIGhhbmRzaGFrZVBoYXNlOiBtZXNzYWdlLmJvZHkuaGFuZHNoYWtlUGhhc2VcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZ2VuZXJhdGVzIHRoZSBpbml0aWFsIHN0cnVjdHVyZSBmb3IgdGhlIGtleXMgYmV0d2VlbiB0d28gdXNlcnNcclxuICAqIEBwYXJhbSB7SlNPTn0gICAgbWVzc2FnZSAgICAgICAgICAgICAgaW5pdGlhbCBtZXNzYWdlIHRoYXQgdHJpZ2dlcnMgdGhlIG11dHVhbCBhdXRoZW50aWNhdGlvblxyXG4gICogQHBhcmFtIHtTdHJpbmd9ICB1c2VyVVJMICAgICAgICAgICAgICB1c2VyVVJMXHJcbiAgKiBAcGFyYW0ge2Jvb2xlYW59IHJlY2VpdmVyKE9wdGlvbmFsKSAgaW5kaWNhdGVzIGlmIGlzIHRoZSBzZW5kZXIgb3IgdGhlIHJlY2VpdmVyIHRoYXQgY3JlYXRlcyBhIG5ldyBjaGF0IGNyeXB0b1xyXG4gICogQHJldHVybiB7SlNPTn0gbmV3Q2hhdENyeXB0byAgbmV3IEpTT04gc3RydWN0dXJlIGZvciB0aGUgY2hhdCBjcnlwdG9cclxuICAqL1xyXG4gIF9uZXdDaGF0Q3J5cHRvKG1lc3NhZ2UsIHVzZXJVUkwsIHJlY2VpdmVyKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIC8vY2hlY2sgd2hldGhlciBpcyB0aGUgc2VuZGVyIG9yIHRoZSByZWNlaXZlciB0byBjcmVhdGUgYSBuZXcgY2hhdENyeXB0b1xyXG4gICAgLy90byBtYW50YWluIGNvbnNpc3RlbmN5IG9uIHRoZSBrZXlzIGlmIHRoZSByZWNlaXZlciBjcmVhdGUgYSBuZXcgY2hhdENyeXB0byxcclxuICAgIC8vdGhlbiBpbnZlcnQgdGhlIGZpZWxkc1xyXG4gICAgbGV0IGZyb20gPSAocmVjZWl2ZXIpID8gbWVzc2FnZS50byA6IG1lc3NhZ2UuZnJvbTtcclxuICAgIGxldCB0byA9IChyZWNlaXZlcikgPyBtZXNzYWdlLmZyb20gOiBtZXNzYWdlLnRvO1xyXG5cclxuICAgIGxldCB1c2VySW5mbyA9IF90aGlzLl9pZG0uZ2V0SWRlbnRpdHkodXNlclVSTCk7XHJcblxyXG4gICAgbGV0IG5ld0NoYXRDcnlwdG8gPVxyXG4gICAgICB7XHJcbiAgICAgICAgaHlwZXJ0eUZyb206XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaHlwZXJ0eTogZnJvbSxcclxuICAgICAgICAgIHVzZXJJRDogdXNlckluZm8udXNlclByb2ZpbGUudXNlclVSTCxcclxuXHJcbiAgICAgICAgICAvL3ByaXZhdGVLZXk6IFwiZ2V0TXlQdWJsaWNLZXlcIixcclxuICAgICAgICAgIC8vcHVibGljS2V5OiBcImdldE15UHJpdmF0ZUtleVwiLFxyXG4gICAgICAgICAgYXNzZXJ0aW9uOiB1c2VySW5mby5hc3NlcnRpb24sXHJcbiAgICAgICAgICBtZXNzYWdlSW5mbzogdXNlckluZm9cclxuICAgICAgICB9LFxyXG4gICAgICAgIGh5cGVydHlUbzpcclxuICAgICAgICB7XHJcbiAgICAgICAgICBoeXBlcnR5OiB0byxcclxuICAgICAgICAgIHVzZXJJRDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgcHVibGljS2V5OiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBhc3NlcnRpb246IHVuZGVmaW5lZFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAga2V5czpcclxuICAgICAgICB7XHJcbiAgICAgICAgICBoeXBlcnR5VG9TZXNzaW9uS2V5OiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBoeXBlcnR5RnJvbVNlc3Npb25LZXk6IHVuZGVmaW5lZCxcclxuICAgICAgICAgIGh5cGVydHlUb0hhc2hLZXk6IHVuZGVmaW5lZCxcclxuICAgICAgICAgIGh5cGVydHlGcm9tSGFzaEtleTogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgdG9SYW5kb206IHVuZGVmaW5lZCxcclxuICAgICAgICAgIGZyb21SYW5kb206IHVuZGVmaW5lZCxcclxuICAgICAgICAgIHByZW1hc3RlcktleTogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgbWFzdGVyS2V5OiB1bmRlZmluZWRcclxuICAgICAgICB9LFxyXG4gICAgICAgIGhhbmRzaGFrZUhpc3Rvcnk6IHtcclxuICAgICAgICAgIHNlbmRlckhlbGxvOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICByZWNlaXZlckhlbGxvOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBzZW5kZXJDZXJ0aWZpY2F0ZTogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgcmVjZWl2ZXJGaW5pc2hlZE1lc3NhZ2U6IHVuZGVmaW5lZFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5pdGlhbE1lc3NhZ2U6IChtZXNzYWdlLmJvZHkuaWdub3JlKSA/IHVuZGVmaW5lZCA6IG1lc3NhZ2UsXHJcbiAgICAgICAgY2FsbGJhY2s6IG1lc3NhZ2UuY2FsbGJhY2ssXHJcbiAgICAgICAgYXV0aGVudGljYXRlZDogZmFsc2UsXHJcbiAgICAgICAgZGF0YU9iamVjdFVSTDogbWVzc2FnZS5kYXRhT2JqZWN0VVJMXHJcbiAgICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ld0NoYXRDcnlwdG87XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFJldHJpZXZlcyBhIHB1YmxpYyBrZXlzIGdpdmVuIGEgdXNlciByZWZyZW5jZS4gSWYgbm8ga2V5IGlzIGZvdW5kLFxyXG4gIGdlbmVyYXRlcyBhIG5ldyBrZXkgYXN5bW1ldHJpYyBrZXkgYW5kIHJldHJpZXZlcyB0aGUgcHVibGljIGtleXMuXHJcbiAgKiBAcGFyYW0gICB7dXNlclJlZn0gICAgU3RyaW5nICAgIHVzZXIgcmVmZXJlbmNlIGZvciB0aGUga2V5IHBhaXJcclxuICAqIEByZXR1cm4gIHtBcnJheX0gICBwdWJsaWMga2V5XHJcbiAgKi9cclxuICBnZXRNeVB1YmxpY0tleSh1c2VyUmVmID0gdGhpcy51c2VyRGVmYXVsdEtleVJlZikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIF90aGlzLnN0b3JhZ2VNYW5hZ2VyLmdldCh1c2VyUmVmKS50aGVuKHN0b3JlZEtleVBhaXIgPT4ge1xyXG4gICAgICAgIGlmIChzdG9yZWRLZXlQYWlyKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZShzdG9yZWRLZXlQYWlyLnB1YmxpYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF90aGlzLl9nZW5lcmF0ZUFuZFN0b3JlTmV3QXN5bWV0cmljS2V5KHVzZXJSZWYpLnRoZW4oZ2VuZXJhdGVkS2V5UGFpciA9PiB7XHJcbiAgICAgICAgICByZXNvbHZlKGdlbmVyYXRlZEtleVBhaXIucHVibGljKTtcclxuICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgbG9nLmVycm9yKCdbZ2V0TXlQdWJsaWNLZXk6X2dlbmVyYXRlQW5kU3RvcmVOZXdBc3ltZXRyaWNLZXk6ZXJyXTogJyArIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgIGxvZy5lcnJvcignW2dldE15UHVibGljS2V5OnN0b3JhZ2VNYW5hZ2VyOmVycl06ICcgKyBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFJldHJpZXZlcyBhIHByaXZhdGUga2V5cyBnaXZlbiBhIHVzZXIgcmVmcmVuY2UuIElmIG5vIGtleSBpcyBmb3VuZCxcclxuICBnZW5lcmF0ZXMgYSBuZXcga2V5IGFzeW1tZXRyaWMga2V5IGFuZCByZXRyaWV2ZXMgdGhlIHByaXZhdGUga2V5LlxyXG4gICogQHBhcmFtICAge3VzZXJSZWZ9ICAgIFN0cmluZyAgICB1c2VyIHJlZmVyZW5jZSBmb3IgdGhlIGtleSBwYWlyXHJcbiAgKiBAcmV0dXJuICB7QXJyYXl9ICAgcHJpdmF0ZSBrZXlcclxuICAqKi9cclxuICBnZXRNeVByaXZhdGVLZXkodXNlclJlZiA9IHRoaXMudXNlckRlZmF1bHRLZXlSZWYpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBfdGhpcy5zdG9yYWdlTWFuYWdlci5nZXQodXNlclJlZikudGhlbihzdG9yZWRLZXlQYWlyID0+IHtcclxuICAgICAgICBpZiAoc3RvcmVkS2V5UGFpcikge1xyXG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUoc3RvcmVkS2V5UGFpci5wcml2YXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX3RoaXMuX2dlbmVyYXRlQW5kU3RvcmVOZXdBc3ltZXRyaWNLZXkodXNlclJlZikudGhlbihnZW5lcmF0ZWRLZXlQYWlyID0+IHtcclxuICAgICAgICAgIHJlc29sdmUoZ2VuZXJhdGVkS2V5UGFpci5wcml2YXRlKTtcclxuICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgbG9nLmVycm9yKCdbZ2V0TXlQcml2YXRlS2V5Ol9nZW5lcmF0ZUFuZFN0b3JlTmV3QXN5bWV0cmljS2V5OmVycl06ICcgKyBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBsb2cuZXJyb3IoJ1tnZXRNeVByaXZhdGVLZXk6c3RvcmFnZU1hbmFnZXI6ZXJyXTogJyArIGVyci5tZXNzYWdlKTtcclxuICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAqIEdlbmVyYXRlcyBhIG5ldyBrZXkgcGFpciwgc3RvcmVzIGFuZCByZXRyaXZlcyB0aGUga2V5IHBhaXIuXHJcbiAgKiBAcGFyYW0gICB7dXNlclJlZn0gICAgU3RyaW5nICAgIHVzZXIgcmVmZXJlbmNlIGZvciB0aGUga2V5IHBhaXJcclxuICAqIEByZXR1cm4gIHtBcnJheX0gICBwcml2YXRlIGtleVxyXG4gICoqL1xyXG4gIF9nZW5lcmF0ZUFuZFN0b3JlTmV3QXN5bWV0cmljS2V5KHVzZXJSZWYpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQga2V5UGFpciA9IHVuZGVmaW5lZDtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbi8vICAgICAgX3RoaXMuY3J5cHRvLmdlbmVyYXRlUlNBS2V5UGFpcigpLnRoZW4oZ2VuZXJhdGVkS2V5UGFpciA9PiB7XHJcbiAgICAgICAgbGV0IGdlbmVyYXRlZEtleVBhaXIgPSB7fTtcclxuICAgICAgICBnZW5lcmF0ZWRLZXlQYWlyLnByaXZhdGUgPSBnZW5lcmF0ZUdVSUQoKTtcclxuICAgICAgICBnZW5lcmF0ZWRLZXlQYWlyLnB1YmxpYyA9IGdlbmVyYXRlR1VJRCgpO1xyXG4gICAgICAgIGxvZy5sb2coJ19nZW5lcmF0ZUFuZFN0b3JlTmV3QXN5bWV0cmljS2V5OnVzZXJBc3ltbWV0cmljS2V5R2VuZXJhdGVkJywgZ2VuZXJhdGVkS2V5UGFpcik7XHJcbiAgICAgICAga2V5UGFpciA9IGdlbmVyYXRlZEtleVBhaXI7XHJcbiAgICAgICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIuc2V0KHVzZXJSZWYsIDAsIGdlbmVyYXRlZEtleVBhaXIpO1xyXG4vLyAgICAgIH0pLnRoZW4oc3RvcmVkUmVmZXJlbmNlID0+IHtcclxuLy8gICAgICAgIGxvZy5sb2coJ19nZW5lcmF0ZUFuZFN0b3JlTmV3QXN5bWV0cmljS2V5OnVzZXJBc3ltbWV0cmljS2V5U3VjY2VzcycsIHN0b3JlZFJlZmVyZW5jZSk7XHJcbiAgICAgICAgcmVzb2x2ZShrZXlQYWlyKTtcclxuICAgICAgfSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBsb2cuZXJyb3IoJ1tfZ2VuZXJhdGVBbmRTdG9yZU5ld0FzeW1ldHJpY0tleTplcnJdOiAnICsgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICB9KTtcclxuLy8gICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuLypcclxuY29uc3Qgbm9kZUpTS2V5UGFpclBvcHVsYXRlID0geyBwdWJsaWM6IFs0OCwgMTMwLCAxLCAzNCwgNDgsIDEzLCA2LCA5LCA0MiwgMTM0LCA3MiwgMTM0LCAyNDcsIDEzLCAxLCAxLCAxLCA1LCAwLCAzLCAxMzAsIDEsIDE1LCAwLCA0OCwgMTMwLCAxLCAxMCwgMiwgMTMwLCAxLCAxLCAwLCAyMjgsIDQzLCAxMDEsIDEyLCAxMjEsIDcsIDE1NywgNzEsIDgxLCA1OCwgMjE5LCAzMiwgMTAsIDEwOCwgMTkzLCAxNzksIDIxMiwgMTE2LCAyNTUsIDU5LCAyMTcsIDMyLCAxNjEsIDIwMSwgNTMsIDE3MSwgMjI2LCAxOTksIDEzNywgMjAyLCAxNzEsIDYwLCA4MiwgNTMsIDEyNSwgNjIsIDE3NywgMTI2LCAxNjUsIDI0LCAxNDEsIDMwLCAxNSwgMjI2LCA1OSwgMTA3LCAzNCwgNywgMTMsIDE0OSwgMTEyLCAxMjUsIDEwLCAyMzAsIDE5MSwgMTU2LCAxNjQsIDE3NywgMTAsIDE4NSwgMTMsIDY2LCAzLCAyMTcsIDE2NiwgMjQ0LCA5MCwgMTE5LCAxMTEsIDI3LCAxNDUsIDEwNCwgNzEsIDE4OSwgMTY2LCAyMjYsIDI1NSwgMTMzLCA4MywgMTUxLCAyMzEsIDEwMSwgMTUxLCA4OSwgMjIsIDE5LCA2NSwgMTU0LCAxMCwgNTMsIDIwOCwgMjE4LCAyNTIsIDIxOSwgMzcsIDUwLCAyMTIsIDg2LCAxNDUsIDEwNywgMTMyLCA5MCwgMjMzLCAyMDIsIDIyNywgMTA4LCAxMTQsIDE0MSwgMjksIDczLCAxODcsIDMxLCAxMywgMjM0LCAwLCAyMzIsIDI0LCAxOTEsIDM1LCAxNDksIDE3OSwgMTM4LCAyMTQsIDE1OSwgMjQ1LCAxNjIsIDE0OCwgMjIxLCAxMTgsIDE3LCAxMDUsIDg5LCAxNTEsIDE0NiwgMjA5LCA1NSwgMjM2LCA2MSwgMTQzLCAyMzMsIDIyOCwgMTAsIDExNSwgOCwgODEsIDE5NywgNDUsIDEyMywgMTg3LCAyMjMsIDE3NiwgMjU0LCAxNjUsIDY5LCAxNDMsIDI5LCAxMDAsIDExNCwgMTcsIDEzMCwgMjI2LCAyMjMsIDMzLCAxMSwgMjQwLCA4MSwgNjEsIDE3MiwgMTkxLCAxNTcsIDI0NiwgMjAyLCA4NywgMTMxLCAyMjEsIDg4LCA0OCwgMTI3LCAxNTksIDExOSwgMTYwLCAxNTIsIDExNywgNjEsIDI1MywgMTc0LCA2NSwgMjE0LCAyMDMsIDIxOCwgNjMsIDUwLCA3OCwgMTYwLCAxODEsIDIyMSwgMjExLCAxMjgsIDcwLCAxNzgsIDE5MSwgMTcwLCAwLCAxMywgMTIyLCAxNzMsIDEyLCAyMDMsIDI1MiwgNCwgMTg0LCAyMjUsIDI1MiwgNywgNjIsIDk2LCAxMTYsIDE1LCAyMTYsIDE1OCwgNTUsIDg1LCA0OCwgMTYsIDksIDIwNiwgMTE5LCA3NCwgMTEyLCAyNDMsIDEzNiwgODQsIDE4NCwgMjIzLCAyNTQsIDEwMSwgOTEsIDYxLCAxMCwgOTEsIDg1LCAxOTIsIDE0NywgMTQ0LCA1NywgMjksIDY2LCAyMzgsIDE5OSwgMjQ0LCAxOTMsIDE5NCwgMTUwLCAyMzIsIDIwMCwgMTA3LCAyLCAzLCAxLCAwLCAxXSxcclxuICBwcml2YXRlOiBbNDgsIDEzMCwgNCwgMTkxLCAyLCAxLCAwLCA0OCwgMTMsIDYsIDksIDQyLCAxMzQsIDcyLCAxMzQsIDI0NywgMTMsIDEsIDEsIDEsIDUsIDAsIDQsIDEzMCwgNCwgMTY5LCA0OCwgMTMwLCA0LCAxNjUsIDIsIDEsIDAsIDIsIDEzMCwgMSwgMSwgMCwgMjI4LCA0MywgMTAxLCAxMiwgMTIxLCA3LCAxNTcsIDcxLCA4MSwgNTgsIDIxOSwgMzIsIDEwLCAxMDgsIDE5MywgMTc5LCAyMTIsIDExNiwgMjU1LCA1OSwgMjE3LCAzMiwgMTYxLCAyMDEsIDUzLCAxNzEsIDIyNiwgMTk5LCAxMzcsIDIwMiwgMTcxLCA2MCwgODIsIDUzLCAxMjUsIDYyLCAxNzcsIDEyNiwgMTY1LCAyNCwgMTQxLCAzMCwgMTUsIDIyNiwgNTksIDEwNywgMzQsIDcsIDEzLCAxNDksIDExMiwgMTI1LCAxMCwgMjMwLCAxOTEsIDE1NiwgMTY0LCAxNzcsIDEwLCAxODUsIDEzLCA2NiwgMywgMjE3LCAxNjYsIDI0NCwgOTAsIDExOSwgMTExLCAyNywgMTQ1LCAxMDQsIDcxLCAxODksIDE2NiwgMjI2LCAyNTUsIDEzMywgODMsIDE1MSwgMjMxLCAxMDEsIDE1MSwgODksIDIyLCAxOSwgNjUsIDE1NCwgMTAsIDUzLCAyMDgsIDIxOCwgMjUyLCAyMTksIDM3LCA1MCwgMjEyLCA4NiwgMTQ1LCAxMDcsIDEzMiwgOTAsIDIzMywgMjAyLCAyMjcsIDEwOCwgMTE0LCAxNDEsIDI5LCA3MywgMTg3LCAzMSwgMTMsIDIzNCwgMCwgMjMyLCAyNCwgMTkxLCAzNSwgMTQ5LCAxNzksIDEzOCwgMjE0LCAxNTksIDI0NSwgMTYyLCAxNDgsIDIyMSwgMTE4LCAxNywgMTA1LCA4OSwgMTUxLCAxNDYsIDIwOSwgNTUsIDIzNiwgNjEsIDE0MywgMjMzLCAyMjgsIDEwLCAxMTUsIDgsIDgxLCAxOTcsIDQ1LCAxMjMsIDE4NywgMjIzLCAxNzYsIDI1NCwgMTY1LCA2OSwgMTQzLCAyOSwgMTAwLCAxMTQsIDE3LCAxMzAsIDIyNiwgMjIzLCAzMywgMTEsIDI0MCwgODEsIDYxLCAxNzIsIDE5MSwgMTU3LCAyNDYsIDIwMiwgODcsIDEzMSwgMjIxLCA4OCwgNDgsIDEyNywgMTU5LCAxMTksIDE2MCwgMTUyLCAxMTcsIDYxLCAyNTMsIDE3NCwgNjUsIDIxNCwgMjAzLCAyMTgsIDYzLCA1MCwgNzgsIDE2MCwgMTgxLCAyMjEsIDIxMSwgMTI4LCA3MCwgMTc4LCAxOTEsIDE3MCwgMCwgMTMsIDEyMiwgMTczLCAxMiwgMjAzLCAyNTIsIDQsIDE4NCwgMjI1LCAyNTIsIDcsIDYyLCA5NiwgMTE2LCAxNSwgMjE2LCAxNTgsIDU1LCA4NSwgNDgsIDE2LCA5LCAyMDYsIDExOSwgNzQsIDExMiwgMjQzLCAxMzYsIDg0LCAxODQsIDIyMywgMjU0LCAxMDEsIDkxLCA2MSwgMTAsIDkxLCA4NSwgMTkyLCAxNDcsIDE0NCwgNTcsIDI5LCA2NiwgMjM4LCAxOTksIDI0NCwgMTkzLCAxOTQsIDE1MCwgMjMyLCAyMDAsIDEwNywgMiwgMywgMSwgMCwgMSwgMiwgMTMwLCAxLCAwLCAxMDMsIDI0NCwgMTM3LCAxMTgsIDExNiwgODIsIDE0LCAyMDMsIDEwMiwgMTA3LCAyNTMsIDg4LCAxMiwgMTk5LCAyMjIsIDYwLCAyNDMsIDEzNiwgODYsIDE1NywgNzQsIDIyNCwgMTkwLCA1MywgMTEzLCA1NywgMTU3LCAyNTAsIDQ5LCAxMzAsIDk2LCAzMSwgMjUyLCAxMzYsIDE1MiwgNzAsIDE0MywgMTcsIDIxNSwgOTYsIDEwMywgNTEsIDE4LCAzNSwgMTQxLCAyMTIsIDIxMCwgMjA1LCA5LCAyMTYsIDgzLCA3MCwgMjQ1LCA3MSwgMTM4LCAxMTksIDExMiwgMjI5LCAxNjQsIDE3NiwgOSwgMzcsIDgxLCAxNjEsIDE5MywgMTU0LCA2OCwgMjQ5LCAxMTUsIDEwNiwgMjAxLCA2LCAxMiwgMjI1LCAxNDQsIDEyNiwgMTQxLCAyMTAsIDE0MSwgMjQyLCAxMjgsIDE1OSwgMjIxLCAxNjMsIDIyMiwgMjEsIDIzMywgMjMwLCAxNjcsIDIwNiwgNTksIDI0LCAyNTAsIDIzMywgODEsIDEyMiwgMTAyLCAyNiwgNiwgMjMzLCA3MiwgMTMzLCA0NywgNzcsIDE1NSwgMjM4LCA4NiwgNiwgMTM5LCAyNCwgMTMxLCAxNjMsIDE3OSwgMTEyLCA0OCwgMjQ3LCAxNDIsIDYsIDIwNywgMjA0LCAxNzMsIDIyMywgMTQwLCAxOTksIDE1MCwgOTUsIDEyMywgMTUyLCAyMDIsIDE1NSwgMTMxLCAyMzgsIDYyLCA5NiwgMTMzLCA0LCAyMTcsIDUxLCAxMjEsIDMwLCAzOCwgMTc4LCAxODksIDIxNiwgNDQsIDM1LCAyNDEsIDkzLCA3LCA2MiwgOTAsIDExMSwgMjE2LCA2NiwgMjA5LCAyNDMsIDEyOCwgMjM0LCAxNDEsIDg0LCAxMzUsIDE4MSwgMTMsIDM4LCAyMjAsIDExNCwgMjQ1LCAyNDAsIDE3OCwgOTUsIDIyMCwgMjA2LCAxMSwgMTg2LCAyMzQsIDIxMywgNjYsIDEyMSwgODMsIDY4LCA4OSwgNzUsIDQ2LCAxODMsIDE0NSwgMTgzLCAxNDcsIDE2MCwgMjE1LCAxMTgsIDE5OCwgMTI1LCAxODEsIDE0NiwgMzAsIDI1MSwgNTgsIDg3LCA0NywgMjA5LCAyMzcsIDk3LCAyNCwgNDcsIDE3OSwgNiwgMTEwLCAyNDIsIDk5LCAxNTAsIDIyNiwgMTQ4LCAxOTgsIDE3NCwgMTQ2LCAxMDEsIDIxMywgODcsIDE3OCwgMTAsIDIyMywgMTA1LCAxOCwgNTYsIDUzLCAyMiwgMjEyLCAxNTgsIDE3MCwgMTc2LCA1MSwgODYsIDE0NSwgMTI1LCAxMjQsIDQ0LCA5LCA4NSwgMTksIDE0NCwgMjQ2LCAxNzAsIDc4LCAxMjQsIDMwLCAzMiwgMTIsIDE2NiwgMTc0LCAxMzksIDc3LCA2MywgMTczLCA4MiwgMTAsIDE1MywgMiwgMTI5LCAxMjksIDAsIDI0OCwgMTgsIDE0MywgMjQ2LCAxMzcsIDEzNiwgMTQ1LCAyMTksIDE3OCwgMzksIDI3LCA5NCwgNjQsIDkwLCA0NywgMTYzLCAxMTQsIDYwLCA2MywgMTg3LCAxMzEsIDE0MywgMjQ0LCAxNiwgNDIsIDEyOCwgMjMxLCAxMTcsIDkyLCA5OCwgMjE5LCAxNTUsIDYyLCAxMDcsIDI1MiwgMTcsIDI0NSwgNDUsIDE2MCwgMjI1LCAxMDMsIDE0MiwgNzIsIDM2LCAxOTMsIDE1MCwgMjM1LCAyMTQsIDE3NSwgNjIsIDIxMiwgNTYsIDQ1LCA5LCAwLCA2MCwgMTE0LCAxMDcsIDEzNCwgMjI4LCAyMDQsIDEzMSwgMTMxLCAyMTQsIDk0LCAyMDEsIDE0OCwgMTU5LCA5OSwgMTM5LCAxODEsIDEzLCAxMTksIDM4LCAzMCwgMTA3LCAxNjYsIDE2NSwgMjAzLCA0MywgMzQsIDIwLCAyMDcsIDE3MSwgMzIsIDU4LCAxNjcsIDYyLCAxOTYsIDE1MywgMTAzLCAyMDQsIDIxMywgMjQ3LCA0OCwgMTExLCAyMjcsIDU5LCA5NSwgOTcsIDE5NCwgMTg3LCA1MywgMTAsIDI0NywgMTA4LCA1OCwgODYsIDI4LCAyOSwgMTEzLCA4LCAxMTAsIDE3MSwgMjIwLCAyNDUsIDExLCA4MiwgMjMzLCAyMjMsIDkxLCA2OCwgMTY2LCAxMTcsIDE3NCwgMTg3LCA2MiwgNzcsIDIsIDEyOSwgMTI5LCAwLCAyMzUsIDExOCwgMiwgMTA1LCAyMzksIDIxMiwgMzAsIDEwNCwgMTU3LCA0MSwgMTA5LCAxMSwgMjQ4LCAxNTIsIDIyLCAyMzYsIDk3LCA0MCwgMTUzLCAxMzEsIDIyOCwgNSwgODYsIDE4NywgMTEzLCAxMjYsIDE0NCwgNzYsIDE0MSwgNzksIDExMCwgMjUwLCAxNDYsIDE1MiwgNDksIDU4LCAxNTYsIDIwMSwgMTc2LCA5MiwgMTg5LCAyMDksIDMwLCAxMTIsIDEwOCwgMTc1LCAyMDQsIDIwNCwgMjQ3LCAxNjQsIDQ2LCAxMjksIDIzOSwgOTgsIDEyNywgNDksIDE0NSwgMjE4LCA2MywgMTkzLCAxMjQsIDE3NCwgMTgsIDk4LCAyMDEsIDk5LCAxNTQsIDE2MiwgMTM4LCA3OCwgMTU5LCAyNTMsIDMsIDI0OCwgMywgMjA5LCAzNiwgMjM5LCAxOTMsIDE1NSwgMTkzLCA1LCAxOSwgMjM2LCAzNywgNzgsIDExOCwgMTM1LCAyNTAsIDE5OSwgNywgMTQxLCAyNDgsIDEyMCwgMzYsIDEzNiwgOTMsIDk4LCAxNzQsIDYwLCAxOCwgMjE1LCA5MywgMTc0LCAxMDcsIDE0MSwgMTE2LCAxNDUsIDE2NywgMjIxLCAyMTAsIDE2OSwgMjQ3LCA2NywgMjU0LCAyMjIsIDE2MSwgMTM0LCA2MywgMjIxLCA5MCwgODcsIDQyLCA5OSwgMjI3LCA4MSwgMTczLCAxNTEsIDIsIDEyOSwgMTI5LCAwLCAxMzMsIDIzLCAxNjgsIDEwMywgODMsIDIzMiwgMTQ2LCAxNjAsIDE4MSwgMjMsIDQwLCAzOCwgMjA0LCAxMywgMjE0LCAyMDMsIDQ5LCA0MSwgMTk1LCAyMjcsIDE4OSwgMTgxLCA4LCAyNDMsIDExOSwgMTA2LCA3NSwgNjcsIDI1MCwgMjUwLCAxMCwgMjM0LCA5OCwgMTE4LCAyNiwgMjUwLCAzNSwgMTIxLCAxMzIsIDEyNCwgMTAsIDc2LCAyNiwgMTk4LCAxNjUsIDE1NCwgMTA4LCAxOSwgMTE3LCA4OCwgMjMsIDE3LCAxOTIsIDE0MywgMTg0LCAxNzcsIDE4MSwgMTQxLCAxNTcsIDQsIDE4NSwgMjQ4LCAxOTMsIDc3LCAyMDQsIDI0MywgNywgMTcwLCAyNDAsIDQsIDExMSwgMTEzLCAxODMsIDAsIDI3LCAxMzYsIDIwLCAxOSwgMTQ5LCA3NCwgMzMsIDI0MSwgMjE4LCAxMDgsIDIzNiwgODAsIDE3MSwgMTQ4LCAxNiwgMTE2LCA5NywgMTA5LCA4MywgNzQsIDg4LCAxNDUsIDk0LCAyMzksIDEwMiwgMTkyLCAxOSwgMTE0LCAyMDcsIDUsIDEyOCwgNTEsIDExMSwgMTY0LCAyMzcsIDg2LCAxNTQsIDk5LCA1MiwgMTk3LCA2MiwgNTcsIDE4MiwgNiwgMTUyLCAyNDUsIDYxLCAxMzcsIDU4LCAxMDUsIDE1OSwgMiwgODQsIDEwOSwgMiwgMTI5LCAxMjksIDAsIDIyNiwgNjcsIDExMSwgMTMyLCA5NSwgOTEsIDEwMSwgMTc3LCA2MywgMTg5LCA0NCwgNTMsIDE5MywgMTg0LCA5MiwgMjMwLCAyMjMsIDk4LCAxMzMsIDc0LCAyMDksIDg2LCA1MiwgNywgNjUsIDE5NSwgMjA2LCAxMDAsIDgxLCAxNzgsIDE0NCwgNjUsIDE2NywgMTUxLCA0MiwgNzksIDg5LCAxNDksIDE4LCAxNzMsIDE4OCwgMjEsIDI0NCwgMjUxLCA0OSwgMjMwLCA0MSwgMTUwLCAxNTMsIDQ2LCAzNSwgMzgsIDIzMSwgOTksIDE3NCwgNTYsIDExNSwgMzIsIDIxNSwgMjUzLCA4NSwgMTQ3LCAxMDgsIDE5NywgMTQ3LCAzNCwgMjM2LCAyMTYsIDIyMiwgMTc3LCA1NywgOTAsIDEzNiwgMTE0LCAyMDcsIDQ4LCA0NiwgMzEsIDkwLCAyMjAsIDE4LCA1OCwgMTQzLCAyMzksIDExMSwgMjE0LCAyNywgOTUsIDYsIDM2LCA1MywgMjI5LCA2MiwgMTA4LCA0NSwgMzksIDEsIDMwLCA0NywgMTc4LCA1NiwgMTY0LCAyMDYsIDU2LCA0MiwgMjA4LCA0NiwgMTkzLCA2MSwgMzEsIDE0NywgNDUsIDE0NywgMjMsIDE4NywgMjIsIDUwLCAyNTUsIDExMSwgMjI5LCAxMzIsIDE5OSwgMTUyLCA3NSwgMTQyLCAxMzYsIDIwOSwgMTUxLCAyLCAxMjksIDEyOSwgMCwgMTY1LCA1NiwgMjMyLCA3NiwgNTUsIDU3LCAyNDAsIDE1OSwgOTIsIDIwNywgMjIwLCAxNDMsIDEzMCwgMzAsIDU3LCAyMzQsIDI1MSwgMTcyLCAxNzEsIDE4MCwgNTQsIDE1OSwgMjI5LCA5NiwgMjQ2LCA3MywgMTEyLCAxNDYsIDc1LCAxNTcsIDI0MiwgMjAxLCAxNjEsIDIxOCwgMzcsIDE3NiwgMzUsIDE3MCwgNTAsIDkwLCAxNDgsIDEwMiwgMTkxLCAxOTksIDIzOSwgMTc0LCA3OCwgNzIsIDY3LCA4NSwgMTk5LCA0NSwgMTQ5LCAxNDUsIDEzMiwgMTYxLCAyMTIsIDMzLCAxNTcsIDc1LCAyMTYsIDc5LCAzOSwgMjMzLCAxOCwgMjEwLCAyNTUsIDI2LCA3MiwgMjI5LCAyMzksIDQ0LCAxMiwgMTQ3LCAxNTgsIDE3NiwgMTkyLCA5NSwgMTI2LCAzMiwgMTc1LCAyMywgMjI2LCAxMzEsIDEzOSwgMTk3LCAxNzUsIDE5MywgNjIsIDgsIDE1MSwgMjUyLCA2OCwgMTU0LCA5NCwgODksIDE4OSwgMTI1LCA5MCwgMzAsIDM2LCAxNzUsIDczLCAyMzAsIDE5NCwgMTMsIDIzMywgMjQ3LCAxMjMsIDYwLCAyNDEsIDQ3LCAxNzEsIDUxLCAxODksIDExMiwgMTExLCAyMTMsIDE0MSwgODksIDcwLCAyNDksIDIzNiwgNjMsIDIzNiwgMTEwLCAxMTUsIDIwOF19O1xyXG4qL1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgbmV3IENyeXB0b01hbmFnZXIoKTtcclxuIiwiLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignTG9hZGVyJyk7XHJcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xyXG5cclxuaW1wb3J0IHsgZGl2aWRlVVJMLCBlbXB0eU9iamVjdCB9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IEFkZHJlc3NBbGxvY2F0aW9uIGZyb20gJy4uL2FsbG9jYXRpb24vQWRkcmVzc0FsbG9jYXRpb24nO1xyXG5cclxuY2xhc3MgTG9hZGVyIHtcclxuXHJcbiAgY29uc3RydWN0b3IocnVudGltZVVSTCwgcnVudGltZUNvbmZpZ3VyYXRpb24sIHJ1bnRpbWVEZXNjcmlwdG9yc0luc3RhbmNlKSB7XHJcbiAgICBpZiAoIXJ1bnRpbWVDb25maWd1cmF0aW9uKSB0aHJvdyBFcnJvcignW1J1bnRpbWUuTG9hZGVyXSBUaGUgZGVzY3JpcHRvciBuZWVkIHRvIGtub3cgdGhlIHJ1bnRpbWUgY29uZmlndXJhdGlvbicpO1xyXG4gICAgaWYgKCFydW50aW1lRGVzY3JpcHRvcnNJbnN0YW5jZSkgdGhyb3cgRXJyb3IoJ1tSdW50aW1lLkxvYWRlcl0gVGhlIGRlc2NyaXB0b3IgbmVlZCB0byBrbm93IHRoZSBydW50aW1lIERlc2NyaXB0b3IgaW5zdGFuY2UnKTtcclxuXHJcbiAgICB0aGlzLmxvZyA9IGxvZztcclxuXHJcbiAgICB0aGlzLnJ1bnRpbWVDb25maWd1cmF0aW9uID0gcnVudGltZUNvbmZpZ3VyYXRpb247XHJcbiAgICB0aGlzLmRlc2NyaXB0b3JzID0gcnVudGltZURlc2NyaXB0b3JzSW5zdGFuY2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgcnVudGltZSB1cmxcclxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IHZhbHVlIHJ1bnRpbWVVUkxcclxuICAgKi9cclxuICBzZXQgcnVudGltZVVSTCh2YWx1ZSkge1xyXG4gICAgdGhpcy5fcnVudGltZVVSTCA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHJ1bnRpbWUgdXJsXHJcbiAgICogQHJldHVybiB7c3RyaW5nfSB2YWx1ZSBydW50aW1lVVJMXHJcbiAgICovXHJcbiAgZ2V0IHJ1bnRpbWVVUkwoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcnVudGltZVVSTDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldCBSZWdpc3RyeSBjb21wb25lbnRcclxuICAgKiBAcGFyYW0gIHtSZWdpc3RyeX0gdmFsdWUgUmVnaXN0cnkgQ29tcG9uZW50XHJcbiAgICovXHJcbiAgc2V0IHJlZ2lzdHJ5KHZhbHVlKSB7XHJcbiAgICB0aGlzLl9yZWdpc3RyeSA9IHZhbHVlO1xyXG5cclxuICAgIC8vIEluc3RhbGwgQWRkcmVzc0FsbG9jYXRpb25cclxuICAgIGxldCBhZGRyZXNzQWxsb2NhdGlvbiA9IEFkZHJlc3NBbGxvY2F0aW9uLmluc3RhbmNlO1xyXG4gICAgdGhpcy5fYWRkcmVzc0FsbG9jYXRpb24gPSBhZGRyZXNzQWxsb2NhdGlvbjtcclxuXHJcbiAgICBsb2cubG9nKCdbTG9hZGVyIC0gQWRkcmVzc0FsbG9jYXRpb25dIC0gJywgYWRkcmVzc0FsbG9jYXRpb24pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IFJlZ2lzdHJ5IGNvbXBvbmVudFxyXG4gICAqIEByZXR1cm4ge1JlZ2lzdHJ5fSBSZWdpc3RyeSBjb21wb25lbnRcclxuICAgKi9cclxuICBnZXQgcmVnaXN0cnkoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVnaXN0cnk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgTWVzc2FnZSBCdXMgY29tcG9uZW50XHJcbiAgICogQHBhcmFtICB7TWVzc2FnZUJ1c30gdmFsdWUgTWVzc2FnZSBidXMgY29tcG9uZW50XHJcbiAgICovXHJcbiAgc2V0IG1lc3NhZ2VCdXModmFsdWUpIHtcclxuICAgIHRoaXMuX21lc3NhZ2VzQnVzID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgTWVzc2FnZSBCdXMgY29tcG9uZW50XHJcbiAgICogQHJldHVybiB7TWVzc2FnZUJ1c30gTWVzc2FnZSBCdXMgY29tcG9uZW50XHJcbiAgICovXHJcbiAgZ2V0IG1lc3NhZ2VCdXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fbWVzc2FnZXNCdXM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgUnVudGltZSBGYWN0b3J5IGNvbXBvbmVudFxyXG4gICAqIEBwYXJhbSAge3J1bnRpbWVGYWN0b3J5fSB2YWx1ZSBGYWN0b3J5IGluY2x1ZGVzIHRoZSBzcGVjaWZpYyBpbXBsZW1lbnRhdGlvbnMgZm9yIGVhY2ggZW52aXJvbm1lbnRcclxuICAgKi9cclxuICBzZXQgcnVudGltZUZhY3RvcnkodmFsdWUpIHtcclxuICAgIHRoaXMuX3J1bnRpbWVGYWN0b3J5ID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgUnVudGltZSBGYWN0b3J5IGNvbXBvbmVudFxyXG4gICAqIEByZXR1cm4ge3J1bnRpbWVGYWN0b3J5fSBSdW50aW1lIEZhY3RvcnkgY29tcG9uZW50XHJcbiAgICovXHJcbiAgZ2V0IHJ1bnRpbWVGYWN0b3J5KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3J1bnRpbWVGYWN0b3J5O1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIERlcGxveSBIeXBlcnR5IGZyb20gQ2F0YWxvZ3VlIFVSTFxyXG4gICAqXHJcbiAgICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL3RyZWUvbWFzdGVyL2RhdGFtb2RlbC9jb3JlL2FkZHJlc3NcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7VVJMLkh5cGVydHlDYXRhbG9ndWVVUkx9IGh5cGVydHlDYXRhbG9ndWVVUkwgLSBUaGUgQ2F0YWxvZ3VlIFVSTCB1c2VkIHRvIGlkZW50aWZ5IGRlc2NyaXB0b3JzIGluIHRoZSBDYXRhbG9ndWUuXHJcbiAgICogQHBhcmFtIHtib29sZWFufFVSTC5IeXBlcnR5VVJMfSBbcmV1c2VVUkw9ZmFsc2VdIHJldXNlVVJMIC0gcmV1c2VVUkwgaXMgdXNlZCB0byByZXVzZSB0aGUgaHlwZXJ0eVVSTCBwcmV2aW91c2x5IHJlZ2lzdHJlZCwgYnkgZGVmYXVsdCB0aGUgcmV1c2UgaXMgZGlzYWJsZWQ7XHJcbiAgICogQHBhcmFtIHtVUkx9IGFwcFVSTCAtIHRoZSBhcHAgdXJsIG9yaWdpbiBhZGRyZXNzO1xyXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBJZHBDb25zdHJhaW50IC0gY29uc3RyYWludHMgdG8gYmUgdXNlZCB3aGVuIHNlbGVjdGluZyB0aGUgaWRlbnRpdHkgdG8gYmUgYXNzb2NpYXRlZCB3aXRoIHRoZSBIeXBlcnR5IGluY2x1ZGluZyBvcmlnaW4sIGlkcCwgYW5kIGlkSGludC5cclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxCb29sZWFuLCBFcnJvcj59IHRoaXMgaXMgUHJvbWlzZSBhbmQgcmV0dXJucyB0cnVlIGlmIGFsbCBjb21wb25lbnRzIGFyZSBsb2FkZWQgd2l0aCBzdWNjZXNzIG9yIGFuIGVycm9yIGlmIHNvbWVvbmUgZmFpbHMuXHJcbiAgICpcclxuICAgKiBAbWVtYmVyT2YgTG9hZGVyXHJcbiAgICovXHJcbiAgbG9hZEh5cGVydHkoaHlwZXJ0eUNsYXNzLCByZXVzZVVSTCA9IGZhbHNlLCBJZHBDb25zdHJhaW50LCBhcHBVUkwpIHtcclxuXHJcbiAgICBpZiAoIXRoaXMuX3JlYWR5VG9Vc2UoKSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgaWYgKCFoeXBlcnR5Q2xhc3MpIHRocm93IG5ldyBFcnJvcignW1J1bnRpbWUuTG9hZGVyXSBoeXBlcnR5Q2xhc3MgcGFyYW1ldGVyIGlzIG5lZWRlZCcpO1xyXG5cclxuXHJcbiAgICBsZXQgX2h5cGVydHlVUkw7XHJcbiAgICBsZXQgX2h5cGVydHlTYW5kYm94O1xyXG4gICAgbGV0IF9oeXBlcnR5U291cmNlUGFja2FnZTtcclxuICAgIGxldCBoYXZlRXJyb3IgPSBmYWxzZTtcclxuICAgIGxldCBpbnN0YW5jZSA9IG5ldyBoeXBlcnR5Q2xhc3MoKTtcclxuICAgIGxldCBoeXBlcnR5ID0gaW5zdGFuY2UubmFtZTtcclxuXHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIGxldCBlcnJvclJlYXNvbiA9IChyZWFzb24pID0+IHtcclxuICAgICAgICBsb2cuaW5mbygnW1J1bnRpbWUuTG9hZGVyXSBTb21ldGhpbmcgZmFpbGVkIG9uIHRoZSBkZXBsb3kgaHlwZXJ0eTogJywgcmVhc29uKTtcclxuICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgfTtcclxuICBcclxuICAgICAgbGV0IGhhbmRsZUVycm9yID0gKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGhhdmVFcnJvciA9IHRydWU7XHJcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgIH07XHJcbiAgXHJcbiAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXIubG9hZEh5cGVydHldICcsIGh5cGVydHkpO1xyXG4gICAgICBsZXQgX2h5cGVydHlEZXNjcmlwdG9yID0gaW5zdGFuY2UuZGVzY3JpcHRvcjtcclxuXHJcbiAgICAgIF9oeXBlcnR5RGVzY3JpcHRvci5kYXRhT2JqZWN0c1swXSA9IF9oeXBlcnR5RGVzY3JpcHRvci5kYXRhT2JqZWN0c1swXS5yZXBsYWNlKCclZG9tYWluJScsIHRoaXMuX3JlZ2lzdHJ5Ll9kb21haW4pO1xyXG5cclxuICAgICAgLy8gYXQgdGhpcyBwb2ludCwgd2UgaGF2ZSBjb21wbGV0ZWQgXCJzdGVwIDIgYW5kIDNcIiBhcyBzaG93biBpbiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1oeXBlcnR5Lm1kXHJcbiAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDE6IHJldHVybiBoeXBlcnR5IGRlc2NyaXB0b3I6ICcsIF9oeXBlcnR5RGVzY3JpcHRvcik7XHJcblxyXG5cclxuICAgICAgX2h5cGVydHlTYW5kYm94ID0gdGhpcy5yZWdpc3RyeS5nZXRBcHBTYW5kYm94KCk7XHJcblxyXG5cclxuXHJcbiAgICAgIGxldCBudW1iZXJPZkFkZHJlc3NlcyA9IDE7XHJcbiAgICAgIC8vZGVidWdnZXI7XHJcbiAgICAgIHRoaXMuX2FkZHJlc3NBbGxvY2F0aW9uLmNyZWF0ZSh0aGlzLl9yZWdpc3RyeS5fZG9tYWluLCBudW1iZXJPZkFkZHJlc3NlcywgX2h5cGVydHlEZXNjcmlwdG9yLCAnaHlwZXJ0eScsIHJldXNlVVJMKVxyXG4gICAgICAudGhlbigoYWRkcmVzc2VzKSA9PiB7XHJcbiAgICAgICAgaWYgKGhhdmVFcnJvcikgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDY6IHJldHVybiB0aGUgYWRkcmVzc2VzIGZvciB0aGUgaHlwZXJ0eScsIGFkZHJlc3Nlcyk7XHJcblxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIGh5cGVydHlcclxuICAgICAgICByZXR1cm4gdGhpcy5yZWdpc3RyeS5yZWdpc3Rlckh5cGVydHkoX2h5cGVydHlTYW5kYm94LCBoeXBlcnR5LCBfaHlwZXJ0eURlc2NyaXB0b3IsIGFkZHJlc3NlcywgSWRwQ29uc3RyYWludCk7XHJcbiAgICAgIH0sIGhhbmRsZUVycm9yKVxyXG4gICAgICAudGhlbigocmVnaXN0cmF0aW9uUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgaWYgKGhhdmVFcnJvcikgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDc6IHJlZ2lzdHJhdGlvbiByZXN1bHQnLCByZWdpc3RyYXRpb25SZXN1bHQpO1xyXG5cclxuICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIDE2IG9mIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LWh5cGVydHkubWQgcmlnaHQgbm93LlxyXG4gICAgICAgIF9oeXBlcnR5VVJMID0gcmVnaXN0cmF0aW9uUmVzdWx0LnVybDtcclxuXHJcbiAgICAgICAgLy8gRXh0ZW5kIG9yaWdpbmFsIGh5cGVydHkgY29uZmlndXJhdGlvbjtcclxuICAgICAgICBsZXQgY29uZmlndXJhdGlvbiA9IHt9O1xyXG4gICAgICAgIGlmICghZW1wdHlPYmplY3QoX2h5cGVydHlEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb24pKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25maWd1cmF0aW9uID0gT2JqZWN0LmFzc2lnbih7fSwgSlNPTi5wYXJzZShfaHlwZXJ0eURlc2NyaXB0b3IuY29uZmlndXJhdGlvbikpO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25maWd1cmF0aW9uID0gX2h5cGVydHlEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb247XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTCA9IHRoaXMuX3J1bnRpbWVVUkw7XHJcblxyXG4gICAgICAgIGlmIChyZWdpc3RyYXRpb25SZXN1bHQucDJwSGFuZGxlcikge1xyXG4gICAgICAgICAgY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyID0gcmVnaXN0cmF0aW9uUmVzdWx0LnAycEhhbmRsZXI7XHJcbiAgICAgICAgICBjb25maWd1cmF0aW9uLnAycFJlcXVlc3RlciA9IHJlZ2lzdHJhdGlvblJlc3VsdC5wMnBSZXF1ZXN0ZXI7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgLy8gV2Ugd2lsbCBkZXBsb3kgdGhlIGNvbXBvbmVudCAtIHN0ZXAgMTcgb2YgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktaHlwZXJ0eS5tZCByaWdodCBub3cuXHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyAgICAgICAgICAgIHJldHVybiBfaHlwZXJ0eVNhbmRib3guZGVwbG95Q29tcG9uZW50KF9oeXBlcnR5U291cmNlUGFja2FnZS5zb3VyY2VDb2RlLCBfaHlwZXJ0eVVSTCwgY29uZmlndXJhdGlvbik7XHJcbiAgICAgICAgICByZXR1cm4gX2h5cGVydHlTYW5kYm94LmRlcGxveUNvbXBvbmVudChpbnN0YW5jZSwgX2h5cGVydHlVUkwsIGNvbmZpZ3VyYXRpb24pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIEVycm9yIG9uIGRlcGxveSBjb21wb25lbnQ6JywgZSk7XHJcbiAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCBoYW5kbGVFcnJvcilcclxuICAgICAgLnRoZW4oKGRlcGxveUNvbXBvbmVudFN0YXR1cykgPT4ge1xyXG4gICAgICAgIGlmIChoYXZlRXJyb3IpIHJldHVybiBmYWxzZTtcclxuICAgICAgICBsb2cuaW5mbygnW1J1bnRpbWUuTG9hZGVyXSA4OiBEZXBsb3kgY29tcG9uZW50IHN0YXR1cyBmb3IgaHlwZXJ0eTogJywgZGVwbG95Q29tcG9uZW50U3RhdHVzKTtcclxuXHJcbiAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCAxOSBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1oeXBlcnR5Lm1kIHJpZ2h0IG5vdy5cclxuXHJcbiAgICAgICAgLy8gQWRkIHRoZSBtZXNzYWdlIGJ1cyBsaXN0ZW5lciB0byB0aGUgYXBwU2FuZGJveCBvciBoeXBlcnRTYW5kYm94O1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihfaHlwZXJ0eVVSTCwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgX2h5cGVydHlTYW5kYm94LnBvc3RNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIEFkZCB0aGUgbWVzc2FnZSBidXMgbGlzdGVuZXIgdG8gdGhlIGFwcFNhbmRib3ggb3IgaHlwZXJ0U2FuZGJveDtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuYWRkTGlzdGVuZXIodGhpcy5ydW50aW1lVVJMICsgJy9zdGF0dXMnLCAobXNnKSA9PiB7XHJcbiAgICAgICAgICBfaHlwZXJ0eVNhbmRib3gucG9zdE1lc3NhZ2UobXNnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCAyMCBvZiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1oeXBlcnR5Lm1kIHJpZ2h0IG5vdy5cclxuICAgICAgICBsZXQgZGVwbG95ZWQgPSB7XHJcbiAgICAgICAgICBydW50aW1lSHlwZXJ0eVVSTDogX2h5cGVydHlVUkwsXHJcbiAgICAgICAgICBzdGF0dXM6IGRlcGxveUNvbXBvbmVudFN0YXR1cyxcclxuICAgICAgICAgIG5hbWU6IGh5cGVydHksXHJcbiAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2VcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsb2cuaW5mbygnW1J1bnRpbWUuTG9hZGVyXSBIeXBlcnR5IGRlcGxveWVkOiAnLCBkZXBsb3llZCk7XHJcbiAgICAgICAgcmVzb2x2ZShpbnN0YW5jZSk7XHJcblxyXG4gICAgICAgIC8vIHdlIGhhdmUgY29tcGxldGVkIHN0ZXAgMjEgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktaHlwZXJ0eS5tZCByaWdodCBub3cuXHJcbiAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlcl0gLS0tLS0tLS0tLS0tLS0tLS0tIEVORCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcclxuICAgICAgfSwgaGFuZGxlRXJyb3IpXHJcbiAgICAgIC5jYXRjaChlcnJvclJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBEZXBsb3kgU3R1YiBmcm9tIENhdGFsb2d1ZSBVUkwgb3IgZG9tYWluIHVybFxyXG4gICogQHBhcmFtICB7VVJMLlVSTH0gICAgIHByb3Rvc3R1YlVSTCAgICBDYXRhbG9ndWUgVVJMIGZvciB0aGUgUHJvdG9TdHViIHRvIGJlIGxvYWRlZCBvciB0aGUgZG9tYWluIHRvIGJlIHRhcmdldCBieSB0aGUgcHJvdG9zdHViXHJcbiAgKiBAcGFyYW0gIHtPYmplY3R9ICAgICAgcDJwQ29uZmlnICAgICAgIGNvbmZpZ3VyYXRpb24gb2YgcDJwXHJcbiAgKi9cclxuICBsb2FkU3R1Yihwcm90b3N0dWJVUkwsIHAycENvbmZpZykge1xyXG5cclxuICAgIGlmICghdGhpcy5fcmVhZHlUb1VzZSgpKSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAoIXByb3Rvc3R1YlVSTCkgdGhyb3cgbmV3IEVycm9yKCdbUnVudGltZS5Mb2FkZXIubG9hZFN0dWJdUHJvdG9TdHViIGRlc2NyaXB0b3IgdXJsIHBhcmFtZXRlciBpcyBuZWVkZWQnKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgLy8gdG8gYW5hbHlzZSBpZiBkb21haW4gZm9yIHAycEhhbmRsZXJzIHNob3VsZCBiZSBzb21ldGhpbmcgZWxzZSBhbmQgbm90IHRoZSBkZWZhdWx0IGRvbWFpbiBpdHNlbGZcclxuXHJcbiAgICAgIGxldCBkb21haW4gPSBkaXZpZGVVUkwocHJvdG9zdHViVVJMKS5kb21haW47XHJcblxyXG4gICAgICBpZiAoIWRvbWFpbikge1xyXG4gICAgICAgIGRvbWFpbiA9IHByb3Rvc3R1YlVSTDtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IF9zdHViU2FuZGJveDtcclxuICAgICAgbGV0IF9zdHViRGVzY3JpcHRvcjtcclxuICAgICAgbGV0IF9ydW50aW1lUHJvdG9TdHViVVJMO1xyXG4gICAgICBsZXQgX3N0dWJTb3VyY2VQYWNrYWdlO1xyXG4gICAgICBsZXQgaGF2ZUVycm9yID0gZmFsc2U7XHJcbiAgICAgIGxldCBzdHViSWQ7XHJcblxyXG4gICAgICBsZXQgZXJyb3JSZWFzb24gPSAocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlci5sb2FkU3R1Yl1Tb21ldGhpbmcgZmFpbGVkIG9uIHRoZSBkZXBsb3kgb2YgcHJvdG9jb2xzdHViOiAnLCByZWFzb24pO1xyXG4gICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgbGV0IGhhbmRsZUVycm9yID0gKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGhhdmVFcnJvciA9IHRydWU7XHJcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBEaXNjb3ZlciBQcm90b2NvbCBTdHViXHJcbiAgICAgIGxldCBkaXNjb3ZlclN0dWI7XHJcbiAgICAgIGxldCBpc1AyUEhhbmRsZXIgPSBmYWxzZTtcclxuICAgICAgbGV0IGlzUDJQUmVxdWVzdGVyID0gZmFsc2U7XHJcbiAgICAgIGxldCBzdHViQ2FwYWJpbGl0aWVzID0ge307XHJcblxyXG4gICAgICBsb2cuaW5mbygnW1J1bnRpbWUuTG9hZGVyLmxvYWRTdHViXSBzdGFydGluZyBsb2FkaW5nIGZvciAnLCBwcm90b3N0dWJVUkwsICcgd2l0aCBwMnBjb25maWcgJywgcDJwQ29uZmlnKTtcclxuICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlci5sb2FkU3R1Yl1EaXNjb3ZlciBvciBDcmVhdGUgYSBuZXcgUHJvdG9TdHViIGZvciBkb21haW46ICcsIGRvbWFpbik7XHJcblxyXG4gICAgICAvLyBzdGVwIDIgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKHAycENvbmZpZykge1xyXG5cclxuICAgICAgICAgIGlmIChwMnBDb25maWcuaGFzT3duUHJvcGVydHkoJ2lzSGFuZGxlclN0dWInKSAmJiBwMnBDb25maWcuaXNIYW5kbGVyU3R1Yikge1xyXG4gICAgICAgICAgICAvLyBzdGVwIDYgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICAgIGlzUDJQSGFuZGxlciA9IHRydWU7XHJcbiAgICAgICAgICAgIHN0dWJJZCA9IHRoaXMucnVudGltZVVSTDtcclxuICAgICAgICAgICAgZGlzY292ZXJTdHViID0gdGhpcy5yZWdpc3RyeS5kaXNjb3ZlclAyUFN0dWIoKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlzUDJQUmVxdWVzdGVyID0gdHJ1ZTtcclxuICAgICAgICAgICAgbGV0IHAycEhhbmRsZXJSdW50aW1lVVJMID0gcDJwQ29uZmlnLnJlbW90ZVJ1bnRpbWVVUkw7XHJcbiAgICAgICAgICAgIHN0dWJJZCA9IHAycEhhbmRsZXJSdW50aW1lVVJMO1xyXG5cclxuICAgICAgICAgICAgLy8gc3RlcCA0IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG5cclxuICAgICAgICAgICAgLy8gc3RlcCA1IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgICAgICBkaXNjb3ZlclN0dWIgPSB0aGlzLnJlZ2lzdHJ5LmRpc2NvdmVyUDJQU3R1YihwMnBIYW5kbGVyUnVudGltZVVSTCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBzdGVwIDMgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICBzdHViSWQgPSBkb21haW47XHJcbiAgICAgICAgICBkaXNjb3ZlclN0dWIgPSB0aGlzLnJlZ2lzdHJ5LmRpc2NvdmVyUHJvdG9zdHViKGRvbWFpbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJcyByZWdpc3RlZD9cclxuICAgICAgICBsb2cuaW5mbygnW1J1bnRpbWUuTG9hZGVyLmxvYWRTdHViXTEuIFByb3RvIFN0dWIgRGlzY292ZXJlZCBmb3IgJywgcHJvdG9zdHViVVJMLCAnOiAnLCBkaXNjb3ZlclN0dWIpO1xyXG5cclxuICAgICAgICAvLyBzdGVwIDIzIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgIHJlc29sdmUoZGlzY292ZXJTdHViKTtcclxuICAgICAgICBsb2cuaW5mbygnIFtSdW50aW1lLkxvYWRlcl0tLS0tLS0tLS0tLS0tLS0tLS0tIEVORCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cXG4nKTtcclxuXHJcbiAgICAgIH0gY2F0Y2ggKHJlYXNvbikge1xyXG5cclxuICAgICAgICAvLyBpcyBub3QgcmVnaXN0ZWQ/XHJcbiAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlci5sb2FkU3R1Yl0xLiBQcm90byBTdHViIG5vdCBmb3VuZCAnICsgcmVhc29uKTtcclxuXHJcbiAgICAgICAgLy8gc3RlcCA4IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRvcnMuZ2V0U3R1YkRlc2NyaXB0b3IocHJvdG9zdHViVVJMKVxyXG4gICAgICAgICAgLnRoZW4oKHN0dWJEZXNjcmlwdG9yKSA9PiB7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGF2ZUVycm9yKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXIubG9hZFN0dWJdMi4gcmV0dXJuIHRoZSBQcm90b1N0dWIgZGVzY3JpcHRvcicpO1xyXG5cclxuICAgICAgICAgICAgLy8gc3RlcCA5IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgICAgICBfc3R1YkRlc2NyaXB0b3IgPSBzdHViRGVzY3JpcHRvcjtcclxuXHJcbiAgICAgICAgICAgIGxldCBzb3VyY2VQYWNrYWdlVVJMID0gc3R1YkRlc2NyaXB0b3Iuc291cmNlUGFja2FnZVVSTDtcclxuXHJcbiAgICAgICAgICAgIGlmIChzb3VyY2VQYWNrYWdlVVJMID09PSAnL3NvdXJjZVBhY2thZ2UnKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHN0dWJEZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHN0ZXAgMTAgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJ1bnRpbWVDYXRhbG9ndWUuZ2V0U291cmNlUGFja2FnZUZyb21VUkwoc291cmNlUGFja2FnZVVSTCk7XHJcbiAgICAgICAgICB9LCBoYW5kbGVFcnJvcilcclxuICAgICAgICAgIC5jYXRjaChlcnJvclJlYXNvbilcclxuICAgICAgICAgIC50aGVuKChzdHViU291cmNlUGFja2FnZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaGF2ZUVycm9yKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAvLyBBY2NvcmRpbmcgdG8gZGVidWcsIGl0IHNlZW1zIFJ1bnRpbWVDYXRhbG9ndWUgZG9lcyBub3Qgc3VwcG9ydCB5ZXQgY29uc3RyYWludHMuIEl0IGFwcGVhcnMgZW1wdHkhISEhXHJcblxyXG4gICAgICAgICAgICBpZiAoX3N0dWJEZXNjcmlwdG9yICYmIF9zdHViRGVzY3JpcHRvci5jb25zdHJhaW50cykge1xyXG4gICAgICAgICAgICAgIHN0dWJDYXBhYmlsaXRpZXMgPSBfc3R1YkRlc2NyaXB0b3IuY29uc3RyYWludHM7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHN0ZXAgMTEgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXIubG9hZFN0dWJdMy4gcmV0dXJuIHRoZSBQcm90b1N0dWIgU291cmNlIENvZGUnKTtcclxuICAgICAgICAgICAgX3N0dWJTb3VyY2VQYWNrYWdlID0gc3R1YlNvdXJjZVBhY2thZ2U7XHJcblxyXG4gICAgICAgICAgICAvLyB0aGlzIHdpbGwgcmV0dXJuIHRoZSBzYW5kYm94IG9yIG9uZSBwcm9taXNlIHRvIGdldFNhbmRib3g7XHJcbiAgICAgICAgICAgIC8vIHN0ZXAgMTIgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlZ2lzdHJ5LmdldFNhbmRib3goZG9tYWluLCBzdHViQ2FwYWJpbGl0aWVzKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAudGhlbigoc3R1YlNhbmRib3gpID0+IHtcclxuICAgICAgICAgICAgaWYgKGhhdmVFcnJvcikgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgLy8gc3RlcCAxNSBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWRcclxuICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlci5sb2FkU3R1Yl00LiBpZiB0aGUgc2FuZGJveCBpcyByZWdpc3RlcmVkIHRoZW4gcmV0dXJuIHRoZSBzYW5kYm94ICcsIHN0dWJTYW5kYm94KTtcclxuXHJcbiAgICAgICAgICAgIF9zdHViU2FuZGJveCA9IHN0dWJTYW5kYm94O1xyXG4gICAgICAgICAgICByZXR1cm4gc3R1YlNhbmRib3g7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICAgICAgaWYgKGhhdmVFcnJvcikgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgLy8gc3RlcCAxMyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWRcclxuICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlci5sb2FkU3R1Yl01LiBTYW5kYm94IHdhcyBub3QgZm91bmQsIGNyZWF0aW5nIGEgbmV3IG9uZSAnLCByZWFzb24pO1xyXG5cclxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNhbmRib3ggaXMgcmVnaXN0ZWQgZm9yIHRoaXMgc3R1YiBkZXNjcmlwdG9yIHVybDtcclxuXHJcblxyXG4gICAgICAgICAgICAvLyBzdGVwIDE0IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcnVudGltZUZhY3RvcnkuY3JlYXRlU2FuZGJveChzdHViQ2FwYWJpbGl0aWVzKS50aGVuKChzYW5kYm94KSA9PiB7XHJcbiAgICAgICAgICAgICAgc2FuZGJveC5hZGRMaXN0ZW5lcignKicsIChtc2cpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gc2FuZGJveDtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC50aGVuKChzYW5kYm94KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChoYXZlRXJyb3IpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIC8vIHN0ZXAgMTYgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXIubG9hZFN0dWJdNi4gcmV0dXJuIHRoZSBzYW5kYm94IGluc3RhbmNlIGFuZCByZWdpc3RlcicsIHNhbmRib3gsICd0byBkb21haW4gJywgZG9tYWluKTtcclxuXHJcbiAgICAgICAgICAgIF9zdHViU2FuZGJveCA9IHNhbmRib3g7XHJcblxyXG4gICAgICAgICAgICAvLyB3ZSBuZWVkIHJlZ2lzdGVyIHN0dWIgb24gcmVnaXN0cnkgLSBzdGVwIHh4eCBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWRcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVnaXN0cnkucmVnaXN0ZXJTdHViKF9zdHViU2FuZGJveCwgc3R1YklkLCBwMnBDb25maWcsIHByb3Rvc3R1YlVSTCwgX3N0dWJEZXNjcmlwdG9yKTtcclxuICAgICAgICAgIH0sIGhhbmRsZUVycm9yKVxyXG4gICAgICAgICAgLnRoZW4oKHJ1bnRpbWVQcm90b1N0dWIpID0+IHtcclxuICAgICAgICAgICAgaWYgKGhhdmVFcnJvcikgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgLy8gc3RlcCAyMyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWRcclxuICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlci5sb2FkU3R1Yl0gNy4gcmV0dXJuIHRoZSBydW50aW1lIHByb3Rvc3R1YiB1cmw6ICcsIHJ1bnRpbWVQcm90b1N0dWIpO1xyXG5cclxuICAgICAgICAgICAgX3J1bnRpbWVQcm90b1N0dWJVUkwgPSBydW50aW1lUHJvdG9TdHViLnVybDtcclxuXHJcbiAgICAgICAgICAgIC8vIEV4dGVuZCBvcmlnaW5hbCBoeXBlcnR5IGNvbmZpZ3VyYXRpb247XHJcbiAgICAgICAgICAgIGxldCBjb25maWd1cmF0aW9uID0ge307XHJcbiAgICAgICAgICAgIGlmICghZW1wdHlPYmplY3QoX3N0dWJEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gPSBPYmplY3QuYXNzaWduKHt9LCBKU09OLnBhcnNlKF9zdHViRGVzY3JpcHRvci5jb25maWd1cmF0aW9uKSk7XHJcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbiA9IF9zdHViRGVzY3JpcHRvci5jb25maWd1cmF0aW9uO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHAycENvbmZpZykge1xyXG4gICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uID0gT2JqZWN0LmFzc2lnbihjb25maWd1cmF0aW9uLCBKU09OLnBhcnNlKHAycENvbmZpZykpO1xyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gPSBPYmplY3QuYXNzaWduKGNvbmZpZ3VyYXRpb24sIHAycENvbmZpZyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyByZXF1aXJlZCBmb3IgcHJvdG9zdHViIHNlc3Npb25cclxuXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTCA9IHRoaXMuX3J1bnRpbWVVUkw7XHJcblxyXG4gICAgICAgICAgICAvLyBzdGVwIDI0IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIC8vIHN0ZXAgMjYgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlci5sb2FkU3R1Yl0gODogYWRkaW5nIHNhbmRib3ggbGlzdGVuZXIgdG8gcHJvdG9zdHViVVJMIDogJywgX3J1bnRpbWVQcm90b1N0dWJVUkwpO1xyXG5cclxuICAgICAgICAgICAgICAvLyBzdGVwIDI3IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgICAgICAgIC8vIEFkZCB0aGUgbWVzc2FnZSBidXMgbGlzdGVuZXJcclxuICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuYWRkTGlzdGVuZXIoX3J1bnRpbWVQcm90b1N0dWJVUkwsIChtc2cpID0+IHtcclxuICAgICAgICAgICAgICAgIF9zdHViU2FuZGJveC5wb3N0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gX3N0dWJTYW5kYm94LmRlcGxveUNvbXBvbmVudChfc3R1YlNvdXJjZVBhY2thZ2Uuc291cmNlQ29kZSwgX3J1bnRpbWVQcm90b1N0dWJVUkwsIGNvbmZpZ3VyYXRpb24pO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgbG9nLmVycm9yKCdbUnVudGltZS5Mb2FkZXIubG9hZFN0dWJdIEVycm9yIG9uIGRlcGxveSBjb21wb25lbnQ6JywgZSk7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LCBoYW5kbGVFcnJvcilcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKGhhdmVFcnJvcikgcmV0dXJuIGZhbHNlO1xyXG5cclxuXHJcbiAgICAgICAgICAgIC8vIHN0ZXAgMjggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICAgIGxldCBzdHViO1xyXG4gICAgICAgICAgICBpZiAocDJwQ29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgbG9nLmxvZygnW1J1bnRpbWUuTG9hZGVyLmxvYWRTdHViXSBwMnBDb25maWc6ICcsIHAycENvbmZpZyk7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChwMnBDb25maWcuaGFzT3duUHJvcGVydHkoJ2lzSGFuZGxlclN0dWInKSkgc3R1YiA9IHRoaXMucmVnaXN0cnkucDJwSGFuZGxlclN0dWJbdGhpcy5fcnVudGltZVVSTF07XHJcbiAgICAgICAgICAgICAgaWYgKHAycENvbmZpZy5oYXNPd25Qcm9wZXJ0eSgncDJwUmVxdWVzdGVyU3R1YicpKSBzdHViID0gdGhpcy5yZWdpc3RyeS5wMnBSZXF1ZXN0ZXJTdHViW3AycENvbmZpZy5yZW1vdGVSdW50aW1lVVJMXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBzdHViID0gdGhpcy5yZWdpc3RyeS5wcm90b3N0dWJzTGlzdFtkb21haW5dO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsb2cubG9nKCdbUnVudGltZS5Mb2FkZXIubG9hZFN0dWJdIFN0dWI6ICcsIHN0dWIpO1xyXG4gICAgICAgICAgICByZXNvbHZlKHN0dWIpO1xyXG4gICAgICAgICAgICBsb2cuaW5mbygnW1J1bnRpbWUuTG9hZGVyLmxvYWRTdHViXS0tLS0tLS0tLS0tLS0tLS0tLS0gRU5EIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcbicpO1xyXG4gICAgICAgICAgfSwgaGFuZGxlRXJyb3IpXHJcbiAgICAgICAgICAuY2F0Y2goZXJyb3JSZWFzb24pO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogRGVwbG95IGlkcFByb3h5IGZyb20gQ2F0YWxvZ3VlIFVSTCBvciBkb21haW4gdXJsXHJcbiAgKiBAcGFyYW0gIHtVUkwuVVJMfSAgICAgZG9tYWluICAgICAgICAgIGRvbWFpblxyXG4gICovXHJcblxyXG4gIGxvYWRJZHBQcm94eShpZHBQcm94eVVSTCkge1xyXG5cclxuICAgIGlmICghdGhpcy5fcmVhZHlUb1VzZSgpKSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAoIWlkcFByb3h5VVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1tSdW50aW1lLkxvYWRlcl0gSWRwUHJveHkgZGVzY3JpcHRvciB1cmwgcGFyYW1ldGVyIGlzIG5lZWRlZCcpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgZG9tYWluID0gZGl2aWRlVVJMKGlkcFByb3h5VVJMKS5kb21haW47XHJcblxyXG4gICAgICBpZiAoIWRvbWFpbikge1xyXG4gICAgICAgIGRvbWFpbiA9IGlkcFByb3h5VVJMO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgX3Byb3h5U2FuZGJveDtcclxuICAgICAgbGV0IF9wcm94eURlc2NyaXB0b3I7XHJcbiAgICAgIGxldCBfcnVudGltZUlkcFByb3h5VVJMO1xyXG4gICAgICBsZXQgX3Byb3h5U291cmNlUGFja2FnZTtcclxuICAgICAgbGV0IGhhdmVFcnJvciA9IGZhbHNlO1xyXG5cclxuICAgICAgbGV0IGVycm9yUmVhc29uID0gKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIFNvbWV0aGluZyBmYWlsZWQgb24gdGhlIGRlcGxveSBvZiBJZHBQcm94eTogJywgcmVhc29uKTtcclxuICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGxldCBoYW5kbGVFcnJvciA9IChyZWFzb24pID0+IHtcclxuICAgICAgICBoYXZlRXJyb3IgPSB0cnVlO1xyXG4gICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gRGlzY292ZXIgSURQUHJveHlcclxuICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlcl0gLS0tLS0tLS0tLS0tLS0tLS0tLSBJRFAgUHJveHkgRGVwbG95IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcbicpO1xyXG4gICAgICBsb2cuaW5mbygnW1J1bnRpbWUuTG9hZGVyXSBEaXNjb3ZlciBvciBDcmVhdGUgYSBuZXcgSWRwUHJveHkgZm9yIGRvbWFpbi9VUkw6ICcsIGRvbWFpbik7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGxldCBydW50aW1lSWRwUHJveHlVUkwgPSB0aGlzLnJlZ2lzdHJ5LmRpc2NvdmVySWRwUHJveHkoZG9tYWluKTtcclxuXHJcbiAgICAgICAgLy8gSXMgcmVnaXN0ZWQ/XHJcbiAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlcl0gMS4gSURQUHJveHkgRGlzY292ZXJlZDogJywgcnVudGltZUlkcFByb3h5VVJMKTtcclxuXHJcbiAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCAyIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG5cclxuICAgICAgICBsZXQgaWRwUHJveHkgPSB0aGlzLnJlZ2lzdHJ5LmlkcFByb3h5TGlzdFtkb21haW5dO1xyXG4gICAgICAgIGxvZy5sb2coJ0RlcGxveWVkOiAnLCBpZHBQcm94eSk7XHJcblxyXG4gICAgICAgIHJlc29sdmUoaWRwUHJveHkpO1xyXG4gICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIC0tLS0tLS0tLS0tLS0tLS0tLS0gRU5EIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcbicpO1xyXG4gICAgICB9IGNhdGNoIChyZWFzb24pIHtcclxuXHJcbiAgICAgICAgLy8gaXMgbm90IHJlZ2lzdGVkP1xyXG4gICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDEuIElkcFByb3h5IG5vdCBmb3VuZDonLCByZWFzb24pO1xyXG5cclxuICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIDMgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcblxyXG4gICAgICAgIC8vIHdlIG5lZWQgdG8gZ2V0IFByb3RvU3R1YiBkZXNjcmlwdG9yIHN0ZXAgNCBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWRcclxuICAgICAgICB0aGlzLmRlc2NyaXB0b3JzLmdldElkcFByb3h5RGVzY3JpcHRvcihpZHBQcm94eVVSTClcclxuICAgICAgICAgIC50aGVuKChwcm94eURlc2NyaXB0b3IpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDIuIFJldHVybiB0aGUgSURQUHJveHkgZGVzY3JpcHRvcicpO1xyXG5cclxuICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCA1IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgICAgICBfcHJveHlEZXNjcmlwdG9yID0gcHJveHlEZXNjcmlwdG9yO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNvdXJjZVBhY2thZ2VVUkwgPSBwcm94eURlc2NyaXB0b3Iuc291cmNlUGFja2FnZVVSTDtcclxuXHJcbiAgICAgICAgICAgIGlmIChzb3VyY2VQYWNrYWdlVVJMID09PSAnL3NvdXJjZVBhY2thZ2UnKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHByb3h5RGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGdldCBQcm90b1N0dWIgU291cmNlIGNvZGUgZnJvbSBkZXNjcmlwdG9yIC0gc3RlcCA2IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ydW50aW1lQ2F0YWxvZ3VlLmdldFNvdXJjZVBhY2thZ2VGcm9tVVJMKHNvdXJjZVBhY2thZ2VVUkwpO1xyXG4gICAgICAgICAgfSwgaGFuZGxlRXJyb3IpXHJcbiAgICAgICAgICAudGhlbigoc291cmNlUGFja2FnZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaGF2ZUVycm9yKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDMuIHJldHVybiB0aGUgSURQUHJveHkgc291cmNlIHBhY2thZ2UnKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHdlIGhhdmUgY29tcGxldGVkIHN0ZXAgNyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWRcclxuXHJcbiAgICAgICAgICAgIF9wcm94eVNvdXJjZVBhY2thZ2UgPSBzb3VyY2VQYWNrYWdlO1xyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogQ2hlY2sgb24gUEVQIChwb2xpY3kgRW5naW5lKSBpZiB3ZSBuZWVkIHRoZSBzYW5kYm94IGFuZCBjaGVjayBpZiB0aGUgU2FuZGJveCBGYWN0b3J5IGhhdmUgdGhlIGNvbnRleHQgc2FuZGJveDtcclxuICAgICAgICAgICAgbGV0IHBvbGljeSA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiBwb2xpY3k7XHJcbiAgICAgICAgICB9LCBoYW5kbGVFcnJvcilcclxuICAgICAgICAgIC50aGVuKChwb2xpY3kpID0+IHtcclxuICAgICAgICAgICAgaWYgKGhhdmVFcnJvcikgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHJldHVybiB0aGUgc2FuZGJveCBvciBvbmUgcHJvbWlzZSB0byBnZXRTYW5kYm94O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWdpc3RyeS5nZXRTYW5kYm94KGRvbWFpbik7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLnRoZW4oKHByb3h5U2FuZGJveCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaGF2ZUVycm9yKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDQuIGlmIHRoZSBzYW5kYm94IGlzIHJlZ2lzdGVyZWQgdGhlbiByZXR1cm4gdGhlIHNhbmRib3gnLCBwcm94eVNhbmRib3gpO1xyXG5cclxuICAgICAgICAgICAgX3Byb3h5U2FuZGJveCA9IHByb3h5U2FuZGJveDtcclxuICAgICAgICAgICAgcmV0dXJuIHByb3h5U2FuZGJveDtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaGF2ZUVycm9yKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDUuIFNhbmRib3ggd2FzIG5vdCBmb3VuZCwgY3JlYXRpbmcgYSBuZXcgb25lJywgcmVhc29uKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwcm94eUNhcGFiaWxpdGllcyA9IHt9O1xyXG4gICAgICAgICAgICBpZiAoX3Byb3h5RGVzY3JpcHRvciAmJiBfcHJveHlEZXNjcmlwdG9yLmhhc093blByb3BlcnR5KCdjYXBhYmlsaXRpZXMnKSkge1xyXG4gICAgICAgICAgICAgIF9wcm94eURlc2NyaXB0b3IgPSBfcHJveHlEZXNjcmlwdG9yLnN0dWJDYXBhYmlsaXRpZXM7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9ydW50aW1lRmFjdG9yeS5jcmVhdGVTYW5kYm94KHByb3h5Q2FwYWJpbGl0aWVzKS50aGVuKChzYW5kYm94KSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgIHNhbmRib3guYWRkTGlzdGVuZXIoJyonLCAobXNnKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnKTtcclxuICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgcmV0dXJuIHNhbmRib3g7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC50aGVuKChzYW5kYm94KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChoYXZlRXJyb3IpIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlcl0gNi4gcmV0dXJuIHRoZSBzYW5kYm94IGluc3RhbmNlIGFuZCByZWdpc3RlcicsIHNhbmRib3gsICd0byBkb21haW4gJywgZG9tYWluKTtcclxuXHJcbiAgICAgICAgICAgIF9wcm94eVNhbmRib3ggPSBzYW5kYm94O1xyXG5cclxuICAgICAgICAgICAgLy8gd2UgbmVlZCByZWdpc3RlciBzdHViIG9uIHJlZ2lzdHJ5IC0gc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlZ2lzdHJ5LnJlZ2lzdGVySWRwUHJveHkoc2FuZGJveCwgZG9tYWluKTtcclxuICAgICAgICAgIH0sIGhhbmRsZUVycm9yKVxyXG4gICAgICAgICAgLnRoZW4oKHJ1bnRpbWVJZHBQcm94eVVSTCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaGF2ZUVycm9yKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXJdIDcuIFJldHVybiB0aGUgcnVudGltZSBJZHAgUHJveHkgVVJMOiAnLCBydW50aW1lSWRwUHJveHlVUkwpO1xyXG5cclxuICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcblxyXG4gICAgICAgICAgICBfcnVudGltZUlkcFByb3h5VVJMID0gcnVudGltZUlkcFByb3h5VVJMO1xyXG5cclxuICAgICAgICAgICAgLy8gRXh0ZW5kIG9yaWdpbmFsIGh5cGVydHkgY29uZmlndXJhdGlvbjtcclxuICAgICAgICAgICAgbGV0IGNvbmZpZ3VyYXRpb24gPSB7fTtcclxuICAgICAgICAgICAgaWYgKCFlbXB0eU9iamVjdChfcHJveHlEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gPSBPYmplY3QuYXNzaWduKHt9LCBKU09OLnBhcnNlKF9wcm94eURlc2NyaXB0b3IuY29uZmlndXJhdGlvbikpO1xyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gPSBfcHJveHlEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb247XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTCA9IHRoaXMuX3J1bnRpbWVVUkw7XHJcblxyXG4gICAgICAgICAgICAvLyBEZXBsb3kgQ29tcG9uZW50IHN0ZXAgeHh4XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcblxyXG4gICAgICAgICAgICAgIC8vIEFkZCB0aGUgbWVzc2FnZSBidXMgbGlzdGVuZXJcclxuICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMuYWRkTGlzdGVuZXIoX3J1bnRpbWVJZHBQcm94eVVSTCwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgX3Byb3h5U2FuZGJveC5wb3N0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gX3Byb3h5U2FuZGJveC5kZXBsb3lDb21wb25lbnQoX3Byb3h5U291cmNlUGFja2FnZS5zb3VyY2VDb2RlLCBydW50aW1lSWRwUHJveHlVUkwsIGNvbmZpZ3VyYXRpb24pO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lLkxvYWRlcl0gRXJyb3Igb24gZGVwbG95IGNvbXBvbmVudDonLCBlKTtcclxuICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sIGhhbmRsZUVycm9yKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaGF2ZUVycm9yKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cclxuICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kXHJcblxyXG4gICAgICAgICAgICAvLyBMb2FkIFN0dWIgZnVuY3Rpb24gcmVzb2x2ZWQgd2l0aCBzdWNjZXNzO1xyXG4gICAgICAgICAgICAvLyBsZXQgaWRwUHJveHkgPSB7XHJcbiAgICAgICAgICAgIC8vICAgcnVudGltZUlkcFByb3h5VVJMOiBfcnVudGltZUlkcFByb3h5VVJMLFxyXG4gICAgICAgICAgICAvLyAgIHN0YXR1czogZGVwbG95Q29tcG9uZW50U3RhdHVzXHJcbiAgICAgICAgICAgIC8vIH07XHJcblxyXG4gICAgICAgICAgICAvL3RoaXMucmVnaXN0cnkuaWRwUHJveHlMaXN0W2RvbWFpbl0uc3RhdHVzID0gJ2RlcGxveWVkJztcclxuICAgICAgICAgICAgbGV0IGlkcFByb3h5ID0gdGhpcy5yZWdpc3RyeS5pZHBQcm94eUxpc3RbZG9tYWluXTtcclxuXHJcbiAgICAgICAgICAgIGxvZy5sb2coJ1tSdW50aW1lLkxvYWRlci5sb2FkSWRwUHJveHldIDg6IGxvYWRlZDogJywgaWRwUHJveHkpO1xyXG5cclxuICAgICAgICAgICAgcmVzb2x2ZShpZHBQcm94eSk7XHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZS5Mb2FkZXIubG9hZElkcFByb3h5XSAtLS0tLS0tLS0tLS0tLS0tLS0tIEVORCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cXG4nKTtcclxuXHJcbiAgICAgICAgICB9LCBoYW5kbGVFcnJvcilcclxuICAgICAgICAgIC5jYXRjaChlcnJvclJlYXNvbik7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIHRoZSBsb2FkZXIgaXMgcmVhZHkgdG8gbG9hZCBhbGwgY29tcG9uZW50c1xyXG4gIF9yZWFkeVRvVXNlKCkge1xyXG5cclxuICAgIGxldCBzdGF0dXMgPSBmYWxzZTtcclxuXHJcbiAgICBpZiAoIXRoaXMuX3J1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcignW1J1bnRpbWUuTG9hZGVyXSBUaGUgbG9hZGVyIG5lZWQgdGhlIHJ1bnRpbWUgdXJsIGFkZHJlc3MnKTtcclxuICAgIGlmICghdGhpcy5fbWVzc2FnZXNCdXMpIHRocm93IG5ldyBFcnJvcignW1J1bnRpbWUuTG9hZGVyXSBUaGUgbG9hZGVyIG5lZWQgdGhlIG1lc3NhZ2VCdXMgY29tcG9uZW50Jyk7XHJcbiAgICBpZiAoIXRoaXMuX3JlZ2lzdHJ5KSB0aHJvdyBuZXcgRXJyb3IoJ1tSdW50aW1lLkxvYWRlcl0gVGhlIGxvYWRlciBuZWVkIHRoZSByZWdpc3RyeSBjb21wb25lbnQnKTtcclxuICAgIGlmICghdGhpcy5fcnVudGltZUZhY3RvcnkpIHRocm93IG5ldyBFcnJvcignW1J1bnRpbWUuTG9hZGVyXSBUaGUgbG9hZGVyIG5lZWQgdGhlIHJ1bnRpbWUgZmFjdG9yeSBjb21wb25lbnQnKTtcclxuXHJcbiAgICBzdGF0dXMgPSB0cnVlO1xyXG4gICAgcmV0dXJuIHN0YXR1cztcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBMb2FkZXI7XHJcbiIsImltcG9ydCB7IHJ1bnRpbWVDb25maWd1cmF0aW9uIH0gZnJvbSAnLi9ydW50aW1lQ29uZmlndXJhdGlvbic7XHJcblxyXG5sZXQgc3RvcmFnZXMgPSB7fTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzdG9yYWdlKHJ1bnRpbWVGYWN0b3J5LCBydW50aW1lU3RhdHVzVXBkYXRlKSB7XHJcbiAgaWYgKCFydW50aW1lRmFjdG9yeSkgdGhyb3cgbmV3IEVycm9yKCdUaGUgcnVudGltZSBmYWN0b3J5IGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO1xyXG5cclxuICBPYmplY3Qua2V5cyhydW50aW1lQ29uZmlndXJhdGlvbi5zdG9yYWdlU2NoZW1hcykuZm9yRWFjaCgoa2V5KSA9PiB7XHJcblxyXG4gICAgaWYgKCFzdG9yYWdlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgIHN0b3JhZ2VzW2tleV0gPSBydW50aW1lRmFjdG9yeS5zdG9yYWdlTWFuYWdlcihrZXksIHJ1bnRpbWVDb25maWd1cmF0aW9uLnN0b3JhZ2VTY2hlbWFzW2tleV0sIHJ1bnRpbWVTdGF0dXNVcGRhdGUpO1xyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIHN0b3JhZ2VzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3luY0RCKGtleSwgcnVudGltZUZhY3RvcnksIHNjaGVtYSwgcnVudGltZVN0YXR1c1VwZGF0ZSwgdXJsID0gZmFsc2UpIHtcclxuICBpZiAoIXJ1bnRpbWVGYWN0b3J5KSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBydW50aW1lIGZhY3RvcnkgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7XHJcblxyXG4gIGxldCByZW1vdGUgPSB1cmwgPyB1cmwgOiBydW50aW1lQ29uZmlndXJhdGlvbi5yZW1vdGVTdG9yYWdlO1xyXG5cclxuICByZXR1cm4gcnVudGltZUZhY3Rvcnkuc3RvcmFnZU1hbmFnZXIoa2V5LCBzY2hlbWEsIHJ1bnRpbWVTdGF0dXNVcGRhdGUsIHJlbW90ZSk7XHJcblxyXG59XHJcbiIsImltcG9ydCB7ZGl2aWRlVVJMLCBnZXRDb25maWd1cmF0aW9uUmVzb3VyY2VzLCBidWlsZFVSTH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBydW50aW1lVXRpbHMgfSBmcm9tICcuL3J1bnRpbWVVdGlscyc7XHJcblxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignRGVzY3JpcHRvcnMnKTtcclxuXHJcbmNsYXNzIERlc2NyaXB0b3JzIHtcclxuXHJcbiAgY29uc3RydWN0b3IocnVudGltZVVSTCwgY2F0YWxvZ3VlLCBydW50aW1lQ29uZmlndXJhdGlvbikge1xyXG4gICAgaWYgKCFydW50aW1lVVJMKSB0aHJvdyBFcnJvcignVGhlIGRlc2NyaXB0b3IgbmVlZCB0byBrbm93IHRoZSBydW50aW1lIHVybCB0byBiZSB1c2VkJyk7XHJcbiAgICBpZiAoIWNhdGFsb2d1ZSkgdGhyb3cgRXJyb3IoJ1RoZSBkZXNjcmlwdG9yIG5lZWRzIHRoZSBjYXRhbG9ndWUgaW5zdGFuY2UnKTtcclxuICAgIGlmICghcnVudGltZUNvbmZpZ3VyYXRpb24pIHRocm93IEVycm9yKCdUaGUgZGVzY3JpcHRvciBuZWVkcyB0aGUgcnVudGltZSBjb25maWd1cmF0aW9uJyk7XHJcblxyXG4gICAgdGhpcy5sb2cgPSBsb2c7XHJcblxyXG4gICAgdGhpcy5ydW50aW1lQ29uZmlndXJhdGlvbiA9IHJ1bnRpbWVDb25maWd1cmF0aW9uO1xyXG4gICAgdGhpcy5ydW50aW1lVVJMID0gcnVudGltZVVSTDtcclxuICAgIHRoaXMuY2F0YWxvZ3VlID0gY2F0YWxvZ3VlO1xyXG5cclxuICAgIHRoaXMuY29uc3RyYWludHMgPSBydW50aW1lVXRpbHMucnVudGltZUNhcGFiaWxpdGllcztcclxuICB9XHJcblxyXG4gIGdldEh5cGVydHlEZXNjcmlwdG9yKGh5cGVydHlVUkwpIHtcclxuICAgIHJldHVybiB0aGlzLmNhdGFsb2d1ZS5nZXRIeXBlcnR5RGVzY3JpcHRvcihoeXBlcnR5VVJMLCB0cnVlLCB0aGlzLmNvbnN0cmFpbnRzKTtcclxuICB9XHJcblxyXG4gIGdldFN0dWJEZXNjcmlwdG9yKHN0dWJVUkwpIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IGRvbWFpbjtcclxuICAgICAgbGV0IHByb3Rvc3R1YjtcclxuICAgICAgbGV0IHByb3RvU3R1YlVSTDtcclxuXHJcbiAgICAgIGxldCBvcmlnaW5EaXZpZGVkVVJMID0gZGl2aWRlVVJMKHRoaXMucnVudGltZVVSTCk7XHJcbiAgICAgIGxldCBvcmlnaW5Eb21haW4gPSBvcmlnaW5EaXZpZGVkVVJMLmRvbWFpbjtcclxuXHJcbiAgICAgIGlmIChzdHViVVJMLmluY2x1ZGVzKCc6Ly8nKSkge1xyXG4gICAgICAgIGxldCBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKHN0dWJVUkwpO1xyXG4gICAgICAgIGRvbWFpbiA9IGRpdmlkZWRVUkwuZG9tYWluO1xyXG4gICAgICAgIGxldCBwYXRoID0gZGl2aWRlZFVSTC5pZGVudGl0eTtcclxuXHJcbiAgICAgICAgaWYgKHBhdGgpIHtcclxuICAgICAgICAgIHByb3Rvc3R1YiA9IHBhdGguc3Vic3RyaW5nKHBhdGgubGFzdEluZGV4T2YoJy8nKSArIDEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBwcm90b3N0dWIgPSAnZGVmYXVsdCc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwcm90b3N0dWIgPSAnZGVmYXVsdCc7XHJcbiAgICAgICAgZG9tYWluID0gc3R1YlVSTDtcclxuICAgICAgfVxyXG5cclxuICAgICAgcHJvdG9TdHViVVJMID0gYnVpbGRVUkwodGhpcy5ydW50aW1lQ29uZmlndXJhdGlvbiwgJ2NhdGFsb2d1ZVVSTHMnLCAncHJvdG9jb2xzdHViJywgcHJvdG9zdHViKTtcclxuICAgICAgaWYgKGRvbWFpbiAhPT0gdGhpcy5ydW50aW1lQ29uZmlndXJhdGlvbi5kb21haW4pIHtcclxuICAgICAgICBpZiAoIXN0dWJVUkwuaW5kZXhPZignaHR0cHMnKSB8fCAhc3R1YlVSTC5pbmRleE9mKCdoeXBlcnR5LWNhdGFsb2d1ZScpKSB7XHJcbiAgICAgICAgICBwcm90b1N0dWJVUkwgPSBzdHViVVJMO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgLy8gVE9ETzogY2hlY2sgaG93IHRvIGxvYWQgZm9ybSBkaWZmZXJlbnQgY29uZmlndXJhdGlvbiBkb21haW5cclxuICAgICAgICAgIGxldCByZXNvdXJjZSA9IGdldENvbmZpZ3VyYXRpb25SZXNvdXJjZXModGhpcy5ydW50aW1lQ29uZmlndXJhdGlvbiwgJ2NhdGFsb2d1ZVVSTHMnLCAncHJvdG9jb2xzdHViJyk7XHJcbiAgICAgICAgICBwcm90b1N0dWJVUkwgPSByZXNvdXJjZS5wcmVmaXggKyBkb21haW4gKyByZXNvdXJjZS5zdWZmaXggKyBwcm90b3N0dWI7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBsb2cubG9nKCdMb2FkIFByb3RvY29sU3R1YiBmb3IgZG9tYWluLCAnICsgZG9tYWluICsgJyA6ICcsIHByb3RvU3R1YlVSTCk7XHJcbiAgICAgIHJldHVybiB0aGlzLmNhdGFsb2d1ZS5nZXRTdHViRGVzY3JpcHRvcihwcm90b1N0dWJVUkwsIHRydWUsIHRoaXMuY29uc3RyYWludHMpLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG5cclxuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcblxyXG4gICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcclxuXHJcbiAgICAgICAgLy8gbG9nLmxvZygnRXJyb3I6ICcsIGVycm9yKTtcclxuXHJcbiAgICAgICAgcHJvdG9zdHViID0gZG9tYWluO1xyXG4gICAgICAgIGRvbWFpbiA9IG9yaWdpbkRvbWFpbjtcclxuXHJcbiAgICAgICAgbGV0IHJlc291cmNlID0gZ2V0Q29uZmlndXJhdGlvblJlc291cmNlcyh0aGlzLnJ1bnRpbWVDb25maWd1cmF0aW9uLCAnY2F0YWxvZ3VlVVJMcycsICdwcm90b2NvbHN0dWInKTtcclxuICAgICAgICBwcm90b1N0dWJVUkwgPSByZXNvdXJjZS5wcmVmaXggKyBkb21haW4gKyByZXNvdXJjZS5zdWZmaXggKyBwcm90b3N0dWI7XHJcblxyXG4gICAgICAgIC8vIGxvZy5sb2coJ0ZhbGxiYWNrIC0+IExvYWQgUHJvdG9jb2xzdHViIGZvciBkb21haW4sICcgKyBkb21haW4gKyAnIDogJywgcHJvdG9zdHViKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jYXRhbG9ndWUuZ2V0U3R1YkRlc2NyaXB0b3IocHJvdG9TdHViVVJMLCB0cnVlLCB0aGlzLmNvbnN0cmFpbnRzKTtcclxuICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWRwUHJveHlEZXNjcmlwdG9yKGlkcFByb3h5VVJMKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgbGV0IGRvbWFpbjtcclxuICAgICAgbGV0IGlkcHByb3h5O1xyXG5cclxuICAgICAgbGV0IG9yaWdpbkRpdmlkZWRVUkwgPSBkaXZpZGVVUkwodGhpcy5ydW50aW1lVVJMKTtcclxuICAgICAgbGV0IG9yaWdpbkRvbWFpbiA9IG9yaWdpbkRpdmlkZWRVUkwuZG9tYWluO1xyXG4gICAgICBsZXQgY29uc3RyYWludHMgPSB0aGlzLmNvbnN0cmFpbnRzO1xyXG5cclxuICAgICAgY29uc3RyYWludHMuY29uc3RyYWludHMub25seUFjY2Vzc1Rva2VuID0gdHJ1ZTtcclxuICAgICAgY29uc3RyYWludHMuY29uc3RyYWludHMub25seUlkQXNzZXJ0aW9uVmFsaWRhdGlvbiA9IHRydWU7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdMT0cgSEVSRScsIGNvbnN0cmFpbnRzKTtcclxuICAgICAgaWYgKGlkcFByb3h5VVJMLmluY2x1ZGVzKCc6Ly8nKSkge1xyXG4gICAgICAgIGxldCBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKGlkcFByb3h5VVJMKTtcclxuICAgICAgICBkb21haW4gPSBkaXZpZGVkVVJMLmRvbWFpbjtcclxuICAgICAgICBsZXQgcGF0aCA9IGRpdmlkZWRVUkwuaWRlbnRpdHk7XHJcbiAgICAgICAgaWYgKHBhdGgpIHtcclxuICAgICAgICAgIGlkcHByb3h5ID0gcGF0aC5zdWJzdHJpbmcocGF0aC5sYXN0SW5kZXhPZignLycpICsgMSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlkcHByb3h5ID0gJ2RlZmF1bHQnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWRwcHJveHkgPSAnZGVmYXVsdCc7XHJcbiAgICAgICAgZG9tYWluID0gaWRwUHJveHlVUkw7XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgICBsZXQgcmVzb3VyY2UgPSBnZXRDb25maWd1cmF0aW9uUmVzb3VyY2VzKHRoaXMucnVudGltZUNvbmZpZ3VyYXRpb24sICdjYXRhbG9ndWVVUkxzJywgJ2lkcFByb3h5Jyk7XHJcblxyXG4gICAgICBpZHBQcm94eVVSTCA9IHJlc291cmNlLnByZWZpeCArIGRvbWFpbiArIHJlc291cmNlLnN1ZmZpeCArIGlkcHByb3h5O1xyXG4gICAgICAvLyBsb2cubG9nKCdMb2FkIElkcCBQcm94eSBmb3IgZG9tYWluLCAnICsgZG9tYWluICsgJyA6ICcsIGlkcFByb3h5VVJMKTtcclxuICAgICAgcmV0dXJuIHRoaXMuY2F0YWxvZ3VlLmdldElkcFByb3h5RGVzY3JpcHRvcihpZHBQcm94eVVSTCwgdHJ1ZSwgY29uc3RyYWludHMpLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG5cclxuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcblxyXG4gICAgICB9KS5jYXRjaCgoKSA9PiB7XHJcblxyXG4gICAgICAgIGlkcHByb3h5ID0gZG9tYWluO1xyXG4gICAgICAgIGRvbWFpbiA9IG9yaWdpbkRvbWFpbjtcclxuXHJcbiAgICAgICAgaWRwUHJveHlVUkwgPSBidWlsZFVSTCh0aGlzLnJ1bnRpbWVDb25maWd1cmF0aW9uLCAnY2F0YWxvZ3VlVVJMcycsICdpZHBQcm94eScsIGlkcHByb3h5KTtcclxuXHJcbiAgICAgICAgLy8gbG9nLmxvZygnTG9hZCBJZHAgUHJveHkgZm9yIGRvbWFpbiwgJyArIGRvbWFpbiArICcgOiAnLCBpZHBQcm94eVVSTCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2F0YWxvZ3VlLmdldElkcFByb3h5RGVzY3JpcHRvcihpZHBQcm94eVVSTCwgdHJ1ZSwgY29uc3RyYWludHMpO1xyXG4gICAgICB9KS50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBEZXNjcmlwdG9ycztcclxuIiwiLyoqXHJcbiAqICBDbGFzcyB3aGVyZSBtZXNzYWdlIGJ1cyBoYW5kbGVycyBhcmUgYnVpbHQuIFRvIGJlIHVzZWQgYnkgdGhlIFJ1bnRpbWVVQSB0byBpbml0aWFsaXNlIHRoZSBydW50aW1lIFVBLlxyXG4gKi9cclxuXHJcbi8vaW1wb3J0IHsgbG9nIGFzIGxvZ0xldmVscyB9IGZyb20gJy4uL2xvZ0xldmVscyc7XHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdSdW50aW1lVUEnKTtcclxuXHJcbmNsYXNzIE1zZ0J1c0hhbmRsZXJzIHtcclxuXHJcbiAgY29uc3RydWN0b3IocGVwLCBpZG0sIGNyeXB0bykge1xyXG4gICAgaWYgKCFwZXApIHRocm93IEVycm9yKCdbTXNnQnVzSGFuZGxlcnNdIHBlcCBpbnB1dCBwYXJhbWVudGVyIGlzIG1hbmRhdG9yeScpO1xyXG4gICAgaWYgKCFpZG0pIHRocm93IEVycm9yKCdbTXNnQnVzSGFuZGxlcnNdIGlkbSBpbnB1dCBwYXJhbWVudGUgaXMgbWFuZGF0b3J5Jyk7XHJcbiAgICBpZiAoIWNyeXB0bykgdGhyb3cgRXJyb3IoJ1tNc2dCdXNIYW5kbGVyc10gY3J5cHRvIGlucHV0IHBhcmFtZW50ZSBpcyBtYW5kYXRvcnknKTtcclxuXHJcbiAgICB0aGlzLnBvbGljeUVuZ2luZSA9IHBlcDtcclxuICAgIHRoaXMuaWRlbnRpdHlNYW5hZ2VyID0gaWRtO1xyXG4gICAgdGhpcy5jcnlwdG9NYW5hZ2VyID0gY3J5cHRvO1xyXG4gIH1cclxuXHJcbiAgLy8gUG9saWN5IGJhc2VkIGFjY2VzcyBjb250cm9sIGZvciBpbmNvbWluZyBtZXNzYWdlc1xyXG5cclxuICBnZXQgcGVwSW5IYW5kbGVyKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gKGN0eCkgPT4ge1xyXG4gICAgICBfdGhpcy5wb2xpY3lFbmdpbmUuYXV0aG9yaXNlKGN0eC5tc2csIHRydWUpLnRoZW4oKGNoYW5nZWRNZ3MpID0+IHtcclxuICAgICAgICBjdHgubXNnID0gY2hhbmdlZE1ncztcclxuICAgICAgICBjdHgubmV4dCgpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbG9nLmVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgY3R4LmZhaWwocmVhc29uKTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICB9XHJcblxyXG4gIC8vIFBvbGljeSBiYXNlZCBhY2Nlc3MgY29udHJvbCBmb3Igb3V0Z29pbmcgbWVzc2FnZXNcclxuICBnZXQgcGVwT3V0SGFuZGxlcigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gKGN0eCkgPT4ge1xyXG4gICAgICBfdGhpcy5wb2xpY3lFbmdpbmUuYXV0aG9yaXNlKGN0eC5tc2csIGZhbHNlKS50aGVuKChjaGFuZ2VkTWdzKSA9PiB7XHJcbiAgICAgICAgY3R4Lm1zZyA9IGNoYW5nZWRNZ3M7XHJcbiAgICAgICAgY3R4Lm5leHQoKTtcclxuICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGxvZy5lcnJvcihyZWFzb24pO1xyXG4gICAgICAgIGN0eC5mYWlsKHJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIEFkZCBJZGVudGl0eSBpbmZvIHRvIG1lc3NhZ2VzXHJcbiAgZ2V0IGlkbUhhbmRsZXIoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIChjdHgpID0+IHtcclxuICAgICAgX3RoaXMuaWRlbnRpdHlNYW5hZ2VyLnByb2Nlc3NNZXNzYWdlKGN0eC5tc2cpLnRoZW4oKGNoYW5nZWRNZ3MpID0+IHtcclxuICAgICAgICBjdHgubXNnID0gY2hhbmdlZE1ncztcclxuICAgICAgICBjdHgubmV4dCgpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbG9nLmVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgY3R4LmZhaWwocmVhc29uKTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gZW5jcnlwdCBtZXNzYWdlc1xyXG5cclxuICBnZXQgZW5jcnlwdEhhbmRsZXIoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIChjdHgpID0+IHtcclxuICAgICAgX3RoaXMuY3J5cHRvTWFuYWdlci5lbmNyeXB0TWVzc2FnZShjdHgubXNnKS50aGVuKChjaGFuZ2VkTWdzKSA9PiB7XHJcbiAgICAgICAgY3R4Lm1zZyA9IGNoYW5nZWRNZ3M7XHJcbiAgICAgICAgY3R4Lm5leHQoKTtcclxuICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIGxvZy5lcnJvcihyZWFzb24pO1xyXG4gICAgICAgIGN0eC5mYWlsKHJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgfVxyXG5cclxuICAvLyBkZWNyeXB0IG1lc3NhZ2VzXHJcblxyXG4gIGdldCBkZWNyeXB0SGFuZGxlcigpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICByZXR1cm4gKGN0eCkgPT4ge1xyXG4gICAgICBfdGhpcy5jcnlwdG9NYW5hZ2VyLmRlY3J5cHRNZXNzYWdlKGN0eC5tc2cpLnRoZW4oKGNoYW5nZWRNZ3MpID0+IHtcclxuICAgICAgICBjdHgubXNnID0gY2hhbmdlZE1ncztcclxuICAgICAgICBjdHgubmV4dCgpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbG9nLndhcm4ocmVhc29uKTtcclxuICAgICAgICBjdHguZmFpbChyZWFzb24pO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IE1zZ0J1c0hhbmRsZXJzO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdDb3JlRGlzY292ZXJ5Jyk7XHJcblxyXG5cclxuaW1wb3J0IHtkaXZpZGVVUkx9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuXHJcbi8qKlxyXG4qIENvcmUgRGlzY292ZXJ5IGludGVyZmFjZVxyXG4qIENsYXNzIHRvIGFsbG93IGFwcGxpY2F0aW9ucyB0byBzZWFyY2ggZm9yIGh5cGVydGllcyBhbmQgRGF0YU9iamVjdHMgdXNpbmcgdGhlIG1lc3NhZ2UgYnVzXHJcbiovXHJcbmNsYXNzIENvcmVEaXNjb3Zlcnkge1xyXG5cclxuICAvKipcclxuICAqIFRvIGluaXRpYWxpc2UgdGhlIERpc2NvdmVyeSwgd2hpY2ggd2lsbCBwcm92aWRlIHRoZSBzdXBwb3J0IGZvciBoeXBlcnRpZXMgdG9cclxuICAqIHF1ZXJ5IHVzZXJzIHJlZ2lzdGVyZWQgaW4gb3V0c2lkZSB0aGUgaW50ZXJuYWwgY29yZS5cclxuICAqIEBwYXJhbSAge01lc3NhZ2VCdXN9ICAgICAgICAgIG1zZ2J1cyAgICAgICAgICAgICAgICBtc2didXNcclxuICAqIEBwYXJhbSAge1J1bnRpbWVVUkx9ICAgICAgICAgIHJ1bnRpbWVVUkwgICAgICAgICAgICBydW50aW1lVVJMXHJcbiAgKiBAcGFyYW0gIHtncmFwaENvbm5lY3Rvcn0gICAgZ3JhcGhDb25uZWN0b3JcclxuICAqL1xyXG4gIGNvbnN0cnVjdG9yKHJ1bnRpbWVVUkwsIG1zZ0J1cywgZ3JhcGhDb25uZWN0b3IsIHJ1bnRpbWVGYWN0b3J5LCByZWdpc3RyeSkge1xyXG4gICAgaWYgKCFydW50aW1lRmFjdG9yeSkgdGhyb3cgRXJyb3IoJ1RoZSBjYXRhbG9ndWUgbmVlZHMgdGhlIHJ1bnRpbWVGYWN0b3J5Jyk7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHRoaXMuX21lc3NhZ2VCdXMgPSBtc2dCdXM7XHJcbiAgICBfdGhpcy5ncmFwaENvbm5lY3RvciA9IGdyYXBoQ29ubmVjdG9yO1xyXG4gICAgX3RoaXMuaHR0cFJlcXVlc3QgPSBydW50aW1lRmFjdG9yeS5jcmVhdGVIdHRwUmVxdWVzdCgpO1xyXG4gICAgX3RoaXMuZG9tYWluID0gZGl2aWRlVVJMKHJ1bnRpbWVVUkwpLmRvbWFpbjtcclxuICAgIF90aGlzLmRpc2NvdmVyeVVSTCA9IHJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nO1xyXG4gICAgX3RoaXMucmVnaXN0cnkgPSByZWdpc3RyeTtcclxuXHJcbiAgICBfdGhpcy5tZXNzYWdlQnVzLmFkZExpc3RlbmVyKF90aGlzLmRpc2NvdmVyeVVSTCwgKG1zZykgPT4ge1xyXG5cclxuICAgICAgX3RoaXMuZGlzY292ZXJ5TWFuYWdlcihtc2cpLnRoZW4ocmVzdWx0ID0+e1xyXG5cclxuICAgICAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHJlc3BvbnNlXHJcbiAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICBpZDogbXNnLmlkLFxyXG4gICAgICAgICAgdHlwZTogJ3Jlc3BvbnNlJyxcclxuICAgICAgICAgIGZyb206IG1zZy50byxcclxuICAgICAgICAgIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgY29kZTogMjAwLFxyXG4gICAgICAgICAgICB2YWx1ZTogcmVzdWx0XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgbGV0IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgbGV0IGNvZGU7XHJcblxyXG4gICAgICAgICAgaWYgKGVyciA9PT0gJ0dyYXBoQ29ubmVjdG9yJykge1xyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdUaGlzIHNlYXJjaCBpcyBub3QgYXZhaWxhYmxlIGF0IHRoZSBtb21lbnQuIFRyeSBsYXRlci4nO1xyXG4gICAgICAgICAgICBjb2RlID0gNTAwO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnTm90IEZvdW5kJztcclxuICAgICAgICAgICAgY29kZSA9IDQwNDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvL0ZMT1ctT1VUOiBlcnJvciBtZXNzYWdlIHJlc3BvbnNlXHJcbiAgICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgICAgaWQ6IG1zZy5pZCxcclxuICAgICAgICAgICAgdHlwZTogJ3Jlc3BvbnNlJyxcclxuICAgICAgICAgICAgZnJvbTogbXNnLnRvLFxyXG4gICAgICAgICAgICB0bzogbXNnLmZyb20sXHJcbiAgICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgICBjb2RlOiBjb2RlLFxyXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgTWVzc2FnZUJ1cy5cclxuICAgKi9cclxuICBnZXQgbWVzc2FnZUJ1cygpIHtcclxuICAgIHJldHVybiB0aGlzLl9tZXNzYWdlQnVzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0cyB0aGUgTWVzc2FnZUJ1cy5cclxuICAgKiBAcGFyYW0ge01lc3NhZ2VCdXN9ICAgICAgICAgICBtZXNzYWdlQnVzICAgIFRoZSBNZXNzYWdlIEJ1cy5cclxuICAgKi9cclxuICBzZXQgbWVzc2FnZUJ1cyhtZXNzYWdlQnVzKSB7XHJcbiAgICB0aGlzLl9tZXNzYWdlQnVzID0gbWVzc2FnZUJ1cztcclxuICB9XHJcblxyXG4gIC8qIGZ1bmN0aW9uIHRvIGRlY2lkZSB3aGF0IGRpc2NvdmVyeSBtZXRob2QgdG8gY2FsbCBhbmQgbGF0ZXIgcmV0dXJuIHRoZSByZXNwb25zZSBtc2cgICovXHJcbiAgZGlzY292ZXJ5TWFuYWdlcihtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgZG9tYWluID0gZGl2aWRlVVJMKG1zZy5mcm9tKS5kb21haW47XHJcbiAgICBsZXQgYXRyaWJ1dGVzID0gbXNnLmJvZHkucmVzb3VyY2Uuc3BsaXQoJy8nKS5maWx0ZXIoQm9vbGVhbik7XHJcbiAgICBsZXQgcmVzb3VyY2VzID0gW107XHJcbiAgICBsZXQgZGF0YVNjaGVtZXMgPSBbXTtcclxuXHJcbiAgICBsb2cubG9nKCdbQ29yZURpc2NvdmVyeS5kaXNjb3ZlcnlNYW5hZ2VyXSByZWNlaXZlZDogJywgbXNnKTtcclxuXHJcbiAgICBpZiAobXNnLmJvZHkuY3JpdGVyaWEpIHtcclxuICAgICAgaWYgKG1zZy5ib2R5LmNyaXRlcmlhLnJlc291cmNlcykgeyByZXNvdXJjZXMgPSBtc2cuYm9keS5jcml0ZXJpYS5yZXNvdXJjZXM7IH1cclxuICAgICAgaWYgKG1zZy5ib2R5LmNyaXRlcmlhLmRhdGFTY2hlbWVzKSB7IGRhdGFTY2hlbWVzID0gbXNnLmJvZHkuY3JpdGVyaWEuZGF0YVNjaGVtZXM7IH1cclxuICAgIH1cclxuXHJcbiAgICBzd2l0Y2ggKGF0cmlidXRlc1sxXSkge1xyXG4gICAgICBjYXNlICd1c2VyJzpcclxuICAgICAgICBpZiAoYXRyaWJ1dGVzWzBdID09ICdoeXBlcnR5JykgeyByZXR1cm4gX3RoaXMuZGlzY292ZXJIeXBlcnRpZXMobXNnLmJvZHkucmVzb3VyY2Uuc3BsaXQoJ3VzZXIvJylbMV0sIGRhdGFTY2hlbWVzLCByZXNvdXJjZXMsIG1zZy5ib2R5LmNyaXRlcmlhLmRvbWFpbik7IH0gZWxzZSB7IHJldHVybiBfdGhpcy5kaXNjb3ZlckRhdGFPYmplY3RzKG1zZy5ib2R5LnJlc291cmNlLnNwbGl0KCd1c2VyLycpWzFdLCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzLCBtc2cuYm9keS5jcml0ZXJpYS5kb21haW4pOyB9XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICd1cmwnOlxyXG4gICAgICAgIGlmIChhdHJpYnV0ZXNbMF0gPT0gJ2h5cGVydHknKSB7IHJldHVybiBfdGhpcy5kaXNjb3Zlckh5cGVydHlQZXJVUkwobXNnLmJvZHkucmVzb3VyY2Uuc3BsaXQoJ3VybC8nKVsxXSwgbXNnLmJvZHkuY3JpdGVyaWEuZG9tYWluKTsgfSBlbHNlIHsgcmV0dXJuIF90aGlzLmRpc2NvdmVyRGF0YU9iamVjdFBlclVSTChtc2cuYm9keS5yZXNvdXJjZS5zcGxpdCgndXJsLycpWzFdLCBtc2cuYm9keS5jcml0ZXJpYS5kb21haW4pOyB9XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ25hbWUnOlxyXG4gICAgICAgIHJldHVybiBfdGhpcy5kaXNjb3ZlckRhdGFPYmplY3RzUGVyTmFtZShtc2cuYm9keS5yZXNvdXJjZS5zcGxpdCgnbmFtZS8nKVsxXSwgZGF0YVNjaGVtZXMsIHJlc291cmNlcywgbXNnLmJvZHkuY3JpdGVyaWEuZG9tYWluKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAncmVwb3J0ZXInOlxyXG4gICAgICAgIHJldHVybiBfdGhpcy5kaXNjb3ZlckRhdGFPYmplY3RzUGVyUmVwb3J0ZXIobXNnLmJvZHkucmVzb3VyY2Uuc3BsaXQoJ3JlcG9ydGVyLycpWzFdLCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzLCBtc2cuYm9keS5jcml0ZXJpYS5kb21haW4pO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdndWlkJzpcclxuICAgICAgICBpZiAodHlwZW9mIF90aGlzLmdyYXBoQ29ubmVjdG9yICE9PSAndW5kZWZpbmVkJyAmJiAgX3RoaXMuZ3JhcGhDb25uZWN0b3IgIT09IG51bGwpIHtcclxuICAgICAgICAgIGlmIChhdHJpYnV0ZXNbMF0gPT0gJ2h5cGVydHknKSB7IHJldHVybiBfdGhpcy5kaXNjb3Zlckh5cGVydGllc1BlckdVSUQobXNnLmJvZHkucmVzb3VyY2Uuc3BsaXQoJ3VzZXItZ3VpZDovLycpWzFdLCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzKTsgfSBlbHNlIHsgcmV0dXJuIF90aGlzLmRpc2NvdmVyRGF0YU9iamVjdHNQZXJHVUlEKG1zZy5ib2R5LnJlc291cmNlLnNwbGl0KCd1c2VyLWd1aWQ6Ly8nKVsxXSwgZGF0YVNjaGVtZXMsIHJlc291cmNlcyk7IH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ0dyYXBoQ29ubmVjdG9yJyk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIGNhc2UgJ3VzZXJwcm9maWxlJzpcclxuICAgICAgICBpZiAodHlwZW9mIF90aGlzLmdyYXBoQ29ubmVjdG9yICE9PSAndW5kZWZpbmVkJyAmJiAgX3RoaXMuZ3JhcGhDb25uZWN0b3IgIT09IG51bGwpIHtcclxuICAgICAgICAgIGlmIChhdHJpYnV0ZXNbMF0gPT0gJ2h5cGVydHknKSB7IHJldHVybiBfdGhpcy5kaXNjb3Zlckh5cGVydGllc1BlclVzZXJQcm9maWxlRGF0YShtc2cuYm9keS5yZXNvdXJjZS5zcGxpdCgndXNlcnByb2ZpbGUvJylbMV0sIGRhdGFTY2hlbWVzLCByZXNvdXJjZXMpOyB9IGVsc2UgeyByZXR1cm4gX3RoaXMuZGlzY292ZXJEYXRhT2JqZWN0c1BlclVzZXJQcm9maWxlRGF0YShtc2cuYm9keS5yZXNvdXJjZS5zcGxpdCgndXNlcnByb2ZpbGUvJylbMV0sIGRhdGFTY2hlbWVzLCByZXNvdXJjZXMpOyB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdHcmFwaENvbm5lY3RvcicpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIEh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSB1c2VyIGlkZW50aWZpZXIgKGVnIGVtYWlsLCBuYW1lIC4uLilcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIHVzZXJJZGVudGlmaWVyXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBkYXRhU2NoZW1lcyAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBoeXBlcnRpZXMgc2NoZW1hc1xyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXNcclxuICAqL1xyXG4gIGRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlclByb2ZpbGVEYXRhKHVzZXJJZGVudGlmaWVyLCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIC8vdHJhbnNsYXRlIHVzZXIgaWRlbnRpZmllciAoZS5nLiBlbWFpbCwgbmFtZS4uLikgaW50byB0aGUgYXNzb2NpYXRlZCBHVUlEc1xyXG4gICAgICBfdGhpcy5kaXNjb3ZlckdVSURQZXJVc2VySWRlbnRpZmllcih1c2VySWRlbnRpZmllcilcclxuICAgICAgICAudGhlbihmdW5jdGlvbihndWlkcykge1xyXG5cclxuICAgICAgICAgIGxldCBoeXBlcnRpZXNQcm9taXNlcyA9IGd1aWRzLm1hcChmdW5jdGlvbihndWlkKSB7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgX3RoaXMuZGlzY292ZXJIeXBlcnRpZXNQZXJHVUlEKGd1aWQsIGRhdGFTY2hlbWVzLCByZXNvdXJjZXMpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihoeXBlcnRpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShoeXBlcnRpZXMpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShbXSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBQcm9taXNlLmFsbChoeXBlcnRpZXNQcm9taXNlcylcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oaHlwZXJ0aWVzUmVzdWx0KSB7XHJcblxyXG4gICAgICAgICAgICAgIGxldCBoeXBlcnRpZXMgPSBbXS5jb25jYXQuYXBwbHkoW10sIGh5cGVydGllc1Jlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChoeXBlcnRpZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KCdObyBoeXBlcnRpZXMgd2VyZSBmb3VuZCcpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShoeXBlcnRpZXMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIERhdGFPYmplY3RzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IGFzc29jaWF0ZWQgd2l0aCBzb21lIHVzZXIgaWRlbnRpZmllciAoZWcgZW1haWwsIG5hbWUgLi4uKVxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlcklkZW50aWZpZXJcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIGRhdGFTY2hlbWVzIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICByZXNvdXJjZXMgKE9wdGlvbmFsKSAgdHlwZXMgb2YgaHlwZXJ0aWVzIHJlc291cmNlc1xyXG4gICovXHJcbiAgZGlzY292ZXJEYXRhT2JqZWN0c1BlclVzZXJQcm9maWxlRGF0YSh1c2VySWRlbnRpZmllciwgZGF0YVNjaGVtZXMsIHJlc291cmNlcykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICAvL3RyYW5zbGF0ZSB1c2VyIGlkZW50aWZpZXIgKGUuZy4gZW1haWwsIG5hbWUuLi4pIGludG8gdGhlIGFzc29jaWF0ZWQgR1VJRHNcclxuICAgICAgX3RoaXMuZGlzY292ZXJHVUlEUGVyVXNlcklkZW50aWZpZXIodXNlcklkZW50aWZpZXIpXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZ3VpZHMpIHtcclxuXHJcbiAgICAgICAgICBsZXQgZGF0YU9iamVjdHNQcm9taXNlcyA9IGd1aWRzLm1hcChmdW5jdGlvbihndWlkKSB7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgX3RoaXMuZGlzY292ZXJEYXRhT2JqZWN0c1BlckdVSUQoZ3VpZCwgZGF0YVNjaGVtZXMsIHJlc291cmNlcylcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGFPYmplY3RzKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YU9iamVjdHMpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShbXSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBQcm9taXNlLmFsbChkYXRhT2JqZWN0c1Byb21pc2VzKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhT2JqZWN0c1Jlc3VsdCkge1xyXG5cclxuICAgICAgICAgICAgICBsZXQgZGF0YU9iamVjdHMgPSBbXS5jb25jYXQuYXBwbHkoW10sIGRhdGFPYmplY3RzUmVzdWx0KTtcclxuXHJcbiAgICAgICAgICAgICAgaWYgKGRhdGFPYmplY3RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgnTm8gZGF0YU9iamVjdHMgd2VyZSBmb3VuZCcpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhT2JqZWN0cyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIEFkdmFuY2VkIFNlYXJjaCBmb3IgSHlwZXJ0aWVzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IGFzc29jaWF0ZWQgd2l0aCBzb21lIEdVSURcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgICAgZ3VpZFxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgZGF0YVNjaGVtZXMgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgaHlwZXJ0aWVzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzXHJcbiAgKi9cclxuICBkaXNjb3Zlckh5cGVydGllc1BlckdVSUQoZ3VpZCwgZGF0YVNjaGVtZXMsIHJlc291cmNlcykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICAvL3RyYW5zbGF0ZSBHVUlEIGludG8gdGhlIHVzZXIgSURzIHRvIHF1ZXJ5IHRoZSBkb21haW4gcmVnaXN0cnlcclxuICAgICAgX3RoaXMuZGlzY292ZXJVc2VySWRzUGVyR1VJRChndWlkKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHVpZHMpIHtcclxuXHJcbiAgICAgICAgLy90cmFuc2xhdGUgdXNlciBJRHMgaW50byB0aGUgYXNzb2NpYXRlZCBoeXBlcnRpZXMgcmVnaXN0ZXJlZCBpbiBzb21lIGRvbWFpblxyXG4gICAgICAgICAgbGV0IGh5cGVydGllc1Byb21pc2VzID0gdWlkcy5tYXAoZnVuY3Rpb24odWlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICBfdGhpcy5kaXNjb3Zlckh5cGVydGllcyh1aWQudUlELCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzLCB1aWQuZG9tYWluKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oaHlwZXJ0aWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoaHlwZXJ0aWVzKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoW10pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgUHJvbWlzZS5hbGwoaHlwZXJ0aWVzUHJvbWlzZXMpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGh5cGVydGllc1Jlc3VsdCkge1xyXG5cclxuICAgICAgICAgICAgICBsZXQgaHlwZXJ0aWVzID0gW10uY29uY2F0LmFwcGx5KFtdLCBoeXBlcnRpZXNSZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgICBpZiAoaHlwZXJ0aWVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgnTm8gaHlwZXJ0aWVzIHdlcmUgZm91bmQnKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIGxvZy5sb2coJ0h5cGVydGllcyA6ICcsIGh5cGVydGllcyk7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShoeXBlcnRpZXMpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogQWR2YW5jZWQgU2VhcmNoIGZvciBEYXRhT2JqZWN0cyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSBHVUlEXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgIGd1aWRcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIGRhdGFTY2hlbWVzIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzXHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICByZXNvdXJjZXMgKE9wdGlvbmFsKSAgdHlwZXMgb2YgaHlwZXJ0aWVzIHJlc291cmNlc1xyXG4gICovXHJcbiAgZGlzY292ZXJEYXRhT2JqZWN0c1BlckdVSUQoZ3VpZCwgZGF0YVNjaGVtZXMsIHJlc291cmNlcykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICAvL3RyYW5zbGF0ZSBHVUlEIGludG8gdGhlIHVzZXIgSURzIHRvIHF1ZXJ5IHRoZSBkb21haW4gcmVnaXN0cnlcclxuICAgICAgX3RoaXMuZGlzY292ZXJVc2VySWRzUGVyR1VJRChndWlkKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHVpZHMpIHtcclxuXHJcbiAgICAgICAgLy90cmFuc2xhdGUgdXNlciBJRHMgaW50byB0aGUgYXNzb2NpYXRlZCBkYXRhT2JqZWN0cyByZWdpc3RlcmVkIGluIHNvbWUgZG9tYWluXHJcbiAgICAgICAgICBsZXQgZGF0YU9iamVjdFByb21pc2VzID0gdWlkcy5tYXAoZnVuY3Rpb24odWlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICBfdGhpcy5kaXNjb3ZlckRhdGFPYmplY3RzKHVpZC51SUQsIGRhdGFTY2hlbWVzLCByZXNvdXJjZXMsIHVpZC5kb21haW4pXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhT2JqZWN0cykge1xyXG4gICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGFPYmplY3RzKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoW10pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgUHJvbWlzZS5hbGwoZGF0YU9iamVjdFByb21pc2VzKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhT2JqZWN0c1Jlc3VsdCkge1xyXG5cclxuICAgICAgICAgICAgICBsZXQgZGF0YU9iamVjdHMgPSBbXS5jb25jYXQuYXBwbHkoW10sIGRhdGFPYmplY3RzUmVzdWx0KTtcclxuXHJcbiAgICAgICAgICAgICAgaWYgKGRhdGFPYmplY3RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgnTm8gZGF0YU9iamVjdHMgd2VyZSBmb3VuZCcpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gbG9nLmxvZygnRGF0YU9iamVjdHMgOiAnLCBkYXRhT2JqZWN0cyk7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhT2JqZWN0cyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqIEFkdmFuY2VkIFNlYXJjaCBmb3IgSHlwZXJ0aWVzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IGFuZCBhc3NvY2lhdGVkIHdpdGggc29tZSB1c2VyIElEXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICB1c2VyICAgICAgICAgICAgICAgICAgdXNlciBpZGVudGlmaWVyLCBlaXRoZXIgaW4gdXJsIG9yIGVtYWlsIGZvcm1hdFxyXG4gICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgZGF0YVNjaGVtZXMgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgaHlwZXJ0aWVzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKSAgICAgZG9tYWluIG9mIHRoZSByZWdpc3RyeSB0byBzZWFyY2hcclxuICAqL1xyXG4gIGRpc2NvdmVySHlwZXJ0aWVzKHVzZXIsIGRhdGFTY2hlbWVzLCByZXNvdXJjZXMsIGRvbWFpbikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBhY3RpdmVEb21haW47XHJcblxyXG4gICAgYWN0aXZlRG9tYWluID0gKCFkb21haW4pID8gX3RoaXMuZG9tYWluIDogZG9tYWluO1xyXG5cclxuICAgIGxldCBtc2cgPSB7XHJcbiAgICAgIHR5cGU6ICdyZWFkJyxcclxuICAgICAgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLFxyXG4gICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBhY3RpdmVEb21haW4sXHJcbiAgICAgIGJvZHk6IHtcclxuXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYgKHVzZXIuaW5kZXhPZigndXNlcjovLycpID4gLTEpIHsgbXNnLmJvZHkucmVzb3VyY2UgPSB1c2VyOyB9IGVsc2UgeyBtc2cuYm9keS5yZXNvdXJjZSA9ICcvaHlwZXJ0eS9pZHAtaWRlbnRpZmllci8nICsgdXNlcjsgfVxyXG5cclxuICAgIGlmIChkYXRhU2NoZW1lcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGlmICghbXNnLmJvZHkuY3JpdGVyaWEpIHsgbXNnLmJvZHkuY3JpdGVyaWEgPSB7fTsgfVxyXG4gICAgICBtc2cuYm9keS5jcml0ZXJpYS5kYXRhU2NoZW1lcyA9IGRhdGFTY2hlbWVzO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChyZXNvdXJjZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBpZiAoIW1zZy5ib2R5LmNyaXRlcmlhKSB7IG1zZy5ib2R5LmNyaXRlcmlhID0ge307IH1cclxuICAgICAgbXNnLmJvZHkuY3JpdGVyaWEucmVzb3VyY2VzID0gcmVzb3VyY2VzO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgLy8gbG9nLmxvZyhcIltDb3JlRGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0aWVzXSBzZW5kaW5nIG1zZyBcIiwgbXNnKTtcclxuXHJcbiAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuXHJcbiAgICAgICAgLy8gbG9nLmxvZyhcIltDb3JlRGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0aWVzXSByY3ZlZCByZXBseSBcIiwgcmVwbHkpO1xyXG5cclxuICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDAgfHwgcmVwbHkuYm9keS5jb2RlID09PSA1MDApIHtcclxuICAgICAgICAgIGxldCBoeXBlcnRpZXMgPSByZXBseS5ib2R5LnZhbHVlO1xyXG5cclxuICAgICAgICAgIGxldCBmaW5hbEh5cGVydGllcyA9IFtdO1xyXG4gICAgICAgICAgZm9yICh2YXIga2V5IGluIGh5cGVydGllcykgZmluYWxIeXBlcnRpZXMucHVzaChoeXBlcnRpZXNba2V5XSk7XHJcblxyXG4gICAgICAgICAgaWYgKGZpbmFsSHlwZXJ0aWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gbG9nLmxvZyhcIltDb3JlRGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0aWVzXSBIeXBlcnRpZXMgRm91bmQ6IFwiLCBmaW5hbEh5cGVydGllcyk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoZmluYWxIeXBlcnRpZXMpO1xyXG4gICAgICAgICAgfSBlbHNlIHsgcmV0dXJuIHJlamVjdCgnTm8gSHlwZXJ0eSB3YXMgZm91bmQnKTsgfVxyXG4gICAgICAgIH0gZWxzZSB7IHJldHVybiByZWplY3QoJ05vIEh5cGVydHkgd2FzIGZvdW5kJyk7IH1cclxuXHJcbiAgICAgICAgLypfdGhpcy5yZWdpc3RyeS5pc0xlZ2FjeSh1c2VyKS50aGVuKChsZWdhY3kpID0+IHtcclxuICAgICAgICAgICAgICBpZiAobGVnYWN5KSByZXNvbHZlKFt7aHlwZXJ0eUlEOiB1c2VyIH1dKVxyXG4gICAgICAgICAgICAgIGVsc2UgcmV0dXJuIHJlamVjdCgnTm8gSHlwZXJ0eSB3YXMgZm91bmQnKTtcclxuICAgICAgICAgIH0pOyovXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKiogQWR2YW5jZWQgU2VhcmNoIGZvciBEYXRhT2JqZWN0cyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhbmQgYXNzb2NpYXRlZCB3aXRoIHNvbWUgdXNlciBJRFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlciAgICAgICAgICAgICAgICAgIHVzZXIgaWRlbnRpZmllciwgZWl0aGVyIGluIHVybCBvciBlbWFpbCBmb3JtYXRcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIGRhdGFTY2hlbWVzIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBkYXRhT2JqZWN0cyByZXNvdXJjZXNcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaFxyXG4gICovXHJcbiAgZGlzY292ZXJEYXRhT2JqZWN0cyh1c2VyLCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG4gICAgbGV0IGRhdGFPYmplY3RzQXJyYXkgPSBbXTtcclxuXHJcbiAgICBhY3RpdmVEb21haW4gPSAoIWRvbWFpbikgPyBfdGhpcy5kb21haW4gOiBkb21haW47XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgLy90cmFuc2xhdGUgdXNlciBpZGVudGlmaWVyIChlLmcuIGVtYWlsLCBuYW1lLi4uKSBpbnRvIHRoZSBhc3NvY2lhdGVkIGh5cGVydGllc1xyXG4gICAgICBfdGhpcy5kaXNjb3Zlckh5cGVydGllcyh1c2VyLCBbXSwgW10sIGFjdGl2ZURvbWFpbilcclxuICAgICAgICAudGhlbihmdW5jdGlvbihoeXBlcnRpZXMpIHtcclxuXHJcbiAgICAgICAgICBsZXQgZmluYWxIeXBlcnRpZXMgPSBbXTtcclxuICAgICAgICAgIGZvciAodmFyIGtleSBpbiBoeXBlcnRpZXMpIGZpbmFsSHlwZXJ0aWVzLnB1c2goaHlwZXJ0aWVzW2tleV0pO1xyXG5cclxuICAgICAgICAgIC8vdHJhbnNsYXRlIGh5cGVydGllcyBVUkxzIGludG8gdGhlIGFzc29jaWF0ZWQgZGF0YU9iamVjdHMgcmVnaXN0ZXJlZCBpbiBzb21lIGRvbWFpblxyXG4gICAgICAgICAgbGV0IGRhdGFPYmplY3RzUHJvbWlzZXMgPSBmaW5hbEh5cGVydGllcy5tYXAoZnVuY3Rpb24oaHlwZXJ0eSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgX3RoaXMuZGlzY292ZXJEYXRhT2JqZWN0c1BlclJlcG9ydGVyKGh5cGVydHkuaHlwZXJ0eUlELCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzLCBhY3RpdmVEb21haW4pXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhT2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YU9iamVjdCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICByZXNvbHZlKFtdKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIFByb21pc2UuYWxsKGRhdGFPYmplY3RzUHJvbWlzZXMpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGFPYmplY3RzUmVzdWx0KSB7XHJcblxyXG4gICAgICAgICAgICAgIGxldCBkYXRhT2JqZWN0cyA9IFtdLmNvbmNhdC5hcHBseShbXSwgZGF0YU9iamVjdHNSZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgICBkYXRhT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKGRhdGFPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIGRhdGFPYmplY3RzQXJyYXkucHVzaChkYXRhT2JqZWN0KTtcclxuICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgbGV0IGZpbmFsRGF0YU9iamVjdHMgPSBbXTtcclxuICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YU9iamVjdHNBcnJheSkgZmluYWxEYXRhT2JqZWN0cy5wdXNoKGRhdGFPYmplY3RzQXJyYXlba2V5XSk7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChmaW5hbERhdGFPYmplY3RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgnTm8gZGF0YU9iamVjdHMgd2VyZSBmb3VuZCcpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gbG9nLmxvZygnRGF0YU9iamVjdHMgRm91bmQ6ICcsIGZpbmFsRGF0YU9iamVjdHMpO1xyXG4gICAgICAgICAgICAgIHJlc29sdmUoZmluYWxEYXRhT2JqZWN0cyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IGh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSwgYW5kXHJcbiAgKiByZXR1cm4gdGhlIGh5cGVydHkgaW5mb3JtYXRpb24sIGlmIGZvdW5kLlxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgICAgdXJsICBkYXRhT2JqZWN0IFVSTFxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpXHJcbiAgKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgICAgICBQcm9taXNlXHJcbiAgKi9cclxuICBkaXNjb3Zlckh5cGVydHlQZXJVUkwodXJsLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG5cclxuICAgIGFjdGl2ZURvbWFpbiA9ICghZG9tYWluKSA/IF90aGlzLmRvbWFpbiA6IGRvbWFpbjtcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG4gICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCxcclxuICAgICAgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6IHVybFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuXHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSAhPT0gMjAwICYmIHJlcGx5LmJvZHkuY29kZSAhPT0gNTAwKSB7IHJldHVybiByZWplY3QoJ05vIEh5cGVydHkgd2FzIGZvdW5kJyk7IH1cclxuXHJcbiAgICAgICAgbGV0IGh5cGVydHkgPSByZXBseS5ib2R5LnZhbHVlO1xyXG5cclxuICAgICAgICBpZiAoaHlwZXJ0eSkge1xyXG4gICAgICAgICAgLy8gbG9nLmxvZygnSHlwZXJ0eSBmb3VuZDogJywgaHlwZXJ0eSk7XHJcbiAgICAgICAgICByZXNvbHZlKGh5cGVydHkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KCdObyBIeXBlcnR5IHdhcyBmb3VuZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZnVuY3Rpb24gdG8gcmVxdWVzdCBhYm91dCBkYXRhT2JqZWN0IHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5LCBhbmRcclxuICAqIHJldHVybiB0aGUgZGF0YU9iamVjdCBpbmZvcm1hdGlvbiwgaWYgZm91bmQuXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgICB1cmwgIGRhdGFPYmplY3QgVVJMXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgZG9tYWluIChPcHRpb25hbClcclxuICAqIEByZXR1cm4ge1Byb21pc2V9ICAgICAgICAgIFByb21pc2VcclxuICAqL1xyXG4gIGRpc2NvdmVyRGF0YU9iamVjdFBlclVSTCh1cmwsIGRvbWFpbikge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBhY3RpdmVEb21haW47XHJcblxyXG4gICAgYWN0aXZlRG9tYWluID0gKCFkb21haW4pID8gX3RoaXMuZG9tYWluIDogZG9tYWluO1xyXG5cclxuICAgIGxldCBtc2cgPSB7XHJcbiAgICAgIHR5cGU6ICdyZWFkJyxcclxuICAgICAgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLFxyXG4gICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBhY3RpdmVEb21haW4sXHJcbiAgICAgIGJvZHk6IHtcclxuICAgICAgICByZXNvdXJjZTogdXJsXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cclxuICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIChyZXBseSkgPT4ge1xyXG5cclxuICAgICAgICBsZXQgZGF0YU9iamVjdCA9IHJlcGx5LmJvZHkudmFsdWU7XHJcblxyXG4gICAgICAgIGlmIChkYXRhT2JqZWN0KSB7XHJcbiAgICAgICAgICAvLyBsb2cubG9nKCdEYXRhT2JqZWN0IGZvdW5kOiAnLCBkYXRhT2JqZWN0KTtcclxuICAgICAgICAgIHJlc29sdmUoZGF0YU9iamVjdCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiByZWplY3QoJ0RhdGFPYmplY3Qgbm90IGZvdW5kJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqIEFkdmFuY2VkIFNlYXJjaCBmb3IgZGF0YU9iamVjdHMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnlcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIG5hbWUgICAgICAgICAgICAgICAgICBuYW1lIG9mIHRoZSBkYXRhT2JqZWN0XHJcbiAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBkYXRhU2NoZW1lcyAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBkYXRhT2JqZWN0IHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBkYXRhT2JqZWN0IHJlc291cmNlc1xyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZG9tYWluIChPcHRpb25hbCkgICAgIGRvbWFpbiBvZiB0aGUgcmVnaXN0cnkgdG8gc2VhcmNoXHJcbiAgKi9cclxuICBkaXNjb3ZlckRhdGFPYmplY3RzUGVyTmFtZShuYW1lLCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG5cclxuICAgIGFjdGl2ZURvbWFpbiA9ICghZG9tYWluKSA/IF90aGlzLmRvbWFpbiA6IGRvbWFpbjtcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG4gICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCxcclxuICAgICAgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6IG5hbWVcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoZGF0YVNjaGVtZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBpZiAoIW1zZy5ib2R5LmNyaXRlcmlhKSB7IG1zZy5ib2R5LmNyaXRlcmlhID0ge307IH1cclxuICAgICAgbXNnLmJvZHkuY3JpdGVyaWEuZGF0YVNjaGVtZXMgPSBkYXRhU2NoZW1lcztcclxuICAgIH1cclxuXHJcbiAgICBpZiAocmVzb3VyY2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgaWYgKCFtc2cuYm9keS5jcml0ZXJpYSkgeyBtc2cuYm9keS5jcml0ZXJpYSA9IHt9OyB9XHJcbiAgICAgIG1zZy5ib2R5LmNyaXRlcmlhLnJlc291cmNlcyA9IHJlc291cmNlcztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcblxyXG4gICAgICAgIGxldCBkYXRhT2JqZWN0cyA9IHJlcGx5LmJvZHkudmFsdWU7XHJcblxyXG4gICAgICAgIGxldCBmaW5hbERhdGFPYmplY3RzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRhdGFPYmplY3RzKSBmaW5hbERhdGFPYmplY3RzLnB1c2goZGF0YU9iamVjdHNba2V5XSk7XHJcblxyXG4gICAgICAgIGlmIChmaW5hbERhdGFPYmplY3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIC8vIGxvZy5sb2coXCJEYXRhT2JqZWN0cyBGb3VuZDogXCIsIGZpbmFsRGF0YU9iamVjdHMpO1xyXG4gICAgICAgICAgcmVzb2x2ZShmaW5hbERhdGFPYmplY3RzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIHJlamVjdCgnTm8gRGF0YU9iamVjdCB3YXMgZm91bmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgc3BlY2lmaWMgcmVwb3J0ZXIgZGF0YU9iamVjdCByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSwgYW5kXHJcbiAgKiByZXR1cm4gdGhlIGRhdGFPYmplY3RzIGZyb20gdGhhdCByZXBvcnRlci5cclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIHJlcG9ydGVyICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFPYmplY3QgcmVwb3J0ZXJcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjZGF0YVNjaGVtZXNoZW1hICAgICAgICAgICAgICAgIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHNjaGVtYXNcclxuICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAgICAgICAgICAgICAgICAgICAgICAgIChPcHRpb25hbCkgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHJlc291cmNlc1xyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZG9tYWluICAgICAgICAgICAgICAgICAgICAgICAgICAgKE9wdGlvbmFsKVxyXG4gICovXHJcbiAgZGlzY292ZXJEYXRhT2JqZWN0c1BlclJlcG9ydGVyKHJlcG9ydGVyLCBkYXRhU2NoZW1lcywgcmVzb3VyY2VzLCBkb21haW4pIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgYWN0aXZlRG9tYWluO1xyXG5cclxuICAgIGFjdGl2ZURvbWFpbiA9ICghZG9tYWluKSA/IF90aGlzLmRvbWFpbiA6IGRvbWFpbjtcclxuXHJcbiAgICBsZXQgbXNnID0ge1xyXG4gICAgICB0eXBlOiAncmVhZCcsXHJcbiAgICAgIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCxcclxuICAgICAgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluLFxyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgcmVzb3VyY2U6ICcvY29tbScsXHJcbiAgICAgICAgY3JpdGVyaWE6IHtcclxuICAgICAgICAgIHJlcG9ydGVyOiByZXBvcnRlclxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoZGF0YVNjaGVtZXMubGVuZ3RoID4gMCkgeyBtc2cuYm9keS5jcml0ZXJpYS5kYXRhU2NoZW1lcyA9IGRhdGFTY2hlbWVzOyB9XHJcblxyXG4gICAgaWYgKHJlc291cmNlcy5sZW5ndGggPiAwKSB7IG1zZy5ib2R5LmNyaXRlcmlhLnJlc291cmNlcyA9IHJlc291cmNlczsgfVxyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCAocmVwbHkpID0+IHtcclxuXHJcbiAgICAgICAgbGV0IGRhdGFPYmplY3RzID0gcmVwbHkuYm9keS52YWx1ZTtcclxuXHJcbiAgICAgICAgbGV0IGZpbmFsRGF0YU9iamVjdHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YU9iamVjdHMpIGZpbmFsRGF0YU9iamVjdHMucHVzaChkYXRhT2JqZWN0c1trZXldKTtcclxuXHJcbiAgICAgICAgaWYgKGZpbmFsRGF0YU9iamVjdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgLy8gbG9nLmxvZyhcIkRhdGFPYmplY3RzIEZvdW5kOiBcIiwgZmluYWxEYXRhT2JqZWN0cyk7XHJcbiAgICAgICAgICByZXNvbHZlKGZpbmFsRGF0YU9iamVjdHMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KCdObyBEYXRhT2JqZWN0IHdhcyBmb3VuZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZnVuY3Rpb24gdG8gcmVxdWVzdCBnbG9iYWwgcmVnaXN0cnkgYWJvdXQgdGhlIHVzZXIgSURzIGFzc29jaWF0ZWQgd2l0aCBzb21lIEdVSURcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgICAgIGd1aWRcclxuICAqIEByZXR1cm4ge1Byb21pc2V9ICAgICAgICAgIFByb21pc2VcclxuICAqL1xyXG4gIGRpc2NvdmVyVXNlcklkc1BlckdVSUQoZ3VpZCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblxyXG4gICAgICAvLyBsb2cubG9nKFwiR08gZ3JhcGhDb25uZWN0b3I6XCIsIGd1aWQpO1xyXG5cclxuICAgICAgX3RoaXMuZ3JhcGhDb25uZWN0b3IucXVlcnlHbG9iYWxSZWdpc3RyeShndWlkKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGdyYXBoQ29ubmVjdG9yQ29udGFjdERhdGEpIHtcclxuXHJcbiAgICAgICAgLy8gbG9nLmxvZygnSW5mb3JtYXRpb24gcmV0dXJuZWQgZnJvbSBHbG9iYWwgUmVnaXN0cnk6ICcsIGdyYXBoQ29ubmVjdG9yQ29udGFjdERhdGEpO1xyXG5cclxuICAgICAgICAgIGlmICh0eXBlb2YgZ3JhcGhDb25uZWN0b3JDb250YWN0RGF0YSA9PT0gJ3N0cmluZycgfHwgIWdyYXBoQ29ubmVjdG9yQ29udGFjdERhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgnVW5zdWNjZXNzZnVsIGRpc2NvdmVyIHVzZXJJRHMgYnkgR1VJRCcpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIGxldCB1c2VyaWRzID0gZ3JhcGhDb25uZWN0b3JDb250YWN0RGF0YS51c2VySURzO1xyXG5cclxuICAgICAgICAgICAgaWYgKHVzZXJpZHMubGVuZ3RoID09PSAwKSB7IHJldHVybiByZWplY3QoJ1VzZXJJRHMgbm90IGF2YWlsYWJsZScpOyB9XHJcblxyXG4gICAgICAgICAgICByZXNvbHZlKHVzZXJpZHMpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogZnVuY3Rpb24gdG8gcmVxdWVzdCBkaXNjb3Zlcnkgc2VydmljZSBhYm91dCB0aGUgR1VJRCBhc3NvY2lhdGVkIHdpdGggc29tZSB1c2VyIGlkZW50aWZpZXIgKGVnIGVtYWlsLCBuYW1lIC4uLilcclxuICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgICB1c2VySWRlbnRpZmllclxyXG4gICogQHJldHVybiB7UHJvbWlzZX0gICAgICAgICAgIFByb21pc2VcclxuICAqL1xyXG4gIGRpc2NvdmVyR1VJRFBlclVzZXJJZGVudGlmaWVyKHVzZXJJZGVudGlmaWVyKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIGxldCBsb29rdXBVUkxEaXNjb3ZlcnlTZXJ2aWNlID0gJ2h0dHBzOi8vcmV0aGluay50bGFic2Nsb3VkLmNvbS9kaXNjb3ZlcnkvcmVzdC9kaXNjb3Zlci9sb29rdXA/c2VhcmNocXVlcnk9JztcclxuICAgICAgX3RoaXMuaHR0cFJlcXVlc3QuZ2V0KGxvb2t1cFVSTERpc2NvdmVyeVNlcnZpY2UgKyB1c2VySWRlbnRpZmllcilcclxuICAgICAgICAudGhlbihmdW5jdGlvbihqc29uKSB7XHJcbiAgICAgICAgLy8gbG9nLmxvZygnZGlzY292ZXIgR1VJRCBieSB1c2VyIGlkZW50aWZpZXInLCBqc29uKTtcclxuXHJcbiAgICAgICAgICBsZXQgcmVzcG9uc2UgPSBKU09OLnBhcnNlKGpzb24pO1xyXG4gICAgICAgICAgbGV0IGZpbHRlcmVkR3VpZCA9IHJlc3BvbnNlLnJlc3VsdHMuZmlsdGVyKGZ1bmN0aW9uKHgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHgucmV0aGlua0lEICE9IHVuZGVmaW5lZDtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGlmIChmaWx0ZXJlZEd1aWQubGVuZ3RoID09PSAwKSB7IHJldHVybiByZWplY3QoJ1Vuc3VjY2Vzc2Z1bCBkaXNjb3ZlciBHVUlEIGJ5IHVzZXIgaWRlbnRpZmllcicpOyB9XHJcblxyXG4gICAgICAgICAgbGV0IGd1aWRzID0gZmlsdGVyZWRHdWlkLm1hcChmdW5jdGlvbih4KSB7IHJldHVybiB4LnJldGhpbmtJRDsgfSk7XHJcblxyXG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUoZ3VpZHMpO1xyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAvLyBsb2cubG9nKFwiSFRUUCBSZXF1ZXN0IGVycm9yOiBcIiwgZXJyKTtcclxuICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ29yZURpc2NvdmVyeTtcclxuIiwiLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignRGF0YU9iamVjdHNTdG9yYWdlJyk7XHJcblxyXG5pbXBvcnQgeyBhc3NpZ24sIGRlZXBDbG9uZSwgZGl2aWRlVVJMIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuaW1wb3J0IHsgY3JlYXRlU3luY0RCIH0gZnJvbSAnLi4vcnVudGltZS9TdG9yYWdlJztcclxuXHJcbmNsYXNzIERhdGFPYmplY3RzU3RvcmFnZSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHN0b3JhZ2VNYW5hZ2VyLCBzdG9yZWREYXRhT2JqZWN0cyA9IHt9LCBmYWN0b3J5LCBydW50aW1lU3RhdHVzVXBkYXRlKSB7XHJcbiAgICBpZiAoIXN0b3JhZ2VNYW5hZ2VyKSB0aHJvdyBuZXcgRXJyb3IoJ1tTdG9yZSBEYXRhIE9iamVjdHNdIC0gTmVlZHMgdGhlIHN0b3JhZ2VNYW5hZ2VyIGNvbXBvbmVudCcpO1xyXG5cclxuICAgIHRoaXMuX3N0b3JhZ2VNYW5hZ2VyID0gc3RvcmFnZU1hbmFnZXI7XHJcblxyXG4gICAgdGhpcy5fc3RvcmVEYXRhT2JqZWN0ID0gc3RvcmVkRGF0YU9iamVjdHM7XHJcblxyXG4gICAgdGhpcy5fY2FjaGUgPSB7fTtcclxuXHJcbiAgICB0aGlzLl9jcmVhdGVTeW5jREIgPSBjcmVhdGVTeW5jREI7IC8vIHRvIGNyZWF0ZSBEYXRhIE9iamVjdHMgdG8gYmUgc3luY2hlZCB3aXRoIHJlbW90ZSBzdG9yYWdlc1xyXG4gICAgdGhpcy5fcmVtb3RlcyA9IHt9OyAvLyBMaXN0IG9mIERPIHN5bmNoZWQgd2l0aCByZW1vdGUgc3RvcmFnZXNcclxuICAgIHRoaXMuX2ZhY3RvcnkgPSBmYWN0b3J5O1xyXG4gICAgdGhpcy5fdGFibGUgPSAnc3luY2hlck1hbmFnZXI6T2JqZWN0VVJMcyc7XHJcbiAgICB0aGlzLl9yZW1vdGVTdG9yYWdlVGFibGUgPSAnZGF0YU9iamVjdFN0b3JhZ2UnO1xyXG4gICAgdGhpcy5fcmVtb3RlU2NoZW1hID0gJ3VybCc7XHJcbiAgICB0aGlzLl9ydW50aW1lU3RhdHVzVXBkYXRlID0gcnVudGltZVN0YXR1c1VwZGF0ZTtcclxuICB9XHJcblxyXG4gIC8vIGxvYWQgRGF0YSBPYmplY3RzIHN5bmNoZWQgd2l0aCByZW1vdGUgU3RvcmFnZXNcclxuXHJcbiAgbG9hZFJlbW90ZShyZXN1bWUgPSBmYWxzZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGxldCBsb2FkaW5nID0gW107XHJcbiAgICAgIGxldCBsb2FkaW5nREJzID0gW107XHJcblxyXG4gICAgICBfdGhpcy5fc3RvcmFnZU1hbmFnZXIuZ2V0KG51bGwsIG51bGwsICdyZW1vdGVzJykudGhlbigocmVtb3RlcykgPT4ge1xyXG5cclxuICAgICAgICAvLyBpbiBjYXNlIHdlIGRvbid0IGhhdmUgYW55IHJlbW90ZXMgbG9jYWxseSBzdG9yZWRcclxuICAgICAgICBsb2cuaW5mbygnW1N0b3JlRGF0YU9iamVjdHMubG9hZFJlbW90ZV0gcmVtb3RlczogJywgcmVtb3Rlcyk7XHJcbiAgICAgICAgaWYgKCFyZW1vdGVzKSByZXNvbHZlKCk7XHJcblxyXG4gICAgICAgIGlmICghcmVzdW1lKSBfdGhpcy5fcmVtb3RlcyA9IHJlbW90ZXM7XHJcblxyXG4gICAgICAgIGxvZy5pbmZvKCdbU3RvcmVEYXRhT2JqZWN0cy5sb2FkUmVtb3RlXSBsb2FkaW5nOiAnLCBfdGhpcy5fcmVtb3Rlcyk7XHJcblxyXG4gICAgICAgIGxldCByZW1vdGVPYmplY3RzID0gT2JqZWN0LmtleXMocmVtb3Rlcyk7XHJcblxyXG4gICAgICAgIC8vIGluIGNhc2Ugd2UgZG9uJ3QgaGF2ZSBhbnkgcmVtb3RlcyBsb2NhbGx5IHN0b3JlZFxyXG5cclxuICAgICAgICBpZiAocmVtb3RlT2JqZWN0cy5sZW5ndGggPT09IDApIHJlc29sdmUoKTtcclxuXHJcbiAgICAgICAgcmVtb3RlT2JqZWN0cy5mb3JFYWNoKChkYikgPT4ge1xyXG4gICAgICAgICAgbGV0IHNjaGVtYSA9IHt9O1xyXG4gICAgICAgICAgbGV0IHRhYmxlID0gZGIuc3BsaXQoJy8nKVszXTtcclxuICAgICAgICAgIHNjaGVtYVt0YWJsZV0gPSB0aGlzLl9yZW1vdGVTY2hlbWE7XHJcbiAgICAgICAgICBfdGhpcy5fcmVtb3Rlc1tkYl0gPSBjcmVhdGVTeW5jREIoZGIsIHRoaXMuX2ZhY3RvcnksIHNjaGVtYSwgdGhpcy5fcnVudGltZVN0YXR1c1VwZGF0ZSk7XHJcbiAgICAgICAgICAvLyAgICAgICAgICAgIF90aGlzLl9yZW1vdGVzW3JlbW90ZV0gPSBjcmVhdGVTeW5jREIocmVtb3RlLCBfdGhpcy5fZmFjdG9yeSwgJ3JlbW90ZURhdGFPYmplY3RTdG9yYWdlJyApO1xyXG4gICAgICAgICAgbG9hZGluZy5wdXNoKF90aGlzLl9yZW1vdGVzW2RiXS5nZXQobnVsbCwgbnVsbCwgdGFibGUpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgUHJvbWlzZS5hbGwobG9hZGluZykudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICBsb2cubG9nKCdbU3RvcmVEYXRhT2JqZWN0cy5sb2FkUmVtb3RlXSBsb2FkZWQuIFN0YXJ0aW5nIGluaXQnKTtcclxuICAgICAgICAgIC8vVE9ETzogaW5pdCB0aGlzLl9zdG9yZURhdGFPYmplY3Qgd2l0aCBsb2FkZWQgZGF0YSBvYmplY3RzXHJcbiAgICAgICAgICBPYmplY3Qua2V5cyhfdGhpcy5fcmVtb3RlcykuZm9yRWFjaCgocmVtb3RlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0YWJsZSA9IHJlbW90ZS5zcGxpdCgnLycpWzNdO1xyXG4gICAgICAgICAgICBsb2FkaW5nREJzLnB1c2goX3RoaXMuX3JlbW90ZXNbcmVtb3RlXS5nZXQobnVsbCwgbnVsbCwgdGFibGUpKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgUHJvbWlzZS5hbGwobG9hZGluZ0RCcykudGhlbigoZGF0YU9ianMpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGlmIChkYXRhT2Jqcy5sZW5ndGggPT09IDApIHJlc29sdmUoKTtcclxuXHJcbiAgICAgICAgICAgIGRhdGFPYmpzLmZvckVhY2goKGRPKSA9PiB7XHJcbiAgICAgICAgICAgICAgT2JqZWN0LmtleXMoZE8pLmZvckVhY2goKHVybCkgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxvZy5sb2coJ1tTdG9yZURhdGFPYmplY3RzLmxvYWRSZW1vdGVdIGxvYWRlZCByZW1vdGUgJywgZE9bdXJsXSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgaWYgKGRPW3JlbW90ZV0uaXNSZXBvcnRlcikge1xyXG4gICAgICAgICAgICAgICAgbGV0IHR5cGUgPSB0aGlzLl9nZXRUeXBlT2ZPYmplY3QoZE9bdXJsXS5pc1JlcG9ydGVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIV90aGlzLl9zdG9yZURhdGFPYmplY3QpIF90aGlzLl9zdG9yZURhdGFPYmplY3QgPSB7fTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIV90aGlzLl9zdG9yZURhdGFPYmplY3QuaGFzT3duUHJvcGVydHkodHlwZSkpIF90aGlzLl9zdG9yZURhdGFPYmplY3RbdHlwZV0gPSB7fTtcclxuXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3VybF0gPSBkT1t1cmxdO1xyXG5cclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuX3N0b3JlRGF0YU9iamVjdCk7XHJcblxyXG4gICAgICAgICAgfSwgKGVycm9yKSA9PiB7IHJlamVjdChlcnJvcikgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuIC8vIGRlbGV0ZSBEYXRhIE9iamVjdHMgc3luY2hlZCB3aXRoIHJlbW90ZSBTdG9yYWdlc1xyXG5cclxuIGRlbGV0ZVJlbW90ZXMoKSB7XHJcbiAgbGV0IF90aGlzID0gdGhpcztcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgbGV0IGRlbGV0aW5nID0gW107XHJcbiAgICBsZXQgZGlzY29ubmVjdGluZyA9IFtdO1xyXG5cclxuICAgIF90aGlzLl9zdG9yYWdlTWFuYWdlci5nZXQobnVsbCwgbnVsbCwgJ3JlbW90ZXMnKS50aGVuKChyZW1vdGVzKSA9PiB7XHJcblxyXG4gICAgICAvLyBpbiBjYXNlIHdlIGRvbid0IGhhdmUgYW55IHJlbW90ZXMgbG9jYWxseSBzdG9yZWRcclxuICAgICAgbG9nLmluZm8oJ1tTdG9yZURhdGFPYmplY3RzLmRlbGV0ZVJlbW90ZXNdIHJlbW90ZXM6ICcsIHJlbW90ZXMpO1xyXG4gICAgICBpZiAoIXJlbW90ZXMpIHJlc29sdmUoKTtcclxuXHJcbiAgICAgIGxldCByZW1vdGVPYmplY3RzID0gT2JqZWN0LmtleXMoX3RoaXMuX3JlbW90ZXMpO1xyXG5cclxuICAgICAgLy8gaW4gY2FzZSB3ZSBkb24ndCBoYXZlIGFueSByZW1vdGVzIGxvY2FsbHkgc3RvcmVkXHJcblxyXG4gICAgICBpZiAocmVtb3RlT2JqZWN0cy5sZW5ndGggPT09IDApIHJlc29sdmUoKTtcclxuXHJcbiAgICAgIHJlbW90ZU9iamVjdHMuZm9yRWFjaCgoZGIpID0+IHtcclxuICAgICAgICBkZWxldGluZy5wdXNoKFxyXG4gICAgICAgICAgX3RoaXMuX3JlbW90ZXNbZGJdLmRpc2Nvbm5lY3QoKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgZGVsZXRpbmcucHVzaChcclxuICAgICAgICAgIF90aGlzLl9yZW1vdGVzW2RiXS5kZWxldGUoKVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgUHJvbWlzZS5hbGwoZGVsZXRpbmcpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGxvZy5sb2coJ1tTdG9yZURhdGFPYmplY3RzLmRlbGV0ZVJlbW90ZXNdIGRlbGV0ZWQuJyk7XHJcblxyXG4gICAgICAgICAgcmVzb2x2ZSgpO1xyXG5cclxuICAgICAgICB9LCAoZXJyb3IpID0+IHsgcmVzb2x2ZSgpOyB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcblxyXG4gIH0pO1xyXG59XHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiBzaG91bGQgc2V0IHRoZSBpbml0aWFsIHN0YXRlIG9mIHRoZSBkYXRhT2JqZWN0VVJMIHRvIGJlIHJlc3VtZWQgaWYgbmVjZXNzYXJ5O1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtEYXRhT2JqZWN0VVJMfSB1cmwgLSBkYXRhT2JqZWN0VVJMIHRvIGJlIHNhdmVkO1xyXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNSZXBvcnRlciAtIHRoZSBvYmplY3QgdG8gYmUgc2F2ZWQgaXMgYSByZXBvcnRlclxyXG4gICAqIEBwYXJhbSB7U2NoZW1hVVJMfSBzY2hlbWEgLSB0aGUgc2NoZW1hIHVybFxyXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzdGF0dXMgLSB0aGUgc3RhdHVzIG9mIGN1cnJlbnQgZGF0YU9iamVjdFxyXG4gICAqIEBwYXJhbSB7SHlwZXJ0eVVSTH0gcmVwb3J0ZXIgLSB0aGUgUmVwb3J0ZXIgaHlwZXJ0eVVSTFxyXG4gICAqIEBwYXJhbSB7QXJyYXk8SHlwZXJ0eVVSTD59IHN1YnNjcmlwdGlvbiAtIGxpc3Qgb2Ygc3Vic2NyaXB0aW9uc1xyXG4gICAqIEBwYXJhbSB7QXJyYXk8RGF0YU9iamVjdENoaWxkPn0gY2hpbGRyZW4gLSBsaXN0IG9mIGNoaWxkcyBvZiBkYXRhT2JqZWN0VVJMXHJcbiAgICogQHBhcmFtIHtBcnJheTxTdHJpbmc+fSBjaGlsZHJlbnMgLSBsaXN0IG9mIGNoaWxkcmVucywgbGlrZSwgJ2NoYXRtZXNzYWdlJztcclxuICAgKiBAcGFyYW0ge0FycmF5PFVzZXJVUkx9IHN1YnNjcmliZXJVc2VyIC0gbGlzdCBvZiBzdWJzY3JpYmVkIHVzZXJzO1xyXG4gICAqL1xyXG5cclxuICBzZXQobWV0YWRhdGEpIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBsZXQgc3RvcmVEYXRhT2JqZWN0ID0gdGhpcy5fc3RvcmVEYXRhT2JqZWN0ID8gdGhpcy5fc3RvcmVEYXRhT2JqZWN0IDoge307XHJcbiAgICAgIGxldCB0eXBlID0gdGhpcy5fZ2V0VHlwZU9mT2JqZWN0KG1ldGFkYXRhLmlzUmVwb3J0ZXIpO1xyXG5cclxuXHJcbiAgICAgIGlmICghc3RvcmVEYXRhT2JqZWN0Lmhhc093blByb3BlcnR5KHR5cGUpKSBzdG9yZURhdGFPYmplY3RbdHlwZV0gPSB7fTtcclxuXHJcbiAgICAgIGlmICghc3RvcmVEYXRhT2JqZWN0W3R5cGVdLmhhc093blByb3BlcnR5KG1ldGFkYXRhLnVybCkpIHtcclxuICAgICAgICBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXSA9IHt9O1xyXG4gICAgICAgIHN0b3JlRGF0YU9iamVjdFt0eXBlXVttZXRhZGF0YS51cmxdLnN1YnNjcmlwdGlvbnMgPSBbXTsvLyBUT0RPOmRvIHdlIG5lZWQgdGhpcz9cclxuICAgICAgICBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXS5zdWJzY3JpYmVyVXNlcnMgPSBbXTsvLyBUT0RPOmRvIHdlIG5lZWQgdGhpcz9cclxuICAgICAgICBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXS5jaGlsZHJlbk9iamVjdHMgPSB7fTtcclxuICAgICAgICBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXS5kYXRhID0ge307XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIE9iamVjdC5hc3NpZ24oc3RvcmVEYXRhT2JqZWN0W3R5cGVdW21ldGFkYXRhLnVybF0sIG1ldGFkYXRhKTtcclxuICAgICAgZGVsZXRlIHN0b3JlRGF0YU9iamVjdFt0eXBlXVttZXRhZGF0YS51cmxdLnN1YnNjcmliZXJVc2VyO1xyXG4gICAgICBkZWxldGUgc3RvcmVEYXRhT2JqZWN0W3R5cGVdW21ldGFkYXRhLnVybF0uc3Vic2NyaWJlckh5cGVydHk7XHJcblxyXG4gICAgICBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXS5iYWNrdXAgPSBtZXRhZGF0YS5oYXNPd25Qcm9wZXJ0eSgnYmFja3VwJykgPyBtZXRhZGF0YS5iYWNrdXAgOiBmYWxzZTtcclxuXHJcbiAgICAgIC8qaWYgKHNjaGVtYSkgc3RvcmVEYXRhT2JqZWN0W3R5cGVdW21ldGFkYXRhLnVybF0uc2NoZW1hID0gc2NoZW1hO1xyXG4gICAgICBpZiAoc3RhdHVzKSBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXS5zdGF0dXMgPSBzdGF0dXM7XHJcbiAgICAgIGlmIChjaGlsZHJlblJlc291cmNlcykgc3RvcmVEYXRhT2JqZWN0W3R5cGVdW21ldGFkYXRhLnVybF0uY2hpbGRyZW5SZXNvdXJjZXMgPSBjaGlsZHJlblJlc291cmNlczsqL1xyXG5cclxuICAgICAgaWYgKG1ldGFkYXRhLnN1YnNjcmliZXJIeXBlcnR5ICYmICFtZXRhZGF0YS5pc1JlcG9ydGVyKSB7IC8vIFRPRE86IGRvIHdlIG5lZWQgdGhpcz9cclxuICAgICAgICB0aGlzLl91cGRhdGVUb0FycmF5KHN0b3JlRGF0YU9iamVjdFt0eXBlXSwgbWV0YWRhdGEudXJsLCAnc3Vic2NyaXB0aW9ucycsIG1ldGFkYXRhLnN1YnNjcmliZXJIeXBlcnR5KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy9zdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXS5vd25lciA9IG93bmVyO1xyXG5cclxuICAgICAgaWYgKG1ldGFkYXRhLnN1YnNjcmliZXJVc2VyKSB7IC8vIFRPRE86IGRvIHdlIG5lZWQgdGhpcz9cclxuICAgICAgICBpZiAoc3RvcmVEYXRhT2JqZWN0W3R5cGVdW21ldGFkYXRhLnVybF0uc3Vic2NyaWJlclVzZXJzLmluZGV4T2YobWV0YWRhdGEuc3Vic2NyaWJlclVzZXIpKSB7XHJcbiAgICAgICAgICB0aGlzLl91cGRhdGVUb0FycmF5KHN0b3JlRGF0YU9iamVjdFt0eXBlXSwgbWV0YWRhdGEudXJsLCAnc3Vic2NyaWJlclVzZXJzJywgbWV0YWRhdGEuc3Vic2NyaWJlclVzZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5fc3RvcmVEYXRhT2JqZWN0ID0gc3RvcmVEYXRhT2JqZWN0O1xyXG5cclxuICAgICAgbGV0IGJhY2t1cCA9IG1ldGFkYXRhLmhhc093blByb3BlcnR5KCdiYWNrdXAnKSA/IG1ldGFkYXRhLmJhY2t1cCA6IGZhbHNlO1xyXG4gICAgICBsZXQgZGIgPSBiYWNrdXAgPyBtZXRhZGF0YS51cmwgOiB0aGlzLl90YWJsZTtcclxuICAgICAgbGV0IHRhYmxlID0gYmFja3VwID8gZGIuc3BsaXQoJy8nKVszXSA6IHRoaXMuX3RhYmxlO1xyXG4gICAgICBpZiAoYmFja3VwICYmICF0aGlzLl9yZW1vdGVzW2RiXSkge1xyXG4gICAgICAgIGxldCBzY2hlbWEgPSB7fTtcclxuICAgICAgICBzY2hlbWFbdGFibGVdID0gdGhpcy5fcmVtb3RlU2NoZW1hO1xyXG4gICAgICAgIHRoaXMuX3JlbW90ZXNbZGJdID0gY3JlYXRlU3luY0RCKGRiLCB0aGlzLl9mYWN0b3J5LCBzY2hlbWEsIHRoaXMuX3J1bnRpbWVTdGF0dXNVcGRhdGUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBTYXZlIERhdGEgT2JqZWN0IFVSTCBhdCByZW1vdGVzIHRhYmxlIHRvIHN1cHBvcnQgcmVzdW1lc1xyXG5cclxuICAgICAgaWYgKGJhY2t1cCkgdGhpcy5fc3RvcmFnZU1hbmFnZXIuc2V0KG1ldGFkYXRhLnVybCwgMCwgbWV0YWRhdGEudXJsLCAncmVtb3RlcycpO1xyXG5cclxuICAgICAgbGV0IHN0b3JhZ2UgPSBiYWNrdXAgPyB0aGlzLl9yZW1vdGVzW2RiXSA6IHRoaXMuX3N0b3JhZ2VNYW5hZ2VyO1xyXG5cclxuICAgICAgaWYgKG1ldGFkYXRhLmlzUmVwb3J0ZXIgJiYgYmFja3VwKSB7Ly8gbGV0cyBjb25uZWN0IHRvIHJlbW90ZSBzdG9yYWdlIHRvIGVuYWJsZSBzeW5jXHJcbiAgICAgICAgbGV0IG9wdGlvbnMgPSB7IHRhYmxlOiB0YWJsZSB9O1xyXG4gICAgICAgIHN0b3JhZ2UuY29ubmVjdChvcHRpb25zKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHN0b3JhZ2Uuc2V0KGRiLCAwLCBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXSwgdGFibGUpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICByZXNvbHZlKHN0b3JlRGF0YU9iamVjdFt0eXBlXVttZXRhZGF0YS51cmxdKTtcclxuICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICBsb2cuZXJyb3IoJ1tEYXRhT2JqZWN0U3RvcmFnZS5zZXRdIGZhaWxlZCB0byBzYXZlIGludG8gcmVtb3RlIHN0b3JhZ2U6ICcsIGVycm9yKTtcclxuICAgICAgICAgICAgdGhpcy5fY29ubmVjdFRvUmVtb3RlVGhyZWFkKHN0b3JhZ2UsIG9wdGlvbnMsIGRiLCBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXSwgdGFibGUpO1xyXG4gICAgICAgICAgICByZXNvbHZlKHN0b3JlRGF0YU9iamVjdFt0eXBlXVttZXRhZGF0YS51cmxdKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgbG9nLmVycm9yKCdbRGF0YU9iamVjdFN0b3JhZ2Uuc2V0XSBmYWlsZWQgdG8gY29ubmVjdCB3aXRoIHJlbW90ZSBzdG9yYWdlOiAnLCBlcnJvciwgJyB0cnlpbmcgYWdhaW4uLi4nKTtcclxuICAgICAgICAgIHRoaXMuX2Nvbm5lY3RUb1JlbW90ZVRocmVhZChzdG9yYWdlLCBvcHRpb25zLCBkYiwgc3RvcmVEYXRhT2JqZWN0W3R5cGVdW21ldGFkYXRhLnVybF0sIHRhYmxlKTtcclxuICAgICAgICAgIHJlc29sdmUoc3RvcmVEYXRhT2JqZWN0W3R5cGVdW21ldGFkYXRhLnVybF0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vICAgICAgICAgIHJldHVybiBzdG9yZURhdGFPYmplY3RbdHlwZV1bbWV0YWRhdGEudXJsXTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzdG9yYWdlLnNldChkYiwgMSwgdGhpcy5fZmlsdGVyUmVtb3RlcyhzdG9yZURhdGFPYmplY3QpLCB0YWJsZSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICByZXNvbHZlKHN0b3JlRGF0YU9iamVjdFt0eXBlXVttZXRhZGF0YS51cmxdKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfY29ubmVjdFRvUmVtb3RlVGhyZWFkKHN0b3JhZ2UsIG9wdGlvbnMsIGRiLCBkYXRhT2JqZWN0LCB0YWJsZSkge1xyXG5cclxuICAgIGxldCBjb25uZWN0ZWQgPSBmYWxzZTtcclxuICAgIGxldCBpZDtcclxuXHJcbiAgICBsZXQgY29ubmVjdCA9IGZ1bmN0aW9uIChkTykge1xyXG4gICAgICBsb2cuZXJyb3IoJ1tEYXRhT2JqZWN0U3RvcmFnZS5fY29ubmVjdFRvUmVtb3RlXSB0cnlpbmcgdG8gY29ubmVjdCB0byByZW1vdGUgc3RvcmFnZSAuLi4gJyk7XHJcbiAgICAgIHN0b3JhZ2UuY29ubmVjdChvcHRpb25zKS50aGVuKCgpID0+IHtcclxuICAgICAgICBzdG9yYWdlLnNldChkYiwgMCwgZE8sIHRhYmxlKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIGNvbm5lY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICBjbGVhckludGVydmFsKGlkKTtcclxuICAgICAgICB9LCAoZXJyb3IpID0+IHtcclxuICAgICAgICAgIGxvZy5lcnJvcignW0RhdGFPYmplY3RTdG9yYWdlLl9jb25uZWN0VG9SZW1vdGVdIGZhaWxlZCB0byBzYXZlIGludG8gcmVtb3RlIHN0b3JhZ2U6ICcsIGVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgbG9nLmVycm9yKCdbRGF0YU9iamVjdFN0b3JhZ2UuX2Nvbm5lY3RUb1JlbW90ZV0gZmFpbGVkIHRvIGNvbm5lY3QgdG8gcmVtb3RlIHN0b3JhZ2U6ICcsIGVycm9yKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGlkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgaWYgKCFjb25uZWN0ZWQpIGNvbm5lY3QoZGF0YU9iamVjdCk7XHJcbiAgICB9LCA1MDAwKTtcclxuXHJcblxyXG4gIH1cclxuXHJcbiAgLy8gdG8gZmlsdGVyIERhdGEgT2JqZWN0cyB0aGF0IGFyZSBzdG9yZWQgb3V0c2lkZSB0aGUgT2JqZWN0VVJMcyB0YWJsZVxyXG5cclxuICBfZmlsdGVyUmVtb3RlcyhzdG9yZURhdGFPYmplY3QpIHtcclxuICAgIGxldCByZW1vdGVzID0gT2JqZWN0LmtleXModGhpcy5fcmVtb3Rlcyk7XHJcblxyXG4gICAgbGV0IGZpbHRlcmVkID0gZGVlcENsb25lKHN0b3JlRGF0YU9iamVjdCk7XHJcblxyXG4gICAgcmVtb3Rlcy5mb3JFYWNoKChyZW1vdGUpID0+IHtcclxuICAgICAgaWYgKGZpbHRlcmVkWydyZXBvcnRlcnMnXVtyZW1vdGVdKSBkZWxldGUgZmlsdGVyZWRbJ3JlcG9ydGVycyddW3JlbW90ZV07XHJcbiAgICAgIGVsc2UgZGVsZXRlIGZpbHRlcmVkWydvYnNlcnZlcnMnXVtyZW1vdGVdO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0U3RvcmFnZS5fZmlsdGVyUmVtb3Rlc10gJywgZmlsdGVyZWQpO1xyXG5cclxuICAgIHJldHVybiBmaWx0ZXJlZDtcclxuICB9XHJcblxyXG4gIC8vIEluaXRpYWwgU3luYyBvZiBPYnNlcnZlciB0byBhdm9pZCBsYXRlciBtaXNtYXRjaGVzIHdpdGggc3luYyByZXZpc2lvbnNcclxuICAvLyBPVXRkYXRlZDogbm90IHVzZWQgYW55bW9yZVxyXG4gIC8qXHJcbiAgICBpbml0aWFsT2JzZXJ2ZXJTeW5jKHJlc291cmNlLCBiYWNrdXBSZXZpc2lvbikge1xyXG4gICAgICAvLyB0byBiZSBjb21wbGV0ZWRcclxuICAgICAgbGV0IHRhYmxlID0gcmVzb3VyY2Uuc3BsaXQoJy8nKVszXTtcclxuICBcclxuICAgICAgbGV0IF90aGlzID0gdGhpcztcclxuICBcclxuICAgICAgbGV0IG9wdGlvbnMgPSB7dGFibGU6IHRhYmxlLCBvYnNlcnZlcjogdHJ1ZSwgYmFzZVJldmlzaW9uOiBiYWNrdXBSZXZpc2lvbiwgc3luY2VkUmV2aXNpb246IGJhY2t1cFJldmlzaW9ufTtcclxuICBcclxuICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0U3RvcmFnZS5pbml0aWFsT2JzZXJ2ZXJTeW5jXSBvYmplY3Q6ICcsIHJlc291cmNlLCAnIHJldmlzaW9uICcsIGJhY2t1cFJldmlzaW9uKVxyXG4gIFxyXG4gICAgICBfdGhpcy5fcmVtb3Rlc1tyZXNvdXJjZV0uY29ubmVjdChvcHRpb25zKS50aGVuKCgpPT4ge1xyXG4gIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFN0b3JhZ2UuaW5pdGlhbE9ic2VydmVyU3luY10gY29ubmVjdGVkICcpO1xyXG4gIFxyXG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fcmVtb3Rlc1tyZXNvdXJjZV0uZGlzY29ubmVjdCgpLnRoZW4oKCk9PntcclxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0U3RvcmFnZS5pbml0aWFsT2JzZXJ2ZXJTeW5jXSBkaXNjb25uZWN0ZWQgJyk7XHJcbiAgICAgICAgICAgICAgfSwoZXJyb3IpPT4ge1xyXG4gICAgICAgICAgICAgICAgbG9nLmVycm9yKCdbRGF0YU9iamVjdFN0b3JhZ2UuaW5pdGlhbE9ic2VydmVyU3luY10gRXJyb3IgZGlzY29ubmVjdGluZyB3aXRoIHJlbW90ZSBzdG9yYWdlJyk7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0sIDE1MDAwKVxyXG4gIFxyXG4gICAgICB9LCAoZXJyb3IpID0+IHtcclxuICAgICAgICBsb2cuZXJyb3IoJ1tEYXRhT2JqZWN0U3RvcmFnZS5pbml0aWFsT2JzZXJ2ZXJTeW5jXSBFcnJvciBjb25uZWN0aW5nIHRvIHJlbW90ZSBzdG9yYWdlJyk7XHJcbiAgICAgICAgcmVqZWN0KGVycm9yKVxyXG4gICAgICB9KTtcclxuICBcclxuICAgIH0qL1xyXG5cclxuICAvKipcclxuICAgKiBAZGVzY3JpcHRpb24gc2hvdWxkIHNhdmUgYW5kIHVwZGF0ZSB0aGUgY3VycmVudCBkYXRhT2JqZWN0IGRhdGEgaW5mb3JtYXRpb25cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNSZXBvcnRlciAtIHRoZSBvYmplY3QgdG8gYmUgc2F2ZWQgaXMgYSByZXBvcnRlclxyXG4gICAqIEBwYXJhbSB7RGF0YU9iamVjdFVSTH0gcmVzb3VyY2UgLSBkYXRhT2JqZWN0VVJMIHRvIGJlIHNhdmVkIG9yIHVwZGF0ZWQ7XHJcbiAgICogQHBhcmFtIHtTdHJpbmd9IGF0dHJpYnV0ZSAtIGF0dHJpYnV0ZSBpbnNpZGUgdGhlIGRhdGEgd2hpY2ggd2lsbCBiZSBzYXZlZFxyXG4gICAqIEBwYXJhbSB7YW55fSBkYXRhIC0gdmFsdWUgd2lsbCBiZSBzYXZlZCBpbnNpZGUgdGhlIGF0dHJpYnV0ZTtcclxuICAgKi9cclxuICBzYXZlRGF0YShpc1JlcG9ydGVyLCByZXNvdXJjZSwgYXR0cmlidXRlLCB2YWx1ZSwgdXBkYXRlUnVudGltZVN0YXR1cykge1xyXG5cclxuICAgIGxldCBzdG9yZURhdGFPYmplY3QgPSB0aGlzLl9zdG9yZURhdGFPYmplY3Q7XHJcbiAgICBsZXQgdHlwZSA9IHRoaXMuX2dldFR5cGVPZk9iamVjdChpc1JlcG9ydGVyKTtcclxuXHJcbiAgICBpZiAoIXN0b3JlRGF0YU9iamVjdCB8fCAhc3RvcmVEYXRhT2JqZWN0W3R5cGVdIHx8ICFzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdKSB7XHJcbiAgICAgIGxvZy5sb2coJ1tTdG9yZURhdGFPYmplY3RzIC0gc2F2ZSBkYXRhXSAtIG5vdCBzYXZlZCcpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbG9nLmxvZygnW1N0b3JlRGF0YU9iamVjdHMgLSBzYXZlRGF0YV0gLSAnLCBpc1JlcG9ydGVyLCB0eXBlLCByZXNvdXJjZSwgYXR0cmlidXRlLCB2YWx1ZSk7XHJcblxyXG4gICAgaWYgKCFzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmhhc093blByb3BlcnR5KCdkYXRhJykpIHtcclxuICAgICAgc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXS5kYXRhID0ge307XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGF0dHJpYnV0ZSkge1xyXG4gICAgICBsZXQgZGF0YTtcclxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIGRhdGEgPSBkZWVwQ2xvbmUodmFsdWUpO1xyXG4gICAgICBlbHNlIGRhdGEgPSB2YWx1ZTtcclxuXHJcbiAgICAgIGFzc2lnbihzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmRhdGEsIGF0dHJpYnV0ZSwgZGF0YSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmRhdGEgPSBkZWVwQ2xvbmUodmFsdWUpIHx8IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3N0b3JlRGF0YU9iamVjdCA9IHN0b3JlRGF0YU9iamVjdDtcclxuICAgIGxldCBkYiA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXS51cmwgOiAnc3luY2hlck1hbmFnZXI6T2JqZWN0VVJMcyc7XHJcbiAgICBsZXQgc3RvcmFnZSA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gdGhpcy5fcmVtb3Rlc1tkYl0gOiB0aGlzLl9zdG9yYWdlTWFuYWdlcjtcclxuICAgIGxldCB0YWJsZSA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gZGIuc3BsaXQoJy8nKVszXSA6IHRoaXMuX3RhYmxlO1xyXG4gICAgbGV0IGRhdGEgPSBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmJhY2t1cCA/IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0gOiB0aGlzLl9maWx0ZXJSZW1vdGVzKHN0b3JlRGF0YU9iamVjdCk7XHJcbiAgICBzdG9yYWdlLnNldChkYiwgMSwgZGF0YSwgdGFibGUsIHVwZGF0ZVJ1bnRpbWVTdGF0dXMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICByZXR1cm4gc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXTtcclxuICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgcmV0dXJuIHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNhdmVDaGlsZHJlbnMoaXNSZXBvcnRlciwgcmVzb3VyY2UsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcclxuICAgIGxldCBzdG9yZURhdGFPYmplY3QgPSB0aGlzLl9zdG9yZURhdGFPYmplY3Q7XHJcbiAgICBsZXQgdHlwZSA9IHRoaXMuX2dldFR5cGVPZk9iamVjdChpc1JlcG9ydGVyKTtcclxuXHJcbiAgICBpZiAoIXN0b3JlRGF0YU9iamVjdCB8fCAhc3RvcmVEYXRhT2JqZWN0W3R5cGVdIHx8ICFzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdKSB7XHJcbiAgICAgIGxvZy5sb2coJ1tTdG9yZURhdGFPYmplY3RzIC0gc2F2ZSBjaGlsZHJlbnNdIC0gbm90IHNhdmVkJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uaGFzT3duUHJvcGVydHkoJ2NoaWxkcmVucycpKSB7XHJcbiAgICAgIHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uY2hpbGRyZW5PYmplY3RzID0ge307XHJcbiAgICB9XHJcblxyXG4gICAgLyogICAgaWYgKCFzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmNoaWxkcmVuT2JqZWN0cy5oYXNPd25Qcm9wZXJ0eSgncmVzb3VyY2VzJykpIHtcclxuICAgICAgICAgIHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uY2hpbGRyZW5PYmplY3RzLnJlc291cmNlcyA9IHt9O1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgIGlmIChhdHRyaWJ1dGUpIHtcclxuICAgICAgYXNzaWduKHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uY2hpbGRyZW5PYmplY3RzLCBhdHRyaWJ1dGUsIGRlZXBDbG9uZSh2YWx1ZSkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXS5jaGlsZHJlbk9iamVjdHMgPSBkZWVwQ2xvbmUodmFsdWUpIHx8IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3N0b3JlRGF0YU9iamVjdCA9IHN0b3JlRGF0YU9iamVjdDtcclxuICAgIGxldCBkYiA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXS51cmwgOiAnc3luY2hlck1hbmFnZXI6T2JqZWN0VVJMcyc7XHJcbiAgICBsZXQgc3RvcmFnZSA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gdGhpcy5fcmVtb3Rlc1tkYl0gOiB0aGlzLl9zdG9yYWdlTWFuYWdlcjtcclxuICAgIGxldCB0YWJsZSA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gZGIuc3BsaXQoJy8nKVszXSA6IHRoaXMuX3RhYmxlO1xyXG4gICAgbGV0IGRhdGEgPSBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmJhY2t1cCA/IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0gOiB0aGlzLl9maWx0ZXJSZW1vdGVzKHN0b3JlRGF0YU9iamVjdCk7XHJcbiAgICBzdG9yYWdlLnNldChkYiwgMSwgZGF0YSwgdGFibGUpLnRoZW4oKCkgPT4ge1xyXG4gICAgICByZXR1cm4gc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiBzaG91bGQgc2F2ZSBhbmQgdXBkYXRlIHRoZSBjdXJyZW50IGRhdGFPYmplY3QgaW5mb3JtYXRpb25cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNSZXBvcnRlciAtIHRoZSBvYmplY3QgdG8gYmUgc2F2ZWQgaXMgYSByZXBvcnRlclxyXG4gICAqIEBwYXJhbSB7RGF0YU9iamVjdFVSTH0gcmVzb3VyY2UgLSBkYXRhT2JqZWN0VVJMIHRvIGJlIHNhdmVkIG9yIHVwZGF0ZWQ7XHJcbiAgICogQHBhcmFtIHtTdHJpbmd9IGF0dHJpYnV0ZSAtIGF0dHJpYnV0ZSBpbnNpZGUgdGhlIGRhdGEgd2hpY2ggd2lsbCBiZSBzYXZlZFxyXG4gICAqIEBwYXJhbSB7YW55fSBkYXRhIC0gdmFsdWUgd2lsbCBiZSBzYXZlZCBpbnNpZGUgdGhlIGF0dHJpYnV0ZTtcclxuICAgKi9cclxuICB1cGRhdGUoaXNSZXBvcnRlciwgcmVzb3VyY2UsIGF0dHJpYnV0ZSwgdmFsdWUsIHVwZGF0ZVJ1bnRpbWVTdGF0dXMpIHtcclxuXHJcbiAgICBsZXQgc3RvcmVEYXRhT2JqZWN0ID0gdGhpcy5fc3RvcmVEYXRhT2JqZWN0O1xyXG4gICAgbGV0IHR5cGUgPSB0aGlzLl9nZXRUeXBlT2ZPYmplY3QoaXNSZXBvcnRlcik7XHJcblxyXG4gICAgaWYgKCFzdG9yZURhdGFPYmplY3QgfHwgIXN0b3JlRGF0YU9iamVjdFt0eXBlXSB8fCAhc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXSkge1xyXG4gICAgICBsb2cubG9nKCdbU3RvcmVEYXRhT2JqZWN0cyAtIHVwZGF0ZV0gLSBub3Qgc2F2ZWQnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxvZy5sb2coJ1tTdG9yZURhdGFPYmplY3RzIC0gdXBkYXRlXSAtICcsIGlzUmVwb3J0ZXIsIHR5cGUsIHJlc291cmNlLCBhdHRyaWJ1dGUsIHZhbHVlKTtcclxuXHJcbiAgICBpZiAoc3RvcmVEYXRhT2JqZWN0W3R5cGVdICYmIHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0gJiYgcmVzb3VyY2UgJiYgYXR0cmlidXRlICYmIHZhbHVlKSB7XHJcblxyXG4gICAgICBpZiAoYXR0cmlidXRlID09PSAnc3Vic2NyaXB0aW9ucycgfHwgYXR0cmlidXRlID09PSAnc3Vic2NyaWJlclVzZXJzJykge1xyXG4gICAgICAgIGxldCB1cGRhdGUgPSB0cnVlO1xyXG5cclxuICAgICAgICBpZiAoYXR0cmlidXRlID09PSAnc3Vic2NyaXB0aW9ucycpIHtcclxuICAgICAgICAgIHVwZGF0ZSA9ICF0aGlzLl9pc093bmVyKHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0sIHZhbHVlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh1cGRhdGUpIHRoaXMuX3VwZGF0ZVRvQXJyYXkoc3RvcmVEYXRhT2JqZWN0W3R5cGVdLCByZXNvdXJjZSwgYXR0cmlidXRlLCB2YWx1ZSk7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV1bYXR0cmlidXRlXSA9IHZhbHVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLl9zdG9yZURhdGFPYmplY3QgPSBzdG9yZURhdGFPYmplY3Q7XHJcbiAgICAgIGxldCBkYiA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXS51cmwgOiAnc3luY2hlck1hbmFnZXI6T2JqZWN0VVJMcyc7XHJcbiAgICAgIGxldCBzdG9yYWdlID0gc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXS5iYWNrdXAgPyB0aGlzLl9yZW1vdGVzW2RiXSA6IHRoaXMuX3N0b3JhZ2VNYW5hZ2VyO1xyXG4gICAgICBsZXQgdGFibGUgPSBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmJhY2t1cCA/IGRiLnNwbGl0KCcvJylbM10gOiB0aGlzLl90YWJsZTtcclxuICAgICAgbGV0IGRhdGEgPSBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmJhY2t1cCA/IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0gOiB0aGlzLl9maWx0ZXJSZW1vdGVzKHN0b3JlRGF0YU9iamVjdCk7XHJcbiAgICAgIHN0b3JhZ2Uuc2V0KGRiLCAxLCBkYXRhLCB0YWJsZSwgdXBkYXRlUnVudGltZVN0YXR1cykudGhlbigoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV07XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGRlc2NyaXB0aW9uIHNob3VsZCBkZWxldGUgc3RvcmVkIGluZm9ybWF0aW9uIGZyb20gdGhlIGRhdGFPYmplY3RcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNSZXBvcnRlciAtIHRoZSBvYmplY3QgdG8gYmUgc2F2ZWQgaXMgYSByZXBvcnRlclxyXG4gICAqIEBwYXJhbSB7RGF0YU9iamVjdFVSTH0gcmVzb3VyY2UgLSBkYXRhT2JqZWN0VVJMIHRvIGJlIHNhdmVkIG9yIHVwZGF0ZWQ7XHJcbiAgICogQHBhcmFtIHtTdHJpbmd9IGF0dHJpYnV0ZSAtIGF0dHJpYnV0ZSBpbnNpZGUgdGhlIGRhdGEgd2hpY2ggd2lsbCBiZSBzYXZlZFxyXG4gICAqIEBwYXJhbSB7YW55fSBkYXRhIC0gdmFsdWUgd2lsbCBiZSBzYXZlZCBpbnNpZGUgdGhlIGF0dHJpYnV0ZTtcclxuICAgKi9cclxuICBkZWxldGUoaXNSZXBvcnRlciwgcmVzb3VyY2UsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcclxuXHJcbiAgICBsZXQgc3RvcmVEYXRhT2JqZWN0ID0gdGhpcy5fc3RvcmVEYXRhT2JqZWN0O1xyXG4gICAgbGV0IHR5cGUgPSB0aGlzLl9nZXRUeXBlT2ZPYmplY3QoaXNSZXBvcnRlcik7XHJcblxyXG4gICAgaWYgKCFzdG9yZURhdGFPYmplY3QgfHwgIXN0b3JlRGF0YU9iamVjdFt0eXBlXSB8fCAhc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXSkge1xyXG4gICAgICBsb2cubG9nKCdbU3RvcmVEYXRhT2JqZWN0cyAtIGRlbGV0ZV0gLSBub3Qgc2F2ZWQnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzdG9yZURhdGFPYmplY3RbdHlwZV0gJiYgc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXSAmJiByZXNvdXJjZSAmJiBhdHRyaWJ1dGUgJiYgdmFsdWUpIHtcclxuXHJcbiAgICAgIGlmIChhdHRyaWJ1dGUgPT09ICdzdWJzY3JpcHRpb25zJyB8fCBhdHRyaWJ1dGUgPT09ICdzdWJzY3JpYmVyVXNlcnMnKSB7XHJcbiAgICAgICAgdGhpcy5fcmVtb3ZlRnJvbUFycmF5KHN0b3JlRGF0YU9iamVjdFt0eXBlXSwgcmVzb3VyY2UsIGF0dHJpYnV0ZSwgdmFsdWUpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRlbGV0ZSBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdW2F0dHJpYnV0ZV07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuX3N0b3JlRGF0YU9iamVjdCA9IHN0b3JlRGF0YU9iamVjdDtcclxuICAgICAgbGV0IGRiID0gc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXS5iYWNrdXAgPyBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLnVybCA6ICdzeW5jaGVyTWFuYWdlcjpPYmplY3RVUkxzJztcclxuICAgICAgbGV0IHN0b3JhZ2UgPSBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdLmJhY2t1cCA/IHRoaXMuX3JlbW90ZXNbZGJdIDogdGhpcy5fc3RvcmFnZU1hbmFnZXI7XHJcbiAgICAgIGxldCB0YWJsZSA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gZGIuc3BsaXQoJy8nKVszXSA6IHRoaXMuX3RhYmxlO1xyXG4gICAgICBsZXQgZGF0YSA9IHN0b3JlRGF0YU9iamVjdFt0eXBlXVtyZXNvdXJjZV0uYmFja3VwID8gc3RvcmVEYXRhT2JqZWN0W3R5cGVdW3Jlc291cmNlXSA6IHRoaXMuX2ZpbHRlclJlbW90ZXMoc3RvcmVEYXRhT2JqZWN0KTtcclxuICAgICAgc3RvcmFnZS5zZXQoZGIsIDEsIGRhdGEsIHRhYmxlKTtcclxuXHJcbiAgICAgIHJldHVybiBzdG9yZURhdGFPYmplY3RbdHlwZV1bcmVzb3VyY2VdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVsZXRlIERhdGEgT2JqZWN0IGZyb20gdGhlIHN0b3JhZ2VcclxuICAgKi9cclxuXHJcbiAgZGVsZXRlUmVzb3VyY2UocmVzb3VyY2UpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBpZiAocmVzb3VyY2UpIHtcclxuICAgICAgICAvLyAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsKCkudGhlbigoc3RvcmVkRGF0YU9iamVjdHMpID0+IHtcclxuICAgICAgICBsb2cuaW5mbygnW0RhdGFPYmplY3RTdG9yYWdlLmRlbGV0ZVJlc291cmNlXSBkZWxldGluZzogJywgcmVzb3VyY2UpO1xyXG5cclxuICAgICAgICAvLyAgICAgICAgICBsZXQgdGhpcy5fc3RvcmVEYXRhT2JqZWN0ID0gT2JqZWN0LmFzc2lnbih0aGlzLl9zdG9yZURhdGFPYmplY3QgfHwge30pO1xyXG5cclxuICAgICAgICBsZXQgYmFja3VwO1xyXG4gICAgICAgIGxldCBkYjtcclxuICAgICAgICBsZXQgc3RvcmFnZTtcclxuXHJcbiAgICAgICAgaWYgKF90aGlzLl9zdG9yZURhdGFPYmplY3QuaGFzT3duUHJvcGVydHkoJ29ic2VydmVycycpICYmIF90aGlzLl9zdG9yZURhdGFPYmplY3Qub2JzZXJ2ZXJzLmhhc093blByb3BlcnR5KHJlc291cmNlKSkge1xyXG4gICAgICAgICAgYmFja3VwID0gKF90aGlzLl9zdG9yZURhdGFPYmplY3Qub2JzZXJ2ZXJzW3Jlc291cmNlXS5iYWNrdXApID8gdHJ1ZSA6IGZhbHNlO1xyXG5cclxuICAgICAgICAgIGRiID0gYmFja3VwID8gX3RoaXMuX3N0b3JlRGF0YU9iamVjdC5vYnNlcnZlcnNbcmVzb3VyY2VdLnVybCA6ICdzeW5jaGVyTWFuYWdlcjpPYmplY3RVUkxzJztcclxuICAgICAgICAgIHN0b3JhZ2UgPSBiYWNrdXAgPyBfdGhpcy5fcmVtb3Rlc1tkYl0gOiBfdGhpcy5fc3RvcmFnZU1hbmFnZXI7XHJcbiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N0b3JlRGF0YU9iamVjdC5vYnNlcnZlcnNbcmVzb3VyY2VdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKF90aGlzLl9zdG9yZURhdGFPYmplY3QuaGFzT3duUHJvcGVydHkoJ3JlcG9ydGVycycpICYmIF90aGlzLl9zdG9yZURhdGFPYmplY3QucmVwb3J0ZXJzLmhhc093blByb3BlcnR5KHJlc291cmNlKSkge1xyXG4gICAgICAgICAgYmFja3VwID0gKF90aGlzLl9zdG9yZURhdGFPYmplY3QucmVwb3J0ZXJzW3Jlc291cmNlXS5iYWNrdXApID8gdHJ1ZSA6IGZhbHNlO1xyXG5cclxuICAgICAgICAgIGRiID0gYmFja3VwID8gX3RoaXMuX3N0b3JlRGF0YU9iamVjdC5yZXBvcnRlcnNbcmVzb3VyY2VdLnVybCA6ICdzeW5jaGVyTWFuYWdlcjpPYmplY3RVUkxzJztcclxuICAgICAgICAgIHN0b3JhZ2UgPSBiYWNrdXAgPyBfdGhpcy5fcmVtb3Rlc1tkYl0gOiBfdGhpcy5fc3RvcmFnZU1hbmFnZXI7XHJcbiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N0b3JlRGF0YU9iamVjdC5yZXBvcnRlcnNbcmVzb3VyY2VdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gICAgICAgICAgdGhpcy5fc3RvcmVEYXRhT2JqZWN0ID0gdGhpcy5fc3RvcmVEYXRhT2JqZWN0O1xyXG5cclxuICAgICAgICBpZiAoYmFja3VwICYmIHN0b3JhZ2UpIHtcclxuICAgICAgICAgIHN0b3JhZ2UuZGVsZXRlKCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fcmVtb3Rlc1tkYl07XHJcbiAgICAgICAgICAgIF90aGlzLl9zdG9yYWdlTWFuYWdlci5kZWxldGUocmVzb3VyY2UsIG51bGwsICdyZW1vdGVzJyk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgc3RvcmFnZS5zZXQoZGIsIDEsIHRoaXMuX2ZpbHRlclJlbW90ZXMoX3RoaXMuX3N0b3JlRGF0YU9iamVjdCkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcclxuXHJcbiAgICAgICAgLy8gICAgICAgIH0pO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZWplY3QobmV3IEVycm9yKCdbU3RvcmVEYXRhT2JqZWN0c10gLSBDYW5cXCd0IGRlbGV0ZSB0aGlzICcgKyByZXNvdXJjZSkpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0QWxsKCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgX3RoaXMuX3N0b3JlRGF0YU9iamVjdCA9IHRoaXMuX3N0b3JhZ2VNYW5hZ2VyLmdldCgnc3luY2hlck1hbmFnZXI6T2JqZWN0VVJMcycpLnRoZW4oKG9iamVjdHMpID0+IHtcclxuICAgICAgICBfdGhpcy5fc3RvcmVEYXRhT2JqZWN0ID0gb2JqZWN0cztcclxuICAgICAgICBfdGhpcy5sb2FkUmVtb3RlKHRydWUpLnRoZW4oKHN0b3JlZE9iamVjdHMpID0+IHtcclxuICAgICAgICAgIHJlc29sdmUoX3RoaXMuX3N0b3JlRGF0YU9iamVjdCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuICAgIC8vICAgIHJldHVybiB0aGlzLl9zdG9yYWdlTWFuYWdlci5nZXQoJ3N5bmNoZXJNYW5hZ2VyOk9iamVjdFVSTHMnKTtcclxuICB9XHJcblxyXG4gIC8vIFRvIHN5bmMgbG9jYWwgc3RvcmFnZSB3aXRoIHJlbW90ZSBzdG9yYWdlIHNlcnZlclxyXG5cclxuICBzeW5jKHJlc291cmNlLCBiYWNrdXBSZXZpc2lvbiwgb25jZSA9IHRydWUpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgaWYgKF90aGlzLl9yZW1vdGVzW3Jlc291cmNlXSkge1xyXG5cclxuICAgICAgbGV0IHRhYmxlID0gcmVzb3VyY2Uuc3BsaXQoJy8nKVszXTtcclxuXHJcbiAgICAgIGlmIChiYWNrdXBSZXZpc2lvbikgcmV0dXJuIF90aGlzLl9zeW5jKHJlc291cmNlLCBiYWNrdXBSZXZpc2lvbiwgb25jZSwgdGFibGUpO1xyXG4gICAgICBlbHNlIF90aGlzLl9yZW1vdGVzW3Jlc291cmNlXS5nZXRCYWNrdXBSZXZpc2lvbihyZXNvdXJjZSkudGhlbigoYmFja3VwUmV2aXNpb24pID0+IHtcclxuICAgICAgICByZXR1cm4gX3RoaXMuX3N5bmMocmVzb3VyY2UsIGJhY2t1cFJldmlzaW9uLCBvbmNlLCB0YWJsZSk7XHJcblxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCBpbmZvID0gJ1tEYXRhT2JqZWN0U3RvcmFnZS5zeW5jXSBJbmZvOiAnICsgcmVzb3VyY2UgKyAnIGlzIG5vdCBzeW5jaGVkIHdpdGggcmVtb3RlIHN0b3JhZ2UuJ1xyXG4gICAgICBsb2cuaW5mbyhpbmZvKTtcclxuICAgICAgLy8gICAgICAgICAgcmVqZWN0KGluZm8pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3N5bmMocmVzb3VyY2UsIGJhY2t1cFJldmlzaW9uLCBvbmNlLCB0YWJsZSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RTdG9yYWdlLl9zeW5jXSBiYWNrdXBSZXZpc2lvbjogJywgYmFja3VwUmV2aXNpb24pO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgb3B0aW9ucyA9IHsgdGFibGU6IHRhYmxlLCBvYnNlcnZlcjogZmFsc2UsIHN5bmNlZFJldmlzaW9uOiBiYWNrdXBSZXZpc2lvbiArIDMgfTtcclxuXHJcbiAgICAgIF90aGlzLl9yZW1vdGVzW3Jlc291cmNlXS5jb25uZWN0KG9wdGlvbnMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGxvZy5pbmZvKCdbRGF0YU9iamVjdFN0b3JhZ2Uuc3luY10gY29ubmVjdGVkIHdpdGggcmVtb3RlICcpO1xyXG5cclxuICAgICAgICBfdGhpcy5fcmVtb3Rlc1tyZXNvdXJjZV0uZ2V0KG51bGwsIG51bGwsIHRhYmxlKS50aGVuKChkYXRhT2JqZWN0KSA9PiB7XHJcbiAgICAgICAgICAvLyAgICAgICAgICB0aGlzLl9yZW1vdGVzW3Jlc291cmNlXS5nZXQoKS50aGVuKChkYXRhT2JqZWN0KT0+e1xyXG4gICAgICAgICAgbG9nLmluZm8oJ1tEYXRhT2JqZWN0U3RvcmFnZS5zeW5jXSByZXR1cm5pbmcgc3luY2hlZCBETzogJywgZGF0YU9iamVjdCk7XHJcblxyXG4gICAgICAgICAgaWYgKG9uY2UpIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgX3RoaXMuX3JlbW90ZXNbcmVzb3VyY2VdLmRpc2Nvbm5lY3QoKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGxvZy5pbmZvKCdbRGF0YU9iamVjdFN0b3JhZ2Uuc3luY10gZGlzY29ubmVjdGVkICcpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhT2JqZWN0W3Jlc291cmNlXSk7XHJcbiAgICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoJ1tEYXRhT2JqZWN0U3RvcmFnZS5zeW5jXSBFcnJvciBzeW5jaGluZyB3aXRoIHJlbW90ZSBzdG9yYWdlJyk7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LCAyMDAwKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmVzb2x2ZShkYXRhT2JqZWN0W3Jlc291cmNlXSk7XHJcbiAgICAgICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICBsb2cuZXJyb3IoJ1tEYXRhT2JqZWN0U3RvcmFnZS5zeW5jXSBFcnJvciByZXRyaWV2aW5nIHN0b3JlZCBkYXRhIG9iamVjdCcpO1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LCAoZXJyb3IpID0+IHtcclxuICAgICAgICBsb2cuZXJyb3IoJ1tEYXRhT2JqZWN0U3RvcmFnZS5zeW5jXSBFcnJvciBjb25uZWN0aW5nIHRvIHJlbW90ZSBzdG9yYWdlICcsIGVycm9yKTtcclxuICAgICAgICBfdGhpcy5fcmVtb3Rlc1tyZXNvdXJjZV0uZ2V0KG51bGwsIG51bGwsIHRhYmxlKS50aGVuKChkYXRhT2JqZWN0KSA9PiB7XHJcbiAgICAgICAgICBsb2cuaW5mbygnW0RhdGFPYmplY3RTdG9yYWdlLnN5bmNdIHJldHVybmluZyBzeW5jaGVkIERPOiAnLCBkYXRhT2JqZWN0KTtcclxuICAgICAgICAgIHJlc29sdmUoZGF0YU9iamVjdFtyZXNvdXJjZV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc3RvcFN5bmMocmVzb3VyY2UpIHtcclxuXHJcbiAgICBpZiAodGhpcy5fcmVtb3Rlc1tyZXNvdXJjZV0pIHRoaXMuX3JlbW90ZXNbcmVzb3VyY2VdLmRpc2Nvbm5lY3QoKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuKiBAZGVzY3JpcHRpb24gc2hvdWxkIGxvb2sgZm9yIGEgc3BlY2lmaWMgZGF0YU9iamVjdFVSTFxyXG4qXHJcbiogQHBhcmFtIHtEYXRhT2JqZWN0VVJMfSByZXNvdXJjZSAtIHRoZSBkYXRhT2JqZWN0VVJMIHdpbGwgYmUgc2VhcmNoZWRcclxuKlxyXG4qIEByZXR1cm5zIFByb21pc2U8T2JqZWN0PiBvYmplY3Qgd2l0aCB0aGUgZGF0YU9iamVjdCBpbmZvcm1hdGlvbjtcclxuKi9cclxuICBnZXREYXRhT2JqZWN0KHJlc291cmNlKSB7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIC8qICAgICAgdGhpcy5fcmVtb3Rlc1tyZXNvdXJjZV0uZ2V0KCkudGhlbigoZGF0YU9iamVjdCk9PiB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoZGF0YU9iamVjdCk7XHJcbiAgICAgICAgICAgIH0gLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5fc3RvcmFnZU1hbmFnZXIuZ2V0KCdzeW5jaGVyTWFuYWdlcjpPYmplY3RVUkxzJykudGhlbigoc3RvcmVkRGF0YU9iamVjdCkgPT4geyovXHJcblxyXG4gICAgICBsZXQgc3RvcmVkRGF0YU9iamVjdCA9IHRoaXMuX3N0b3JlRGF0YU9iamVjdDtcclxuXHJcbiAgICAgIGxldCBvYnNlcnZlcnMgPSBzdG9yZWREYXRhT2JqZWN0Lmhhc093blByb3BlcnR5KCdvYnNlcnZlcnMnKSA/IHN0b3JlZERhdGFPYmplY3Qub2JzZXJ2ZXJzIDoge307XHJcbiAgICAgIGxldCByZXBvcnRlcnMgPSBzdG9yZWREYXRhT2JqZWN0Lmhhc093blByb3BlcnR5KCdyZXBvcnRlcnMnKSA/IHN0b3JlZERhdGFPYmplY3QucmVwb3J0ZXJzIDoge307XHJcblxyXG4gICAgICBsZXQgY3VycmVudFJlcG9ydGVyID0gT2JqZWN0LmtleXMocmVwb3J0ZXJzKS5maW5kKCh2YWx1ZSkgPT4geyByZXR1cm4gdmFsdWUgPT09IHJlc291cmNlOyB9KTtcclxuICAgICAgbGV0IGN1cnJlbnRPYnNlcnZlciA9IE9iamVjdC5rZXlzKG9ic2VydmVycykuZmluZCgodmFsdWUpID0+IHsgcmV0dXJuIHZhbHVlID09PSByZXNvdXJjZTsgfSk7XHJcbiAgICAgIGxldCBkYXRhT2JqZWN0O1xyXG5cclxuICAgICAgaWYgKGN1cnJlbnRPYnNlcnZlcikgeyBkYXRhT2JqZWN0ID0gc3RvcmVkRGF0YU9iamVjdC5vYnNlcnZlcnNbY3VycmVudE9ic2VydmVyXTsgfVxyXG4gICAgICBpZiAoY3VycmVudFJlcG9ydGVyKSB7IGRhdGFPYmplY3QgPSBzdG9yZWREYXRhT2JqZWN0LnJlcG9ydGVyc1tjdXJyZW50UmVwb3J0ZXJdOyB9XHJcblxyXG4gICAgICBsb2cuaW5mbygnW1N0b3JlRGF0YU9iamVjdHMgLSBnZXREYXRhT2JqZWN0XSAtIGZvciBvYnNlcnZlcjogJywgY3VycmVudE9ic2VydmVyKTtcclxuICAgICAgbG9nLmluZm8oJ1tTdG9yZURhdGFPYmplY3RzIC0gZ2V0RGF0YU9iamVjdF0gLSBmb3IgcmVwb3J0ZXJzOiAnLCBjdXJyZW50UmVwb3J0ZXIpO1xyXG5cclxuICAgICAgbG9nLmluZm8oJ1tTdG9yZURhdGFPYmplY3RzIC0gZ2V0RGF0YU9iamVjdF0gLSByZXNvbHZlOiAnLCBkYXRhT2JqZWN0KTtcclxuICAgICAgcmV0dXJuIGRhdGFPYmplY3QgPyByZXNvbHZlKGRhdGFPYmplY3QpIDogcmVqZWN0KCdObyBkYXRhT2JqZWN0IHdhcyBmb3VuZCcpO1xyXG5cclxuICAgICAgLy8gICAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiBzaG91bGQgZ2V0IHRoZSBkYXRhT2JqZWN0IGluZm9ybWF0aW9uIGJ5IHRoZSBtZXNzYWdlXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge09iamVjdH0gbXNnIC0gbWVzc2FnZSB3b3VsZCBiZSBhbmFsaXNlZCB0byBnZXQgdGhlIGN1cnJlbnQgZGF0YU9iamVjdCBpbmZvcm1hdGlvblxyXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNSZXBvcnRlciAtIHRoZSBvYmplY3QgdG8gYmUgc2F2ZWQgaXMgYSByZXBvcnRlclxyXG4gICAqXHJcbiAgICogQHJldHVybnMgUHJvbWlzZTxvYmplY3Q+IHNob3VsZCByZXR1biBhbiBvYmplY3Qgd2l0aCB0aGUgZGF0YU9iamVjdCBvciBudWxsXHJcbiAgICovXHJcbiAgZ2V0UmVzb3VyY2VzQnlDcml0ZXJpYShtc2csIGlzUmVwb3J0ZXIpIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHJcbiAgICAgIGxldCB0eXBlID0gdGhpcy5fZ2V0VHlwZU9mT2JqZWN0KGlzUmVwb3J0ZXIpO1xyXG5cclxuICAgICAgLy8gICAgICB0aGlzLmdldEFsbChpc1JlcG9ydGVyKS50aGVuKChzdG9yZWREYXRhT2JqZWN0cykgPT4ge1xyXG4gICAgICBsZXQgc3RvcmVkRGF0YU9iamVjdHMgPSB0aGlzLl9zdG9yZURhdGFPYmplY3Q7XHJcblxyXG4gICAgICBpZiAoIXN0b3JlZERhdGFPYmplY3RzKSB7XHJcbiAgICAgICAgbG9nLmxvZygnW0RhdGFPYmplY3RzU3RvcmFnZS5nZXRSZXNvdXJjZXNCeUNyaXRlcmlhXSBkb25cXCd0IGhhdmUgc3RvcmVkIGRhdGEgb2JqZWN0cycpO1xyXG4gICAgICAgIHJldHVybiByZXNvbHZlKG51bGwpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ3Jlc3VtZScpICYmICFtc2cuYm9keS5yZXN1bWUpIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShudWxsKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gY2hlY2sgaWYgdGhlIG1lc3NhZ2UgaGF2ZSBvdGhlciBjcml0ZXJpYVxyXG4gICAgICAvLyBpZiBub3Qgc2VhcmNoIGZvciBvbiB0aGUgJ2Zyb20nIG9mIHRoZSBtZXNzYWdlLlxyXG4gICAgICBsZXQgcmVzdWx0ID0gW107XHJcbiAgICAgIGxldCBoYXNTdWJzY3JpcHRpb24gPSB0aGlzLl9oYXNTdWJzY3JpcHRpb24oc3RvcmVkRGF0YU9iamVjdHNbdHlwZV0sIG1zZy5mcm9tKTtcclxuICAgICAgbGV0IGlzT3duZXIgPSB0aGlzLl9zZWFyY2hPd25lcihzdG9yZWREYXRhT2JqZWN0c1t0eXBlXSwgbXNnLmZyb20pO1xyXG4gICAgICBsZXQgaXNUb1Byb3RvU3R1YlJlc3VtZSA9IHRoaXMuX2NoZWNrUHJvdG9zdHViUmVzdW1lKHN0b3JlZERhdGFPYmplY3RzLCBtc2cpO1xyXG4gICAgICBsb2cubG9nKCdbU3RvcmVkRGF0YU9iamVjdHMgLSBnZXRSZXNvdXJjZXNCeUNyaXRlcmlhXTonLCBzdG9yZWREYXRhT2JqZWN0cywgbXNnLCBoYXNTdWJzY3JpcHRpb24sIGlzT3duZXIpO1xyXG4gICAgICBpZiAobXNnLmhhc093blByb3BlcnR5KCdmcm9tJykgJiYgaGFzU3Vic2NyaXB0aW9uIHx8IGlzT3duZXIgfHwgaXNUb1Byb3RvU3R1YlJlc3VtZSkge1xyXG4gICAgICAgIGxldCByZXNvdXJjZTtcclxuXHJcbiAgICAgICAgaWYgKGlzT3duZXIpIHtcclxuICAgICAgICAgIHJlc291cmNlID0gdGhpcy5fZ2V0UmVzb3VyY2VzQnlPd25lcihzdG9yZWREYXRhT2JqZWN0c1t0eXBlXSwgbXNnLmZyb20pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXNvdXJjZSA9IHRoaXMuX2dldFJlc291cmNlc0J5U3Vic2NyaXB0aW9uKHN0b3JlZERhdGFPYmplY3RzW3R5cGVdLCBtc2cuZnJvbSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaWRlbnRpdHlGb3VuZERhdGEgPSBbXTtcclxuICAgICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkuaWRlbnRpdHkpIGlkZW50aXR5Rm91bmREYXRhID0gdGhpcy5fZ2V0UmVzb3VyY2VzQnlJZGVudGl0eShzdG9yZWREYXRhT2JqZWN0c1t0eXBlXSwgbXNnLmJvZHkuaWRlbnRpdHkpO1xyXG5cclxuICAgICAgICAvL1RPRE86IHJlbW92ZSBzY2hlbWEgc2luY2UgbWV0YWRhdGEgYWxyZWFkeSBpbmNsdWRlcyB0aGUgc2NoZW1hP1xyXG5cclxuICAgICAgICBsZXQgc2NoZW1hRm91bmREYXRhID0gW107XHJcbiAgICAgICAgaWYgKG1zZy5ib2R5ICYmIG1zZy5ib2R5LnNjaGVtYSkgc2NoZW1hRm91bmREYXRhID0gdGhpcy5fZ2V0UmVzb3VyY2VzQnlTY2hlbWEoc3RvcmVkRGF0YU9iamVjdHNbdHlwZV0sIG1zZy5ib2R5LnNjaGVtYSk7XHJcblxyXG4gICAgICAgIGxldCBtZXRhZGF0YUZvdW5kID0gW107XHJcbiAgICAgICAgaWYgKG1zZy5ib2R5ICYmIG1zZy5ib2R5LnZhbHVlKSB7XHJcbiAgICAgICAgICBsZXQgbWV0YWRhdGEgPSBtc2cuYm9keS52YWx1ZTtcclxuICAgICAgICAgIGRlbGV0ZSBtZXRhZGF0YS5kYXRhO1xyXG4gICAgICAgICAgbWV0YWRhdGFGb3VuZCA9IHRoaXMuX2dldFJlc291cmNlc0J5TWV0YWRhdGEoc3RvcmVkRGF0YU9iamVjdHNbdHlwZV0sIG1ldGFkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBkYXRhRm91bmQgPSBbXTtcclxuICAgICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmFsdWUgJiYgbXNnLmJvZHkudmFsdWUuZGF0YSkgZGF0YUZvdW5kID0gdGhpcy5fZ2V0UmVzb3VyY2VzQnlEYXRhKHN0b3JlZERhdGFPYmplY3RzW3R5cGVdLCBtc2cuYm9keS52YWx1ZS5kYXRhKTtcclxuXHJcbiAgICAgICAgLy8geW91IGNhbiBwYXNzIGFzIGFycmF5cyBhcyB5b3Ugd2FudC4uIGl0IHdpbGwgYmUgbWVyZ2VkIGluIG9uIHBsYWNlXHJcbiAgICAgICAgLy8gcmVtb3ZlZCBkdXBsaWNhdGVzO1xyXG4gICAgICAgIHJlc3VsdCA9IHRoaXMuX2ludGVyc2VjdGlvbihyZXNvdXJjZSwgaWRlbnRpdHlGb3VuZERhdGEsIHNjaGVtYUZvdW5kRGF0YSwgZGF0YUZvdW5kLCBtZXRhZGF0YUZvdW5kKTtcclxuXHJcbiAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPT0gMCAmJiBpc1RvUHJvdG9TdHViUmVzdW1lICYmIHR5cGUgPT0gJ29ic2VydmVycycgJiYgbXNnLmZyb20uc3BsaXQoJ3Byb3Rvc3R1YicpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGxldCBzdG9yZWRPYnNlcnZlcnMgPSBzdG9yZWREYXRhT2JqZWN0c1t0eXBlXTtcclxuICAgICAgICAgIGxldCBmcm9tRG9tYWluID0gZGl2aWRlVVJMKG1zZy5mcm9tKS5kb21haW47XHJcbiAgICAgICAgICBPYmplY3Qua2V5cyhzdG9yZWRPYnNlcnZlcnMpLmZpbHRlcigob2JqZWN0VVJMKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzdWJzY3JpcHRpb25zID0gc3RvcmVkT2JzZXJ2ZXJzW29iamVjdFVSTF0uc3Vic2NyaXB0aW9ucztcclxuICAgICAgICAgICAgbGV0IGhhc1N1YnNjcmlwdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzdWJzY3JpcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICAgIGxldCBzdWJzY3JpcHRpb25Eb21haW4gPSBkaXZpZGVVUkwoc3Vic2NyaXB0aW9uKS5kb21haW47XHJcbiAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbkRvbWFpbiA9PSBmcm9tRG9tYWluKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChvYmplY3RVUkwpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShudWxsKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGluaXQgPSB7fTtcclxuICAgICAgcmVzdWx0LmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICAgIGxldCBjdXJyZW50SXNSZXBvcnRlciA9IHN0b3JlZERhdGFPYmplY3RzW3R5cGVdW2tleV07XHJcbiAgICAgICAgaW5pdFtrZXldID0gY3VycmVudElzUmVwb3J0ZXI7XHJcbiAgICAgICAgcmV0dXJuIGluaXQ7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbG9nLmxvZygnW1N0b3JlIERhdGEgT2JqZWN0c10gLSAnLCBpbml0KTtcclxuXHJcbiAgICAgIHJlc29sdmUoaW5pdCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEB0b2RvIGRvY3VtZW50YXRpb25cclxuICAgKi9cclxuICBfZ2V0UmVzb3VyY2VzQnlJZGVudGl0eShzdG9yZWREYXRhLCB1c2VyVVJMKSB7XHJcbiAgICBpZiAoIXN0b3JlZERhdGEpIHJldHVybiBbXTtcclxuXHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoc3RvcmVkRGF0YSkuZmlsdGVyKChvYmplY3RVUkwpID0+IHtcclxuICAgICAgcmV0dXJuIHN0b3JlZERhdGFbb2JqZWN0VVJMXS5zdWJzY3JpYmVyVXNlcnMuZmlsdGVyKChjdXJyZW50KSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQgPT09IHVzZXJVUkw7XHJcbiAgICAgIH0pLmxlbmd0aDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdG9kbyBkb2N1bWVudGF0aW9uXHJcbiAgICovXHJcbiAgX2dldFJlc291cmNlc0J5T3duZXIoc3RvcmVkRGF0YSwgb3duZXIpIHtcclxuICAgIGlmICghc3RvcmVkRGF0YSkgcmV0dXJuIFtdO1xyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHN0b3JlZERhdGEpLmZpbHRlcigob2JqZWN0VVJMKSA9PiB7XHJcbiAgICAgIHJldHVybiBzdG9yZWREYXRhW29iamVjdFVSTF0ucmVwb3J0ZXIgPT09IG93bmVyO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEB0b2RvIGRvY3VtZW50YXRpb25cclxuICAgKi9cclxuICBfZ2V0UmVzb3VyY2VzQnlTdWJzY3JpcHRpb24oc3RvcmVkRGF0YSwgc3Vic2NyaXB0aW9uKSB7XHJcbiAgICBpZiAoIXN0b3JlZERhdGEpIHJldHVybiBbXTtcclxuXHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoc3RvcmVkRGF0YSkuZmlsdGVyKChvYmplY3RVUkwpID0+IHtcclxuICAgICAgcmV0dXJuIHN0b3JlZERhdGFbb2JqZWN0VVJMXS5zdWJzY3JpcHRpb25zLmZpbHRlcigoY3VycmVudCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBjdXJyZW50ID09PSBzdWJzY3JpcHRpb247XHJcbiAgICAgIH0pLmxlbmd0aDtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQHRvZG8gZG9jdW1lbnRhdGlvblxyXG4gICAqL1xyXG4gIF9nZXRSZXNvdXJjZXNCeVNjaGVtYShzdG9yZWREYXRhLCBzY2hlbWEpIHtcclxuICAgIHJldHVybiBPYmplY3Qua2V5cyhzdG9yZWREYXRhKS5maWx0ZXIoKG9iamVjdFVSTCkgPT4ge1xyXG4gICAgICBsZXQgY3VycmVudE9iamVjdCA9IHN0b3JlZERhdGFbb2JqZWN0VVJMXTtcclxuICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGN1cnJlbnRPYmplY3QpLmZpbHRlcigoa2V5KSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGtleSA9PT0gJ3NjaGVtYScgJiYgY3VycmVudE9iamVjdFtrZXldID09PSBzY2hlbWE7XHJcbiAgICAgIH0pLmxlbmd0aDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdG9kbyBkb2N1bWVudGF0aW9uXHJcbiAgICovXHJcbiAgX2dldFJlc291cmNlc0J5TWV0YWRhdGEoc3RvcmVkRGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIGlmICghbWV0YWRhdGEpIHJldHVybiBbXTtcclxuXHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoc3RvcmVkRGF0YSkuZmlsdGVyKChvYmplY3RVUkwpID0+IHtcclxuICAgICAgbGV0IGN1cnJlbnRPYmplY3QgPSBzdG9yZWREYXRhW29iamVjdFVSTF07XHJcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhjdXJyZW50T2JqZWN0KS5maWx0ZXIoKGtleSkgPT4ge1xyXG4gICAgICAgIC8vIHNlYXJjaCBvbiBzdG9yZURhdGFPYmplY3RzIGZvciBzcGVjaWZpYyBrZXkgcHJvdmlkZWQgZnJvbSBkYXRhO1xyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhtZXRhZGF0YSkuZmlsdGVyKHNlYXJjaEZvciA9PiB7XHJcbiAgICAgICAgICByZXR1cm4ga2V5ID09PSBzZWFyY2hGb3IgJiYgY3VycmVudE9iamVjdFtrZXldID09PSBtZXRhZGF0YVtzZWFyY2hGb3JdO1xyXG4gICAgICAgIH0pLmxlbmd0aDtcclxuXHJcbiAgICAgIH0pLmxlbmd0aDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdG9kbyBkb2N1bWVudGF0aW9uXHJcbiAgICovXHJcbiAgX2dldFJlc291cmNlc0J5RGF0YShzdG9yZWREYXRhLCBkYXRhKSB7XHJcbiAgICBpZiAoIWRhdGEpIHJldHVybiBbXTtcclxuXHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoc3RvcmVkRGF0YSkuZmlsdGVyKChvYmplY3RVUkwpID0+IHtcclxuICAgICAgbGV0IGN1cnJlbnRPYmplY3QgPSBzdG9yZWREYXRhW29iamVjdFVSTF0uaGFzT3duUHJvcGVydHkoJ2RhdGEnKSA/IHN0b3JlZERhdGFbb2JqZWN0VVJMXS5kYXRhIDoge307XHJcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhjdXJyZW50T2JqZWN0KS5maWx0ZXIoKGtleSkgPT4ge1xyXG4gICAgICAgIC8vIHNlYXJjaCBvbiBzdG9yZURhdGFPYmplY3RzIGZvciBzcGVjaWZpYyBrZXkgcHJvdmlkZWQgZnJvbSBkYXRhO1xyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhkYXRhKS5maWx0ZXIoc2VhcmNoRm9yID0+IHtcclxuICAgICAgICAgIHJldHVybiBrZXkgPT09IHNlYXJjaEZvciAmJiBjdXJyZW50T2JqZWN0W2tleV0gPT09IGRhdGFbc2VhcmNoRm9yXTtcclxuICAgICAgICB9KS5sZW5ndGg7XHJcblxyXG4gICAgICB9KS5sZW5ndGg7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQHRvZG8gZG9jdW1lbnRhdGlvblxyXG4gICAqL1xyXG4gIF9oYXNTdWJzY3JpcHRpb24oc3RvcmVkRGF0YSwgc3Vic2NyaXB0aW9uKSB7XHJcbiAgICBpZiAoIXN0b3JlZERhdGEpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoc3RvcmVkRGF0YSkuZmlsdGVyKChvYmplY3RVUkwpID0+IHtcclxuICAgICAgcmV0dXJuIHN0b3JlZERhdGFbb2JqZWN0VVJMXS5zdWJzY3JpcHRpb25zLmZpbHRlcigoY3VycmVudCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBjdXJyZW50ID09PSBzdWJzY3JpcHRpb247XHJcbiAgICAgIH0pLmxlbmd0aDtcclxuICAgIH0pLmxlbmd0aCA+IDAgPyB0cnVlIDogZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEB0b2RvIGRvY3VtZW50YXRpb25cclxuICAgKi9cclxuICBfc2VhcmNoT3duZXIoc3RvcmVkRGF0YSwgZnJvbSkge1xyXG4gICAgaWYgKCFzdG9yZWREYXRhKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHN0b3JlZERhdGEpLmZpbHRlcigob2JqZWN0VVJMKSA9PiB7XHJcbiAgICAgIHJldHVybiBzdG9yZWREYXRhW29iamVjdFVSTF0ucmVwb3J0ZXIgPT09IGZyb207XHJcbiAgICB9KS5sZW5ndGggPiAwID8gdHJ1ZSA6IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdG9kbyBkb2N1bWVudGF0aW9uXHJcbiAgICovXHJcbiAgX2NoZWNrUHJvdG9zdHViUmVzdW1lKHN0b3JlZERhdGFPYmplY3RzLCBtc2cpIHtcclxuXHJcbiAgICBpZiAoIXN0b3JlZERhdGFPYmplY3RzKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgaWYgKG1zZy5oYXNPd25Qcm9wZXJ0eSgnYm9keScpICYmIG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCd2YWx1ZScpICYmIG1zZy5ib2R5LnZhbHVlLmhhc093blByb3BlcnR5KCdyZXBvcnRlcicpKSB7XHJcbiAgICAgIGxldCByZXBvcnRlciA9IG1zZy5ib2R5LnZhbHVlLnJlcG9ydGVyO1xyXG4gICAgICBpZiAoc3RvcmVkRGF0YU9iamVjdHMuaGFzT3duUHJvcGVydHkoJ3JlcG9ydGVycycpKSB7XHJcbiAgICAgICAgbGV0IHJlcG9ydGVyc1N0b3JlZCA9IHN0b3JlZERhdGFPYmplY3RzLnJlcG9ydGVycztcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMocmVwb3J0ZXJzU3RvcmVkKS5maWx0ZXIoKG9iamVjdFVSTCkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcG9ydGVyc1N0b3JlZFtvYmplY3RVUkxdLnJlcG9ydGVyID09PSByZXBvcnRlcjtcclxuICAgICAgICB9KS5sZW5ndGggPiAwID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChzdG9yZWREYXRhT2JqZWN0cy5oYXNPd25Qcm9wZXJ0eSgnb2JzZXJ2ZXJzJykpIHtcclxuICAgICAgbGV0IHN0b3JlZE9ic2VydmVycyA9IHN0b3JlZERhdGFPYmplY3RzLm9ic2VydmVycztcclxuICAgICAgbGV0IGZyb21Eb21haW4gPSBkaXZpZGVVUkwobXNnLmZyb20pLmRvbWFpbjtcclxuXHJcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhzdG9yZWRPYnNlcnZlcnMpLmZpbHRlcigob2JqZWN0VVJMKSA9PiB7XHJcbiAgICAgICAgbGV0IHN1YnNjcmlwdGlvbnMgPSBzdG9yZWRPYnNlcnZlcnNbb2JqZWN0VVJMXS5zdWJzY3JpcHRpb25zO1xyXG4gICAgICAgIGxldCBoYXNTdWJzY3JpcHRpb24gPSBmYWxzZTtcclxuICAgICAgICBzdWJzY3JpcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgbGV0IHN1YnNjcmlwdGlvbkRvbWFpbiA9IGRpdmlkZVVSTChzdWJzY3JpcHRpb24pLmRvbWFpbjtcclxuICAgICAgICAgIGlmIChzdWJzY3JpcHRpb25Eb21haW4gPT0gZnJvbURvbWFpbikge1xyXG4gICAgICAgICAgICBoYXNTdWJzY3JpcHRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChoYXNTdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkubGVuZ3RoID4gMCA/IHRydWUgOiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQHRvZG8gZG9jdW1lbnRhdGlvblxyXG4gICAqL1xyXG4gIF9pc093bmVyKHZhbHVlLCB1cmwpIHtcclxuICAgIGlmICghdmFsdWUpIHJldHVybiBmYWxzZTtcclxuICAgIHJldHVybiB2YWx1ZS5yZXBvcnRlciA9PT0gdXJsID8gdHJ1ZSA6IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdG9kbyBkb2N1bWVudGF0aW9uXHJcbiAgICovXHJcbiAgX2ludGVyc2VjdGlvbigpIHtcclxuICAgIGxldCBhcmdzID0gQXJyYXkuZnJvbShhcmd1bWVudHMpO1xyXG5cclxuICAgIGxldCByZXN1bHQgPSBhcmdzLnJlZHVjZSgoZmlyc3QsIHNlY29uZCkgPT4ge1xyXG4gICAgICByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7XHJcbiAgICB9KS5maWx0ZXIoKHZhbHVlLCBpbmRleCwgc2VsZikgPT4ge1xyXG4gICAgICByZXR1cm4gc2VsZi5pbmRleE9mKHZhbHVlKSA9PT0gaW5kZXg7XHJcbiAgICB9KTtcclxuICAgIGxvZy5sb2coJ0RhdGFPYmplY3RzU3RvcmFnZS5faW50ZXJzZWN0aW9uXSBSZXN1bHQgYW4gdW5pcXVlIGFycmF5IG9mIHN0cmluZ3M6ICcsIHJlc3VsdCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdG9kbyBkb2N1bWVudGF0aW9uXHJcbiAgICovXHJcbiAgX3VwZGF0ZVRvQXJyYXkoc3RvcmVEYXRhT2JqZWN0LCByZXNvdXJjZSwga2V5LCB2YWx1ZSkge1xyXG4gICAgbG9nLmxvZygnW0RhdGFPYmplY3RzU3RvcmFnZV0gLSBfdXBkYXRlVG9BcnJheTogJywgc3RvcmVEYXRhT2JqZWN0LCByZXNvdXJjZSwga2V5LCB2YWx1ZSk7XHJcbiAgICBpZiAoc3RvcmVEYXRhT2JqZWN0W3Jlc291cmNlXVtrZXldLmluZGV4T2YodmFsdWUpID09PSAtMSkgc3RvcmVEYXRhT2JqZWN0W3Jlc291cmNlXVtrZXldLnB1c2godmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAdG9kbyBkb2N1bWVudGF0aW9uXHJcbiAgICovXHJcbiAgX3JlbW92ZUZyb21BcnJheShzdG9yZURhdGFPYmplY3QsIHJlc291cmNlLCBrZXksIHZhbHVlKSB7XHJcbiAgICBsZXQgaW5kZXhPZlZhbHVlID0gc3RvcmVEYXRhT2JqZWN0W3Jlc291cmNlXVtrZXldLmluZGV4T2YodmFsdWUpO1xyXG4gICAgaWYgKGluZGV4T2ZWYWx1ZSA9PT0gLTEpIHN0b3JlRGF0YU9iamVjdFtyZXNvdXJjZV1ba2V5XS5zcGxpY2UoaW5kZXhPZlZhbHVlLCAxKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQHRvZG8gZG9jdW1lbnRhdGlvblxyXG4gICAqL1xyXG4gIF9oYXNWYWx1ZShvYmosIGtleSwgdmFsdWUpIHtcclxuICAgIHJldHVybiBvYmouaGFzT3duUHJvcGVydHkoa2V5KSAmJiBvYmpba2V5XSA9PT0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEB0b2RvIGRvY3VtZW50YXRpb25cclxuICAgKi9cclxuICBfZ2V0VHlwZU9mT2JqZWN0KGlzUmVwb3J0ZXIpIHtcclxuICAgIHJldHVybiBpc1JlcG9ydGVyID8gJ3JlcG9ydGVycycgOiAnb2JzZXJ2ZXJzJztcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBEYXRhT2JqZWN0c1N0b3JhZ2U7XHJcbiIsImNsYXNzIFByb21pc2VRdWV1ZSB7XHJcblxyXG4gIC8vIFRPRE86IEltcHJvdmUgdGhpcyBRdWV1aW5nXHJcbiAgY29uc3RydWN0b3IoY29uY3VycmVuY3kpIHtcclxuICAgIHRoaXMuZmx1c2hpbmcgPSBmYWxzZTtcclxuICAgIHRoaXMuUHJvbWlzZSA9IFByb21pc2U7XHJcbiAgICB0aGlzLmNvbmN1cnJlbmN5ID0gKHR5cGVvZiBjb25jdXJyZW5jeSAhPT0gJ251bWJlcicpID8gMSA6IGNvbmN1cnJlbmN5O1xyXG4gICAgdGhpcy5wcm9taXNlcyA9IFtdO1xyXG4gICAgdGhpcy5xdWV1ZSA9IFtdO1xyXG4gICAgdGhpcy5pc1Byb2Nlc3NpbmcgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGRvbmUoY2IpIHtcclxuICAgIHRoaXMuY2FsbGJhY2sgPSBjYjtcclxuICB9XHJcblxyXG4gIGFkZChwcm9taXNlKSB7XHJcbiAgICB0aGlzLnF1ZXVlLnB1c2gocHJvbWlzZSk7XHJcblxyXG4gICAgaWYgKCF0aGlzLmlzUHJvY2Vzc2luZykge1xyXG4gICAgICByZXR1cm4gdGhpcy5xdWV1ZS5yZWR1Y2UoKHByb21pc2VDaGFpbiwgY3VycmVudFRhc2spID0+IHtcclxuICAgICAgICByZXR1cm4gcHJvbWlzZUNoYWluLnRoZW4oY2hhaW5SZXN1bHRzID0+IGN1cnJlbnRUYXNrLnRoZW4oY3VycmVudFJlc3VsdCA9PiBbLi4uY2hhaW5SZXN1bHRzLCBjdXJyZW50UmVzdWx0XSkpO1xyXG4gICAgICB9LCBQcm9taXNlLnJlc29sdmUoW10pKS50aGVuKGFycmF5T2ZSZXN1bHRzID0+IHtcclxuICAgICAgICAvLyBEbyBzb21ldGhpbmcgd2l0aCBhbGwgcmVzdWx0c1xyXG4gICAgICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gZmFsc2U7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQcm9taXNlUXVldWU7XHJcblxyXG4iLCIvLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZScpO1xyXG5cclxuaW1wb3J0IHsgZ2VuZXJhdGVHVUlELCBkZWVwQ2xvbmUsIGF2YWlsYWJsZVNwYWNlIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuaW1wb3J0IFByb21pc2VRdWV1ZSBmcm9tICcuLi91dGlscy9Qcm9taXNlUXVldWUnO1xyXG5cclxuY2xhc3MgSHlwZXJ0eVJlc291cmNlc1N0b3JhZ2Uge1xyXG5cclxuICBjb25zdHJ1Y3RvcihydW50aW1lVVJMLCBidXMsIHN0b3JhZ2VNYW5hZ2VyLCBoeXBlcnR5UmVzb3VyY2VzKSB7XHJcblxyXG4gICAgaWYgKCFzdG9yYWdlTWFuYWdlcikgdGhyb3cgbmV3IEVycm9yKCdbSHlwZXJ0eVJlc291cmNlc1N0b3JhZ2UgY29uc3RydWN0b3JdIG1hbmRhdG9yeSBzdG9yYWdlTWFuYWdlciBwYXJhbWV0ZXIgbWlzc2luZycpO1xyXG4gICAgaWYgKCFydW50aW1lVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1tIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZSBjb25zdHJ1Y3Rvcl0gbWFuZGF0b3J5IHJ1bnRpbWVVUkwgcGFyYW1ldGVyIG1pc3NpbmcnKTtcclxuICAgIGlmICghYnVzKSB0aHJvdyBuZXcgRXJyb3IoJ1tIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZSBjb25zdHJ1Y3Rvcl0gbWFuZGF0b3J5IGJ1cyBwYXJhbWV0ZXIgbWlzc2luZycpO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX2J1cyA9IGJ1cztcclxuXHJcbiAgICBfdGhpcy5fc3RvcmFnZUxpbWl0ID0gMC45OyAvLyB0aGUgc2F2ZSBzdG9yYWdlTGltaXQ7XHJcblxyXG4gICAgX3RoaXMuX3VybCA9IHJ1bnRpbWVVUkwgKyAnL3N0b3JhZ2UnO1xyXG5cclxuICAgIF90aGlzLl9zdG9yYWdlTWFuYWdlciA9IHN0b3JhZ2VNYW5hZ2VyO1xyXG5cclxuICAgIF90aGlzLnByb21pc2VRdWV1ZSA9IG5ldyBQcm9taXNlUXVldWUoKTtcclxuXHJcbiAgICBfdGhpcy5faHlwZXJ0eVJlc291cmNlcyA9IGh5cGVydHlSZXNvdXJjZXM7XHJcblxyXG4gICAgYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIChtc2cpID0+IHtcclxuICAgICAgbG9nLmluZm8oJ1tIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZV0gTWVzc2FnZSBSQ1Y6ICcsIG1zZyk7XHJcbiAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHtcclxuICAgICAgICBjYXNlICdjcmVhdGUnOiBfdGhpcy5fb25DcmVhdGUobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncmVhZCc6IF90aGlzLl9vblJlYWQobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnZGVsZXRlJzogX3RoaXMuX29uRGVsZXRlKG1zZyk7IGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBjaGVjayB0aGUgYXZhaWxhYmxlIHN0b3JhZ2UgcXVvdGFcclxuICAgKlxyXG4gICAqIEBtZW1iZXJvZiBIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZVxyXG4gICAqL1xyXG4gIGNoZWNrU3RvcmFnZVF1b3RhKCkge1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBpZiAodGhpcy5fYXZhaWxhYmxlUXVvdGEgJiYgdGhpcy5fdXNhZ2UpIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShhdmFpbGFibGVTcGFjZSh0aGlzLl91c2FnZSwgdGhpcy5fYXZhaWxhYmxlUXVvdGEpKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKG5hdmlnYXRvcikge1xyXG5cclxuICAgICAgICBuYXZpZ2F0b3Iuc3RvcmFnZS5lc3RpbWF0ZSgpLnRoZW4oKGVzdGltYXRlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl9hdmFpbGFibGVRdW90YSA9IGVzdGltYXRlLnF1b3RhO1xyXG4gICAgICAgICAgdGhpcy5fdXNhZ2UgPSBlc3RpbWF0ZS51c2FnZTtcclxuICAgICAgICAgIHJlc29sdmUoYXZhaWxhYmxlU3BhY2UodGhpcy5fdXNhZ2UsIHRoaXMuX2F2YWlsYWJsZVF1b3RhKSk7XHJcblxyXG4gICAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICAgIGxvZy5lcnJvcignW0h5cGVydHlSZXNvdXJjZXNTdG9yYWdlXSBDaGVja1N0b3JhZ2VRdW90YSBlcnJvcjogJywgcmVhc29uKTtcclxuICAgICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiBzaG91bGQgc2F2ZSBhbiBIeXBlcnR5UmVzb3VyY2UgY29udGFpbmVkIGluIHRoZSBib2R5IG9mIGEgY3JlYXRlIG1lc3NhZ2UgcmVxdWVzdDtcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIC0gbWVzc2FnZSBjb250YWluaW5nIHRoZSBoeXBlcnR5IHJlc291cmNlIHRvIGJlIHN0b3JlZFxyXG4gICAqL1xyXG5cclxuICBfb25DcmVhdGUobWVzc2FnZSkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgaWYgKCFtZXNzYWdlLmJvZHkgfHwgIW1lc3NhZ2UuYm9keS52YWx1ZSkgdGhyb3cgbmV3IEVycm9yKCdbSHlwZXJ0eVJlc291cmNlc1N0b3JhZ2UuX29uQ3JlYXRlXSBtYW5kYXRvcnkgbWVzc2FnZSBib2R5IHZhbHVlIG1pc3Npbmc6ICcsIG1lc3NhZ2UpO1xyXG5cclxuICAgIGxldCBjb250ZW50ID0gbWVzc2FnZS5ib2R5LnZhbHVlO1xyXG4gICAgbGV0IGNvbnRlbnRVUkwgPSBjb250ZW50LmNvbnRlbnRVUkw7XHJcbiAgICBsZXQgcmVzb3VyY2VVUkwgPSAnJztcclxuXHJcbiAgICBpZiAoIWNvbnRlbnRVUkwpIHtcclxuXHJcbiAgICAgIGNvbnRlbnRVUkwgPSBbXTtcclxuICAgICAgcmVzb3VyY2VVUkwgPSBfdGhpcy5fdXJsICsgJy8nICsgZ2VuZXJhdGVHVUlEKCk7XHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgY3VycmVudFVSTCA9IGNvbnRlbnRVUkxbMF07XHJcbiAgICAgIGNvbnN0IHJlc291cmNlID0gY3VycmVudFVSTC5zdWJzdHIoY3VycmVudFVSTC5sYXN0SW5kZXhPZignLycpICsgMSk7XHJcbiAgICAgIHJlc291cmNlVVJMID0gX3RoaXMuX3VybCArICcvJyArIHJlc291cmNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghX3RoaXMuX2h5cGVydHlSZXNvdXJjZXMuaGFzT3duUHJvcGVydHkocmVzb3VyY2VVUkwpKSB7XHJcblxyXG4gICAgICBjb250ZW50VVJMLnB1c2gocmVzb3VyY2VVUkwpO1xyXG4gICAgICBjb250ZW50LmNvbnRlbnRVUkwgPSBjb250ZW50VVJMO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9oeXBlcnR5UmVzb3VyY2VzW3Jlc291cmNlVVJMXSA9IGNvbnRlbnQ7XHJcblxyXG4gICAgdGhpcy5wcm9taXNlUXVldWUuYWRkKHRoaXMuX3RvU2F2ZShyZXNvdXJjZVVSTCwgbWVzc2FnZSwgY29udGVudCkpO1xyXG5cclxuICB9XHJcblxyXG4gIF90b1NhdmUocmVzb3VyY2VVUkwsIG1lc3NhZ2UsIGNvbnRlbnQpIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgY29uc3QgZXJyb3IgPSAocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbGV0IHJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgZnJvbTogbWVzc2FnZS50byxcclxuICAgICAgICAgIHRvOiBtZXNzYWdlLmZyb20sXHJcbiAgICAgICAgICBpZDogbWVzc2FnZS5pZCxcclxuICAgICAgICAgIHR5cGU6ICdyZXNwb25zZScsXHJcbiAgICAgICAgICBib2R5OiB7IHZhbHVlOiByZXNvdXJjZVVSTCwgY29kZTogNTAwLCBkZXNjcmlwdGlvbjogcmVhc29uIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UocmVzcG9uc2UpO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICB0aGlzLmNoZWNrU3RvcmFnZVF1b3RhKCkudGhlbigocmVzdWx0KSA9PiB7XHJcblxyXG4gICAgICAgIGlmIChjb250ZW50LnNpemUgPiByZXN1bHQucXVvdGEpIHtcclxuICAgICAgICAgIGNvbnN0IG1zZyA9ICdUaGUgc3RvcmFnZSBkbyBub3QgaGF2ZSBzcGFjZSB0byBzdG9yZSB0aGF0IHJlc291cmNlJztcclxuICAgICAgICAgIGVycm9yKG1zZyk7XHJcbiAgICAgICAgICB0aHJvdyBFcnJvcihtc2cpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgc3BhY2VBdmFpbGFibGUgPSByZXN1bHQucXVvdGE7XHJcbiAgICAgICAgY29uc3QgYWxsb2NhdGVkID0gcmVzdWx0LnVzYWdlICsgY29udGVudC5zaXplO1xyXG5cclxuICAgICAgICBpZiAocmVzdWx0LnBlcmNlbnQgPj0gdGhpcy5fc3RvcmFnZUxpbWl0IHx8IGFsbG9jYXRlZCA+IHNwYWNlQXZhaWxhYmxlKSB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0T2xkZXJSZXNvdXJjZXMoY29udGVudC5zaXplKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0b3JhZ2VNYW5hZ2VyLnNldChyZXNvdXJjZVVSTCwgMSwgY29udGVudCk7XHJcbiAgICAgIH0pLnRoZW4oKCkgPT4ge1xyXG5cclxuICAgICAgICBsZXQgcmVzcG9uc2UgPSB7XHJcbiAgICAgICAgICBmcm9tOiBtZXNzYWdlLnRvLFxyXG4gICAgICAgICAgdG86IG1lc3NhZ2UuZnJvbSxcclxuICAgICAgICAgIGlkOiBtZXNzYWdlLmlkLFxyXG4gICAgICAgICAgdHlwZTogJ3Jlc3BvbnNlJyxcclxuICAgICAgICAgIGJvZHk6IHsgdmFsdWU6IHJlc291cmNlVVJMLCBjb2RlOiAyMDAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXNwb25zZSk7XHJcblxyXG4gICAgICAgIGxvZy5sb2coJ1N1Y2Nlc3MnKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcclxuXHJcbiAgICAgIH0pLmNhdGNoKGVycm9yKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBfZ2V0T2xkZXJSZXNvdXJjZXMoc2l6ZSkge1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICB0aGlzLl9zdG9yYWdlTWFuYWdlci5nZXQoKS50aGVuKChyZXN1bHQpID0+IHtcclxuXHJcbiAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gT2JqZWN0LmtleXMocmVzdWx0KTtcclxuXHJcbiAgICAgICAgbGV0IHRvdGFsID0gMDtcclxuICAgICAgICBjb25zdCByZWR1Y2VkID0gcmVzb3VyY2VzLnNvcnQoKGEsIGIpID0+IHJlc3VsdFthXS5jcmVhdGVkIDwgcmVzdWx0W2JdLmNyZWF0ZWQpXHJcbiAgICAgICAgICAucmVkdWNlKChwcmV2aW91c1Jlc291cmNlLCBjdXJyZW50UmVzb3VyY2UpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMuX2h5cGVydHlSZXNvdXJjZXNbY3VycmVudFJlc291cmNlXTtcclxuXHJcbiAgICAgICAgICAgIGxvZy5sb2coJ1tIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZV0gX2dldE9sZGVyUmVzb3VyY2VzOiAnLCB0b3RhbCwgc2l6ZSwgY3VycmVudFJlc291cmNlLCB0aGlzLl9hdmFpbGFibGVRdW90YSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodG90YWwgPD0gc2l6ZSkge1xyXG4gICAgICAgICAgICAgIHRvdGFsICs9IGN1cnJlbnQuc2l6ZTtcclxuICAgICAgICAgICAgICBwcmV2aW91c1Jlc291cmNlLnB1c2goY3VycmVudFJlc291cmNlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHByZXZpb3VzUmVzb3VyY2U7XHJcblxyXG4gICAgICAgICAgfSwgW10pO1xyXG5cclxuICAgICAgICBjb25zdCBkZWxldGluZyA9IHJlZHVjZWQubWFwKGtleSA9PiB0aGlzLl9zdG9yYWdlTWFuYWdlci5kZWxldGUoa2V5KSk7XHJcblxyXG4gICAgICAgIFByb21pc2UuYWxsKGRlbGV0aW5nKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAZGVzY3JpcHRpb24gc2hvdWxkIHJldHVybiBhbiBIeXBlcnR5UmVzb3VyY2Ugc3RvcmVkIGluIHRoZSBTdG9yYWdlIE1hbmFnZXIgaWRlbnRpZmllZCBieSB0aGUgY29udGVudCB1cmwgY29udGFpbmVkIGluIHRoZSBib2R5IG9mIGEgcmVhZCBtZXNzYWdlIHJlcXVlc3Q7XHJcbiAgICpcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIG1lc3NhZ2UgY29udGFpbmluZyB0aGUgaHlwZXJ0eSByZXNvdXJjZSB0byBiZSBzdG9yZWRcclxuICAgKi9cclxuXHJcbiAgX29uUmVhZChtZXNzYWdlKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoIW1lc3NhZ2UuYm9keSB8fCAhbWVzc2FnZS5ib2R5LnJlc291cmNlKSB0aHJvdyBuZXcgRXJyb3IoJ1tIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZS5fb25SZWFkXSBtYW5kYXRvcnkgbWVzc2FnZSBib2R5IHJlc291cmNlIG1pc3Npbmc6ICcsIG1lc3NhZ2UpO1xyXG5cclxuICAgIGxldCBjb250ZW50VXJsID0gbWVzc2FnZS5ib2R5LnJlc291cmNlO1xyXG5cclxuICAgIGxldCByZXNwb25zZSA9IHtcclxuICAgICAgZnJvbTogbWVzc2FnZS50byxcclxuICAgICAgdG86IG1lc3NhZ2UuZnJvbSxcclxuICAgICAgaWQ6IG1lc3NhZ2UuaWQsXHJcbiAgICAgIHR5cGU6ICdyZXNwb25zZScsXHJcbiAgICAgIGJvZHk6IHt9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGxldCBjb250ZW50ID0gX3RoaXMuX2h5cGVydHlSZXNvdXJjZXNbY29udGVudFVybF07XHJcblxyXG4gICAgbG9nLmluZm8oJ1tIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZS5fb25SZWFkXSBnZXQgcmVzb3VyY2VVUkw6JywgY29udGVudFVybCk7XHJcblxyXG4gICAgdGhpcy5fc3RvcmFnZU1hbmFnZXIuZ2V0KCdyZXNvdXJjZVVSTCcsIGNvbnRlbnRVcmwpLnRoZW4oKGNvbnRlbnQpID0+IHtcclxuXHJcbiAgICAgIGxvZy5pbmZvKCdbSHlwZXJ0eVJlc291cmNlc1N0b3JhZ2UuX29uUmVhZF0gZm91bmQgY29udGVudDonLCBjb250ZW50KTtcclxuXHJcbiAgICAgIGlmIChjb250ZW50KSB7XHJcblxyXG4gICAgICAgIGlmIChjb250ZW50LnJlc291cmNlVHlwZSA9PT0gJ2ZpbGUnKSB7XHJcbiAgICAgICAgICBfdGhpcy5fb25SZWFkRmlsZShyZXNwb25zZSwgY29udGVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlc3BvbnNlLmJvZHkuY29kZSA9IDIwMDtcclxuICAgICAgICAgIHJlc3BvbnNlLmJvZHkucDJwID0gdHJ1ZTtcclxuICAgICAgICAgIHJlc3BvbnNlLmJvZHkudmFsdWUgPSBjb250ZW50O1xyXG4gICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNwb25zZS5ib2R5LmNvZGUgPSA0MDQ7XHJcbiAgICAgICAgcmVzcG9uc2UuYm9keS5kZXNjID0gJ0NvbnRlbnQgTm90IEZvdW5kIGZvciAnICsgY29udGVudFVybDtcclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlc3BvbnNlKTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICAvL3Jlc3BvbnNlLmJvZHkuY29kZSA9IDQwNDtcclxuXHJcbiAgICAvL190aGlzLl9oeXBlcnR5UmVzb3VyY2VzW2NvbnRlbnRVcmxdID0gbWVzc2FnZS5ib2R5LnZhbHVlO1xyXG5cclxuXHJcbiAgfVxyXG5cclxuICBfb25SZWFkRmlsZShyZXNwb25zZSwgcmVzb3VyY2UpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKHRoZUZpbGUpIHtcclxuXHJcbiAgICAgIGxvZy5pbmZvKCdbRmlsZUh5cGVydHlSZXNvdXJjZS5pbml0XSBmaWxlIGxvYWRlZCAnLCB0aGVGaWxlKTtcclxuXHJcbiAgICAgIHJlc3BvbnNlLmJvZHkuY29kZSA9IDIwMDtcclxuICAgICAgcmVzcG9uc2UuYm9keS5wMnAgPSB0cnVlO1xyXG4gICAgICByZXNwb25zZS5ib2R5LnZhbHVlID0gZGVlcENsb25lKHJlc291cmNlKTtcclxuICAgICAgcmVzcG9uc2UuYm9keS52YWx1ZS5jb250ZW50ID0gdGhlRmlsZS50YXJnZXQucmVzdWx0O1xyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlc3BvbnNlKTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKHJlc291cmNlLm1pbWV0eXBlLmluY2x1ZGVzKCd0ZXh0LycpKSB7XHJcbiAgICAgIHJlYWRlci5yZWFkQXNUZXh0KHJlc291cmNlLmNvbnRlbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgY3VycmVudCA9IHJlc291cmNlLmNvbnRlbnQ7XHJcblxyXG4gICAgICBsZXQgYmxvYjtcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY3VycmVudCkpIHtcclxuICAgICAgICBibG9iID0gbmV3IEJsb2IoY3VycmVudCwgeyB0eXBlOiByZXNvdXJjZS5taW1ldHlwZX0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJsb2IgPSBuZXcgQmxvYihbY3VycmVudF0sIHsgdHlwZTogcmVzb3VyY2UubWltZXR5cGV9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGJsb2IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGRlc2NyaXB0aW9uIHNob3VsZCBkZWxldGUgYW4gSHlwZXJ0eVJlc291cmNlIGZyb20gdGhlIHN0b3JhZ2U7XHJcbiAgICpcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIG1lc3NhZ2UgY29udGFpbmluZyB0aGUgY29udGVudCBVUkwgb2YgdGhlIGh5cGVydHkgcmVzb3VyY2UgdG8gYmUgZGVsZXRlZFxyXG4gICAqL1xyXG5cclxuICBfb25EZWxldGUobWVzc2FnZSkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgaWYgKCFtZXNzYWdlLmJvZHkpIHRocm93IG5ldyBFcnJvcignW0h5cGVydHlSZXNvdXJjZXNTdG9yYWdlLl9vbkRlbGV0ZV0gbWFuZGF0b3J5IG1lc3NhZ2UgYm9keSBtaXNzaW5nOiAnLCBtZXNzYWdlKTtcclxuXHJcbiAgICBpZiAobWVzc2FnZS5ib2R5LnJlc291cmNlKSB7XHJcbiAgICAgIGRlbGV0ZSBfdGhpcy5faHlwZXJ0eVJlc291cmNlc1ttZXNzYWdlLmJvZHkucmVzb3VyY2VdO1xyXG4gICAgfSBlbHNlIGlmIChtZXNzYWdlLmJvZHkucmVzb3VyY2VzKSB7XHJcbiAgICAgIG1lc3NhZ2UuYm9keS5yZXNvdXJjZXMuZm9yRWFjaCgocmVzb3VyY2UpID0+IHtcclxuICAgICAgICBkZWxldGUgX3RoaXMuX2h5cGVydHlSZXNvdXJjZXNbcmVzb3VyY2VdO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignW0h5cGVydHlSZXNvdXJjZXNTdG9yYWdlLl9vbkRlbGV0ZV0gbWFuZGF0b3J5IHJlc291cmNlIG1pc3Npbmc6ICcsIG1lc3NhZ2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF90aGlzLl9zdG9yYWdlTWFuYWdlci5kZWxldGUoJ3Jlc291cmNlVVJMJywgbWVzc2FnZS5ib2R5LnJlc291cmNlKS50aGVuKCgpID0+IHtcclxuICAgICAgbGV0IHJlc3BvbnNlID0ge1xyXG4gICAgICAgIGZyb206IG1lc3NhZ2UudG8sXHJcbiAgICAgICAgdG86IG1lc3NhZ2UuZnJvbSxcclxuICAgICAgICBpZDogbWVzc2FnZS5pZCxcclxuICAgICAgICB0eXBlOiAncmVzcG9uc2UnLFxyXG4gICAgICAgIGJvZHk6IHsgY29kZTogMjAwIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVzcG9uc2UpO1xyXG4gICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICBsZXQgcmVzcG9uc2UgPSB7XHJcbiAgICAgICAgZnJvbTogbWVzc2FnZS50byxcclxuICAgICAgICB0bzogbWVzc2FnZS5mcm9tLFxyXG4gICAgICAgIGlkOiBtZXNzYWdlLmlkLFxyXG4gICAgICAgIHR5cGU6ICdyZXNwb25zZScsXHJcbiAgICAgICAgYm9keTogeyBjb2RlOiA0MDAsIGRlc2NyaXB0aW9uOiByZWFzb24gfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXNwb25zZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgSHlwZXJ0eVJlc291cmNlc1N0b3JhZ2U7XHJcbiIsIi8vIExvZyBTeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ1N5blN1YnNjcmlwdGlvbicpO1xyXG5cclxuY2xhc3MgU3Vic2NyaXB0aW9uIHtcclxuXHJcbiAgY29uc3RydWN0b3IoYnVzLCBvd25lciwgdXJsLCBpc1JlcG9ydGVyKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJztcclxuICAgIGxldCBjaGFuZ2VVUkwgPSB1cmwgKyAnL2NoYW5nZXMnO1xyXG5cclxuICAgIC8vcHJvY2VzcyBkZWxldGUgbWVzc2FnZVxyXG4gICAgX3RoaXMuX2RlbGV0ZUxpc3RlbmVyID0gYnVzLmFkZExpc3RlbmVyKGNoYW5nZVVSTCwgKG1zZykgPT4ge1xyXG4gICAgICBpZiAobXNnLnR5cGUgPT09ICdkZWxldGUnKSB7XHJcbiAgICAgICAgbG9nLmxvZygnU3Vic2NyaXB0aW9uLURFTEVURTogJywgbXNnKTtcclxuXHJcbiAgICAgICAgLy9GTE9XLU9VVDogbWVzc2FnZSBzZW50IHRvIGFsbCBzdWJzY3JpYmVyc1xyXG4gICAgICAgIGxldCBkZWxldGVNZXNzYWdlVG9IeXBlcnR5ID0ge1xyXG4gICAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IG1zZy5mcm9tLCB0bzogb3duZXIsXHJcbiAgICAgICAgICBib2R5OiB7IGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwgcmVzb3VyY2U6IHVybCB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy9zZW5kIGRlbGV0ZSB0byBoeXBlcnR5XHJcbiAgICAgICAgYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1lc3NhZ2VUb0h5cGVydHksIChyZXBseSkgPT4ge1xyXG4gICAgICAgICAgbG9nLmxvZygnU3Vic2NyaXB0aW9uLURFTEVURS1SRVBMWTogJywgcmVwbHkpO1xyXG4gICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vYWRkIGNoYW5nZSBwdWJsaXNoIGFkZHJlc3Mgb3IgZm9yd2FyZFxyXG4gICAgaWYgKGlzUmVwb3J0ZXIpIHtcclxuICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gYnVzLmFkZFB1Ymxpc2goY2hhbmdlVVJMKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lciA9IGJ1cy5hZGRGb3J3YXJkKGNoYW5nZVVSTCwgb3duZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdO1xyXG4vLyAgICBsb2cubG9nKCdbU3Vic2NyaXB0aW9uXSAtIGNoaWxkSUQnLCBjaGlsZHJlbnMpO1xyXG4vLyAgICBjaGlsZHJlbnMuZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuLy8gICAgbGV0IGNoaWxkSWQgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDtcclxuXHJcbi8vICAgICAgbG9nLmxvZygnW1N1YnNjcmlwdGlvbl0gLSBjaGlsZElEJywgY2hpbGRCYXNlVVJMKTtcclxuXHJcbiAgICAgIC8vYWRkIGNoaWxkcmVuIHB1Ymxpc2ggYWRkcmVzc1xyXG4gICAgICBsZXQgY2hpbGRyZW5Gb3J3YXJkID0gYnVzLmFkZFB1Ymxpc2goY2hpbGRCYXNlVVJMKTtcclxuICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2goY2hpbGRyZW5Gb3J3YXJkKTtcclxuXHJcbiAgICAgIC8vYWRkIHNlbGYgZm9yd2FyZCBpZiBhbiBvYnNlcnZlclxyXG4gICAgICBpZiAoIWlzUmVwb3J0ZXIpIHtcclxuICAgICAgICBsZXQgc2VsZkZvcndhcmQgPSBidXMuYWRkRm9yd2FyZChjaGlsZEJhc2VVUkwsIG93bmVyKTtcclxuICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChzZWxmRm9yd2FyZCk7XHJcbiAgICAgIH1cclxuLy8gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfcmVsZWFzZUxpc3RlbmVycygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX2RlbGV0ZUxpc3RlbmVyLnJlbW92ZSgpO1xyXG5cclxuICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lci5yZW1vdmUoKTtcclxuXHJcbiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaCgoZm9yd2FyZCkgPT4ge1xyXG4gICAgICBmb3J3YXJkLnJlbW92ZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgU3Vic2NyaXB0aW9uO1xyXG4iLCIvLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdSZXBvcnRlck9iamVjdCcpO1xyXG5cclxuaW1wb3J0IHsgZGl2aWRlVVJMLCBzcGxpdE9iamVjdFVSTCB9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IFN1YnNjcmlwdGlvbiBmcm9tICcuL1N1YnNjcmlwdGlvbic7XHJcbmltcG9ydCAqIGFzIGNyeXB0b01hbmFnZXIgZnJvbSAnLi4vY3J5cHRvTWFuYWdlci9DcnlwdG9NYW5hZ2VyJztcclxuXHJcbmNsYXNzIFJlcG9ydGVyT2JqZWN0IHtcclxuXHJcbiAgY29uc3RydWN0b3IocGFyZW50LCBvd25lciwgdXJsLCBjaGlsZHJlbnMsIG9mZmxpbmUpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX3BhcmVudCA9IHBhcmVudDtcclxuICAgIF90aGlzLl9vd25lciA9IG93bmVyO1xyXG4gICAgX3RoaXMuX3VybCA9IHVybDtcclxuXHJcbiAgICBfdGhpcy5fYnVzID0gcGFyZW50Ll9idXM7XHJcblxyXG4gICAgX3RoaXMuX2RvbWFpbiA9IGRpdmlkZVVSTCh1cmwpLmRvbWFpbjtcclxuICAgIF90aGlzLl9vYmpTdWJzY3JpcHRvclVSTCA9IF90aGlzLl91cmwgKyAnL3N1YnNjcmlwdGlvbic7XHJcblxyXG4gICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTtcclxuICAgIF90aGlzLl9jaGlsZHJlbnMgPSBjaGlsZHJlbnM7XHJcbiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTtcclxuXHJcbiAgICBfdGhpcy5fZm9yd2FyZHMgPSB7fTtcclxuXHJcbiAgICBfdGhpcy5faXNUb1NhdmVEYXRhID0gZmFsc2U7XHJcblxyXG4gICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7XHJcblxyXG4gICAgX3RoaXMuX29mZmxpbmUgPSBvZmZsaW5lID8gb2ZmbGluZSA6IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0IG9mZmxpbmUoKXtcclxuICAgIHJldHVybiB0aGlzLl9vZmZsaW5lO1xyXG4gIH1cclxuXHJcbiAgX2FsbG9jYXRlTGlzdGVuZXJzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAvL2FkZCBzdWJzY3JpcHRpb24gbGlzdGVuZXIuLi5cclxuICAgIF90aGlzLl9zdWJzY3JpcHRpb25MaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX29ialN1YnNjcmlwdG9yVVJMLCAobXNnKSA9PiB7XHJcbiAgICAgIGxvZy5pbmZvKCdbU3luY2hlck1hbmFnZXIuUmVwb3J0ZXJPYmplY3QgcmVjZWl2ZWQgXScsIG1zZyk7XHJcbiAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHtcclxuICAgICAgICBjYXNlICdzdWJzY3JpYmUnOiBfdGhpcy5fb25SZW1vdGVTdWJzY3JpYmUobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAndW5zdWJzY3JpYmUnOiBfdGhpcy5fb25SZW1vdGVVblN1YnNjcmliZShtc2cpOyBicmVhaztcclxuICAgICAgICBjYXNlICdyZXNwb25zZSc6IF90aGlzLl9vblJlbW90ZVJlc3BvbnNlKG1zZyk7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2ZvcndhcmQnOiBfdGhpcy5fb25Gb3J3YXJkZWRSZW1vdGVTdWJzY3JpYmUobXNnKTsgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjaGFuZ2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJztcclxuICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hhbmdlVVJMLCAobXNnKSA9PiB7XHJcblxyXG4gICAgICBsb2cuaW5mbygnW1N5bmNoZXJNYW5hZ2VyLlJlcG9ydGVyT2JqZWN0IF0gU3luY2hlck1hbmFnZXItJyArIGNoYW5nZVVSTCArICctUkNWOiAnLCBtc2cpO1xyXG5cclxuICAgICAgLy9kbyBub3Qgc2F2ZSBjaGFuZ2VzIHRvIGJhY2t1cFJldmlzaW9uIHRvIGF2b2lkIGluZmluaXRlIGxvb3BzXHJcbiAgICAgIGlmICh0aGlzLl9pc1RvU2F2ZURhdGEgJiYgbXNnLmJvZHkuYXR0cmlidXRlICkge1xyXG4gICAgICAgIGxldCB1cGRhdGVSdW50aW1lU3RhdHVzID0gbXNnLmJvZHkuYXR0cmlidXRlICE9PSAnYmFja3VwUmV2aXNpb24nID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5SZXBvcnRlck9iamVjdCBdIFN5bmNoZXJNYW5hZ2VyIC0gc2F2ZSBkYXRhOiAnLCBtc2cpO1xyXG4gICAgICAgIF90aGlzLl9wYXJlbnQuX2RhdGFPYmplY3RzU3RvcmFnZS51cGRhdGUodHJ1ZSwgX3RoaXMuX3VybCwgJ3ZlcnNpb24nLCBtc2cuYm9keS52ZXJzaW9uLCB1cGRhdGVSdW50aW1lU3RhdHVzKTtcclxuICAgICAgICBfdGhpcy5fcGFyZW50Ll9kYXRhT2JqZWN0c1N0b3JhZ2UudXBkYXRlKHRydWUsIF90aGlzLl91cmwsICdsYXN0TW9kaWZpZWQnLCBtc2cuYm9keS5sYXN0TW9kaWZpZWQsIHVwZGF0ZVJ1bnRpbWVTdGF0dXMpO1xyXG4gICAgICAgIF90aGlzLl9wYXJlbnQuX2RhdGFPYmplY3RzU3RvcmFnZS5zYXZlRGF0YSh0cnVlLCBfdGhpcy5fdXJsLCBtc2cuYm9keS5hdHRyaWJ1dGUsIG1zZy5ib2R5LnZhbHVlLCB1cGRhdGVSdW50aW1lU3RhdHVzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXQgaXNUb1NhdmVEYXRhKHZhbHVlKSB7XHJcbiAgICB0aGlzLl9pc1RvU2F2ZURhdGEgPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIC8vIFRvIGhhbmRsZSBzdWJzY3JpcHRpb25zIHNlbnQgd2hpbGUgdGhlIHJlcG9ydGVyIHdhcyBvZmZsaW5lIGllIGZvcndhcmRlZCBieSBhIE9mZmxpbmUgU3Vic2NyaXB0aW9uIE1hbmFnZXIgc2VydmljZVxyXG5cclxuICBfb25Gb3J3YXJkZWRSZW1vdGVTdWJzY3JpYmUobXNnKSB7XHJcbiAgICB0aGlzLl9vblJlbW90ZVN1YnNjcmliZShtc2cuYm9keSk7XHJcbiAgfVxyXG5cclxuICBfcmVsZWFzZUxpc3RlbmVycygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX3N1YnNjcmlwdGlvbkxpc3RlbmVyLnJlbW92ZSgpO1xyXG5cclxuICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lci5yZW1vdmUoKTtcclxuXHJcbiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaCgoY2wpID0+IHtcclxuICAgICAgY2wucmVtb3ZlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBPYmplY3Qua2V5cyhfdGhpcy5fZm9yd2FyZHMpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICBfdGhpcy5mb3J3YXJkVW5TdWJzY3JpYmUoa2V5KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vcmVtb3ZlIGFsbCBzdWJzY3JpcHRpb25zXHJcbiAgICBPYmplY3Qua2V5cyhfdGhpcy5fc3Vic2NyaXB0aW9ucykuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zW2tleV0uX3JlbGVhc2VMaXN0ZW5lcnMoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVzdW1lU3Vic2NyaXB0aW9ucyhzdWJzY3JpcHRpb25zKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGlmICghc3Vic2NyaXB0aW9ucylcclxuICAgICAgcmV0dXJuO1xyXG5cclxuICAgIE9iamVjdC5rZXlzKHN1YnNjcmlwdGlvbnMpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICBsZXQgaHlwZXJ0eVVSTCA9IHN1YnNjcmlwdGlvbnNba2V5XTtcclxuXHJcbiAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5SZXBvcnRlck9iamVjdF0gLSByZXN1bWUgc3Vic2NyaXB0aW9ucycsIF90aGlzLCBoeXBlcnR5VVJMLCBfdGhpcy5fY2hpbGRyZW5zKTtcclxuXHJcbiAgICAgIGlmICghX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVSTF0pIHtcclxuICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VVJMXSA9IG5ldyBTdWJzY3JpcHRpb24oX3RoaXMuX2J1cywgX3RoaXMuX293bmVyLCBfdGhpcy5fdXJsLCB0cnVlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgYSBsaXN0ZW5lciBpbiB0aGUgbXNnLW5vZGUgYW5kIGluIHRoZSBsb2NhbCBNZXNzYWdlQnVzLCBzbyB0aGF0IG1lc3NhZ2VzIG9uIHRoaXMgYWRkcmVzcyBhcmUgZm9yd2FyZGVkIHRvIHRoZSByZXBvcnRlciBvYmplY3RcclxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IGFkZHJlc3MgLSBVUkwgdG8gcmVnaXN0ZXIgdGhlIGxpc3RlbmVyc1xyXG4gICAqIEByZXR1cm4ge1Byb21pc2V9IFJldHVybiBQcm9taXNlIE9LIG9yIGVycm9yXHJcbiAgICovXHJcbiAgZm9yd2FyZFN1YnNjcmliZShhZGRyZXNzZXMpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgLy9GTE9XLU9VVDogbWVzc2FnZSBzZW50IHRvIHRoZSBtc2ctbm9kZSBTdWJzY3JpcHRpb25NYW5hZ2VyIGNvbXBvbmVudFxyXG4gICAgbGV0IG5vZGVTdWJzY3JpYmVNc2cgPSB7XHJcbiAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fcGFyZW50Ll91cmwsIHRvOiAnZG9tYWluOi8vbXNnLW5vZGUuJyArIF90aGlzLl9kb21haW4gKyAnL3NtJyxcclxuICAgICAgYm9keTogeyByZXNvdXJjZXM6IGFkZHJlc3Nlcywgc291cmNlOiBfdGhpcy5fb3duZXIgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG5vZGVTdWJzY3JpYmVNc2csIChyZXBseSkgPT4ge1xyXG4gICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5SZXBvcnRlck9iamVjdCBdZm9yd2FyZC1zdWJzY3JpYmUtcmVzcG9uc2UocmVwb3J0ZXIpOiAnLCByZXBseSk7XHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICBsZXQgbmV3Rm9yd2FyZCA9IF90aGlzLl9idXMuYWRkRm9yd2FyZChfdGhpcy5fdXJsLCBfdGhpcy5fb3duZXIpO1xyXG4gICAgICAgICAgX3RoaXMuX2ZvcndhcmRzW2FkZHJlc3Nlc1swXV0gPSBuZXdGb3J3YXJkO1xyXG4gICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZWplY3QoJ0Vycm9yIG9uIG1zZy1ub2RlIHN1YnNjcmlwdGlvbjogJyArIHJlcGx5LmJvZHkuZGVzYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVW5SZWdpc3RlciBhIGxpc3RlbmVyIGluIHRoZSBtc2ctbm9kZSBhbmQgaW4gdGhlIGxvY2FsIE1lc3NhZ2VCdXMsIHNvIHRoYXQgbWVzc2FnZXMgb24gdGhpcyBhZGRyZXNzIGFyZSByZW1vdmVkIGZyb20gZm9yd2FyZFxyXG4gICAqIEBwYXJhbSAge3N0cmluZ30gYWRkcmVzcyAtIFVSTCB0byB1bi1yZWdpc3RlciB0aGUgbGlzdGVuZXJzXHJcbiAgICovXHJcbiAgZm9yd2FyZFVuU3Vic2NyaWJlKGFkZHJlc3MpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX2ZvcndhcmRzW2FkZHJlc3NdLnJlbW92ZSgpO1xyXG4gICAgZGVsZXRlIF90aGlzLl9mb3J3YXJkc1thZGRyZXNzXTtcclxuXHJcbiAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHNlbnQgdG8gdGhlIG1zZy1ub2RlIFN1YnNjcmlwdGlvbk1hbmFnZXIgY29tcG9uZW50XHJcbiAgICBsZXQgbm9kZVVuU3Vic2NyaWJlTXNnID0ge1xyXG4gICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fcGFyZW50Ll91cmwsIHRvOiAnZG9tYWluOi8vbXNnLW5vZGUuJyArIF90aGlzLl9kb21haW4gKyAnL3NtJyxcclxuICAgICAgYm9keTogeyByZXNvdXJjZXM6IFthZGRyZXNzXSwgc291cmNlOiBfdGhpcy5fb3duZXIgfVxyXG4gICAgfTtcclxuXHJcbiAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG5vZGVVblN1YnNjcmliZU1zZyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWdpc3RlciBsaXN0ZW5lcnMgZm9yIGEgbGlzdCBvZiBjaGlsZHJlbnMuIFB1YmxpYyBjaGFubmVscyB1c2VkIHRvIHRyYW5zbWl0IG1lc3NhZ2VzLlxyXG4gICAqIEBwYXJhbSAge3N0cmluZ1tdfSBjaGlsZHJlbnMgLSBjaGFubmVscyB0byByZWdpc3RlclxyXG4gICAqIEByZXR1cm4ge1Byb21pc2V9IFJldHVybiBQcm9taXNlIE9LIG9yIGVycm9yXHJcbiAgICovXHJcbiAgYWRkQ2hpbGRyZW5zKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBpZiAoX3RoaXMuX2NoaWxkcmVucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IF90aGlzLl91cmwgKyAnL2NoaWxkcmVuLyc7XHJcbiAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5SZXBvcnRlck9iamVjdCAtIGFkZENoaWxkcmVuc10gLSBjaGlsZHJlbnM6ICcsIGNoaWxkQmFzZVVSTCk7XHJcblxyXG4gIC8qICAgIGNoaWxkcmVucy5mb3JFYWNoKChjaGlsZCkgPT4ge1xyXG4gICAgICAgIF90aGlzLl9jaGlsZHJlbnMucHVzaChjaGlsZCk7XHJcbiAgICAgIH0pOyovXHJcblxyXG4gICAgICAvKlxyXG4gICAgICBfdGhpcy5fY2hpbGRyZW5zLmZvckVhY2goKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgbGV0IGNoaWxkSWQgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDtcclxuXHJcbiAgICAgICAgbGV0IHNlbGZGb3J3YXJkID0gX3RoaXMuX2J1cy5hZGRGb3J3YXJkKGNoaWxkSWQsIG93bmVyKTtcclxuICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChzZWxmRm9yd2FyZCk7XHJcbiAgICAgIH0pOyovXHJcblxyXG4gICAgICBsZXQgc3Vic2NyaXB0aW9ucyA9IFtdO1xyXG4vLyAgICAgIGNoaWxkcmVucy5mb3JFYWNoKChjaGlsZCkgPT4gc3Vic2NyaXB0aW9ucy5wdXNoKGNoaWxkQmFzZVVSTCArIGNoaWxkKSk7XHJcbiAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChjaGlsZEJhc2VVUkwgKTtcclxuXHJcbiAgICAgIC8vX3RoaXMuX3N0b3JhZ2VTdWJzY3JpcHRpb25zW190aGlzLl9vYmpTdWJzY3JpcHRvclVSTF0gPSB7dXJsOiBfdGhpcy5fdXJsLCBvd25lcjogX3RoaXMuX293bmVyLCBjaGlsZHJlbnM6IF90aGlzLl9jaGlsZHJlbnN9O1xyXG5cclxuICAgICAgLy9GTE9XLU9VVDogbWVzc2FnZSBzZW50IHRvIHRoZSBtc2ctbm9kZSBTdWJzY3JpcHRpb25NYW5hZ2VyIGNvbXBvbmVudFxyXG4gICAgICBsZXQgbm9kZVN1YnNjcmliZU1zZyA9IHtcclxuICAgICAgICB0eXBlOiAnc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX3BhcmVudC5fdXJsLCB0bzogJ2RvbWFpbjovL21zZy1ub2RlLicgKyBfdGhpcy5fZG9tYWluICsgJy9zbScsXHJcbiAgICAgICAgYm9keTogeyByZXNvdXJjZXM6IHN1YnNjcmlwdGlvbnMsIHNvdXJjZTogX3RoaXMuX293bmVyIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uobm9kZVN1YnNjcmliZU1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLlJlcG9ydGVyT2JqZWN0IF1ub2RlLXN1YnNjcmliZS1yZXNwb25zZShyZXBvcnRlcik6JywgcmVwbHkpO1xyXG4gICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkge1xyXG5cclxuICAgICAgICAgIC8vYWRkIGNoaWxkcmVuIGxpc3RlbmVycyBvbiBsb2NhbCAuLi5cclxuICAgICAgICAgIHN1YnNjcmlwdGlvbnMuZm9yRWFjaCgoY2hpbGRVUkwpID0+IHtcclxuICAgICAgICAgICAgbGV0IGNoaWxkTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCAobXNnKSA9PiB7XHJcbiAgICAgICAgICAgICAgLy9UT0RPOiB3aGF0IHRvZG8gaGVyZT8gU2F2ZSBjaGlsZHJlbnM/XHJcbiAgICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLlJlcG9ydGVyT2JqZWN0IHJlY2VpdmVkXScsIG1zZyk7XHJcblxyXG5cclxuICAgICAgICAgICAgICBpZiAobXNnLnR5cGUgPT09ICdjcmVhdGUnICYmIG1zZy50by5pbmNsdWRlcygnY2hpbGRyZW4nKSAmJiB0aGlzLl9pc1RvU2F2ZURhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgdmFsdWUgaXMgbm90IGVuY3J5cHRlZCBsZXRzIGVuY3J5cHQgaXRcclxuICAgICAgICAgICAgICAgIC8vIHRvZG86IHNob3VsZCBiZSBzdWJqZWN0IHRvIHNvbWUgcG9saWN5XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXRlZFJlcG9ydGVyVVJMID0gc3BsaXRPYmplY3RVUkwobXNnLnRvKTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gc3BsaXRlZFJlcG9ydGVyVVJMLnVybDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIW1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdtdXR1YWwnKSkgbXNnLmJvZHkubXV0dWFsID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBmYWxzZSB3aGVuIG11dHVhbEF1dGhlbnRpY2F0aW9uIGlzIGVuYWJsZWRcclxuICAgICAgICAgICAgICAgIGlmICghKHR5cGVvZiBtc2cuYm9keS52YWx1ZSA9PT0gJ3N0cmluZycpICYmIG1zZy5ib2R5Lm11dHVhbCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLlJlcG9ydGVyT2JqZWN0XSBlbmNyeXB0aW5nIHJlY2VpdmVkIGRhdGEgJywgbXNnLmJvZHkudmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgY3J5cHRvTWFuYWdlci5kZWZhdWx0LmVuY3J5cHREYXRhT2JqZWN0KG1zZy5ib2R5LnZhbHVlLCB1cmwpLnRoZW4oKGVuY3J5cHRlZFZhbHVlKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5SZXBvcnRlck9iamVjdF0gZW5jcnlwdGVkIGRhdGEgJywgIGVuY3J5cHRlZFZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3N0b3JlQ2hpbGRPYmplY3QobXNnLCBKU09OLnN0cmluZ2lmeShlbmNyeXB0ZWRWYWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4oJ1tTeW5jaGVyTWFuYWdlci5fZGVjcnlwdENoaWxkcmVuc10gZmFpbGVkIDogJywgcmVhc29uLCAnIFN0b3JpbmcgdW5lbmNyeXB0ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fc3RvcmVDaGlsZE9iamVjdChtc2csIG1zZy5ib2R5LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBfdGhpcy5fc3RvcmVDaGlsZE9iamVjdChtc2csIG1zZy5ib2R5LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2goY2hpbGRMaXN0ZW5lcik7XHJcblxyXG4gICAgICAgICAgICBsZXQgc2VsZkZvcndhcmQgPSBfdGhpcy5fYnVzLmFkZEZvcndhcmQoY2hpbGRVUkwsIF90aGlzLl9vd25lcik7XHJcbiAgICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKHNlbGZGb3J3YXJkKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVqZWN0KCdFcnJvciBvbiBtc2ctbm9kZSBzdWJzY3JpcHRpb246ICcgKyByZXBseS5ib2R5LmRlc2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIHN0b3JlIGNoaWxkT2JqZWN0XHJcblxyXG4gIF9zdG9yZUNoaWxkT2JqZWN0KG1zZywgZGF0YSkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgc3BsaXRlZFJlcG9ydGVyVVJMID0gc3BsaXRPYmplY3RVUkwobXNnLnRvKTtcclxuXHJcbiAgICBsZXQgdXJsID0gc3BsaXRlZFJlcG9ydGVyVVJMLnVybDtcclxuXHJcbiAgICBsZXQgcmVzb3VyY2UgPSBzcGxpdGVkUmVwb3J0ZXJVUkwucmVzb3VyY2U7XHJcbiAgICBsZXQgdmFsdWU7XHJcbiAgICBcclxuXHJcbi8qICAgIGlmIChtc2cuYm9keS5pZGVudGl0eSkge1xyXG4gICAgICB2YWx1ZS5pZGVudGl0eSA9IG1zZy5ib2R5LmlkZW50aXR5O1xyXG4gICAgICBkZWxldGUgdmFsdWUuaWRlbnRpdHkuYXNzZXJ0aW9uO1xyXG4gICAgICBkZWxldGUgdmFsdWUuaWRlbnRpdHkuZXhwaXJlcztcclxuICAgIH0qL1xyXG5cclxuICAgIGxldCBvYmplY3RVUkxSZXNvdXJjZSA9IG1zZy5ib2R5LnJlc291cmNlO1xyXG4gICAgbGV0IGF0dHJpYnV0ZSA9IHJlc291cmNlO1xyXG5cclxuICAgIGlmIChvYmplY3RVUkxSZXNvdXJjZSA9PT0gJ2hlYXJ0YmVhdCcgKSB2YWx1ZSA9IGRhdGE7XHJcbiAgICBlbHNlIHZhbHVlID0ge1xyXG4gICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksXHJcbiAgICAgIHZhbHVlOiBkYXRhXHJcbiAgICB9O1xyXG5cclxuLy8gICAgaWYgKG9iamVjdFVSTFJlc291cmNlKSBhdHRyaWJ1dGUgKz0gJy4nICsgb2JqZWN0VVJMUmVzb3VyY2U7XHJcbiAgICBpZiAob2JqZWN0VVJMUmVzb3VyY2UpIGF0dHJpYnV0ZSA9IG9iamVjdFVSTFJlc291cmNlO1xyXG5cclxuICAgIC8vIHRoaXMgaWRlbnRpdHkgZGF0YSBpcyBub3QgbmVlZGVkIHRvIGJlIHN0b3JlZFxyXG5cclxuXHJcbiAgICBjb25zb2xlLmxvZygnW1N5bmNoZXJNYW5hZ2VyLlJlcG9ydGVyT2JqZWN0Ll9zdG9yZUNoaWxkT2JqZWN0XSA6ICcsIHVybCwgYXR0cmlidXRlLCB2YWx1ZSk7XHJcblxyXG4gICAgX3RoaXMuX3BhcmVudC5fZGF0YU9iamVjdHNTdG9yYWdlLnNhdmVDaGlsZHJlbnModHJ1ZSwgdXJsLCBhdHRyaWJ1dGUsIHZhbHVlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBsZXQgZG9tYWluID0gZGl2aWRlVVJMKF90aGlzLl9vd25lcikuZG9tYWluO1xyXG5cclxuICAgIC8vRkxPVy1PVVQ6IG1lc3NhZ2Ugc2VudCBkaXJlY3RseSB0byBhbGwgc3Vic2NyaWJlcnMgb2YgdGhlIHJlcG9ydGVyXHJcbiAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vYmpTdWJzY3JpcHRvclVSTCwgdG86IF90aGlzLl91cmwgKyAnL2NoYW5nZXMnXHJcbiAgICB9KTtcclxuXHJcbiAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHNlbnQgdG8gdGhlIG1zZy1ub2RlIE9iamVjdEFsbG9jYXRpb25NYW5hZ2VyIGNvbXBvbmVudFxyXG4gICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgIHR5cGU6ICdkZWxldGUnLCBmcm9tOiBfdGhpcy5fcGFyZW50Ll91cmwsIHRvOiAnZG9tYWluOi8vbXNnLW5vZGUuJyArIGRvbWFpbiArICcvb2JqZWN0LWFkZHJlc3MtYWxsb2NhdGlvbicsXHJcbiAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IF90aGlzLl91cmwsIGNoaWxkcmVuUmVzb3VyY2VzOiBfdGhpcy5fY2hpbGRyZW5zIH1cclxuICAgIH0pO1xyXG5cclxuICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcbiAgICBkZWxldGUgX3RoaXMuX3BhcmVudC5fcmVwb3J0ZXJzW190aGlzLl91cmxdO1xyXG4gIH1cclxuXHJcbiAgX29uUmVtb3RlUmVzcG9uc2UobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBfdGhpcy5fdXJsLFxyXG4gICAgICBib2R5OiB7IGNvZGU6IG1zZy5ib2R5LmNvZGUsIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwgc291cmNlOiBtc2cuZnJvbSB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIFN5bmNoZXIgLT4gc3Vic2NyaWJlXHJcbiAgX29uUmVtb3RlU3Vic2NyaWJlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCBoeXBlcnR5VVJMID0gbXNnLmJvZHkuc3Vic2NyaWJlcjtcclxuXHJcbiAgICAvL3ZhbGlkYXRlIGlmIHN1YnNjcmlwdGlvbiBhbHJlYWR5IGV4aXN0cz9cclxuICAgIGlmIChfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VVJMXSkge1xyXG4gICAgICAvLyBsZXQgZXJyb3JNc2cgPSB7XHJcbiAgICAgIC8vICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogaHlwZXJ0eVVSTCxcclxuICAgICAgLy8gICBib2R5OiB7IGNvZGU6IDUwMCwgZGVzYzogJ1N1YnNjcmlwdGlvbiBmb3IgKCcgKyBfdGhpcy5fdXJsICsgJyA6ICcgKyAgaHlwZXJ0eVVSTCArICcpIGFscmVhZHkgZXhpc3RzIScgfVxyXG4gICAgICAvLyB9O1xyXG4gICAgICAvL1xyXG4gICAgICAvLyBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGVycm9yTXNnKTtcclxuICAgICAgLy8gcmV0dXJuO1xyXG5cclxuICAgICAgLy8gbmV3IHZlcnNpb24gYmVjYXVzZSBvZiByZXVzYWdlXHJcbiAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVUkxdLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9hc2sgdG8gc3Vic2NyaWJlIHRvIFN5bmNoZXI/IChkZXBlbmRzIG9uIHRoZSBvcGVyYXRpb24gbW9kZSlcclxuICAgIC8vVE9ETzogZ2V0IG1vZGUgZnJvbSBvYmplY3QhXHJcbiAgICBsZXQgbW9kZSA9ICdzdWIvcHViJztcclxuXHJcbiAgICBpZiAobW9kZSA9PT0gJ3N1Yi9wdWInKSB7XHJcbiAgICAgIC8vRkxPVy1PVVQ6IG1lc3NhZ2Ugc2VudCB0byBsb2NhbCBoeXBlcnR5IGFkZHJlc3MgU3luY2hlciAtPiBfb25Gb3J3YXJkXHJcbiAgICAgIGxldCBmb3J3YXJkTXNnID0ge1xyXG4gICAgICAgIHR5cGU6ICdmb3J3YXJkJywgZnJvbTogX3RoaXMuX3VybCwgdG86IF90aGlzLl9vd25lcixcclxuICAgICAgICBib2R5OiB7IHR5cGU6IG1zZy50eXBlLCBmcm9tOiBoeXBlcnR5VVJMLCB0bzogX3RoaXMuX3VybCwgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5IH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHlcclxuICAgICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdtdXR1YWwnKSkgZm9yd2FyZE1zZy5ib2R5Lm11dHVhbCA9IG1zZy5ib2R5Lm11dHVhbDtcclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZm9yd2FyZE1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLlJlcG9ydGVyT2JqZWN0IF1mb3J3YXJkLXJlcGx5OiAnLCByZXBseSk7XHJcbiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICBpZiAoIV90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVUkxdKSB7XHJcbiAgICAgICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5SZXBvcnRlck9iamVjdF0gLSBfb25SZW1vdGVTdWJzY3JpYmU6JywgX3RoaXMuX2NoaWxkcmVucyk7XHJcbiAgICAgICAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVUkxdID0gbmV3IFN1YnNjcmlwdGlvbihfdGhpcy5fYnVzLCBfdGhpcy5fb3duZXIsIF90aGlzLl91cmwsIHRydWUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIC8vIFN0b3JlIGZvciBlYWNoIHJlcG9ydGVyIGh5cGVydHkgdGhlIGRhdGFPYmplY3RcclxuICAgICAgICBsZXQgdXNlclVSTDtcclxuICAgICAgICBpZiAobXNnLmJvZHkuaWRlbnRpdHkgJiYgbXNnLmJvZHkuaWRlbnRpdHkudXNlclByb2ZpbGUudXNlclVSTCkge1xyXG4gICAgICAgICAgdXNlclVSTCA9IG1zZy5ib2R5LmlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJVUkw7XHJcbiAgICAgICAgICBfdGhpcy5fcGFyZW50Ll9kYXRhT2JqZWN0c1N0b3JhZ2UudXBkYXRlKHRydWUsIF90aGlzLl91cmwsICdzdWJzY3JpYmVyVXNlcnMnLCB1c2VyVVJMKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vVE9ETzogbXV0dWFsIGFuZCBzZXNzaW9ua2V5cyB1cGRhdGVzIHdlcmUgcmVtb3ZlZC4gRkZTXHJcblxyXG4gICAgICAgIC8qICAgICAgICBpZiAobXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ211dHVhbCcpKSB7XHJcbi8vICAgICAgICAgIF90aGlzLl9wYXJlbnQuX2lkZW50aXR5TW9kdWxlLnVwZGF0ZUlzVG9FbmNyeXB0Rm9yRGF0YU9iamVjdFNlc3Npb25LZXkoX3RoaXMuX3VybCwgbXNnLmJvZHkubXV0dWFsKS50aGVuKCgpPT57XHJcbiAgICAgICAgICAgIF90aGlzLl9wYXJlbnQuX2RhdGFPYmplY3RzU3RvcmFnZS51cGRhdGUodHJ1ZSwgX3RoaXMuX3VybCwgJ211dHVhbCcsIG1zZy5ib2R5Lm11dHVhbCk7XHJcbi8vICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICBfdGhpcy5fcGFyZW50Ll9kYXRhT2JqZWN0c1N0b3JhZ2UudXBkYXRlKHRydWUsIF90aGlzLl91cmwsICdzdWJzY3JpcHRpb25zJywgaHlwZXJ0eVVSTCk7XHJcblxyXG4gICAgICAgIHJlcGx5LmJvZHkub3duZXIgPSBfdGhpcy5fb3duZXI7XHJcblxyXG4gICAgICAgIC8vRkxPVy1PVVQ6IHN1YnNjcmlwdGlvbiByZXNwb25zZSBzZW50IChmb3J3YXJkIGZyb20gaW50ZXJuYWwgSHlwZXJ0eSlcclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICAgICAgYm9keTogcmVwbHkuYm9keVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gcmVtb3RlIE9ic2VydmVyT2JqZWN0IC0+IHJlbW92ZVN1YnNjcmlwdGlvblxyXG4gIF9vblJlbW90ZVVuU3Vic2NyaWJlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIGxldCB1bnN1YnNjcmliZXIgPSBtc2cuYm9keS5zb3VyY2U7XHJcblxyXG4gICAgbGV0IHN1YnNjcmlwdGlvbiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW3Vuc3Vic2NyaWJlcl07XHJcbiAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgIHN1YnNjcmlwdGlvbi5fcmVsZWFzZUxpc3RlbmVycygpO1xyXG4gICAgICBkZWxldGUgX3RoaXMuX3N1YnNjcmlwdGlvbnNbdW5zdWJzY3JpYmVyXTtcclxuXHJcbiAgICAgIGxldCBmb3J3YXJkTXNnID0ge1xyXG4gICAgICAgIHR5cGU6ICdmb3J3YXJkJywgZnJvbTogX3RoaXMuX3VybCwgdG86IF90aGlzLl9vd25lcixcclxuICAgICAgICBib2R5OiB7IHR5cGU6IG1zZy50eXBlLCBmcm9tOiB1bnN1YnNjcmliZXIsIHRvOiBfdGhpcy5fdXJsLCBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHkgfVxyXG4gICAgICB9O1xyXG5cclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZm9yd2FyZE1zZyk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFJlcG9ydGVyT2JqZWN0O1xyXG4iLCIvLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdPYnNlcnZlck9iamVjdCcpO1xyXG5cclxuaW1wb3J0IHsgZGl2aWRlVVJMLCBzcGxpdE9iamVjdFVSTCwgZGVlcENsb25lIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgU3Vic2NyaXB0aW9uIGZyb20gJy4vU3Vic2NyaXB0aW9uJztcclxuaW1wb3J0ICogYXMgY3J5cHRvTWFuYWdlciBmcm9tICcuLi9jcnlwdG9NYW5hZ2VyL0NyeXB0b01hbmFnZXInO1xyXG5cclxuY2xhc3MgT2JzZXJ2ZXJPYmplY3Qge1xyXG5cclxuICBjb25zdHJ1Y3RvcihwYXJlbnQsIHVybCwgY2hpbGRyZW5zKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9wYXJlbnQgPSBwYXJlbnQ7XHJcbiAgICBfdGhpcy5fdXJsID0gdXJsO1xyXG4gICAgX3RoaXMuX2NoaWxkcmVucyA9IGNoaWxkcmVucztcclxuXHJcbiAgICBfdGhpcy5fYnVzID0gcGFyZW50Ll9idXM7XHJcblxyXG4gICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTtcclxuICAgIF90aGlzLl9zdG9yYWdlU3Vic2NyaXB0aW9ucyA9IHt9O1xyXG4gICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzID0gW107XHJcblxyXG4gICAgdGhpcy5faXNUb1NhdmVEYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IGNoYW5nZVVSTCA9IF90aGlzLl91cmwgKyAnL2NoYW5nZXMnO1xyXG4gICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGFuZ2VVUkwsIChtc2cpID0+IHtcclxuXHJcbiAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5PYnNlcnZlck9iamVjdCBdIFN5bmNoZXJNYW5hZ2VyLScgKyBjaGFuZ2VVUkwgKyAnLVJDVjogJywgbXNnKTtcclxuXHJcbiAgICAgIC8vVE9ETzogd2hhdCB0b2RvIGhlcmU/IFNhdmUgY2hhbmdlcz9cclxuICAgICAgaWYgKHRoaXMuX2lzVG9TYXZlRGF0YSAmJiBtc2cuYm9keS5hdHRyaWJ1dGUpIHtcclxuICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuT2JzZXJ2ZXJPYmplY3QgXSBTeW5jaGVyTWFuYWdlciAtIHNhdmUgZGF0YTogJywgbXNnKTtcclxuICAgICAgICBfdGhpcy5fcGFyZW50Ll9kYXRhT2JqZWN0c1N0b3JhZ2UudXBkYXRlKGZhbHNlLCBfdGhpcy5fdXJsLCAndmVyc2lvbicsIG1zZy5ib2R5LnZlcnNpb24pO1xyXG4gICAgICAgIF90aGlzLl9wYXJlbnQuX2RhdGFPYmplY3RzU3RvcmFnZS51cGRhdGUoZmFsc2UsIF90aGlzLl91cmwsICdsYXN0TW9kaWZpZWQnLCBtc2cuYm9keS5sYXN0TW9kaWZpZWQpO1xyXG4gICAgICAgIF90aGlzLl9wYXJlbnQuX2RhdGFPYmplY3RzU3RvcmFnZS5zYXZlRGF0YShmYWxzZSwgX3RoaXMuX3VybCwgbXNnLmJvZHkuYXR0cmlidXRlLCBtc2cuYm9keS52YWx1ZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldCBpc1RvU2F2ZURhdGEodmFsdWUpIHtcclxuICAgIHRoaXMuX2lzVG9TYXZlRGF0YSA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgX25ld1N1YnNjcmlwdGlvbihoeXBlcnR5KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBzdWJzY3JpcHRpb24gPSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5XTtcclxuICAgIGxvZy5sb2coJ1tPYnNlcnZlciBPYmplY3QgLSBuZXcgc3Vic2NyaXB0aW9uXSAtICcsICBfdGhpcy5fc3Vic2NyaXB0aW9ucywgaHlwZXJ0eSwgX3RoaXMuX3N1YnNjcmlwdGlvbnMuaGFzT3duUHJvcGVydHkoaHlwZXJ0eSkpO1xyXG4gICAgaWYgKCFzdWJzY3JpcHRpb24pIHtcclxuICAgICAgX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eV0gPSBuZXcgU3Vic2NyaXB0aW9uKF90aGlzLl9idXMsIGh5cGVydHksIF90aGlzLl91cmwsIGZhbHNlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFkZFN1YnNjcmlwdGlvbihoeXBlcnR5KSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9uZXdTdWJzY3JpcHRpb24oaHlwZXJ0eSk7XHJcbiAgfVxyXG5cclxuICBhZGRDaGlsZHJlbnMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICBpZiAoX3RoaXMuX2NoaWxkcmVucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IF90aGlzLl91cmwgKyAnL2NoaWxkcmVuLyc7XHJcbiAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5PYnNlcnZlck9iamVjdCAtIGFkZENoaWxkcmVuc10gLSBjaGlsZHJlbnM6ICcsIGNoaWxkQmFzZVVSTCk7XHJcblxyXG4vLyAgICAgIGNoaWxkcmVucy5mb3JFYWNoKChjaGlsZCkgPT4ge1xyXG5cclxuICAgICAgICBsZXQgY2hpbGRMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hpbGRCYXNlVVJMLCAobXNnKSA9PiB7XHJcbiAgICAgICAgICAvL1RPRE86IHdoYXQgdG9kbyBoZXJlPyBTYXZlIGNoaWxkcmVucz9cclxuICAgICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5PYnNlcnZlck9iamVjdCByZWNlaXZlZF0nLCBtc2cpO1xyXG5cclxuICAgICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ2NyZWF0ZScgJiYgbXNnLnRvLmluY2x1ZGVzKCdjaGlsZHJlbicpICYmIHRoaXMuX2lzVG9TYXZlRGF0YSkge1xyXG4gICAgICAgICAgICBsZXQgc3BsaXRlZFJlcG9ydGVyVVJMID0gc3BsaXRPYmplY3RVUkwobXNnLnRvKTtcclxuXHJcbiAgICAgICAgICAgIGxldCB1cmwgPSBzcGxpdGVkUmVwb3J0ZXJVUkwudXJsO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykpIG1zZy5ib2R5Lm11dHVhbCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAvL3JlbW92ZSBmYWxzZSB3aGVuIG11dHVhbEF1dGhlbnRpY2F0aW9uIGlzIGVuYWJsZWRcclxuICAgICAgICAgICAgaWYgKCEodHlwZW9mIG1zZy5ib2R5LnZhbHVlID09PSAnc3RyaW5nJykgJiYgbXNnLmJvZHkubXV0dWFsKSB7XHJcblxyXG4gICAgICAgICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5PYnNlcnZlck9iamVjdF0gZW5jcnlwdGluZyByZWNlaXZlZCBkYXRhICcsIG1zZy5ib2R5LnZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgY3J5cHRvTWFuYWdlci5kZWZhdWx0LmVuY3J5cHREYXRhT2JqZWN0KG1zZy5ib2R5LnZhbHVlLCB1cmwpLnRoZW4oKGVuY3J5cHRlZFZhbHVlKT0+e1xyXG4gICAgICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLk9ic2VydmVyT2JqZWN0XSBlbmNyeXB0ZWQgZGF0YSAnLCAgZW5jcnlwdGVkVmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIF90aGlzLl9zdG9yZUNoaWxkT2JqZWN0KG1zZywgSlNPTi5zdHJpbmdpZnkoZW5jcnlwdGVkVmFsdWUpKTtcclxuICAgICAgICAgICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2cud2FybignW1N5bmNoZXJNYW5hZ2VyLk9ic2VydmVyT2JqZWN0Ll9lbmNyeXB0Q2hpbGRdIGZhaWxlZCwgc3RvcmluZyB1bmVuY3J5cHRlZCAnLCByZWFzb24pO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuX3N0b3JlQ2hpbGRPYmplY3QobXNnLCBtc2cuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgX3RoaXMuX3N0b3JlQ2hpbGRPYmplY3QobXNnLCBtc2cuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuT2JzZXJ2ZXJPYmplY3QgY2hpbGRyZW4gTGlzdGVuZXJzXScsIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycywgY2hpbGRMaXN0ZW5lcik7XHJcbiAgICAgICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmluZGV4T2YoY2hpbGRMaXN0ZW5lcikgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGNoaWxkTGlzdGVuZXIpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuLy8gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBzdG9yZSBjaGlsZE9iamVjdFxyXG5cclxuICBfc3RvcmVDaGlsZE9iamVjdChtc2csIGRhdGEpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IHNwbGl0ZWRSZXBvcnRlclVSTCA9IHNwbGl0T2JqZWN0VVJMKG1zZy50byk7XHJcblxyXG4gICAgbGV0IHVybCA9IHNwbGl0ZWRSZXBvcnRlclVSTC51cmw7XHJcblxyXG4gICAgbGV0IHJlc291cmNlID0gc3BsaXRlZFJlcG9ydGVyVVJMLnJlc291cmNlO1xyXG4gICAgbGV0IHZhbHVlID0ge307XHJcblxyXG4vKiAgICBsZXQgdmFsdWUgPSB7XHJcbiAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSxcclxuICAgICAgdmFsdWU6IGRhdGFcclxuICAgIH07Ki9cclxuXHJcbiAgICAvLyB0aGlzIGlkZW50aXR5IGRhdGEgaXMgbm90IG5lZWRlZCB0byBiZSBzdG9yZWRcclxuLyogICAgZGVsZXRlIHZhbHVlLmlkZW50aXR5LmFzc2VydGlvbjtcclxuICAgIGRlbGV0ZSB2YWx1ZS5pZGVudGl0eS5leHBpcmVzOyovXHJcblxyXG4gICAgbGV0IG9iamVjdFVSTFJlc291cmNlID0gbXNnLmJvZHkucmVzb3VyY2U7XHJcbiAgICBsZXQgYXR0cmlidXRlID0gcmVzb3VyY2U7XHJcblxyXG4gICAgaWYgKG9iamVjdFVSTFJlc291cmNlID09PSAnaGVhcnRiZWF0Jykge1xyXG4gICAgICB2YWx1ZSA9IGRhdGE7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB2YWx1ZS5pZGVudGl0eT0gbXNnLmJvZHkuaWRlbnRpdHk7XHJcbiAgICAgIHZhbHVlLnZhbHVlID0gZGF0YTtcclxuICAgIH0gXHJcblxyXG4vLyAgICBpZiAob2JqZWN0VVJMUmVzb3VyY2UpIGF0dHJpYnV0ZSArPSAnLicgKyBvYmplY3RVUkxSZXNvdXJjZTtcclxuICAgIGlmIChvYmplY3RVUkxSZXNvdXJjZSkgYXR0cmlidXRlID0gb2JqZWN0VVJMUmVzb3VyY2U7XHJcblxyXG4gICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLk9ic2VydmVyT2JqZWN0Ll9zdG9yZUNoaWxkT2JqZWN0XSA6ICcsIHVybCwgYXR0cmlidXRlLCB2YWx1ZSk7XHJcblxyXG4gICAgX3RoaXMuX3BhcmVudC5fZGF0YU9iamVjdHNTdG9yYWdlLnNhdmVDaGlsZHJlbnMoZmFsc2UsIHVybCwgYXR0cmlidXRlLCB2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVTdWJzY3JpcHRpb24obXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCBoeXBlcnR5ID0gbXNnLmZyb207XHJcblxyXG4gICAgbGV0IGRvbWFpbiA9IGRpdmlkZVVSTChoeXBlcnR5KS5kb21haW47XHJcbiAgICBsZXQgb2JqVVJMU3Vic2NyaXB0aW9uID0gX3RoaXMuX3VybCArICcvc3Vic2NyaXB0aW9uJztcclxuXHJcbiAgICBsZXQgc3Vic2NyaXB0aW9uID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eV07XHJcbiAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgIC8vRkxPVy1PVVQ6IG1lc3NhZ2Ugc2VudCB0byByZW1vdGUgUmVwb3J0ZXJPYmplY3QgLT4gX29uUmVtb3RlVW5TdWJzY3JpYmVcclxuICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogJ3Vuc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX3BhcmVudC5fdXJsLCB0bzogb2JqVVJMU3Vic2NyaXB0aW9uLFxyXG4gICAgICAgIGJvZHk6IHsgc291cmNlOiBoeXBlcnR5LCBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHkgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vVE9ETzogc2hvdWxkIEkgd2FpdCBmb3IgcmVzcG9uc2UgYmVmb3JlIHVuc3Vic2NyaWJlIG9uIG1zZy1ub2RlXHJcbiAgICAgIC8vRkxPVy1PVVQ6IG1lc3NhZ2Ugc2VudCB0byBtc2ctbm9kZSBTdWJzY3JpcHRpb25NYW5hZ2VyIGNvbXBvbmVudFxyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fcGFyZW50Ll91cmwsIHRvOiAnZG9tYWluOi8vbXNnLW5vZGUuJyArIGRvbWFpbiArICcvc20nLFxyXG4gICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IF90aGlzLl91cmwsIHJlc291cmNlczogW190aGlzLl91cmwgKyAnL2NoaWxkcmVuLyddIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBzdWJzY3JpcHRpb24uX3JlbGVhc2VMaXN0ZW5lcnMoKTtcclxuICAgICAgZGVsZXRlIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHldO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IE9ic2VydmVyT2JqZWN0O1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vLyBMb2cgU3lzdGVtXHJcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdTeW5jaGVyTWFuYWdlcicpO1xyXG5cclxuaW1wb3J0IHsgZGl2aWRlVVJMLCBkZWVwQ2xvbmUgfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcbi8vaW1wb3J0IHsgc2NoZW1hVmFsaWRhdGlvbiB9IGZyb20gJy4uL3V0aWxzL3NjaGVtYVZhbGlkYXRpb24nO1xyXG5cclxuaW1wb3J0IEFkZHJlc3NBbGxvY2F0aW9uIGZyb20gJy4uL2FsbG9jYXRpb24vQWRkcmVzc0FsbG9jYXRpb24nO1xyXG5pbXBvcnQgUmVwb3J0ZXJPYmplY3QgZnJvbSAnLi9SZXBvcnRlck9iamVjdCc7XHJcbmltcG9ydCBPYnNlcnZlck9iamVjdCBmcm9tICcuL09ic2VydmVyT2JqZWN0JztcclxuaW1wb3J0ICogYXMgY3J5cHRvTWFuYWdlciBmcm9tICcuLi9jcnlwdG9NYW5hZ2VyL0NyeXB0b01hbmFnZXInO1xyXG5cclxuLyoqXHJcbiAqIEBhdXRob3IgbWljYWVscGVkcm9zYUBnbWFpbC5jb21cclxuICogQ29yZSBTeW5jcm9uaXphdGlvbiBzeXN0ZW0uXHJcbiAqL1xyXG5jbGFzcyBTeW5jaGVyTWFuYWdlciB7XHJcbiAgLyogcHJpdmF0ZVxyXG4gIF91cmw6IFVSTFxyXG4gIF9idXM6IE1pbmlCdXNcclxuICBfcmVnaXN0cnk6IFJlZ2lzdHJ5XHJcbiAgX2FsbG9jYXRvcjogQWRkcmVzc0FsbG9jYXRpb25cclxuXHJcbiAgX3JlcG9ydGVyczogeyBPYmplY3RVUkw6IFJlcG9ydGVyT2JqZWN0IH1cclxuICBfb2JzZXJ2ZXJzOiB7IE9iamVjdFVSTDogT2JzZXJ2ZXJPYmplY3QgfVxyXG4gICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKHJ1bnRpbWVVUkwsIGJ1cywgcmVnaXN0cnksIGNhdGFsb2csIHN0b3JhZ2VNYW5hZ2VyLCBhbGxvY2F0b3IsIHN0b3JlRGF0YU9iamVjdHMsIGlkZW50aXR5TW9kdWxlKSB7XHJcbiAgICBpZiAoIXJ1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcignW1N5bmNoZXIgTWFuYWdlcl0gLSBuZWVkcyB0aGUgcnVudGltZVVSTCBwYXJhbWV0ZXInKTtcclxuICAgIGlmICghYnVzKSB0aHJvdyBuZXcgRXJyb3IoJ1tTeW5jaGVyIE1hbmFnZXJdIC0gbmVlZHMgdGhlIE1lc3NhZ2VCdXMgaW5zdGFuY2UnKTtcclxuICAgIGlmICghcmVnaXN0cnkpIHRocm93IG5ldyBFcnJvcignW1N5bmNoZXIgTWFuYWdlcl0gLSBuZWVkcyB0aGUgUmVnaXN0cnkgaW5zdGFuY2UnKTtcclxuICAgIGlmICghY2F0YWxvZykgdGhyb3cgbmV3IEVycm9yKCdbU3luY2hlciBNYW5hZ2VyXSAtIG5lZWRzIHRoZSBSdW50aW1lQ2F0YWxvZ3VlIGluc3RhbmNlJyk7XHJcbiAgICBpZiAoIXN0b3JhZ2VNYW5hZ2VyKSB0aHJvdyBuZXcgRXJyb3IoJ1tTeW5jaGVyIE1hbmFnZXJdIC0gbmVlZCB0aGUgc3RvcmFnZU1hbmFnZXIgaW5zdGFuY2UnKTtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIF90aGlzLl9idXMgPSBidXM7XHJcbiAgICBfdGhpcy5fcmVnaXN0cnkgPSByZWdpc3RyeTtcclxuICAgIF90aGlzLl9jYXRhbG9nID0gY2F0YWxvZztcclxuICAgIF90aGlzLl9zdG9yYWdlTWFuYWdlciA9IHN0b3JhZ2VNYW5hZ2VyO1xyXG4gICAgX3RoaXMuX2lkZW50aXR5TW9kdWxlID0gaWRlbnRpdHlNb2R1bGU7XHJcblxyXG4gICAgLy9UT0RPOiB0aGVzZSBzaG91bGQgYmUgc2F2ZWQgaW4gcGVyc2lzdGVuY2UgZW5naW5lP1xyXG4gICAgX3RoaXMucnVudGltZVVSTCA9IHJ1bnRpbWVVUkw7XHJcbiAgICBfdGhpcy5fdXJsID0gcnVudGltZVVSTCArICcvc20nO1xyXG4gICAgX3RoaXMuX29iamVjdFVSTCA9IHJ1bnRpbWVVUkwgKyAnL29iamVjdC1hbGxvY2F0aW9uJztcclxuXHJcbiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307XHJcbiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307XHJcblxyXG4gICAgX3RoaXMuX2RhdGFPYmplY3RzU3RvcmFnZSA9IHN0b3JlRGF0YU9iamVjdHM7XHJcbiAgICBjb25zb2xlLmxvZygnW05PVFNBVklOR10gc3RvcmVEYXRhT2JqZWN0cycsIHN0b3JlRGF0YU9iamVjdHMpO1xyXG4gICAgLy9UT0RPOiB0aGlzIHNob3VsZCBub3QgYmUgaGFyZGNvZGVkIVxyXG4gICAgX3RoaXMuX2RvbWFpbiA9IGRpdmlkZVVSTChydW50aW1lVVJMKS5kb21haW47XHJcblxyXG4gICAgaWYgKGFsbG9jYXRvcikge1xyXG4gICAgICBfdGhpcy5fYWxsb2NhdG9yID0gYWxsb2NhdG9yO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgX3RoaXMuX2FsbG9jYXRvciA9IEFkZHJlc3NBbGxvY2F0aW9uLmluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlciAtIEFkZHJlc3NBbGxvY2F0aW9uXSAtICcsIF90aGlzLl9hbGxvY2F0b3IpO1xyXG5cclxuICAgIGJ1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsLCAobXNnKSA9PiB7XHJcbiAgICAgIGxvZy5pbmZvKCdbU3luY2hlck1hbmFnZXJdIFJDVjogJywgbXNnKTtcclxuICAgICAgc3dpdGNoIChtc2cudHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ2NyZWF0ZSc6IF90aGlzLl9vbkNyZWF0ZShtc2cpOyBicmVhaztcclxuICAgICAgICBjYXNlICdkZWxldGUnOiBfdGhpcy5fb25EZWxldGUobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzogX3RoaXMuX29uTG9jYWxTdWJzY3JpYmUobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAndW5zdWJzY3JpYmUnOiBfdGhpcy5fb25Mb2NhbFVuU3Vic2NyaWJlKG1zZyk7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3JlYWQnOiBfdGhpcy5fb25SZWFkKG1zZyk7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2V4ZWN1dGUnOiBfdGhpcy5fb25FeGVjdXRlKG1zZyk7IGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBnZXQgdXJsKCkgeyByZXR1cm4gdGhpcy5fdXJsOyB9XHJcblxyXG4gICAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBTeW5jaGVyIC0+IHJlYWRcclxuICAgICAgX29uRXhlY3V0ZShtc2cpIHtcclxuXHJcbiAgICAgICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAgICAgbGV0IHJlcGx5ID0ge1xyXG4gICAgICAgICAgdHlwZTogJ3Jlc3BvbnNlJyxcclxuICAgICAgICAgIGZyb206IG1zZy50byxcclxuICAgICAgICAgIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICAgIGlkOiBtc2cuaWRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxvZy5pbmZvKCdbU3luY2hlck1hbmFnZXIub25FeGVjdXRlXSBuZXcgbWVzc2FnZScsIG1zZyk7XHJcblxyXG4gICAgICAgIGlmIChtc2cuaGFzT3duUHJvcGVydHkoJ2JvZHknKSAmJiBtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbWV0aG9kJykgJiYgbXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ3BhcmFtcycpKSB7XHJcblxyXG4gICAgICAgIHN3aXRjaCAobXNnLmJvZHkubWV0aG9kKSB7XHJcbiAgICAgICAgICBjYXNlICdzeW5jJzogX3RoaXMuX2RhdGFPYmplY3RzU3RvcmFnZS5zeW5jKG1zZy5ib2R5LnBhcmFtc1swXSwgbXNnLmJvZHkucGFyYW1zWzFdLCBmYWxzZSk7XHJcbiAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICdzdG9wU3luYyc6IF90aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2Uuc3RvcFN5bmMobXNnLmJvZHkucGFyYW1zWzBdKTtcclxuICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXBseS5ib2R5ID0ge1xyXG4gICAgICAgICAgICAgIGNvZGU6IDIwMFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXBseSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVwbHkuYm9keSA9IHtcclxuICAgICAgICAgICAgY29kZTogNDAwLFxyXG4gICAgICAgICAgICBkZXNjOiAnbWlzc2luZyBib2R5IG9yIGJvZHkgbWV0aG9kIC8gcGFyYW1zIG1hbmRhdG9yeSBmaWVsZHMnXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIGxvZy5lcnJvcignW1N5bmNoZXJNYW5hZ2VyLm9uRXhlY3V0ZV0gZXJyb3IuIE1pc3NpbmcgYm9keSBvciBib2R5IG1ldGhvZCAvIHBhcmFtcyBtYW5kYXRvcnkgZmllbGRzJywgbXNnKTtcclxuXHJcbiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcGx5KTtcclxuXHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBTeW5jaGVyIC0+IHJlYWRcclxuICAgIF9vblJlYWQobXNnKSB7XHJcblxyXG4gICAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgICAgbGV0IHJlcGx5ID0ge1xyXG4gICAgICAgIHR5cGU6ICdyZXNwb25zZScsXHJcbiAgICAgICAgZnJvbTogbXNnLnRvLFxyXG4gICAgICAgIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICBpZDogbXNnLmlkXHJcbiAgICAgIH1cclxuICAgICAgbG9nLmluZm8oJ1tTeW5jaGVyTWFuYWdlci5vblJlYWRdIG5ldyBtZXNzYWdlJywgbXNnKTtcclxuXHJcbiAgICAgIGlmIChtc2cuaGFzT3duUHJvcGVydHkoJ2JvZHknKSAmJiBtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgncmVzb3VyY2UnKSkge1xyXG4gICAgICAgIF90aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2Uuc3luYyhtc2cuYm9keS5yZXNvdXJjZSwgY3JpdGVyaWEuYmFja3VwUmV2aXNpb24sIHRydWUpLnRoZW4oKGRhdGFPYmplY3QpPT57XHJcbiAgICAgICAgICByZXBseS5ib2R5ID0ge1xyXG4gICAgICAgICAgICBjb2RlOiAyMDAsXHJcbiAgICAgICAgICAgIHZhbHVlOiBkYXRhT2JqZWN0XHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIGxvZy5pbmZvKCdbU3luY2hlck1hbmFnZXIub25SZWFkXSBmb3VuZCBvYmplY3Q6ICcsIGRhdGFPYmplY3QpO1xyXG5cclxuICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVwbHkpO1xyXG4gICAgICAgIH0sIChlcnJvcik9PntcclxuICAgICAgICAgIHJlcGx5LmJvZHkgPSB7XHJcbiAgICAgICAgICAgIGNvZGU6IDQwMCxcclxuICAgICAgICAgICAgZGVzYzogZXJyb3JcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgbG9nLmVycm9yKCdbU3luY2hlck1hbmFnZXIub25SZWFkXSBlcnJvcjogJywgZXJyb3IpO1xyXG5cclxuICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVwbHkpO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVwbHkuYm9keSA9IHtcclxuICAgICAgICAgIGNvZGU6IDQwMCxcclxuICAgICAgICAgIGRlc2M6ICdtaXNzaW5nIGJvZHkgb3IgYm9keSByZXNvdXJjZSBtYW5kYXRvcnkgZmllbGRzJ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGxvZy5lcnJvcignW1N5bmNoZXJNYW5hZ2VyLm9uUmVhZF0gZXJyb3IuIE1pc3NpbmcgYm9keSBvciBib2R5IHJlc291cmNlIG1hbmRhdG9yeSBmaWVsZHMnLCBtc2cpO1xyXG5cclxuICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcGx5KTtcclxuXHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBTeW5jaGVyIC0+IGNyZWF0ZVxyXG4gIF9vbkNyZWF0ZShtc2cpIHtcclxuXHJcbiAgICBsZXQgZnJvbSA9IG1zZy5mcm9tO1xyXG4gICAgbGV0IHRvID0gbXNnLnRvO1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAvLyBjaGVjayBpZiBtZXNzYWdlIGlzIHRvIHNhdmUgbmV3IGNoaWxkcmVuT2JqZWN0cyBpbiB0aGUgbG9jYWwgc3RvcmFnZVxyXG4gICAgLy8gVE9ETzogY2hlY2sgaWYgbWVzc2FnZSBpcyB0byBzdG9yZSBuZXcgY2hpbGQgaW4gdGhlIGxvY2FsIHN0b3JhZ2UgYW5kIGNhbGwgc3RvcmVDaGlsZC4gSG93IHRvIGRpc3Rpbmd1aXNoIGZyb20gb3RoZXJzP1xyXG5cclxuICAgIC8vZGVidWdnZXI7XHJcbiAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlKSB7IHRoaXMuX3N0b3JlQ2hpbGRyZW5zKG1zZyk7IH0gZWxzZSB7XHJcblxyXG4gICAgICBpZiAoIW1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdyZXN1bWUnKSB8fCAobXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ3Jlc3VtZScpICYmICFtc2cuYm9keS5yZXN1bWUpKSB7XHJcblxyXG4gICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgaXMgYW4gaW52aXRhdGlvbiBtZXNzYWdlXHJcbiAgICAgICAgaWYgKG1zZy5ib2R5LmF1dGhvcmlzZSkge1xyXG4gICAgICAgICAgdGhpcy5fYXV0aG9yaXNlKG1zZyk7XHJcbiAgICAgICAgICBsb2cuaW5mbygnW1N5bmNoZXJNYW5hZ2VyLm9uQ3JlYXRlIC0gaW52aXRlIG9ic2VydmVyc10nLCBtc2cpO1xyXG4gICAgICAgIH0gZWxzZSB7IC8vIHRoaXMgaXMgdG8gY3JlYXRlIGEgbmV3IGRhdGEgb2JqZWN0XHJcbiAgICAgICAgICBsb2cuaW5mbygnW1N5bmNoZXJNYW5hZ2VyLm9uQ3JlYXRlIC0gQ3JlYXRlIE5ldyBPYmplY3RdJywgbXNnKTtcclxuICAgICAgICAgIHRoaXMuX25ld0NyZWF0ZShtc2cpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIC8vIElmIGZyb20gdGhlIGh5cGVydHkgc2lkZSwgY2FsbCB0aGUgcmVzdW1lUmVwb3J0ZXIgd2Ugd2lsbCBoYXZlIHJlc3VtZSA9IHRydWUnXHJcbiAgICAgICAgLy8gc28gd2Ugd2lsbCBjcmVhdGUgYW4gcmVzdW1lZCBvYmplY3QgYW5kIHdpbGwgdHJ5IHRvIHJlc3VtZSB0aGUgb2JqZWN0IHByZXZpb3VzbHkgc2F2ZWQ7XHJcbiAgICAgICAgdGhpcy5fZGF0YU9iamVjdHNTdG9yYWdlLmdldFJlc291cmNlc0J5Q3JpdGVyaWEobXNnLCB0cnVlKS50aGVuKChyZXN1bHQpID0+IHtcclxuXHJcbiAgICAgICAgICBsb2cuaW5mbygnW1N5bmNoZXJNYW5hZ2VyIC0gQ3JlYXRlIFJlc3VtZWRdIC0gUmVzb3VyY2VzQnlDcml0ZXJpYSB8IE1lc3NhZ2U6ICcsIG1zZywgJyByZXN1bHQ6ICcsIHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgaWYgKHJlc3VsdCAmJiBPYmplY3Qua2V5cyhyZXN1bHQpLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgIGxldCBsaXN0T2ZSZXBvcnRlcnMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlc3VsdCkuZm9yRWFjaCgob2JqVVJMKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgIGxpc3RPZlJlcG9ydGVycy5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICBfdGhpcy5fcmVzdW1lQ3JlYXRlKG1zZywgcmVzdWx0W29ialVSTF0pXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIFByb21pc2UuYWxsKGxpc3RPZlJlcG9ydGVycykudGhlbigocmVzdW1lZFJlcG9ydGVycykgPT4ge1xyXG4gICAgICAgICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlciAtIENyZWF0ZSBSZXN1bWVkXScsIHJlc3VtZWRSZXBvcnRlcnMpO1xyXG5cclxuICAgICAgICAgICAgICAvLyBUT0RPOiBzaG91ZCBzZW5kIHRoZSBpbmZvcm1hdGlvbiBpZiBzb21lIG9iamVjdCB3YXMgZmFpbGluZztcclxuICAgICAgICAgICAgICBsZXQgc3VjY2Vzc2Z1bGx5UmVzdW1lZCA9IE9iamVjdC52YWx1ZXMocmVzdW1lZFJlcG9ydGVycykuZmlsdGVyKChyZXBvcnRlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcG9ydGVyICE9PSBmYWxzZTtcclxuICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgbG9nLmluZm8oJ1tTeW5jaGVyTWFuYWdlci5vbkNyZWF0ZV0gcmV0dXJuaW5nIHJlc3VtZWQgb2JqZWN0cyA6ICcsIHN1Y2Nlc3NmdWxseVJlc3VtZWQpO1xyXG5cclxuICAgICAgICAgICAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHJlc3BvbnNlIHRvIFN5bmNoZXIgLT4gY3JlYXRlIHJlc3VtZVxyXG4gICAgICAgICAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiB0bywgdG86IGZyb20sXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6IGRlZXBDbG9uZShzdWNjZXNzZnVsbHlSZXN1bWVkKSB9XHJcbiAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgIC8qc3VjY2Vzc2Z1bGx5UmVzdW1lZC5mb3JFYWNoKChyZXBvcnRlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcG9ydGVyLmJhY2t1cCkge1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2Uuc3luYyhyZXBvcnRlci51cmwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pOyovXHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvL2ZvcndhcmQgdG8gaHlwZXJ0eTpcclxuICAgICAgICAgICAgbGV0IHJlcGx5ID0ge307XHJcbiAgICAgICAgICAgIHJlcGx5LmlkID0gbXNnLmlkO1xyXG4gICAgICAgICAgICByZXBseS5mcm9tID0gbXNnLnRvO1xyXG4gICAgICAgICAgICByZXBseS50byA9IG1zZy5mcm9tO1xyXG4gICAgICAgICAgICByZXBseS50eXBlID0gJ3Jlc3BvbnNlJztcclxuICAgICAgICAgICAgcmVwbHkuYm9keSA9IHtcclxuICAgICAgICAgICAgICBjb2RlOiA0MDQsXHJcbiAgICAgICAgICAgICAgZGVzYzogJ05vIGRhdGEgb2JqZWN0cyByZXBvcnRlcnMgdG8gYmUgcmVzdW1lZCdcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcGx5KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICBfc3RvcmVDaGlsZHJlbnMobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCByZXNvdXJjZSA9IG1zZy5ib2R5LnJlc291cmNlO1xyXG4gICAgbGV0IGF0dHJpYnV0ZSA9IG1zZy5ib2R5LmF0dHJpYnV0ZTtcclxuXHJcbiAgICBpZiAoYXR0cmlidXRlID09PSAnY2hpbGRyZW5PYmplY3RzJykge1xyXG4gICAgICBfdGhpcy5fZGF0YU9iamVjdHNTdG9yYWdlLnNhdmVDaGlsZHJlbnMoZmFsc2UsIHJlc291cmNlLCB1bmRlZmluZWQsIG1zZy5ib2R5LnZhbHVlKTtcclxuICAgIH0gZWxzZSB7IF90aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2Uuc2F2ZUNoaWxkcmVucyh0cnVlLCByZXNvdXJjZSwgYXR0cmlidXRlLCBtc2cuYm9keS52YWx1ZSk7XHJcbiAgICAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgX25ld0NyZWF0ZShtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IG93bmVyID0gbXNnLmZyb207XHJcbiAgICBsZXQgZG9tYWluID0gZGl2aWRlVVJMKG1zZy5mcm9tKS5kb21haW47XHJcblxyXG4gICAgLy8gaWYgcmVwb3J0ZXIgaXMgaW4gYSBJbnRlcndvcmtpbmcgUHJvdG9zdHViIHRoZSBydW50aW1lIGRvbWFpbiBiYWNrZW5kIHNlcnZpY2VzIHdpbGwgYmUgdXNlZFxyXG4gICAgaWYgKF90aGlzLl9yZWdpc3RyeS5pc0ludGVyd29ya2luZ1Byb3RvU3R1Yihtc2cuZnJvbSkpIHtcclxuICAgICAgZG9tYWluID0gZGl2aWRlVVJMKF90aGlzLnJ1bnRpbWVVUkwpLmRvbWFpbjtcclxuICAgIH1cclxuXHJcbi8vICAgIGxldCBkb21haW5SZWdpc3RyYXRpb24gPSBtc2cuYm9keS52YWx1ZS5oYXNPd25Qcm9wZXJ0eSgnZG9tYWluX3JlZ2lzdHJhdGlvbicpID8gbXNnLmJvZHkudmFsdWUuZG9tYWluX3JlZ2lzdHJhdGlvbiA6IHRydWU7XHJcbiAgICBsZXQgZG9tYWluUm91dGluZyA9IG1zZy5ib2R5LnZhbHVlLmhhc093blByb3BlcnR5KCdkb21haW5fcm91dGluZycpID8gbXNnLmJvZHkudmFsdWUuZG9tYWluX3JvdXRpbmcgOiB0cnVlO1xyXG5cclxuICAgIC8vIFByb2Nlc3MgaW52aXRhdGlvbiBtZXNzYWdlIHRvIG9ic2VydmVyc1xyXG5cclxuICAgIC8qaWYgKG1zZy5ib2R5LmF1dGhvcmlzZSkge1xyXG4gICAgICBfdGhpcy5fYXV0aG9yaXNlKG1zZyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH0qL1xyXG5cclxuICAgIC8vZ2V0IHNjaGVtYSBmcm9tIGNhdGFsb2d1ZSBhbmQgcGFyc2UgLT4gKHNjaGVtZSwgY2hpbGRyZW4pXHJcbiAgICBfdGhpcy5fY2F0YWxvZy5nZXREYXRhU2NoZW1hRGVzY3JpcHRvcihtc2cuYm9keS5zY2hlbWEpLnRoZW4oKGRlc2NyaXB0b3IpID0+IHtcclxuXHJcblxyXG5cclxuXHJcbiAgICAgIGxldCBwcm9wZXJ0aWVzID0gZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUucHJvcGVydGllcztcclxuICAgICAgbGV0IHNjaGVtZSA9IHByb3BlcnRpZXMuc2NoZW1lID8gcHJvcGVydGllcy5zY2hlbWUgOiAncmVzb3VyY2UnO1xyXG4gICAgICBsZXQgY2hpbGRyZW5zID0gcHJvcGVydGllcy5jaGlsZHJlbiA/IHByb3BlcnRpZXMuY2hpbGRyZW4gOiBbXTtcclxuXHJcbiAgICAgIC8vIERvIHNjaGVtYSB2YWxpZGF0aW9uXHJcbiAgICAgIC8vIFRPRE86IGNoZWNrIGlmIGlzIG5lZWQgdG8gaGFuZGxlIHdpdGggdGhlIHJlc3VsdCBvZiB2YWxpZGF0aW9uXHJcbiAgICAgIC8vICAgICAgc2NoZW1hVmFsaWRhdGlvbihzY2hlbWUsIGRlc2NyaXB0b3IsIG1zZy5ib2R5LnZhbHVlKTtcclxuXHJcbiAgICAgIGxldCBvYmplY3RJbmZvID0ge1xyXG4gICAgICAgIG5hbWU6IG1zZy5ib2R5LnZhbHVlLm5hbWUsXHJcbiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS52YWx1ZS5zY2hlbWEsXHJcbiAgICAgICAgcmVwb3J0ZXI6IG1zZy5ib2R5LnZhbHVlLnJlcG9ydGVyLFxyXG4gICAgICAgIHJlc291cmNlczogbXNnLmJvZHkudmFsdWUucmVzb3VyY2VzXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBzaG91bGQgcmVzdXNlIGRhdGEgb2JqZWN0IHVybCBpZiBpdCBwYXNzZWRcclxuICAgICAgbGV0IHJldXNlRGF0YU9iamVjdCA9IG1zZy5ib2R5LnZhbHVlLnJlc291cmNlO1xyXG4gICAgICBsZXQgbnVtT2ZBZGRyZXNzID0gMTtcclxuXHJcbiAgICAgIC8vZGVidWdnZXI7XHJcbiAgICAgIC8vcmVxdWVzdCBhZGRyZXNzIGFsbG9jYXRpb24gb2YgYSBuZXcgb2JqZWN0IGZyb20gdGhlIG1zZy1ub2RlXHJcbiAgICAgIC8vX3RoaXMuX2FsbG9jYXRvci5jcmVhdGUoZG9tYWluLCBudW1PZkFkZHJlc3MsIG9iamVjdEluZm8sIHNjaGVtZSwgcmV1c2VEYXRhT2JqZWN0KS50aGVuKChhbGxvY2F0ZWQpID0+IHtcclxuICAgICAgX3RoaXMuX2FsbG9jYXRvci5jcmVhdGUoZG9tYWluLCBudW1PZkFkZHJlc3MsIG9iamVjdEluZm8sIHNjaGVtZSwgcmV1c2VEYXRhT2JqZWN0KS50aGVuKChhbGxvY2F0ZWQpID0+IHtcclxuXHJcbiAgICAgICAgbGV0IG9iamVjdFJlZ2lzdHJhdGlvbiA9IGRlZXBDbG9uZShtc2cuYm9keS52YWx1ZSk7XHJcbiAgICAgICAgb2JqZWN0UmVnaXN0cmF0aW9uLnVybCA9IGFsbG9jYXRlZC5hZGRyZXNzWzBdO1xyXG4gICAgICAgIG9iamVjdFJlZ2lzdHJhdGlvbi5hdXRob3Jpc2UgPSBtc2cuYm9keS5hdXRob3Jpc2U7XHJcbiAgICAgICAgb2JqZWN0UmVnaXN0cmF0aW9uLmNoaWxkcmVucyA9IGNoaWxkcmVucztcclxuXHJcbiAgICAgICAgLy9vYmplY3RSZWdpc3RyYXRpb24uZXhwaXJlcyA9IDMwOy8vVE9ETzogZ2V0IGl0IGZyb20gZGF0YSBvYmplY3QgY29uZmlndXJhdGlvbiBkZXNjcmlwdGlvbiB3aGVuIHByZXNlbnRcclxuXHJcbiAgICAgICAgZGVsZXRlIG9iamVjdFJlZ2lzdHJhdGlvbi5kYXRhO1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX25ld0NyZWF0ZV0gQUxMT0NBVE9SIENSRUFURTonLCBhbGxvY2F0ZWQpO1xyXG5cclxuICAgICAgICBsZXQgc3Vic2NyaXB0aW9uVVJMID0gb2JqZWN0UmVnaXN0cmF0aW9uLnVybCArICcvc3Vic2NyaXB0aW9uJztcclxuXHJcbiAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLl9uZXdDcmVhdGVdIFN1YnNjcmlwdGlvbiBVUkwnLCBzdWJzY3JpcHRpb25VUkwpO1xyXG5cclxuICAgICAgICAvL1RvIHJlZ2lzdGVyIHRoZSBkYXRhT2JqZWN0IGluIHRoZSBydW50aW1lUmVnaXN0cnlcclxuICAgICAgICBsb2cuaW5mbygnW1N5bmNoZXJNYW5hZ2VyLl9uZXdDcmVhdGVdIFJlZ2lzdGVyIE9iamVjdDogJywgb2JqZWN0UmVnaXN0cmF0aW9uKTtcclxuXHJcbiAgICAgICAgLy9fdGhpcy5fcmVnaXN0cnkucmVnaXN0ZXJEYXRhT2JqZWN0KG1zZy5ib2R5LnZhbHVlLm5hbWUsIG1zZy5ib2R5LnZhbHVlLnNjaGVtYSwgb2JqVVJMLCBtc2cuYm9keS52YWx1ZS5yZXBvcnRlciwgbXNnLmJvZHkudmFsdWUucmVzb3VyY2VzLCBhbGxvY2F0ZWQsIG1zZy5ib2R5LmF1dGhvcmlzZSkudGhlbigocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgIF90aGlzLl9yZWdpc3RyeS5yZWdpc3RlckRhdGFPYmplY3Qob2JqZWN0UmVnaXN0cmF0aW9uKS50aGVuKChyZWdpc3RlcmVkT2JqZWN0KSA9PiB7XHJcbiAgICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX25ld0NyZWF0ZV0gRGF0YU9iamVjdCBzdWNjZXNzZnVsbHkgcmVnaXN0ZXJlZCcsIHJlZ2lzdGVyZWRPYmplY3QpO1xyXG5cclxuICAgICAgICAgIC8vYWxsIE9LIC0+IGNyZWF0ZSByZXBvcnRlciBhbmQgcmVnaXN0ZXIgbGlzdGVuZXJzXHJcbiAgICAgICAgICBsZXQgcmVwb3J0ZXI7XHJcblxyXG5cclxuICAgICAgICAgIGlmICghdGhpcy5fcmVwb3J0ZXJzW29iamVjdFJlZ2lzdHJhdGlvbi51cmxdKSB7XHJcbiAgICAgICAgICAgIGxldCBvZmZsaW5lID0gb2JqZWN0UmVnaXN0cmF0aW9uLm9mZmxpbmUgPyBvYmplY3RSZWdpc3RyYXRpb24ub2ZmbGluZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICByZXBvcnRlciA9IG5ldyBSZXBvcnRlck9iamVjdChfdGhpcywgb3duZXIsIG9iamVjdFJlZ2lzdHJhdGlvbi51cmwsIGNoaWxkcmVucywgb2ZmbGluZSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXBvcnRlciA9IHRoaXMuX3JlcG9ydGVyc1tvYmplY3RSZWdpc3RyYXRpb24udXJsXTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIgLSBuZXcgQ3JlYXRlXSAtICcsIG1zZyk7XHJcblxyXG4gICAgICAgICAgLy8gU3RvcmUgZm9yIGVhY2ggcmVwb3J0ZXIgaHlwZXJ0eSB0aGUgZGF0YU9iamVjdFxyXG4gICAgICAgICAgbGV0IHVzZXJVUkw7XHJcbiAgICAgICAgICAvLyBsZXQgaW50ZXJ3b3JraW5nID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdpZGVudGl0eScpICYmIG1zZy5ib2R5LmlkZW50aXR5LnVzZXJQcm9maWxlICYmIG1zZy5ib2R5LmlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJVUkwpIHtcclxuICAgICAgICAgICAgdXNlclVSTCA9IG1zZy5ib2R5LmlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJVUkw7XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAoIXVzZXJVUkwuaW5jbHVkZXMoJ3VzZXI6Ly8nKSkge1xyXG4gICAgICAgICAgICAvLyAgIGludGVyd29ya2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHVzZXJVUkwgPSBfdGhpcy5fcmVnaXN0cnkuZ2V0SHlwZXJ0eU93bmVyKG1zZy5mcm9tKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGlmICghdXNlclVSTCkge1xyXG4gICAgICAgICAgICAvLyAgIGludGVyd29ya2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBzaG91bGQgd2UgdXNlIHRoZSBtc2cuYm9keS52YWx1ZSBpbnN0ZWFkP1xyXG5cclxuICAgICAgICAgIGxldCBtZXRhZGF0YSA9IGRlZXBDbG9uZShvYmplY3RSZWdpc3RyYXRpb24pO1xyXG4gICAgICAgICAgbWV0YWRhdGEuc3Vic2NyaWJlclVzZXIgPSB1c2VyVVJMO1xyXG4gICAgICAgICAgbWV0YWRhdGEuaXNSZXBvcnRlciA9IHRydWU7XHJcblxyXG4gICAgICAgICAgLy8gU3RvcmUgdGhlIGRhdGFPYmplY3QgaW5mb3JtYXRpb25cclxuXHJcbiAgICAgICAgICAvL2lmICghaW50ZXJ3b3JraW5nKSB7XHJcblxyXG4gICAgICAgICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdzdG9yZScpICYmIG1zZy5ib2R5LnN0b3JlKSB7XHJcbiAgICAgICAgICAgIHJlcG9ydGVyLmlzVG9TYXZlRGF0YSA9IHRydWU7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmlzVG9TYXZlRGF0YSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChtc2cuYm9keS52YWx1ZS5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgbWV0YWRhdGEuZGF0YSA9IGRlZXBDbG9uZShtc2cuYm9keS52YWx1ZS5kYXRhKTtcclxuLy8gICAgICAgICAgICAgIF90aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2Uuc2F2ZURhdGEodHJ1ZSwgb2JqZWN0UmVnaXN0cmF0aW9uLnVybCwgbnVsbCwgbXNnLmJvZHkudmFsdWUuZGF0YSk7IH1cclxuLy8gICAgICAgICAgICBfdGhpcy5fZGF0YU9iamVjdHNTdG9yYWdlLnVwZGF0ZSh0cnVlLCBvYmplY3RSZWdpc3RyYXRpb24udXJsLCAnaXNUb1NhdmVEYXRhJywgdHJ1ZSk7XHJcblxyXG4vLyAgICAgICAgICAgIGlmIChtc2cuYm9keS52YWx1ZS5kYXRhKSB7IF90aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2Uuc2F2ZURhdGEodHJ1ZSwgb2JqZWN0UmVnaXN0cmF0aW9uLnVybCwgbnVsbCwgbXNnLmJvZHkudmFsdWUuZGF0YSk7IH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgX3RoaXMuX2RhdGFPYmplY3RzU3RvcmFnZS5zZXQobWV0YWRhdGEpLnRoZW4oKHN0b3JlT2JqZWN0KSA9PiB7XHJcblxyXG4gICAgICAgICAgICBpZiAobWV0YWRhdGEub2ZmbGluZSkgeyAvL3JlZ2lzdGVyIG5ldyBEYXRhT2JqZWN0IGF0IE9mZmxpbmUgU3Vic2NyaXB0aW9uIE1hbmFnZXJcclxuICAgICAgICAgICAgICBtc2cuYm9keS5pZGVudGl0eS5ndWlkID0gX3RoaXMuX2lkZW50aXR5TW9kdWxlLl9pZGVudGl0aWVzLmd1aWQ7XHJcbiAgICAgICAgICAgICAgbGV0IGZvcndhcmQgPSB7XHJcbiAgICAgICAgICAgICAgICBmcm9tOiBtc2cudG8sXHJcbiAgICAgICAgICAgICAgICB0bzogbWV0YWRhdGEub2ZmbGluZSArICcvcmVnaXN0ZXInLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ2ZvcndhcmQnLFxyXG4gICAgICAgICAgICAgICAgYm9keTogbXNnXHJcbiAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgZm9yd2FyZC5ib2R5LmJvZHkucmVzb3VyY2UgPSBvYmplY3RSZWdpc3RyYXRpb24udXJsO1xyXG5cclxuICAgICAgICAgICAgICBmb3J3YXJkLmJvZHkuYm9keS52YWx1ZSA9IG1ldGFkYXRhO1xyXG5cclxuICAgICAgICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIubmV3Q3JlYXRlXSByZWdpc3RlcmluZyBuZXcgb2JqZWN0IGF0IG9mZmxpbmUgbWFuYWdlciAnLCBmb3J3YXJkKTtcclxuXHJcbiAgICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShmb3J3YXJkKTtcclxuXHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAvL31cclxuICAgICAgICAgIGxldCByZXNwb25zZU1zZyA9IHtcclxuICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogb3duZXIsXHJcbiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCByZXNvdXJjZTogb2JqZWN0UmVnaXN0cmF0aW9uLnVybCwgY2hpbGRyZW5SZXNvdXJjZXM6IGNoaWxkcmVucyB9XHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIC8vIGFkZGluZyBsaXN0ZW5lcnMgdG8gZm9yd2FyZCB0byByZXBvcnRlclxyXG5cclxuICAgICAgICAgIGlmIChkb21haW5Sb3V0aW5nKSB7XHJcblxyXG4gICAgICAgICAgICByZXBvcnRlci5mb3J3YXJkU3Vic2NyaWJlKFtvYmplY3RSZWdpc3RyYXRpb24udXJsLCBzdWJzY3JpcHRpb25VUkxdKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICByZXBvcnRlci5hZGRDaGlsZHJlbnMoKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqZWN0UmVnaXN0cmF0aW9uLnVybF0gPSByZXBvcnRlcjtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLy9GTE9XLU9VVDogbWVzc2FnZSByZXNwb25zZSB0byBTeW5jaGVyIC0+IGNyZWF0ZVxyXG4gICAgICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXNwb25zZU1zZyk7XHJcblxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlcG9ydGVyLmFkZENoaWxkcmVucygpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqZWN0UmVnaXN0cmF0aW9uLnVybF0gPSByZXBvcnRlcjtcclxuXHJcblxyXG4gICAgICAgICAgICAgIC8vRkxPVy1PVVQ6IG1lc3NhZ2UgcmVzcG9uc2UgdG8gU3luY2hlciAtPiBjcmVhdGVcclxuICAgICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlc3BvbnNlTXNnKTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIH0sIChlcnJvcik9PiB7XHJcbiAgICAgICAgICAgIGxvZy5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgbG9nLmVycm9yKGVycm9yKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0pO1xyXG4gICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAvL0ZMT1ctT1VUOiBlcnJvciBtZXNzYWdlIHJlc3BvbnNlIHRvIFN5bmNoZXIgLT4gY3JlYXRlXHJcbiAgICAgIGxldCByZXNwb25zZU1zZyA9IHtcclxuICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBvd25lcixcclxuICAgICAgICBib2R5OiB7IGNvZGU6IDUwMCwgZGVzYzogcmVhc29uIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVzcG9uc2VNc2cpO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgX3Jlc3VtZUNyZWF0ZShtc2csIHN0b3JlZE9iamVjdCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblxyXG4gICAgICBsZXQgb3duZXIgPSBtc2cuZnJvbTtcclxuICAgICAgbGV0IHNjaGVtYSA9IHN0b3JlZE9iamVjdC5zY2hlbWE7XHJcbiAgICAgIGxldCByZXNvdXJjZSA9IHN0b3JlZE9iamVjdC51cmw7XHJcbiAgICAgIGxldCBkb21haW5SZWdpc3RyYXRpb24gPSBzdG9yZWRPYmplY3QuaGFzT3duUHJvcGVydHkoJ2RvbWFpbl9yZWdpc3RyYXRpb24nKSA/IHN0b3JlZE9iamVjdC5kb21haW5fcmVnaXN0cmF0aW9uIDogdHJ1ZTtcclxuICAgICAgbGV0IGluaXRpYWxEYXRhID0gc3RvcmVkT2JqZWN0LmRhdGE7XHJcblxyXG4gICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXJdIC0gcmVzdW1lIGNyZWF0ZScsIG1zZywgc3RvcmVkT2JqZWN0KTtcclxuXHJcbiAgICAgIC8vZ2V0IHNjaGVtYSBmcm9tIGNhdGFsb2d1ZSBhbmQgcGFyc2UgLT4gKHNjaGVtZSwgY2hpbGRyZW4pXHJcbiAgICAgIF90aGlzLl9jYXRhbG9nLmdldERhdGFTY2hlbWFEZXNjcmlwdG9yKHNjaGVtYSkudGhlbigoZGVzY3JpcHRvcikgPT4ge1xyXG5cclxuICAgICAgICBsZXQgcHJvcGVydGllcyA9IGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlLnByb3BlcnRpZXM7XHJcbiAgICAgICAgbGV0IHNjaGVtZSA9IHByb3BlcnRpZXMuc2NoZW1lID8gcHJvcGVydGllcy5zY2hlbWUuY29uc3RhbnQgOiAncmVzb3VyY2UnO1xyXG4gICAgICAgIGxldCBjaGlsZHJlbnMgPSBwcm9wZXJ0aWVzLmNoaWxkcmVuID8gcHJvcGVydGllcy5jaGlsZHJlbi5jb25zdGFudCA6IFtdO1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXJdIC0gZ2V0RGF0YVNjaGVtYURlc2NyaXB0b3I6ICcsIGRlc2NyaXB0b3IsIGNoaWxkcmVucyk7XHJcblxyXG4gICAgICAgIC8vIERvIHNjaGVtYSB2YWxpZGF0aW9uXHJcbiAgICAgICAgLy8gVE9ETzogY2hlY2sgaWYgaXMgbmVlZCB0byBoYW5kbGUgd2l0aCB0aGUgcmVzdWx0IG9mIHZhbGlkYXRpb25cclxuICAgICAgICAvLyAgICAgICAgc2NoZW1hVmFsaWRhdGlvbihzY2hlbWUsIGRlc2NyaXB0b3IsIGluaXRpYWxEYXRhKTtcclxuXHJcblxyXG4gICAgICAgIC8vYWxsIE9LIC0+IGNyZWF0ZSByZXBvcnRlciBhbmQgcmVnaXN0ZXIgbGlzdGVuZXJzXHJcbiAgICAgICAgbGV0IHJlcG9ydGVyO1xyXG4gICAgICAgIGxldCBvZmZsaW5lO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuX3JlcG9ydGVyc1tyZXNvdXJjZV0pIHtcclxuICAgICAgICAgIG9mZmxpbmUgPSBzdG9yZWRPYmplY3Qub2ZmbGluZSA/IHN0b3JlZE9iamVjdC5vZmZsaW5lIDogZmFsc2U7XHJcbiAgICAgICAgICByZXBvcnRlciA9IG5ldyBSZXBvcnRlck9iamVjdChfdGhpcywgb3duZXIsIHJlc291cmNlLCBjaGlsZHJlbnMsIG9mZmxpbmUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXBvcnRlciA9IHRoaXMuX3JlcG9ydGVyc1tyZXNvdXJjZV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXBvcnRlci5pc1RvU2F2ZURhdGEgPSBzdG9yZWRPYmplY3QuaXNUb1NhdmVEYXRhO1xyXG5cclxuICAgICAgICBpZiAob2ZmbGluZSkgeyAvL3VwZGF0ZSBuZXcgRGF0YU9iamVjdCBhdCBPZmZsaW5lIFN1YnNjcmlwdGlvbiBNYW5hZ2VyXHJcbiAgICAgICAgICBsZXQgbXNnID0ge1xyXG4gICAgICAgICAgICBmcm9tOiBfdGhpcy5fdXJsLFxyXG4gICAgICAgICAgICB0bzogb2ZmbGluZSArICcvcmVnaXN0ZXInLFxyXG4gICAgICAgICAgICB0eXBlOiAndXBkYXRlJyxcclxuICAgICAgICAgICAgYm9keToge31cclxuICAgICAgICAgIH07XHJcbiAgXHJcbiAgICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX3Jlc3VtZUNyZWF0ZV0gdXBkYXRlIG9iamVjdCBhdCBvZmZsaW5lIG1hbmFnZXIgJywgbXNnKTtcclxuICBcclxuICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTtcclxuICBcclxuICBcclxuICAgICAgICB9XHJcbiAgXHJcblxyXG4gICAgICAgIGlmIChkb21haW5SZWdpc3RyYXRpb24pIHtcclxuICAgICAgICAgIHJlcG9ydGVyLmZvcndhcmRTdWJzY3JpYmUoW3N0b3JlZE9iamVjdC51cmxdKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLl9yZXN1bWVDcmVhdGVdIHJlc3VtaW5nUmVwb3J0ZXJTdWJzY3JpcHRpb24gJywgc3RvcmVkT2JqZWN0KTtcclxuICAgICAgICAgICAgX3RoaXMuX3Jlc3VtZVJlcG9ydGVyU3Vic2NyaXB0aW9ucyhtc2csIHN0b3JlZE9iamVjdCwgcmVwb3J0ZXIsIGNoaWxkcmVucywgZG9tYWluUmVnaXN0cmF0aW9uKS50aGVuKChyZXN1bWVPYmplY3QpPT57XHJcbiAgICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLl9yZXN1bWVDcmVhdGVdIHJlc29sdmVkIHJlc3VtZWQgb2JqZWN0ICcsIHJlc3VtZU9iamVjdCk7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bWVPYmplY3QpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHJlc29sdmUoX3RoaXMuX3Jlc3VtZVJlcG9ydGVyU3Vic2NyaXB0aW9ucyhtc2csIHN0b3JlZE9iamVjdCwgcmVwb3J0ZXIsIGNoaWxkcmVucywgZG9tYWluUmVnaXN0cmF0aW9uKSk7XHJcblxyXG4gICAgICAgIC8vICByZXNvbHZlKCk7XHJcbiAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICBsb2cuZXJyb3IoJ1tTeW5jaGVyTWFuYWdlciAtIHJlc3VtZSBjcmVhdGVdIC0gZmFpbCBvbiBnZXREYXRhU2NoZW1hRGVzY3JpcHRvcjogJywgcmVhc29uKTtcclxuICAgICAgICByZXNvbHZlKGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9yZXN1bWVSZXBvcnRlclN1YnNjcmlwdGlvbnMobXNnLCBzdG9yZWRPYmplY3QsIHJlcG9ydGVyLCBjaGlsZHJlbnMsIGRvbWFpblJlZ2lzdHJhdGlvbil7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgbGV0IHJlc291cmNlID0gc3RvcmVkT2JqZWN0LnVybDtcclxuICAgIGxldCBvYmplY3RSZWdpc3RyYXRpb24gPSBkZWVwQ2xvbmUobXNnLmJvZHkudmFsdWUpO1xyXG4gICAgb2JqZWN0UmVnaXN0cmF0aW9uLnVybCA9IHN0b3JlZE9iamVjdC51cmw7XHJcbiAgICBvYmplY3RSZWdpc3RyYXRpb24uZXhwaXJlcyA9IHN0b3JlZE9iamVjdC5leHBpcmVzO1xyXG4gICAgb2JqZWN0UmVnaXN0cmF0aW9uLmRvbWFpbl9yZWdpc3RyYXRpb24gPSBkb21haW5SZWdpc3RyYXRpb247XHJcblxyXG4gICAgZGVsZXRlIG9iamVjdFJlZ2lzdHJhdGlvbi5kYXRhO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG5cclxuXHJcbiAgICByZXBvcnRlci5hZGRDaGlsZHJlbnMoKS50aGVuKCgpID0+IHtcclxuXHJcbiAgICAgIHJlcG9ydGVyLnJlc3VtZVN1YnNjcmlwdGlvbnMoc3RvcmVkT2JqZWN0LnN1YnNjcmlwdGlvbnMpO1xyXG5cclxuICAgICAgX3RoaXMuX3JlcG9ydGVyc1tyZXNvdXJjZV0gPSByZXBvcnRlcjtcclxuXHJcbiAgICAgIGxvZy5pbmZvKCdbU3luY2hlck1hbmFnZXIgLSByZXN1bWUgY3JlYXRlXSAtIHJlc29sdmVkIHJlc3VtZWQ6ICcsIHN0b3JlZE9iamVjdCk7XHJcblxyXG4gICAgICByZXR1cm4gX3RoaXMuX2RlY3J5cHRDaGlsZHJlbnMoc3RvcmVkT2JqZWN0LCBjaGlsZHJlbnMpO1xyXG4gICAgfSkudGhlbigoZGVjcnlwdGVkT2JqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsb2cuaW5mbygnW1N5bmNoZXJNYW5hZ2VyLl9yZXN1bWVSZXBvcnRlclN1YnNjcmlwdGlvbnNdIFJlZ2lzdGVyIE9iamVjdDogJywgb2JqZWN0UmVnaXN0cmF0aW9uKTtcclxuICAgICAgX3RoaXMuX3JlZ2lzdHJ5LnJlZ2lzdGVyRGF0YU9iamVjdChvYmplY3RSZWdpc3RyYXRpb24pLnRoZW4oKHJlZ2lzdGVyZWQpID0+IHtcclxuICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX3Jlc3VtZVJlcG9ydGVyU3Vic2NyaXB0aW9uc10gRGF0YU9iamVjdCByZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bGx5IHVwZGF0ZWQnLCByZWdpc3RlcmVkKTtcclxuICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX3Jlc3VtZVJlcG9ydGVyU3Vic2NyaXB0aW9uc10gcmVzb2x2aW5nIG9iamVjdCcsIGRlY3J5cHRlZE9iamVjdCk7XHJcbiAgICAgICAgcmVzb2x2ZShkZWNyeXB0ZWRPYmplY3QpO1xyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBsb2cubG9nKCdyZXN1bHQgb2YgcHJldmlvdXMgcHJvbWlzZScpO1xyXG4gICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICBsb2cuZXJyb3IoJ1tTeW5jaGVyTWFuYWdlciAtIHJlc3VtZSBjcmVhdGVdIC0gZmFpbCBvbiBhZGRDaGlsZHJlbnM6ICcsIHJlYXNvbik7XHJcbiAgICAgIHJlc29sdmUoZmFsc2UpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLy8gdG8gZGVjcnlwdCBEYXRhQ2hpbGRPYmplY3RzIGlmIHRoZXkgYXJlIGVuY3J5cHRlZFxyXG5cclxuICBfZGVjcnlwdENoaWxkcmVucyhlbmNyeXB0ZWRPYmplY3QsIGNoaWxkcmVucykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgc3RvcmVkT2JqZWN0ID0gZGVlcENsb25lKGVuY3J5cHRlZE9iamVjdCk7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHJcbiAgICAgIGlmICghY2hpbGRyZW5zKSB7IHJlc29sdmUoc3RvcmVkT2JqZWN0KTsgfSBlbHNlIHtcclxuICAgICAgICBsZXQgY2hpbGRyZW5zT2JqID0gT2JqZWN0LmtleXMoc3RvcmVkT2JqZWN0LmNoaWxkcmVuT2JqZWN0cyk7XHJcblxyXG4gICAgICAgIGlmIChjaGlsZHJlbnNPYmoubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICByZXNvbHZlKHN0b3JlZE9iamVjdCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjaGlsZHJlbnMuZm9yRWFjaCgoY2hpbGRyZW4pID0+IHtcclxuXHJcbi8vICAgICAgICAgIGxldCBjaGlsZE9iamVjdHMgPSBzdG9yZWRPYmplY3QuY2hpbGRyZW5PYmplY3RzW2NoaWxkcmVuXTtcclxuICAgICAgICAgIGxldCBjaGlsZE9iamVjdHMgPSBzdG9yZWRPYmplY3QuY2hpbGRyZW5PYmplY3RzO1xyXG5cclxuICAgICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5fZGVjcnlwdENoaWxkcmVuc10gZGF0YU9iamVjdENoaWxkcyB0byBkZWNyeXB0ICcsIGNoaWxkT2JqZWN0cyk7XHJcblxyXG4gICAgICAgICAgbGV0IGxpc3RPZkRlY3J5cHRlZE9iamVjdHMgPSBbXTtcclxuXHJcbiAgICAgICAgICBPYmplY3Qua2V5cyhjaGlsZE9iamVjdHMpLmZvckVhY2goKGNoaWxkSWQpID0+IHtcclxuICAgICAgICAgICAgbGV0IGNoaWxkID0gY2hpbGRPYmplY3RzW2NoaWxkSWRdO1xyXG4gICAgICAgICAgICBsZXQgb3duZXIgPSBjaGlsZElkLnNwbGl0KCcjJylbMF07XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNoaWxkLnZhbHVlID09PSAnc3RyaW5nJykge1xyXG5cclxuICAgICAgICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX2RlY3J5cHRDaGlsZHJlbnNdIGNyZWF0ZWRCeSAnLCBvd25lciwgJyBvYmplY3Q6ICcsIGNoaWxkLnZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgbGV0IGRlY3J5cHRlZCA9IGNyeXB0b01hbmFnZXIuZGVmYXVsdC5kZWNyeXB0RGF0YU9iamVjdChKU09OLnBhcnNlKGNoaWxkLnZhbHVlKSwgc3RvcmVkT2JqZWN0LnVybCk7XHJcblxyXG4gICAgICAgICAgICAgIGxpc3RPZkRlY3J5cHRlZE9iamVjdHMucHVzaChkZWNyeXB0ZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBQcm9taXNlLmFsbChsaXN0T2ZEZWNyeXB0ZWRPYmplY3RzKS50aGVuKChkZWNyeXB0ZWRPYmplY3RzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX2RlY3J5cHRDaGlsZHJlbnNdIHJldHVybmluZyBkZWNyeXB0ZWQgJywgZGVjcnlwdGVkT2JqZWN0cyk7XHJcblxyXG4gICAgICAgICAgICBkZWNyeXB0ZWRPYmplY3RzLmZvckVhY2goKGRlY3J5cHRlZE9iamVjdCkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGNoaWxkSWQgPSBkZWNyeXB0ZWRPYmplY3QudmFsdWUudXJsO1xyXG4gICAgICAgICAgICAgIHN0b3JlZE9iamVjdC5jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0udmFsdWUgPSBkZWNyeXB0ZWRPYmplY3QudmFsdWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyLl9kZWNyeXB0Q2hpbGRyZW5zXSBzdG9yZWRPYmplY3QgJywgc3RvcmVkT2JqZWN0KTtcclxuXHJcbiAgICAgICAgICAgIHJlc29sdmUoc3RvcmVkT2JqZWN0KTtcclxuXHJcbiAgICAgICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICAgIGxvZy53YXJuKCdbU3luY2hlck1hbmFnZXIuX2RlY3J5cHRDaGlsZHJlbnNdIGZhaWxlZCA6ICcsIHJlYXNvbik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQcm9jZXNzIGludml0YXRpb25zIHRvIG9ic2VydmVyc1xyXG5cclxuICBfYXV0aG9yaXNlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBpZiAoIW1zZy5ib2R5LnJlc291cmNlKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1N5bmNoZXJNYW5hZ2VyLl9hdXRob3Jpc2VdIGludml0YXRpb24gcmVxdWVzdCB3aXRob3V0IGRhdGEgb2JqZWN0IHVybDonLCBtc2cpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBvYmpTdWJzY3JpcHRvclVSTCA9IG1zZy5ib2R5LnJlc291cmNlICsgJy9zdWJzY3JpcHRpb24nO1xyXG4gICAgbGV0IHAycCA9IG1zZy5ib2R5LnAycCA/IG1zZy5ib2R5LnAycCA6IGZhbHNlO1xyXG5cclxuICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlciAtICBhdXRob3Jpc2VdIC0gJywgbXNnKTtcclxuXHJcbiAgICBpZiAobXNnLmJvZHkuYXV0aG9yaXNlKSB7XHJcbiAgICAgIG1zZy5ib2R5LmF1dGhvcmlzZS5mb3JFYWNoKChoeXBlcnR5VVJMKSA9PiB7XHJcbiAgICAgICAgLy9GTE9XLU9VVDogc2VuZCBpbnZpdGVzIHRvIGxpc3Qgb2YgcmVtb3RlIFN5bmNoZXIgLT4gX29uUmVtb3RlQ3JlYXRlIC0+IG9uTm90aWZpY2F0aW9uXHJcblxyXG4gICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IG9ialN1YnNjcmlwdG9yVVJMLCB0bzogaHlwZXJ0eVVSTCxcclxuICAgICAgICAgIGJvZHk6IHsgcDJwOiBwMnAsIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwgc291cmNlOiBtc2cuZnJvbSwgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLCBzY2hlbWE6IG1zZy5ib2R5LnNjaGVtYSB9XHJcbiAgICAgICAgfSwgKHJlcGx5KSA9PiB7IC8vIGxldHMgZm9yd2FyZCB0aGUgaW52aXRhdGlvbiByZXNwb25zZVxyXG4gICAgICAgICAgbGV0IHJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgICBmcm9tOiBtc2cudG8sXHJcbiAgICAgICAgICAgIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICAgICAgaWQ6IG1zZy5pZCxcclxuICAgICAgICAgICAgdHlwZTogcmVwbHkudHlwZSxcclxuICAgICAgICAgICAgYm9keTogcmVwbHkuYm9keVxyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlc3BvbnNlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlXHJcbiAgX29uRGVsZXRlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgb2JqVVJMID0gbXNnLmJvZHkucmVzb3VyY2U7XHJcblxyXG4gICAgbGV0IG9iamVjdCA9IF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXTtcclxuICAgIGlmIChvYmplY3QpIHtcclxuICAgICAgLy9UT0RPOiBpcyB0aGVyZSBhbnkgcG9saWN5IHZlcmlmaWNhdGlvbiBiZWZvcmUgZGVsZXRlP1xyXG5cclxuICAgICAgaWYgKG9iamVjdC5vZmZsaW5lKSB7IC8vcmVnaXN0ZXIgbmV3IERhdGFPYmplY3QgYXQgT2ZmbGluZSBTdWJzY3JpcHRpb24gTWFuYWdlclxyXG4gICAgICAgIGxldCBmb3J3YXJkID0ge1xyXG4gICAgICAgICAgZnJvbTogbXNnLnRvLFxyXG4gICAgICAgICAgdG86IG9iamVjdC5vZmZsaW5lICsgJy9yZWdpc3RlcicsXHJcbiAgICAgICAgICB0eXBlOiAnZm9yd2FyZCcsXHJcbiAgICAgICAgICBib2R5OiBtc2dcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX29uRGVsZXRlXSB1bnJlZ2lzdGVyaW5nIG9iamVjdCBmcm9tIG9mZmxpbmUgbWFuYWdlciAnLCBmb3J3YXJkKTtcclxuXHJcbiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShmb3J3YXJkKTtcclxuXHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICBvYmplY3QuZGVsZXRlKCk7XHJcblxyXG4gICAgICB0aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2UuZGVsZXRlUmVzb3VyY2Uob2JqVVJMKS50aGVuKChyZXN1bHQpID0+IHtcclxuXHJcblxyXG4gICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlciAtIG9uRGVsZXRlXSAtIGRlbGV0ZVJlc291cmNlOiAnLCByZXN1bHQpO1xyXG5cclxuICAgICAgICBfdGhpcy5fcmVnaXN0cnkudW5yZWdpc3RlckRhdGFPYmplY3Qob2JqVVJMKTtcclxuXHJcblxyXG4gICAgICAgIC8vVE9ETzogdW5yZWdpc3RlciBvYmplY3Q/XHJcbiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBsb2NhbCBTeW5jaGVyIC0+IHN1YnNjcmliZVxyXG4gIF9vbkxvY2FsU3Vic2NyaWJlKG1zZykge1xyXG4gICAgLy9kZWJ1Z2dlcjtcclxuXHJcbiAgICBpZiAobXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ3Jlc3VtZScpICYmIChtc2cuYm9keS5yZXN1bWUgKSkge1xyXG4gICAgICB0aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2UuZ2V0UmVzb3VyY2VzQnlDcml0ZXJpYShtc2csIGZhbHNlKS50aGVuKChyZXN1bHQpID0+IHtcclxuXHJcbiAgICAgICAgbG9nLmluZm8oJ1tTeW5jaGVyTWFuYWdlci5vbkxvY2FsU3Vic2NyaWJlLiByZXN1bWVdOiAnLCBtc2csICcgcmVzdWx0OiAnLCByZXN1bHQpO1xyXG4gIFxyXG4gICAgICAgIGlmIChyZXN1bHQgJiYgT2JqZWN0LmtleXMocmVzdWx0KS5sZW5ndGggPiAwKSB7XHJcbiAgXHJcbiAgICAgICAgICBsZXQgbGlzdE9mT2JzZXJ2ZXJzID0gW107XHJcbiAgXHJcbiAgICAgICAgICAvLyBUT0RPOiBzaG91bGQgcmV1c2UgdGhlIHN0b3JlZCBpbmZvcm1hdGlvblxyXG4gICAgICAgICAgT2JqZWN0LmtleXMocmVzdWx0KS5mb3JFYWNoKChvYmpVUkwpID0+IHtcclxuICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyIC0gcmVzdW1lIFN1YnNjcmliZV0gLSByZXVzZSBjdXJyZW50IG9iamVjdCB1cmw6ICcsIHJlc3VsdFtvYmpVUkxdKTtcclxuICAgICAgICAgICAgbGlzdE9mT2JzZXJ2ZXJzLnB1c2godGhpcy5fcmVzdW1lU3Vic2NyaXB0aW9uKG1zZywgcmVzdWx0W29ialVSTF0pKTtcclxuICAgICAgICAgIH0pO1xyXG4gIFxyXG4gICAgICAgICAgUHJvbWlzZS5hbGwobGlzdE9mT2JzZXJ2ZXJzKS50aGVuKChyZXN1bWVkT2JzZXJ2ZXJzKSA9PiB7XHJcbiAgICAgICAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlciAtIE9ic2VydmVycyBSZXN1bWVkXScsIHJlc3VtZWRPYnNlcnZlcnMpO1xyXG4gIFxyXG4gICAgICAgICAgICAvLyBUT0RPOiBzaG91ZCBzZW5kIHRoZSBpbmZvcm1hdGlvbiBpZiBzb21lIG9iamVjdCBpcyBmYWlsaW5nO1xyXG4gICAgICAgICAgICBsZXQgc3VjY2Vzc2Z1bGx5UmVzdW1lZCA9IE9iamVjdC52YWx1ZXMocmVzdW1lZE9ic2VydmVycykuZmlsdGVyKChvYnNlcnZlcikgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlciAhPT0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gIFxyXG4gICAgICAgICAgICBsZXQgcmVzcG9uc2UgPSB7XHJcbiAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sXHJcbiAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHZhbHVlOiBzdWNjZXNzZnVsbHlSZXN1bWVkIH1cclxuICAgICAgICAgICAgfTtcclxuICBcclxuICAgICAgICAgICAgbG9nLmxvZygnW1N5bmNoZXJNYW5hZ2VyIC0gT2JzZXJ2ZXJzIFJlc3VtZWRdIHJlcGx5aW5nICcsIHJlc3BvbnNlKTtcclxuICBcclxuICAgICAgICAgICAgLy9GTE9XLU9VVDogbWVzc2FnZSByZXNwb25zZSB0byBTeW5jaGVyIC0+IGNyZWF0ZVxyXG4gICAgICAgICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UocmVzcG9uc2UpO1xyXG4gIFxyXG4gICAgICAgICAgfSk7XHJcbiAgXHJcbiAgICAgICBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy9mb3J3YXJkIHRvIGh5cGVydHk6XHJcbiAgICAgICAgICBsZXQgcmVwbHkgPSB7fTtcclxuICAgICAgICAgIHJlcGx5LmlkID0gbXNnLmlkO1xyXG4gICAgICAgICAgcmVwbHkuZnJvbSA9IG1zZy50bztcclxuICAgICAgICAgIHJlcGx5LnRvID0gbXNnLmZyb207XHJcbiAgICAgICAgICByZXBseS50eXBlID0gJ3Jlc3BvbnNlJztcclxuICAgICAgICAgIHJlcGx5LmJvZHkgPSB7XHJcbiAgICAgICAgICAgIGNvZGU6IDQwNCxcclxuICAgICAgICAgICAgZGVzYzogJ05vIGRhdGEgb2JqZWN0cyBvYnNlcnZlcnMgdG8gYmUgcmVzdW1lZCdcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UocmVwbHkpO1xyXG4gICAgICAgIH1cclxuICBcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIub25Mb2NhbFN1YnNjcmliZSAtIG5ldyBTdWJzY3JpYmVdIC0gJywgbXNnLmJvZHkuc2NoZW1hLCBtc2cuYm9keS5yZXNvdXJjZSk7XHJcbiAgICAgIHRoaXMuX25ld1N1YnNjcmlwdGlvbihtc2cpO1xyXG4gICAgfVxyXG4gXHJcblxyXG4gIH1cclxuXHJcbiAgX25ld1N1YnNjcmlwdGlvbihtc2cpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgbGV0IG9ialVSTCA9IG1zZy5ib2R5LnJlc291cmNlO1xyXG5cclxuICAgIGxldCBoeXBlcnR5VVJMID0gbXNnLmZyb207XHJcbiAgICBsZXQgZG9tYWluID0gZGl2aWRlVVJMKG9ialVSTCkuZG9tYWluO1xyXG4gICAgbGV0IGRvbWFpblN1YnNjcmlwdGlvbiA9IG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdkb21haW5fc3Vic2NyaXB0aW9uJykgPyBtc2cuYm9keS5kb21haW5fc3Vic2NyaXB0aW9uIDogdHJ1ZTtcclxuXHJcbiAgICBsZXQgY2hpbGRCYXNlVVJMID0gb2JqVVJMICsgJy9jaGlsZHJlbi8nO1xyXG5cclxuICAgIC8vZ2V0IHNjaGVtYSBmcm9tIGNhdGFsb2d1ZSBhbmQgcGFyc2UgLT4gKGNoaWxkcmVuKVxyXG4gICAgX3RoaXMuX2NhdGFsb2cuZ2V0RGF0YVNjaGVtYURlc2NyaXB0b3IobXNnLmJvZHkuc2NoZW1hKS50aGVuKChkZXNjcmlwdG9yKSA9PiB7XHJcbiAgICAgIGxldCBwcm9wZXJ0aWVzID0gZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUucHJvcGVydGllcztcclxuICAgICAgbGV0IGNoaWxkcmVucyA9IHByb3BlcnRpZXMuY2hpbGRyZW4gPyBwcm9wZXJ0aWVzLmNoaWxkcmVuLmNvbnN0YW50IDogW107XHJcblxyXG4gICAgICBsZXQgc3Vic2NyaXB0aW9ucyA9IFtdO1xyXG4gICAgICBzdWJzY3JpcHRpb25zLnB1c2gob2JqVVJMICsgJy9jaGFuZ2VzJyk7XHJcblxyXG4vLyAgICAgIGNoaWxkcmVucy5mb3JFYWNoKChjaGlsZCkgPT4gc3Vic2NyaXB0aW9ucy5wdXNoKGNoaWxkQmFzZVVSTCArIGNoaWxkKSk7XHJcbiAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChjaGlsZEJhc2VVUkwpO1xyXG5cclxuICAgICAgLy9jaGlsZHJlbiBhZGRyZXNzZXNcclxuXHJcbiAgICAgIGlmIChkb21haW5TdWJzY3JpcHRpb24pIHsgIC8vRkxPVy1PVVQ6IHN1YnNjcmliZSBtZXNzYWdlIHRvIHRoZSBtc2ctbm9kZSwgcmVnaXN0ZXJpbmcgbGlzdGVuZXJzIG9uIHRoZSBicm9rZXJcclxuICAgICAgbGV0IG5vZGVTdWJzY3JpYmVNc2cgPSB7XHJcbiAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl91cmwsIHRvOiAnZG9tYWluOi8vbXNnLW5vZGUuJyArIGRvbWFpbiArICcvc20nLFxyXG4gICAgICAgIGJvZHk6IHsgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LCByZXNvdXJjZXM6IHN1YnNjcmlwdGlvbnMsIHNvdXJjZTogaHlwZXJ0eVVSTCB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvL3N1YnNjcmliZSBpbiBtc2ctbm9kZVxyXG4gICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG5vZGVTdWJzY3JpYmVNc2csIChyZXBseSkgPT4ge1xyXG4gICAgICAgIGxvZy5sb2coJ25vZGUtc3Vic2NyaWJlLXJlc3BvbnNlKG9ic2VydmVyKTogJywgcmVwbHkpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdSRVVTRVRFU1QgU3luY2hlck1hbmFnZXIgLSBub2RlLXN1YnNjcmliZS1yZXNwb25zZShvYnNlcnZlcik6ICcsIHJlcGx5KTtcclxuICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHtcclxuICAgICAgICAgIF90aGlzLl9uZXdSZXBvcnRlclN1YnNjcmliZShtc2csIGh5cGVydHlVUkwsIG9ialVSTCwgY2hpbGRyZW5zKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy9saXN0ZW5lciByZWplY3RlZFxyXG4gICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IGh5cGVydHlVUkwsXHJcbiAgICAgICAgICAgIGJvZHk6IHJlcGx5LmJvZHlcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgX3RoaXMuX25ld1JlcG9ydGVyU3Vic2NyaWJlKG1zZywgaHlwZXJ0eVVSTCwgb2JqVVJMLCBjaGlsZHJlbnMpO1xyXG5cclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBfbmV3UmVwb3J0ZXJTdWJzY3JpYmUobXNnLCBoeXBlcnR5VVJMLCBvYmpVUkwsIGNoaWxkcmVucyl7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgb2JqVVJMU3Vic2NyaXB0aW9uID0gb2JqVVJMICsgJy9zdWJzY3JpcHRpb24nO1xyXG5cclxuICAgICAgICAgIC8vRkxPVy1PVVQ6IHJlcGx5IHdpdGggcHJvdmlzaW9uYWwgcmVzcG9uc2VcclxuICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBoeXBlcnR5VVJMLFxyXG4gICAgICAgICAgICBib2R5OiB7IGNvZGU6IDEwMCwgY2hpbGRyZW5SZXNvdXJjZXM6IGNoaWxkcmVucywgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsIHJlc291cmNlOiBtc2cuYm9keS5yZXNvdXJjZSB9XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAvL0ZMT1ctT1VUOiBzdWJzY3JpYmUgbWVzc2FnZSB0byByZW1vdGUgUmVwb3J0ZXJPYmplY3QgLT4gX29uUmVtb3RlU3Vic2NyaWJlXHJcbiAgICAgICAgICBsZXQgb2JqU3Vic2NyaWJlTXNnID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAnc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX3VybCwgdG86IG9ialVSTFN1YnNjcmlwdGlvbixcclxuICAgICAgICAgICAgYm9keTogeyBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksIHN1YnNjcmliZXI6IGh5cGVydHlVUkwgfVxyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5XHJcbiAgICAgICAgICBpZiAobXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ211dHVhbCcpKSBvYmpTdWJzY3JpYmVNc2cuYm9keS5tdXR1YWwgPSBtc2cuYm9keS5tdXR1YWw7XHJcbiAgICAgICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX25ld1N1YnNjcmlwdGlvbl0nLCBvYmpTdWJzY3JpYmVNc2csIG1zZyk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnUkVVU0VURVNUIFN5bmNoZXJNYW5hZ2VyIC0gW1N5bmNoZXJNYW5hZ2VyLl9uZXdTdWJzY3JpcHRpb25dJywgb2JqU3Vic2NyaWJlTXNnLCBtc2cpO1xyXG4gICAgICAgICAgLy9zdWJzY3JpYmUgdG8gcmVwb3J0ZXIgU01cclxuICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uob2JqU3Vic2NyaWJlTXNnLCAocmVwbHkpID0+IHtcclxuICAgICAgICAgICAgbG9nLmxvZygncmVwb3J0ZXItc3Vic2NyaWJlLXJlc3BvbnNlLW5ldzogJywgcmVwbHkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUkVVU0VURVNUIFN5bmNoZXJNYW5hZ2VyIC0gcmVwb3J0ZXItc3Vic2NyaWJlLXJlc3BvbnNlLW5ldzogJywgcmVwbHkpO1xyXG4gICAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIF90aGlzLl9wcm9jZXNzU3VjY2Vzc2Z1bGxTdWJzY3JpcHRpb24ocmVwbHksIGh5cGVydHlVUkwsIG9ialVSTCwgY2hpbGRyZW5zLCBtc2cpO1xyXG4gICAgICAgICAgICBlbHNlIGlmIChtc2cuYm9keS5vZmZsaW5lKSBfdGhpcy5fcHJvY2Vzc09mZmxpbmVTdWJzY3JpcHRpb24ob2JqU3Vic2NyaWJlTXNnLCBtc2cuYm9keS5vZmZsaW5lLCBoeXBlcnR5VVJMLCBvYmpVUkwsIGNoaWxkcmVucywgbXNnKTtcclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy9UT0RPOiBzZW5kIHJlc3BvbnNlIGJhY2sgdG8gSHlwZXJ0eSB3aXRoIGVycm9yIG1lc3NhZ2UgcmVjZWl2ZWQgaW4gdGhlIHJlcGx5XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3Byb2Nlc3NPZmZsaW5lU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbiwgcmVkaXJlY3RUbywgaHlwZXJ0eVVSTCwgb2JqVVJMLCBjaGlsZHJlbnMsIG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgZm9yd2FyZCA9IHtcclxuICAgICAgZnJvbTogc3Vic2NyaXB0aW9uLmZyb20sXHJcbiAgICAgIHR5cGU6ICdmb3J3YXJkJyxcclxuICAgICAgdG86IHJlZGlyZWN0VG8sXHJcbiAgICAgIGJvZHk6IHN1YnNjcmlwdGlvblxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnW1N5bmNoZXJNYW5hZ2VyLl9wcm9jZXNzT2ZmbGluZVN1YnNjcmlwdGlvbl0gZm9yd2FkaW5nICcsIGZvcndhcmQpO1xyXG5cclxuICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZm9yd2FyZCwgKHJlcGx5KSA9PiB7XHJcbiAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlci5fcHJvY2Vzc09mZmxpbmVTdWJzY3JpcHRpb25dIHJlcGx5ICcsIHJlcGx5KTtcclxuICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSBfdGhpcy5fcHJvY2Vzc1N1Y2Nlc3NmdWxsU3Vic2NyaXB0aW9uKHJlcGx5LCBoeXBlcnR5VVJMLCBvYmpVUkwsIGNoaWxkcmVucywgbXNnKTtcclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgLy9UT0RPOiBzZW5kIHJlc3BvbnNlIGJhY2sgdG8gSHlwZXJ0eSB3aXRoIGVycm9yIG1lc3NhZ2UgcmVjZWl2ZWQgaW4gdGhlIHJlcGx5XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgfVxyXG5cclxuICBfcHJvY2Vzc1N1Y2Nlc3NmdWxsU3Vic2NyaXB0aW9uKHJlcGx5LCBoeXBlcnR5VVJMLCBvYmpVUkwsIGNoaWxkcmVucywgbXNnKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX25ld1N1YnNjcmlwdGlvbl0gLSBvYnNlcnZlcnM6ICcsIF90aGlzLl9vYnNlcnZlcnMsIG9ialVSTCwgX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdKTtcclxuICAgIGNvbnNvbGUubG9nKCdSRVVTRVRFU1QgU3luY2hlck1hbmFnZXIgLSAyMDAgY29kZVtTeW5jaGVyTWFuYWdlci5fbmV3U3Vic2NyaXB0aW9uXSAtIG9ic2VydmVyczogJywgX3RoaXMuX29ic2VydmVycywgb2JqVVJMLCBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0pO1xyXG4gICAgbGV0IG9ic2VydmVyID0gX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdO1xyXG4gICAgaWYgKCFvYnNlcnZlcikge1xyXG4gICAgICBvYnNlcnZlciA9IG5ldyBPYnNlcnZlck9iamVjdChfdGhpcywgb2JqVVJMLCBjaGlsZHJlbnMpO1xyXG4gICAgICBsb2cubG9nKCdbU3luY2hlck1hbmFnZXIuX25ld1N1YnNjcmlwdGlvbl0gLSBvYnNlcnZlcnM6IGNyZWF0ZSBuZXcgT2JzZXJ2ZXJPYmplY3Q6ICcsIG9ic2VydmVyKTtcclxuICAgICAgX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdID0gb2JzZXJ2ZXI7XHJcblxyXG4gICAgICAvLyByZWdpc3RlciBuZXcgaHlwZXJ0eSBzdWJzY3JpcHRpb25cclxuICAgICAgb2JzZXJ2ZXIuYWRkU3Vic2NyaXB0aW9uKGh5cGVydHlVUkwpO1xyXG5cclxuICAgICAgLy8gYWRkIGNoaWxkcmVucyBhbmQgbGlzdGVuZXJzIHRvIHNhdmUgZGF0YSBpZiBuZWNlc3NhcnlcclxuICAgICAgb2JzZXJ2ZXIuYWRkQ2hpbGRyZW5zKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGludGVyd29ya2luZyA9IGZhbHNlO1xyXG5cclxuICAgIC8vZGVidWdnZXI7XHJcblxyXG4gICAgLy8gU3RvcmUgZm9yIGVhY2ggcmVwb3J0ZXIgaHlwZXJ0eSB0aGUgZGF0YU9iamVjdFxyXG4gICAgbGV0IHVzZXJVUkw7XHJcbiAgICBpZiAobXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ2lkZW50aXR5JykgJiYgbXNnLmJvZHkuaWRlbnRpdHkudXNlclByb2ZpbGUgJiYgbXNnLmJvZHkuaWRlbnRpdHkudXNlclByb2ZpbGUudXNlclVSTCkge1xyXG4gICAgICB1c2VyVVJMID0gbXNnLmJvZHkuaWRlbnRpdHkudXNlclByb2ZpbGUudXNlclVSTDtcclxuICAgICAgaWYgKCF1c2VyVVJMLmluY2x1ZGVzKCd1c2VyOi8vJykpIHtcclxuICAgICAgICBpbnRlcndvcmtpbmcgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB1c2VyVVJMID0gX3RoaXMuX3JlZ2lzdHJ5LmdldEh5cGVydHlPd25lcihtc2cuZnJvbSk7XHJcbiAgICAgIGlmICghdXNlclVSTCkgaW50ZXJ3b3JraW5nID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbWV0YWRhdGEgPSBkZWVwQ2xvbmUocmVwbHkuYm9keS52YWx1ZSk7XHJcblxyXG4gICAgLy8gbGV0IGNoaWxkcmVuT2JqZWN0cyA9IG1ldGFkYXRhLmNoaWxkcmVuT2JqZWN0cyB8fCB7fTtcclxuXHJcbiAgICBkZWxldGUgbWV0YWRhdGEuZGF0YTtcclxuICAgIGRlbGV0ZSBtZXRhZGF0YS5jaGlsZHJlbk9iamVjdHM7XHJcblxyXG4gICAgbWV0YWRhdGEuY2hpbGRyZW5zID0gY2hpbGRyZW5zO1xyXG4gICAgbWV0YWRhdGEuc3Vic2NyaWJlclVzZXIgPSB1c2VyVVJMO1xyXG4gICAgbWV0YWRhdGEuaXNSZXBvcnRlciA9IGZhbHNlO1xyXG4gICAgbWV0YWRhdGEuc3Vic2NyaWJlckh5cGVydHkgPSBoeXBlcnR5VVJMO1xyXG5cclxuICAgIGlmICghaW50ZXJ3b3JraW5nKSB7XHJcbiAgICAgIC8vX3RoaXMuX2RhdGFPYmplY3RzU3RvcmFnZS5zZXQob2JqVVJMLCBmYWxzZSwgbXNnLmJvZHkuc2NoZW1hLCAnb24nLCByZXBseS5ib2R5Lm93bmVyLCBoeXBlcnR5VVJMLCBjaGlsZHJlbnMsIHVzZXJVUkwpO1xyXG4gICAgICBfdGhpcy5fZGF0YU9iamVjdHNTdG9yYWdlLnNldChtZXRhZGF0YSk7XHJcbiAgICAgIGlmICgobWV0YWRhdGEuaGFzT3duUHJvcGVydHkoJ3N0b3JlJykgJiYgbWV0YWRhdGEuc3RvcmUpIHx8IChtZXRhZGF0YS5oYXNPd25Qcm9wZXJ0eSgnaXNUb1NhdmVEYXRhJykgJiYgbWV0YWRhdGEuaXNUb1NhdmVEYXRhKSkge1xyXG4gICAgICAgIG9ic2VydmVyLmlzVG9TYXZlRGF0YSA9IHRydWU7XHJcbiAgICAgICAgX3RoaXMuX2RhdGFPYmplY3RzU3RvcmFnZS51cGRhdGUoZmFsc2UsIG9ialVSTCwgJ2lzVG9TYXZlRGF0YScsIHRydWUpO1xyXG4gICAgICAgIF90aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2Uuc2F2ZURhdGEoZmFsc2UsIG9ialVSTCwgbnVsbCwgcmVwbHkuYm9keS52YWx1ZS5kYXRhKTtcclxuLy8gICAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW5zKSBfdGhpcy5fZGF0YU9iamVjdHNTdG9yYWdlLmluaXRpYWxPYnNlcnZlclN5bmMob2JqVVJMLCByZXBseS5ib2R5LnZhbHVlLmRhdGEuYmFja3VwUmV2aXNpb24pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy9mb3J3YXJkIHRvIGh5cGVydHk6XHJcbiAgICByZXBseS5pZCA9IG1zZy5pZDtcclxuICAgIHJlcGx5LmZyb20gPSBfdGhpcy5fdXJsO1xyXG4gICAgcmVwbHkudG8gPSBoeXBlcnR5VVJMO1xyXG4gICAgcmVwbHkuYm9keS5zY2hlbWEgPSBtc2cuYm9keS5zY2hlbWE7XHJcbiAgICByZXBseS5ib2R5LnJlc291cmNlID0gbXNnLmJvZHkucmVzb3VyY2U7XHJcblxyXG4gICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeVxyXG4gICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdtdXR1YWwnKSkgcmVwbHkuYm9keS5tdXR1YWwgPSBtc2cuYm9keS5tdXR1YWw7XHJcbiAgICBsb2cubG9nKCdbc3Vic2NyaWJlXSAtIG5ldyBzdWJzY3JpcHRpb246ICcsIG1zZywgcmVwbHksIG9ic2VydmVyKTtcclxuXHJcbiAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UocmVwbHkpO1xyXG5cclxuICB9XHJcblxyXG4gIF9yZXN1bWVTdWJzY3JpcHRpb24obXNnLCBzdG9yZWRPYmplY3QpIHtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHJcbiAgICAgIGxldCBvYmpVUkwgPSBzdG9yZWRPYmplY3QudXJsO1xyXG4gICAgICBsZXQgc2NoZW1hID0gc3RvcmVkT2JqZWN0LnNjaGVtYTtcclxuXHJcbiAgICAgIGxldCBoeXBlcnR5VVJMID0gbXNnLmZyb207XHJcblxyXG4gICAgICAvLyBsZXQgb2JqVVJMU3Vic2NyaXB0aW9uID0gb2JqVVJMICsgJy9zdWJzY3JpcHRpb24nO1xyXG5cclxuICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IG9ialVSTCArICcvY2hpbGRyZW4vJztcclxuXHJcbiAgICAgIGxvZy5sb2coJ1tTeW5jaGVyTWFuYWdlciAtIFJldXNlU3Vic2NyaXB0aW9uXSAtIG9ialVSTDogJywgb2JqVVJMLCAnIC0gc2NoZW1hOicsIHNjaGVtYSk7XHJcblxyXG4gICAgICAvL2dldCBzY2hlbWEgZnJvbSBjYXRhbG9ndWUgYW5kIHBhcnNlIC0+IChjaGlsZHJlbilcclxuICAgICAgLy8gVE9ETzogcmVtb3ZlIHRoaXMgc2luY2UgY2hpbGRyZW4gcmVzb3VyY2VzIHNob3VsZCBiZSBhdmFpbGFibGUgaW4gdGhlIERhdGFPYmplY3RzU3RvcmFnZVxyXG4gICAgICB0aGlzLl9jYXRhbG9nLmdldERhdGFTY2hlbWFEZXNjcmlwdG9yKHNjaGVtYSkudGhlbigoZGVzY3JpcHRvcikgPT4ge1xyXG4gICAgICAgIGxldCBwcm9wZXJ0aWVzID0gZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUucHJvcGVydGllcztcclxuICAgICAgICBsZXQgY2hpbGRyZW5zID0gcHJvcGVydGllcy5jaGlsZHJlbiA/IHByb3BlcnRpZXMuY2hpbGRyZW4uY29uc3RhbnQgOiBbXTtcclxuXHJcbiAgICAgICAgLy9jaGlsZHJlbiBhZGRyZXNzZXNcclxuICAgICAgICBsZXQgc3Vic2NyaXB0aW9ucyA9IFtdO1xyXG4gICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChvYmpVUkwgKyAnL2NoYW5nZXMnKTtcclxuLy8gICAgICAgIGNoaWxkcmVucy5mb3JFYWNoKChjaGlsZCkgPT4gc3Vic2NyaXB0aW9ucy5wdXNoKGNoaWxkQmFzZVVSTCArIGNoaWxkKSk7XHJcbiAgICAgICAgc3Vic2NyaXB0aW9ucy5wdXNoKGNoaWxkQmFzZVVSTCk7XHJcblxyXG4gICAgICAgIC8vRkxPVy1PVVQ6IHJlcGx5IHdpdGggcHJvdmlzaW9uYWwgcmVzcG9uc2VcclxuICAgICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogaHlwZXJ0eVVSTCxcclxuICAgICAgICAgIGJvZHk6IHsgY29kZTogMTAwLCBjaGlsZHJlblJlc291cmNlczogY2hpbGRyZW5zLCBzY2hlbWE6IHNjaGVtYSwgcmVzb3VyY2U6IG9ialVSTCB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vRkxPVy1PVVQ6IHN1YnNjcmliZSBtZXNzYWdlIHRvIHJlbW90ZSBSZXBvcnRlck9iamVjdCAtPiBfb25SZW1vdGVTdWJzY3JpYmVcclxuICAgICAgICAvKmxldCBvYmpTdWJzY3JpYmVNc2cgPSB7XHJcbiAgICAgICAgICB0eXBlOiAnc3Vic2NyaWJlJywgZnJvbTogdGhpcy5fdXJsLCB0bzogb2JqVVJMU3Vic2NyaXB0aW9uLFxyXG4gICAgICAgICAgYm9keTogeyBzdWJzY3JpYmVyOiBoeXBlcnR5VVJMLCBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHkgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vc3Vic2NyaWJlIHRvIHJlcG9ydGVyIFNNXHJcbiAgICAgICAgdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG9ialN1YnNjcmliZU1zZywgKHJlcGx5KSA9PiB7Ki9cclxuXHJcbiAgICAgICAgbGV0IG9ic2VydmVyID0gdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF07XHJcbiAgICAgICAgaWYgKCFvYnNlcnZlcikge1xyXG4gICAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgT2JzZXJ2ZXJPYmplY3QodGhpcywgb2JqVVJMLCBjaGlsZHJlbnMpO1xyXG4gICAgICAgICAgb2JzZXJ2ZXIuaXNUb1NhdmVEYXRhID0gc3RvcmVkT2JqZWN0LmlzVG9TYXZlRGF0YTtcclxuICAgICAgICAgIHRoaXMuX29ic2VydmVyc1tvYmpVUkxdID0gb2JzZXJ2ZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL3JlZ2lzdGVyIG5ldyBoeXBlcnR5IHN1YnNjcmlwdGlvblxyXG4gICAgICAgIG9ic2VydmVyLmFkZFN1YnNjcmlwdGlvbihoeXBlcnR5VVJMKTtcclxuICAgICAgICBvYnNlcnZlci5hZGRDaGlsZHJlbnMoKTtcclxuXHJcbiAgICAgICAgLy8gT2JqZWN0LmFzc2lnbihzdG9yZWRPYmplY3QuZGF0YSwgcmVwbHkuYm9keS52YWx1ZS5kYXRhKTtcclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKHN0b3JlZE9iamVjdC5jaGlsZHJlbnMsIHJlcGx5LmJvZHkudmFsdWUuY2hpbGRyZW5zKTtcclxuXHJcbiAgICAgICAgLy9sb2cubG9nKCdbc3Vic2NyaWJlXSAtIHJlc3VtZSBzdWJzY3JpcHRpb246ICcsIG1zZywgcmVwbHksIHN0b3JlZE9iamVjdCwgb2JzZXJ2ZXIpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVjcnlwdENoaWxkcmVucyhzdG9yZWRPYmplY3QsIGNoaWxkcmVucyk7XHJcbiAgICAgIH0pLnRoZW4oKGRlY3J5cHRlZE9iamVjdCkgPT4ge1xyXG4gICAgICAgIC8vIGxvZy5sb2coJ3Jlc3VsdCBvZiBwcmV2aW91cyBwcm9taXNlJyk7XHJcbiAgICAgICAgcmVzb2x2ZShkZWNyeXB0ZWRPYmplY3QpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbG9nLmVycm9yKCdbU3luY2hlck1hbmFnZXIgLSByZXN1bWUgc3Vic2NyaXB0aW9uXSAtIGZhaWwgb24gZ2V0RGF0YVNjaGVtYURlc2NyaXB0b3I6ICcsIHJlYXNvbik7XHJcbiAgICAgICAgcmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBsb2NhbCBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmVcclxuICBfb25Mb2NhbFVuU3Vic2NyaWJlKG1zZykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgaHlwZXJ0eVVSTCA9IG1zZy5mcm9tO1xyXG4gICAgbGV0IG9ialVSTCA9IG1zZy5ib2R5LnJlc291cmNlO1xyXG5cclxuICAgIGxldCBvYnNlcnZlciA9IF90aGlzLl9vYnNlcnZlcnNbb2JqVVJMXTtcclxuICAgIGlmIChvYnNlcnZlcikge1xyXG4gICAgICAvL1RPRE86IGlzIHRoZXJlIGFueSBwb2xpY3kgdmVyaWZpY2F0aW9uIGJlZm9yZSBkZWxldGU/XHJcbiAgICAgIG9ic2VydmVyLnJlbW92ZVN1YnNjcmlwdGlvbihtc2cpO1xyXG5cclxuICAgICAgLy9UT0RPOiBkZXN0cm95IG9iamVjdCBpbiB0aGUgcmVnaXN0cnk/XHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICAgIGJvZHk6IHsgY29kZTogMjAwIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICB0aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2UuZGVsZXRlUmVzb3VyY2Uob2JqVVJMKTtcclxuXHJcbiAgICAgIC8vVE9ETzogcmVtb3ZlIE9iamVjdCBpZiBubyBtb3JlIHN1YnNjcmlwdGlvbj9cclxuICAgICAgZGVsZXRlIF90aGlzLl9vYnNlcnZlcnNbb2JqVVJMXTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTeW5jaGVyTWFuYWdlcjtcclxuIiwiLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignU3Vic2NyaXB0aW9uJyk7XHJcblxyXG5jbGFzcyBTdWJzY3JpcHRpb24ge1xyXG5cclxuICBjb25zdHJ1Y3RvcihidXMsIHN1YnNjcmliZXIsIHJlc291cmNlKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgX3RoaXMuX3N1YnNjcmliZXIgPSBzdWJzY3JpYmVyO1xyXG4gICAgX3RoaXMucmVzb3VyY2UgPSByZXNvdXJjZTtcclxuXHJcbiAgICBsb2cubG9nKCdbU3Vic2NyaXB0aW9uTWFuYWdlci5TdWJzY3JpcHRpb25dIG5ldzogJywgc3Vic2NyaWJlciwgcmVzb3VyY2UpXHJcblxyXG4gICAgLy9hZGQgZm9yd2FyZFxyXG4gICAgX3RoaXMuX2xpc3RlbmVyID0gYnVzLmFkZEZvcndhcmQocmVzb3VyY2UsIHN1YnNjcmliZXIpO1xyXG5cclxuICB9XHJcblxyXG4gIF9yZWxlYXNlTGlzdGVuZXJzKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBfdGhpcy5fbGlzdGVuZXIucmVtb3ZlKCk7XHJcblxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFN1YnNjcmlwdGlvbjtcclxuIiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5cclxuLy8gTG9nIFN5c3RlbVxyXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnbG9nbGV2ZWwnO1xyXG5sZXQgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignU3Vic2NyaXB0aW9uTWFuYWdlcicpO1xyXG5cclxuaW1wb3J0IHsgZGl2aWRlVVJMIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgU3Vic2NyaXB0aW9uIGZyb20gJy4vU3Vic2NyaXB0aW9uJztcclxuXHJcblxyXG4vKipcclxuICogQGF1dGhvciBwYXVsby1nLWNoYWluaG9AYWx0aWNlbGFicy5jb21cclxuICogU3Vic2NyaXB0aW9uIE1hbmFnZXIgdXNlZCB0byBtYW5hZ2Ugcm91dGluZyBwYXRocyBhdCB0aGUgcnVudGltZS5cclxuICovXHJcblxyXG5jbGFzcyBTdWJzY3JpcHRpb25NYW5hZ2VyIHtcclxuXHJcbiAgY29uc3RydWN0b3IocnVudGltZVVSTCwgYnVzLCBzdG9yYWdlKSB7XHJcbiAgICBpZiAoIXJ1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcignW1N1YnNjcmlwdGlvbk1hbmFnZXJdIC0gbmVlZHMgdGhlIHJ1bnRpbWVVUkwgcGFyYW1ldGVyJyk7XHJcbiAgICBpZiAoIWJ1cykgdGhyb3cgbmV3IEVycm9yKCdbU3Vic2NyaXB0aW9uTWFuYWdlcl0gLSBuZWVkcyB0aGUgTWVzc2FnZUJ1cyBpbnN0YW5jZScpO1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMuX2J1cyA9IGJ1cztcclxuICAgIF90aGlzLl9zdG9yYWdlID0gc3RvcmFnZTtcclxuXHJcbiAgICBfdGhpcy5fc3Vic2NyaXB0aW9ucyA9IHt9O1xyXG5cclxuICAgIF90aGlzLl9zdWJzY3JpcHRpb25zU3RvcmFnZSA9IHt9O1xyXG5cclxuICAgIC8vVE9ETzogdGhlc2Ugc2hvdWxkIGJlIHNhdmVkIGluIHBlcnNpc3RlbmNlIGVuZ2luZT9cclxuICAgIF90aGlzLnJ1bnRpbWVVUkwgPSBydW50aW1lVVJMO1xyXG4gICAgX3RoaXMuX3VybCA9IHJ1bnRpbWVVUkwgKyAnL3N1YnNjcmlwdGlvbnMnO1xyXG5cclxuICAgIC8vVE9ETzogdGhpcyBzaG91bGQgbm90IGJlIGhhcmRjb2RlZCFcclxuICAgIF90aGlzLl9kb21haW4gPSBkaXZpZGVVUkwocnVudGltZVVSTCkuZG9tYWluO1xyXG5cclxuICAgIGJ1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsLCAobXNnKSA9PiB7XHJcbiAgICAgIGxvZy5pbmZvKCdbU3Vic2NyaXB0aW9uTWFuYWdlcl0gUkNWOiAnLCBtc2cpO1xyXG4gICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzogX3RoaXMuX29uU3Vic2NyaWJlKG1zZyk7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzogX3RoaXMuX29uVW5TdWJzY3JpYmUobXNnKTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncmVhZCc6IF90aGlzLl9vblJlYWQobXNnKTsgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGluaXQoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG5cclxuICAgICAgX3RoaXMuX3N0b3JhZ2UuZ2V0KCdzdWJzY3JpcHRpb25zJykudGhlbigoc3Vic2NyaXB0aW9ucykgPT4ge1xyXG4gICAgICAgIGxvZy5sb2coJ1tTdWJzY3JpcHRpb25NYW5hZ2VyLmluaXRdIHJlc3VtZSBzdWJzY3JpcHRpb25zOiAnLCBzdWJzY3JpcHRpb25zKTtcclxuICAgICAgICBpZiAoc3Vic2NyaXB0aW9ucykge1xyXG5cclxuICAgICAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zU3RvcmFnZSA9IHN1YnNjcmlwdGlvbnM7XHJcblxyXG4gICAgICAgICAgT2JqZWN0LnZhbHVlcyhzdWJzY3JpcHRpb25zKS5mb3JFYWNoKChzdWJzY3JpcHRpb24pPT57XHJcbiAgICAgICAgICAgIF90aGlzLmNyZWF0ZVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24uZG9tYWluLCBzdWJzY3JpcHRpb24ucmVzb3VyY2VzLCBzdWJzY3JpcHRpb24uc3Vic2NyaWJlciwgc3Vic2NyaXB0aW9uLmlkZW50aXR5KTtcclxuXHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxuICB9XHJcblxyXG4gIGdldCB1cmwoKSB7IHJldHVybiB0aGlzLl91cmw7IH1cclxuXHJcblxyXG4gIC8vbWVzc2FnZSByZWNlaXZlZCB0byBzZXQgYSByb3V0aW5nIHBhdGhcclxuICBfb25TdWJzY3JpYmUobXNnKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgcmVzb3VyY2VzID0gbXNnLmJvZHkucmVzb3VyY2VzO1xyXG5cclxuICAgIGxldCBzdWJzY3JpYmVyID0gbXNnLmZyb207XHJcbiAgICBsZXQgZG9tYWluID0gZGl2aWRlVVJMKHJlc291cmNlc1swXSkuZG9tYWluOyAvL3dlIGFyZSBhc3N1bWluZyByZXNvdXJjZXMgYXJlIGFsbCBmcm9tIHRoZSBzYW1lIGRvbWFpblxyXG5cclxuICAgIGxldCBpZGVudGl0eSA9IG1zZy5ib2R5LmlkZW50aXR5O1xyXG5cclxuICAgIF90aGlzLmNyZWF0ZVN1YnNjcmlwdGlvbihkb21haW4sIHJlc291cmNlcywgc3Vic2NyaWJlciwgaWRlbnRpdHkpLnRoZW4oKHJlcGx5KT0+e1xyXG4gICAgICAvL2ZvcndhcmQgdG8gaHlwZXJ0eTpcclxuICAgICAgcmVwbHkuaWQgPSBtc2cuaWQ7XHJcbiAgICAgIHJlcGx5LmZyb20gPSBfdGhpcy5fdXJsO1xyXG4gICAgICByZXBseS50byA9IHN1YnNjcmliZXI7XHJcbiAgICAgIHJlcGx5LmJvZHkgPSBtc2cuYm9keTtcclxuICAgICAgcmVwbHkuYm9keS5jb2RlID0gMjAwO1xyXG5cclxuICAgICAgbG9nLmxvZygnW1N1YnNjcmlwdGlvbk1hbmFnZXJdIC0gY3JhZXRlU3Vic2NyaXB0aW9uOiAnLCBtc2csIHJlcGx5LCBzdWJzY3JpYmVyKTtcclxuXHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVwbHkpO1xyXG5cclxuXHJcbiAgICAgIGlmICghX3RoaXMuX3N1YnNjcmlwdGlvbnNTdG9yYWdlW3N1YnNjcmliZXJdKSB7XHJcblxyXG5cclxuICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1N0b3JhZ2Vbc3Vic2NyaWJlcl0gPSB7XHJcbiAgICAgICAgICBkb21haW46IGRvbWFpbixcclxuICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzLFxyXG4gICAgICAgICAgc3Vic2NyaWJlcjogc3Vic2NyaWJlcixcclxuICAgICAgICAgIGlkZW50aXR5OiBpZGVudGl0eVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlc291cmNlcy5mb3JFYWNoKChyZXNvdXJjZSkgPT4ge1xyXG4gICAgICAgICAgaWYgKCEoX3RoaXMuX3N1YnNjcmlwdGlvbnNTdG9yYWdlW3N1YnNjcmliZXJdLnJlc291cmNlcy5pbmNsdWRlcyhyZXNvdXJjZSkpKSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zU3RvcmFnZVtzdWJzY3JpYmVyXS5yZXNvdXJjZXMucHVzaChyZXNvdXJjZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIF90aGlzLl9zdG9yYWdlLnNldCgnc3Vic2NyaXB0aW9ucycsIDEsIF90aGlzLl9zdWJzY3JpcHRpb25zU3RvcmFnZSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZVN1YnNjcmlwdGlvbihkb21haW4sIHJlc291cmNlcywgc3Vic2NyaWJlciwgaWRlbnRpdHkpIHtcclxuXHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgLy9kZWJ1Z2dlcjtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAvL0ZMT1ctT1VUOiBzdWJzY3JpYmUgbWVzc2FnZSB0byB0aGUgbXNnLW5vZGUsIHJlZ2lzdGVyaW5nIGxpc3RlbmVycyBvbiB0aGUgYnJva2VyXHJcblxyXG4gICAgICBsZXQgbm9kZVN1YnNjcmliZU1zZyA9IHtcclxuICAgICAgICB0eXBlOiAnc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX3VybCwgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgZG9tYWluICsgJy9zbScsXHJcbiAgICAgICAgYm9keTogeyBpZGVudGl0eTogaWRlbnRpdHksIHJlc291cmNlczogcmVzb3VyY2VzLCBzb3VyY2U6IHN1YnNjcmliZXIgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy9zdWJzY3JpYmUgaW4gbXNnLW5vZGVcclxuICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShub2RlU3Vic2NyaWJlTXNnLCAocmVwbHkpID0+IHtcclxuICAgICAgICBsb2cubG9nKCdbU3Vic2NyaXB0aW9uTWFuYWdlcl0gbm9kZS1zdWJzY3JpYmUtcmVzcG9uc2U6ICcsIHJlcGx5KTtcclxuXHJcbiAgICAgICAgLy9pZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsvL1RPRE86IHVuY29tbWVudCB3aGVuICBNTiByZXBsaWVzIHdpdGggY29ycmVjdCByZXNwb25zZSBib2R5IGNvZGVcclxuXHJcbiAgICAgICAgLy9UT0RPOiBzdXBwb3J0IG11bHRpcGxlIHJvdXRlcyBmb3IgbXVsdGlwbGUgcmVzb3VyY2VzXHJcblxyXG4gICAgICAgIGxldCBzdWJzY3JpcHRpb24gPSBfdGhpcy5fc3Vic2NyaXB0aW9uc1tzdWJzY3JpYmVyXTtcclxuICAgICAgICBsb2cubG9nKCdbU3Vic2NyaXB0aW9uTWFuYWdlcl0gLSAnLCAgX3RoaXMuX3N1YnNjcmlwdGlvbnMsIHJlc291cmNlcywgX3RoaXMuX3N1YnNjcmlwdGlvbnMuaGFzT3duUHJvcGVydHkoc3Vic2NyaWJlcikpO1xyXG4gICAgICAgIGlmICghc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1tzdWJzY3JpYmVyXSA9IHt9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVzb3VyY2VzLmZvckVhY2goKHJlc291cmNlKT0+e1xyXG4gICAgICAgICAgX3RoaXMuX3N1YnNjcmlwdGlvbnNbc3Vic2NyaWJlcl1bcmVzb3VyY2VdID0gbmV3IFN1YnNjcmlwdGlvbihfdGhpcy5fYnVzLCBzdWJzY3JpYmVyLCByZXNvdXJjZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJlc29sdmUocmVwbHkpO1xyXG5cclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLy8gbWVzc2FnZSByZWNlaXZlZCB0byByZW1vdmUgcm91dGluZyBwYXRoXHJcbiAgX29uVW5TdWJzY3JpYmUobXNnKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIGxldCB1bnN1YnNjcmliZXIgPSBtc2cuZnJvbTtcclxuICAgIGxldCByZXNvdXJjZSA9IG1zZy5ib2R5LnJlc291cmNlO1xyXG5cclxuICAgIGlmIChfdGhpcy5fc3Vic2NyaXB0aW9uc1t1bnN1YnNjcmliZXJdICYmIF90aGlzLl9zdWJzY3JpcHRpb25zW3Vuc3Vic2NyaWJlcl1bcmVzb3VyY2VdKSB7XHJcbiAgICAgIGxldCBkb21haW4gPSBkaXZpZGVVUkwocmVzb3VyY2UpLmRvbWFpbjtcclxuICAgICAgbGV0IHN1YnNjcmlwdGlvbiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW3Vuc3Vic2NyaWJlcl1bcmVzb3VyY2VdO1xyXG5cclxuICAgICAgLy9GTE9XLU9VVDogbWVzc2FnZSBzZW50IHRvIG1zZy1ub2RlIFN1YnNjcmlwdGlvbk1hbmFnZXIgY29tcG9uZW50XHJcbiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl91cmwsIHRvOiAnZG9tYWluOi8vbXNnLW5vZGUuJyArIGRvbWFpbiArICcvc20nLFxyXG4gICAgICAgIGJvZHk6IHsgcmVzb3VyY2VzOiBbcmVzb3VyY2VdLCBzb3VyY2U6IHVuc3Vic2NyaWJlciB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgc3Vic2NyaXB0aW9uLl9yZWxlYXNlTGlzdGVuZXJzKCk7XHJcbiAgICAgIGRlbGV0ZSBfdGhpcy5fc3Vic2NyaXB0aW9uc1t1bnN1YnNjcmliZXJdW3Jlc291cmNlXTtcclxuXHJcbiAgICAgIGlmIChfdGhpcy5fc3Vic2NyaXB0aW9uc1N0b3JhZ2VbdW5zdWJzY3JpYmVyXSkge1xyXG4gICAgICAgIGxldCBpID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNTdG9yYWdlW3Vuc3Vic2NyaWJlcl0ucmVzb3VyY2VzLmluZGV4T2YocmVzb3VyY2UpO1xyXG4gICAgICAgIGlmIChpICE9IC0xKSB7XHJcbiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1N0b3JhZ2VbdW5zdWJzY3JpYmVyXS5yZXNvdXJjZXMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfdGhpcy5fc3RvcmFnZS5zZXQoJ3N1YnNjcmlwdGlvbnMnLCAxLCBfdGhpcy5fc3Vic2NyaXB0aW9uc1N0b3JhZ2UpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLFxyXG4gICAgICBib2R5OiB7IGNvZGU6IDIwMCB9XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvL21lc3NhZ2UgcmVjZWl2ZWQgdG8gcmVhZCBleGlzdGluZyByb3V0aW5nIHBhdGhzLiBBdCB0aGlzIHBvaW50IGxpbWl0ZWQgdG8gcmVhZCBhbGwgZXhpc3Rpbmcgcm91dGluZyBwYXRocyBzZXQgZm9yIG9uZSBsaXN0ZW5lclxyXG4gIF9vblJlYWQobXNnKSB7XHJcblxyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICBsZXQgbGlzdGVuZXJBZGRyZXNzID0gbXNnLmJvZHkucmVzb3VyY2U7XHJcbiAgICBsZXQgcmVwbHk7XHJcblxyXG4gICAgbG9nLmxvZygnW1N1YnNjcmlwdGlvbk1hbmFnZXJdIC0gcmVxdWVzdCB0byByZWFkIFN1YnNjcmlwdGlvbnM6ICcsIG1zZyk7XHJcblxyXG4gICAgX3RoaXMuX3N0b3JhZ2UuZ2V0KCdzdWJzY3JpcHRpb25zJykudGhlbigoc3Vic2NyaXB0aW9ucyk9PntcclxuICAgICAgaWYgKHN1YnNjcmlwdGlvbnMgJiYgc3Vic2NyaXB0aW9uc1tsaXN0ZW5lckFkZHJlc3NdKSB7XHJcbiAgICAgICAgbGV0IHJlc291cmNlcyA9IHN1YnNjcmlwdGlvbnNbbGlzdGVuZXJBZGRyZXNzXS5yZXNvdXJjZXM7XHJcblxyXG4gICAgICAgIHJlcGx5ID0ge1xyXG4gICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sXHJcbiAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6IHJlc291cmNlcyB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVwbHkgPSB7XHJcbiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSxcclxuICAgICAgICAgIGJvZHk6IHsgY29kZTogNDA0LCBkZXNjcmlwdGlvbjogJ05vdCBGb3VuZCcgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXBseSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFN1YnNjcmlwdGlvbk1hbmFnZXI7XHJcbiIsImltcG9ydCB7ZGl2aWRlRW1haWwsIGRpdmlkZVVSTCwgaXNEYXRhT2JqZWN0VVJMfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcblxyXG5jbGFzcyBSZVRoaW5rQ3R4IHtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmRlZmF1bHRCZWhhdmlvdXIgPSB0cnVlO1xyXG4gICAgdGhpcy5ncm91cHMgPSB7fTtcclxuICB9XHJcblxyXG4gIGdldCBzY2hlbWUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fc2NoZW1lO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGRhdGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGF0ZTtcclxuICB9XHJcblxyXG4gIGdldCBkb21haW4oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZG9tYWluO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHR5cGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdHlwZTtcclxuICB9XHJcblxyXG4gIGdldCBzb3VyY2UoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fc291cmNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHRpbWUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdGltZTtcclxuICB9XHJcblxyXG4gIGdldCB3ZWVrZGF5KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3dlZWtkYXk7XHJcbiAgfVxyXG5cclxuICBzZXQgc2NoZW1lKHBhcmFtcykge1xyXG4gICAgbGV0IGZyb20gPSBwYXJhbXMubWVzc2FnZS5mcm9tO1xyXG4gICAgaWYgKGlzRGF0YU9iamVjdFVSTChmcm9tKSkge1xyXG4gICAgICB0aGlzLl9zY2hlbWUgPSBkaXZpZGVVUkwoZnJvbSkudHlwZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3NjaGVtZSA9IHVuZGVmaW5lZDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldCBkYXRlKG5vdykge1xyXG4gICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgbGV0IGRheSA9IFN0cmluZyhkYXRlLmdldERhdGUoKSk7XHJcbiAgICBpZiAoZGF5Lmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICBkYXkgPSAnMCcgKyBkYXk7XHJcbiAgICB9XHJcbiAgICBsZXQgbW9udGggPSBTdHJpbmcoZGF0ZS5nZXRNb250aCgpICsgMSk7XHJcbiAgICBpZiAobW9udGgubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgIG1vbnRoID0gJzAnICsgbW9udGg7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9kYXRlID0gZGF5ICsgJy8nICsgbW9udGggKyAnLycgKyBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgfVxyXG5cclxuICBzZXQgZG9tYWluKHBhcmFtcykge1xyXG4gICAgaWYgKHBhcmFtcy5tZXNzYWdlLmJvZHkuaWRlbnRpdHkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aGlzLl9kb21haW4gPSBkaXZpZGVFbWFpbChwYXJhbXMubWVzc2FnZS5ib2R5LmlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJuYW1lKS5kb21haW47XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXQgdHlwZShwYXJhbXMpIHtcclxuICAgIGxldCBtZXNzYWdlID0gcGFyYW1zLm1lc3NhZ2U7XHJcbiAgICBpZiAobWVzc2FnZS5ib2R5LnZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhpcy5fdHlwZSA9IG1lc3NhZ2UuYm9keS52YWx1ZS5yZXNvdXJjZVR5cGU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXQgc291cmNlKHBhcmFtcykge1xyXG4gICAgaWYgKHBhcmFtcy5tZXNzYWdlLmJvZHkuaWRlbnRpdHkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aGlzLl9zb3VyY2UgPSBwYXJhbXMubWVzc2FnZS5ib2R5LmlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJuYW1lO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0IHRpbWUobm93KSB7XHJcbiAgICBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgbGV0IG1pbnV0ZXMgPSBTdHJpbmcobm93LmdldE1pbnV0ZXMoKSk7XHJcbiAgICBpZiAobWludXRlcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgbWludXRlcyA9ICcwJyArIG1pbnV0ZXM7XHJcbiAgICB9XHJcbiAgICB0aGlzLl90aW1lID0gcGFyc2VJbnQoU3RyaW5nKG5vdy5nZXRIb3VycygpKSArIG1pbnV0ZXMpO1xyXG4gIH1cclxuXHJcbiAgc2V0IHdlZWtkYXkobm93KSB7XHJcbiAgICB0aGlzLl93ZWVrZGF5ID0gU3RyaW5nKG5ldyBEYXRlKCkuZ2V0RGF5KCkpO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFJlVGhpbmtDdHg7XHJcbiIsImltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICdsb2dsZXZlbCc7XHJcbmxldCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdQRVAnKTtcclxuXHJcbmltcG9ydCBBbGxvd092ZXJyaWRlcyBmcm9tICcuLi9jb21iaW5pbmdBbGdvcml0aG1zL0FsbG93T3ZlcnJpZGVzJztcclxuaW1wb3J0IEJsb2NrT3ZlcnJpZGVzIGZyb20gJy4uL2NvbWJpbmluZ0FsZ29yaXRobXMvQmxvY2tPdmVycmlkZXMnO1xyXG5pbXBvcnQge2RpdmlkZVVSTCwgZ2V0VXNlckVtYWlsRnJvbVVSTCwgaXNEYXRhT2JqZWN0VVJMfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBGaXJzdEFwcGxpY2FibGUgZnJvbSAnLi4vY29tYmluaW5nQWxnb3JpdGhtcy9GaXJzdEFwcGxpY2FibGUnO1xyXG5pbXBvcnQgUmVUaGlua0N0eCBmcm9tICcuLi9SZVRoaW5rQ3R4JztcclxuXHJcbmNsYXNzIFJ1bnRpbWVDb3JlQ3R4IGV4dGVuZHMgUmVUaGlua0N0eCB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHJ1bnRpbWVVUkwsIGlkTW9kdWxlLCBydW50aW1lUmVnaXN0cnksIHN0b3JhZ2VNYW5hZ2VyLCBydW50aW1lQ2FwYWJpbGl0aWVzKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gICAgdGhpcy5fcnVudGltZVVSTCA9IHJ1bnRpbWVVUkw7XHJcbiAgICB0aGlzLl9wZXBVUkwgPSB0aGlzLl9ydW50aW1lVVJMICsgJy9wZXAnO1xyXG4gICAgdGhpcy5fZ3VpVVJMID0gdGhpcy5fcnVudGltZVVSTCArICcvcG9saWN5LWd1aSc7XHJcbiAgICB0aGlzLmlkTW9kdWxlID0gaWRNb2R1bGU7XHJcbiAgICB0aGlzLnJ1bnRpbWVSZWdpc3RyeSA9IHJ1bnRpbWVSZWdpc3RyeTtcclxuICAgIHRoaXMuYWN0aXZlVXNlclBvbGljeSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuc2VydmljZVByb3ZpZGVyUG9saWN5ID0ge307XHJcbiAgICB0aGlzLnVzZXJQb2xpY2llcyA9IHt9O1xyXG4gICAgdGhpcy5zdG9yYWdlTWFuYWdlciA9IHN0b3JhZ2VNYW5hZ2VyO1xyXG4gICAgdGhpcy5ydW50aW1lQ2FwYWJpbGl0aWVzID0gcnVudGltZUNhcGFiaWxpdGllcztcclxuICB9XHJcblxyXG4gIGdldCBwZXBVUkwoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9wZXBVUkw7XHJcbiAgfVxyXG5cclxuICBnZXQgZ3VpVVJMKCkge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHJldHVybiBfdGhpcy5fZ3VpVVJMO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHJ1bnRpbWVVUkwoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9ydW50aW1lVVJMO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiByZXR1cm4gdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeVxyXG4gICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1c1xyXG4gICovXHJcbiAgZ2V0IG1lc3NhZ2VCdXMoKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIF90aGlzLl9tZXNzYWdlQnVzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBTZXQgdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeVxyXG4gICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1c1xyXG4gICovXHJcbiAgc2V0IG1lc3NhZ2VCdXMobWVzc2FnZUJ1cykge1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLl9tZXNzYWdlQnVzID0gbWVzc2FnZUJ1cztcclxuICB9XHJcblxyXG4gIGdldCBzdWJzY3JpcHRpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fc3Vic2NyaXB0aW9uO1xyXG4gIH1cclxuXHJcbiAgc2V0IHN1YnNjcmlwdGlvbihwYXJhbXMpIHtcclxuICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IHBhcmFtcy5tZXNzYWdlLmJvZHkuc3Vic2NyaWJlcjtcclxuICB9XHJcblxyXG4gIGxvYWRDb25maWd1cmF0aW9ucygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKF90aGlzLnN0b3JhZ2VNYW5hZ2VyKTtcclxuXHJcbiAgICAgIF90aGlzLnN0b3JhZ2VNYW5hZ2VyLmdldCgncmV0aGluazphY3RpdmVQb2xpY3knKS50aGVuKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgIF90aGlzLmFjdGl2ZVVzZXJQb2xpY3kgPSB2YWx1ZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIF90aGlzLnN0b3JhZ2VNYW5hZ2VyLmdldCgncmV0aGluazpncm91cHMnKTtcclxuICAgICAgfSkudGhlbigoZ3JvdXBJbmZvKSA9PiB7XHJcbiAgICAgICAgbGV0IGdyb3VwcyA9IGdyb3VwSW5mbztcclxuICAgICAgICBfdGhpcy5ncm91cHMgPSAoZ3JvdXBzID09PSB1bmRlZmluZWQpID8ge30gOiBncm91cHM7XHJcblxyXG4gICAgICAgIHJldHVybiBfdGhpcy5zdG9yYWdlTWFuYWdlci5nZXQoJ3JldGhpbms6c3BQb2xpY2llcycpO1xyXG4gICAgICB9KS50aGVuKChwb2xpY2llc0luZm8pID0+IHtcclxuICAgICAgICBsZXQgc3BQb2xpY2llcyA9IHBvbGljaWVzSW5mbztcclxuICAgICAgICBfdGhpcy5zZXJ2aWNlUHJvdmlkZXJQb2xpY3kgPSAoc3BQb2xpY2llcyA9PT0gdW5kZWZpbmVkKSA/IHt9IDogc3BQb2xpY2llcztcclxuXHJcbiAgICAgICAgX3RoaXMuX2xvYWRVc2VyUG9saWNpZXMoKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBnZXRQb2xpY2llcyhtZXNzYWdlLCBpc0luY29taW5nTWVzc2FnZSkge1xyXG4gICAgbGV0IHBvbGljaWVzID0ge307XHJcblxyXG4gICAgaWYgKHRoaXMuYWN0aXZlVXNlclBvbGljeSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHBvbGljaWVzLnVzZXJQb2xpY3kgPSB0aGlzLnVzZXJQb2xpY2llc1t0aGlzLmFjdGl2ZVVzZXJQb2xpY3ldO1xyXG4gICAgfVxyXG5cclxuICAgIHBvbGljaWVzLnNlcnZpY2VQcm92aWRlclBvbGljeSA9IHRoaXMuZ2V0U2VydmljZVByb3ZpZGVyUG9saWN5KG1lc3NhZ2UsIGlzSW5jb21pbmdNZXNzYWdlKTtcclxuXHJcbiAgICByZXR1cm4gcG9saWNpZXM7XHJcbiAgfVxyXG5cclxuICBfaXNWYWxpZFVwZGF0ZShtZXNzYWdlKSB7XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgaWYgKG1lc3NhZ2UuZnJvbS5zcGxpdCgnOi8vJykubGVuZ3RoID4gMSkge1xyXG4gICAgICAgIF90aGlzLmlkTW9kdWxlLl9nZXRIeXBlcnR5RnJvbURhdGFPYmplY3QobWVzc2FnZS5mcm9tKS50aGVuKGh5cGVydHlVUkwgPT4ge1xyXG4gICAgICAgICAgaWYgKGh5cGVydHlVUkwgPT09IG1lc3NhZ2UuYm9keS5zb3VyY2UpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCgnVGhlIHNvdXJjZSBvZiB0aGUgbWVzc2FnZSBpcyBub3QgdmFsaWQuJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlc29sdmUobWVzc2FnZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG5cclxuICBnZXRNeUVtYWlscygpIHtcclxuICAgIGxldCBpZGVudGl0aWVzID0gdGhpcy5pZE1vZHVsZS5nZXRJZGVudGl0aWVzKCk7XHJcbiAgICBsZXQgZW1haWxzID0gW107XHJcblxyXG4gICAgZm9yIChsZXQgaSBpbiBpZGVudGl0aWVzKSB7XHJcbiAgICAgIGVtYWlscy5wdXNoKGdldFVzZXJFbWFpbEZyb21VUkwoaWRlbnRpdGllc1tpXS5pZGVudGl0eSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBlbWFpbHM7XHJcbiAgfVxyXG5cclxuICBnZXRNeUh5cGVydGllcygpIHtcclxuICAgIGxldCBoeXBlcnRpZXMgPSB0aGlzLnJ1bnRpbWVSZWdpc3RyeS5oeXBlcnRpZXNMaXN0O1xyXG4gICAgbGV0IGh5cGVydGllc05hbWVzID0gW107XHJcblxyXG4gICAgZm9yIChsZXQgaSBpbiBoeXBlcnRpZXMpIHtcclxuICAgICAgbGV0IGh5cGVydHlOYW1lID0gaHlwZXJ0aWVzW2ldLm9iamVjdE5hbWU7XHJcbiAgICAgIGlmIChoeXBlcnRpZXNOYW1lcy5pbmRleE9mKGh5cGVydHlOYW1lKSA9PT0gLTEpIHtcclxuICAgICAgICBoeXBlcnRpZXNOYW1lcy5wdXNoKGh5cGVydHlOYW1lKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBoeXBlcnRpZXNOYW1lcztcclxuICB9XHJcblxyXG4gIGdldFNlcnZpY2VQcm92aWRlclBvbGljeShtZXNzYWdlLCBpc0luY29taW5nKSB7XHJcbiAgICBsZXQgcG9saWN5O1xyXG5cclxuICAgIGlmIChpc0luY29taW5nKSB7XHJcbiAgICAgIGxldCB0b0h5cGVydHkgPSB0aGlzLnJ1bnRpbWVSZWdpc3RyeS5nZXRIeXBlcnR5TmFtZShtZXNzYWdlLnRvKTtcclxuICAgICAgcG9saWN5ID0gdGhpcy5zZXJ2aWNlUHJvdmlkZXJQb2xpY3lbdG9IeXBlcnR5XTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCBmcm9tSHlwZXJ0eSA9IHRoaXMucnVudGltZVJlZ2lzdHJ5LmdldEh5cGVydHlOYW1lKG1lc3NhZ2UuZnJvbSk7XHJcbiAgICAgIHBvbGljeSA9IHRoaXMuc2VydmljZVByb3ZpZGVyUG9saWN5W2Zyb21IeXBlcnR5XTtcclxuICAgIH1cclxuICAgIHJldHVybiBwb2xpY3k7XHJcbiAgfVxyXG5cclxuXHJcbiAgZ2V0VVJMKHVybCkge1xyXG4gICAgbGV0IHNwbGl0VVJMID0gdXJsLnNwbGl0KCcvJyk7XHJcbiAgICByZXR1cm4gc3BsaXRVUkxbMF0gKyAnLy8nICsgc3BsaXRVUkxbMl0gKyAnLycgKyBzcGxpdFVSTFszXTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAqIENyZWF0ZXMgYSBncm91cCB3aXRoIHRoZSBnaXZlbiBuYW1lLlxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgZ3JvdXBOYW1lXHJcbiAgKi9cclxuICBfbG9hZFVzZXJQb2xpY2llcygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIF90aGlzLnN0b3JhZ2VNYW5hZ2VyLmdldCgncmV0aGluazp1c2VyUG9saWNpZXMnKS50aGVuKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgIGxldCBwb2xpY2llcyA9IHZhbHVlO1xyXG4gICAgICAgIGlmIChwb2xpY2llcyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICBmb3IgKGxldCBpIGluIHBvbGljaWVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVwLmFkZFBvbGljeSgnVVNFUicsIGksIHBvbGljaWVzW2ldKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIF9nZXRMYXN0Q29tcG9uZW50T2ZVUkwodXJsKSB7XHJcbiAgICBsZXQgc3BsaXQgPSB1cmwuc3BsaXQoJy8nKTtcclxuICAgIHJldHVybiBzcGxpdFtzcGxpdC5sZW5ndGggLSAxXTtcclxuICB9XHJcblxyXG4gIF9nZXRQb2xpY2llc0pTT04ocG9saWNpZXMpIHtcclxuICAgIGZvciAobGV0IGkgaW4gcG9saWNpZXMpIHtcclxuICAgICAgbGV0IGNvbWJpbmluZ0FsZ29yaXRobSA9IHBvbGljaWVzW2ldLmNvbWJpbmluZ0FsZ29yaXRobTtcclxuICAgICAgaWYgKGNvbWJpbmluZ0FsZ29yaXRobSBpbnN0YW5jZW9mIEJsb2NrT3ZlcnJpZGVzKSB7XHJcbiAgICAgICAgcG9saWNpZXNbaV0uY29tYmluaW5nQWxnb3JpdGhtID0gJ2Jsb2NrT3ZlcnJpZGVzJztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoY29tYmluaW5nQWxnb3JpdGhtIGluc3RhbmNlb2YgQWxsb3dPdmVycmlkZXMpIHtcclxuICAgICAgICAgIHBvbGljaWVzW2ldLmNvbWJpbmluZ0FsZ29yaXRobSA9ICdhbGxvd092ZXJyaWRlcyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChjb21iaW5pbmdBbGdvcml0aG0gaW5zdGFuY2VvZiBGaXJzdEFwcGxpY2FibGUpIHtcclxuICAgICAgICAgICAgcG9saWNpZXNbaV0uY29tYmluaW5nQWxnb3JpdGhtID0gJ2ZpcnN0QXBwbGljYWJsZSc7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwb2xpY2llc1tpXS5jb21iaW5pbmdBbGdvcml0aG0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHBvbGljaWVzO1xyXG4gIH1cclxuXHJcbiAgc2F2ZUFjdGl2ZVBvbGljeSgpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIuc2V0KCdyZXRoaW5rOmFjdGl2ZVBvbGljeScsIDAsIHRoaXMuYWN0aXZlVXNlclBvbGljeSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2F2ZUdyb3VwcygpIHtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgX3RoaXMuc3RvcmFnZU1hbmFnZXIuc2V0KCdyZXRoaW5rOmdyb3VwcycsIDAsIHRoaXMuZ3JvdXBzKS50aGVuKCgpID0+IHtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzYXZlUG9saWNpZXMoc291cmNlLCBwb2xpY3ksIGtleSkge1xyXG4gICAgbGV0IHBvbGljaWVzSnNvbjtcclxuXHJcbiAgICBzd2l0Y2ggKHNvdXJjZSkge1xyXG4gICAgICBjYXNlICdVU0VSJzpcclxuICAgICAgICBwb2xpY2llc0pzb24gPSBKU09OLnN0cmluZ2lmeSh0aGlzLnVzZXJQb2xpY2llcyk7XHJcbiAgICAgICAgcG9saWNpZXNKc29uID0gdGhpcy5fZ2V0UG9saWNpZXNKU09OKEpTT04ucGFyc2UocG9saWNpZXNKc29uKSk7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlTWFuYWdlci5zZXQoJ3JldGhpbms6dXNlclBvbGljaWVzJywgMCwgcG9saWNpZXNKc29uKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnU0VSVklDRV9QUk9WSURFUic6XHJcbiAgICAgICAgaWYgKHBvbGljeSAhPT0gdW5kZWZpbmVkICYga2V5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIHRoaXMuc2VydmljZVByb3ZpZGVyUG9saWN5W2tleV0gPSBwb2xpY3k7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBvbGljaWVzSnNvbiA9IEpTT04uc3RyaW5naWZ5KHRoaXMuc2VydmljZVByb3ZpZGVyUG9saWN5KTtcclxuICAgICAgICBwb2xpY2llc0pzb24gPSB0aGlzLl9nZXRQb2xpY2llc0pTT04oSlNPTi5wYXJzZShwb2xpY2llc0pzb24pKTtcclxuICAgICAgICB0aGlzLnN0b3JhZ2VNYW5hZ2VyLnNldCgncmV0aGluazpzcFBvbGljaWVzJywgMCwgcG9saWNpZXNKc29uKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICB0aHJvdyBFcnJvcignVW5rbm93biBwb2xpY3kgc291cmNlOiAnICsgc291cmNlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldEdyb3Vwc05hbWVzKCkge1xyXG4gICAgbGV0IG15R3JvdXBzID0gdGhpcy5ncm91cHM7XHJcbiAgICBsZXQgZ3JvdXBzTmFtZXMgPSBbXTtcclxuICAgIGlmIChteUdyb3VwcyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGZvciAobGV0IGdyb3VwTmFtZSBpbiBteUdyb3Vwcykge1xyXG4gICAgICAgIGdyb3Vwc05hbWVzLnB1c2goZ3JvdXBOYW1lKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGdyb3Vwc05hbWVzO1xyXG4gIH1cclxuXHJcbiAgZ2V0R3JvdXAoZ3JvdXBOYW1lLCBkZXN0aW5hdGlvbikge1xyXG4gICAgbGV0IG1lbWJlcnMgPSBbXTtcclxuXHJcbiAgICBpZiAoZ3JvdXBOYW1lID09PSAncHJlYXV0aG9yaXNlZCcpIHtcclxuICAgICAgbGV0IGRhdGFPYmplY3RVUkwgPSBkZXN0aW5hdGlvbi5zcGxpdCgnLycpO1xyXG4gICAgICBkYXRhT2JqZWN0VVJMLnBvcCgpO1xyXG4gICAgICBkYXRhT2JqZWN0VVJMID0gZGF0YU9iamVjdFVSTFswXSArICcvLycgKyBkYXRhT2JqZWN0VVJMWzJdO1xyXG4gICAgICBtZW1iZXJzID0gdGhpcy5ydW50aW1lUmVnaXN0cnkuZ2V0UHJlQXV0aFN1YnNjcmliZXJzKGRhdGFPYmplY3RVUkwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKHRoaXMuZ3JvdXBzW2dyb3VwTmFtZV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIG1lbWJlcnMgPSB0aGlzLmdyb3Vwc1tncm91cE5hbWVdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG1lbWJlcnM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIENyZWF0ZXMgYSBncm91cCB3aXRoIHRoZSBnaXZlbiBuYW1lLlxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgZ3JvdXBOYW1lXHJcbiAgKi9cclxuICBjcmVhdGVHcm91cChncm91cE5hbWUpIHtcclxuICAgIHRoaXMuZ3JvdXBzW2dyb3VwTmFtZV0gPSBbXTtcclxuICAgIHRoaXMuc2F2ZUdyb3VwcygpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlR3JvdXAoZ3JvdXBOYW1lKSB7XHJcbiAgICBkZWxldGUgdGhpcy5ncm91cHNbZ3JvdXBOYW1lXTtcclxuICAgIHRoaXMuc2F2ZUdyb3VwcygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBZGRzIHRoZSBnaXZlbiB1c2VyIGVtYWlsIHRvIHRoZSBncm91cCB3aXRoIHRoZSBnaXZlbiBuYW1lLlxyXG4gICogQHBhcmFtICB7U3RyaW5nfSAgdXNlckVtYWlsXHJcbiAgKiBAcGFyYW0gIHtTdHJpbmd9ICBncm91cE5hbWVcclxuICAqL1xyXG4gIGFkZFRvR3JvdXAoZ3JvdXBOYW1lLCB1c2VyRW1haWwpIHtcclxuICAgIGxldCBteUdyb3VwcyA9IHRoaXMuZ3JvdXBzO1xyXG4gICAgaWYgKG15R3JvdXBzW2dyb3VwTmFtZV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBpZiAobXlHcm91cHNbZ3JvdXBOYW1lXS5pbmRleE9mKHVzZXJFbWFpbCkgPT09IC0xKSB7XHJcbiAgICAgICAgbXlHcm91cHNbZ3JvdXBOYW1lXS5wdXNoKHVzZXJFbWFpbCk7XHJcbiAgICAgICAgdGhpcy5zYXZlR3JvdXBzKCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRocm93IEVycm9yKCdHcm91cCBcIicgKyBncm91cE5hbWUgKyAnXCIgZG9lcyBub3QgZXhpc3QhJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW1vdmVGcm9tR3JvdXAoZ3JvdXBOYW1lLCB1c2VyRW1haWwpIHtcclxuICAgIGxldCBncm91cCA9IHRoaXMuZ3JvdXBzW2dyb3VwTmFtZV07XHJcblxyXG4gICAgZ3JvdXAuc3BsaWNlKGdyb3VwLmluZGV4T2YodXNlckVtYWlsKSwgMSk7XHJcbiAgICB0aGlzLnNhdmVHcm91cHMoKTtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBSdW50aW1lQ29yZUN0eDtcclxuIiwiLyoqXHJcbiAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4gKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4gKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuICogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICoqL1xyXG5pbXBvcnQgdHY0IGZyb20gXCJ0djRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBSZXRoaW5rT2JqZWN0IHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFZhbGlkYXRlcyB0aGlzIFJldGhpbmtPYmplY3QgYWdhaW5zdCB0aGUgcHJvdmlkZWQgc2NoZW1hLlxyXG4gICAgICpcclxuICAgICAqIExJTUlUQVRJT05TOiBUaGUgcHJvdmlkZWQgc2NoZW1hIGNhbm5vdCBjb250YWluIHJlZmVyZW5jZXMgdG8gb3RoZXIgc2NoZW1hcywgc2luY2UgdGhleSBjYW4ndCBiZSByZXNvbHZlZC5cclxuICAgICAqIEBwYXJhbSBzY2hlbWEgLSBzY2hlbWEgdG8gdmFsaWRhdGUgYWdhaW5zdFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaWYgdmFsaWQsIGZhbHNlIG90aGVyd2lzZVxyXG4gICAgICovXHJcbiAgICB2YWxpZGF0ZShzY2hlbWEpIHtcclxuICAgICAgICAvLyBhZGQgc2NoZW1hIGl0c2VsZiBzbyBsb2NhbCByZWZlcmVuY2VzIHdvcmtcclxuICAgICAgICB0djQuYWRkU2NoZW1hKHNjaGVtYS5pZCwgc2NoZW1hKTtcclxuXHJcbiAgICAgICAgLy8gSlNPTiBzdHJpbmdpZnkgLT4gcGFyc2UgbmVlZGVkIHRvIGhhdmUgcHJvcGVyIHZhbGlkYXRpb25cclxuICAgICAgICBsZXQgcmVzdWx0ID0gdHY0LnZhbGlkYXRlTXVsdGlwbGUoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzKSksIHNjaGVtYSk7XHJcblxyXG4gICAgICAgIC8vIGRlbGV0ZSBlcnJvciBzdGFja3MgdG8gaW1wcm92ZSBsb2dnaW5nXHJcbiAgICAgICAgcmVzdWx0LmVycm9ycy5mb3JFYWNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICBkZWxldGUgZXJyb3Iuc3RhY2s7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHByaW50IG1vcmUgZGV0YWlscyBhYm91dCB2YWxpZGF0aW9uIGlmIGl0IGZhaWxzIG9yIHNjaGVtYSBjb250YWlucyAkcmVmc1xyXG4gICAgICAgIGlmICghcmVzdWx0LnZhbGlkIHx8IChyZXN1bHQubWlzc2luZy5sZW5ndGggPiAwKSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJPYmplY3QgdmFsaWRhdGlvbiBcIiArIChyZXN1bHQudmFsaWQgPyBcInN1Y2NlZWRlZCwgYnV0IHNjaGVtYSBjb250YWluZWQgcmVmZXJlbmNlczpcIiA6IFwiZmFpbGVkOlwiKSwgSlNPTi5zdHJpbmdpZnkocmVzdWx0LCBudWxsLCAyKSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiT2JqZWN0OlwiLCBKU09OLnN0cmluZ2lmeSh0aGlzLCBudWxsLCAyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQudmFsaWQ7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBSZXRoaW5rT2JqZWN0O1xyXG5cclxuIiwiLyoqXHJcbiAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4gKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4gKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuICogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICoqL1xyXG5pbXBvcnQgUmV0aGlua09iamVjdCBmcm9tIFwiLi9SZXRoaW5rT2JqZWN0XCI7XHJcblxyXG4vKipcclxuICogQGF1dGhvciBhbGljZS5jaGVhbWJlW2F0XWZva3VzLmZyYXVuaG9mZXIuZGVcclxuICogVGhlIENhdGFsb2d1ZURhdGFPYmplY3QgY2xhc3MgaXMgdGhlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZVRISU5LIENhdGFsb2d1ZSBEYXRhIE1vZGVsXHJcbiAqL1xyXG5jbGFzcyBDYXRhbG9ndWVEYXRhT2JqZWN0IGV4dGVuZHMgUmV0aGlua09iamVjdCB7XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgdGhlIENhdGFsb2d1ZSBEYXRhIE9iamVjdFxyXG4gICAgICogQHBhcmFtIGd1aWQgLSBHbG9iYWwgVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIENhdGFsb2d1ZSBPYmplY3QgKGUuZy4gSHlwZXJ0eSBkZXNjcmlwdG9yLCBQcm90b2NvbFN0dWIgZGVzY3JpcHRvcixcclxuICAgICAqIGV0YykgZW5hYmxpbmcgdGhlIHNhbWUgb2JqZWN0IHRvIGJlIHN0b3JlZCBhbmQgZGlzY292ZXJlZCBpbiBkaWZmZXJlbnQgQ2F0YWxvZ3Vlcy4gVGhhdCBtZWFucywgZ3VpZCBjb3JyZXNwb25kcyB0b1xyXG4gICAgICogW3Jlc291cmNlLXR5cGUtaWRdIHBlciBCTkYgb2YgUmVzb3VyY2UgUGF0aC4gQ291bGRuJ3Qgd2UgaGF2ZSBwcm9ibGVtcyB3aXRoIHRvbyBsb25nIFVSTCBwYXRocz9cclxuICAgICAqIEBwYXJhbSB0eXBlIC0gaW5kaWNhdGVzIHRoZSB0eXBlIG9mIENhdGFsb2d1ZSBEYXRhIE9iamVjdCBlLmcuIEh5cGVydHksIFByb3RvY29sU3R1YiwgZXRjXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmVyc2lvbiAtIEluZGljYXRlcyB0aGUgdmVyc2lvbiBvZiBDYXRhbG9ndWUgRGF0YVxyXG4gICAgICogQHBhcmFtIG9iamVjdE5hbWUgLSBodW1hbi11bmRlcnN0YW5kYWJsZSBuYW1lIG9mIHRoZSBjYXRhbG9ndWUgb2JqZWN0IGUuZy4gXCJNeSBBd2Vzb21lIEh5cGVydHlcIlxyXG4gICAgICogQHBhcmFtIGRlc2NyaXB0aW9uIC0gZGVzY3JpcHRpb24gb2YgdGhlIHNvdXJjZSBwYWNrYWdlXHJcbiAgICAgKiBAcGFyYW0gbGFuZ3VhZ2UgLSB0aGUgcHJvZ3JhbW1pbmcgbGFuZ3VhZ2UgdXNlZCBpbiB0aGUgU291cmNlUGFja2FnZS5Tb3VyY2VDb2RlXHJcbiAgICAgKiBAcGFyYW0gc291cmNlUGFja2FnZVVSTCAtIEEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIFVSTCBmcm9tIHdoZXJlIHRoZSBzb3VyY2UgY29kZSBwYWNrYWdlIG9mIHRoZSBjb3JyZXNwb25kaW5nXHJcbiAgICAgKiBjYXRhbG9ndWUgb2JqZWN0LCBlLmcuIGRlcGxveWFibGUgcGFja2FnZXMgY29udGFpbmluZyBleGVjdXRhYmxlIGNvZGUgZm9yIEh5cGVydGllcyBvciBQcm90b1N0dWJzLCBjYW4gYmUgZG93bmxvYWRlZFxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihndWlkLCB0eXBlLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuX2d1aWQgPSBndWlkO1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xyXG4gICAgICAgIHRoaXMuX3ZlcnNpb24gPSB2ZXJzaW9uO1xyXG4gICAgICAgIHRoaXMuX29iamVjdE5hbWUgPSBvYmplY3ROYW1lO1xyXG4gICAgICAgIHRoaXMuX2Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICAgICAgdGhpcy5fbGFuZ3VhZ2UgPSBsYW5ndWFnZTtcclxuICAgICAgICB0aGlzLl9zb3VyY2VQYWNrYWdlVVJMID0gc291cmNlUGFja2FnZVVSTDtcclxuXHJcbiAgICAgICAgdGhpcy5fc2lnbmF0dXJlID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9zb3VyY2VQYWNrYWdlID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXR0ZXJzXHJcbiAgICBnZXQgZ3VpZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZ3VpZDtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgdHlwZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgdmVyc2lvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdmVyc2lvbjtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgb2JqZWN0TmFtZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fb2JqZWN0TmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgZGVzY3JpcHRpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBsYW5ndWFnZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbGFuZ3VhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHNpZ25hdHVyZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2lnbmF0dXJlO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBzb3VyY2VQYWNrYWdlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zb3VyY2VQYWNrYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBzb3VyY2VQYWNrYWdlVVJMKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zb3VyY2VQYWNrYWdlVVJMO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyBTZXR0ZXJzXHJcbiAgICAvKipcclxuICAgICAqIFNldCB0aGUgc2lnbmF0dXJlIHRvIGVuYWJsZXMgaW50ZWdyaXR5IGFuZCBhdXRoZW50aWNpdHkgdmVyaWZpY2F0aW9uXHJcbiAgICAgKiBAcGFyYW0gc2lnbmF0dXJlXHJcbiAgICAgKi9cclxuICAgIHNldCBzaWduYXR1cmUoc2lnbmF0dXJlKSB7XHJcbiAgICAgICAgaWYgKHNpZ25hdHVyZSlcclxuICAgICAgICAgICAgdGhpcy5fc2lnbmF0dXJlID0gc2lnbmF0dXJlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBzb3VyY2VQYWNrYWdlKHNvdXJjZVBhY2thZ2UpIHtcclxuICAgICAgICBpZiAoc291cmNlUGFja2FnZSlcclxuICAgICAgICAgICAgdGhpcy5fc291cmNlUGFja2FnZSA9IHNvdXJjZVBhY2thZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGd1aWQoZ3VpZCkge1xyXG4gICAgICAgIGlmIChndWlkKVxyXG4gICAgICAgICAgICB0aGlzLl9ndWlkID0gZ3VpZDtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgdHlwZSh0eXBlKSB7XHJcbiAgICAgICAgaWYgKHR5cGUpXHJcbiAgICAgICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCB2ZXJzaW9uKHZlcnNpb24pIHtcclxuICAgICAgICBpZiAodmVyc2lvbikge1xyXG4gICAgICAgICAgICB0aGlzLl92ZXJzaW9uID0gdmVyc2lvbjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IG9iamVjdE5hbWUob2JqZWN0TmFtZSkge1xyXG4gICAgICAgIGlmIChvYmplY3ROYW1lKVxyXG4gICAgICAgICAgICB0aGlzLl9vYmplY3ROYW1lID0gb2JqZWN0TmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgZGVzY3JpcHRpb24oZGVzY3JpcHRpb24pIHtcclxuICAgICAgICBpZiAoZGVzY3JpcHRpb24pXHJcbiAgICAgICAgICAgIHRoaXMuX2Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGxhbmd1YWdlKGxhbmd1YWdlKSB7XHJcbiAgICAgICAgaWYgKGxhbmd1YWdlKVxyXG4gICAgICAgICAgICB0aGlzLl9sYW5ndWFnZSA9IGxhbmd1YWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBzb3VyY2VQYWNrYWdlVVJMKHNvdXJjZVBhY2thZ2VVUkwpIHtcclxuICAgICAgICBpZiAoc291cmNlUGFja2FnZVVSTClcclxuICAgICAgICAgICAgdGhpcy5fc291cmNlUGFja2FnZVVSTCA9IHNvdXJjZVBhY2thZ2VVUkw7XHJcbiAgICB9XHJcbn1cclxuLy9BbGljZTogcmVtb3ZlZCBQT0xJQ1lfRU5GT1JDRVI6ICdwb2xpY3lfZW5mb3JjZXInLCBEQVRBX1NDSEVNQTogJ2RhdGFfc2NoZW1hJyBmcm9tIHRoZSBsaXN0XHJcbi8vd3J0OiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2Rldi1zZXJ2aWNlLWZyYW1ld29yay9ibG9iL2RldmVsb3AvZG9jcy9kYXRhbW9kZWwvY29yZS9oeXBlcnR5LWNhdGFsb2d1ZS9yZWFkbWUubWQjZGF0YS1vYmplY3Qtc2NoZW1hXHJcbmV4cG9ydCBjb25zdCBDYXRhbG9ndWVPYmplY3RUeXBlID0ge1xyXG4gICAgSFlQRVJUWTogJ2h5cGVydHknLCBQUk9UT1NUVUI6ICdwcm90b3N0dWInLCBIWVBFUlRZX1JVTlRJTUU6ICdoeXBlcnR5X3J1bnRpbWUnLFxyXG4gICAgSFlQRVJUWV9JTlRFUkNFUFRPUjogJ2h5cGVydHlfaW5zcGVjdG9yJywgSFlQRVJUWV9EQVRBX09CSkVDVDogJ2h5cGVydHlfZGF0YV9vYmplY3QnXHJcbn07XHJcbmV4cG9ydCBjb25zdCBEYXRhT2JqZWN0U291cmNlTGFuZ3VhZ2UgPSB7XHJcbiAgICBKQVZBU0NSSVBUX0VDTUE2OiAnamF2YXNjcmlwdF9lY21hNicsIEpBVkFTQ1JJUFRfRUNNQTU6ICdqYXZhc2NyaXB0X2VjbWE1JyxcclxuICAgIEpTT05fU0NIRU1BX1Y0OiAnanNvbl9zY2hlbWFfdjQnLCBQWVRIT046ICdweXRob24nLCBUWVBFU0NSSVBUOiAndHlwZXNjcmlwdCdcclxufTtcclxuZXhwb3J0IGRlZmF1bHQgQ2F0YWxvZ3VlRGF0YU9iamVjdDsiLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vKipcclxuICogQ3JlYXRlZCBieSBhbW8gb24gMTQvMTEvMjAxNS5cclxuICovXHJcbmNsYXNzIFNvdXJjZVBhY2thZ2Uge1xyXG4gICAgY29uc3RydWN0b3Ioc291cmNlQ29kZUNsYXNzbmFtZSwgc291cmNlQ29kZSkge1xyXG4gICAgICAgIHRoaXMuX3NvdXJjZUNvZGUgPSBzb3VyY2VDb2RlO1xyXG4gICAgICAgIHRoaXMuX3NvdXJjZUNvZGVDbGFzc25hbWUgPSBzb3VyY2VDb2RlQ2xhc3NuYW1lO1xyXG5cclxuICAgICAgICB0aGlzLl9lbmNvZGluZyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fc2lnbmF0dXJlID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgc291cmNlQ29kZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlQ29kZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgc291cmNlQ29kZUNsYXNzbmFtZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlQ29kZUNsYXNzbmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgZW5jb2RpbmcoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VuY29kaW5nO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBzaWduYXR1cmUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NpZ25hdHVyZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgZW5jb2RpbmcoZW5jb2RpbmcpIHtcclxuICAgICAgICBpZiAoZW5jb2RpbmcpXHJcbiAgICAgICAgICAgIHRoaXMuX2VuY29kaW5nID0gZW5jb2Rpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IHNpZ25hdHVyZShzaWduKSB7XHJcbiAgICAgICAgaWYgKHNpZ24pXHJcbiAgICAgICAgICAgIHRoaXMuX3NpZ25hdHVyZSA9IHNpZ247XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IHNvdXJjZUNvZGUoc291cmNlQ29kZSkge1xyXG4gICAgICAgIGlmIChzb3VyY2VDb2RlKVxyXG4gICAgICAgICAgICB0aGlzLl9zb3VyY2VDb2RlID0gc291cmNlQ29kZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgc291cmNlQ29kZUNsYXNzbmFtZShzb3VyY2VDb2RlQ2xhc3NuYW1lKSB7XHJcbiAgICAgICAgaWYgKHNvdXJjZUNvZGVDbGFzc25hbWUpXHJcbiAgICAgICAgICAgIHRoaXMuX3NvdXJjZUNvZGVDbGFzc25hbWUgPSBzb3VyY2VDb2RlQ2xhc3NuYW1lO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTb3VyY2VQYWNrYWdlO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vKipcclxuICogQ3JlYXRlZCBieSBhbW8gb24gMTQvMTEvMjAxNS5cclxuICovXHJcbmltcG9ydCBDYXRhbG9ndWVEYXRhT2JqZWN0IGZyb20gJy4vQ2F0YWxvZ3VlRGF0YU9iamVjdCc7XHJcblxyXG5jbGFzcyBIeXBlcnR5RGVzY3JpcHRvciBleHRlbmRzIENhdGFsb2d1ZURhdGFPYmplY3Qge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBndWlkIC0gQ2F0YWxvZ3VlIEdsb2JhbCBVbmlxdWUgaWRlbnRpZmllciBvZiB0aGUgQ2F0YWxvZ3VlIE9iamVjdCBlbmFibGluZyB0aGUgc2FtZSBvYmplY3QgdG8gYmVcclxuICAgICAqIHN0b3JlZCBhbmQgZGlzY292ZXJlZCBpbiBkaWZmZXJlbnQgQ2F0YWxvZ3Vlcy4gR3VpZCBjb3JyZXNwb25kcyB0byA8cmVzb3VyY2UtdHlwZS1pZD4gcGVyIEJORiBvZiBSZXNvdXJjZSBQYXRoLlxyXG4gICAgICogQHBhcmFtIHtDYXRhbG9ndWVPYmplY3RUeXBlfSBjYXRhbG9ndWVUeXBlIC0gXHRJbmRpY2F0ZXMgdGhlIHR5cGUgb2YgQ2F0YWxvZ3VlIERhdGEgT2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmVyc2lvblxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG9iamVjdE5hbWVcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkZXNjcmlwdGlvblxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc291cmNlUGFja2FnZVVSTFxyXG4gICAgICogQHBhcmFtIHtIeXBlcnR5UmVzb3VyY2VUeXBlW119IGh5cGVydHlUeXBlIEEgdGFnIHRoYXQgaWRlbnRpZmllcyB3aGF0IHR5cGUgb2YgaHlwZXJ0eSBpcyBkZXNjcmliZWQgaW4gdGhlIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7VVJMLkh5cGVydHlDYXRhbG9ndWVVUkxMaXN0fSBkYXRhT2JqZWN0VXJscyAtIEl0IGRlZmluZXMgdGhlIERhdGEgT2JqZWN0IFNjaGVtYXMgc3VwcG9ydGVkIGJ5IHRoZSBIeXBlcnR5XHJcbiAgICAgKiB0aHJvdWdoIGEgbGlzdCBvZiBDYXRhbG9ndWUgVVJMcyBmcm9tIHdoZXJlIHRoZXNlIHNjaGVtYXMgY2FuIGJlIHJlYWNoZWRcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoZ3VpZCwgY2F0YWxvZ3VlVHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBoeXBlcnR5VHlwZSwgZGF0YU9iamVjdFVybHMpIHtcclxuICAgICAgICBzdXBlcihndWlkLCBjYXRhbG9ndWVUeXBlLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwpO1xyXG5cclxuICAgICAgICB0aGlzLl9jb25maWd1cmF0aW9uID0ge307XHJcbiAgICAgICAgdGhpcy5fY29uc3RyYWludHMgPSB7fTtcclxuICAgICAgICB0aGlzLl9wb2xpY2llcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX21lc3NhZ2VTY2hlbWEgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLl9oeXBlcnR5VHlwZSA9IGh5cGVydHlUeXBlO1xyXG4gICAgICAgIHRoaXMuX2RhdGFPYmplY3RzID0gZGF0YU9iamVjdFVybHM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGh5cGVydHlUeXBlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9oeXBlcnR5VHlwZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgZGF0YU9iamVjdHMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFPYmplY3RzO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBjb25maWd1cmF0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb25maWd1cmF0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBjb25zdHJhaW50cygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludHM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IG1lc3NhZ2VTY2hlbWEoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21lc3NhZ2VTY2hlbWE7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHBvbGljaWVzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wb2xpY2llcztcclxuICAgIH1cclxuXHJcbiAgICBzZXQgaHlwZXJ0eVR5cGUoaFR5cGUpIHtcclxuICAgICAgICBpZiAoaFR5cGUpXHJcbiAgICAgICAgICAgIHRoaXMuX2h5cGVydHlUeXBlID0gaFR5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGRhdGFPYmplY3RzKGRhdGFPYmplY3RzKSB7XHJcbiAgICAgICAgaWYgKGRhdGFPYmplY3RzKVxyXG4gICAgICAgICAgICB0aGlzLl9kYXRhT2JqZWN0cyA9IGRhdGFPYmplY3RzO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBjb25maWd1cmF0aW9uKGNvbmZpZ3VyYXRpb24pIHtcclxuICAgICAgICBpZiAoY29uZmlndXJhdGlvbilcclxuICAgICAgICAgICAgdGhpcy5fY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGNvbnN0cmFpbnRzKGNvbnN0cmFpbnRzKSB7XHJcbiAgICAgICAgaWYgKGNvbnN0cmFpbnRzKVxyXG4gICAgICAgICAgICB0aGlzLl9jb25zdHJhaW50cyA9IGNvbnN0cmFpbnRzO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBtZXNzYWdlU2NoZW1hKG1lc3NhZ2VTY2hlbWEpIHtcclxuICAgICAgICBpZiAobWVzc2FnZVNjaGVtYSlcclxuICAgICAgICAgICAgdGhpcy5fbWVzc2FnZVNjaGVtYSA9IG1lc3NhZ2VTY2hlbWE7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IHBvbGljaWVzKHBvbGljaWVzKSB7XHJcbiAgICAgICAgaWYgKHBvbGljaWVzKVxyXG4gICAgICAgICAgICB0aGlzLl9wb2xpY2llcyA9IHBvbGljaWVzO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBSdW50aW1lSHlwZXJ0eUNhcGFiaWxpdHlUeXBlID0ge307XHJcbmV4cG9ydCBjb25zdCBIeXBlcnR5VHlwZSA9IHtDT01NVU5JQ0FUT1I6ICdjb21tdW5pY2F0b3InLCBJREVOVElUWTogJ2lkZW50aXR5JywgQ09OVEVYVDogJ2NvbnRleHQnfTtcclxuZXhwb3J0IGNvbnN0IEh5cGVydHlSZXNvdXJjZVR5cGUgPSB7Y2hhdDogJ0NIQVQnLCBhdWRpbzogJ0F1ZGlvJywgdmlkZW86ICdWaWRlbycsIGF2OiAnQVYnLCBzY3JlZW46J1NDUkVFTicsXHJcbiAgICBmaWxlOiAnRklMZScsIG1pZGk6J01JREknfTtcclxuZXhwb3J0IGRlZmF1bHQgSHlwZXJ0eURlc2NyaXB0b3I7IiwiLyoqXHJcbiAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4gKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4gKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuICogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICoqL1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZWQgYnkgYW1vIG9uIDE0LzExLzIwMTUuXHJcbiAqL1xyXG5cclxuaW1wb3J0IENhdGFsb2d1ZURhdGFPYmplY3QgZnJvbSBcIi4vQ2F0YWxvZ3VlRGF0YU9iamVjdFwiO1xyXG5cclxuY2xhc3MgUHJvdG9jb2xTdHViRGVzY3JpcHRvciBleHRlbmRzIENhdGFsb2d1ZURhdGFPYmplY3Qge1xyXG4gICAgY29uc3RydWN0b3IoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBtZXNzYWdlU2NoZW1hcywgY29uZmlndXJhdGlvbixcclxuICAgICAgICAgICAgICAgIGNvbnN0cmFpbnRzLCBoeXBlcnR5VHlwZSwgZGF0YU9iamVjdHMsIGludGVyd29ya2luZywgaWRwUHJveHksIG11dHVhbEF1dGhlbnRpY2F0aW9uKSB7XHJcbiAgICAgICAgc3VwZXIoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMKTtcclxuXHJcbiAgICAgICAgdGhpcy5fbWVzc2FnZVNjaGVtYXMgPSBtZXNzYWdlU2NoZW1hcztcclxuXHJcbiAgICAgICAgaWYgKGNvbmZpZ3VyYXRpb24pXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgdGhpcy5fY29uZmlndXJhdGlvbiA9IHt9O1xyXG5cclxuICAgICAgICBpZiAoY29uc3RyYWludHMpXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnN0cmFpbnRzID0gY29uc3RyYWludHM7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLl9jb25zdHJhaW50cyA9IHt9O1xyXG5cclxuICAgICAgICB0aGlzLl9oeXBlcnR5VHlwZSA9IGh5cGVydHlUeXBlO1xyXG5cclxuICAgICAgICBpZiAoZGF0YU9iamVjdHMpXHJcbiAgICAgICAgICAgIHRoaXMuX2RhdGFPYmplY3RzID0gZGF0YU9iamVjdHM7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLl9kYXRhT2JqZWN0cyA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuX2ludGVyd29ya2luZyA9IGludGVyd29ya2luZztcclxuICAgICAgICB0aGlzLl9pZHBQcm94eSA9IGlkcFByb3h5O1xyXG4gICAgICAgIHRoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldCBtZXNzYWdlU2NoZW1hcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbWVzc2FnZVNjaGVtYXM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGNvbnN0cmFpbnRzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb25zdHJhaW50cztcclxuICAgIH1cclxuXHJcbiAgICBnZXQgY29uZmlndXJhdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlndXJhdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgbWVzc2FnZVNjaGVtYXMobWVzc2FnZVNjaGVtYXMpIHtcclxuICAgICAgICBpZiAobWVzc2FnZVNjaGVtYXMpXHJcbiAgICAgICAgICAgIHRoaXMuX21lc3NhZ2VTY2hlbWFzID0gbWVzc2FnZVNjaGVtYXM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGNvbnN0cmFpbnRzKGNvbnN0cmFpbnRzKSB7XHJcbiAgICAgICAgaWYgKGNvbnN0cmFpbnRzKVxyXG4gICAgICAgICAgICB0aGlzLl9jb25zdHJhaW50cyA9IGNvbnN0cmFpbnRzO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBjb25maWd1cmF0aW9uKGNvbmZpZ3VyYXRpb24pIHtcclxuICAgICAgICBpZiAoY29uZmlndXJhdGlvbilcclxuICAgICAgICAgICAgdGhpcy5fY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGh5cGVydHlUeXBlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9oeXBlcnR5VHlwZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgaHlwZXJ0eVR5cGUodmFsdWUpIHtcclxuICAgICAgICB0aGlzLl9oeXBlcnR5VHlwZSA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBkYXRhT2JqZWN0cygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YU9iamVjdHM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGRhdGFPYmplY3RzKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fZGF0YU9iamVjdHMgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgaW50ZXJ3b3JraW5nKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnRlcndvcmtpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGludGVyd29ya2luZyh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX2ludGVyd29ya2luZyA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBpZHBQcm94eSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faWRwUHJveHk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGlkcFByb3h5KHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5faWRwUHJveHkgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgbXV0dWFsQXV0aGVudGljYXRpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBtdXR1YWxBdXRoZW50aWNhdGlvbih2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uID0gdmFsdWU7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFByb3RvY29sU3R1YkRlc2NyaXB0b3I7IiwiLyoqXHJcbiAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4gKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4gKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuICogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICoqL1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZWQgYnkgYW1vIG9uIDE0LzExLzIwMTUuXHJcbiAqL1xyXG5cclxuaW1wb3J0IENhdGFsb2d1ZURhdGFPYmplY3QgZnJvbSBcIi4vQ2F0YWxvZ3VlRGF0YU9iamVjdFwiO1xyXG5cclxuY2xhc3MgSHlwZXJ0eVJ1bnRpbWVEZXNjcmlwdG9yIGV4dGVuZHMgQ2F0YWxvZ3VlRGF0YU9iamVjdCB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoZ3VpZCwgY2F0YWxvZ3VlVHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBydW50aW1lVHlwZSxcclxuICAgICAgICAgICAgICAgIGh5cGVydHlDYXBhYmlsaXRpZXMsIHByb3RvY29sQ2FwYWJpbGl0aWVzLCBwMnBIYW5kbGVyU3R1YiwgcDJwUmVxdWVzdGVyU3R1Yikge1xyXG4gICAgICAgIHN1cGVyKGd1aWQsIGNhdGFsb2d1ZVR5cGUsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLCBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3J1bnRpbWVUeXBlID0gcnVudGltZVR5cGU7XHJcblxyXG4gICAgICAgIGlmIChoeXBlcnR5Q2FwYWJpbGl0aWVzKVxyXG4gICAgICAgICAgICB0aGlzLl9oeXBlcnR5Q2FwYWJpbGl0aWVzID0gaHlwZXJ0eUNhcGFiaWxpdGllcztcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHRoaXMuX2h5cGVydHlDYXBhYmlsaXRpZXMgPSBuZXcgUnVudGltZUh5cGVydHlDYXBhYmlsaXR5KHRydWUsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICBpZiAocHJvdG9jb2xDYXBhYmlsaXRpZXMpXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb3RvY29sQ2FwYWJpbGl0aWVzID0gcHJvdG9jb2xDYXBhYmlsaXRpZXM7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLl9wcm90b2NvbENhcGFiaWxpdGllcyA9IG5ldyBSdW50aW1lUHJvdG9jb2xDYXBhYmlsaXR5KHRydWUsIGZhbHNlLCB0cnVlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcDJwSGFuZGxlclN0dWIgPSBwMnBIYW5kbGVyU3R1YjtcclxuICAgICAgICB0aGlzLl9wMnBSZXF1ZXN0ZXJTdHViID0gcDJwUmVxdWVzdGVyU3R1YjtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgcnVudGltZVR5cGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3J1bnRpbWVUeXBlO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBoeXBlcnR5Q2FwYWJpbGl0aWVzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9oeXBlcnR5Q2FwYWJpbGl0aWVzO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBwcm90b2NvbENhcGFiaWxpdGllcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faHlwZXJ0eUNhcGFiaWxpdGllcztcclxuICAgIH1cclxuXHJcbiAgICBzZXQgcnVudGltZVR5cGUocnVudGltZVR5cGUpIHtcclxuICAgICAgICBpZiAocnVudGltZVR5cGUpXHJcbiAgICAgICAgICAgIHRoaXMuX3J1bnRpbWVUeXBlID0gcnVudGltZVR5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGh5cGVydHlDYXBhYmlsaXRpZXMoaHlwZXJ0eUNhcGFiaWxpdGllcykge1xyXG4gICAgICAgIGlmIChoeXBlcnR5Q2FwYWJpbGl0aWVzKVxyXG4gICAgICAgICAgICB0aGlzLl9oeXBlcnR5Q2FwYWJpbGl0aWVzID0gaHlwZXJ0eUNhcGFiaWxpdGllcztcclxuICAgIH1cclxuXHJcbiAgICBzZXQgcHJvdG9jb2xDYXBhYmlsaXRpZXMocHJvdG9jb2xDYXBhYmlsaXRpZXMpIHtcclxuICAgICAgICBpZiAocHJvdG9jb2xDYXBhYmlsaXRpZXMpXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb3RvY29sQ2FwYWJpbGl0aWVzID0gcHJvdG9jb2xDYXBhYmlsaXRpZXM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHAycEhhbmRsZXJTdHViKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wMnBIYW5kbGVyU3R1YjtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgcDJwSGFuZGxlclN0dWIodmFsdWUpIHtcclxuICAgICAgICB0aGlzLl9wMnBIYW5kbGVyU3R1YiA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBwMnBSZXF1ZXN0ZXJTdHViKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wMnBSZXF1ZXN0ZXJTdHViO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBwMnBSZXF1ZXN0ZXJTdHViKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fcDJwUmVxdWVzdGVyU3R1YiA9IHZhbHVlO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogQSBjbGFzcyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2FwYWJpbGl0eSBzZXQgb2YgdGhlIFJ1bnRpbWUgSHlwZXJ0eVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bnRpbWVIeXBlcnR5Q2FwYWJpbGl0eSB7XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gb2JqZWN0IG9mIHRoZSBSdW50aW1lIEh5cGVydHkgY2FwYWJpbGl0eSBzZXRcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNXZWJSVENTdXBwb3J0ZWRcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNNaWNTdXBwb3J0ZWRcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNDYW1lcmFTdXBwb3J0ZWRcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNTZW5zb3JTdXBwb3J0ZWRcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNPUlRDU3VwcG9ydGVkXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGlzV2ViUlRDU3VwcG9ydGVkLCBpc01pY1N1cHBvcnRlZCwgaXNDYW1lcmFTdXBwb3J0ZWQsIGlzU2Vuc29yU3VwcG9ydGVkLCBpc09SVENTdXBwb3J0ZWQpIHtcclxuICAgICAgICB0aGlzLl9pc1dlYlJUQyA9IGlzV2ViUlRDU3VwcG9ydGVkO1xyXG4gICAgICAgIHRoaXMuX2lzTWljID0gaXNNaWNTdXBwb3J0ZWQ7XHJcbiAgICAgICAgdGhpcy5faXNDYW1lcmEgPSBpc0NhbWVyYVN1cHBvcnRlZDtcclxuICAgICAgICB0aGlzLl9pc1NlbnNvciA9IGlzU2Vuc29yU3VwcG9ydGVkO1xyXG4gICAgICAgIHRoaXMuX2lzT1JUQyA9IGlzT1JUQ1N1cHBvcnRlZDtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgaXNNaWMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzTWljO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBpc0NhbWVyYSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXNDYW1lcmE7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGlzU2Vuc29yKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc1NlbnNvcjtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgaXNXZWJSVEMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzV2ViUlRDO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBpc09SVENTKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc09SVEM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q2FwYWJpbGl0eVNldCgpIHtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcyk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogQSBjbGFzcyByZXByZXNlbnRhdGlvbiBvZiB0aGUgcHJvdG9jb2wgY2FwYWJpbGl0eSBzZXQgb2YgdGhlIFJ1bnRpbWUgSHlwZXJ0eVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJ1bnRpbWVQcm90b2NvbENhcGFiaWxpdHkge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBvYmplY3Qgb2YgdGhlIHJ1bnRpbWUgcHJvdG9jb2wgY2FwYWJpbGl0eVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0h0dHBcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNIdHRwc1xyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc1dTXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzV1NTXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzQ29hcFxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0RhdGFDaGFubmVsXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGlzSHR0cCwgaXNIdHRwcywgaXNXUywgaXNXU1MsIGlzQ29hcCwgaXNEYXRhQ2hhbm5lbCkge1xyXG4gICAgICAgIHRoaXMuX2lzSHR0cCA9IGlzSHR0cDtcclxuICAgICAgICB0aGlzLl9pc0h0dHBzID0gaXNIdHRwcztcclxuICAgICAgICB0aGlzLl9pc1dTID0gaXNXUztcclxuICAgICAgICB0aGlzLl9pc1dTUyA9IGlzV1NTO1xyXG4gICAgICAgIHRoaXMuX2lzQ29hcCA9IGlzQ29hcDtcclxuICAgICAgICB0aGlzLl9pc0RhdGFDaGFubmVsID0gaXNEYXRhQ2hhbm5lbDtcclxuICAgIH1cclxuXHJcbiAgICBpc0h0dHAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzSHR0cDtcclxuICAgIH1cclxuXHJcbiAgICBpc0h0dHBzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc0h0dHBzO1xyXG4gICAgfVxyXG5cclxuICAgIGlzV1MoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzV1M7XHJcbiAgICB9XHJcblxyXG4gICAgaXNTZW5zb3JTdXBwb3J0ZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzU2Vuc29yO1xyXG4gICAgfVxyXG5cclxuICAgIGlzV1NTKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc1dTUztcclxuICAgIH1cclxuXHJcbiAgICBpc0NvYXAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzQ29hcDtcclxuICAgIH1cclxuXHJcbiAgICBpc0RhdGFDaGFubmVsKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc0RhdGFDaGFubmVsO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBnZXRDYXBhYmlsaXR5U2V0KCkge1xyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFJ1bnRpbWVUeXBlID0ge0JST1dTRVI6ICdicm93c2VyJywgU1RBTkRBTE9ORTogJ3N0YW5kYWxvbmUnLCBTRVJWRVI6ICdzZXJ2ZXInLCBHQVRFV0FZOiAnZ2F0ZXdheSd9O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgSHlwZXJ0eVJ1bnRpbWVEZXNjcmlwdG9yO1xyXG4iLCIvKipcclxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxyXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXHJcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xyXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxyXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbipcclxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuKlxyXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbipcclxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKiovXHJcblxyXG4vKipcclxuICogQ3JlYXRlZCBieSBwenUgb24gMTkuMTEuMTUuXHJcbiAqL1xyXG5pbXBvcnQgQ2F0YWxvZ3VlRGF0YU9iamVjdCBmcm9tICcuL0NhdGFsb2d1ZURhdGFPYmplY3QnO1xyXG5cclxuY2xhc3MgUG9saWN5RW5mb3JjZXJEZXNjcmlwdG9yIGV4dGVuZHMgQ2F0YWxvZ3VlRGF0YU9iamVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcihndWlkLCB0eXBlLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwsIGNvbmZpZ3VyYXRpb24sIHBvbGljaWVzKSB7XHJcbiAgICAgICAgc3VwZXIoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMKTtcclxuXHJcbiAgICAgICAgdGhpcy5fY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247XHJcbiAgICAgICAgdGhpcy5fcG9saWNpZXMgPSBwb2xpY2llcztcclxuICAgIH1cclxuXHJcbiAgICBnZXQgY29uZmlndXJhdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlndXJhdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgcG9saWNpZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BvbGljaWVzO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBwb2xpY2llcyhwb2xpY2llcykge1xyXG4gICAgICAgIHRoaXMuX3BvbGljaWVzID0gcG9saWNpZXM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGNvbmZpZ3VyYXRpb24oY29uZmlndXJhdGlvbikge1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb2xpY3lFbmZvcmNlckRlc2NyaXB0b3I7IiwiLyoqXHJcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXHJcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcclxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxyXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxyXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcclxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxyXG4qXHJcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbipcclxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4qXHJcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqL1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZWQgYnkgcHp1IG9uIDE5LjExLjE1LlxyXG4gKi9cclxuXHJcbmltcG9ydCBDYXRhbG9ndWVEYXRhT2JqZWN0IGZyb20gJy4vQ2F0YWxvZ3VlRGF0YU9iamVjdCc7XHJcblxyXG5leHBvcnQgY2xhc3MgRGF0YU9iamVjdFNjaGVtYSBleHRlbmRzIENhdGFsb2d1ZURhdGFPYmplY3Qge1xyXG4gICAgY29uc3RydWN0b3IoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMKSB7XHJcbiAgICAgICAgc3VwZXIoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMKTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcblxyXG4vL0NoaWxkcmVuXHJcbmV4cG9ydCBjbGFzcyBNZXNzYWdlRGF0YU9iamVjdFNjaGVtYSBleHRlbmRzIERhdGFPYmplY3RTY2hlbWEge1xyXG4gICAgY29uc3RydWN0b3IoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMKSB7XHJcbiAgICAgICAgc3VwZXIoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEh5cGVydHlEYXRhT2JqZWN0U2NoZW1hIGV4dGVuZHMgRGF0YU9iamVjdFNjaGVtYSB7XHJcbiAgICBjb25zdHJ1Y3RvcihndWlkLCB0eXBlLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwsIGFjY2Vzc0NvbnRyb2xQb2xpY3ksIGRhdGFVcmxTY2hlbWUpIHtcclxuICAgICAgICBzdXBlcihndWlkLCB0eXBlLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwpO1xyXG4gICAgICAgIHRoaXMuX2FjY2Vzc0NvbnRyb2xQb2xpY3kgPSBhY2Nlc3NDb250cm9sUG9saWN5O1xyXG4gICAgICAgIHRoaXMuX3NjaGVtZSA9IGRhdGFVcmxTY2hlbWU7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vQ2hpbGRyZW5cclxuZXhwb3J0IGNsYXNzIENvbW11bmljYXRpb25EYXRhT2JqZWN0U2NoZW1hIGV4dGVuZHMgSHlwZXJ0eURhdGFPYmplY3RTY2hlbWEge1xyXG4gICAgY29uc3RydWN0b3IoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBhY2Nlc3NDb250cm9sUG9saWN5KSB7XHJcbiAgICAgICAgc3VwZXIoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBhY2Nlc3NDb250cm9sUG9saWN5KTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25EYXRhT2JqZWN0U2NoZW1hIGV4dGVuZHMgSHlwZXJ0eURhdGFPYmplY3RTY2hlbWEge1xyXG4gICAgY29uc3RydWN0b3IoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBhY2Nlc3NDb250cm9sUG9saWN5KSB7XHJcbiAgICAgICAgc3VwZXIoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBhY2Nlc3NDb250cm9sUG9saWN5KTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIElkZW50aXR5RGF0YU9iamVjdFNjaGVtYSBleHRlbmRzIEh5cGVydHlEYXRhT2JqZWN0U2NoZW1hIHtcclxuICAgIGNvbnN0cnVjdG9yKGd1aWQsIHR5cGUsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLCBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCwgYWNjZXNzQ29udHJvbFBvbGljeSkge1xyXG4gICAgICAgIHN1cGVyKGd1aWQsIHR5cGUsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLCBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCwgYWNjZXNzQ29udHJvbFBvbGljeSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb250ZXh0RGF0YU9iamVjdFNjaGVtYSBleHRlbmRzIEh5cGVydHlEYXRhT2JqZWN0U2NoZW1hIHtcclxuICAgIGNvbnN0cnVjdG9yKGd1aWQsIHR5cGUsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLCBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCwgYWNjZXNzQ29udHJvbFBvbGljeSkge1xyXG4gICAgICAgIHN1cGVyKGd1aWQsIHR5cGUsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLCBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCwgYWNjZXNzQ29udHJvbFBvbGljeSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBEYXRhVXJsU2NoZW1lID0ge1xyXG4gICAgQ09NTTogJ0NPTU0nLCBDT05ORUNUSU9OOiAnQ09OTkVDVElPTicsIENUWFQ6ICdDVFhUJywgSURFTlRJVFk6ICdJREVOVElUWSdcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IERhdGFPYmplY3RTY2hlbWE7IiwiLyoqXHJcbiAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4gKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxyXG4gKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcclxuICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXHJcbiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcclxuICogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICoqL1xyXG5cclxuaW1wb3J0IENhdGFsb2d1ZURhdGFPYmplY3QsIHtDYXRhbG9ndWVPYmplY3RUeXBlLCBEYXRhT2JqZWN0U291cmNlTGFuZ3VhZ2V9IGZyb20gXCIuL0NhdGFsb2d1ZURhdGFPYmplY3RcIjtcclxuaW1wb3J0IFNvdXJjZVBhY2thZ2UgZnJvbSBcIi4vU291cmNlUGFja2FnZVwiO1xyXG5pbXBvcnQgSHlwZXJ0eURlc2NyaXB0b3IgZnJvbSBcIi4vSHlwZXJ0eURlc2NyaXB0b3JcIjtcclxuaW1wb3J0IFByb3RvY29sU3R1YkRlc2NyaXB0b3IgZnJvbSBcIi4vUHJvdG9jb2xTdHViRGVzY3JpcHRvclwiO1xyXG5pbXBvcnQgSHlwZXJ0eVJ1bnRpbWVEZXNjcmlwdG9yLCB7UnVudGltZVR5cGV9IGZyb20gXCIuL0h5cGVydHlSdW50aW1lRGVzY3JpcHRvclwiO1xyXG5pbXBvcnQgSHlwZXJ0eUludGVyY2VwdG9yRGVzY3JpcHRvciBmcm9tIFwiLi9IeXBlcnR5SW50ZXJjZXB0b3JEZXNjcmlwdG9yXCI7XHJcbmltcG9ydCB7XHJcbiAgICBEYXRhT2JqZWN0U2NoZW1hLFxyXG4gICAgRGF0YVVybFNjaGVtZSxcclxuICAgIENvbW11bmljYXRpb25EYXRhT2JqZWN0U2NoZW1hLFxyXG4gICAgQ29ubmVjdGlvbkRhdGFPYmplY3RTY2hlbWEsXHJcbiAgICBDb250ZXh0RGF0YU9iamVjdFNjaGVtYSxcclxuICAgIElkZW50aXR5RGF0YU9iamVjdFNjaGVtYVxyXG59IGZyb20gXCIuL0RhdGFPYmplY3RTY2hlbWFcIjtcclxuXHJcbmNsYXNzIENhdGFsb2d1ZURhdGFPYmplY3RGYWN0b3J5IHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBDYXRhbG9ndWVEYXRhT2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZ3VpZCAtIENhdGFsb2d1ZSBHbG9iYWwgVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIENhdGFsb2d1ZSBPYmplY3RcclxuICAgICAqIEBwYXJhbSB7Q2F0YWxvZ3VlT2JqZWN0VHlwZX0gdHlwZSAtIEluZGljYXRlcyB0aGUgdHlwZSBvZiBDYXRhbG9ndWUgRGF0YSBPYmplY3RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2ZXJzaW9uIC0gSW5kaWNhdGVzIHRoZSB2ZXJzaW9uIG9mIENhdGFsb2d1ZSBEYXRhXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb2JqZWN0TmFtZSAtIEh1bWFuLXVuZGVyc3RhbmRhYmxlIG5hbWUgb2YgdGhlIGNhdGFsb2d1ZSBvYmplY3RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkZXNjcmlwdGlvblxyXG4gICAgICogQHBhcmFtIHtEYXRhT2JqZWN0U291cmNlTGFuZ3VhZ2V9IGxhbmd1YWdlIC0gUHJvZ3JhbW1pbmcgbGFuZ3VhZ2UgdXNlZCBpbiB0aGUgU291cmNlUGFja2FnZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZVBhY2thZ2VVUkwgLSBVUkwgZnJvbSB3aGVyZSB0aGUgc291cmNlIGNvZGUgcGFja2FnZSBvZiB0aGUgY29ycmVzcG9uZGluZyBjYXRhbG9ndWUgb2JqZWN0IGNhbiBiZSBkb3dubG9hZGVkLlxyXG4gICAgICogQHJldHVybnMge0NhdGFsb2d1ZURhdGFPYmplY3R9XHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZUNhdGFsb2d1ZURhdGFPYmplY3QoZ3VpZCwgdHlwZSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMKSB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICB0eXBlb2YgZ3VpZCA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgdHlwZSA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgdmVyc2lvbiA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2Ygb2JqZWN0TmFtZSA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgZGVzY3JpcHRpb24gPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIGxhbmd1YWdlID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBzb3VyY2VQYWNrYWdlVVJMID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBhcmFtZXRlcnMhXCIpO1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2F0YWxvZ3VlRGF0YU9iamVjdChndWlkLCB0eXBlLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIEh5cGVydHlEZXNjcmlwdG9yXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZ3VpZCAtIENhdGFsb2d1ZSBHbG9iYWwgVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIENhdGFsb2d1ZSBPYmplY3RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2ZXJzaW9uIC0gSW5kaWNhdGVzIHRoZSB2ZXJzaW9uIG9mIENhdGFsb2d1ZSBEYXRhXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb2JqZWN0TmFtZSAtIEh1bWFuLXVuZGVyc3RhbmRhYmxlIG5hbWUgb2YgdGhlIGNhdGFsb2d1ZSBvYmplY3RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkZXNjcmlwdGlvblxyXG4gICAgICogQHBhcmFtIHtEYXRhT2JqZWN0U291cmNlTGFuZ3VhZ2V9IGxhbmd1YWdlIC0gUHJvZ3JhbW1pbmcgbGFuZ3VhZ2UgdXNlZCBpbiB0aGUgU291cmNlUGFja2FnZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZVBhY2thZ2VVUkwgLSBVUkwgZnJvbSB3aGVyZSB0aGUgc291cmNlIGNvZGUgcGFja2FnZSBvZiB0aGUgY29ycmVzcG9uZGluZyBjYXRhbG9ndWUgb2JqZWN0XHJcbiAgICAgKiBjYW4gYmUgZG93bmxvYWRlZC5cclxuICAgICAqIEBwYXJhbSB7SHlwZXJ0eVJlc291cmNlVHlwZVtdfSBoeXBlcnR5VHlwZSAtIEFuIGFycmF5IG9mIEh5cGVydHlSZXNvdXJjZVR5cGUgdGhhdCBpZGVudGlmaWVzIHdoYXQgdHlwZSBvZiBoeXBlcnR5XHJcbiAgICAgKiByZXNvdXJjZXMgYXJlIGhhbmRsZWQgYnkgdGhlIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7VVJMLlVSTExpc3R9IGRhdGFPYmplY3RzIC0gRGVmaW5lcyB0aGUgRGF0YSBPYmplY3QgU2NoZW1hcyBzdXBwb3J0ZWQgYnkgdGhlIEh5cGVydHkgdGhyb3VnaCBhIGxpc3Qgb2YgQ2F0YWxvZ3VlIFVSTHMgZnJvbSB3aGVyZSB0aGVzZSBzY2hlbWFzIGNhbiBiZSByZWFjaGVkLlxyXG4gICAgICogQHJldHVybnMge0h5cGVydHlEZXNjcmlwdG9yfVxyXG4gICAgICovXHJcbiAgICBjcmVhdGVIeXBlcnR5RGVzY3JpcHRvck9iamVjdChndWlkLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwsIGh5cGVydHlUeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9iamVjdHMpIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHR5cGVvZiBndWlkID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiB2ZXJzaW9uID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBvYmplY3ROYW1lID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBkZXNjcmlwdGlvbiA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgbGFuZ3VhZ2UgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIHNvdXJjZVBhY2thZ2VVUkwgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIGh5cGVydHlUeXBlID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBkYXRhT2JqZWN0cyA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgIClcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXJzIVwiKTtcclxuICAgICAgICByZXR1cm4gbmV3IEh5cGVydHlEZXNjcmlwdG9yKGd1aWQsIENhdGFsb2d1ZU9iamVjdFR5cGUuSFlQRVJUWSwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBoeXBlcnR5VHlwZSwgZGF0YU9iamVjdHMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIFByb3RvY29sU3R1YkRlc2NyaXB0b3JcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBndWlkIC0gQ2F0YWxvZ3VlIEdsb2JhbCBVbmlxdWUgaWRlbnRpZmllciBvZiB0aGUgQ2F0YWxvZ3VlIE9iamVjdFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZlcnNpb24gLSBJbmRpY2F0ZXMgdGhlIHZlcnNpb24gb2YgQ2F0YWxvZ3VlIERhdGFcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvYmplY3ROYW1lIC0gSHVtYW4tdW5kZXJzdGFuZGFibGUgbmFtZSBvZiB0aGUgY2F0YWxvZ3VlIG9iamVjdFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRlc2NyaXB0aW9uXHJcbiAgICAgKiBAcGFyYW0ge0RhdGFPYmplY3RTb3VyY2VMYW5ndWFnZX0gbGFuZ3VhZ2UgLSBQcm9ncmFtbWluZyBsYW5ndWFnZSB1c2VkIGluIHRoZSBTb3VyY2VQYWNrYWdlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc291cmNlUGFja2FnZVVSTCAtIFVSTCBmcm9tIHdoZXJlIHRoZSBzb3VyY2UgY29kZSBwYWNrYWdlIG9mIHRoZSBjb3JyZXNwb25kaW5nIGNhdGFsb2d1ZSBvYmplY3QgY2FuIGJlIGRvd25sb2FkZWQuXHJcbiAgICAgKiBAcGFyYW0ge1VSTC5VUkx9IG1lc3NhZ2VTY2hlbWFzIC0gRGVmaW5lcyB0aGUgU2NoZW1hIGRlc2NyaWJpbmcgdGhlIE1lc3NhZ2UgRGF0YSBNb2RlbCB1c2VkIGJ5IHRoZSBIeXBlcnR5IHRocm91Z2ggdGhlIENhdGFsb2d1ZSBVUkwgZnJvbSB3aGVyZSB0aGUgTWVzc2FnZSBzY2hlbWEgY2FuIGJlIHJlYWNoZWQuIElmIG5vdCBkZWZpbmVkLCBieSBkZWZhdWx0IGl0IGlzIGFzc3VtZWQgdGhlIHN0YW5kYXJkIE1lc3NhZ2UgTW9kZWwgaXMgdXNlZC5cclxuICAgICAqIEBwYXJhbSBjb25maWd1cmF0aW9uIC0gRGF0YSByZXF1aXJlZCB0byBjb25maWd1cmUgdGhlIFByb3RvY29sU3R1YlxyXG4gICAgICogQHBhcmFtIGNvbnN0cmFpbnRzIC0gRGVzY3JpYmVzIGNhcGFiaWxpdGllcyByZXF1aXJlZCBmcm9tIHRoZSBIeXBlcnR5IFJ1bnRpbWUgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBleGVjdXRlIHRoZSBQcm90b2NvbFN0dWJcclxuICAgICAqIEBwYXJhbSBoeXBlcnR5VHlwZVxyXG4gICAgICogQHBhcmFtIGRhdGFPYmplY3RzXHJcbiAgICAgKiBAcGFyYW0gaW50ZXJ3b3JraW5nXHJcbiAgICAgKiBAcGFyYW0gaWRwUHJveHlcclxuICAgICAqIEBwYXJhbSBtdXR1YWxBdXRoZW50aWNhdGlvblxyXG4gICAgICogQHJldHVybnMge1Byb3RvY29sU3R1YkRlc2NyaXB0b3J9XHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZVByb3RvU3R1YkRlc2NyaXB0b3JPYmplY3QoZ3VpZCwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBtZXNzYWdlU2NoZW1hcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbiwgY29uc3RyYWludHMsIGh5cGVydHlUeXBlLCBkYXRhT2JqZWN0cywgaW50ZXJ3b3JraW5nLCBpZHBQcm94eSwgbXV0dWFsQXV0aGVudGljYXRpb24pIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHR5cGVvZiBndWlkID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiB2ZXJzaW9uID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBvYmplY3ROYW1lID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBkZXNjcmlwdGlvbiA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgbGFuZ3VhZ2UgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIHNvdXJjZVBhY2thZ2VVUkwgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIG1lc3NhZ2VTY2hlbWFzID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBjb25maWd1cmF0aW9uID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBjb25zdHJhaW50cyA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgIClcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXJzIVwiKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb3RvY29sU3R1YkRlc2NyaXB0b3IoZ3VpZCwgQ2F0YWxvZ3VlT2JqZWN0VHlwZS5QUk9UT1NUVUIsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCwgbWVzc2FnZVNjaGVtYXMsIGNvbmZpZ3VyYXRpb24sIGNvbnN0cmFpbnRzLCBoeXBlcnR5VHlwZSwgZGF0YU9iamVjdHMsIGludGVyd29ya2luZywgaWRwUHJveHksIG11dHVhbEF1dGhlbnRpY2F0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBIeXBlcnR5UnVudGltZURlc2NyaXB0b3JcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBndWlkIC0gQ2F0YWxvZ3VlIEdsb2JhbCBVbmlxdWUgaWRlbnRpZmllciBvZiB0aGUgQ2F0YWxvZ3VlIE9iamVjdFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZlcnNpb24gLSBJbmRpY2F0ZXMgdGhlIHZlcnNpb24gb2YgQ2F0YWxvZ3VlIERhdGFcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvYmplY3ROYW1lIC0gSHVtYW4tdW5kZXJzdGFuZGFibGUgbmFtZSBvZiB0aGUgY2F0YWxvZ3VlIG9iamVjdFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRlc2NyaXB0aW9uXHJcbiAgICAgKiBAcGFyYW0ge0RhdGFPYmplY3RTb3VyY2VMYW5ndWFnZX0gbGFuZ3VhZ2UgLSBQcm9ncmFtbWluZyBsYW5ndWFnZSB1c2VkIGluIHRoZSBTb3VyY2VQYWNrYWdlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc291cmNlUGFja2FnZVVSTCAtIFVSTCBmcm9tIHdoZXJlIHRoZSBzb3VyY2UgY29kZSBwYWNrYWdlIG9mIHRoZSBjb3JyZXNwb25kaW5nIGNhdGFsb2d1ZSBvYmplY3QgY2FuIGJlIGRvd25sb2FkZWQuXHJcbiAgICAgKiBAcGFyYW0ge1J1bnRpbWVUeXBlfXJ1bnRpbWVUeXBlXHJcbiAgICAgKiBAcGFyYW0ge1J1bnRpbWVIeXBlcnR5Q2FwYWJpbGl0aWVzfSBoeXBlcnR5Q2FwYWJpbGl0aWVzIC0gU3VwcG9ydGVkIGNhcGFiaWxpdGllcyB0byBleGVjdXRlIEh5cGVydGllc1xyXG4gICAgICogQHBhcmFtIHtSdW50aW1lUHJvdG9jb2xDYXBhYmlsaXRpZXN9IHByb3RvY29sQ2FwYWJpbGl0aWVzIC0gU3VwcG9ydGVkIGNhcGFiaWxpdGllcyB0byBleGVjdXRlIFByb3RvY29sIFN0dWJzXHJcbiAgICAgKiBAcGFyYW0gcDJwSGFuZGxlclN0dWJcclxuICAgICAqIEBwYXJhbSBwMnBSZXF1ZXN0ZXJTdHViXHJcbiAgICAgKiBAcmV0dXJucyB7SHlwZXJ0eVJ1bnRpbWVEZXNjcmlwdG9yfSB0aGUgZGF0YSBvYmplY3Qgb2YgdGhlIEh5cGVydHkgUnVudGltZSBEZXNjcmlwdG9yXHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZUh5cGVydHlSdW50aW1lRGVzY3JpcHRvck9iamVjdChndWlkLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVudGltZVR5cGUsIGh5cGVydHlDYXBhYmlsaXRpZXMsIHByb3RvY29sQ2FwYWJpbGl0aWVzLCBwMnBIYW5kbGVyU3R1YiwgcDJwUmVxdWVzdGVyU3R1Yikge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdHlwZW9mIGd1aWQgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIHZlcnNpb24gPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIG9iamVjdE5hbWUgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIGRlc2NyaXB0aW9uID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBsYW5ndWFnZSA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2Ygc291cmNlUGFja2FnZVVSTCA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgcnVudGltZVR5cGUgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW1ldGVycyFcIik7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgSHlwZXJ0eVJ1bnRpbWVEZXNjcmlwdG9yKGd1aWQsIENhdGFsb2d1ZU9iamVjdFR5cGUuSFlQRVJUWV9SVU5USU1FLCB2ZXJzaW9uLCBvYmplY3ROYW1lLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwsIHJ1bnRpbWVUeXBlLCBoeXBlcnR5Q2FwYWJpbGl0aWVzLCBwcm90b2NvbENhcGFiaWxpdGllcywgcDJwSGFuZGxlclN0dWIsIHAycFJlcXVlc3RlclN0dWIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIEh5cGVydHkgSW50ZXJjZXB0b3IgRGVzY3JpcHRvclxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGd1aWQgLSBDYXRhbG9ndWUgR2xvYmFsIFVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBDYXRhbG9ndWUgT2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmVyc2lvbiAtIEluZGljYXRlcyB0aGUgdmVyc2lvbiBvZiBDYXRhbG9ndWUgRGF0YVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG9iamVjdE5hbWUgLSBIdW1hbi11bmRlcnN0YW5kYWJsZSBuYW1lIG9mIHRoZSBjYXRhbG9ndWUgb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGVzY3JpcHRpb25cclxuICAgICAqIEBwYXJhbSB7RGF0YU9iamVjdFNvdXJjZUxhbmd1YWdlfSBsYW5ndWFnZSAtIFByb2dyYW1taW5nIGxhbmd1YWdlIHVzZWQgaW4gdGhlIFNvdXJjZVBhY2thZ2VcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzb3VyY2VQYWNrYWdlVVJMIC0gVVJMIGZyb20gd2hlcmUgdGhlIHNvdXJjZSBjb2RlIHBhY2thZ2Ugb2YgdGhlIGNvcnJlc3BvbmRpbmcgY2F0YWxvZ3VlIG9iamVjdCBjYW4gYmUgZG93bmxvYWRlZC5cclxuICAgICAqIEBwYXJhbSBjb25maWd1cmF0aW9uXHJcbiAgICAgKiBAcGFyYW0gcG9saWNpZXNcclxuICAgICAqIEByZXR1cm5zIHtQb2xpY3lFbmZvcmNlckRlc2NyaXB0b3J9XHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZUh5cGVydHlJbnRlcmNlcHRvckRlc2NyaXB0b3JPYmplY3QoZ3VpZCwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBjb25maWd1cmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xpY2llcykge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdHlwZW9mIGd1aWQgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIHZlcnNpb24gPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIG9iamVjdE5hbWUgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIGRlc2NyaXB0aW9uID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBsYW5ndWFnZSA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2Ygc291cmNlUGFja2FnZVVSTCA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgIClcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXJzIVwiKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBIeXBlcnR5SW50ZXJjZXB0b3JEZXNjcmlwdG9yKGd1aWQsIENhdGFsb2d1ZU9iamVjdFR5cGUuSFlQRVJUWV9JTlRFUkNFUFRPUiwgdmVyc2lvbiwgb2JqZWN0TmFtZSxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBjb25maWd1cmF0aW9uLCBwb2xpY2llcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgRGF0YU9iamVjdFNjaGVtYSB3aGljaCBpbiBlZmZlY3QgaXMgdGhlIE1lc3NhZ2VEYXRhT2JqZWN0U2NoZW1hXHJcbiAgICAgKiBAZGVwcmVjYXRlZCBVc2UgZWl0aGVyIGNyZWF0ZU1lc3NhZ2VEYXRhT2JqZWN0U2NoZW1hIG9yIGNyZWF0ZUh5cGVydHlEYXRhT2JqZWN0U2NoZW1hIGluc3RlYWRcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBndWlkIC0gQ2F0YWxvZ3VlIEdsb2JhbCBVbmlxdWUgaWRlbnRpZmllciBvZiB0aGUgQ2F0YWxvZ3VlIE9iamVjdFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZlcnNpb24gLSBJbmRpY2F0ZXMgdGhlIHZlcnNpb24gb2YgQ2F0YWxvZ3VlIERhdGFcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvYmplY3ROYW1lIC0gSHVtYW4tdW5kZXJzdGFuZGFibGUgbmFtZSBvZiB0aGUgY2F0YWxvZ3VlIG9iamVjdFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRlc2NyaXB0aW9uXHJcbiAgICAgKiBAcGFyYW0ge0RhdGFPYmplY3RTb3VyY2VMYW5ndWFnZX0gbGFuZ3VhZ2UgLSBQcm9ncmFtbWluZyBsYW5ndWFnZSB1c2VkIGluIHRoZSBTb3VyY2VQYWNrYWdlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc291cmNlUGFja2FnZVVSTCAtIFVSTCBmcm9tIHdoZXJlIHRoZSBzb3VyY2UgY29kZSBwYWNrYWdlIG9mIHRoZSBjb3JyZXNwb25kaW5nIGNhdGFsb2d1ZSBvYmplY3QgY2FuIGJlIGRvd25sb2FkZWQuXHJcbiAgICAgKiBAcmV0dXJucyB7RGF0YU9iamVjdFNjaGVtYX1cclxuICAgICAqL1xyXG4gICAgY3JlYXRlRGF0YU9iamVjdFNjaGVtYShndWlkLCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbiwgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwpIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHR5cGVvZiBndWlkID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiB2ZXJzaW9uID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBvYmplY3ROYW1lID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBkZXNjcmlwdGlvbiA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgbGFuZ3VhZ2UgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIHNvdXJjZVBhY2thZ2VVUkwgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW1ldGVycyFcIik7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgRGF0YU9iamVjdFNjaGVtYShndWlkLCBDYXRhbG9ndWVPYmplY3RUeXBlLkhZUEVSVFlfREFUQV9PQkpFQ1QsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLCBsYW5ndWFnZSxcclxuICAgICAgICAgICAgc291cmNlUGFja2FnZVVSTCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgRGF0YU9iamVjdFNjaGVtYSB3aGljaCBpbiBlZmZlY3QgaXMgdGhlIE1lc3NhZ2VEYXRhT2JqZWN0U2NoZW1hXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZ3VpZCAtIENhdGFsb2d1ZSBHbG9iYWwgVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIENhdGFsb2d1ZSBPYmplY3RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2ZXJzaW9uIC0gSW5kaWNhdGVzIHRoZSB2ZXJzaW9uIG9mIENhdGFsb2d1ZSBEYXRhXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb2JqZWN0TmFtZSAtIEh1bWFuLXVuZGVyc3RhbmRhYmxlIG5hbWUgb2YgdGhlIGNhdGFsb2d1ZSBvYmplY3RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkZXNjcmlwdGlvblxyXG4gICAgICogQHBhcmFtIHtEYXRhT2JqZWN0U291cmNlTGFuZ3VhZ2V9IGxhbmd1YWdlIC0gUHJvZ3JhbW1pbmcgbGFuZ3VhZ2UgdXNlZCBpbiB0aGUgU291cmNlUGFja2FnZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZVBhY2thZ2VVUkwgLSBVUkwgZnJvbSB3aGVyZSB0aGUgc291cmNlIGNvZGUgcGFja2FnZSBvZiB0aGUgY29ycmVzcG9uZGluZyBjYXRhbG9ndWUgb2JqZWN0IGNhbiBiZSBkb3dubG9hZGVkLlxyXG4gICAgICogQHJldHVybnMge0RhdGFPYmplY3RTY2hlbWF9XHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZU1lc3NhZ2VEYXRhT2JqZWN0U2NoZW1hKGd1aWQsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLCBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCkge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdHlwZW9mIGd1aWQgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIHZlcnNpb24gPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIG9iamVjdE5hbWUgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIGRlc2NyaXB0aW9uID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBsYW5ndWFnZSA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2Ygc291cmNlUGFja2FnZVVSTCA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgIClcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXJzIVwiKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRhT2JqZWN0U2NoZW1hKGd1aWQsIENhdGFsb2d1ZU9iamVjdFR5cGUuSFlQRVJUWV9EQVRBX09CSkVDVCwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLFxyXG4gICAgICAgICAgICBzb3VyY2VQYWNrYWdlVVJMKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBIeXBlcnR5RGF0YU9iamVjdFNjaGVtYVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGd1aWQgLSBDYXRhbG9ndWUgR2xvYmFsIFVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBDYXRhbG9ndWUgT2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmVyc2lvbiAtIEluZGljYXRlcyB0aGUgdmVyc2lvbiBvZiBDYXRhbG9ndWUgRGF0YVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG9iamVjdE5hbWUgLSBIdW1hbi11bmRlcnN0YW5kYWJsZSBuYW1lIG9mIHRoZSBjYXRhbG9ndWUgb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGVzY3JpcHRpb25cclxuICAgICAqIEBwYXJhbSB7RGF0YU9iamVjdFNvdXJjZUxhbmd1YWdlfSBsYW5ndWFnZSAtIFByb2dyYW1taW5nIGxhbmd1YWdlIHVzZWQgaW4gdGhlIFNvdXJjZVBhY2thZ2VcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzb3VyY2VQYWNrYWdlVVJMIC0gVVJMIGZyb20gd2hlcmUgdGhlIHNvdXJjZSBjb2RlIHBhY2thZ2Ugb2YgdGhlIGNvcnJlc3BvbmRpbmcgY2F0YWxvZ3VlIG9iamVjdCBjYW4gYmUgZG93bmxvYWRlZC5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhY2Nlc3NDb250cm9sUG9saWN5IC0gcG9saWN5IHJ1bGUgdG8gYWNjZXNzIG9iamVjdCAoc2VlIFJlcG9ydGVyLU9ic2VydmVyIENvbW0gcGF0dGVybilcclxuICAgICAqIEBwYXJhbSB7RGF0YVVybFNjaGVtZX0gc2NoZW1lIC0gaWRlbnRpZmllcyB0aGUgZGF0YSBzY2hlbWUgKENPTU0sIENPTk5FQ1RJT04sIENUWFQgb3IgSURFTlRJVFkpXHJcbiAgICAgKiBAcmV0dXJucyB7RGF0YU9iamVjdFNjaGVtYX1cclxuICAgICAqL1xyXG4gICAgY3JlYXRlSHlwZXJ0eURhdGFPYmplY3RTY2hlbWEoZ3VpZCwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzQ29udHJvbFBvbGljeSwgc2NoZW1lKSB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICB0eXBlb2YgZ3VpZCA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgdmVyc2lvbiA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2Ygb2JqZWN0TmFtZSA9PT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICB8fCB0eXBlb2YgZGVzY3JpcHRpb24gPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIGxhbmd1YWdlID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBzb3VyY2VQYWNrYWdlVVJMID09PSBcInVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgIHx8IHR5cGVvZiBzY2hlbWUgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIGFjY2Vzc0NvbnRyb2xQb2xpY3kgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW1ldGVycyFcIik7XHJcblxyXG4gICAgICAgIGlmIChzY2hlbWUgPT09IERhdGFVcmxTY2hlbWUuQ09NTSlcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb21tdW5pY2F0aW9uRGF0YU9iamVjdFNjaGVtYShndWlkLCBDYXRhbG9ndWVPYmplY3RUeXBlLkhZUEVSVFlfREFUQV9PQkpFQ1QsIHZlcnNpb24sIG9iamVjdE5hbWUsIGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2UsIHNvdXJjZVBhY2thZ2VVUkwsIHNjaGVtZSwgYWNjZXNzQ29udHJvbFBvbGljeSk7XHJcbiAgICAgICAgZWxzZSBpZiAoc2NoZW1lID09PSBEYXRhVXJsU2NoZW1lLkNPTk5FQ1RJT04pXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29ubmVjdGlvbkRhdGFPYmplY3RTY2hlbWEoZ3VpZCwgQ2F0YWxvZ3VlT2JqZWN0VHlwZS5IWVBFUlRZX0RBVEFfT0JKRUNULCB2ZXJzaW9uLCBvYmplY3ROYW1lLCBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIGxhbmd1YWdlLCBzb3VyY2VQYWNrYWdlVVJMLCBzY2hlbWUsIGFjY2Vzc0NvbnRyb2xQb2xpY3kpO1xyXG4gICAgICAgIGVsc2UgaWYgKHNjaGVtZSA9PT0gRGF0YVVybFNjaGVtZS5DVFhUKVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvbnRleHREYXRhT2JqZWN0U2NoZW1hKGd1aWQsIENhdGFsb2d1ZU9iamVjdFR5cGUuSFlQRVJUWV9EQVRBX09CSkVDVCwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCwgc2NoZW1lLCBhY2Nlc3NDb250cm9sUG9saWN5KTtcclxuICAgICAgICBlbHNlIGlmIChzY2hlbWUgPT09IERhdGFVcmxTY2hlbWUuSURFTlRJVFkpXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgSWRlbnRpdHlEYXRhT2JqZWN0U2NoZW1hKGd1aWQsIENhdGFsb2d1ZU9iamVjdFR5cGUuSFlQRVJUWV9EQVRBX09CSkVDVCwgdmVyc2lvbiwgb2JqZWN0TmFtZSwgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZSwgc291cmNlUGFja2FnZVVSTCwgc2NoZW1lLCBhY2Nlc3NDb250cm9sUG9saWN5KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBTb3VyY2VQYWNrYWdlXHJcbiAgICAgKiBAcGFyYW0gc291cmNlQ29kZUNsYXNzbmFtZSAtIFRoZSBDbGFzcy1uYW1lIG9mIHRoZSBTb3VyY2VDb2RlXHJcbiAgICAgKiBAcGFyYW0gc291cmNlQ29kZSAtIFRoZSBzb3VyY2UgY29kZSBvZiB0aGUgY2F0YWxvZ3VlIG9iamVjdFxyXG4gICAgICogQHJldHVybnMge1NvdXJjZVBhY2thZ2V9XHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZVNvdXJjZVBhY2thZ2Uoc291cmNlQ29kZUNsYXNzbmFtZSwgc291cmNlQ29kZSkge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdHlwZW9mIHNvdXJjZUNvZGUgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICAgICAgfHwgdHlwZW9mIHNvdXJjZUNvZGVDbGFzc25hbWUgPT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICApXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW1ldGVycyFcIik7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgU291cmNlUGFja2FnZShzb3VyY2VDb2RlQ2xhc3NuYW1lLCBzb3VyY2VDb2RlKTtcclxuXHJcbiAgICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgQ2F0YWxvZ3VlRGF0YU9iamVjdEZhY3Rvcnk7XHJcbiIsIi8vIExvZyBTeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ1J1bnRpbWVDYXRhbG9ndWUnKTtcclxuXHJcbmltcG9ydCBDYXRhbG9ndWVGYWN0b3J5IGZyb20gJy4vQ2F0YWxvZ3VlRGF0YU9iamVjdEZhY3RvcnknO1xyXG5cclxuY2xhc3MgUnVudGltZUNhdGFsb2d1ZSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHJ1bnRpbWVGYWN0b3J5LCBuYW1lLCBzY2hlbWEpIHtcclxuICAgIGlmICghcnVudGltZUZhY3RvcnkpIHRocm93IEVycm9yKCdUaGUgY2F0YWxvZ3VlIG5lZWRzIHRoZSBydW50aW1lRmFjdG9yeScpO1xyXG5cclxuICAgIHRoaXMuX2ZhY3RvcnkgPSBuZXcgQ2F0YWxvZ3VlRmFjdG9yeSgpO1xyXG4gICAgdGhpcy5odHRwUmVxdWVzdCA9IHJ1bnRpbWVGYWN0b3J5LmNyZWF0ZUh0dHBSZXF1ZXN0KCk7XHJcbiAgICB0aGlzLmF0b2IgPSBydW50aW1lRmFjdG9yeS5hdG9iID8gcnVudGltZUZhY3RvcnkuYXRvYiA6IGF0b2I7XHJcblxyXG4gICAgY29uc3Qgc3RvcmFnZU5hbWUgPSBuYW1lID8gbmFtZSA6ICdydW50aW1lQ2F0YWxvZ3VlJztcclxuICAgIGNvbnN0IHN0b3JhZ2VTY2hlbWEgPSBzY2hlbWEgPyBzY2hlbWEgOiAnJmNndWlkLCBhY2Nlc3NDb250cm9sUG9saWN5LCBjb25zdHJhaW50cywgZGF0YU9iamVjdHMsIGh5cGVydHlUeXBlLCBvYmplY3ROYW1lLCBzb3VyY2VQYWNrYWdlLCB2ZXJzaW9uJztcclxuXHJcbiAgICBjb25zdCBzY2hlbWFzID0ge307XHJcbiAgICBzY2hlbWFzW3N0b3JhZ2VOYW1lXSA9IHN0b3JhZ2VTY2hlbWE7XHJcblxyXG4gICAgdGhpcy5zdG9yYWdlTWFuYWdlciA9IHJ1bnRpbWVGYWN0b3J5LnN0b3JhZ2VNYW5hZ2VyKHN0b3JhZ2VOYW1lLCBzY2hlbWFzKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIEdldCBhIENhdGFsb2d1ZSBEYXRhIE9iamVjdCAoRGVzY3JpcHRvcikgZnJvbSBhIFVSTCwgYW5kIGNvbnN0cnVjdCBpdCB1c2luZyB0aGUgcHJvdmlkZWQgZnVuY3Rpb25cclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkZXNjcmlwdG9yVVJMIC0gZS5nLiBteWRvbWFpbi5jb20vLndlbGwta25vd24vaHlwZXJ0eS9NeUh5cGVydHlcclxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNyZWF0ZUZ1bmMgLSBlLmcuIGNyZWF0ZUh5cGVydHlcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2dldEZ1bGxdIC0gd2hldGhlciBvciBub3QgdG8gZ2V0IGRlc2NyaXB0b3Igd2l0aCBzb3VyY2VQYWNrYWdlLCBvciBvbmx5IHRoZSBkZXNjcmlwdG9yIHBhcnRcclxuICAgICAqIEBwYXJhbSB7SlNPTn0gY29uc3RyYWludHMgLSBjb25zdHJhaW50cyBvYmplY3RcclxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfSAtIFByb21pc2UgdGhhdCBmdWxmaWxscyB3aXRoIHRoZSByZXF1ZXN0ZWQgZGVzY3JpcHRvciBpbiB0aGUgYXBwcm9wcmlhdGUgdHlwZS5cclxuICAgICAqIElmIGNvbnN0cmFpbnRzIHdlcmUgcHJvdmlkZWQsIGEgZGVzY3JpcHRvciBpcyBvbmx5IHJldHVybmVkIGlmIGl0IG1lZXRzIHRoZSBjb25zdHJhaW50cywgb3RoZXJ3aXNlIHRoZSBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQuXHJcbiAgICAgKi9cclxuICBnZXREZXNjcmlwdG9yKGRlc2NyaXB0b3JVUkwsIGNyZWF0ZUZ1bmMsIGdldEZ1bGwgPSB0cnVlLCBjb25zdHJhaW50cykge1xyXG4gICAgbG9nLmluZm8oJ1tSdW50aW1lQ2F0YWxvZ3VlXSAtIGdldHRpbmcgZGVzY3JpcHRvciBmcm9tOiAnLCBkZXNjcmlwdG9yVVJMLCAnIHdpdGggY29uc3RyYWludHM6ICcsIGNvbnN0cmFpbnRzKTtcclxuXHJcbiAgICAvLyBzb21lIGZsYWdzIGZvciBvcHRpbWl6YXRpb25cclxuICAgIC8vIChsYXRlciB0aGUgZGVzY3JpcHRvciB3aWxsIG5vdCBiZSBzYXZlZCBpbiBjYXNlIGJvdGggb2YgdGhlc2UgYm9vbGVhbnMgYXJlIHRydWUpXHJcbiAgICBsZXQgaXNTYXZlZERlc2NyaXB0b3IgPSBmYWxzZTtcclxuICAgIGxldCBpc0NvbXBsZXRlRGVzY3JpcHRvciA9IGZhbHNlO1xyXG5cclxuICAgIC8vIGdldCByYXcgZGVzY3JpcHRvclxyXG4gICAgLy8gZmlyc3QgY2hlY2tzIGlmIGRlc2NyaXB0b3IgaXMgYWxyZWFkeSBpbiBsb2NhbFN0b3JhZ2UgKGJhc2VkIG9uIGNndWlkIGFuZCB2ZXJzaW9uKVxyXG4gICAgbGV0IGRlc2NyaXB0b3JQcm9taXNlO1xyXG4gICAgaWYgKGNvbnN0cmFpbnRzICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICBkZXNjcmlwdG9yUHJvbWlzZSA9IFByb21pc2UuYWxsKFt0aGlzLmh0dHBSZXF1ZXN0LnBvc3QoZGVzY3JpcHRvclVSTCArICcvdmVyc2lvbicsIHtib2R5OiBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cyl9KSwgdGhpcy5odHRwUmVxdWVzdC5wb3N0KGRlc2NyaXB0b3JVUkwgKyAnL2NndWlkJywge2JvZHk6IEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKX0pXSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGRlc2NyaXB0b3JQcm9taXNlID0gUHJvbWlzZS5hbGwoW3RoaXMuaHR0cFJlcXVlc3QuZ2V0KGRlc2NyaXB0b3JVUkwgKyAnL3ZlcnNpb24nKSwgdGhpcy5odHRwUmVxdWVzdC5nZXQoZGVzY3JpcHRvclVSTCArICcvY2d1aWQnKV0pXHJcbiAgICB9XHJcbiAgICBkZXNjcmlwdG9yUHJvbWlzZSA9IGRlc2NyaXB0b3JQcm9taXNlLnRoZW4oKFt2ZXJzaW9uLCBjZ3VpZF0pID0+IHtcclxuICAgICAgbG9nLmxvZygnW1J1bnRpbWVDYXRhbG9ndWUuZ2V0RGVzY3JpcHRvcl0gLSBnb3QgdmVyc2lvbiAoJyArIHZlcnNpb24gKyAnKSBhbmQgY2d1aWQgKCcgKyBjZ3VpZCArICcpIGZvciBkZXNjcmlwdG9yICcgKyBkZXNjcmlwdG9yVVJMKTtcclxuXHJcbiAgICAgIC8vIGNoZWNrIGlmIHNhbWUgdmVyc2lvbiBpcyBjb250YWluZWQgaW4gbG9jYWxTdG9yYWdlXHJcbiAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2VNYW5hZ2VyLmdldFZlcnNpb24oJ2NndWlkJywgY2d1aWQpLnRoZW4oKGRiVmVyc2lvbikgPT4ge1xyXG4gICAgICAgIGlmIChkYlZlcnNpb24gPj0gdmVyc2lvbikge1xyXG4gICAgICAgICAgbG9nLmxvZygnW1J1bnRpbWVDYXRhbG9ndWUuZ2V0RGVzY3JpcHRvcl0gbG9jYWwgdmVyc2lvbiBpcyB1cGRhdGVkIGZvciAnLCBkZXNjcmlwdG9yVVJMKTtcclxuICAgICAgICAgIGlzU2F2ZWREZXNjcmlwdG9yID0gdHJ1ZTtcclxuICAgICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2VNYW5hZ2VyLmdldCgnY2d1aWQnLCBjZ3VpZCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZy5sb2coJ1tSdW50aW1lQ2F0YWxvZ3VlLmdldERlc2NyaXB0b3JdIGxvY2FsIHZlcnNpb24gbm90IHVwZGF0ZWQgZm9yICcsIGRlc2NyaXB0b3JVUkwsICcgcmV0cmlldmluZyBmcm9tIHJlbW90ZSBjYXRhbG9ndWUgLi4uJyk7XHJcblxyXG4gICAgICAgICAgLy8gbm8gc2F2ZWQgY29weSwgcHJvY2VlZCB3aXRoIHJldHJpZXZpbmcgZGVzY3JpcHRvclxyXG4gICAgICAgICAgbGV0IHJldHJpZXZlUHJvbWlzZSA9IGNvbnN0cmFpbnRzICE9IHVuZGVmaW5lZCA/IHRoaXMuaHR0cFJlcXVlc3QucG9zdChkZXNjcmlwdG9yVVJMLCB7Ym9keTogSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpfSkgOiB0aGlzLmh0dHBSZXF1ZXN0LmdldChkZXNjcmlwdG9yVVJMKTtcclxuICAgICAgICAgIHJldHVybiByZXRyaWV2ZVByb21pc2UudGhlbigoZGVzY3JpcHRvcikgPT4ge1xyXG4gICAgICAgICAgICBkZXNjcmlwdG9yID0gSlNPTi5wYXJzZShkZXNjcmlwdG9yKTtcclxuXHJcbiAgICAgICAgICAgIC8vbG9nLmxvZyhcImdvdCBkZXNjcmlwdG9yOlwiLCBKU09OLnN0cmluZ2lmeShkZXNjcmlwdG9yLCBudWxsLCAyKSk7XHJcbiAgICAgICAgICAgIGlmIChkZXNjcmlwdG9yWydFUlJPUiddKSB7XHJcbiAgICAgICAgICAgICAgLy8gVE9ETyBoYW5kbGUgZXJyb3IgcHJvcGVybHlcclxuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGVzY3JpcHRvcik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH0pLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBsZXQgZXJyb3JTdHJpbmcgPSAnVW5hYmxlIHRvIGdldCBkZXNjcmlwdG9yIGZvciAnICsgZGVzY3JpcHRvclVSTCArIChjb25zdHJhaW50cyAhPSB1bmRlZmluZWQgPyAnIHdpdGggY29uc3RyYWludHMgJyArIGNvbnN0cmFpbnRzIDogJycpICsgJzogJyArIGVycm9yO1xyXG4gICAgICBsb2cuZXJyb3IoZXJyb3JTdHJpbmcpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JTdHJpbmcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IHJldHVyblByb21pc2UgPSBkZXNjcmlwdG9yUHJvbWlzZTtcclxuXHJcbiAgICAvLyBpZiBnZXRGdWxsLCBhdHRhY2ggc291cmNlUGFja2FnZVxyXG4gICAgaWYgKGdldEZ1bGwpIHtcclxuICAgICAgbG9nLmxvZygnYWRkaW5nIHByb21pc2UgdG8gYXR0YWNoIHNvdXJjZVBhY2thZ2UnKTtcclxuICAgICAgcmV0dXJuUHJvbWlzZSA9IGRlc2NyaXB0b3JQcm9taXNlLnRoZW4oKGRlc2NyaXB0b3IpID0+IHtcclxuICAgICAgICBpZiAoZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlKSB7XHJcbiAgICAgICAgICBpc0NvbXBsZXRlRGVzY3JpcHRvciA9IHRydWU7XHJcbiAgICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaXNDb21wbGV0ZURlc2NyaXB0b3IgPSBmYWxzZTtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmF0dGFjaFJhd1NvdXJjZVBhY2thZ2UoZGVzY3JpcHRvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGZpbmFsbHkgY3JlYXRlIG9iamVjdFxyXG4gICAgcmV0dXJuUHJvbWlzZSA9IHJldHVyblByb21pc2UudGhlbigoZGVzY3JpcHRvcikgPT4ge1xyXG4gICAgICAvLyBzdG9yZSBpZiBub3Qgc2F2ZWQgYmVmb3JlLCBvciBpZiBmdWxsIGRlc2NyaXB0b3Igd2FzIHJlcXVlc3RlZCBhbmQgb25seSBwYXJ0aWFsIGRlc2NyaXB0b3Igd2FzIHN0b3JlZC5cclxuICAgICAgaWYgKCFpc1NhdmVkRGVzY3JpcHRvciB8fCAoaXNTYXZlZERlc2NyaXB0b3IgJiYgIWlzQ29tcGxldGVEZXNjcmlwdG9yICYmIGdldEZ1bGwpKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlTWFuYWdlci5zZXQoZGVzY3JpcHRvci5jZ3VpZCwgZGVzY3JpcHRvci52ZXJzaW9uLCBkZXNjcmlwdG9yKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gY3JlYXRlRnVuYy5hcHBseSh0aGlzLCBbZGVzY3JpcHRvciwgY29uc3RyYWludHNdKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByZXR1cm5Qcm9taXNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICAgKiBVc2VzIHRoZSBzb3VyY2VQYWNrYWdlVVJMIGZyb20gdGhlIGRlc2NyaXB0b3IsIHJlcXVlc3RzIHRoZSBzb3VyY2VQYWNrYWdlIGFuZCBhdHRhY2hlcyBpdCB0byB0aGUgZGVzY3JpcHRvci5cclxuICAgICAqIEBwYXJhbSB7Q2F0YWxvZ3VlRGF0YU9iamVjdH0gZGVzY3JpcHRvclxyXG4gICAgICogQHBhcmFtIHtKU09OfSBjb25zdHJhaW50cyAtIGNvbnN0cmFpbnRzIG9iamVjdFxyXG4gICAgICogQHJldHVybnMge1Byb21pc2V9IC0gZnVsZmlsbHMgd2l0aCBjb21wbGV0ZSBkZXNjcmlwdG9yXHJcbiAgICAgKi9cclxuICBhdHRhY2hSYXdTb3VyY2VQYWNrYWdlKGRlc2NyaXB0b3IsIGNvbnN0cmFpbnRzKSB7XHJcbiAgICBsb2cubG9nKCdhdHRhY2hpbmcgcmF3IHNvdXJjZVBhY2thZ2UgZnJvbTonLCBkZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2VVUkwpO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgbGV0IHJldHJpZXZlUHJvbWlzZSA9IGNvbnN0cmFpbnRzICE9IHVuZGVmaW5lZCA/IHRoaXMuaHR0cFJlcXVlc3QucG9zdChkZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2VVUkwsIHtib2R5OiBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cyl9KSA6IHRoaXMuaHR0cFJlcXVlc3QuZ2V0KGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZVVSTCk7XHJcbiAgICAgIHJldHJpZXZlUHJvbWlzZS50aGVuKChzb3VyY2VQYWNrYWdlKSA9PiB7XHJcbiAgICAgICAgc291cmNlUGFja2FnZSA9IEpTT04ucGFyc2Uoc291cmNlUGFja2FnZSk7XHJcblxyXG4gICAgICAgIC8vZGVsZXRlIGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZVVSTDtcclxuICAgICAgICAvL2xvZy5sb2coXCJhdHRhY2hpbmcgc291cmNlUGFja2FnZTpcIiwgc291cmNlUGFja2FnZSk7XHJcbiAgICAgICAgZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlID0gc291cmNlUGFja2FnZTtcclxuICAgICAgICByZXNvbHZlKGRlc2NyaXB0b3IpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgcmVqZWN0KHJlYXNvbik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIEdldCBIeXBlcnR5RGVzY3JpcHRvclxyXG4gICAgICogQHBhcmFtIGh5cGVydHlVUkwgLSBlLmcuIG15ZG9tYWluLmNvbS8ud2VsbC1rbm93bi9oeXBlcnR5L015SHlwZXJ0eVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZ2V0RnVsbF0gLSBib29sZWFuIHRvIGRlY2lkZSB0byBnZXQgdGhlIGRlc2NyaXB0b3Igd2l0aCB0aGUgc291cmNlUGFja2FnZSBvciAocG90ZW50aWFsbHkpIHdpdGhvdXRcclxuICAgICAqIEBwYXJhbSB7SlNPTn0gY29uc3RyYWludHMgLSBjb25zdHJhaW50cyBvYmplY3RcclxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAgICovXHJcbiAgZ2V0SHlwZXJ0eURlc2NyaXB0b3IoaHlwZXJ0eVVSTCwgZ2V0RnVsbCA9IHRydWUsIGNvbnN0cmFpbnRzKSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXREZXNjcmlwdG9yKGh5cGVydHlVUkwsIHRoaXMuY3JlYXRlSHlwZXJ0eSwgZ2V0RnVsbCwgY29uc3RyYWludHMpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIEdldCBTdHViRGVzY3JpcHRvclxyXG4gICAgICogQHBhcmFtIHN0dWJVUkwgLSBlLmcuIG15ZG9tYWluLmNvbS8ud2VsbC1rbm93bi9wcm90b3N0dWIvTXlQcm90b3N0dWJcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2dldEZ1bGxdIC0gYm9vbGVhbiB0byBkZWNpZGUgdG8gZ2V0IHRoZSBkZXNjcmlwdG9yIHdpdGggdGhlIHNvdXJjZVBhY2thZ2Ugb3IgKHBvdGVudGlhbGx5KSB3aXRob3V0XHJcbiAgICAgKiBAcGFyYW0ge0pTT059IGNvbnN0cmFpbnRzIC0gY29uc3RyYWludHMgb2JqZWN0XHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgICAqL1xyXG4gIGdldFN0dWJEZXNjcmlwdG9yKHN0dWJVUkwsIGdldEZ1bGwgPSB0cnVlLCBjb25zdHJhaW50cykge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0RGVzY3JpcHRvcihzdHViVVJMLCB0aGlzLmNyZWF0ZVN0dWIsIGdldEZ1bGwsIGNvbnN0cmFpbnRzKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICAgKiBHZXQgUnVudGltZURlc2NyaXB0b3JcclxuICAgICAqIEBwYXJhbSBydW50aW1lVVJMIC0gZS5nLiBteWRvbWFpbi5jb20vLndlbGwta25vd24vcnVudGltZS9NeVJ1bnRpbWVcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2dldEZ1bGxdIC0gYm9vbGVhbiB0byBkZWNpZGUgdG8gZ2V0IHRoZSBkZXNjcmlwdG9yIHdpdGggdGhlIHNvdXJjZVBhY2thZ2Ugb3IgKHBvdGVudGlhbGx5KSB3aXRob3V0XHJcbiAgICAgKiBAcGFyYW0ge0pTT059IGNvbnN0cmFpbnRzIC0gY29uc3RyYWludHMgb2JqZWN0XHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgICAqL1xyXG4gIGdldFJ1bnRpbWVEZXNjcmlwdG9yKHJ1bnRpbWVVUkwsIGdldEZ1bGwgPSB0cnVlLCBjb25zdHJhaW50cykge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0RGVzY3JpcHRvcihydW50aW1lVVJMLCB0aGlzLmNyZWF0ZVJ1bnRpbWVEZXNjcmlwdG9yLCBnZXRGdWxsLCBjb25zdHJhaW50cylcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAgICogR2V0IERhdGFTY2hlbWFEZXNjcmlwdG9yXHJcbiAgICAgKiBAcGFyYW0gZGF0YVNjaGVtYVVSTCAtIGUuZy4gbXlkb21haW4uY29tLy53ZWxsLWtub3duL2RhdGFzY2hlbWEvTXlEYXRhU2NoZW1hXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtnZXRGdWxsXSAtIGJvb2xlYW4gdG8gZGVjaWRlIHRvIGdldCB0aGUgZGVzY3JpcHRvciB3aXRoIHRoZSBzb3VyY2VQYWNrYWdlIG9yIChwb3RlbnRpYWxseSkgd2l0aG91dFxyXG4gICAgICogQHBhcmFtIHtKU09OfSBjb25zdHJhaW50cyAtIGNvbnN0cmFpbnRzIG9iamVjdFxyXG4gICAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICAgKi9cclxuICBnZXREYXRhU2NoZW1hRGVzY3JpcHRvcihkYXRhU2NoZW1hVVJMLCBnZXRGdWxsID0gdHJ1ZSwgY29uc3RyYWludHMpIHtcclxuXHJcbiAgICAvLyAgICByZXR1cm4gdGhpcy5nZXREZXNjcmlwdG9yKGRhdGFTY2hlbWFVUkwsIHRoaXMuY3JlYXRlRGF0YVNjaGVtYSwgZ2V0RnVsbCwgY29uc3RyYWludHMpXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpPT4ge1xyXG4gICAgICBsZXQgc2NoZW1hID0gZGF0YVNjaGVtYVVSTC5zcGxpdCgnL2RhdGFzY2hlbWEvJylbMV07XHJcbiAgICAgIGxvZy5sb2coJ1tSdW50aW1lQ2F0YWxvZ3VlLmdldERhdGFTY2hlbWFEZXNjcmlwdG9yXSBzY2hlbWEgJywgc2NoZW1hKTtcclxuICAgICAgbGV0IGRlc2NyaXB0b3IgPSB7XHJcbiAgICAgICAgc291cmNlUGFja2FnZToge1xyXG4gICAgICAgICAgc291cmNlQ29kZToge1xyXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgLy8gICAgICBsZXQgc2NoZW1lID0gcHJvcGVydGllcy5zY2hlbWUgPyBwcm9wZXJ0aWVzLnNjaGVtZS5jbyA6IFtdO1xyXG4gIFxyXG4gICAgICBzd2l0Y2ggKHNjaGVtYSkge1xyXG4gICAgICAgIGNhc2UgJ0NvbnRleHQnOlxyXG4gICAgICAgIGNhc2UgJ0NvbnRleHRSZXBvcnRlcic6XHJcbiAgICAgICAgY2FzZSAnQ29udGV4dE9ic2VydmVyJzpcclxuICAgICAgICAgIGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlLnByb3BlcnRpZXMuc2NoZW1lID0gJ2NvbnRleHQnO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnQ29ubmVjdGlvbic6XHJcbiAgICAgICAgICBkZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2Uuc291cmNlQ29kZS5wcm9wZXJ0aWVzLnNjaGVtZSA9ICdjb25uZWN0aW9uJztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ1dhbGxldERhdGEnOlxyXG4gICAgICAgICAgZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUucHJvcGVydGllcy5zY2hlbWUgPSAnd2FsbGV0RGF0YSc7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdDb21tdW5pY2F0aW9uJzpcclxuICAgICAgICAgIGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlLnByb3BlcnRpZXMuc2NoZW1lID0gJ2NvbW0nO1xyXG4gICAgICAgICAgZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUucHJvcGVydGllcy5jaGlsZHJlbnMgPSBbJ3Jlc291cmNlcyddO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnSGVsbG9Xb3JsZERhdGFTY2hlbWEnOlxyXG4gICAgICAgICAgZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUucHJvcGVydGllcy5zY2hlbWUgPSAnaGVsbG8nO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlLnByb3BlcnRpZXMuc2NoZW1lID0gJ3Jlc291cmNlJztcclxuICAgICAgICAgIGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlLnByb3BlcnRpZXMuY2hpbGRyZW5zID0gW107XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICByZXNvbHZlKGRlc2NyaXB0b3IpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIEdldCBJRFBQcm94eURlc2NyaXB0b3JcclxuICAgICAqIEBwYXJhbSBpZHBQcm94eVVSTCAtIGUuZy4gbXlkb21haW4uY29tLy53ZWxsLWtub3duL2lkcC1wcm94eS9NeVByb3h5XHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtnZXRGdWxsXSAtIGJvb2xlYW4gdG8gZGVjaWRlIHRvIGdldCB0aGUgZGVzY3JpcHRvciB3aXRoIHRoZSBzb3VyY2VQYWNrYWdlIG9yIChwb3RlbnRpYWxseSkgd2l0aG91dFxyXG4gICAgICogQHBhcmFtIHtKU09OfSBjb25zdHJhaW50cyAtIGNvbnN0cmFpbnRzIG9iamVjdFxyXG4gICAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICAgKi9cclxuICBnZXRJZHBQcm94eURlc2NyaXB0b3IoaWRwUHJveHlVUkwsIGdldEZ1bGwgPSB0cnVlLCBjb25zdHJhaW50cykge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0RGVzY3JpcHRvcihpZHBQcm94eVVSTCwgdGhpcy5jcmVhdGVJZHBQcm94eSwgZ2V0RnVsbCwgY29uc3RyYWludHMpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIENyZWF0ZSBIeXBlcnR5RGVzY3JpcHRvciBiYXNlZCBvbiByYXcgb2JqZWN0IHRoYXQgY29udGFpbnMgaXRzIGF0dHJpYnV0ZXNcclxuICAgICAqIEBwYXJhbSB7SlNPTn0gcmF3SHlwZXJ0eVxyXG4gICAgICogQHJldHVybnMge0h5cGVydHlEZXNjcmlwdG9yfVxyXG4gICAgICovXHJcbiAgY3JlYXRlSHlwZXJ0eShyYXdIeXBlcnR5KSB7XHJcbiAgICAvL2xvZy5sb2coXCJjcmVhdGVIeXBlcnR5OlwiLCByYXdIeXBlcnR5KTtcclxuICAgIC8vIGNyZWF0ZSB0aGUgZGVzY3JpcHRvclxyXG4gICAgbGV0IGh5cGVydHkgPSB0aGlzLl9mYWN0b3J5LmNyZWF0ZUh5cGVydHlEZXNjcmlwdG9yT2JqZWN0KFxyXG4gICAgICByYXdIeXBlcnR5WydjZ3VpZCddLFxyXG4gICAgICByYXdIeXBlcnR5Wyd2ZXJzaW9uJ10sXHJcbiAgICAgIHJhd0h5cGVydHlbJ29iamVjdE5hbWUnXSxcclxuICAgICAgcmF3SHlwZXJ0eVsnZGVzY3JpcHRpb24nXSxcclxuICAgICAgcmF3SHlwZXJ0eVsnbGFuZ3VhZ2UnXSxcclxuICAgICAgcmF3SHlwZXJ0eVsnc291cmNlUGFja2FnZVVSTCddLFxyXG4gICAgICByYXdIeXBlcnR5Wyd0eXBlJ10gfHwgcmF3SHlwZXJ0eVsnaHlwZXJ0eVR5cGUnXSxcclxuICAgICAgcmF3SHlwZXJ0eVsnZGF0YU9iamVjdHMnXVxyXG4gICAgKTtcclxuXHJcbiAgICAvL2xvZy5sb2coXCJmYWN0b3J5IHJldHVybmVkOlwiLCBoeXBlcnR5KTtcclxuXHJcbiAgICAvLyBvcHRpb25hbCBmaWVsZHNcclxuICAgIGh5cGVydHkuY29uZmlndXJhdGlvbiA9IHJhd0h5cGVydHlbJ2NvbmZpZ3VyYXRpb24nXTtcclxuICAgIGh5cGVydHkuY29uc3RyYWludHMgPSByYXdIeXBlcnR5Wydjb25zdHJhaW50cyddO1xyXG4gICAgaHlwZXJ0eS5tZXNzYWdlU2NoZW1hID0gcmF3SHlwZXJ0eVsnbWVzc2FnZVNjaGVtYSddO1xyXG4gICAgaHlwZXJ0eS5wb2xpY2llcyA9IHJhd0h5cGVydHlbJ3BvbGljaWVzJ107XHJcbiAgICBoeXBlcnR5LnNpZ25hdHVyZSA9IHJhd0h5cGVydHlbJ3NpZ25hdHVyZSddO1xyXG5cclxuICAgIC8vIHBhcnNlIGFuZCBhdHRhY2ggc291cmNlUGFja2FnZVxyXG4gICAgbGV0IHNvdXJjZVBhY2thZ2UgPSByYXdIeXBlcnR5Wydzb3VyY2VQYWNrYWdlJ107XHJcbiAgICBpZiAoc291cmNlUGFja2FnZSkge1xyXG4gICAgICBoeXBlcnR5LnNvdXJjZVBhY2thZ2UgPSB0aGlzLmNyZWF0ZVNvdXJjZVBhY2thZ2Uoc291cmNlUGFja2FnZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGh5cGVydHk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIENyZWF0ZSBQcm90b2NvbFN0dWJEZXNjcmlwdG9yIGJhc2VkIG9uIHJhdyBvYmplY3QgdGhhdCBjb250YWlucyBpdHMgYXR0cmlidXRlc1xyXG4gICAgICogQHBhcmFtIHJhd1N0dWJcclxuICAgICAqIEByZXR1cm5zIHtQcm90b2NvbFN0dWJEZXNjcmlwdG9yfVxyXG4gICAgICovXHJcbiAgY3JlYXRlU3R1YihyYXdTdHViKSB7XHJcbiAgICAvLyBsb2cubG9nKFwiY3JlYXRpbmcgc3R1YiBkZXNjcmlwdG9yIGJhc2VkIG9uOiBcIiwgcmF3U3R1Yik7XHJcblxyXG4gICAgLy8gY3JlYXRlIHRoZSBkZXNjcmlwdG9yXHJcbiAgICBsZXQgc3R1YiA9IHRoaXMuX2ZhY3RvcnkuY3JlYXRlUHJvdG9TdHViRGVzY3JpcHRvck9iamVjdChcclxuICAgICAgcmF3U3R1YlsnY2d1aWQnXSxcclxuICAgICAgcmF3U3R1YlsndmVyc2lvbiddLFxyXG4gICAgICByYXdTdHViWydvYmplY3ROYW1lJ10sXHJcbiAgICAgIHJhd1N0dWJbJ2Rlc2NyaXB0aW9uJ10sXHJcbiAgICAgIHJhd1N0dWJbJ2xhbmd1YWdlJ10sXHJcbiAgICAgIHJhd1N0dWJbJ3NvdXJjZVBhY2thZ2VVUkwnXSxcclxuICAgICAgcmF3U3R1YlsnbWVzc2FnZVNjaGVtYXMnXSxcclxuICAgICAgcmF3U3R1YlsnY29uZmlndXJhdGlvbiddLFxyXG4gICAgICByYXdTdHViWydjb25zdHJhaW50cyddLFxyXG4gICAgICByYXdTdHViWydoeXBlcnR5VHlwZSddLFxyXG4gICAgICByYXdTdHViWydkYXRhT2JqZWN0cyddLFxyXG4gICAgICByYXdTdHViWydpbnRlcndvcmtpbmcnXSxcclxuICAgICAgcmF3U3R1YlsnaWRwUHJveHknXSxcclxuICAgICAgcmF3U3R1YlsnbXV0dWFsQXV0aGVudGljYXRpb24nXVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBvcHRpb25hbCBmaWVsZHNcclxuICAgIHN0dWIuc2lnbmF0dXJlID0gcmF3U3R1Ylsnc2lnbmF0dXJlJ107XHJcblxyXG4gICAgLy8gcGFyc2UgYW5kIGF0dGFjaCB0aGUgc291cmNlUGFja2FnZVxyXG4gICAgbGV0IHNvdXJjZVBhY2thZ2UgPSByYXdTdHViWydzb3VyY2VQYWNrYWdlJ107XHJcbiAgICBpZiAoc291cmNlUGFja2FnZSkge1xyXG4gICAgICBzdHViLnNvdXJjZVBhY2thZ2UgPSB0aGlzLmNyZWF0ZVNvdXJjZVBhY2thZ2Uoc291cmNlUGFja2FnZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHN0dWI7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIENyZWF0ZSBIeXBlcnR5UnVudGltZURlc2NyaXB0b3IgYmFzZWQgb24gcmF3IG9iamVjdCB0aGF0IGNvbnRhaW5zIGl0cyBhdHRyaWJ1dGVzXHJcbiAgICAgKiBAcGFyYW0gcmF3UnVudGltZVxyXG4gICAgICogQHJldHVybnMge0h5cGVydHlSdW50aW1lRGVzY3JpcHRvcn1cclxuICAgICAqL1xyXG4gIGNyZWF0ZVJ1bnRpbWVEZXNjcmlwdG9yKHJhd1J1bnRpbWUpIHtcclxuICAgIC8vIHBhcnNlIGNhcGFiaWxpdGllcyBmaXJzdFxyXG4gICAgdHJ5IHtcclxuICAgICAgcmF3UnVudGltZVsnaHlwZXJ0eUNhcGFiaWxpdGllcyddID0gSlNPTi5wYXJzZShyYXdSdW50aW1lWydoeXBlcnR5Q2FwYWJpbGl0aWVzJ10pO1xyXG4gICAgICByYXdSdW50aW1lWydwcm90b2NvbENhcGFiaWxpdGllcyddID0gSlNPTi5wYXJzZShyYXdSdW50aW1lWydwcm90b2NvbENhcGFiaWxpdGllcyddKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgLy8gYWxyZWFkeSBqc29uIG9iamVjdFxyXG4gICAgfVxyXG5cclxuICAgIC8vbG9nLmxvZyhcImNyZWF0aW5nIHJ1bnRpbWUgZGVzY3JpcHRvciBiYXNlZCBvbjogXCIsIHJhd1J1bnRpbWUpO1xyXG5cclxuXHJcbiAgICAvLyBjcmVhdGUgdGhlIGRlc2NyaXB0b3JcclxuICAgIGxldCBydW50aW1lID0gdGhpcy5fZmFjdG9yeS5jcmVhdGVIeXBlcnR5UnVudGltZURlc2NyaXB0b3JPYmplY3QoXHJcbiAgICAgIHJhd1J1bnRpbWVbJ2NndWlkJ10sXHJcbiAgICAgIHJhd1J1bnRpbWVbJ3ZlcnNpb24nXSxcclxuICAgICAgcmF3UnVudGltZVsnb2JqZWN0TmFtZSddLFxyXG4gICAgICByYXdSdW50aW1lWydkZXNjcmlwdGlvbiddLFxyXG4gICAgICByYXdSdW50aW1lWydsYW5ndWFnZSddLFxyXG4gICAgICByYXdSdW50aW1lWydzb3VyY2VQYWNrYWdlVVJMJ10sXHJcbiAgICAgIHJhd1J1bnRpbWVbJ3R5cGUnXSB8fCByYXdSdW50aW1lWydydW50aW1lVHlwZSddLFxyXG4gICAgICByYXdSdW50aW1lWydoeXBlcnR5Q2FwYWJpbGl0aWVzJ10sXHJcbiAgICAgIHJhd1J1bnRpbWVbJ3Byb3RvY29sQ2FwYWJpbGl0aWVzJ10sXHJcbiAgICAgIHJhd1J1bnRpbWVbJ3AycEhhbmRsZXJTdHViJ10sXHJcbiAgICAgIHJhd1J1bnRpbWVbJ3AycFJlcXVlc3RlclN0dWInXVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBvcHRpb25hbCBmaWVsZHNcclxuICAgIHJ1bnRpbWUuc2lnbmF0dXJlID0gcmF3UnVudGltZVsnc2lnbmF0dXJlJ107XHJcblxyXG4gICAgLy8gcGFyc2UgYW5kIGF0dGFjaCBzb3VyY2VQYWNrYWdlXHJcbiAgICBsZXQgc291cmNlUGFja2FnZSA9IHJhd1J1bnRpbWVbJ3NvdXJjZVBhY2thZ2UnXTtcclxuICAgIGlmIChzb3VyY2VQYWNrYWdlKSB7XHJcbiAgICAgIC8vIGxvZy5sb2coXCJydW50aW1lIGhhcyBzb3VyY2VQYWNrYWdlOlwiLCBzb3VyY2VQYWNrYWdlKTtcclxuICAgICAgcnVudGltZS5zb3VyY2VQYWNrYWdlID0gdGhpcy5jcmVhdGVTb3VyY2VQYWNrYWdlKHNvdXJjZVBhY2thZ2UpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJ1bnRpbWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIENyZWF0ZSBEYXRhT2JqZWN0U2NoZW1hIGJhc2VkIG9uIHJhdyBvYmplY3QgdGhhdCBjb250YWlucyBpdHMgYXR0cmlidXRlc1xyXG4gICAgICogQHBhcmFtIHJhd1NjaGVtYVxyXG4gICAgICogQHJldHVybnMge0RhdGFPYmplY3RTY2hlbWF9XHJcbiAgICAgKi9cclxuICBjcmVhdGVEYXRhU2NoZW1hKHJhd1NjaGVtYSkge1xyXG4gICAgLy9sb2cubG9nKFwiY3JlYXRpbmcgZGF0YVNjaGVtYSBiYXNlZCBvbjogXCIsIHJhd1NjaGVtYSk7XHJcblxyXG4gICAgbGV0IGRhdGFTY2hlbWE7XHJcblxyXG4gICAgLy9sb2cubG9nKCcxLiBjcmVhdGVNZXNzYWdlRGF0YU9iamVjdFNjaGVtYTogJywgcmF3U2NoZW1hW1wiYWNjZXNzQ29udHJvbFBvbGljeVwiXSk7XHJcbiAgICAvL2xvZy5sb2coJzIuIGNyZWF0ZU1lc3NhZ2VEYXRhT2JqZWN0U2NoZW1hOiAnLCByYXdTY2hlbWFbXCJzY2hlbWVcIl0pO1xyXG4gICAgaWYgKHJhd1NjaGVtYVsnYWNjZXNzQ29udHJvbFBvbGljeSddICYmIHJhd1NjaGVtYVsnc2NoZW1lJ10pIHtcclxuICAgICAgZGF0YVNjaGVtYSA9IHRoaXMuX2ZhY3RvcnkuY3JlYXRlSHlwZXJ0eURhdGFPYmplY3RTY2hlbWEoXHJcbiAgICAgICAgcmF3U2NoZW1hWydjZ3VpZCddLFxyXG4gICAgICAgIHJhd1NjaGVtYVsndmVyc2lvbiddLFxyXG4gICAgICAgIHJhd1NjaGVtYVsnb2JqZWN0TmFtZSddLFxyXG4gICAgICAgIHJhd1NjaGVtYVsnZGVzY3JpcHRpb24nXSxcclxuICAgICAgICByYXdTY2hlbWFbJ2xhbmd1YWdlJ10sXHJcbiAgICAgICAgcmF3U2NoZW1hWydzb3VyY2VQYWNrYWdlVVJMJ10sXHJcbiAgICAgICAgcmF3U2NoZW1hWydhY2Nlc3NDb250cm9sUG9saWN5J10sXHJcbiAgICAgICAgcmF3U2NoZW1hWydzY2hlbWUnXVxyXG4gICAgICApXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvL2xvZy5sb2coJzMuIGNyZWF0ZU1lc3NhZ2VEYXRhT2JqZWN0U2NoZW1hOiAnLCByYXdTY2hlbWEpO1xyXG4gICAgICBkYXRhU2NoZW1hID0gdGhpcy5fZmFjdG9yeS5jcmVhdGVNZXNzYWdlRGF0YU9iamVjdFNjaGVtYShcclxuICAgICAgICByYXdTY2hlbWFbJ2NndWlkJ10sXHJcbiAgICAgICAgcmF3U2NoZW1hWyd2ZXJzaW9uJ10sXHJcbiAgICAgICAgcmF3U2NoZW1hWydvYmplY3ROYW1lJ10sXHJcbiAgICAgICAgcmF3U2NoZW1hWydkZXNjcmlwdGlvbiddLFxyXG4gICAgICAgIHJhd1NjaGVtYVsnbGFuZ3VhZ2UnXSxcclxuICAgICAgICByYXdTY2hlbWFbJ3NvdXJjZVBhY2thZ2VVUkwnXVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gb3B0aW9uYWwgZmllbGRzXHJcbiAgICBkYXRhU2NoZW1hLnNpZ25hdHVyZSA9IHJhd1NjaGVtYVsnc2lnbmF0dXJlJ107XHJcblxyXG4gICAgLy8gcGFyc2UgYW5kIGF0dGFjaCBzb3VyY2VQYWNrYWdlXHJcbiAgICBsZXQgc291cmNlUGFja2FnZSA9IHJhd1NjaGVtYVsnc291cmNlUGFja2FnZSddO1xyXG4gICAgaWYgKHNvdXJjZVBhY2thZ2UpIHtcclxuICAgICAgLy9sb2cubG9nKFwiZGF0YVNjaGVtYSBoYXMgc291cmNlUGFja2FnZTpcIiwgc291cmNlUGFja2FnZSk7XHJcbiAgICAgIGRhdGFTY2hlbWEuc291cmNlUGFja2FnZSA9IHRoaXMuY3JlYXRlU291cmNlUGFja2FnZShzb3VyY2VQYWNrYWdlKTtcclxuXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgZGF0YVNjaGVtYS5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUgPSBKU09OLnBhcnNlKGRhdGFTY2hlbWEuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlKTtcclxuICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGxvZy5sb2coJ0RhdGFTY2hlbWEgU291cmNlIGNvZGUgaXMgYWxyZWFkeSBwYXJzZWQnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIGRhdGFTY2hlbWE7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vbG9nLmxvZyhcImNyZWF0ZWQgZGF0YVNjaGVtYSBkZXNjcmlwdG9yIG9iamVjdDpcIiwgZGF0YVNjaGVtYSk7XHJcbiAgICByZXR1cm4gZGF0YVNjaGVtYTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAgICogQ3JlYXRlIFByb3RvY29sU3R1YkRlc2NyaXB0b3IgYmFzZWQgb24gcmF3IG9iamVjdCB0aGF0IGNvbnRhaW5zIGl0cyBhdHRyaWJ1dGVzXHJcbiAgICAgKiBAcGFyYW0gcmF3UHJveHlcclxuICAgICAqIEByZXR1cm5zIHtQcm90b2NvbFN0dWJEZXNjcmlwdG9yfVxyXG4gICAgICovXHJcbiAgY3JlYXRlSWRwUHJveHkocmF3UHJveHkpIHtcclxuICAgIC8vIGxvZy5sb2coXCJjcmVhdGluZyBpZHBwcm94eSBkZXNjcmlwdG9yIGJhc2VkIG9uOiBcIiwgcmF3UHJveHkpO1xyXG5cclxuICAgIC8vIGNyZWF0ZSB0aGUgZGVzY3JpcHRvclxyXG4gICAgbGV0IGlkcHByb3h5ID0gdGhpcy5fZmFjdG9yeS5jcmVhdGVQcm90b1N0dWJEZXNjcmlwdG9yT2JqZWN0KFxyXG4gICAgICByYXdQcm94eVsnY2d1aWQnXSxcclxuICAgICAgcmF3UHJveHlbJ3ZlcnNpb24nXSxcclxuICAgICAgcmF3UHJveHlbJ29iamVjdE5hbWUnXSxcclxuICAgICAgcmF3UHJveHlbJ2Rlc2NyaXB0aW9uJ10sXHJcbiAgICAgIHJhd1Byb3h5WydsYW5ndWFnZSddLFxyXG4gICAgICByYXdQcm94eVsnc291cmNlUGFja2FnZVVSTCddLFxyXG4gICAgICByYXdQcm94eVsnbWVzc2FnZVNjaGVtYXMnXSxcclxuICAgICAgcmF3UHJveHlbJ2NvbmZpZ3VyYXRpb24nXSxcclxuICAgICAgcmF3UHJveHlbJ2NvbnN0cmFpbnRzJ10sXHJcbiAgICAgIHJhd1Byb3h5WydoeXBlcnR5VHlwZSddLFxyXG4gICAgICByYXdQcm94eVsnZGF0YU9iamVjdHMnXSxcclxuICAgICAgcmF3UHJveHlbJ2ludGVyd29ya2luZyddLFxyXG4gICAgICByYXdQcm94eVsnaWRwUHJveHknXSxcclxuICAgICAgcmF3UHJveHlbJ211dHVhbEF1dGhlbnRpY2F0aW9uJ11cclxuICAgICk7XHJcblxyXG4gICAgLy8gb3B0aW9uYWwgZmllbGRzXHJcbiAgICBpZHBwcm94eS5zaWduYXR1cmUgPSByYXdQcm94eVsnc2lnbmF0dXJlJ107XHJcblxyXG4gICAgLy8gcGFyc2UgYW5kIGF0dGFjaCB0aGUgc291cmNlUGFja2FnZVxyXG4gICAgbGV0IHNvdXJjZVBhY2thZ2UgPSByYXdQcm94eVsnc291cmNlUGFja2FnZSddO1xyXG4gICAgaWYgKHNvdXJjZVBhY2thZ2UpIHtcclxuICAgICAgc291cmNlUGFja2FnZSA9IHRoaXMuY3JlYXRlU291cmNlUGFja2FnZShzb3VyY2VQYWNrYWdlKTtcclxuICAgICAgaWRwcHJveHkuc291cmNlUGFja2FnZSA9IHNvdXJjZVBhY2thZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGlkcHByb3h5O1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlU291cmNlUGFja2FnZShzcCkge1xyXG4gICAgLy9sb2cubG9nKFwiY3JlYXRlU291cmNlUGFja2FnZTpcIiwgc3ApO1xyXG5cclxuICAgIC8vIGNoZWNrIGVuY29kaW5nXHJcbiAgICBpZiAoc3BbJ2VuY29kaW5nJ10gPT09ICdiYXNlNjQnKSB7XHJcbiAgICAgIHNwWydzb3VyY2VDb2RlJ10gPSB0aGlzLmF0b2Ioc3BbJ3NvdXJjZUNvZGUnXSk7XHJcbiAgICAgIHNwWydlbmNvZGluZyddID0gJ3V0Zi04JztcclxuICAgIH1cclxuXHJcbiAgICBsZXQgc291cmNlUGFja2FnZSA9IHRoaXMuX2ZhY3RvcnkuY3JlYXRlU291cmNlUGFja2FnZShzcFsnc291cmNlQ29kZUNsYXNzbmFtZSddLCBzcFsnc291cmNlQ29kZSddKTtcclxuICAgIGlmIChzcFsnZW5jb2RpbmcnXSlcclxuICAgICAgc291cmNlUGFja2FnZS5lbmNvZGluZyA9IHNwWydlbmNvZGluZyddO1xyXG5cclxuICAgIGlmIChzcFsnc2lnbmF0dXJlJ10pXHJcbiAgICAgIHNvdXJjZVBhY2thZ2Uuc2lnbmF0dXJlID0gc3BbJ3NpZ25hdHVyZSddO1xyXG5cclxuICAgIHJldHVybiBzb3VyY2VQYWNrYWdlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICAgKiBHZXQgc291cmNlIFBhY2thZ2UgZnJvbSBhIFVSTFxyXG4gICAgICogQHBhcmFtIHNvdXJjZVBhY2thZ2VVUkwgLSBlLmcuIG15ZG9tYWluLmNvbS8ud2VsbC1rbm93bi9oeXBlcnR5L015SHlwZXJ0eS9zb3VyY2VQYWNrYWdlXHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgICAqL1xyXG4gIGdldFNvdXJjZVBhY2thZ2VGcm9tVVJMKHNvdXJjZVBhY2thZ2VVUkwpIHtcclxuICAgIGxvZy5sb2coJ2dldHRpbmcgc291cmNlUGFja2FnZSBmcm9tOicsIHNvdXJjZVBhY2thZ2VVUkwpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHRoaXMuaHR0cFJlcXVlc3QuZ2V0KHNvdXJjZVBhY2thZ2VVUkwpLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgIC8vbG9nLmxvZyhcImdvdCByYXcgc291cmNlUGFja2FnZTpcIiwgcmVzdWx0KTtcclxuICAgICAgICBpZiAocmVzdWx0WydFUlJPUiddKSB7XHJcbiAgICAgICAgICAvLyBUT0RPIGhhbmRsZSBlcnJvciBwcm9wZXJseVxyXG4gICAgICAgICAgcmVqZWN0KHJlc3VsdCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzdWx0KTtcclxuICAgICAgICAgIGxldCBzb3VyY2VQYWNrYWdlID0gdGhpcy5jcmVhdGVTb3VyY2VQYWNrYWdlKHJlc3VsdCk7XHJcbiAgICAgICAgICByZXNvbHZlKHNvdXJjZVBhY2thZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHNvdXJjZUNvZGUgb2YgYSBnaXZlbiBkZXNjcmlwdG9yXHJcbiAgICAgKiBAcGFyYW0ge0NhdGFsb2d1ZURhdGFPYmplY3R9IGRlc2NyaXB0b3IgLSBDYXRhbG9ndWUgT2JqZWN0IHRoYXQgd2FzIHJldHJpZXZlZCB1c2luZyBlLmcuIGdldEh5cGVydHlEZXNjcmlwdG9yKClcclxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAgICovXHJcbiAgZ2V0U291cmNlQ29kZUZyb21EZXNjcmlwdG9yKGRlc2NyaXB0b3IpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGlmIChkZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2UpIHtcclxuICAgICAgICAvL2xvZy5sb2coXCJkZXNjcmlwdG9yIGhhcyBzb3VyY2VQYWNrYWdlXCIpO1xyXG4gICAgICAgIC8vbG9nLmxvZyhcInJldHVybmluZyBzb3VyY2VDb2RlOlwiLCBkZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2Uuc291cmNlQ29kZSk7XHJcbiAgICAgICAgcmVzb2x2ZShkZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2Uuc291cmNlQ29kZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlTWFuYWdlci5nZXRWZXJzaW9uKGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZVVSTCArICcvc291cmNlQ29kZScpLnRoZW4oKGRiVmVyc2lvbikgPT4ge1xyXG4gICAgICAgICAgaWYgKGRiVmVyc2lvbiA+PSBkZXNjcmlwdG9yLnZlcnNpb24pIHtcclxuICAgICAgICAgICAgbG9nLmxvZygncmV0dXJuaW5nIGNhY2hlZCB2ZXJzaW9uIGZyb20gc3RvcmFnZU1hbmFnZXInKTtcclxuICAgICAgICAgICAgdGhpcy5zdG9yYWdlTWFuYWdlci5nZXQoZGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlVVJMICsgJy9zb3VyY2VDb2RlJykudGhlbigoc291cmNlQ29kZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHJlc29sdmUoc291cmNlQ29kZSk7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmh0dHBSZXF1ZXN0LmdldChkZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2VVUkwgKyAnL3NvdXJjZUNvZGUnKS50aGVuKChzb3VyY2VDb2RlKSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKHNvdXJjZUNvZGVbJ0VSUk9SJ10pIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gaGFuZGxlIGVycm9yIHByb3Blcmx5XHJcbiAgICAgICAgICAgICAgICByZWplY3Qoc291cmNlQ29kZSk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZU1hbmFnZXIuc2V0KGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZVVSTCArICcvc291cmNlQ29kZScsIGRlc2NyaXB0b3IudmVyc2lvbiwgc291cmNlQ29kZSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHNvdXJjZUNvZGUpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSkuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgICAgIHJlamVjdChyZWFzb24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGxpc3Qgb2YgYXZhaWxhYmxlIGNhdGFsb2d1ZSBvYmplY3RzIGZvciB0aGUgZ2l2ZW4gXCJ0eXBlIFVSTFwiLFxyXG4gICAgICogaS5lLiBhIGNhdGFsb2d1ZSBVUkwgdGhhdCBzcGVjaWZpZXMgYSB0eXBlLCBidXQgbm8gY2F0YWxvZ3VlIG9iamVjdCBuYW1lLlxyXG4gICAgICogQHBhcmFtIHR5cGVVUkwgLSBVUkwgcG9pbnRpbmcgdG8gdGhlIGNhdGFsb2d1ZSBvYmplY3QgdHlwZSB5b3Ugd2FudCBhIGxpc3Qgb2YgYXZhaWxhYmxlIG9iamVjdHMgZm9yLFxyXG4gICAgICogZS5nLiBoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS5mb2t1cy5mcmF1bmhvZmVyLmRlLy53ZWxsLWtub3duL2lkcC1wcm94eVxyXG4gICAgICogQHBhcmFtIHtKU09OfSBjb25zdHJhaW50cyAtIGNvbnN0cmFpbnRzIG9iamVjdFxyXG4gICAgICogQHJldHVybnMge1Byb21pc2V9IHR5cGVMaXN0UHJvbWlzZSAtIFByb21pc2UgdGhhdCBmdWxmaWxscyB3aXRoIHRoZSBsaXN0IG9mIGF2YWlsYWJsZSBjYXRhbG9ndWUgb2JqZWN0IG5hbWVzIGZvciB0aGUgcmVxdWVzdGVkIHR5cGUsXHJcbiAgICAgKiByZWplY3RzIG9uIEhUVFAgZXJyb3Igb3IgaWYgdGhlIEhUVFAgcmVzcG9uc2UgaXMgbm90IGluIEpTT04uXHJcbiAgICAgKiBJZiBjb25zdHJhaW50cyB3ZXJlIHByb3ZpZGVkLCB0aGVuIHRoZSBsaXN0IG9ubHkgY29udGFpbnMgdGhvc2Ugb2JqZWN0cyB0aGF0IG1lZXQgdGhlIGNvbnN0cmFpbnRzXHJcbiAgICAgKi9cclxuICBnZXRUeXBlTGlzdCh0eXBlVVJMLCBjb25zdHJhaW50cykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgbGV0IHJlcXVlc3RQcm9taXNlID0gY29uc3RyYWludHMgIT0gdW5kZWZpbmVkID8gdGhpcy5odHRwUmVxdWVzdC5wb3N0KHR5cGVVUkwsIHtib2R5OiBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cyl9KSA6IHRoaXMuaHR0cFJlcXVlc3QuZ2V0KHR5cGVVUkwpO1xyXG4gICAgICByZXF1ZXN0UHJvbWlzZS50aGVuKCh0eXBlTGlzdCkgPT4ge1xyXG4gICAgICAgIHR5cGVMaXN0ID0gSlNPTi5wYXJzZSh0eXBlTGlzdCk7XHJcbiAgICAgICAgcmVzb2x2ZSh0eXBlTGlzdCk7XHJcbiAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICByZWplY3QocmVhc29uKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldCBydW50aW1lVVJMKHJ1bnRpbWVVUkwpIHtcclxuICAgIHRoaXMuX3J1bnRpbWVVUkwgPSBydW50aW1lVVJMO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHJ1bnRpbWVVUkwoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcnVudGltZVVSTDtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUZyb21QTSh1cmwpIHtcclxuICAgIHJldHVybiB0aGlzLnN0b3JhZ2VNYW5hZ2VyLmRlbGV0ZSh1cmwpO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFJ1bnRpbWVDYXRhbG9ndWU7XHJcbiIsIi8qKlxyXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxyXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXHJcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXHJcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcclxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcclxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXHJcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXHJcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cclxuKlxyXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4qXHJcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuKlxyXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKi9cclxuXHJcblxyXG5pbXBvcnQgeyBsb2cgYXMgbG9nTGV2ZWxzIH0gZnJvbSAnLi4vbG9nTGV2ZWxzJztcclxuXHJcbi8vIExvZyBTeXN0ZW1cclxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJ2xvZ2xldmVsJztcclxubGV0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ1J1bnRpbWVVQScpO1xyXG5cclxuLy9NYWluIGRlcGVuZGVjaWVzXHJcbmltcG9ydCBSZWdpc3RyeSBmcm9tICcuLi9yZWdpc3RyeS9SZWdpc3RyeSc7XHJcbmltcG9ydCBJZGVudGl0eU1vZHVsZSBmcm9tICcuLi9pZGVudGl0eS9JZGVudGl0eU1vZHVsZSc7XHJcbmltcG9ydCBJZGVudGl0eUhhbmRsZXIgZnJvbSAnLi4vaWRlbnRpdHkvSWRlbnRpdHlIYW5kbGVyJztcclxuaW1wb3J0IFBFUCBmcm9tICcuLi9wb2xpY3kvUEVQJztcclxuaW1wb3J0IE1lc3NhZ2VCdXMgZnJvbSAnLi4vYnVzL01lc3NhZ2VCdXMnO1xyXG5pbXBvcnQgeyBnZW5lcmF0ZUdVSUQgfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBBZGRyZXNzQWxsb2NhdGlvbiBmcm9tICcuLi9hbGxvY2F0aW9uL0FkZHJlc3NBbGxvY2F0aW9uJztcclxuaW1wb3J0IGNyeXB0b01hbmFnZXIgZnJvbSAnLi4vY3J5cHRvTWFuYWdlci9DcnlwdG9NYW5hZ2VyJztcclxuXHJcbmltcG9ydCBMb2FkZXIgZnJvbSAnLi9Mb2FkZXInO1xyXG5pbXBvcnQgeyBzdG9yYWdlIH0gZnJvbSAnLi9TdG9yYWdlJztcclxuaW1wb3J0IERlc2NyaXB0b3JzIGZyb20gJy4vRGVzY3JpcHRvcnMnO1xyXG5cclxuaW1wb3J0IHsgcnVudGltZUNvbmZpZ3VyYXRpb24gfSBmcm9tICcuL3J1bnRpbWVDb25maWd1cmF0aW9uJztcclxuaW1wb3J0IE1zZ0J1c0hhbmRsZXJzIGZyb20gJy4vTXNnQnVzSGFuZGxlcnMnO1xyXG5pbXBvcnQgeyBydW50aW1lVXRpbHMgfSBmcm9tICcuL3J1bnRpbWVVdGlscyc7XHJcblxyXG4vL2ltcG9ydCBHcmFwaENvbm5lY3RvciBmcm9tICcuLi9ncmFwaGNvbm5lY3Rvci9HcmFwaENvbm5lY3Rvcic7XHJcblxyXG5pbXBvcnQgQ29yZURpc2NvdmVyeSBmcm9tICcuLi9kaXNjb3ZlcnkvQ29yZURpc2NvdmVyeSc7XHJcblxyXG5pbXBvcnQgRGF0YU9iamVjdHNTdG9yYWdlIGZyb20gJy4uL3N0b3JlLW9iamVjdHMvRGF0YU9iamVjdHNTdG9yYWdlJztcclxuaW1wb3J0IEh5cGVydHlSZXNvdXJjZXNTdG9yYWdlIGZyb20gJy4uL2h5cGVydHktcmVzb3VyY2UvSHlwZXJ0eVJlc291cmNlc1N0b3JhZ2UnO1xyXG5pbXBvcnQgU3luY2hlck1hbmFnZXIgZnJvbSAnLi4vc3luY2hlci9TeW5jaGVyTWFuYWdlcic7XHJcbmltcG9ydCBTdWJzY3JpcHRpb25NYW5hZ2VyIGZyb20gJy4uL3N1YnNjcmlwdGlvbk1hbmFnZXIvU3Vic2NyaXB0aW9uTWFuYWdlcic7XHJcbmltcG9ydCBSdW50aW1lQ29yZUN0eCBmcm9tICcuLi9wb2xpY3kvY29udGV4dC9SdW50aW1lQ29yZUN0eCc7XHJcbmltcG9ydCBSdW50aW1lQ2F0YWxvZ3VlIGZyb20gJy4uL3J1bnRpbWUtY2F0YWxvZ3VlL1J1bnRpbWVDYXRhbG9ndWUnO1xyXG5cclxuLyoqXHJcbiAqIFJ1bnRpbWUgVXNlciBBZ2VudCBJbnRlcmZhY2Ugd2lsbCBwcm9jZXNzIGFsbCB0aGUgZGVwZW5kZWNpZXMgb2YgdGhlIGNvcmUgcnVudGltZTtcclxuICogQGF1dGhvciBWaXRvciBTaWx2YSBbdml0b3ItdC1zaWx2YUB0ZWxlY29tLnB0XVxyXG4gKiBAdmVyc2lvbiAwLjQuMFxyXG4gKlxyXG4gKiBAcHJvcGVydHkge3J1bnRpbWVGYWN0b3J5fSBydW50aW1lRmFjdG9yeSAtIFNwZWNpZmljIGltcGxlbWVudGF0aW9uIGZvciBhbGwgZW52aXJvbm1lbnRzO1xyXG4gKiBAcHJvcGVydHkge1J1bnRpbWVDYXRhbG9ndWV9IHJ1bnRpbWVDYXRhbG9ndWUgLSBDYXRhbG9ndWUgb2YgY29tcG9uZW50cyBjYW4gYmUgaW5zdGFsbGVkO1xyXG4gKiBAcHJvcGVydHkge3J1bnRpbWVVUkx9IHJ1bnRpbWVVUkwgLSBUaGlzIGlkZW50aWZ5IHRoZSBjb3JlIHJ1bnRpbWUsIHNob3VsZCBiZSB1bmlxdWU7XHJcbiAqIEBwcm9wZXJ0eSB7SWRlbnRpdHlNb2R1bGV9IGlkZW50aXR5TW9kdWxlIC0gSWRlbnRpdHkgTW9kdWxlO1xyXG4gKiBAcHJvcGVydHkge1BFUH0gcG9saWN5RW5naW5lIC0gUG9saWN5IEVuZ2luZSBNb2R1bGU7XHJcbiAqIEBwcm9wZXJ0eSB7UmVnaXN0cnl9IHJlZ2lzdHJ5IC0gUmVnaXN0cnkgTW9kdWxlO1xyXG4gKiBAcHJvcGVydHkge01lc3NhZ2VCdXN9IG1lc3NhZ2VCdXMgLSBNZXNzYWdlIEJ1cyBpcyB1c2VkIGxpa2UgYSByb3V0ZXIgdG8gcmVkaXJlY3QgdGhlIG1lc3NhZ2VzIGZyb20gb25lIGNvbXBvbmVudCB0byBvdGhlcihzKVxyXG4gKiBAcHJvcGVydHkge0dyYXBoQ29ubmVjdG9yfSBncmFwaENvbm5lY3RvciAtIEdyYXBoIENvbm5lY3RvciBoYW5kbGluZyBHVUlEIGFuZCBjb250YWN0c1xyXG4gKiBAcHJvcGVydHkge0NvcmVEaXNjb3Zlcnl9IGNvcmVEaXNjb3ZlcnkgLSBEaXNjb3ZlcnkgZm9yIGRpc2NvdmVyeSBoeXBlcnRpZXMvZGF0YU9iamVjdHNcclxuICovXHJcbmNsYXNzIFJ1bnRpbWVVQSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBSdW50aW1lIFVzZXIgQWdlbnRcclxuICAgKiBAcGFyYW0ge2Rlc2NyaXB0b3J9IHJ1bnRpbWVEZXNjcmlwdG9yIC0gcGFzcyBhbGwgdGhlIGh5cGVydHkgcnVudGltZSBkZXNjcmlwdG9yXHJcbiAgICogQHBhcmFtIHtydW50aW1lRmFjdG9yeX0gcnVudGltZUZhY3RvcnkgLSBTcGVjaWZpYyBpbXBsZW1lbnRhdGlvbiBmb3IgdGhlIGVudmlyb25tZW50IHdoZXJlIHRoZSBjb3JlIHJ1bnRpbWUgd2lsbCBydW47XHJcbiAgICogQHBhcmFtIHtkb21haW59IGRvbWFpblVSTCAtIHNwZWNpZnkgdGhlIGRvbWFpbiBiYXNlIGZvciB0aGUgcnVudGltZTtcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvcihydW50aW1lRGVzY3JpcHRvciwgcnVudGltZUZhY3RvcnksIGRvbWFpbikge1xyXG4gICAgaWYgKCFydW50aW1lRGVzY3JpcHRvcikgdGhyb3cgbmV3IEVycm9yKCdUaGUgcnVudGltZSBkZXNjcmlwdG9yIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO1xyXG4gICAgaWYgKCFydW50aW1lRmFjdG9yeSkgdGhyb3cgbmV3IEVycm9yKCdUaGUgc2FuZGJveCBmYWN0b3J5IGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpO1xyXG4gICAgaWYgKCFkb21haW4pIHRocm93IG5ldyBFcnJvcignWW91IG5lZWQgdGhlIGRvbWFpbiBvZiBydW50aW1lJyk7XHJcblxyXG4gICAgLy8gQ29uZmlndXJhdGlvbiBvYmplY3Qgd2l0aCBpbmZvcm1hdGlvbiByZWxhdGVkIHdpdGggc2VydmVyc1xyXG4gICAgdGhpcy5ydW50aW1lQ29uZmlndXJhdGlvbiA9IE9iamVjdC5hc3NpZ24oeyBkb21haW46IGRvbWFpbiB9LCBydW50aW1lQ29uZmlndXJhdGlvbik7XHJcbiAgICB0aGlzLnJ1bnRpbWVGYWN0b3J5ID0gcnVudGltZUZhY3Rvcnk7XHJcblxyXG4gICAgdGhpcy5sb2cgPSBsb2c7XHJcbiAgICB0aGlzLmxvZ0xldmVscyA9IGxvZ0xldmVscztcclxuXHJcbiAgICBpZiAocnVudGltZURlc2NyaXB0b3IucDJwSGFuZGxlclN0dWIgJiYgdHlwZW9mIHJ1bnRpbWVEZXNjcmlwdG9yLnAycEhhbmRsZXJTdHViID09PSAnc3RyaW5nJyAmJiBydW50aW1lRGVzY3JpcHRvci5wMnBIYW5kbGVyU3R1Yi5pbmNsdWRlcygnOi8vJykpIHtcclxuICAgICAgdGhpcy5wMnAgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5wMnAgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBydW50aW1lVXRpbHMucnVudGltZURlc2NyaXB0b3IgPSBydW50aW1lRGVzY3JpcHRvcjtcclxuICAgIHRoaXMucnVudGltZVV0aWxzID0gcnVudGltZVV0aWxzO1xyXG5cclxuICAgIHRoaXMuc3RvcmFnZXMgPSB7fTtcclxuXHJcbi8qICAgIGlmICh0eXBlb2YgcnVudGltZUZhY3RvcnkuY3JlYXRlUnVudGltZUNhdGFsb2d1ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICB0aGlzLnJ1bnRpbWVDYXRhbG9ndWUgPSBydW50aW1lRmFjdG9yeS5jcmVhdGVSdW50aW1lQ2F0YWxvZ3VlKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NoZWNrIHlvdXIgUnVudGltZSBGYWN0b3J5IGJlY2F1c2UgaXQgbmVlZHMgdGhlIFJ1bnRpbWUgQ2F0YWxvZ3VlIGltcGxlbWVudGF0aW9uJyk7XHJcbiAgICB9Ki9cclxuXHJcbiAgICB0aGlzLnJ1bnRpbWVDYXRhbG9ndWUgPSBuZXcgUnVudGltZUNhdGFsb2d1ZShydW50aW1lRmFjdG9yeSk7XHJcblxyXG5cclxuXHJcbi8qICAgIGlmICh0eXBlb2YgcnVudGltZUZhY3RvcnkucGVyc2lzdGVuY2VNYW5hZ2VyID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIHRoaXMucGVyc2lzdGVuY2VNYW5hZ2VyID0gcnVudGltZUZhY3RvcnkucGVyc2lzdGVuY2VNYW5hZ2VyKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NoZWNrIHlvdXIgUnVudGltZSBGYWN0b3J5IGJlY2F1c2UgaXQgbmVlZHMgdGhlIFBlcnNpc3RlbmNlIE1hbmFnZXIgaW1wbGVtZW50YXRpb24nKTtcclxuICAgIH0qL1xyXG5cclxuICAgIGlmICh0eXBlb2YgcnVudGltZUZhY3Rvcnkuc3RvcmFnZU1hbmFnZXIgPT09ICdmdW5jdGlvbicpIHtcclxuXHJcbiAgICAgIHRoaXMuc3RvcmFnZXMgPSBzdG9yYWdlKHJ1bnRpbWVGYWN0b3J5LCB0aGlzKTtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NoZWNrIHlvdXIgUnVudGltZSBGYWN0b3J5IGJlY2F1c2UgaXQgbmVlZHMgdGhlIFN0b3JhZ2UgTWFuYWdlciBpbXBsZW1lbnRhdGlvbicpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgcnVudGltZUZhY3RvcnkucnVudGltZUNhcGFiaWxpdGllcyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICB0aGlzLnJ1bnRpbWVDYXBhYmlsaXRpZXMgPSBydW50aW1lRmFjdG9yeS5ydW50aW1lQ2FwYWJpbGl0aWVzKHRoaXMuc3RvcmFnZXMuY2FwYWJpbGl0aWVzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxvZy5pbmZvKCdDaGVjayB5b3VyIFJ1bnRpbWVGYWN0b3J5IGJlY2F1c2UgaXQgbmVlZHMgdGhlIFJ1bnRpbWUgQ2FwYWJpbGl0aWVzIGltcGxlbWVudGF0aW9uJyk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW50aWFsaXplIHRoZSBpbnN0YWxsYXRpb24gb2YgcnVudGltZVxyXG4gICAqXHJcbiAgICogQGFjY2VzcyBwdWJsaWNcclxuICAgKiBAcmV0dXJuIHtQcm9taXNlPEJvb2xlYW4sIEVycm9yPn0gdGhpcyBpcyBQcm9taXNlIGFuZCBpZiB0aGUgaW5zdGFsbGF0aW9uIHByb2Nlc3MgaGFwcGVuZWQgd2l0aG91dCBhbnkgcHJvYmxlbXMgcmV0dXJucyB0cnVlIG90aGVyd2lzZSB0aGUgZXJyb3IuXHJcbiAgICpcclxuICAgKiBAbWVtYmVyT2YgUnVudGltZVVBXHJcbiAgICovXHJcbiAgaW5pdChndWlkKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cclxuICAgICAgdGhpcy5kb21haW4gPSB0aGlzLnJ1bnRpbWVDb25maWd1cmF0aW9uLmRvbWFpbjtcclxuXHJcbiAgICAgIGxvZy5pbmZvKCdbUnVudGltZVVBIC0gaW5pdF0gU3RhcnRpbmcgJyk7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGxldCBnZXRDYXBhYmlsaXRpZXMgPSB0aGlzLnJ1bnRpbWVDYXBhYmlsaXRpZXMuZ2V0UnVudGltZUNhcGFiaWxpdGllcygpO1xyXG4gICAgICAgIGxldCBnZXRSdW50aW1lVVJMID0gdGhpcy5zdG9yYWdlcy5ydW50aW1lLmdldCgncnVudGltZTpVUkwnKTtcclxuICAgICAgICBsZXQgZ2V0U3RvcmVkRGF0YU9iamVjdHMgPSB0aGlzLnN0b3JhZ2VzLnN5bmNoZXJNYW5hZ2VyLmdldCgnc3luY2hlck1hbmFnZXI6T2JqZWN0VVJMcycpO1xyXG4gICAgICAgIGxldCBnZXRIeXBlcnR5U3RvcmFnZU9iamVjdHMgPSB0aGlzLnN0b3JhZ2VzLmh5cGVydHlSZXNvdXJjZXMuZ2V0KCk7XHJcbiAgICAgICAgbGV0IGdldFAyUEhhbmRsZXJVUkwgPSB0aGlzLnN0b3JhZ2VzLnJ1bnRpbWUuZ2V0KCdwMnBIYW5kbGVyOlVSTCcpO1xyXG4vLyAgICAgICAgbGV0IGdldFJlbW90ZXMgPSB0aGlzLnN0b3JhZ2VzLnN5bmNoZXJNYW5hZ2VyLmdldCgncmVtb3RlcycpO1xyXG5cclxuICAgICAgICBQcm9taXNlLmFsbChbZ2V0UnVudGltZVVSTCwgZ2V0Q2FwYWJpbGl0aWVzLCBnZXRTdG9yZWREYXRhT2JqZWN0cywgZ2V0SHlwZXJ0eVN0b3JhZ2VPYmplY3RzLCBnZXRQMlBIYW5kbGVyVVJMXSkudGhlbigocmVzdWx0cykgPT4ge1xyXG5cclxuICAgICAgICAgIHRoaXMucnVudGltZVVSTCA9IHJlc3VsdHNbMF0gPyByZXN1bHRzWzBdLnJ1bnRpbWVVUkwgOiByZXN1bHRzWzBdO1xyXG4gICAgICAgICAgaWYgKCF0aGlzLnJ1bnRpbWVVUkwpIHtcclxuICAgICAgICAgICAgdGhpcy5ydW50aW1lVVJMID0gJ3J1bnRpbWU6Ly8nICsgdGhpcy5kb21haW4gKyAnLycgKyBnZW5lcmF0ZUdVSUQoKTtcclxuICAgICAgICAgICAgdGhpcy5zdG9yYWdlcy5ydW50aW1lLnNldCgncnVudGltZTpVUkwnLCAxLCB7IHJ1bnRpbWVVUkw6IHRoaXMucnVudGltZVVSTCB9KTtcclxuICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgdGhpcy5jYXBhYmlsaXRpZXMgPSByZXN1bHRzWzFdO1xyXG4gICAgICAgICAgT2JqZWN0LmFzc2lnbihydW50aW1lVXRpbHMucnVudGltZUNhcGFiaWxpdGllcy5jb25zdHJhaW50cywgcmVzdWx0c1sxXSk7XHJcblxyXG4gICAgICAgICAgdGhpcy5fZGF0YU9iamVjdHNTdG9yYWdlID0gbmV3IERhdGFPYmplY3RzU3RvcmFnZSh0aGlzLnN0b3JhZ2VzLnN5bmNoZXJNYW5hZ2VyLCByZXN1bHRzWzJdIHx8IHt9LCB0aGlzLnJ1bnRpbWVGYWN0b3J5LCB0aGlzICk7XHJcblxyXG4gICAgICAgICAgdGhpcy5faHlwZXJ0eVJlc291cmNlcyA9IHJlc3VsdHNbM10gfHwge307XHJcblxyXG4gICAgICAgICAgdGhpcy5wMnBIYW5kbGVyVVJMID0gcmVzdWx0c1s0XSA/IHJlc3VsdHNbNF0ucDJwSGFuZGxlclVSTCA6IHJlc3VsdHNbNF07XHJcbiAgICAgICAgICBpZiAoIXRoaXMucDJwSGFuZGxlclVSTCkge1xyXG4gICAgICAgICAgICB0aGlzLnAycEhhbmRsZXJVUkwgPSB0aGlzLnJ1bnRpbWVVUkwgKyAnL3AycGhhbmRsZXIvJyArIGdlbmVyYXRlR1VJRCgpO1xyXG4gICAgICAgICAgICBsb2cuaW5mbygnW1J1bnRpbWVVQSAtIGluaXRdIFAyUEhhbmRsZXJVUkw6ICcsIHRoaXMucDJwSGFuZGxlclVSTCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2VzLnJ1bnRpbWUuc2V0KCdwMnBIYW5kbGVyOlVSTCcsIDEsIHsgcDJwSGFuZGxlclVSTDogdGhpcy5wMnBIYW5kbGVyVVJMIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuLyogICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lVUEgLSBpbml0XSBkYXRhT2JqZWN0c1N0b3JhZ2UgcmVtb3RlIGxvYWQgc3RhcnRpbmcnKTtcclxuICAgICAgICAgIHRoaXMuX2RhdGFPYmplY3RzU3RvcmFnZS5sb2FkUmVtb3RlKCkudGhlbigoKT0+IHtcclxuICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lVUEgLSBpbml0XSBkYXRhT2JqZWN0c1N0b3JhZ2UgcmVtb3RlIGxvYWQgY29uY2x1ZGVkJyk7Ki9cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWRDb21wb25lbnRzKGd1aWQpO1xyXG5cclxuLy8gICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICB9KS50aGVuKChzdGF0dXMpID0+IHtcclxuXHJcbiAgICAgICAgICB0aGlzLl9oeXBlcnR5UmVzb3VyY2VzU3RvcmFnZSA9IG5ldyBIeXBlcnR5UmVzb3VyY2VzU3RvcmFnZSh0aGlzLnJ1bnRpbWVVUkwsIHRoaXMubWVzc2FnZUJ1cywgdGhpcy5zdG9yYWdlcy5oeXBlcnR5UmVzb3VyY2VzLCB0aGlzLl9oeXBlcnR5UmVzb3VyY2VzKTtcclxuXHJcbiAgICAgICAgICBpZiAodGhpcy5wMnApIHtcclxuICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lVUEgLSBpbml0XSBsb2FkIHAycEhhbmRsZXI6ICcsIHN0YXR1cyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkUDJQSGFuZGxlcigpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbG9nLmluZm8oJ1tSdW50aW1lVUEgLSBpbml0XSBQMlAgbm90IHN1cHBvcnRlZCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gKCdQMlAgTm90IFN1cHBvcnRlZCcpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgICAgIGxvZy5pbmZvKCdbcnVudGltZSB1YSAtIGluaXRdIC0gc3RhdHVzOiAnLCByZXN1bHQpO1xyXG4gICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICB9LCAocmVhc29uKSA9PiB7XHJcbiAgICAgICAgICBsb2cuZXJyb3IoJ0VSUk9SOiAnLCByZWFzb24pO1xyXG4gICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBfdXBkYXRlUnVudGltZVN0YXR1cyhldmVudCkge1xyXG5cclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcblxyXG4gICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgIGZyb206IHRoaXMucnVudGltZVVSTCxcclxuICAgICAgdG86IHRoaXMucnVudGltZVVSTCsnL3N0YXR1cycsXHJcbiAgICAgIHR5cGU6ICd1cGRhdGUnLFxyXG4gICAgICBib2R5OiBldmVudFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfbG9hZFAyUEhhbmRsZXIoKSB7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblxyXG4gICAgICBsZXQgcnVudGltZURlc2NyaXB0b3IgPSBydW50aW1lVXRpbHMucnVudGltZURlc2NyaXB0b3I7XHJcbiAgICAgIGxldCBwMnBTdHViSGFuZGxlciA9IHJ1bnRpbWVEZXNjcmlwdG9yLnAycEhhbmRsZXJTdHViO1xyXG5cclxuICAgICAgbGV0IHAycENvbmZpZyA9IHtcclxuICAgICAgICBpc0hhbmRsZXJTdHViOiB0cnVlLFxyXG4gICAgICAgIHJ1bnRpbWVVUkw6IHRoaXMucnVudGltZVVSTFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgbG9nLmxvZygnW1J1bnRpbWVVQSBsb2FkUDJQSGFuZGxlcl0gUDJQU3R1YkhhbmRsZXI6ICcsIHAycFN0dWJIYW5kbGVyKTtcclxuXHJcbiAgICAgIHRoaXMubG9hZGVyLmxvYWRTdHViKHAycFN0dWJIYW5kbGVyLCBwMnBDb25maWcpLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG5cclxuICAgICAgICBsZXQgcnVudGltZVVBVVJMID0gdGhpcy5ydW50aW1lVVJMICsgJy91YSc7XHJcbiAgICAgICAgbGV0IG1zZyA9IHtcclxuICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLFxyXG4gICAgICAgICAgZnJvbTogcnVudGltZVVBVVJMLFxyXG4gICAgICAgICAgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgdGhpcy5kb21haW4gKyAnL3NtJyxcclxuICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgc3Vic2NyaWJlOiBbcmVzdWx0LnVybF0sXHJcbiAgICAgICAgICAgIHNvdXJjZTogdGhpcy5ydW50aW1lVVJMXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQnVzLmFkZExpc3RlbmVyKHJ1bnRpbWVVQVVSTCwgKG1zZykgPT4ge1xyXG4gICAgICAgICAgbG9nLmxvZygnW3J1bnRpbWUgdWEgLSBsaXN0ZW5lcl0gLSByZWNlaXZlIG1zZzogJywgbXNnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgKHJlcGx5KSA9PiB7XHJcbiAgICAgICAgICBsb2cubG9nKCdbcnVudGltZSB1YSAtIHBvc3RNZXNzYWdlXSAtIHJlcGx5OiAnLCByZXBseSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxvZy5pbmZvKCdbcnVudGltZSB1YSAtIHAycCBpbnN0YWxsYXRpb25dIC0gc3VjY2VzczogJywgcmVzdWx0KTtcclxuICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICB9KS5jYXRjaCgocmVhc29uKSA9PiB7XHJcbiAgICAgICAgbG9nLmluZm8oJ1tydW50aW1lIHVhIC0gcDJwIGluc3RhbGxhdGlvbl0gLSBmYWlsOiAnLCByZWFzb24pO1xyXG4gICAgICAgIHJlc29sdmUoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKlxyXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8Qm9vbGVhbiwgRXJyb3I+fSB0aGlzIGlzIFByb21pc2UgYW5kIHJldHVybnMgdHJ1ZSBpZiBhbGwgY29tcG9uZW50cyBhcmUgbG9hZGVkIHdpdGggc3VjY2VzcyBvciBhbiBlcnJvciBpZiBzb21lb25lIGZhaWxzLlxyXG4gICAqXHJcbiAgICogQG1lbWJlck9mIFJ1bnRpbWVVQVxyXG4gICAqL1xyXG4gIF9sb2FkQ29tcG9uZW50cyhndWlkKSB7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICAgIHRyeSB7XHJcblxyXG4gICAgICAgIC8vIFByZXBhcmUgdGhlIG9uIGluc3RhbmNlIHRvIGhhbmRsZSB3aXRoIHRoZSBmYWxsYmFja3MgYW5kIHJ1bnRpbWVDYXRhbG9ndWU7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdG9ySW5zdGFuY2UgPSBuZXcgRGVzY3JpcHRvcnModGhpcy5ydW50aW1lVVJMLCB0aGlzLnJ1bnRpbWVDYXRhbG9ndWUsIHRoaXMucnVudGltZUNvbmZpZ3VyYXRpb24pO1xyXG5cclxuICAgICAgICAvLyBQcmVwYXJlIHRoZSBsb2FkZXIgdG8gbG9hZCB0aGUgaHlwZXJ0aWVzLCBwcm90b3N0dWJzIGFuZCBpZHBwcm94eTtcclxuICAgICAgICB0aGlzLmxvYWRlciA9IG5ldyBMb2FkZXIodGhpcy5ydW50aW1lVVJMLCB0aGlzLnJ1bnRpbWVDb25maWd1cmF0aW9uLCB0aGlzLmRlc2NyaXB0b3JJbnN0YW5jZSk7XHJcblxyXG4gICAgICAgIC8vIEluc3RhbnRpYXRlIHRoZSBpZGVudGl0eSBNb2R1bGVcclxuICAgICAgICB0aGlzLmlkZW50aXR5TW9kdWxlID0gbmV3IElkZW50aXR5TW9kdWxlKHRoaXMucnVudGltZVVSTCwgdGhpcy5ydW50aW1lQ2FwYWJpbGl0aWVzLCB0aGlzLnN0b3JhZ2VzLmlkZW50aXR5LCB0aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2UsIGNyeXB0b01hbmFnZXIsIHRoaXMucnVudGltZUNhdGFsb2d1ZSk7XHJcblxyXG4gICAgICAgIC8vIFVzZSB0aGUgc2FuZGJveCBmYWN0b3J5IHRvIGNyZWF0ZSBhbiBBcHBTYW5kYm94O1xyXG4gICAgICAgIC8vIEluIHRoZSBmdXR1cmUgY2FuIGJlIGRlY2lkZWQgYnkgcG9saWN5RW5naW5lIGlmIHdlIG5lZWRcclxuICAgICAgICAvLyBjcmVhdGUgYSBBcHBTYW5kYm94IG9yIG5vdDtcclxuICAgICAgICBsZXQgYXBwU2FuZGJveCA9IHRoaXMucnVudGltZUZhY3RvcnkuY3JlYXRlQXBwU2FuZGJveCgpO1xyXG5cclxuICAgICAgICAvLyBJbnN0YW50aWF0ZSB0aGUgUmVnaXN0cnkgTW9kdWxlXHJcbiAgICAgICAgdGhpcy5yZWdpc3RyeSA9IG5ldyBSZWdpc3RyeSh0aGlzLnJ1bnRpbWVVUkwsIGFwcFNhbmRib3gsIHRoaXMuaWRlbnRpdHlNb2R1bGUsIHRoaXMucnVudGltZUNhdGFsb2d1ZSwgdGhpcy5ydW50aW1lQ2FwYWJpbGl0aWVzLCB0aGlzLnN0b3JhZ2VzLnJlZ2lzdHJ5LCB0aGlzLnAycEhhbmRsZXJVUkwpO1xyXG5cclxuICAgICAgICAvLyBTZXQgdGhlIGxvYWRlciB0byBsb2FkIEh5cGVydGllcywgU3R1YnMgYW5kIElkcFByb3hpZXNcclxuICAgICAgICB0aGlzLnJlZ2lzdHJ5LmxvYWRlciA9IHRoaXMubG9hZGVyO1xyXG5cclxuICAgICAgICAvLyBJbnN0YW50aWF0ZSB0aGUgTWVzc2FnZSBCdXNcclxuICAgICAgICB0aGlzLm1lc3NhZ2VCdXMgPSBuZXcgTWVzc2FnZUJ1cyh0aGlzLnJlZ2lzdHJ5KTtcclxuXHJcbiAgICAgICAgLy8gSW5zdGFuY2lhdGUgdGhlIFN1YnNjcmlwdGlvbk1hbmFnZXI7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25NYW5hZ2VyID0gbmV3IFN1YnNjcmlwdGlvbk1hbmFnZXIodGhpcy5ydW50aW1lVVJMLCB0aGlzLm1lc3NhZ2VCdXMsIHRoaXMuc3RvcmFnZXMuc3Vic2NyaXB0aW9ucyk7XHJcblxyXG4gICAgICAgIC8vIFByZXBhcmUgdGhlIGFkZHJlc3MgYWxsb2NhdGlvbiBpbnN0YW5jZTtcclxuICAgICAgICB0aGlzLmFkZHJlc3NBbGxvY2F0aW9uID0gbmV3IEFkZHJlc3NBbGxvY2F0aW9uKHRoaXMucnVudGltZVVSTCwgdGhpcy5tZXNzYWdlQnVzLCB0aGlzLnJlZ2lzdHJ5LCB0aGlzLnN1YnNjcmlwdGlvbk1hbmFnZXIpO1xyXG5cclxuICAgICAgICAvLyBJbnN0YW50aWF0ZSB0aGUgUG9saWN5IEVuZ2luZVxyXG4gICAgICAgIHRoaXMucG9saWN5RW5naW5lID0gbmV3IFBFUChuZXcgUnVudGltZUNvcmVDdHgodGhpcy5ydW50aW1lVVJMLCB0aGlzLmlkZW50aXR5TW9kdWxlLCB0aGlzLnJlZ2lzdHJ5LCB0aGlzLnN0b3JhZ2VzLnBvbGljeSwgdGhpcy5ydW50aW1lQ2FwYWJpbGl0aWVzKSk7XHJcblxyXG4gICAgICAgIC8vIEluc3RhbnRpYXRlIERpc2NvdmVyeVxyXG4gICAgICAgIHRoaXMuY29yZURpc2NvdmVyeSA9IG5ldyBDb3JlRGlzY292ZXJ5KHRoaXMucnVudGltZVVSTCwgdGhpcy5tZXNzYWdlQnVzLCB0aGlzLmdyYXBoQ29ubmVjdG9yLCB0aGlzLnJ1bnRpbWVGYWN0b3J5LCB0aGlzLnJlZ2lzdHJ5KTtcclxuXHJcbiAgICAgICAgLy8gSW5zdGFudGlhdGUgdGhlIGlkZW50aXR5SGFuZGxlclxyXG4gICAgICAgIHRoaXMuaWRlbnRpdHlIYW5kbGVyID0gbmV3IElkZW50aXR5SGFuZGxlcih0aGlzLmlkZW50aXR5TW9kdWxlKTtcclxuXHJcbiAgICAgICAgLy8gaW5pdGlhbGlzZSB0aGUgQ3J5cHRvTWFuYWdlclxyXG4gICAgICAgIGNyeXB0b01hbmFnZXIuaW5pdCh0aGlzLnJ1bnRpbWVVUkwsIHRoaXMucnVudGltZUNhcGFiaWxpdGllcywgdGhpcy5zdG9yYWdlcy5jcnlwdG9NYW5hZ2VyLCB0aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2UsIHRoaXMucmVnaXN0cnksIHRoaXMuY29yZURpc2NvdmVyeSwgdGhpcy5pZGVudGl0eU1vZHVsZSwgdGhpcy5ydW50aW1lRmFjdG9yeSk7XHJcblxyXG4gICAgICAgIC8vIEluc3RhbnRpYXRlIHRoZSBHcmFwaCBDb25uZWN0b3JcclxuLy8gICAgICAgIHRoaXMuZ3JhcGhDb25uZWN0b3IgPSBwcm9jZXNzLmVudi5NT0RFICE9PSAnbGlnaHQnID8gbmV3IEdyYXBoQ29ubmVjdG9yKHRoaXMucnVudGltZVVSTCwgdGhpcy5tZXNzYWdlQnVzLCB0aGlzLnN0b3JhZ2VNYW5hZ2VyKSA6IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSBuZXcgTXNnQnVzSGFuZGxlcnModGhpcy5wb2xpY3lFbmdpbmUsIHRoaXMuaWRlbnRpdHlIYW5kbGVyLCBjcnlwdG9NYW5hZ2VyKTtcclxuXHJcbiAgICAgICAgLy8gKHVuKWNvbW1lbnQgYmVsbG93IHRvIG5vdCBlbmNyeXB0IG1lc3NhZ2VzXHJcblxyXG4gICAgICAgIHRoaXMubWVzc2FnZUJ1cy5waXBlbGluZU91dC5oYW5kbGVycyA9IFt0aGlzLmhhbmRsZXJzLmlkbUhhbmRsZXIsIHRoaXMuaGFuZGxlcnMucGVwT3V0SGFuZGxlcl07XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlQnVzLnBpcGVsaW5lSW4uaGFuZGxlcnMgPSBbIHRoaXMuaGFuZGxlcnMucGVwSW5IYW5kbGVyXTtcclxuXHJcbiAgICAgICAgLy8gKHVuKWNvbW1lbnQgYmVsbG93IHRvIGVuY3J5cHQgbWVzc2FnZXNcclxuXHJcbi8vICAgICAgdGhpcy5tZXNzYWdlQnVzLnBpcGVsaW5lT3V0LmhhbmRsZXJzID0gW3RoaXMuaGFuZGxlcnMuaWRtSGFuZGxlciwgdGhpcy5oYW5kbGVycy5wZXBPdXRIYW5kbGVyLCB0aGlzLmhhbmRsZXJzLmVuY3J5cHRIYW5kbGVyXTtcclxuLy8gICAgICB0aGlzLm1lc3NhZ2VCdXMucGlwZWxpbmVJbi5oYW5kbGVycyA9IFt0aGlzLmhhbmRsZXJzLmRlY3J5cHRIYW5kbGVyLCB0aGlzLmhhbmRsZXJzLnBlcEluSGFuZGxlcl07XHJcblxyXG4gICAgICAgIC8vIEFkZCB0byBBcHAgU2FuZGJveCB0aGUgbGlzdGVuZXI7XHJcbiAgICAgICAgYXBwU2FuZGJveC5hZGRMaXN0ZW5lcignKicsIChtc2cpID0+IHtcclxuICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjcnlwdG9NYW5hZ2VyLm1lc3NhZ2VCdXMgPSB0aGlzLm1lc3NhZ2VCdXM7XHJcblxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIG1lc3NhZ2VCdXMgb24gUmVnaXN0cnlcclxuICAgICAgICB0aGlzLnJlZ2lzdHJ5Lm1lc3NhZ2VCdXMgPSB0aGlzLm1lc3NhZ2VCdXM7XHJcblxyXG4gICAgICAgIC8vIFBvbGljeSBFbmdpbmVcclxuICAgICAgICB0aGlzLnBvbGljeUVuZ2luZS5tZXNzYWdlQnVzID0gdGhpcy5tZXNzYWdlQnVzO1xyXG5cclxuICAgICAgICAvLyBSZWdpc3RlciBtZXNzYWdlQnVzIG9uIElETVxyXG4gICAgICAgIHRoaXMuaWRlbnRpdHlNb2R1bGUubWVzc2FnZUJ1cyA9IHRoaXMubWVzc2FnZUJ1cztcclxuXHJcbiAgICAgICAgLy8gUmVnaXN0ZXIgcmVnaXN0cnkgb24gSWRlbnRpdHlNb2R1bGVcclxuICAgICAgICB0aGlzLmlkZW50aXR5TW9kdWxlLnJlZ2lzdHJ5ID0gdGhpcy5yZWdpc3RyeTtcclxuXHJcbiAgICAgICAgLy8gUmVnaXN0ZXIgY29yZURpc2NvdmVyeSBvbiBJZGVudGl0eU1vZHVsZVxyXG4gICAgICAgIHRoaXMuaWRlbnRpdHlNb2R1bGUuY29yZURpc2NvdmVyeSA9IHRoaXMuY29yZURpc2NvdmVyeTtcclxuXHJcbiAgICAgICAgLy8gVXNlIHNhbmRib3ggZmFjdG9yeSB0byB1c2Ugc3BlY2lmaWMgbWV0aG9kc1xyXG4gICAgICAgIC8vIGFuZCBzZXQgdGhlIG1lc3NhZ2UgYnVzIHRvIHRoZSBmYWN0b3J5XHJcbiAgICAgICAgdGhpcy5ydW50aW1lRmFjdG9yeS5tZXNzYWdlQnVzID0gdGhpcy5tZXNzYWdlQnVzO1xyXG5cclxuICAgICAgICAvLyBJbnN0YW5jaWF0ZSB0aGUgU3luY2hlck1hbmFnZXI7XHJcbiAgICAgICAgdGhpcy5zeW5jaGVyTWFuYWdlciA9IG5ldyBTeW5jaGVyTWFuYWdlcih0aGlzLnJ1bnRpbWVVUkwsIHRoaXMubWVzc2FnZUJ1cywgdGhpcy5yZWdpc3RyeSwgdGhpcy5ydW50aW1lQ2F0YWxvZ3VlLCB0aGlzLnN0b3JhZ2VzLnN5bmNoZXJNYW5hZ2VyLCBudWxsLCB0aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2UsIHRoaXMuaWRlbnRpdHlNb2R1bGUpO1xyXG5cclxuXHJcbiAgICAgICAgLy8gU2V0IGludG8gbG9hZGVyIHRoZSBuZWVkZWQgY29tcG9uZW50cztcclxuICAgICAgICB0aGlzLmxvYWRlci5ydW50aW1lVVJMID0gdGhpcy5ydW50aW1lVVJMO1xyXG4gICAgICAgIHRoaXMubG9hZGVyLm1lc3NhZ2VCdXMgPSB0aGlzLm1lc3NhZ2VCdXM7XHJcbiAgICAgICAgdGhpcy5sb2FkZXIucmVnaXN0cnkgPSB0aGlzLnJlZ2lzdHJ5O1xyXG4gICAgICAgIHRoaXMubG9hZGVyLnJ1bnRpbWVDYXRhbG9ndWUgPSB0aGlzLnJ1bnRpbWVDYXRhbG9ndWU7XHJcbiAgICAgICAgdGhpcy5sb2FkZXIucnVudGltZUZhY3RvcnkgPSB0aGlzLnJ1bnRpbWVGYWN0b3J5O1xyXG5cclxuICAgICAgICAvL0luc3RhbnRpYXRlIERpc2NvdmVyeSBMaWIgZm9yIG5vdGlmaWNhdGlvbiB0ZXN0aW5nXHJcbiAgICAgICAgLy8gdGhpcy5kaXNjb3ZlcnkgPSBuZXcgRGlzY292ZXJ5KFwiaHlwZXJ0eTovL2xvY2FsaG9zdC90ZXN0XCIsIHRoaXMucnVudGltZVVSTCwgdGhpcy5tZXNzYWdlQnVzKTtcclxuICAgICAgICAvLyB0aGlzLmxvYWRTdHViKFwibG9jYWxob3N0XCIpO1xyXG4gICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIC8vICAgdGhpcy5kaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnRpZXNETyhcInVzZXI6Ly9nb29nbGUuY29tL29wZW5pZHRlc3QyMEBnbWFpbC5jb21cIilcclxuICAgICAgICAvLyAgIC50aGVuKGh5cGVydGllcyA9PiB7XHJcbiAgICAgICAgLy8gICAgIGh5cGVydGllcy5mb3JFYWNoKGh5cGVydHkgPT57XHJcbiAgICAgICAgLy8gICAgICAgaHlwZXJ0eS5vbkxpdmUoKCkgPT4gbG9nLmxvZyhgTm90aWZpY2F0aW9uIGZyb20gJHtoeXBlcnR5LmRhdGEuaHlwZXJ0eUlEfSBjaGFuZ2VkIHRvIGxpdmVgKSk7XHJcbiAgICAgICAgLy8gICAgICAgaHlwZXJ0eS5vbkRpc2Nvbm5lY3RlZCgoKSA9PiBsb2cubG9nKGBOb3RpZmljYXRpb24gZnJvbSAke2h5cGVydHkuZGF0YS5oeXBlcnR5SUR9IGNoYW5nZWQgdG8gZGlzY29ubmVjdGVkYCkpO1xyXG4gICAgICAgIC8vICAgICB9KTtcclxuICAgICAgICAvLyAgIH0pO1xyXG4gICAgICAgIC8vIH0sIDIwMDApO1xyXG5cclxuXHJcbiAgICAgICAgLy8gdGhpcy5zdWJzY3JpcHRpb25NYW5hZ2VyLmluaXQoKS50aGVuKCgpPT57XHJcbiAgICAgICAgLy8gICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIC8vIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBwcmVwYXJlQ29tcG9uZW50cyA9IFtdO1xyXG4gICAgICAgIHByZXBhcmVDb21wb25lbnRzLnB1c2godGhpcy5zdWJzY3JpcHRpb25NYW5hZ2VyLmluaXQoKSk7XHJcbiAgICAgICAgcHJlcGFyZUNvbXBvbmVudHMucHVzaCh0aGlzLmlkZW50aXR5TW9kdWxlLmluaXQoZ3VpZCkpO1xyXG4gICAgICAgIHByZXBhcmVDb21wb25lbnRzLnB1c2goY3J5cHRvTWFuYWdlci5sb2FkU2Vzc2lvbktleXMoKSk7XHJcbiAgICAgICAgcHJlcGFyZUNvbXBvbmVudHMucHVzaCh0aGlzLnJlZ2lzdHJ5LmxvYWRSZWdpc3RyeSgpKTtcclxuICAgICAgICBwcmVwYXJlQ29tcG9uZW50cy5wdXNoKHRoaXMuX2RhdGFPYmplY3RzU3RvcmFnZS5sb2FkUmVtb3RlKCkpO1xyXG5cclxuICAgICAgICBQcm9taXNlLmFsbChwcmVwYXJlQ29tcG9uZW50cykudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gNSkge1xyXG4gICAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KCdbUnVudGltZVVBLl9sb2FkQ29tcG9uZW50c10gRXJyb3IgXSAnLCByZXN1bHQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICAgIHRocm93IEVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVwbG95IEh5cGVydHkgZnJvbSBDYXRhbG9ndWUgVVJMXHJcbiAgICpcclxuICAgKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvdHJlZS9tYXN0ZXIvZGF0YW1vZGVsL2NvcmUvYWRkcmVzc1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtVUkwuSHlwZXJ0eUNhdGFsb2d1ZVVSTH0gaHlwZXJ0eUNhdGFsb2d1ZVVSTCAtIFRoZSBDYXRhbG9ndWUgVVJMIHVzZWQgdG8gaWRlbnRpZnkgZGVzY3JpcHRvcnMgaW4gdGhlIENhdGFsb2d1ZS5cclxuICAgKiBAcGFyYW0ge2Jvb2xlYW58VVJMLkh5cGVydHlVUkx9IFtyZXVzZVVSTD1mYWxzZV0gcmV1c2VVUkwgLSByZXVzZVVSTCBpcyB1c2VkIHRvIHJldXNlIHRoZSBoeXBlcnR5VVJMIHByZXZpb3VzbHkgcmVnaXN0cmVkLCBieSBkZWZhdWx0IHRoZSByZXVzZSBpcyBkaXNhYmxlZDtcclxuICAgKiBAcGFyYW0ge1VSTH0gYXBwVVJMIC0gdGhlIGFwcCB1cmwgYWRkcmVzczsgLy8gVE9ETzogaW1wcm92ZSB0aGlzIGRlc2NyaXB0aW9uO1xyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPEJvb2xlYW4sIEVycm9yPn0gdGhpcyBpcyBQcm9taXNlIGFuZCByZXR1cm5zIHRydWUgaWYgYWxsIGNvbXBvbmVudHMgYXJlIGxvYWRlZCB3aXRoIHN1Y2Nlc3Mgb3IgYW4gZXJyb3IgaWYgc29tZW9uZSBmYWlscy5cclxuICAgKlxyXG4gICAqIEBtZW1iZXJPZiBSdW50aW1lVUFcclxuICAgKi9cclxuICBsb2FkSHlwZXJ0eShoeXBlcnR5Q2F0YWxvZ3VlVVJMLCByZXVzZVVSTCA9IGZhbHNlLCBhcHBVUkwpIHtcclxuXHJcbiAgICBpZiAoIWh5cGVydHlDYXRhbG9ndWVVUkwpIHRocm93IG5ldyBFcnJvcignSHlwZXJ0eSBkZXNjcmlwdG9yIHVybCBwYXJhbWV0ZXIgaXMgbmVlZGVkJyk7XHJcbiAgICByZXR1cm4gdGhpcy5sb2FkZXIubG9hZEh5cGVydHkoaHlwZXJ0eUNhdGFsb2d1ZVVSTCwgcmV1c2VVUkwsIGFwcFVSTCk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBEZXBsb3kgU3R1YiBmcm9tIENhdGFsb2d1ZSBVUkwgb3IgZG9tYWluIHVybFxyXG4gICogQHBhcmFtICB7VVJMLlVSTH0gICAgIGRvbWFpbiAgICAgICAgICBkb21haW5cclxuICAqL1xyXG4gIGxvYWRTdHViKHByb3RvY29sc3R1YkNhdGFsb2d1ZVVSTCkge1xyXG5cclxuICAgIGlmICghcHJvdG9jb2xzdHViQ2F0YWxvZ3VlVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1Byb3RvU3R1YiBkZXNjcmlwdG9yIHVybCBwYXJhbWV0ZXIgaXMgbmVlZGVkJyk7XHJcbiAgICByZXR1cm4gdGhpcy5sb2FkZXIubG9hZFN0dWIocHJvdG9jb2xzdHViQ2F0YWxvZ3VlVVJMKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIERlcGxveSBpZHBQcm94eSBmcm9tIENhdGFsb2d1ZSBVUkwgb3IgZG9tYWluIHVybFxyXG4gICogQHBhcmFtICB7VVJMLlVSTH0gICAgIGRvbWFpbiAgICAgICAgICBkb21haW5cclxuICAqL1xyXG4gIGxvYWRJZHBQcm94eShpcGRQcm94eUNhdGFsb2d1ZVVSTCkge1xyXG4gICAgbG9nLmxvZygnaXBkUHJveHlDYXRhbG9ndWVVUkwnLCBpcGRQcm94eUNhdGFsb2d1ZVVSTCk7XHJcblxyXG4gICAgaWYgKCFpcGRQcm94eUNhdGFsb2d1ZVVSTCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgSURQIFByb3h5IFVSTCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXIsIGNvdWxkIGJlIGEgRE9NQUlOIG9yIGEgVVJMJyk7XHJcbiAgICByZXR1cm4gdGhpcy5sb2FkZXIubG9hZElkcFByb3h5KGlwZFByb3h5Q2F0YWxvZ3VlVVJMKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVzZWQgdG8gY2xvc2UgYWxsIHRoZSBydW50aW1lOyBVbnJlZ2lzdGVyIGFsbCBoeXBlcnRpZXM7XHJcbiAgICogQHJldHVybiB7UHJvbWlzZTxCb29sZWFuPn0gcmVzdWx0IG9mIHRoZSBjbG9zZSBtZXRob2QsIHdpdGggdHJ1ZSBvciBmYWxzZSB0byB0aGUgb3BlcmF0aW9uIHN1Y2Nlc3M7XHJcbiAgICovXHJcbiAgY2xvc2UobG9nT3V0KSB7XHJcbiAgICBjb25zb2xlLmxvZygnUnVudGltZSBjb3JlIGxvZ291dDogJywgbG9nT3V0KTtcclxuICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICBpZiAobG9nT3V0ID09PSB0cnVlKSB7XHJcbiAgICAgIHRoaXMuaWRlbnRpdHlIYW5kbGVyLnJlc2V0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgbG9nLmluZm8oJ1VucmVnaXN0ZXIgYWxsIGh5cGVydGllcycpO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuXHJcbiAgICAgIF90aGlzLnJlZ2lzdHJ5LnVucmVnaXN0ZXJBbGxIeXBlcnRpZXMoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICBsb2cuaW5mbygnQWxsIHRoZSBoeXBlcnRpZXMgYXJlIHVucmVnaXN0ZWQgd2l0aCBTdWNjZXNzOicsIHJlc3VsdCk7XHJcbiAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgIGxvZy5lcnJvcignRmFpbGVkIHRvIHVucmVnaXN0ZXIgdGhlIGh5cGVydGllcycsIHJlYXNvbik7XHJcbiAgICAgICAgcmVqZWN0KGZhbHNlKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXNlZCB0byByZXNldCB0aGUgcnVudGltZSBieSBkZWxldGluZyBhbGwgZGF0YSBmcm9tIHRoZSBzdG9yYWdlIG1hbmFnZXI7XHJcbiAgICogQHJldHVybiB7UHJvbWlzZTxCb29sZWFuPn0gcmVzdWx0IG9mIHRoZSByZXNldCBtZXRob2QsIHdpdGggdHJ1ZSBvciBmYWxzZSB0byB0aGUgb3BlcmF0aW9uIHN1Y2Nlc3M7XHJcbiAgICovXHJcbiAgcmVzZXQoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnUnVudGltZVVBLlJ1bnRpbWUgY29yZSByZXNldDogJyk7XHJcblxyXG4gICAgbGV0IHJlc2V0aW5nID0gW107XHJcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIC8vVE9ETzogZGVsZWdhdGUgZGIgcmVzZXQgb3BlcmF0aW9uIHRvIGVhY2ggY29tcG9uZW50XHJcbiAgICAgIC8vICAgIHRoaXMuaWRlbnRpdHlNYW5hZ2VyLnJlc2V0KCk7XHJcblxyXG4gICAgICB0aGlzLl9kYXRhT2JqZWN0c1N0b3JhZ2UuZGVsZXRlUmVtb3RlcygpLnRoZW4oKCk9PntcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xyXG4gICAgICB9KS5cclxuICAgICAgdGhlbigoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlcy5pZGVudGl0eS5nZXQoZmFsc2UsIGZhbHNlLCAnaWRlbnRpdGllcycpLnRoZW4oKGlkZW50aXRpZXMpID0+IHtcclxuICAgICAgICAgIGxldCBpZGVudGl0aWVzS2V5cyA9IE9iamVjdC5rZXlzKGlkZW50aXRpZXMpO1xyXG4gIFxyXG4gICAgICAgICAgaWRlbnRpdGllc0tleXMuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgICAgICAgIHJlc2V0aW5nLnB1c2godGhpcy5zdG9yYWdlcy5pZGVudGl0eS5kZWxldGUoa2V5LCBmYWxzZSwgJ2lkZW50aXRpZXMnKSk7XHJcbiAgXHJcbiAgICAgICAgICB9KTtcclxuICBcclxuICAgICAgICAgIHJlc2V0aW5nLnB1c2godGhpcy5zdG9yYWdlcy5jYXBhYmlsaXRpZXMuZGVsZXRlKCdjYXBhYmlsaXRpZXMnKSk7XHJcbiAgICAgICAgICByZXNldGluZy5wdXNoKHRoaXMuc3RvcmFnZXMuY3J5cHRvTWFuYWdlci5kZWxldGUoJ3VzZXJBc3ltbWV0cmljS2V5JykpO1xyXG4gICAgICAgICAgcmVzZXRpbmcucHVzaCh0aGlzLnN0b3JhZ2VzLmh5cGVydHlSZXNvdXJjZXMuZGVsZXRlKCdoeXBlcnR5UmVzb3VyY2VzJykpO1xyXG4gICAgICAgICAgcmVzZXRpbmcucHVzaCh0aGlzLnN0b3JhZ2VzLmlkZW50aXR5LmRlbGV0ZSgnYWNjZXNzVG9rZW5zJykpO1xyXG4gICAgICAgICAgcmVzZXRpbmcucHVzaCh0aGlzLnN0b3JhZ2VzLnJlZ2lzdHJ5LmRlbGV0ZSgncmVnaXN0cnk6RGF0YU9iamVjdFVSTHMnKSk7XHJcbiAgICAgICAgICByZXNldGluZy5wdXNoKHRoaXMuc3RvcmFnZXMucmVnaXN0cnkuZGVsZXRlKCdyZWdpc3RyeTpIeXBlcnR5VVJMcycpKTtcclxuICAgICAgICAgIHJlc2V0aW5nLnB1c2godGhpcy5zdG9yYWdlcy5ydW50aW1lLmRlbGV0ZSgncDJwSGFuZGxlcjpVUkwnKSk7XHJcbiAgICAgICAgICByZXNldGluZy5wdXNoKHRoaXMuc3RvcmFnZXMucnVudGltZS5kZWxldGUoJ3J1bnRpbWU6VVJMJykpO1xyXG4gICAgICAgICAgLy8gICAgcmVzZXRpbmcucHVzaCh0aGlzLnN0b3JhZ2VzLnJ1bnRpbWVDYXRhbG9ndWUuZGVsZXRlKCdydW50aW1lQ2F0YWxvZ3VlJykpO1xyXG4gICAgICAgICAgcmVzZXRpbmcucHVzaCh0aGlzLnN0b3JhZ2VzLnN1YnNjcmlwdGlvbnMuZGVsZXRlKCdzdWJzY3JpcHRpb25zJykpO1xyXG4gICAgICAgICAgcmVzZXRpbmcucHVzaCh0aGlzLnN0b3JhZ2VzLnN5bmNoZXJNYW5hZ2VyLmRlbGV0ZSgnc3luY2hlck1hbmFnZXI6T2JqZWN0VVJMcycpKTtcclxuICAgICAgICAgIHJlc2V0aW5nLnB1c2godGhpcy5zdG9yYWdlcy5zeW5jaGVyTWFuYWdlci5kZWxldGUoJ3JlbW90ZXMnKSk7XHJcbiAgXHJcbiAgICAgICAgICBQcm9taXNlLmFsbChyZXNldGluZykudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgXHJcbiAgICAgICAgICAgIGxvZy5pbmZvKCdbUnVudGltZVVBLnJlc2V0XSByZXNldCB3aXRoIFN1Y2Nlc3M6JywgcmVzdWx0KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgIGxvZy5lcnJvcignRmFpbGVkIHRvIHJlc2V0IGFsbCBEQnMnLCByZWFzb24pO1xyXG4gICAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KVxyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFJ1bnRpbWVVQTtcclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW9CQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQy9IQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBRkE7O0FDQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0JBOzs7OztBQUtBOzs7Ozs7OztBQVFBOzs7OztBQUtBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBRUE7QUFFQTs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFTQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7QUFLQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBS0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUVBOzs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQzFrQkE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBRUE7Ozs7OztBQUtBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTs7O0FBbEdBO0FBQUE7QUFBQTs7Ozs7O0FBc0dBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBOzs7Ozs7OztBQy9IQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXNCQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7Ozs7QUFHQTtBQUFBOzs7O0FBQ0E7Ozs7O0FBTUE7Ozs7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7Ozs7QUFRQTs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUVBOzs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTEE7QUFZQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBOzs7Ozs7OztBQTBDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBOzs7QUF4T0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBNkpBO0FBQUE7QUFBQTtBQUVBOzs7Ozs7O0FBSUE7QUFBQTtBQUFBO0FBRUE7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUtBO0FBQUE7QUFBQTtBQUVBOzs7Ozs7OztBQUtBO0FBQUE7QUFBQTtBQUVBOzs7Ozs7QUFLQTtBQUFBO0FBQUE7Ozs7OztBQXNDQTs7Ozs7Ozs7QUNwVUE7QUFFQTs7Ozs7QUFJQTs7O0FBQ0E7OztBQUlBOzs7O0FBSUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFKQTtBQVVBO0FBRUE7QUFFQTtBQWpCQTtBQXFCQTtBQUNBOzs7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFRQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBSkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFKQTtBQVVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUpBO0FBVUE7QUFDQTtBQUNBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTs7O0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFDQTs7O0FBckhBO0FBQ0E7QUFHQTs7Ozs7O0FBdUhBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyT0E7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFFQTs7Ozs7Ozs7Ozs7QUFZQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQVJBO0FBVUE7QUFDQTs7OztBQTRCQTs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFKQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFyQkE7QUF3QkE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7OztBQWxPQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBOzs7O0FBbkRBO0FBQ0E7QUFnUUE7Ozs7Ozs7O0FDN1FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBS0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDckpBOzs7O0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7QUFFQTs7Ozs7Ozs7Ozs7QUFZQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWdCQTtBQUNBO0FBQUE7Ozs7Ozs7Ozs7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFIQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFjQTs7Ozs7O0FBTUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTJCQTs7Ozs7QUFNQTtBQUVBOzs7QUFuREE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7OztBQXRIQTtBQUNBO0FBcUtBOzs7Ozs7OztBQ3BMQTs7OztBQUtBO0FBQ0E7QUFDQTs7O0FBRUE7Ozs7QUFLQTtBQUFBO0FBRUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQU5BO0FBQ0E7QUFRQTtBQUVBOzs7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOzs7Ozs7QUFHQTs7Ozs7Ozs7OztBQzNEQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7O0FBSUE7OztBQUNBOzs7Ozs7Ozs7Ozs7OztBQWlCQTs7OztBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBOzs7Ozs7QUFHQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBR0E7Ozs7Ozs7Ozs7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTs7Ozs7O0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQUNBO0FBU0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7OztBQXFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUxBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFDQTtBQVNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUE3WkE7QUFBQTtBQUFBO0FBRUE7Ozs7Ozs7QUFJQTtBQUFBO0FBQUE7QUFFQTs7Ozs7OztBQUlBO0FBQUE7QUFBQTtBQUVBOzs7Ozs7O0FBSUE7QUFBQTtBQUFBO0FBRUE7Ozs7Ozs7QUFJQTtBQUFBO0FBQUE7QUFFQTs7Ozs7OztBQUlBO0FBQUE7QUFBQTs7Ozs7O0FBbVlBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1d0JBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTs7Ozs7QUFJQTs7Ozs7QUFDQTs7Ozs7Ozs7QUFTQTs7OztBQUtBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQWhCQTtBQWlCQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBSkE7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFHQTs7Ozs7OztBQVFBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBOzs7O0FBREE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFDQTtBQUdBOzs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFNQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFGQTtBQUlBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBN0RBO0FBQ0E7QUErREE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFkQTtBQUNBO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7O0FBcUJBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUlBO0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFJQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQWZBO0FBQ0E7QUFpQkE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBOzs7QUE5VkE7QUFBQTtBQUFBOzs7QUF3TkE7QUFDQTtBQUNBO0FBQUE7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQXBaQTtBQUFBOzs7QUE2Z0JBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoakJBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7Ozs7O0FBSUE7Ozs7O0FBQ0E7Ozs7OztBQU9BOzs7O0FBS0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBakJBO0FBaUJBO0FBRUE7Ozs7Ozs7QUFHQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBR0E7Ozs7Ozs7Ozs7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTEE7QUFDQTtBQVdBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBOzs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSkE7QUFTQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU9BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFKQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBelRBO0FBQUE7OztBQTRUQTs7Ozs7Ozs7QUNoV0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBOzs7Ozs7Ozs7OztBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBOzs7OztBQU9BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7O0FBR0E7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFQQTtBQUFBO0FBQUE7Ozs7OztBQVVBOzs7Ozs7OztBQ3pHQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFLQTs7O0FBQ0E7Ozs7Ozs7Ozs7OztBQWVBOzs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFrQkE7Ozs7Ozs7Ozs7OztBQVlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7OztBQVdBO0FBQ0E7Ozs7Ozs7Ozs7OztBQWtCQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7OztBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFEQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFLQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQU1BO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBOzs7Ozs7Ozs7Ozs7Ozs7QUFlQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF5QkE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFNQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQXBCQTtBQUNBO0FBc0JBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBTEE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQXJCQTtBQUNBO0FBdUJBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQWFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBOzs7QUF6dUJBO0FBQUE7QUFBQTtBQUVBOzs7Ozs7O0FBSUE7QUFBQTtBQUFBO0FBRUE7Ozs7Ozs7QUFJQTtBQUFBO0FBQUE7Ozs7OztBQWl1QkE7Ozs7Ozs7O0FDMzBCQTs7O0FBSUE7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQXpCQTtBQUNBO0FBMEJBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFyQkE7QUFDQTtBQXVCQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQ0E7Ozs7OztBQUdBOzs7Ozs7OztBQ3BJQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXNCQTtBQUVBOzs7OztBQUlBOzs7QUFFQTs7Ozs7OztBQU9BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQURBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBR0E7Ozs7Ozs7O0FDaEhBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7O0FBSUE7OztBQUVBOzs7Ozs7O0FBUUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUpBO0FBU0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFFQTs7O0FBR0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQVNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7OztBQUdBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUVBOzs7Ozs7QUFJQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMzTkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7QUFDQTtBQUVBOzs7O0FBR0E7Ozs7Ozs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFKQTtBQUtBO0FBS0E7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBekNBO0FBQ0E7QUE4Q0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1RUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7OztBQUlBOzs7QUFFQTs7Ozs7O0FBTUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7OztBQVFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUpBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7OztBQVFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUpBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7Ozs7QUFHQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7O0FBUUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFGQTtBQUpBO0FBWUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBRkE7QUFKQTtBQVlBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7O0FBUUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7OztBQVFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFEQTtBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFEQTtBQURBO0FBTUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFEQTtBQUlBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQURBO0FBSUE7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7OztBQUdBOzs7Ozs7OztBQ3YrQkE7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7O0FBRUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUFLQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFHQTs7Ozs7Ozs7QUNuSEE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0JBOzs7O0FBSUE7Ozs7Ozs7Ozs7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUlBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTs7Ozs7QUFLQTs7Ozs7QUFFQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFoQ0E7QUFpQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7QUFHQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7OztBQU1BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTs7OztBQTVSQTtBQUNBO0FBK1JBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzdTQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTs7Ozs7QUFJQTs7Ozs7QUFFQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFyQ0E7QUFzQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFFQTs7OztBQS9JQTtBQUNBO0FBbUpBOzs7O0FDeExBOzs7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBRUE7Ozs7QUNuQkE7OztBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBSUE7O0FDdkJBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFNQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMzQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBOzs7OztBQU1BO0FBRUE7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7Ozs7QUFLQTs7Ozs7QUFNQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFBQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBR0E7OztBQTVJQTtBQUNBO0FBQ0E7Ozs7OztBQThJQTs7Ozs7Ozs7QUMzTEE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBOzs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7OztBQXlIQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7OztBQXFCQTtBQUVBO0FBRUE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQURBO0FBSUE7QUFFQTtBQUNBO0FBREE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQU9BO0FBQ0E7QUFWQTtBQWFBO0FBQ0E7QUFEQTtBQU1BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFZQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUdBOzs7Ozs7QUFNQTs7Ozs7Ozs7O0FBTUE7QUFFQTtBQUNBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7OztBQXhtQkE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBbEJBO0FBb0JBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBZ0JBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7Ozs7O0FBd2RBOzs7Ozs7QUN6cUJBO0FBRUE7QUFFQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTUE7Ozs7Ozs7O0FDaEJBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFLQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7OztBQVVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBVUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQXJQQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7Ozs7OztBQW1QQTs7Ozs7Ozs7QUNqVkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBOzs7OztBQU1BO0FBQ0E7QUFDQTtBQUVBOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUlBO0FBRUE7Ozs7Ozs7QUF3SEE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7QUFxQkE7QUFFQTtBQUVBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFEQTtBQUlBO0FBRUE7QUFDQTtBQURBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFLQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBT0E7QUFDQTtBQVZBO0FBYUE7QUFDQTtBQURBO0FBTUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTtBQUNBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7OztBQU1BO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWlDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBeURBOzs7Ozs7O0FBTUE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFvQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUdBOzs7Ozs7QUFNQTs7Ozs7Ozs7O0FBTUE7QUFFQTtBQUNBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7OztBQTFtQkE7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQWxCQTtBQW9CQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQWdCQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7Ozs7OztBQThkQTs7Ozs7Ozs7QUM5cUJBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFLQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7OztBQWlCQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUlBO0FBQ0E7QUFBQTs7Ozs7Ozs7QUFPQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFHQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBVUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQXJOQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7Ozs7O0FBMk1BOzs7Ozs7OztBQ2pUQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7QUFHQTs7O0FBQ0E7OztBQUlBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFLQTtBQUNBO0FBRUE7OztBQVBBO0FBQ0E7QUFDQTs7Ozs7O0FBWUE7Ozs7Ozs7O0FDdEhBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXNCQTs7OztBQUlBO0FBRUE7Ozs7OztBQUtBOzs7QUFDQTs7O0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUZBO0FBSUE7QUFDQTtBQUNBOzs7QUFHQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQURBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQ0E7QUFDQTs7OztBQUlBOzs7QUF6RkE7QUFBQTtBQUFBOzs7Ozs7QUE0RkE7QUFDQTtBQUVBOzs7Ozs7OztBQ3pKQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQU1BOzs7QUFDQTs7Ozs7O0FBU0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7QUFRQTtBQUVBOzs7Ozs7Ozs7O0FBU0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQUE7QUFDQTtBQUNBOzs7Ozs7Ozs7QUFNQTtBQUFBO0FBQUE7Ozs7OztBQUlBOzs7QUFDQTs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUdBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFsQkE7QUFBQTtBQUFBOzs7Ozs7QUFxQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDOVVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0JBO0FBRUE7Ozs7OztBQUtBOzs7OztBQUVBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFFQTs7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBdkNBO0FBQ0E7QUEwQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDeEVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0JBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7Ozs7O0FBSUE7Ozs7O0FBRUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFQQTtBQVNBO0FBRUE7Ozs7Ozs7Ozs7O0FBT0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7Ozs7QUF0RkE7QUFDQTtBQXlGQTs7Ozs7Ozs7QUMxSEE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUdBO0FBRUE7Ozs7QUFHQTs7O0FBQ0E7Ozs7O0FBS0E7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQWdCQTs7Ozs7Ozs7Ozs7Ozs7QUFjQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTs7O0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFrQkE7QUFFQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7Ozs7Ozs7OztBQVlBO0FBRUE7Ozs7QUE5SkE7Ozs7QUFJQTtBQUFBO0FBQUE7OztBQVpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFtS0E7Ozs7Ozs7O0FDdE9BOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXNCQTs7OztBQUlBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDckVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0JBO0FBRUE7Ozs7O0FBSUE7Ozs7O0FBRUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFZQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7OztBQTNEQTtBQUNBO0FBNkRBOzs7Ozs7OztBQzFGQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBR0E7Ozs7QUFHQTs7O0FBRUE7Ozs7OztBQU1BO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTs7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBRkE7QUFGQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUdBOzs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBREE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSkE7QUFDQTtBQU1BO0FBRUE7QUFDQTtBQUVBO0FBR0E7QUFLQTs7Ozs7Ozs7QUFPQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFKQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBREE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSkE7QUFDQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUlBOzs7Ozs7OztBQzlYQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTtBQUNBO0FBQ0E7QUFFQTs7OztBQUdBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBR0E7Ozs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQU5BO0FBU0E7QUFFQTs7Ozs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFKQTtBQUNBO0FBV0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFUQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDclZBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBSUE7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1Q0E7Ozs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBOzs7QUFHQTs7OztBQUdBOzs7QUFFQTs7Ozs7Ozs7O0FBU0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQThFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQWRBO0FBZ0JBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7O0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFHQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOzs7Ozs7Ozs7QUFTQTtBQUNBOzs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUdBOzs7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFHQTs7Ozs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7O0FBR0E7QUFJQTtBQUVBO0FBRUE7QUFFQTs7OztBQUlBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQURBO0FBSUE7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQUVBO0FBRUE7QUFFQTs7Ozs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSkE7QUFDQTtBQVNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7O0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFEQTtBQUlBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFUQTtBQUNBO0FBREE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUEzQ0E7QUE2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBbC9DQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBOzs7Ozs7QUE0NkNBOztBQ3puREE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBREE7QUFwQ0E7QUF5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFyQkE7QUEwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU5BO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFoR0E7Ozs7Ozs7O0FDQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBOzs7OztBQUlBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUE2Q0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTs7O0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7OztBQTNUQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFFQTtBQU9BO0FBQ0E7QUFFQTs7O0FBUkE7QUFDQTtBQUVBO0FBT0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7Ozs7QUFzUkE7QUFDQTtBQUNBO0FBQUE7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7Ozs7QUFJQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUdBOzs7Ozs7QUFHQTs7OztBQ3pZQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBS0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFNQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBOzs7Ozs7OztBQzFEQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTRCQTs7O0FBRUE7OztBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUdBO0FBQ0E7QUFBQTtBQUVBOzs7OztBQU1BO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUdBOzs7Ozs7OztBQXdEQTtBQUNBO0FBQUE7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBRUE7Ozs7O0FBS0E7Ozs7O0FBS0E7Ozs7Ozs7O0FBbUJBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUtBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTs7Ozs7QUFJQTs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7Ozs7Ozs7O0FBS0E7QUFDQTs7OztBQUtBO0FBQ0E7QUFBQTs7Ozs7QUFPQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBTUE7QUFFQTtBQUVBO0FBRUE7Ozs7O0FBSUE7Ozs7Ozs7O0FBVUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBR0E7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUlBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSkE7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQU9BO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOzs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQURBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQURBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7O0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBREE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTEE7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBOzs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBa0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQXo4Q0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQTRCQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7Ozs7QUF1M0NBOzs7Ozs7OztBQzVpREE7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBRUE7QUFFQTs7Ozs7Ozs7Ozs7O0FBY0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7Ozs7OztBQUtBOzs7Ozs7OztBQ2pHQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQU5BO0FBUUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDcEdBOzs7Ozs7Ozs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDN0NBO0FBRUE7Ozs7Ozs7O0FBT0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDM0NBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTs7OztBQUlBOzs7Ozs7Ozs7O0FBRUE7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDaERBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTs7OztBQUlBOzs7Ozs7Ozs7O0FBRUE7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDaERBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTs7OztBQUlBOzs7Ozs7Ozs7O0FBRUE7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7Ozs7QUFJQTs7Ozs7Ozs7QUM3Q0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7QUFFQTs7Ozs7QUFJQTs7O0FBRUE7Ozs7Ozs7QUFPQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQUtBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFJQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbkVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBRUE7Ozs7O0FBSUE7Ozs7O0FBRUE7Ozs7Ozs7QUFPQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBRUE7Ozs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBMUJBO0FBQ0E7QUE2QkE7Ozs7Ozs7O0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDbEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkNBO0FBQ0E7QUF5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFHQTs7Ozs7Ozs7QUN0RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBWEE7QUFhQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUlBOzs7Ozs7OztBQy9IQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBOzs7O0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBbUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQVRBO0FBV0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBdEJBO0FBd0JBOzs7QUF2TEE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBOzs7Ozs7QUE4S0E7Ozs7Ozs7O0FDMU5BOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0JBO0FBQ0E7QUFFQTs7Ozs7O0FBTUE7QUFDQTtBQUNBOzs7QUFDQTs7OztBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBR0E7Ozs7Ozs7QUFLQTs7O0FBQ0E7Ozs7OztBQVFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQU1BOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBNUNBO0FBQUE7QUFBQTs7O0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBOzs7Ozs7QUFnREE7OztBQUNBOzs7O0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUdBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2hLQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7OztBQUtBOzs7OztBQUNBOzs7OztBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFYQTtBQVlBO0FBQ0E7Ozs7QUFLQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTs7Ozs7Ozs7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFUQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBckxBO0FBQUE7QUFBQTs7O0FBRUE7QUFBQTtBQUFBOzs7O0FBNUJBO0FBQ0E7QUFpTkE7O0FDclBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7Ozs7Ozs7QUNqRUE7QUFDQTtBQUNBO0FBRUE7Ozs7O0FBSUE7OztBQUVBOzs7OztBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQURBO0FBSUE7QUFMQTtBQVFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBREE7QUFJQTtBQUxBO0FBU0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFEQTtBQUlBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQURBO0FBSUE7QUFDQTtBQU5BO0FBU0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7QUFUQTtBQVlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBTkE7QUFVQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQURBO0FBSUE7QUFMQTtBQVFBO0FBR0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBREE7QUFJQTtBQUNBO0FBTkE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBSkE7QUFPQTtBQVJBO0FBV0E7QUFDQTtBQUVBO0FBRUE7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFGQTtBQUtBO0FBUkE7QUFXQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUZBO0FBS0E7QUFSQTtBQVdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBRkE7QUFLQTtBQUNBO0FBVEE7QUFZQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUZBO0FBS0E7QUFDQTtBQVRBO0FBWUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQVRBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFEQTtBQURBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFJQTtBQVBBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBS0E7Ozs7Ozs7O0FDNXVCQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBT0E7OztBQUVBOzs7O0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFHQTs7Ozs7OztBQXFFQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUpBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7Ozs7OztBQUtBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBK0NBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFKQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSkE7QUFTQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUpBO0FBU0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUpBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQUNBO0FBUUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFKQTtBQVNBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSkE7QUFRQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFKQTtBQVVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSkE7QUFTQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQVNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExWkE7QUE0WkE7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFKQTtBQVVBO0FBRUE7Ozs7Ozs7Ozs7QUFPQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQXRDQTtBQXlDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFwMUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7QUFJQTs7Ozs7Ozs7QUFTQTs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7Ozs7QUEweENBOzs7Ozs7QUFLQTs7Ozs7Ozs7Ozs7QUNsNkNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUF1RUE7Ozs7Ozs7Ozs7Ozs7QUFhQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUdBO0FBSUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBRUE7QUFFQTs7Ozs7OztBQUtBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSUE7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBeG5CQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUlBO0FBQ0E7QUFDQTs7Ozs7O0FBNGpCQTs7QUNwcEJBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7O0FDekJBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7Ozs7QUFHQTs7Ozs7Ozs7QUNuSkE7OztBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDckdBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7Ozs7O0FBSUE7OztBQUVBOzs7Ozs7O0FBT0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUxBO0FBVUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFMQTtBQVVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlCQTtBQStCQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFFQTs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFKQTtBQVNBO0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUpBO0FBU0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSkE7QUFDQTtBQVFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUZBO0FBSkE7QUFDQTtBQVdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUF2bUJBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUlBO0FBQ0E7QUFDQTs7Ozs7O0FBZ21CQTs7Ozs7Ozs7OztBQzlzQkE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUdBO0FBR0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFjQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7OztBQUlBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTs7O0FBR0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBK0JBOzs7Ozs7Ozs7OztBQVFBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOzs7Ozs7Ozs7OztBQVFBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7QUFRQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUlBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBRUE7QUFFQTs7O0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7OztBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7Ozs7QUFPQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7O0FBS0E7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFFQTtBQUVBOzs7Ozs7Ozs7OztBQVFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFJQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBOzs7Ozs7QUFJQTs7Ozs7Ozs7Ozs7Ozs7OztBQ2w5QkE7OztBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7Ozs7OztBQUlBOzs7Ozs7OztBQ2hDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFIQTtBQUtBO0FBRUE7QUFFQTs7Ozs7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFMQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTs7O0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBSUE7QUFDQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBTEE7QUFDQTtBQU9BO0FBQ0E7QUFFQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDMVZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBSUE7Ozs7Ozs7O0FDeEVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBSkE7QUFNQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFNQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7OztBQUlBOzs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUdBOzs7Ozs7QUFNQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRkE7QUFDQTtBQUtBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBREE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFHQTs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFLQTtBQUNBO0FBRUE7OztBQWhZQTtBQUNBO0FBQ0E7OztBQWdDQTtBQUNBO0FBQ0E7Ozs7OztBQWdXQTs7Ozs7Ozs7QUN2YUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7Ozs7QUFLQTtBQUNBO0FBQUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQU1BO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7O0FBNUlBO0FBQ0E7QUFDQTs7Ozs7O0FBOElBOzs7Ozs7OztBQ3pMQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7QUFJQTs7O0FBQ0E7Ozs7Ozs7O0FBVUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFOQTtBQVFBO0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUpBO0FBQ0E7QUFNQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBS0E7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBOzs7O0FBS0E7QUFDQTtBQUFBO0FBS0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFPQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFDQTtBQUVBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBR0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUdBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFFQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFDQTtBQUtBOzs7Ozs7OztBQVFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQTU5QkE7QUFBQTtBQUFBOzs7Ozs7QUFnK0JBOzs7Ozs7OztBQ3BrQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFJQTs7Ozs7Ozs7QUMzQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBOzs7OztBQUtBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBSEE7QUFLQTtBQUVBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFHQTs7O0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUNBO0FBS0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBRkE7QUFLQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7OztBQXZKQTtBQUFBO0FBQUE7Ozs7OztBQTBKQTs7Ozs7Ozs7QUN4UEE7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBMEJBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBL0JBO0FBQ0E7QUFDQTtBQStCQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBeENBO0FBQ0E7QUFDQTtBQXdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUExQ0E7QUFDQTtBQUNBO0FBMENBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUE3Q0E7QUFDQTtBQUNBO0FBNkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQS9DQTtBQUNBO0FBQ0E7QUErQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQXBEQTtBQUNBO0FBQ0E7QUFvREE7QUFDQTtBQUNBOzs7Ozs7QUFJQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3RkE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUVBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFZQTtBQUNBOzs7QUEwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7Ozs7Ozs7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFmQTtBQWlCQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBOzs7QUE3U0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7OztBQXZEQTtBQUNBO0FBZ1VBOzs7Ozs7Ozs7Ozs7QUMxVUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFzQkE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQUNBOzs7Ozs7O0FBRkE7QUFVQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQTNCQTtBQUNBO0FBREE7QUFBQTtBQStCQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN2REE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFzQkE7QUFFQTs7Ozs7QUFJQTs7Ozs7QUFDQTs7Ozs7Ozs7Ozs7OztBQWFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQVhBO0FBWUE7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFrREE7QUFDQTtBQUVBOzs7QUFuREE7QUFDQTtBQUNBO0FBbURBO0FBQ0E7QUFFQTs7O0FBcERBO0FBQ0E7QUFDQTtBQW9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUF0REE7QUFDQTtBQUNBO0FBc0RBO0FBQ0E7QUFFQTs7O0FBdkRBO0FBQ0E7QUFDQTtBQXVEQTtBQUNBO0FBRUE7OztBQXhEQTtBQUNBO0FBQ0E7QUF3REE7QUFDQTtBQUVBOzs7QUF6REE7QUFDQTtBQUNBO0FBV0E7QUFDQTtBQUFBOzs7O0FBSUE7QUFDQTtBQUVBOzs7QUFqQkE7QUFDQTtBQUNBO0FBaUJBO0FBQ0E7QUFFQTs7O0FBbEJBO0FBQ0E7QUFDQTtBQWlEQTtBQUNBO0FBRUE7Ozs7QUFuSEE7QUFzSEE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRkE7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUlBOzs7Ozs7OztBQzNKQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7OztBQUdBOzs7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQXdCQTtBQUNBO0FBRUE7OztBQXpCQTtBQUNBO0FBQ0E7QUF5QkE7QUFDQTtBQUVBOzs7QUExQkE7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUVBOzs7QUFQQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBRUE7Ozs7OztBQWFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3hFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7OztBQUdBO0FBQ0E7QUFDQTs7Ozs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7QUFjQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFUQTtBQVVBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQXNCQTtBQUNBO0FBRUE7OztBQXZCQTtBQUNBO0FBQ0E7QUF1QkE7QUFDQTtBQUVBOzs7QUF4QkE7QUFDQTtBQUNBO0FBd0JBO0FBQ0E7QUFFQTs7O0FBekJBO0FBQ0E7QUFDQTtBQXlCQTtBQUNBO0FBRUE7OztBQTFCQTtBQUNBO0FBQ0E7QUEwQkE7QUFDQTtBQUVBOzs7QUEzQkE7QUFDQTtBQUNBO0FBMkJBO0FBQ0E7QUFFQTs7OztBQWhGQTtBQUNBO0FBb0ZBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFEQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3JIQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7OztBQUlBO0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBS0E7QUFLQTtBQUVBO0FBS0E7QUFDQTtBQUNBO0FBeEJBO0FBMEJBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBQ0E7QUFFQTs7O0FBWEE7QUFDQTtBQUNBO0FBV0E7QUFDQTtBQUVBOzs7QUFaQTtBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBRUE7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOzs7O0FBL0ZBO0FBQ0E7QUFpR0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL0hBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTs7O0FBSUE7QUFDQTtBQUNBOzs7OztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUVBO0FBRUE7QUFJQTtBQUtBO0FBQ0E7QUFmQTtBQWdCQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQUNBO0FBRUE7OztBQVhBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUFFQTs7O0FBWkE7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQUVBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7OztBQTlEQTtBQWlFQTs7Ozs7QUFHQTtBQUFBO0FBQUE7QUFDQTs7Ozs7Ozs7QUFRQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhCQTtBQUFBO0FBQUE7QUFzQ0E7QUFDQTtBQXZDQTtBQUFBO0FBQUE7QUFrQkE7QUFDQTtBQW5CQTtBQUFBO0FBQUE7QUFzQkE7QUFDQTtBQXZCQTtBQUFBO0FBQUE7QUEwQkE7QUFDQTtBQTNCQTtBQUFBO0FBQUE7QUE4QkE7QUFDQTtBQS9CQTtBQUFBO0FBQUE7QUFrQ0E7QUFDQTtBQW5DQTtBQUNBO0FBREE7QUFBQTtBQTJDQTs7OztBQUdBO0FBQUE7QUFBQTtBQUVBOzs7Ozs7Ozs7QUFTQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkJBO0FBQUE7QUFBQTtBQXFCQTtBQUNBO0FBdEJBO0FBQUE7QUFBQTtBQXlCQTtBQUNBO0FBMUJBO0FBQUE7QUFBQTtBQTZCQTtBQUNBO0FBOUJBO0FBQUE7QUFBQTtBQWlDQTtBQUNBO0FBbENBO0FBQUE7QUFBQTtBQXFDQTtBQUNBO0FBdENBO0FBQUE7QUFBQTtBQXlDQTtBQUNBO0FBMUNBO0FBQUE7QUFBQTtBQTZDQTtBQUNBO0FBOUNBO0FBQUE7QUFBQTtBQWtEQTtBQUNBO0FBbkRBO0FBQ0E7QUFEQTtBQUFBO0FBc0RBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZNQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkE7OztBQUdBO0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBSkE7QUFLQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7OztBQVZBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7OztBQWxCQTtBQUNBO0FBd0JBOzs7Ozs7Ozs7Ozs7Ozs7O0FDckRBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQTs7O0FBSUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFFQTtBQUNBO0FBSkE7QUFBQTtBQUNBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFDQTtBQUpBO0FBQUE7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUhBO0FBSUE7QUFDQTtBQU5BO0FBQUE7QUFDQTtBQVFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFKQTtBQUFBO0FBTUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFDQTtBQUpBO0FBQUE7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFFQTtBQUNBO0FBSkE7QUFBQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFKQTtBQUFBO0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQURBO0FBSUE7Ozs7Ozs7O0FDakZBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRQTs7Ozs7Ozs7OztBQUVBOzs7Ozs7Ozs7OztBQVdBO0FBQ0E7QUFVQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBY0E7QUFFQTtBQVdBO0FBRUE7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBa0JBO0FBRUE7QUFZQTtBQUVBO0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWVBO0FBRUE7QUFXQTtBQUVBO0FBRUE7Ozs7Ozs7Ozs7Ozs7OztBQVlBO0FBRUE7QUFVQTtBQUVBO0FBRUE7Ozs7Ozs7Ozs7Ozs7O0FBV0E7QUFDQTtBQVVBO0FBRUE7QUFFQTs7Ozs7Ozs7Ozs7OztBQVVBO0FBQ0E7QUFVQTtBQUVBO0FBRUE7Ozs7Ozs7Ozs7Ozs7OztBQVlBO0FBRUE7QUFZQTtBQVlBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFNQTtBQUVBOzs7Ozs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7OztBQzVTQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7Ozs7Ozs7QUFTQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBREE7QUFEQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUF0QkE7QUFDQTtBQXVCQTtBQUVBO0FBR0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQWFBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFnQkE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUdBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQWFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFnQkE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUdBO0FBR0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7Ozs7O0FBVUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFVQTtBQUNBO0FBQ0E7OztBQVZBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7Ozs7O0FBUUE7Ozs7Ozs7O0FDM2pCQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXdCQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7Ozs7OztBQWVBOzs7QUFFQTs7Ozs7O0FBTUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOzs7Ozs7QUFNQTtBQUlBOzs7Ozs7QUFNQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7Ozs7Ozs7Ozs7O0FBUUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUVBOzs7OztBQUdBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BOzs7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUpBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7Ozs7O0FBT0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7QUFZQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFFQTs7Ozs7OztBQUlBO0FBRUE7QUFDQTtBQUVBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7Ozs7Ozs7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7Ozs7OztBQUdBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///283\n")}])});